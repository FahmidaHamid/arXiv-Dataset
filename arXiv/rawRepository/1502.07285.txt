Pitfalls in the quantitative analysis of random walks and the mapping of
single-molecule dynamics at the cellular scale.
Jean-Baptiste Masson1,2 , Maxime Dahan3 and Antoine Triller4 .

arXiv:1502.07285v1 [physics.bio-ph] 25 Feb 2015

1

Physics of Biological Systems, Institut Pasteur, 75724 Paris Cedex 15, France
2
Centre National de la Recherche Scientifique, Unite Mixte de Recherche 3525, 75015 Paris, France
3
Laboratoire Physico-Chimie Curie, Institut Curie, CNRS UMR168,
Universite Pierre et Marie Curie-Paris 6, 75005 Paris, France
4
Biologie Cellulaire de la Synapse, Institut Nationale de la Sante et de la
Recherche Medicale U789, Ecole normale superieure, 75005 Paris, France.
(Dated: )
In recent years Bayesian Inference has become an efficient tool to analyse single molecule trajectories. Recently, high density single molecule tagging, Langevin Equation modelling and Bayesian
Inference [10] have been used to infer diffusion, force and potential fields at the full cell scale. In
this short comment, we point out pitfalls [1, 2] to avoid in single molecule analysis in order to get
unbiased results and reliable fields at various scales.
PACS numbers:

A response to Holcman et al [1]
Understanding the physical and biological processes governing the trafficking of membrane proteins is an central question in cell biology and biophysics. A powerful approach to model the motion of a random walker in
a complex environment is to use an overdamped Langevin equation. In the case of a coarse-grained description
(corresponding to the limited spatial and temporal resolution accessible in experiments), this equation writes:
p
ṙ = F (r) /γ (r) + 2D (r)η (t)

where F (r) /γ (r) corresponds to a local drift, γ (r) is a spatially-varying friction, D (r) a spatially-varying diffusion
coefficient and η (t) is a zero-averaged gaussian noise.

In past years, the advent of single molecule techniques has opened new possibilities to estimate the values of the
local parameters F (r) , γ (r) and D (r) in the cellular context. In particular, bayesian inference tools have been
developed to extract local force and diffusivity fields based on single molecule trajectories [3–8]. Not only these tools
have been extensively characterized from a methodological point of view [3, 4, 8] but they have also been applied to
experimental systems, in order to investigate the dynamics of toxin receptors in lipid rafts [3, 5, 6] and to calibrate
optical tweezers [7].
More recently, the analysis of the force and diffusivity fields has been extended to the full cellular scale in [2]
and in [10] thanks to high-density single molecule techniques, such as sptPALM [12] and uPAINT [13]. Thereby,
it has been possible to quantitatively analyze the synaptic stabilization of AMPA receptors [2] and Glycine
receptors [10]. Both papers similarly interpreted the role of synaptic scaffolds in terms of local confining potentials in
line with a view of the neuronal membrane where neuroreceptors diffuse and transiently stabilize at synaptic sites [11].
In their comment, Holcman et al. question the validity of the approach and description presented in [10]. We reply
below to the points that they raised by: (i) addressing some computational issues (statistical estimation of the model
parameters, numerical simulations) and demonstrating biases in the statistical estimators used in [2], (ii) discussing
the interpretation of the results.
Parameter estimation and numerical simulations.
A key point for the determination of the force and diffusivity fields based on single molecule data is the choice of
the statistical estimators. To clearly illustrate the simplifying assumptions used in [2], we first remind the standard
definition of the simplest likelihood used to analyze the dynamics of individual biomolecules in the absence of positional

2
noise:
L (D, f ) =

1
(4πD∆t)N

exp −

N
2
X
(∆ri − f∆t)

4D∆t

i=1

!

corresponding to N translocations ∆ri (during the sampling time ∆t) in a subdomain characterised by a constant
drift f = F/γ and diffusion coefficient D. By differentiating log(L) with respect to f and D, one directly gets:
N

∂ log(L) X (∆ri − f∆t)
=
∂f
2D
i=1
and
N

2

N X (∆ri − f∆t)
∂ log(L)
=− +
∂D
D i=1
4D2 ∆t
The maxima are obtained for:
N
X
∆ri )/N∆t
f =(
i=1

and
D=

1 X
1 X
(∆ri −
∆rj )2
4N ∆t i
N
j

The estimators used in [2] correspond to the maxima in the limit f∆t ≪ ∆ri and can thus be designated as
Maximum Likelihood Estimators (MLE).
The estimators used in [2] are biased when applied to experimentally measured trajectories for two main reasons.
First, an important element in the analysis of single molecule trajectories is the positioning noise σ, which results
from a combination of processes such as photon noise, motion blur, electronic noise and limited performance of peak
fitting algorithm. However, the effect of positioning noise was entirely neglected in the analysis presented in [2],
which, as shown below, leads to estimator biases and to improper parameter values for the synapses studied in [2].
Second, the approximation f∆t ≪ ∆ri (not discussed in [2]) also leads to strong bias in the force and diffusion
estimation over range of values relevant for the experiments reported in [2]. In our work, we have used Bayesian
inference schemes and directly included in our computation the full positioning noise as an experimental parameter
σ (see eq. equations 5 and 6 in [10]). We refer to [8] for a demonstration of the optimality of Bayesian inference methods for diffusion measurements and to [5] for a detailed discussion on their use in the case of confined motions.
To directly compare the performances of the estimators used in [2] and [10], we have performed numerical simulations
corresponding to experimental conditions reported in [2] (σ = 25 nm, ∆t = 20 ms, about 40 points per subdomain).
We first estimated the diffusion coefficient in the absence of external drift for D varying between 0.01 and 0.5 µm2 /s
(Figure 1A). For D < 0.05µm2 /s (a value comparable to the diffusion coefficient in synaptic domains), we observe a
clear bias when using the MLE estimators whereas our estimator √
remains accurate over the entire range. The limit
corresponds to the regime where σ is comparable or greater than D∆t.
Next, we tested the estimation of the diffusion coefficient and drift when brownian particles (with a diffusion
coefficient D = 0.05µm2 /s) were submitted to a force varying between 10−2 and 101 pN. While our approach yielded
accurate estimates of F and D, there was a systematic bias in the MLE estimation of both the force and the diffusion
coefficient at low force. Furthermore, a strong deviation can be observed for forces larger than Fc ∼ 0.1 pN (Figure
1.B1,B2), a value corresponding
to the the limit where the displacement due to the drift f ∆t is comparable to the
√
diffusional movement D∆t. Importantly, Fc is comparable to the confinement force U0 /2δ in a potential well with
depth U0 = 8 kB T and extension δ = 200 nm, such as the ones reported in [2]. Overall, our simulations indicate that
the estimates of the parameters (diffusion, forces and potential) for the synaptic domains are not accurate in [2]
Note that Bayesian inference techniques have been recently applied to evaluate the experimental trapping force
in optical tweezers [7]. This system is advantageous since the trap parameters can be finely tuned with the light

3
intensity and, importantly, independently calibrated. The estimate of the trap spring constant determined with
inference schemes was in good agreement with (in fact more accurate than) the results obtained by standard tools
(equipartition and power-spectrum methods).
Another important point is the extraction of the potential from the force field. In [2], this is done by minimizing
the square difference between the gradient of the potential and the force field. Such class of optimization problems,
especially with a discrete set, limited number of points and harmonic approximation, are always solved with a
regularization term [16, 17] (see equation 7 in [10]). Solving these problems without any regularization, either of
the force field or of the potential, leads to biases (as illustrated in Figure 1C,D).
Finally, regarding the numerical simulations (including the Gillespie scheme), we refer to [14] for approximating the
Fokker-Planck by the master equation and to [15] for simulating the master equation. We especially emphasize the
importance of the Gillespie scheme for rapidly generating a large number of trajectories, which enabled us to compute
fundamental descriptors of the motion (such as the propagator) as function of the time and over a large range of
distance.
Interpretation and discussion of the model.
A legitimate topic of discussion is the interpretation of the diffusivity and force (or potential) fields estimated
from individual trajectories. In their experiments, Hoze et al noted the existence of domains where individual
translocations pointed toward a single center point [2]. Similarly to what has been reported earlier for toxin receptors
[3, 5], such behavior was described in terms of a trapping potential. For AMPA receptors, the potential wells were
interpreted as resulting from interactions of the receptors with scaffolding proteins PSD-95 via stargazin molecules.
Before discussing and comparing our results [10], we emphasize that our inference approach does not require
the computation of a diffusion and a potential (D, U ) but can be performed to estimate the parameters (D, F )
or (D, F/γ) as it was done in [3–9]. The inference scheme simply provides a description of the environment in
terms of the diffusivity and force fields that have the highest probability. In the specific case of our experiments
on glycine receptors [10], we have favored a description in terms of a potential for several reasons. First, the force
field did not exhibit rotational terms, thus justifying the computation of a potential. Second, glycine receptors are
known to interact with gephyrin scaffolding proteins at inhibitory synapses. The fact that the trapping areas of the
membrane proteins perfectly co-localized with the location of gephyrin clusters strongly supported the notion that
the clusters acted as trapping wells. The role of the scaffolds in the observed potentials was further demonstrated
experiments using membrane proteins with mutant constructs of the β-loop mediating the receptor-gephyrin
interactions: for a mutant with weaker affinity, we measured shallower traps, and for proteins lacking the β-loop
entirely, there was a complete absence of potentials. In this context, the potential depth represents the energy needed
for receptors to escape gephyrin clusters. It is worth noting that it is the classical definition of the potential in physics.
In [10], we have used a spatially varying friction γ (r), reflecting the heterogeneity of the plasma membrane at the
full cell scale. Furthermore, we imposed the relationship D (r) = kB T /γ (r). This hypothesis was supported by the
fact that the transitions between adjacent domains (determined experimentally) satisfied detailed balanced condition,
thus suggesting a local equilibrium. For more advanced discussions on the FD relationship for systems with spatially
varying friction, we refer to recent references [18, 19].
An important difference between the results of [2] and [10] lies in the quantitative measurements of the potential
depths. For the wild-type beta-loop, we found an average energy of 3.4 kB T with less than 15% of the traps above 6
kB T (measured over ∼ 69 clusters). In contrast, 25 % of the traps reported in [2] were deeper than 8 kB T, indicating
a much higher level of stabilization. While it could be due to the difference between the biological systems and their
molecular constituents, it seems likely that the biased estimators (see discussion above) and the limited number of
data points presented in [2] (2, 5 and 10 wells depending on the experimental conditions) also contribute to the
discrepancy. Additional experiments, combined with careful statistical analysis, are needed to clarify the difference
between excitatory and inhibitory scaffolds.
In our view, the main remaining challenge is to quantitatively determine how the trapping energies at scaffolding
clusters relate to the biochemical properties of their individual constituents. We emphasize that there is no general

4
!4

B1

B2

/

!4!

# ï

-- !"#

!4

$%&&'(%)- µ* 4( #

/0

# ï

- µ! 4 "

A

1

/0

0

/0

ï/

/0

ï1

/0

ï2

!4!
!4! !4
-- µ!#4ï "

C

!4

/0

ï1

ï/

/0

/0

D

ï#

!$)%$#*+-&, .4µ' (



-

!



!
ï!4

0

ï!4#

!
!4#
!"#$#!%-&µ'(

!4

!4
!4!#

!4!

/

/0
- !"#

ï#

ï

!

/0

!

!

!
- !"#

!

#"!
789'(/-:+;;/(/%,/-0'4946

!4!

!4#

#!!
"!
!!
"!
!
!

!!

"!!
ï5
$%&'()*%+,-./()-01 34µ) 6

!!!

2

FIG. 1: Comparison of the results of the estimators used in [2] and [10] in simulated trajectories. All values are averaged over
1000 trajectories. The theoretical values are in black, the results associated to the estimators described in [2] are in red, and to
our estimators in cyan. Positioning noise was set to 25 nm [2]. A Evolution of the estimated diffusion with constant diffusion
field matching experimental conditions in [2]. Note that blue and red error bars are the same size, distortion is due to log-log
plot. B1,B2 evolution of the force and diffusivity (respectively) with force for constant diffusion field D = 0.05µm2 .s−1 . C
Example of an extracted potential from a simple 1D force field. The mesh was 50nm [2]. D evolution of the difference between
the input potential and the reconstructed one for 2D force fields, as a function of the anharmonicity.

procedure to go from a diffusion and force fields to biochemical characteristics of complex molecular assemblies. It will
depend on many geometrical and molecular properties of the assemblies, as well as on the spatio-temporal resolution
of the measurements. Fortunately, nanoscopy imaging methods now provide powerful tools to analyze the composition
and structure of scaffolding complexes [20, 21] and relate them to their functional roles at synapses.
Conclusion.
In summary, we stand by the methods and the approach described in [10] and earlier papers, and point out to errors
in the statistical and computation methods used in [1, 2]. Note also that we did not comment here on other important
elements for the mapping of the diffusivity and force (or potential fields), such as the meshing procedure and the
mesh size which should be adjusted to the averaged translocation length (a point not discussed in [2]), the effect of
strong variation between the number of points between neighboring mesh domains, the effect of confinement on the
accuracy of parameters extraction, the effect of heterogeneous diffusion field on the convergence of the estimators
and the projection of the potential on a proper functional basis. We refer the reader to previous publications [3–10]
(including their supplementary materials) for further discussion on all these points.
∗
Corresponding authors: jbmasson@pasteur.fr, maxime.dahan@curie.fr, triller@biologie.ens.fr.

[1] D. Holcman, N. Hoze, Z. Schuss, Analysis of single particle trajectories: when things go wrong arXiv:1502.00286
[2] N. Hoze, D. Nair, E. Hosy, C. Sieben, S. Manley, A. Herrman, J.-B. Sibarita, D. Choquet, and D. Holcman. 2012.
Heterogeneity of AMPA receptor trafficking and molecular interactions revealed by superresolution analysis of live cell
imaging. Proc. Natl. Acad. Sci. USA. 109:17052-17057.
[3] Masson, J. B., D. Casanova, ... A. Alexandrou. 2009. Inferring maps of forces inside cell membrane microdomains. Phys.
Rev. Lett. 102:048103.
[4] Turkcan, S., A. Alexandrou, and J.-B. Masson. 2012. A Bayesian inference scheme to extract diffusivity and potential fields
from confined single-molecule trajectories. Biophys. J. 102:2288-2298.
[5] Turkcan S, Masson J-B,... A.Alexandrou. 2012. Observing the confinement potential of bacterial pore-forming toxin receptors inside rafts with non-blinking Eu3+-doped oxide nanoparticles. Biophys J. 102: 2299-2308.

5
[6] Turkcan, S., M. U. Richly, ., J. B. Masson. 2013. Probing membrane protein interactions with their lipid raft environment
using single-molecule tracking and Bayesian inference analysis. PLoS ONE. 8:e53073.
[7] Richly M. U. ,Turkcan S. , ... Perronet K. , and A. Alexandrou. 2013. Optics Express. Vol 21, No 25, p31578
[8] Voisinne, G., A. Alexandrou, and J.-B. Masson. 2010. Quantifying biomolecule diffusivity using an optimal Bayesian
method. Biophys. J. 98:596-605.
[9] Turkcan S. and J.-B Masson . 2013. Bayesian Decision Tree for the Classification of the Mode of Motion in Single-Molecule
Trajectories, PloS ONE 8(12), e82799
[10] Masson J.-B. , P. Dionne, ... M. Dahan. 2014. Mapping the Energy and Diffusion Landscapes of Membrane Proteins at the
Cell Surface Using High-Density Single-Molecule Imaging and Bayesian Inference: Application to the Multiscale Dynamics
of Glycine Receptors in the Neuronal Membrane. Biophys. J. 106:s74?83
[11] A. Triller and D. Choquet (2008). New Concepts in Synaptic Biology Derived from Single-Molecule Imaging. Neuron 59,
358.
[12] Manley S, Gillette JM, Patterson GH, Shroff H, Hess HF, Betzig E, Lippincott-Schwartz J., (2008). High-density mapping
of single-molecule trajectories with photoactivated localization microscopy Nat. Methods 5(2):155-7.
[13] Giannone G., Hosy E., Levet F., Constals A., Schulze K., Sobolevsky A. I., Rosconi M. P., Gouaux E., Tampe R., Choquet
D. and Laurent Cognet. 2013. Dynamic Superresolution Imaging of Endogenous Proteins on Living Cells at Ultra-High
Density, Biophysical Journal Vol 99, No 4, p1303-1310
[14] H. Risken. 1996. The Fokker-Planck Equation, Methods of Solution and Applications, Springer
[15] Gillespie, D. 1977. Exact stochastic simulation of coupled chemical reactions. J. Phys. Chem. 81:2340-2361.
[16] C.M. Bishop. (2007). Pattern Recognition and Machine Learning (Information Science and Statistics). Springer
[17] Y. Wang and A. G. Yagola. (2011).Optimization and Regularization for Computational Inverse Problems and Applications.
Springer
[18] Farago O. and N. Gronbech-Jensen. (2014). Fluctuation-Dissipation Relation for Systems with Spatially Varying Friction.
J. Stat. Phys. 156 (6):1093-1110
[19] Farago O. and N. Gronbech-Jensen. (2014). Langevin dynamics in inhomogeneous media: Re-examining the ItoStratonovich dilemma. Phys. Rev. E 89:013301
[20] Specht CG, Izeddin I, Rodriguez PC, El Beheiry M, Rostaing P, Darzacq X, Dahan M, Triller A. (2013). Quantitative
nanoscopy of inhibitory synapses: counting gephyrin molecules and receptor binding sites. Neuron 24;79(2):308-21
[21] Nair D, Hosy E, Petersen JD, Constals A, Giannone G, Choquet D, Sibarita JB. (2014). Super-resolution imaging reveals
that AMPA receptors inside synapses are dynamically organized in nanodomains regulated by PSD95 J. of Neuroscience
7;33(32):13204-24.

