Combinatorics of Linked Systems of Quartet Trees
Emili Moana , Joseph Rusinkoa,∗

arXiv:1405.2464v2 [q-bio.QM] 16 Mar 2015

a Dept.

of Mathematics, Winthrop University, Rock Hill, SC 29733 USA

Abstract
We apply classical quartet techniques to the problem of phylogenetic decisiveness and find a value k such that all
collections of at least k quartets are decisive. Moreover, we prove that this bound is optimal and give a lower-bound
on the probability that a collection of quartets is decisive.
Keywords: Phylogenetics, Quartets, Decisiveness

1. Overview
Evolutionary biologists represent relationships between groups of organisms with phylogenetic trees. Supertree
methods were designed to handle the computationally difficult problem of reconstructing such trees for large data sets.
Those methods generate a group of accurate, smaller input trees and combine them into a single supertree. Four-taxa
trees, known as quartet trees, are commonly used as inputs in supertree methods.
Most quartet amalgamation algorithms use all quartet trees generated from sequencing data or only remove quartet
trees that appear to be incorrect. As quartet trees may contain overlapping information, it is possible that a smaller
number of trees may provide sufficient information for accurate reconstruction.
In [1], Böcker, et al. developed a sufficient condition for a set of quartet trees to be definitive. For any tree on
a taxon set [n] = {1, 2, · · · , n}, we develop a system of quartet trees that meets Böckers criteria, known as a linked
system. Additionally, we develop collections of linked systems known as meshed systems.
Recently, Steel and Sanderson asked for which collections of sets of taxa do the corresponding induced subtrees
determine a unique supertree. They called such collections decisive. The notion of decisiveness can be viewed as a
generalization of definitiveness where no information is required about the particular subtrees that the subsets of taxa
induce. This notion plays an important role in supertree reconstruction since it a priori addresses the question about
which subsets of taxa must be analyzed to ensure that a unique supertree can be reconstructed.
We use the term quartet to refer to any four element taxon subset, and the term quartet tree when referencing a
resolved four taxa tree. Using meshed systems, we find a minimal number k(n) such that every collection of at least k
quartets is decisive. We use this number to find a lower bound on the probability that an arbitrary collection of quartets
is decisive.
Finally, we find that meshed systems may be useful in amalgamation algorithms, such as Maxcut [2], that do not
always find the correct supertree when given a definitive system of quartet trees.
2. Linked Systems
We adopt the terminology in [3], except in noted instances when we follow [4] or [5]. Phylogenetic trees display
relationships among a finite set of taxonomic units.
∗ corresponding

author
Email addresses: pricee4@winthrop.edu (Emili Moan), rusinkoj@winthrop.edu (Joseph Rusinko)

Preprint submitted to Elsevier

March 17, 2015

Definition 2.1. A binary phylogenetic tree, T = (V, E, ϕ) on a finite set of taxa X, is a triple consisting of a finite set of
vertices, V , a set E of edges between vertices, and a ”labeling” map ϕ : X → L, where L ⊂ V contains all vertices of
degree one or leaves, such that the graph (V, E) is an unrooted binary tree and the map ϕ induces a bijection between
X and the set L of leaves of T .
An edge that contains a leaf is an exterior edge. The non-leaf vertex of an exterior edge is the internal vertex of e,
denoted vint (e). Two exterior edges sharing an internal vertex form a cherry. Any edge that is not an exterior edge is
an interior edge.
While edge length plays an important role in phylogenetics, we do not take it into account, and adopt instead a
topological definition of tree isomorphism.
Definition 2.2. Phylogenetic trees, T 1 = (V1 , E1 , ϕ1 ) and T 2 = (V2 , E2 , ϕ2 ) on a taxon set X, are isomorphic if there
exists a bijective map f : V1 → V2 , called an isomorphism, such that if {u, v} ∈ E1 then { f (u), f (v)} ∈ E2 and for every
x ∈ X we have ϕ2 (x) = f (ϕ1 (x)) .
It is impossible to distinguish phylogenetic relationships from unrooted trees with fewer than four taxa; thus,
supertree reconstruction algorithms frequently use four taxa trees or quartets trees as inputs [2, 6, 7]. Quartet trees
are binary phylogenetic trees on four leaves. Such trees are in one-to-one correspondence with two-element subsets
of X such as {{a, b}, {c, d}} according to the separation of the four leaves by the interior edge. The union of all four
taxa is the support of q, denoted supp(q).
Quartet trees contain an interior edge which separates the taxa into two pairs. Similarly, removing an interior edge
of a tree separates the graph into two connected components. An edge e separates taxa a and b from c and d if {a, b}
and {c, d} are subsets of the vertex sets of different connected components of T − {e}. This separation points to a
relationship between edges of a tree and quartet trees. A quartet tree ab|cd is displayed by a binary phylogenetic tree
T if there exists an edge e ∈ E that separates a and b from c and d.
Denote the set of all quartet trees on a taxon set [
X by Q(X). Any subset Q of Q(X) is called a system of quartet
trees on X with the support defined by supp(Q) =
supp(q). Additionally, we denote the set of all quartet trees
q∈Q

displayed by a tree T by QT . A system of quartet trees Q is compatible if there exists a tree T such that Q ⊆ QT .
Definition 2.3. ([4]) Let T = (V, E, ϕ) be a binary phylogenetic tree and let ab|cd ∈ QT . An interior edge e of T is
distinguished by ab|cd if e is the only edge that separates a and b from c and d.
Quartet trees which distinguish edges are a powerful input to quartet amalgamation algorithms. These algorithms
must handle non-compatible systems of quartet trees. However, even compatible systems may be difficult to resolve
as multiple trees may display a particular collection of quartet trees.
Definition 2.4. ([5]) A system of quartet trees, Q, is definitive, if up to isomorphism, there exists a unique binary
phylogenetic tree T for which Q ⊆ QT .
In [1], Böcker described various criteria for a system of quartet trees of the size n − 3 to be definitive. We construct
systems of quartet trees that meet this criteria and make note of some useful applications of these systems.
Proposition 2.5. (Example 3.7 of [1]) If T is a binary tree such that the interior edges of T are labeled E =
{e1 , ..., en−3}, and Q is a system of quartet trees such that each qi ∈ Q distinguishes a unique edge ei in T with
[
|supp(qi )\
supp(q j )| = 1
j<i

for i = 2, ..., n − 3, then Q is definitive.
We create a system of quartet trees that satisfies the hypotheses of Proposition 2.5, known as a linked system, by
imposing an ordering on the interior edges of a tree and the quartet trees which distinguish those edges. We define
linked systems in terms of the associated graph.
Definition 2.6. For a compatible system of n − 3 quartet trees Q on a taxon set X, define the associated graph GT (Q)
with vertex set V and edge set E as follows:
2

• The vertex set V is the set of all quartet trees q ∈ Q which distinguish a unique edge in T .
• Vertex pairs {qi , q j } are connected by an edge e ∈ E if the edge ei that qi distinguishes is adjacent to the edge e j
that q j distinguishes and |supp({qi, q j })| = 5.
Definition 2.7. Two quartet trees are linked if their vertices are connected in GT (Q). The system of quartet trees Q,
is a linked system if GT (Q) is connected. See Figure 1 for an example.

Figure 1: A binary phylogenetic tree T and the associated graph GT (Q) for the quartet trees q1 = 12|35, q2 = 34|15,
q3 = 57|13 and q4 = 56|71.
In Section 3 we prove that linked systems are definitive. Linked systems also help illuminate the broader concept
of phylogenetic decisiveness which we review here.
For a binary phylogenetic tree T and a subset Y of X, let T |Y denote the induced binary phylogenetic tree on leaf
set Y (the tree obtained from the minimal subtree connecting Y by suppressing any vertices of degree 2). Let S be the
collection of subsets of a set X of size four, we refer to all such subsets as quartets. [5]
Definition 2.8. [5] We say that S is phylogenetically decisive if it satisfies the following property: If T and T ’ are
binary phylogenetic trees, with T |Y = T ’|Y for all Y ∈ S, then T = T ’.
We will use collections of linked systems to find the minimal number k(n) such that a collection of at least k
quartets is phylogenetically decisive.
3. Applications of Linked Systems
We first show that linked systems meet Böcker’s criteria for defining a unique tree.
Theorem 3.1. Every linked system of quartet trees is definitive.
Proof. Let Q be a linked system of quartet trees on a tree T on a taxon set X. Linked systems are of size n − 3 and
each quartet tree distinguishes a unique edge in T . Let T be a binary phylogenetic tree on a taxon set X and let e1 be
an interior edge adjacent to a cherry. The tree is connected, which implies we can label the remaining interior edges
{e2 , · · · , en−3 } such that e j is adjacent to some ei with i < j. Moreover, because the support of each pair of quartet trees
{qi , q j } that distinguishes adjacent edges {ei , e j } is five, each pair of quartet trees shares three taxa and each additional
quartet tree in Q adds one new taxon to the support of Q. Thus, linked systems meet the criteria in Proposition 2.5
and are definitive.
Though all linked systems are definitive, we find that not all definitive systems of size n − 3 are linked.

3

Example. The system of quartet trees Q = {12|36, 23|45, 24|56} meets the criteria established in Proposition 2.5, and
is thus definitive. The graph GT (Q) contains the three vertices q1 , q2 , and q3 , where q2 and q3 are connected by an
edge and q1 is an isolated vertex. Thus, Q is not a linked system.
Since Böcker’s system and linked systems contain n − 3 quartet trees, one might surmise that all compatible
systems of quartet trees of a modest size would be definitive. However, there are large systems of compatible quartet
trees which are not definitive and large collections of quartets which are not decisive. A collection of quartets and the
induced quartet trees on a caterpillar tree provides one such example.
Definition 3.2. ([4]) A caterpillar on n leaves is a binary phylogenetic tree for which there exists an induced subtree
on a sequence of distinct interior vertices v1 , v2 , ..., vk such that, for all i ∈ {1, 2, ..., k − 1}, vi and vi+1 are adjacent.
The ordering of vertices in a caterpillar tree induces an ordering of interior edges ei where ei connects vi with vi+1 .
We use this ordering to construct large families of quartet trees shared by several caterpillar trees.
Theorem
  3.3. The minimal number k(n) such that every collection of quartets S with |S | ≥ k is decisive is greater
than n4 − (n − 3).
Proof. Let {a,b,c} be a subset of X. We define T 1 , T 2 , and T 3 to be three distinct caterpillar trees of size n ≥ 4 that
differ only in the placement of three taxa a, b, and c, such that for each tree vint (a), vint (b) and vint (c) are incident to e1 .
n−3
[
Denote S the set of n−3 sets
Yi = {a, b, c, y|y ∈ X −{a, b, c}} and let S′ be the complement of S. We observe that for
i=1

all Y ∈ S′ we have T 1 |Y = T 2 |Y = T 3 |Y, but T 1 , T 2 , T 3 . Therefore, S ′ is not decisive. Since |S′ | = n4 − (n − 3) the

minimal number k(n) such that every collection S of quartets with |S| ≥ k is decisive is greater than n4 − (n − 3).

To show that that sets of quartets of size n4 − (n − 3) are decisive, we prove that QT contains at least n − 3 disjoint
linked systems, ensuring the removal of any n − 4 quartet trees from a compatible system would leave at least one
linked system. We introduce a process for building such systems by using a seed quartet tree which distinguishes an
edge of a tree, and systematically constructing additional quartet trees which distinguish the same edge.
In a phylogenetic tree, each interior edge e = (vl , vr ) is adjacent to four edges ei , e j , eh , and ek , which divide the
tree into four components and partition the set of taxa X into four distinct sets Ai , A j , Ak , and Ah with x ∈ An if the
unique path from x to vl contains the edge en .
Definition 3.4. Let q = i j|kh be a quartet tree that distinguishes an edge e and let i ∈ Ai , j ∈ A j , k ∈ Ak , and h ∈ Ah ,
where Ai , A j , Ak , and Ah are partitions of X induced by e. For x ∈ X − supp(q) define the quartet tree substitution
q(x) to be the unique quartet tree in which the taxon x ∈ An replaces the taxon in q that is in supp(q) ∩ An .
Notice q(x) and q must distinguish the same edge of the tree.
[

Definition 3.5. Let the quartet tree q distinguish an edge e of a tree. Define the vine of q by v(q) = {q}∪

q(x).

x∈X−supp(q)

We refer to q as the seed of the vine.
The following shows that if two quartet trees are linked, then so are their vines.
Definition 3.6. Two vines v(qi ) and v(q j ) are linked if for each qi ∈ v(qi ) there exists a unique q j ∈ v(q j ) such that qi
and q j are linked.
Theorem 3.7. If qi and q j are linked quartet trees, then the associated vines v(qi ) and v(q j ) are linked.
Proof. Assume that {qi , q j } are the seeds of the adjacent edges ei and e j and are linked in T . Let v(qi ) and v(q j ) be the
associated vines.
Because the supp(qi , q j ) = 5, each quartet tree contains one taxon that the other does not. Let z be the taxon in
supp(q j) − supp(qi ) and y be the taxon in supp(qi ) − supp(q j). Use quartet tree substitution to construct the quartet
trees qi (z) and q j (y). By construction, supp(qi , q j ) = supp(qi (z), q j (y)) and qi (z) and q j (y) are linked.
4

Use quartet tree substitution with each remaining taxon x ∈ X − supp(qi , q j ) on qi and q j to construct the remaining
quartet trees in v(qi ) and v(q j ). In the construction of each {qi (x), q j (x)} one taxon (Case 1) or two taxa (Case 2) are
removed and one taxon x is introduced. Thus, for x ∈ X − (supp(qi, q j )) we have 4 ≤ |supp(qi (x), q j(x))| ≤ 6.
In Case 1, x replaces the same taxon in qi and q j and supp(qi , q j ) remains the same.
In Case 2, x replaces one taxon in qi and a different taxon in q j .
Assume that x replaces two different taxa in supp(qi , q j ) − supp(qi ∩ q j ). Then, |supp(qi(x), q j (x))| = 4 and
qi (x) = q j (x). This is not possible since qi and q j distinguish different edges. Thus, x does not replace two different
taxa in supp(qi , q j ) − supp(qi ∩ q j ) and |supp(qi (x), q j(x))| , 4.
Now assume that x replaces two different taxa in supp(qi ∩ q j ). Then, |supp(qi (x), q j (x))| = 6. Recall that qi and
q j distinguish the edges ei and e j . Thus, in order for x to replace two different taxa in supp(qi ∩ q j ), x would have to
be in two different sets of the partition that ei induces on X. This is not possible because x cannot be in two different
sets of a partition. Thus, x does not replace two different taxa in supp(qi ∩ q j ) and |supp(qi(x), q j (x))| , 6.
Thus, in this case, x replaces one taxon in supp(qi ∩ q j ) and one taxon in supp(qi , q j ) − supp(qi ∩ q j ) and
|supp({qi(x), q j (x)})| = 5. Therefore the vines v(qi ) and v(q j ) are linked.
A linking between vines allows us to construct multiple disjoint linked systems of quartet trees. We refer to these
systems as meshed systems and use them to show that any set of quartets of sufficient size is decisive.
Definition 3.8. A meshed system on a tree T with taxon set X is an (n − 3) by (n − 3) array of quartet trees, where
each row is a linked system and each column is a vine.
Note that the existence of a meshed system ensures that the removal of up to n − 4 quartet trees from QT must
leave at least one definitive set.
Theorem 3.9. For any binary phylogenetic tree T on a taxon set X, the system QT of all quartet trees displayed by T
contains a meshed system.
Proof. Let T be a binary phylogenetic tree on a taxon set X and let e1 be an interior edge adjacent to a cherry. The tree
is connected, which implies we can label the remaining interior edges {e2 , · · · , en−3 } such that e j is adjacent to some ei
with i < j.
Let e j be adjacent to ei with i < j. We know that ei separates T into two connected components T ia and T ib .
Moreover, e j separates T into two connected components T aj and T bj . Because ei and e j are adjacent, supp(T ib ) ∩
supp(T aj ) , ∅. Let qi = ab|cd and q j = ac|de such that a ∈ supp(T ia ), c ∈ supp(T bj ), and d ∈ supp(T ib ) ∩ supp(T aj ).
Thus, qi and q j are linked for all ei and e j in T . Thus, we have a linked system that makes up the first row of our
matrix.
Using quartet tree substitution, construct vines v(qi ) and v(q j ). By Theorem 3.7 the vines v(q j ) and v(qi ) are linked.
Thus, we have n − 3 disjoint columns of quartet trees in our matrix. Additionally, for each pair of linked quartet trees
{qi , q j } in row one, there exists a pair {qi (x), q j (x)} in the remaining rows of the matrix that are linked. Thus, we have
n − 3 rows of linked systems.
Therefore, QT contains a meshed system.
The existence of a meshed system allows us to find the minimal number, k(n), such that every collection S, of
quartets with |S| ≥ k is decisive.

Theorem 3.10. The number k(n) = n4 − (n − 4) is the smallest number such that every collection of quartets S on a
taxon set X = [n] such that S ≥ k is decisive.

Proof. Let S be a collection of quartets on a taxon set X = [n], with |S| ≥ n4 − (n − 4). Let T and T ′ be two
phylogenetic trees such that T |Y = T ’|Y for all Y ∈ S. We define Q ⊂ QT to be the collection
  of T |Y for all Y ∈ S.
By Theorem 3.9, QT contains a meshed system M. By the pigeon hole principle, if |Q| ≥ n4 − (n − 4) then Q must
contain one of the linked systems in M, and by Theorem 3.1, Q is definitive. Thus, T is the unique tree which displays
′
Q. However since Q is also T ′ |Y for all Y ∈ S, we must
n have T = T . Therefore, S is decisive. Moreover, Theorem
n
3.3 shows that k ≥ 4 − (n − 4). Therefore k(n) = 4 − (n − 4) is the minimal number such that every collection of
quartets with |S| ≥ k is decisive.
5

In addition to establishing requirements for collections of subsets of [n] to be decisive, [5] provides a formula for
the probability that a particular collections of subsets of [n] will be decisive for an arbitrarily sampled phylogenetic
tree. In this section, we prove a similar result by finding a lower-bound for the probability that a collection of subsets
of [n] of a particular size will be phylogenetically decisive. This bound is independent of the underlying tree topology.
Theorem 3.11. The probability p(X, k) that an arbitrary collection of k quartets is decisive has the property
n−3
P

(−1)i+1

p(X, k) ≥

i=1

n−3|Q
i

|Q |

T |−i(n−3)

|QT |−k


.

T

k

Proof. Let S be a collection of k quartets. Let T and T ′ be two phylogenetic trees such that T |Y = T ′ |Y for all Y ∈ S.
We define Q ⊂ QT to be the collection of T |Y for all Y ∈ S. Following Theorem 3.10, if Q contains a definitive set of
quartet trees, then S is decisive. By Theorem 3.1, if a collection of compatible quartet trees contains a linked system
of quartets, then it is definitive. Thus, the probability that a collection S is decisive is at least the probability that Q
contains one of the n − 3 disjoint linked systems constructed in Theorem 3.9. The formula follows from applying the
inclusion-exclusion principle to count the number of subsets of size k, which contain one of the disjoint systems of
linked quartets.
To illustrate the utility of the formula, we express the lower bound probability versus the number of quartets
selected in Figure 2. In Figure 3, we plot the number quartets required to ensure a fixed accuracy as a power of n.
Notice the number of quartets needed to ensure the sample is decisive with accuracy of 25% is on the order of nc with
c ∼ 3.3 and is almost indistinguishable from the number required to ensure 99% accuracy.

Figure 2: A lower bound on the probability that a set of quartets is decisive.

4. Conclusion
Using the criteria that Böcker established in [1], we have developed a new type of definitive system of quartet trees,
linked systems. We have also developed groups of linked systems, known as meshed systems. We have used meshed
systems to show that the number of quartets required to ensure decisiveness is on the order of O(n4 ). Moreover, we
have used meshed systems to show the probability that an arbitrary collection of quartets contains a decisive system.
These results lend credence to sampling quartets on the order of n3.3 .
6

Figure 3: Size of compatible quartets as a power of n required to ensure a decisive subset with fixed probability
It has been suggested that smaller sets of representative quartet trees will play a crucial role in developing efficient
scalable supertree methods, as the use of all quartet tree samples may be computationally inefficient [8]. Thus, linked
systems may be useful inputs in such algorithms. However, some supertree methods such as Quartets MaxCut do not
always return a fully resolved tree even when the input sets contain small definitive systems. For example, MaxCut
does not return a fully resolved tree for the linked system Q1 = {12|35, 13|45, 14|56}, but returns the correct tree for
the meshed system M = {Q1 , Q2 , Q3 } where Q2 = {12|34, 23|45, 24|56} and Q3 = {12|36, 23|46, 34|56}. Therefore, we
anticipate that both linked and meshed systems will serve as efficient inputs for future supertree algorithms, as these
algorithms could be reformulated to emphasize small definitive units.
5. Acknowledgements
Both authors were supported by grants from the National Center for Research Resources (5 P20 RR016461) and
the National Institute of General Medical Sciences (8 P20 GM103499) from the National Institutes of Health. We
would also like to thank Dr. Mike Steel for introducing us to the concept of decisiveness and giving input throughout
the writing process.
References
[1] S. Böcker, A. W. Dress, M. A. Steel, Patching up x-trees, Annals of Combinatorics 3 (1) (1999) 1–12.
[2] S. Snir, S. Rao, Quartets maxcut: A divide and conquer quartets algorithm, IEEE/ACM Transactions on Computational Biology and Bioinformatics 7 (4) (2010) 704–718.
[3] A. Dress, K. T. Huber, J. Koolen, V. Moulton, A. Spillner, Basic Phylogenetic Combinatorics, Cambridge University Press, 2012.
[4] C. Semple, M. A. Steel, Phylogenetics, Vol. 24, Oxford University Press, 2003.
[5] M. Steel, M. J. Sanderson, Characterizing phylogenetically decisive taxon coverage, Applied Mathematics Letters 23 (1) (2010) 82–86.
[6] S. Snir, T. Warnow, S. Rao, Short quartet puzzling: A new quartet-based phylogeny reconstruction algorithm, Journal of Computational
Biology 15 (1) (2008) 91–103.
[7] K. Strimmer, A. von Haeseler, Quartet puzzling: A quartet maximum-likelihood method for reconstructing tree topologies, Molecular Biology
and Evolution 13 (7) (1996) 964–969.
[8] M. S. Swenson, R. Suri, C. R. Linder, T. Warnow, An experimental study of quartets maxcut and other supertree methods, Algorithms for
Molecular Biology 6 (7).

7

