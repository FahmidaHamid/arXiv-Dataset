Understanding uncertainty in temperature effects on vector-borne disease: A Bayesian
approach

arXiv:1310.5110v2 [q-bio.QM] 22 May 2014

Leah R. Johnson∗1,2 , Tal Ben-Horin3,4 , Kevin D. Lafferty5,6 , Amy McNally7 , Erin Mordecai3,8 ,
Krijn P. Paaijmans9 , Samraat Pawar1,10 , Sadie J. Ryan11,12,13
1-Ecology and Evolution, University of Chicago; 2-Integrative Biology, University of South Florida;
3-Ecology, Evolution, and Marine Biology, UC Santa Barbara; 4-Marine and Coastal Sciences, Rutgers University;
5-Western Ecological Research Center, US Geological Survey; 6-Marine Science Institute, UC Santa Barbara;
7-Geography Department, UC Santa Barbara; 8-Biology, UNC Chapel Hill;
9-Barcelona Centre for International Health Research, Universitat de Barcelona;
10-Department of Life Sciences, Imperial College; 11- Environmental and Forest Biology, SUNY ESF
12-Center for Global Health and Translational Science, SUNY UMU;
13 - School of Life Sciences College of Agriculture, Engineering, and Science,
University of KwaZulu-Natal, Durban, South Africa

ABSTRACT: Extrinsic environmental factors influence the distribution and population dynamics
2

of many organisms, including insects that are of concern for human health and agriculture. This is
particularly true for vector-borne infectious diseases, like malaria, which is a major source of

4

morbidity and mortality in humans. Understanding the mechanistic links between environment
and population processes for these diseases is key to predicting the consequences of climate

6

change on transmission and for developing effective interventions. An important measure of the
intensity of disease transmission is the reproductive number R0 . However, understanding the

8

mechanisms linking R0 and temperature, an environmental factor driving disease risk, can be
challenging because the data available for parameterization are often poor. To address this we

10

show how a Bayesian approach can help identify critical uncertainties in components of R0 and
how this uncertainty is propagated into the estimate of R0 . Most notably, we find that different

12

parameters dominate the uncertainty at different temperature regimes: bite rate from 15-25◦ C;
fecundity across all temperatures, but especially ∼25-32◦ C; mortality from 20-30◦ C; parasite

14

development rate at ∼15-16◦ C and again at ∼33-35◦ C. Focusing empirical studies on these
parameters and corresponding temperature ranges would be the most efficient way to improve

16

estimates of R0 . While we focus on malaria, our methods apply to improving process-based
models more generally, including epidemiological, physiological niche, and species distribution

18

models.
Keywords: malaria; basic reproductive number; thermal physiology; Bayesian statistics; climate envelope.

1

20

1

Introduction

Malaria is a vector-borne disease that is a major source of illness and mortality in humans,
22

especially in developing countries. Like many vector-borne diseases, the dynamics of malaria are
greatly influenced by extrinsic environmental factors such as temperature and rainfall. As climate

24

changes over time, the distribution of both epidemic and endemic malaria will likely change as
well, presenting new challenges for control. A better understanding of how the dynamics of

26

malaria depend on environmental factors will be vital for understanding and planning for shifts in
malaria incidence.

28

Various approaches have been used to try to understand the question of how environmental
change is likely to impact the prevalence and distribution of malaria [reviewed in Guerra, 2007,

30

Johnson et al., 2014]. Many of these models can be classified as niche or species distribution
models, and they seek to link climate factors to observations of the prevalence of vectors,

32

parasites, or disease occurrence. For mechanistic versions of these models (in contrast to
geographical correlation models), it is necessary to understand how the vital rates of all players in

34

disease transmission respond to the environment. Temperature strongly influences vital rates,
particularly in ectotherms, and its effects can be measured under laboratory conditions. Despite

36

this basic premise and our reasonable knowledge about thermal physiology, data on responses of
vital rates to temperature are not widely available. Even for species that have been well studied,

38

like malarial parasites and their mosquito vectors, the quality and quantity of the data are uneven
across traits and temperatures. The paucity of data compromises the quality of model predictions,

40

such as the range of temperatures that are conducive to disease transmission. Moreover, the
sensitivity of model predictions to errors in empirical estimates is not well known. Here, we

42

develop methods for estimating sensitivity of model outputs to model inputs, focusing on the
effect of temperature on malaria transmission.

44

An important and simple measure of transmission, the reproductive number, R0 , is often used in
disease studies as it is related to both how quickly a disease can spread in a naı̈ve population and

46

to the level of prevalence (the proportion of individuals that have been infected) for endemic
2

diseases [Keeling and Rohani, 2008]. Recently, approaches have been developed to model how
48

R0 depends on temperature by incorporating thermal responses of traits underlying R0 , such as
mosquito and parasite development rates [Mordecai et al., 2013, Molnár et al., 2013]. For malaria,

50

the method involves the use of laboratory data collected on the temperature dependence of all
components of R0 that depend upon parasite or vector physiology — temperature response curves

52

fitted to each component are incorporated into the R0 equation to find the overall thermal
dependence of transmission. Including these physiologically based thermal responses produces

54

predictions of transmission that are more inline with observed incidence patterns than previous
models that do not incorporate these detailed physiological responses, even without accounting

56

for rainfall [Mordecai et al., 2013]. Although many other factors, such as key control measures,
may better predict malaria morbidity and mortality, this kind of relatively simple modeling is a

58

promising first step in prioritizing global health policy to respond to broad changes in the spread
and intensification of infectious diseases [Altizer et al., 2013].

60

Empirical research on the factors or components that determine R0 is costly. Thus, it is important
to direct future research towards aspects that will result in the greatest reduction in uncertainty in

62

R0 overall, and thus improve our predictions of changes in future transmission the most.
Currently, the laboratory data necessary to understand the temperature dependence of the

64

components that determine the response of R0 to temperature are often limited. Available data
leave substantial uncertainty about the relationship between each component of R0 and

66

temperature, especially at the temperatures that are marginal for transmission. Thus, we anticipate
considerable uncertainty in how R0 varies with temperature. By better understanding all of the

68

sources of uncertainty we can prioritize laboratory studies more efficiently and design effective
intervention strategies [Elderd et al., 2006, Merl et al., 2009]. Mordecai et al. [2013] addressed

70

this issue to some degree by performing a sensitivity analysis by perturbing the R0 components
with respect to temperature. However, this kind of simple, single-parameter local sensitivity

72

analysis does not allow a full understanding of either the uncertainty in components or in R0
overall. Further, additional data on components of R0 for closely related species or less

3

74

well-controlled experiments are often available. These additional data, even if not ideal for fitting
the final models directly, can be informative.

76

Here we use a Bayesian approach [Clark, 2007] to understand the full range of uncertainty in the
thermal response of malarial R0 . The focus of a Bayesian analysis is the posterior distribution:

78

i.e., the probability that the parameters have some value given the data. This is obtained by
combining a likelihood (the probability of observing the data given parameters with particular

80

values) and a prior distribution (the assumed probability that the parameters have some values
independent of the observed data) using Bayes rule. A full discussion of the Bayesian approach

82

can be found elsewhere [e.g. Clark, 2007]. A Bayesian approach allows us to incorporate prior
knowledge about the various components of R0 , for instance, by using data from related species

84

in the inference procedure. This is especially useful in applications that rely heavily on sparse
data, such as the one explored here.

86

We are interested in two primary aspects of the relationship between transmission and
temperature: (1) which temperatures prevent transmission? and (2) which temperatures promote

88

transmission? Earlier work on temperature and disease transmission in general, and for malaria in
particular, has produced mixed results, in part because the impact of temperature on preventing

90

transmission (as opposed to promoting it) is often ignored [Rohr et al., 2011, Hay et al., 2002,
Siraj et al., 2014, Gething et al., 2010]. We use a Bayesian approach to explore the uncertainty

92

and sensitivity of these two transmission outcomes – prevention and promotion – to mosquito and
parasite traits.

94

We begin by introducing the R0 model and its components, the potential thermal responses for all
its components, and the available data on these thermal responses. We then introduce the data

96

model, initial “uninformative” priors, and our overall methodology. We then step through a series
of uncertainty and sensitivity analyses, together with the results for each analysis. This is

98

followed by a discussion of how the approach taken compares to more classical analyses, and the
implications of the results.

4

100

2

Data, Models, and Methods

The standard model of malaria transmission by a vector is the Ross-McDonald model
102

[Macdonald, 1952], from which the reproductive number R0 is derived. R0 determines the
dynamical threshold for disease transmission, and is defined as the average number of secondary

104

infections caused by a single infected individual in an entirely susceptible population. It specifies
the relationships of parameters in the model that are required for an infection to spread within a

106

population (R0 > 1) as opposed to dying out (R0 < 1). The most widely used formulation for
malarial R0 [Dietz, 1993] is
s
R0 =

108

M a2 bc exp (−µ/P DR)
,
Nr
µ

(1)

where M is the density of mosquitoes, a is the bite rate, bc is vector competence, µ is the
mortality rate of adult mosquitoes, P DR is the parasite development rate (1/EIP , the extrinsic

110

incubation period of the parasite), N is the human density, and r is the human recovery rate. Most
of these model components are directly measurable or are closely related to quantities or traits

112

that can be observed [Mordecai et al., 2013]. Following Mordecai et al. [2013], we assume that
the expected mosquito density is given by:

M=

114

EF DpEA M DR
,
µ2

(2)

where EF D is number of eggs produced per female per day, pEA is the probability that an egg
will hatch and the larvae will survive to the adult stage, and M DR is the mosquito development

116

rate. The parameters that jointly define R0 and M are summarized in Table 1, and throughout this
paper we refer to these as “components of R0 ”.

118

Virtually all physiological traits in ectotherms exhibit unimodal temperature responses, i.e., they
have an optimal temperature at which the trait is maximized, and declines on either side [e.g.,

120

Amarasekare and Savage, 2012, Dell et al., 2011, Angilletta, 2009]. However, the exact functional

5

form of the unimodal response is still under debate, especially because it is known to vary with
122

the type of trait [Dell et al., 2011, Mordecai et al., 2013]. Therefore, as in Mordecai et al. [2013],
we determined the appropriate thermal-response model for each component trait by fitting

124

candidate functional forms: quadratic for symmetric responses and Briere for asymmetric (see
Section 2.2.1 and Figure 1). These were chosen as they are among the simplest functional forms

126

that exhibit the desired unimodal behavior.
All analyses were conducted in R [R Development Core Team, 2008] with Markov chain Monte

128

Carlo (MCMC) implemented in rjags/JAGS (Just Another Gibbs Sampler, [Plummer, 2003,
2013]). Computer code for all analyses are included in the Supplementary Files.

130

2.1

Data

We use two sets of data in our analysis — the “main” dataset contains the focal data for the
132

thermal responses for the components that make up R0 (Table 1), and a “prior” dataset used to
elicit priors for our Bayesian analysis (both sets included in the Supp. Files; for sources see

134

Supp. App. A, Table 1). Ideally, our main data set would exclusively comprise laboratory data on
Plasmodium falciparum, the causative agent of the majority of tropical malaria, and its primary

136

vector Anopheles gambiae, held at constant temperature for all components. These data were
available for only three traits: mosquito development rate (MDR), egg to adult survival (pEA ), and

138

adult mosquito mortality rate (µ). For other traits ideal data are unavailable [Mordecai et al.,
2013], and instead we used data from related species collected under appropriate laboratory

140

conditions. More specifically, we prioritized data collected in the laboratory at constant
temperatures. For mosquito and parasite traits, we prioritized based on the relative to efficacy of

142

transmission and severity of disease in humans. Thus, for mosquito traits, we prioritized data for
An. gambiae, followed by other anophelene species, and finally for Aedes species. For parasite

144

traits, P. falciparum was prioritized, followed by P. vivax. When possible, only a single mosquito
or parasite species was used for an individual trait in the main data. For our prior data set, our

146

conditions for inclusion were more flexible. Although data on related species held in the lab at

6

constant temperature were preferred, we also allowed more distantly related species, or less
148

controlled (variable temperature) experiments. These data are distinct from the main data set and
were used, along with expert opinion, to elicit informative priors for the parameters of the

150

unimodal temperature responses for each R0 component.

2.2
152

Approach, Likelihoods, and Priors

We fitted the thermal response of each component of R0 (Table 1) to independent data using a
Bayesian approach to obtain the posterior distribution for the parameters that describe each

154

response (and thus the posterior distribution of the response itself), as well as for R0 overall.
Inference in the Bayesian framework proceeds in three steps. First, a likelihood is defined for

156

each type of data. Second, appropriate prior distributions are determined. Third, samples from the
posterior distribution of the parameters, given the data, are obtained via Markov-chain Monte

158

Carlo (MCMC). We used this procedure first for the prior data and for the main data, assuming
uninformative priors in both cases (Section 2.2.2 and Supp. App. A Section 2). Next, the posterior

160

distributions obtained from analyzing the prior data were used to build informative priors and the
inference procedure was repeated for the main data using these informative priors. We then

162

compared the resulting posterior distributions obtained using the uninformative and informative
priors. Further, we calculated R0 with both sets of results, and compared these. This gave an

164

indication of the sensitivity of the individual components and of R0 to the choice of prior. We
followed this with further sensitivity and uncertainty analyses (Section 3).

166

2.2.1

Likelihoods

We assumed functional forms for each component based on our previous work [Mordecai et al.,
168

2013] and on the types of functional forms (unimodal and frequently asymmetric) that are typical
for similar traits in other arthropod species [Dell et al., 2011]. More specifically, we used either a

170

quadratic (symmetric) or Briere (asymmetric) function, depending on the component. At any
given temperature, the mean response should be determined by this functional form. Further, all

172

model components are, by definition, greater than or equal to 0. Thus, we chose to use a truncated
7

normal distribution, with mean parameter (usually denoted by µ) given by the appropriate
174

functional form (i.e., Briere or quadratic), as the likelihood for the data for most of the
components of R0 . For all of the components we examined, the lower truncation limit was at zero.

176

Most components can take any value greater or equal to zero. Thus, for most of our data
iid

Yi |0 < Yi < b ∼ N(µ = f (Ti ), σ 2 ), where b is the upper truncation limit (either 0 or ∞), f (Ti ) is
178

the Briere or quadratic temperature response, and iid indicates that the data are independently and
identically distributed. However, two components, the vector competence (bc) and the egg to adult

180

survival (pEA ), are probabilities and are thus constrained to be between zero and one. For these
components, we would ideally have the actual numbers of successes and total numbers of

182

observations so that the more appropriate binomial model could be used. These data were indeed
available for vector competence, and so were modeled with a binomial likelihood, i.e.
iid

184

Yi ∼ Bin(n, p = f (Ti )), where n is the number of total observations, of which Y were successes,
and the probability, p of a success at a particular temperature, f (Ti ), is either Briere or quadratic.

186

For egg to adult survival the raw data were not available so we used a normal distribution
truncated at zero and one to model the proportion of eggs that successfully mature to the adult

188

stage. This choice keeps calculations simple, allows straightforward implementation of
biologically based priors, and has shape properties that are more appropriate for these data than

190

alternatives such as a beta distribution.
2.2.2

192

Priors

We began by defining a set of default priors for all parameters that are chosen to be relatively
“uninformative”. That is, these priors were designed to constrain parameter values to be

194

biologically reasonable, but to otherwise provide wide, reasonably even support across potential
parameter values. In particular, for our default priors, we assumed that the maximum temperature

196

at which a unimodal, hump-shaped component goes to zero is 45◦ C, and the minimum
temperature should be 0◦ C, as these temperatures are generally lethal to mosquitoes. This upper

198

limit is slightly higher than some observed upper lethal limits, which are closer to 40◦ C [Bayoh,
2001, Bayoh and Lindsay, 2003, Lardeux et al., 2008]. We chose the higher, conservative, limit to
8

200

allow a broader range of temperatures for which the data could inform the posterior distributions.
Each of the concave-down (or hump-shaped) curves have a parameter that describes the

202

temperatures at which trait goes to zero, notated as T0 and Tm for the lower and upper limits,
respectively. Since we required T0 < Tm we specified non-overlapping priors for these

204

parameters. For the concave-up quadratic we chose priors that limited the quadratic curves to
those that are concave up and in the appropriate quadrant. We set the priors on other parameters

206

(including the precision parameter, τ = 1/σ, in the normal distribution) to be diffuse, i.e., to have
wide support. Details can be found in Supp. App. A, Sections 2 and 3. In all cases we examined

208

the sensitivity of the posterior distributions to the priors.

3
210

Uncertainty and Sensitivity Analyses and Results

Our uncertainty and sensitivity analyses consisted of multiple parts. First, we addressed sources
of uncertainty in our analysis, to understand the expected response of R0 and its components to

212

temperature, and the range of responses that are supported by data. This is similar to global
sensitivity analysis for the components and R0 . Our measure of uncertainty for each analysis is

214

the 95% highest probability density (HPD) interval which gives the range of a parameter or
response corresponding to a central area containing 95% of the probability. Second, we compared

216

how the uncertainty in R0 overall depends on the uncertainty in its components, using a variant of
local sensitivity analysis, and comparing the results to those obtained for the global-style analysis.

218

Third, we addressed how sensitive R0 is to temperature and to its components, as well as the
uncertainty in these relationships. Here, sensitivity is the amount by which R0 changes when

220

temperature changes, and is given by the derivative of R0 with respect to T . As with R0 itself, the
uncertainty in this sensitivity is expressed in terms of the 95% HPD intervals. How the Bayesian

222

and classical approaches to these analyses compare is addressed further in the discussion.

9

3.1
224

Uncertainty in the components of R0

How uncertain are the responses of the mosquito and parasite traits to temperature, and
how does this depend on the prior information included in the analysis?

226

To answer this question we made three sets of comparisons. First, we qualitatively examined the
impact of adjusting the default priors for each parameter on the inference for individual

228

components (with both the main and prior data). Second, we compared the posterior distributions
for individual components of the main data set obtained with default and informative priors. In

230

this case, the informative priors are generated from the posterior distributions obtained from
fitting the prior data to elicit informative priors. Third, we examined the impact of using an

232

alternative functional response for the vector competence term, for which there is both relatively
little data and little a priori support for a particular functional form.

234

The impact of including the informative priors varied between components, in some cases
decreasing uncertainty (smaller HPD intervals around the mean – bc, pEA , EF D, P DR),

236

sometimes increasing uncertainty (larger HPD intervals around the mean – a, M DR), or having
little impact on the posterior (no change in HPD intervals – µ) (Supp. App. B, Section 1). Across

238

components, modifying priors on the lower and upper temperature limits of the responses (T0 and
Tm , respectively) had the greatest impact on the posterior distributions of the temperature

240

responses overall. The upper limit of 45◦ C on Tm for the default and some of the informative
priors was important for components for which no high temperature data were available, such as

242

the bite rate, a. Full results for each component, including inferences with both types of priors,
and a comparison of the marginal posterior distributions of parameters with their priors, are

244

included in Supp. App. B.
In Figure 1 we show the posterior mean and 95% HPD interval around this mean (summarizing

246

the extent of our uncertainty around this response) for all the components when informative priors
were used. Some interesting patterns emerged when we compared across components. First, for

248

all components modeled with a Briere function (top row of Figure 1), the low temperature limit
(the temperature below which the trait is zero) was less certain than the upper temperature limit
10

250

(although this difference was small for PDR). This was partly due to the nature of the functional
form – i.e., it goes to zero more quickly at high temperatures than it does at low temperatures.

252

However, it also reflected that there were often fewer data available across lower temperatures
than high temperatures in the main and prior data together. This pattern of uncertainty at the

254

limits was not found for the concave down quadratic responses (middle row, Figure 1). Instead, in
some cases, the upper limit was less certain than the lower. This indicates that the temperature

256

resolution for experiments needed to pin down the responses may depend on the type of response
(asymmetric vs. symmetric) that a trait exhibits.

258

For most of the components explored, either the data gave a strong indication of whether a
symmetric or asymmetric response was appropriate [Mordecai et al., 2013], or there were

260

biophysical reasons why we expected a response to be asymmetric or symmetric a priori
[Angilletta, 2009, Dell et al., 2011]. However, vector competence (a compound trait) was

262

ambiguous. Thus, we fit both a quadratic and Briere function for this component. Both fit quite
well, and thus the impact of fits using both functional forms on the uncertainty in R0 was

264

addressed in the subsequent analysis.

3.2
266

Overall uncertainty in R0

How uncertain is the response of the basic respoductive rate, R0 , to temperature (due to
uncertainty in all components), and how does this depend on the prior information included

268

in the analysis?
To answer this question we made three comparisons. First, we compared the posterior

270

distributions of R0 under default and informative priors for the components, looking at the overall
uncertainty (95% HPD interval) of the full response curve when all components were allowed to

272

vary according to their posterior distributions. Second, we examined the HPD intervals of three
important summaries of R0 : minimum (low temperature transmission limit), maximum (high

274

temperature transmission limit), and peak (temperature at maximal transmission) R0 . Third, we
examined the impact of the two functional responses for the vector competence term on the

11

276

posterior distribution of R0 . This analysis shows the overall uncertainty around (1) which
temperatures prevent transmission (low and high temperature transmission limits) and (2) which

278

temperatures promote transmission (peak temperature).
In Figure 2 (top) we show the posterior mean of the temperature dependence of R0 and 95% HPD

280

intervals of the temperature response of R0 when both informative and uninformative priors are
used. All curves are scaled to the maximum value of the mean R0 (T ) curve. These are generated

282

using posterior samples from all components, and so indicate the overall uncertainty in the
response curve due to uncertainty in all components, simultaneously. Notice that the mean R0

284

curves obtained using default and informative priors are very similar. Further, the upper 95%
HPD intervals were nearly identical. However, the lower HPD intervals of R0 , especially at higher

286

temperatures, differ considerably as the additional prior information allowed us to pin down the
high temperature transmission limit more precisely. This can be seen more clearly by looking at

288

the posterior distributions of the upper and lower temperature limits of R0 and the distribution of
the temperature at peak R0 (Figure 2, bottom). With the default priors, almost the full range of

290

possibilities for the lower (from 0 to 24 ◦ C) and upper (from 25 to 45 ◦ C) limits were equally
represented. Adding in prior information indicates support for a slightly lower temperature limit

292

to malaria transmission while the upper limit is at a slightly higher temperature than was predicted
with default priors. In other words, the climate envelope where transmission may be possible is

294

slightly larger than would be inferred without prior data. Further, our estimates of the
temperatures that can exclude malaria, particularly at the upper end, are more precise. However,

296

the prediction of the temperature of peak transmission, which corresponds to temperatures at
which malaria is expected to be most severe and difficult to control, was robust.

298

As mentioned in the previous section, the most appropriate functional response to describe the
temperature dependence of vector competence (bc, a compound trait) was ambiguous. Since both

300

functional forms fit the available data well, we examined how using each impacted the posterior
inferences for R0 . To do this, we calculated R0 using first the posterior samples for the Briere

302

response for bc and then the quadratic. All other components of R0 were allowed to take all

12

possible values of their posterior distributions. Thus our comparison shows how the uncertainty in
304

the functional form for bc impacts the overall uncertainty in R0 given the full uncertainty in the
other parameters. The choice of the functional form for bc had little impact on the the posterior

306

distribution of R0 (T ) except at the high temperature limit (Supp. App. B). As with other
components examined, the vector competence fit with a Briere function exhibited reduced

308

uncertainty in the upper limit compared to the quadratic fit, and as a result decreased the
uncertainty in R0 at this limit. Since there is no a priori reason to prefer one or the other of these,

310

in all further analyses we assumed the quadratic fit, as this resulted in the most uncertainty in R0
at the upper limit, and was thus a more conservative choice.

312

3.3

Uncertainty in R0 and its sensitivity to temperature, by component

Which mosquito and parasite traits drive the uncertainty in R0 , across temperatures? To
314

answer this question, we used a variation of a traditional sensitivity analysis. We set all but a focal
component to its posterior mean. Then the posterior samples of the focal component were used to

316

calculate the width of the 95% HPD at each temperature due to only the variation in this single
component. We then normalized this to the width of the 95% HPD for the full posterior of R0

318

(i.e., when all components were allowed to vary) to approximate the proportion of the uncertainty
each component contributed to the full uncertainty in R0 .

320

In Figure 3 (a) we show the amount of uncertainty in R0 due to a single component, compared to
the uncertainty overall. The adult mosquito mortality rate µ, dominated at intermediate

322

temperatures, i.e., the region in which temperature promotes transmission, because R0 ∝ 1/µ3
(by definition from Equations (1) and (2)), and at intermediate temperatures the rate of adult

324

mosquito mortality is low. More surprising was the relatively narrow range of temperatures where
it dominated: µ dominated in the middle third of the transmission range, and is primarily

326

determined the height and location of peak R0 . This explains why the informative priors had so
little impact on the upper HPD interval for R0 (Figure 2) – the posterior of µ was not impacted by

328

additional prior information and this component determined the height of the curve. By contrast,

13

the uncertainty on the lower and upper limits for transmission was driven by bite rate and
330

fecundity, respectively. In particular, uncertainty in the bite rate (a) drove uncertainty in the lower
temperature boundary, while the fecundity (EF D), was most important at the upper temperature

332

limit. These two components were also the most important sources of uncertainty, after µ, at
intermediate temperatures. Other components, such as vector competence (bc), contributed very

334

little to the overall uncertainty, despite the fact that the data on these components were sparse.
This was primarily because parameters like this are probabilities, bounded between zero and one,

336

and only impact R0 proportionally. Other parameters have the potential to vary over orders of
magnitude, and thus swamp the impact of these parameters over most of the range of R0 . Only

338

when the magnitude of the other parameters are small, such as the temperature extremes, can
these contribute significantly to the overall uncertainty.

340

Which mosquito and parasite traits determine the sensitivity of R0 to temperature and the
uncertainty in the sensitivity, across temperatures? Next we examined how sensitive R0 is to

342

changes in temperature, that is, how various components contribute to the change in R0 with
temperature, as measured by the derivative of R0 with respect to temperature. We especially

344

focused on the uncertainty of the sensitivity, measured by the HPD interval around the mean
sensitivity, and which components drive the uncertainty. We focus on these as they indicate the

346

348

data that can best help improve our understanding of what determines the shape of R0 across
temperatures. We started with a standard sensitivity analysis, calculating the derivative of R0 with

0
(see Supp. App. A
respect to temperature overall and for each component separately, dR
dT θ
Section 5 for equations). As with the previous analysis, we then set all components, save a focal

350

component to its mean, and used the posterior samples from that focal component to obtain the
marginal posterior distribution for the sensitivity. We repeated this for all components, then

352

354

examined the median sensitivity and the width of the 95% HPD intervals for the component-wise

0
0
sensitivity, dR
, relative to the overall sensitivity, dR
(calculated using the posterior samples
dT θ
dT
from all the components at once) to see which components were driving the sensitivity of R0 to
temperature and the uncertainty in the sensitivity.

14

356

In Figure 3 (b) we show the uncertainty in the sensitivity of R0 to temperature by each component
scaled by the overall uncertainty in the sensitivity of R0 to temperature. For instance, the median

358

sensitivities, by component, indicate that at low temperatures R0 was very sensitive to the bite rate
and at high temperatures (even the very highest) the mortality rate drove the response of R0 to

360

temperature (Supp. App. C). However, at very high and very low temperatures, other components
besides bite rate and mortality began to be important as well, and these other components were

362

less certain. Thus, at the temperature extremes determining where transmission is not possible,
the uncertainty in how sensitive R0 is to temperature was driven by other components, such as

364

fecundity (EFD) and the parasite development rate (PDR).

4
366

Discussion

Using a Bayesian approach, we identified component traits that were the main sources of
uncertainty in R0 , and in how sensitive R0 is to temperature. Overall, uncertainty about the

368

temperature limits on transmission was greater than the uncertainty in the optimal temperature for
transmission. We found that much of the uncertainty in R0 was due to adult mosquito mortality, µ,

370

as one would expect given R0 ’s nonlinear dependence on mortality. This contribution was focused
in the region of temperatures that promote transmission, where µ and its uncertainty were small.

372

Other components determined the uncertainty near the temperature limits of R0 in terms of the
relative width of the HPD intervals. In particular, near the low temperature limit, the uncertainty

374

in R0 was largely due to uncertainty in the bite rate, a, whereas near the high temperature limit the
uncertainty was primarily due to uncertainty in fecundity (EFD). Fecundity also contributed a

376

relatively large amount of uncertainty across temperatures. The uncertainty in the high
temperature limit itself was determined primarily by the parasite development rate (PDR).

378

The most important empirical data needed to improve model certainty depends on the goals. To
resolve the uncertainty in the temperature optimum, empirical studies should focus on measuring

380

adult mosquito mortality rate from 20-30◦ C, as well as bite rate and fecundity. By contrast,
resolving uncertainty surrounding the lower and upper temperature limits on transmission
15

382

requires measuring 1) bite rate from 15-25◦ C; 2) fecundity across temperatures, but especially
∼25-32◦ C; and 3) PDR at ∼15-16◦ C and 33-35◦ C. This last is especially interesting, because

384

PDR is not driving the overall uncertainty at any temperature. Instead, our uncertainty in how
sensitive R0 is to temperature depends on PDR at both temperature extremes. More specifically,

386

our uncertainty in the temperature at which R0 changes from zero is driven by PDR,. This also
suggests that PDR component could be determining the temperature limits for malaria

388

transmission, and the ability of the parasite to evolve at the edges of its thermal limits could
determine where malaria could occur. Resolving the temperature limits is particularly important

390

given that warming is expected to expand transmission into currently or recently unsuitable
highland areas [Siraj et al., 2014], and may force currently warm, suitable lowland areas above the

392

upper transmission limit. Differences in the presumed thermal limits that inhibit transmission can
impact predictions of when and where transmission is likely to occur both now and in the future.

394

[Ryan et al., Submitted]. A better understanding of the uncertainty in the temperatures that inhibit
transmission should help inform policy priorities as climate changes.

396

Further, our results provide guidance as to which components may not be as high priority for
further work. For instance, our analysis indicates which components are contributing relatively

398

little to the uncertainty in R0 , such as vector competence (bc). Although these components are
necessary for transmission (incompetent vectors cannot transmit disease, for example),

400

investment in reducing uncertainty in these components will have a comparatively small impact
on our overall understanding of R0 . Thus, these components could be given a lower priority for

402

further empirical effort, especially if these components are difficult or expensive to measure.
Our method is unusual in that it combines concepts and approaches from traditional global and

404

local sensitivity analyses with a Bayesian method of inference. Bayesian analyses often focus on
the inference and uncertainty aspects, and, for simpler models, model and variable selection. If

406

sensitivity is addressed, it is typically the sensitivity of the posterior to the prior specification.
Conversely, most sensitivity analyses would typically be conducted using parameter values

408

selected at random or evenly over some “reasonable range” of parameters for a system instead of
16

performing parameter inference as part of the procedure. This traditional approach would be most
410

similar to performing our analysis using samples from informative priors. The choice to take the
extra step and fit data before doing the uncertainty and sensitivity analyses depends on whether or

412

not appropriate, high quality data are available for the analysis. If this is not the case, then
incorporating additional data could lead to bias in results. However, even moderately good data,

414

such as we have in our example, allowed us to narrow down the regions of parameter space that
are reasonable for our system by allowing the data to inform us of how the parameters that

416

describe our thermal response curves are correlated for each component of R0 , which is not easy
to obtain a priori.

418

On the other hand, in this example, we have been forced to use data from alternative species, even
for the focal data. For instance, we used fecundity data for Aedes albopictus for the focal data,

420

even though we expect these are likely to be different from any Anopheles species. We also used
P. vivax data for vector competence. Thus, we may have underestimated the overall uncertainty in

422

R0 and the uncertainty due to these components. It is unclear how to explicitly incorporate this
into the current (or any other) framework to quantify the impact of using these data. However, the

424

types of sensitivity analyses we conducted take into account the structure of the model, and give
information about how much each component could potentially contribute to the overall

426

uncertainty. We can, therefore, use these analyses to complement our intuition about how to focus
research efforts. Thus, although fecundity for Anophelene species and vector competence for

428

P. falciparum could be useful (since we had to use alternative species for these analyses), when
combined with the rest of the analyses, we would prioritize fecundity as uncertainty in that

430

component has a bigger impact on overall uncertainty. Further, we might expect that some
components that contribute to R0 have biological reasons to be more uncertain, for instance

432

because there is more individual variability in some traits or local adaptation [Sternberg and
Thomas, 2014]. With appropriate data we could explicitly include individual (or population) level

434

variation as part of the analysis, or combine data across different populations while allowing
differences in thermal response curves within the framework.

17

436

Although we applied our methods to a particular formulation of R0 for malaria, the approach is
appropriate for mechanistic models of other systems, including other vector-borne disease and

438

species distribution models. To best understand the full uncertainty for a particular disease or
species distribution, consideration of multiple mechanistic models and environmental drivers

440

would allow researchers to further understand model uncertainty, and the robustness of
predictions to other formulations. For instance, alternative dynamical models could change the

442

estimate of the peak and range of species distributions as the functional relationship between
various traits or vital rates and population performance could be substantially different. This is an

444

issue that is largely ignored in the literature addressing disease incidence, species distributions,
and climate envelopes. This source of model uncertainty needs to be addressed to fully quantify

446

uncertainty in the response of populations to climate change. We suspect that for many species
and diseases, including malaria, the uncertainty inherent in the individual components would

448

often swamp model uncertainty in big picture quantities like R0 . This is especially true when data
from a focal species are not available at all, as discussed above, and further emphasises the

450

importance of high quality data for parameterising these kinds of models. However, alternative
formulations incorporate each component in different ways, so the conclusions about which

452

components drive uncertainty are likely to be less robust. Consideration of multiple models can
indicate what data acquisition should be prioritized, for instance if it is important across a variety

454

of model formulations, and further, which new data would allow better discrimination between
competing models. The Bayesian approach allows direct comparison of models and their

456

uncertainty. Thus it has the potential to be a useful tool for identifying concrete recommendations
for future research to improve predictions of how factors such as climate change could impact the

458

distribution of malaria and other vector-borne diseases.

Acknowledgements: This work was conducted as part of the Malaria and Climate Change
460

Working Group supported by the Luce Environmental Science to Solutions Fellowship and the
National Center for Ecological Analysis and Synthesis, a Center funded by NSF (EF-0553768),

462

the University of California, Santa Barbara and the State of California. EAM was funded by an

18

NSF Doctoral Dissertation Improvement Grant (DEB-1210378), and an NSF Postdoctoral
464

Research Fellowship (DEB-1202892). Any use of trade, product or firm names in this publication
is for descriptive purposes only and does not imply endorsement by the US government.

466

References
S. Altizer, R. S. Ostfeld, P. T. Johnson, S. Kutz, and C. D. Harvell. Climate change and infectious

468

diseases: From evidence to a predictive framework. Science, 341(6145):514–519, 2013.
P. Amarasekare and V. Savage. A framework for elucidating the temperature dependence of

470

fitness. The American Naturalist, 179(2):178–191, Feb. 2012.
M. J. Angilletta. Thermal adaptation: a theoretical and empirical synthesis. Oxford University

472

Press, 2009.
M. Bayoh and S. Lindsay. Effect of temperature on the development of the aquatic stages of

474

Anopheles gambiae sensu stricto (diptera: Culicidae). Bulletin of entomological research, 93
(5):375–382, 2003.

476

M. N. Bayoh. Studies on the development and survival of Anopheles gambiae sensu stricto at
various temperatures and relative humidities. PhD thesis, Durham University, 2001.

478

J. S. Clark. Models for Ecological Data. Princeton University Press, Princeton, NJ, 2007.
A. I. Dell, S. Pawar, and V. M. Savage. Systematic variation in the temperature dependence of

480

physiological and ecological traits. Proceedings of the National Academy of Sciences, 108(26):
10591–10596, June 2011.

482

K. Dietz. The estimation of the basic reproduction number for infectious diseases. Statistical
Methods in Medical Research, 2(1):23–41, Mar. 1993.

484

B. D. Elderd, V. M. Dukic, and G. Dwyer. Uncertainty in predictions of disease spread and public
health responses to bioterrorism and emerging diseases. Proceedings of the National Academy
19

486

of Sciences, 103(42):15693–15697, 2006. doi: 10.1073/pnas.0600816103. URL
http://www.pnas.org/content/103/42/15693.abstract.

488

P. W. Gething, D. L. Smith, A. P. Patil, A. J. Tatem, R. W. Snow, and S. I. Hay. Climate change
and the global malaria recession. Nature, 465(7296):342–345, May 2010.

490

C. A. Guerra. Mapping the contemporary global distribution limits of malaria using empirical
data and expert opinion. PhD thesis, University of Oxford, Sept. 2007.

492

S. I. Hay, J. Cox, D. J. Rogers, S. E. Randolph, D. I. Stern, G. D. Shanks, M. F. Myers, and R. W.
Snow. Climate change and the resurgence of malaria in the east african highlands. Nature, 415

494

(6874):905–909, 2002.
L. R. Johnson, K. D. Lafferty, A. McNally, E. A. Mordecai, K. P. Paaijmans, S. Pawar, and S. J.

496

Ryan. Mapping the distribution of malaria: current approaches and future directions. In
D. Chen, B. Moulin, and J. Wu, editors, Analyzing and Modeling Spatial and Temporal

498

Dynamics of Infectious Diseases. John Wiley & Sons, 2014.
M. J. Keeling and P. Rohani. Modeling infectious diseases in humans and animals. Princeton

500

University Press, Princeton, 2008.
F. Lardeux, R. Tejerina, V. Quispe, and T. Chavez. A physiological time analysis of the duration

502

of the gonotrophic cycle of Anopheles pseudopunctipennis and its implications for malaria
transmission in Bolivia. Malaria journal, 7(1):141, 2008.

504

G. Macdonald. The analysis of equilibrium in malaria. Tropical diseases bulletin, 49(9):813,
1952.

506

D. Merl, L. R. Johnson, R. B. Gramacy, and M. Mangel. A statistical framework for the adaptive
management of epidemiological interventions. PLoS ONE, 4(6):e5807, 06 2009. doi:

508

10.1371/journal.pone.0005807. URL
http://dx.doi.org/10.1371%2Fjournal.pone.0005807.
20

510

P. K. Molnár, S. J. Kutz, B. M. Hoar, and A. P. Dobson. Metabolic approaches to understanding
climate change impacts on seasonal host-macroparasite dynamics. Ecology Letters, 16(1):921,

512

2013.
E. A. Mordecai, K. P. Paaijmans, L. R. Johnson, C. Balzer, T. Ben-Horin, E. de Moor,

514

A. McNally, S. Pawar, S. J. Ryan, T. C. Smith, and K. D. Lafferty. Optimal temperature for
malaria transmission is dramatically lower than previously predicted. Ecology Letters, 16(1):

516

2230, 2013.
M. Plummer. Jags: A program for analysis of bayesian graphical models using gibbs sampling. In

518

Proceedings of the 3rd International Workshop on Distributed Statistical Computing (DSC
2003). March, pages 20–22, 2003.

520

M. Plummer. rjags: Bayesian graphical models using MCMC, 2013. URL
http://cran.r-project.org/web/packages/rjags/index.html. R package

522

version 3.10.
R Development Core Team. R: A Language and Environment for Statistical Computing. R

524

Foundation for Statistical Computing, Vienna, Austria, 2008. URL
http://www.R-project.org. ISBN 3-900051-07-0.

526

J. R. Rohr, A. P. Dobson, P. T. Johnson, A. M. Kilpatrick, S. H. Paull, T. R. Raffel,
D. Ruiz-Moreno, and M. B. Thomas. Frontiers in climate change–disease research. Trends in

528

ecology & evolution, 26(6):270–277, 2011.
S. Ryan, A. McNally, L. Johnson, E. Mordecai, K. Paaijmans, and K. Lafferty. Climate change

530

and malaria shifts: new implications for health geography and targeting control. Submitted.
A. Siraj, M. Santos-Vega, M. Bouma, D. Yadeta, D. R. Carrascal, and M. Pascual. Altitudinal

532

Changes in Malaria Incidence in Highlands of Ethiopia and Colombia. Science, 343(6175):
1154–1158, 2014.

21

534

E. D. Sternberg and M. B. Thomas. Local adaptation to temperature and the implications for
vector-borne diseases. Trends in Parasitology, 30(3):115–122, 2014.

536

Supplementary Appendix A: Data sources, functional forms, default and informative prior
details, equations for sensitivity analysis.

538

Supplementary Appendix B: Plots for full results for all components of R0 .
Supplementary Appendix C: Further results for R0 and sensitivity to temperature.

540

Supplementary Files: Compiled data, source code for analyses, and output files to reconstruct
the analysis described in the manuscript.

22

Parameter Definition
a
MDR

Functional Form

bite rate (1/ gonotrophic cycle length)

Briere

mosquito development rate

Briere

pEA

egg to adult survival

quadratic

EFD

fecundity (eggs/female/day)

quadratic

µ

mosquito mortality rate

quadratic

bc

vector competence

PDR

quadratic (and Briere)

parasite development rate (1/EIP)

Briere

Table 1: Component parameters of R0 and their definitions.

23

542

Figure 1: Posterior mean (solid line) and 95% credible interval (dashed lines) of the thermal

544

responses for all components of R0 , with informative priors together with the main data. Traits
p
modeled with a Briere thermal response (cT (T − T0 ) (Tm − T )) are grouped in the top row,
concave-down quadratic (f (T ) = a(T − T0 )(T − Tm )) in the middle row, and concave-up

546

quadratic (aT 2 + bT + c) in the bottom row. Data symbols correspond to the species of mosquito
or parasite used for the analysis. •: An. gambiae or P. falciparum in An. gambiae; +: other

548

Anophelene species or P. falciparum in other Anophelene species; ×: Aedes species; ◦: P. vivax
in other Anophelene species.

550

Figure 2: (TOP) Relative R0 (R0 divided by the maximum value of the posterior mean) assuming
a quadratic function for vector competence, with uninformative priors on all components (blue,

552

dashed) and informative priors on components (red, solid). 95% HPD around each curve are
shown as dotted lines. (BOTTOM) Smoothed posterior distributions of the (left) lower

554

temperature limit of R0 , (middle) peak temperature of R0 , (right) upper temperature limit of R0
all assuming a quadratic function for vector competence. Case with uninformative prior is shown

556

as a blue dashed line and with informative prior as a solid red line.
Figure 3: (a) Relative width of the 95% HPD intervals due to uncertainty in each component,

558

compared to uncertainty in R0 overall. Each curve was obtained as followed. For each
component, R0 was calculated for the thinned posterior samples of that component, with all other

560

562

components set to its posterior mean. Then the width of the inner 95% HPD was calculated at
each temperature. This was then normalized to the width of the HPD of the full posterior

0
distribution of R0 at each temperature. (b) Relative width of the 95% HPD in dR
scaled by the
dT θ
width of the 95% HPD for

564

dR0
dT

at each temperature, calculated as in (a). In both, a quadratic

response for vector competence (bc) was used.

24

a

●

0.3

Bite Rate (a)

0.4

0.10

●

10

●

20

30

40

0.0

●

0

0.00

0.00

0.1

●

●

0.2

●
●

0.05

Parasite Development Rate (PDR)

0.10

● ●
●
●

0.05

Mosquito Development Rate (PDR)

0.5

0.6

0.15

PDR

0.15

MDR

0

10

20

Temperature (C)

40

0

10

pEA

30

40

30

40

EFD
25

●

20
Temperature (C)

1.0

1.0

bc
●

30

Temperature (C)

●
●

0.2
●

10

●

20

30

●

40

●

0

10

●

20

Temperature (C)

30

20
0

●

0

0.0

0.0

0.2

●

15

0.6

●

0.4

Egg to Adult Survival

0.6
0.4

vector competence (bc)

●
●

●

10

●
● ●

5

●

fecundity in Eggs per Female per Day (EFD)

0.8

0.8

●

40

Temperature (C)

0

10

20
Temperature (C)

0.6
0.4

mortality rate (mu)

0.8

1.0

µ

●

●

0.2

●
●
●
●

●

0.0

●

0

10

20

30

40

Temperature (C)

Figure 1: Posterior mean (solid line) and 95% credible interval (dashed lines) of the thermal responses for all components of Rp
0 , with informative priors together with the main data. Traits modeled with a Briere thermal response
(cT (T − T0 ) (Tm − T )) are grouped in the top row, concave-down quadratic (f (T ) = a(T − T0 )(T − Tm )) in the
middle row, and concave-up quadratic (aT 2 + bT + c) in the bottom row. Data symbols correspond to the species of
mosquito or parasite used for the analysis. •: An. gambiae or P. falciparum in An. gambiae; +: other Anophelene
species or P. falciparum in other Anophelene species; ×: Aedes species; ◦: P. vivax in other Anophelene species.

25

3.0
2.5
2.0
1.5
0.0

0.5

1.0

relative R0

15

20

25

30

35

Temperature (C)

16

18

20
Temperature (C)

22

24

0.0

0.0

0.00

0.1

0.05

0.1

0.2

0.10

0.2

0.3

0.15

0.3

0.4

0.20

0.5

density of upper limit of R0
0.4

density of peak R0

0.25

density of lower limit of R0

22

23

24

25
Temperature (C)

26

27

28

24

26

28

30

32

34

Temperature (C)

Figure 2: (TOP) Relative R0 (R0 divided by the maximum value of the posterior mean of R0 ) assuming a quadratic
function for vector competence, with uninformative priors for all components (blue, dashed) and informative priors for
all components (red, solid). 95% HPD around each curve are shown as dotted lines. (BOTTOM) Smoothed posterior
distributions of the (left) lower temperature limit of R0 , (middle) peak temperature of R0 , (right) upper temperature
limit of R0 all assuming a quadratic function for vector competence. Case with uninformative prior is shown as a
blue dashed line and with informative prior as a solid red line. The height of the distribution indicates the relative
probability of the value of the quantity of interest.

26

1.0

1.0

0.6

0.8

a
bc
EFD
e2a
MDR
mu
PDR

0.0

0.2

0.4

Relative width of HPD intervals

0.8
0.6
0.4
0.0

0.2

Relative width of HPD intervals

a
bc
EFD
e2a
MDR
mu
PDR

15

20

25

30

35

15

Temperature (C)

20

25

30

35

Temperature (C)

(a)

(b)

Figure 3: (a) Relative width of the 95% HPD intervals due to uncertainty in each component, compared to uncertainty
in R0 overall. Each curve was obtained as follows. For each component, R0 was calculated for the thinned posterior
samples of that component, with all other components set to its posterior mean. Then the width of the inner 95% HPD
was calculated at each temperature. This was then normalized to the width of the HPD of the full posterior distribution
of R0 (incorporating the full posterior
samples from all components simultaneously) at each temperature. (b) Relative

0
0
scaled
by the width of the 95% HPD for dR
width of the 95% HPD in dR
dT θ
dT at each temperature, calculated as in
(a). In both, a quadratic response for vector competence (bc) was used.

27

