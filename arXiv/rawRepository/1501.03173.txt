A note on choice and detect probabilities in the presence of choice
bias
Ralf M. Haefner˚

arXiv:1501.03173v1 [q-bio.NC] 13 Jan 2015

Brain & Cognitive Sciences, University of Rochester, NY

January 15, 2015

Abstract
Recently we have presented the analytical relationship between choice probabilities, noise correlations and read-out weights in the classical feedforward decision-making framework (Haefner et al.
(2013)). The derivation assumed that behavioral reports are distributed evenly between the two
possible choices. This assumption is often violated in empirical data especially when computing socalled grand CPs combining data across stimulus conditions. Here, we extend our analytical results
to situations when subjects show clear biases towards one choice over the other, e.g. in non-zero
signal conditions. Importantly, this also extends our results from discrimination tasks to detection
tasks and detect probabilities for which much empirical data is available. We find that CPs and DPs
depend monotonously on the fraction, p̂, of choices assigned to the more likely option: CPs and DPs
are smallest for p̂ “ 0.5 and increase as p̂ increases, i.e. as the data deviates from the ideal, zerosignal, unbiased scenario. While this deviation is small, our results suggest a) an empirical test for
the feedforward framework and b) a way in which to correct choice probability and detect probability
measurements before combining different stimulus conditions to increase signal/noise.

1

Introduction

Understanding the contribution of sensory neurons to perceptual decisions has been a long-standing goal
of systems neuroscience (Parker and Newsome (1998)). One popular approach to answer this question
has been to compute the correlation between individual neuronal variability of those sensory neurons and
the choice of the subject in perceptual decision-making tasks. In discrimination tasks, these correlations
are quantified as ’choice probability’ (CP), and in detection tasks, as ’detect probability’ (DP) – reviewed
in Nienborg et al. (2012). Unfortunately, the interpretation of CPs and DPs is complicated by the fact
that they not only depend on how individual neurons are being read-out, but also on how these neurons
are correlated with each other (Shadlen et al. (1996)). Recently, we presented the analytical relationship
between CPs, read-out weights and noise correlations for the case of a two-alternatives discrimination
task assuming that the subject’s decisions were unbiased. Here, we extend this work to include biased
decision-making when trials are not evenly split between the two choice, and to detection tasks.
˚ ralf.haefner@gmail.com

1

2

Results

We assume a linear read-out of the responses r ” pr1 , r2 , .., rn q of n sensory neurons by a hypothetical
řn
decision neuron rD “ wJ r ” i“1 wi ri . We further assume that a decision is made in favor of either
choice 1 (of 2 choices, in a discrimination task), or in favor of ’detect’ or ’ignore’ (in a detection task)
when the activity of the decision neuron rD exceeds a given threshold θ: choice 1 if rD ą θ and choice 2 if
rD ď θ. In this mathematical framework discrimination tasks and detection tasks are equivalent and, for
simplicity, in the following our notation will use ’choice 1’ and ’choice 2’ only. Equally, we will use CP to
denote both CPs and DPs. We further assume that the response of each neuron is normally distributed
around a mean given by its tuning curve, fi psq for a particular stimulus value s: ri “ fi psq ` ηi where
η „ N p0, Cq with covariance matrix C.
This allows us to compute the choice-triggered response distribution for each neuron, ppri |rD ą θq and
ppri |rD ă θq, and the choice-triggered average (CTA), i.e. the difference in the mean responses preceding
choice 1 and choice 2, respectively (Methods):
∆choice r :“ xppri |rD ą θqy ´ xppri |rD ă θqy
c
"
*
1
1
Cw
1 “ ´1 ‰2
?
“
exp ´ Φ pp̂q
p̂ p1 ´ p̂q 2π wJ Cw
2
„ J

w f psq ´ θ
with p̂ “ Φ ?
: 0; 1 .
wJ Cw
where p̂ is the probability with which the subject chooses choice 1 over choice 2.
CPs can be computed as
ż8

ż8
D

CPi “

dy ppri “ y|rD ą θq

dx ppri “ x|r ă θq
x

´8

For p̂ “ 0.5 this integral is identical to that for CPs in the unbiased case. Hypothesizing an equivalent
relationship between CTA and CP for the general case (Haefner et al. (2013)), suggests this approximate
formula:
?

CPi «

2
pCwqi
1
a
`
2
π
Cii wJ Cw

!
“
‰2 )
exp ´ 21 Φ´1 pp̂q
4p̂ p1 ´ p̂q

.

(1)

In simulations we have confirmed that the error induced by the approximation is below 0.5% for p̂ ď 0.9,
which is more than a magnitude smaller than current empirical error bars.
Interestingly, this approximation becomes better as p̂ deviates from 0.5 and is therefore better than
the first-order approximation presented for unbiased CPs in Haefner et al. (2013). This is presumably
due to the fact that the choice-triggered distributions, ppr|rD ă θq and ppr|rD ą θq, are maximally nonGaussian for the balanced case of p̂ “ 0.5 and become progressively more Gaussian as p̂ deviates from
0.5, and that for the Gaussian case the CTA–CP relationship is linear.
Figure 1 plots the bias-dependent term that captures the ratio of the CP in a biased condition to the
CP in an unbiased scenario. The bias is quantified by the probability of choice 1, p̂, ranging from 0 to 1,
with 0.5 being unbiased.
While the read-out strategy for detection tasks is currently unknown, equation (1) implies that for
2-pool models, i.e. read-outs that rely on the difference between the responses of two neuronal pools, the

2

Deviation from
unbiased
case (fraction)
coefficient

DP scale
1.5
1.4
1.3
1.2
1.1
1

0.2

0.4

0.6
pdetect

0.8

p̂

Figure 1: Ratio between actual CPs and those for the balanced case of an even number of choices.

insights gained from discrimination tasks also hold (Haefner et al. (2013)). In particular, in a model in
which the averaged responses of two large homogenous neural pools (all neurons have the same response
variance) are subtracted from each other, DPs only depend on the difference between the average noise
correlation coefficient between neurons in the same pool and the average correlation coefficient between
neurons in different pools. This means that DPs in this case depend not on the overall mean of the noise
correlations but on their ’structure’, i.e. the difference between within and across pool correlations. In
contrast, in the equivalent 1-pool model, where the average neuronal activity of a neuronal ’pref’ pool is
compared to an internal threshold θ, the DP of neurons in the pref pool depends on the average noise
correlation within that pool while the DP of other neurons depends on their average correlation with the
pref pool neurons. We obtain for large populations (where the diagonal terms can be neglected):
!
“ ´1 ‰2 )
˜
¸˜ ¸
?
1
Cpref Cdiff
1 exp ´ 2 Φ pp̂q
2
1
1
a
CP « `
2
π
4p̂ p1 ´ p̂q
0
C11 wJ Cw Cdiff Cnull
!
)
“
‰
2
?
exp ´ 12 Φ´1 pp̂q
1
2?
CPpref « `
cpref
and
2
π
4p̂ p1 ´ p̂q
)
!
“ ´1 ‰2
?
1
1
2 cdiff exp ´ 2 Φ pp̂q
CPnull « `
?
2
π cpref
4p̂ p1 ´ p̂q

and therefore

where cpref is the average correlation between neurons within the pref pool and cdiff is the average
correlation between neurons that are in different pools.

3

Discussion

We have extended the known analytical relationship between choice probabilities, read-out weights and
noise correlations in the linear feedforward framework to situations where the subject shows a bias
towards one of the two choices. This, more general case, encompasses discrimination tasks where CPs are
computed for non-zero-signal trials, and detection tasks and detect probabilities. While this generalization
is only approximate, the error due to this approximation is much smaller than current measurement
errors. Furthermore, like the approximation previously presented for the balanced case, it allows for an
easy intuition into how observable CPs depend on read-out weights, and noise correlations. Notably, it
differs from the balanced CP by a factor that only depends on the probability with which the subject

3

chooses choice 1 (or detect) over choice 2 (or miss) – a value that is easily inferred from the data.
Prior work on the effect of choice bias on CPs (Kang and Maunsell (2012)) has found that CPs are
underestimated when grand CPs are computed by z-scoring and combining responses across different
signal conditions. This finding is different and not in contradiction with the result presented here, that
actual CPs should increase with choice bias in the feedforward framework.
The dependency of CP on the choice bias that we report has three immediate consequences. One,
it suggests an empirical test for the feedforward, linear decoding, decision-making framework that is
the basis for the presented relationship. Two, it suggests a way in which to compare CPs measured
at different levels of choice bias, for instance in order to combine signal trials and zero-signal trials to
increase signal-to-noise in the CP measurements (so-called ’grand CPs’, Nienborg et al. (2012)). Third,
and most importantly, it extends the benefits of an analytical relationship from discrimination tasks to
detection tasks for which much physiological data is available (reviewed in Nienborg et al. (2012)).

References
Haefner, R. M., Gerwinn, S., Macke, J. H. and Bethge, M. (2013). Inferring decoding strategies from
choice probabilities in the presence of correlated variability. Nature Neuroscience 16, 235–242.
Kang, I. and Maunsell, J. H. R. (2012). Potential confounds in estimating trial-to-trial correlations
between neuronal response and behavior using choice probabilities. Journal of neurophysiology 108,
3403–15.
Nienborg, H., Cohen, M. and Cumming, B. G. (2012). Decision-Related Activity in Sensory Neurons :
Correlations Among Neurons and with Behavior. Annual Review of Neuroscience 35, 463–483.
Parker, A. J. and Newsome, W. T. (1998). Sense and the single neuron: probing the physiology of
perception. Annu Rev Neurosci 21, 227–277.
Shadlen, M. N., Britten, K. H., Newsome, W. T., Movshon, J. A. and Anthony, J. (1996). A computational
analysis of the relationship between neuronal and behavioral responses to visual motion. J Neurosci
16, 1486–1510.

4

Methods

The choice-triggered response distribution for each neuron is given by:
ppri |rD ą θq “

pprD ą θ|ri qppri q
pprD ą θq

“ p̂´1 pprD ą θ|ri qppri q
ppri |rD ă θq “

pprD ă θ|ri qppri q
pprD ă θq

“ p1 ´ p̂q´1 pprD ă θ|ri qppri q
where p̂ “ 1 ´ Φrθ : wJ f psq; wJ Cws “ ΦrwJ f psq ´ θ : 0; wJ Cws is the fraction of trials during which
the subject reported choice 1. p̂ “ 0.5 for the unbiased case. We defined φpri : fi psq; Cii q to be the
4

Gaussian probability density over ri with mean fi psq and variance Cii . Equivalently, Φ is defined to be
the cumulative Gaussian. It follows:
ppri |rD ą θq “ p̂´1 φpri : fi psq; Cii q
"
„
*
pCwqi
pCwq2i
J
J
1 ´ Φ θ : w f psq `
pri ´ fi psqq; w Cw ´
Cii
Cii
fi
»
pCwqi
J
η
`
w
f
psq
´
θ
i
1
ηi
ii
“ ? φp ?
: 0; 1fl and
: 0; 1qΦ – Cb
pCwq2
p̂ Cii
Cii
wJ Cw ´ Cii i
»
fi
pCwqi
J
η
θ
´
w
f
psq
´
i
1
η
Cii
? φp ? i : 0; 1qΦ – b
ppri |rD ă θq “
: 0; 1fl
pCwq2i
p1 ´ p̂q Cii
Cii
J
w Cw ´ Cii
From that the choice-triggered averages can be computed:
ż8
dri ppri |rD ą θq

a ż 8 ˆ ηi ˙ „
ηi
D
d ?
p fi psq ` ? |r ą θ
“ Cii
Cii
Cii
´8

xri y|rD ąθ “

´8

We can solve this integral using φ1 pxq “ ´xφpxq and the following auxiliary relationship:
ż8

ż8
dx xφpxqΦpax ´ bq “ ´φpxqΦpax ´ bq|8
`
a
dx φpxqφpax ´ bq
´8
´8
´8
„ 2

ż
x
pax ´ bq2
a 8
dx exp ´ ´
“
2π ´8
2
2
«
ˆ
˙2 ff
„

ż8
a
1 ` a2
ab
a 2 b2
b2
“
dx exp ´
x´
exp
´
2π ´8
2
1 ` a2
2p1 ` a2 q
2
c
„ ˆ
˙

1
a
a2
b2
?
“
exp ´ 1 ´
2
2π 1 ` a2
1`a
2

Defining
d
pCwqi
a“ a
“
J
Cii w Cw ´ pCwq2i
?
Cii rθ ´ wJ f psqs
b“ a
Cii wJ Cw ´ pCwq2i

„

pCwq2i
Cii wJ Cw

´1

´1

´1

ñ?

a
1 ` a2

pCwqi
“a
Cii wJ Cw

we find
c

xηi y|rD ąθ

„
ˆ
˙

1 1 pCwqi
1
pCwq2i
Cii rθ ´ wJ f psqs2
?
“
exp ´
1´
2π p̂ wJ Cw
2
Cii wJ Cw Cii wJ Cw ´ pCwq2i
c
„

1 1 pCwqi
1 rθ ´ wJ f psqs2
?
“
exp ´
2π p̂ wJ Cw
2
wJ Cw
c
"
*
1 1 pCwqi
1 “ ´1 ‰2
?
“
exp ´ Φ pp̂q
2π p̂ wJ Cw
2

5

and

Equivalently, we find:
ż8
d ηi ppri |rD ă θq

xηi y|rD ăθ “
´8

pCwqi
a “ ´a
J
Cii w Cw ´ pCwq2i
a
pCwqi
ñ?
“ ´a
1 ` a2
Cii wJ Cw
Cii rθ ´ wJ f psqs
b “ ´a
Cii wJ Cw ´ pCwq2i
c

„
ˆ
˙
1 1
pCwqi
1
pCwq2i
Cii rθ ´ wJ f psqs2
?
xηi y|rD ăθ “ ´
exp ´
1´
2π 1 ´ p̂ wJ Cw
2
Cii wJ Cw Cii wJ Cw ´ pCwq2i
c
"
*
‰2
1“
pCwqi
1 1
?
“´
exp ´ Φ´1 pp̂q
2π 1 ´ p̂ wJ Cw
2
Hence
∆choice r :“ xppri |rD ą θqy ´ xppri |rD ă θqy
c
*
"
1
Cw
1
1 “ ´1 ‰2
?
“
exp ´ Φ pp̂q
p̂ p1 ´ p̂q 2π wJ Cw
2

„ J
w f psq ´ θ
: 0; 1 .
with p̂ “ Φ ?
wJ Cw

6

