Impact of commuting on disease persistence in heterogeneous
metapopulations
G. Rozhnova1,2, A. Nunes1 , and A. J. McKane2

arXiv:1303.6103v2 [q-bio.PE] 20 Feb 2015

1

Centro de Fı́sica da Matéria Condensada and Departamento de Fı́sica, Faculdade de Ciências da
Universidade de Lisboa, P-1649-003 Lisboa Codex, Portugal
2
Theoretical Physics Division, School of Physics and Astronomy, University of Manchester,
Manchester M13 9PL, United Kingdom

Abstract

forcing and the system’s nonlinearities is nowadays reasonably well understood, setting the stage for the additional
layer of complexity that arises from demographic stochasticity [30, 5, 24].
Another key ingredient for population persistence is spatial structure and heterogeneity. Spatial structure was first
addressed using reaction-diffusion equations that successfully modelled the spread of the epizootic in animal borne
diseases [16]. In these models, inspired by physical systems,
the interactions are local and the population is distributed on
a plane. More recently, developments that explore the role
of individual mobility and long range interactions have come
up in the form of metapopulation models, where a number of
typically weakly interacting units represent well mixed homogeneous population patches [11, 13, 22, 23, 26, 1]. A long
standing idea associated with the concept of metapopulation
is that persistence is favoured in a fragmented population,
provided that movement between patches accompanies spatial dispersion [4, 14]. This idea has recently been shown to
be less straightforward than previously thought [12, 15].
Among many aspects treated in these studies on spatially
extended systems, the degree of synchrony of population
abundance oscillations has received special attention as it
has been considered the main determinant of persistence
[10, 3, 8]. With few exceptions associated with chaotic oscillations, it has been found that a small amount of coupling
between population patches is enough to induce synchrony
[6, 32, 9, 23]. Although they are usually called spatially
heterogeneous, the metapopulation models in these studies
assume the same, or very similar, parameter values for the
different population patches, and we will refer to them as
’uniform’, keeping the term ’heterogeneous’ for extended
systems that include significant parameter variation across
different patches. In line with available data for large urban
populations [32, 24], the synchronized oscillations in uniform systems are moreover found to be in phase between
patches, or, in the case of the 2-year cycle typical of measles,
in phase opposition. This is in contrast with the results for
heterogeneous systems, where synchronous states may correspond to intermediate phase lags [3, 28].
In this paper we present an extensive computational study

We use a stochastic metapopulation model to study the combined effects of seasonality and spatial heterogeneity on disease persistence. We find a pronounced effect of enhanced
persistence associated with strong heterogeneity, intermediate coupling strength and moderate seasonal forcing. Analytic calculations show that this effect is not related with the
phase lag between epidemic bursts in different patches, but
rather with the linear stability properties of the attractor that
describes the steady state of the system in the large population limit.

1 Introduction
Demographic stochasticity due to the probabilistic nature of
events such as births, deaths, mating and disease transmission, plays a major role in the dynamics of small populations. Its impact was acknowledged more than fifty years
ago by Bartlett [2], who introduced the concept of critical
community size. Originally defined as the population size
above which the expected time to fade out after an epidemic
exceeds a certain period, it is usually taken in more general terms as the threshold population for (a given definition
of) disease persistence. It became a central concept in epidemiology, much revisited in several attempts to provide less
arbitrary definitions and to reconcile theoretical estimates
with data [19, 25]. Threshold levels of host abundance are
equally important in ecology, a context in which the idea of
the stochastic Allee effect was introduced [21] to represent
demographic stochasticity.
The fact that many natural populations experience annual
abundance troughs establishes an obvious connection between average population size and extinction probability, on
one hand, and seasonality, on the other [33]. Indeed, the
annual and multiannual incidence patterns of many infectious diseases show that seasonality is a key ingredient in
the overall dynamics of these diseases. Despite the mathematical difficulties involved, theoretical studies have therefore tried to take seasonality into account ever since the earliest efforts [29]. The complex interplay between seasonal
1

interpreted as the overall fraction of time that an individual
from one city spends in the other city, averaged over all types
of stays with their typical frequencies and durations. In general, f should be taken class and city dependent (see SM),
but we will explore here only the simplest case.
The usual SIR rate of infection then becomes, for susceptible residents of city 1 while in city 1,

of the combined influence of seasonality and heterogeneity
on disease persistence. The basic unit of our model, which
we will call a ’city’, is formed by a number of individuals
undergoing well-mixed stochastic infection dynamics whose
parameters are specific to that city and may present seasonal
variation. The number of individuals that interact in this way
may comprise commuters from another city, as well as the
residents of that city. Disease persistence is measured over
sets of stochastic simulations of the model. We find that it
depends in a nonintuitive way both on the level of seasonality and on the magnitude of the flow of commuters, with
a pronounced enhancement of persistence induced by strong
heterogeneity at intermediate coupling strengths. We also
find that the epidemic phase lags generated by city heterogeneity have no significant effect on disease persistence.
For the unforced case, an analytic description of the incidence fluctuations based on van Kampen’s expansion was
shown to give good quantitative results for moderate system sizes [27, 28]. Using this approximation, summarized
in the Supplementary Material (SM), it can be seen that this
increase in persistence is instead related with the stability
properties of the attractor that describes the steady state of
the system in the large population limit.

β1 (1 − f )S1 [(1 − f )I1 + f I2 ] /M1 ,
where β1 is a parameter that reflects the urban characteristics
of city 1 through the rate of encounters they elicit, and M1 =
(1 − f )N1 + f N2 is the number of individuals present in
city 1 at any given time. The rate of infection of susceptible
residents of city 1 while in city 2 will be given by
β2 f S1 [(1 − f )I2 + f I1 ] /M2 ,
with M2 = (1 − f )N2 + f N1 . Similar expressions hold for
the rates of infections taking place in city 2.
Our mechanistic model thus leads to represent the interaction between population patches as a weighted distribution of their respective forces of infection. Along with
other metapopulation models based on a description of the
underlying mobility patterns [20, 17], it extends the traditional phenomenological modelling of interacting population
patches by means of a single coupling parameter [23], with
the important difference that the parameters βk are allowed
to differ from patch to patch, so that spatial heterogeneity
does not come from ’patchiness’ of the population only.
The parameter βk may be time dependent to represent seasonal variability of social intercourse, or of other ingredients
such as for instance weather conditions that influence the rate
of infectious contacts. We will consider a time dependence
of the form βk (t) = βk0 (1 + ǫ cos 2πt), where t is the time
measured in years and ǫ represents the amplitude of seasonal
forcing. More realistic forcing terms that include a representation of school term calendars are commonly found in the
literature on childhood infectious diseases (e.g. [19]), but
we expect the overall picture revealed by varying βk0 and ǫ to
be largely independent of the particular form of the periodic
forcing.
With these assumptions, the stochastic process is governed by the master equation for the time evolution of Pn (t),
the probability distribution for finding the system in state n
at time t [31]:

2 Methods
2.1 Model
In this section, we briefly present the metapopulation
susceptible-infectious-recovered (SIR) stochastic model introduced in [27, 28] to describe several interacting cities,
which are population patches where interactions between individuals are taken to be well mixed.
The SIR model consists of three classes of individuals:
susceptibles, infected and recovered. We denote their number among the residents of city k by Sk , Ik , Rk , respectively. These numbers change due to birth, death, infection
and recovery, which in the stochastic version of the model
are taken as stochastic events with certain rates. As usual
when working with time scales for which there are no major
demographic changes, we assume that the number of individuals that reside in city k, Nk , is fixed, so that Sk and
Ik together completely determine the state of city k. The
birth/death rate µ is taken to be constant, and infected individuals recover also at a constant rate γ. When a given disease spreads in a city, the rate of infection is proportional to
the number of encounters between susceptibles and infected
that take place in that city, which in turn, assuming that in the
city the population is well mixed, is proportional to the product of the number of susceptibles and the number of infected
in that city. Now these numbers should take into account
the flow of commuters from and to that city. In the simplest
version of the model, we will assume that the coupling between cities 1 and 2 may be described by a single parameter,
f , which is the fraction of the number of residents of each
class of city 1 (respectively, 2) that are present in city 2 (respectively, 1) at any given time. The parameter f must be

XX
dPn (t)
=
[Tα (n|n′ )Pn′ (t) − Tα (n′ |n)Pn (t)] ,
dt
′
α
n 6=n

(1)
where n denotes the state of the system given by the numbers
of infected and susceptibles in each city and Tα (n|n′ ), are
the (possibly time dependent) transition rates from the state
n′ to the state n that result from the birth-death, recovery
and infection processes. These rates are given explicitly in
the SM.
2

2.2 Theoretical Analysis and Simulations

−3

3

x 10

A deterministic description of the model leads to a set of orε = 0.12
dinary differential equations (ODEs) for the evolution of the
2
R0 = 18
fractions sk = Sk /Nk , ik = Ik /Nk of susceptible and ini(t)
fected individuals in each city. The behaviour of the stochasR0 = 15
biennial cycles
tic system approaches this description in the limit of infinite
1
population sizes where fluctuations can be neglected. Otherwise, for large but finite systems sk and ik will fluctuate
0
around the solutions of the deterministic ODEs. Using van
0
0.5
1
1.5
2
t (yr)
Kampen’s system size expansion [31], these fluctuations are
approximately described by Langevin equations, which for
two cities can be written in compact form as
Figure 2: Fraction of infected as a function of time on the
deterministic biennial attractor for the 1-city SIR model.
4
X
dzJ
=
JJK zK + ηJ (t), J = 1, ..., 4, (2)
dt
K=1

section by studying the stochastic SIR model in a single city.
The results are shown in Figure 1. For ǫ = 0, the AET
increases exponentially with R0 , but a more complex dependence on R0 is found when ǫ > 0. More specifically, for
ǫ = 0.05 the AET gets larger as we increase R0 from 12
to 17 where it attains a maximum. A further increase of R0
reduces the AET, which reaches a minimum at R0 ≈ 21 and
starts to increase again from then on. For stronger seasonality, ǫ = 0.12, the curve describing the dependence of the
AET on R0 has only one maximum at about R0 = 15. A
similar effect was found in [5] for the dependence of persistence on birth rate. The dependence of the AET on R0 is
even more pronounced for larger population sizes, while it
becomes less significant for smaller population sizes where
frequent extinctions dominate all regimes (see Section 4 of
Supplementary Material).
As in [24], a simple qualitative explanation of the behavior seen in Figure 1 can be given in terms of attractors of
the deterministic model and their stability properties. For
the unforced case, the attractor is a stable fixed point with
nonzero densities of susceptible and infective individuals.
As R0 increases, the infective density associated with this
attractor increases, as well as its stability. As a consequence,
in the stochastic model the relative amplitude of the oscillations of the number of infected around their average value
gets smaller, causing the AET to increase with R0 . In the
presence of seasonality, ǫ > 0, the attractors of the system
are limit cycles with periods multiples of 1 year. Depending
on the values of R0 , only annual or biennial cycles are observed in the parameter ranges we explored. Specifically, for
ǫ = 0.12 and R0 ∈ [12, 14.5] or R0 ∈ [15, 24], the cycles are
annual or biennial, respectively. The period doubling bifurcation occurs in the interval 14.5 ≤ R0 ≤ 15 that separates
the regions of increasing and decreasing extinction times. As
shown in Figure 2, the deterministic biennial cycle changes
with increasing R0 so that the infective density stays low for
a longer fraction of the period. Due to this, in the biennial
regime the AET decreases with R0 . In the annual regime,
the stability of the cycle and the infective density averaged
3 Results
over the cycle increase with R0 , explaining the increasing
To illustrate the nontrivial interplay between disease trans- AET for R0 ∈ [12, 14.5] as in the unforced case. A similar
missibility and amplitude of seasonal forcing we start in this analysis holds for ǫ = 0.05.

where z = (z1 , z2 , z3 , z4 ) = (x1 , x2 , y1 , y2 ), xk and yk are
the relative fluctuations of the number of susceptible and infected in city k, and ηJ (t) are zero mean Gaussian noise
terms. The derivation of these analytic approximations, as
well as explicit expressions for its coefficients and for the
noise correlation function, are given in the SM.
Neither the full stochastic system, Eq. (1), nor the deterministic ODEs can be solved analytically. The latter are
however amenable to qualitative analysis, which we will use,
together with numerical integration, to study their attractors
and their stability. As to the former, Eq. (2) can be used
to compute the state variables fluctuation power spectrum
and phase spectrum [28], which determine the amplification
(the overall power of the fluctuation spectrum), the coherence (the fraction of the total power in a small frequency
range around the dominant frequency), and the phase lag between cities. Details are given in the SM.
The simulations implement the stochastic process described in the preceding section on the state variables
(Sk , Ik ), using Gillespie’s algorithm adapted to account for
time dependent reaction rates [7]. We compute the average
extinction time (AET) for a metapopulation as the average
over 103 simulations of the time it takes for the system to
reach a state with no infectives, starting from different initial
conditions near the equilibrium of the deterministic counterpart of the model. The simulation time was taken long
enough for all runs to eventually become extinct.
The crucial epidemiological parameter R0 of the unforced
single city deterministic SIR model, the basic reproductive
ratio, is given by R0 = β/(γ + µ), where β is defined as
usual through the infection rate βSI in that isolated city. It is
well known that R0 = 1 is the critical value that separates the
trivial regime, where the disease dies out, from the endemic
regime, where the disease persists for ever. We will take R0 ,
ǫ and f as the free parameters in this study. The parameters
µ and γ are kept fixed at 1/50 yr and 1/13 d.

3

300

75

(a) ε = 0

30

(b) ε = 0.05

200

50

20

100

25

10

(c) ε = 0.12

AET (yr)

0
10

15

R

20

25

0
10

15

0

R0

20

0
10

25

15

R0

20

25

Figure 1: AET (measured in years) from simulations for the 1-city SIR model with N = 4×105 (results for other population
sizes are given in the SM, Figure S1). The arrows highlight the parameter regions where the attractor of the forced system
changes from annual to biennial (black and red arrows), and from biennial to annual (grey arrow).

50.%

(a) AET, ε = 0

300

(b) AET, ε = 0.05

18.%
6.3%
f

100

(c) AET, ε = 0.12
15

75

200

2.2%

10

50

0.8%

100

0.3%
0.1%

0

50.% (d) coherence, ε = 0
18.%

0.6

(e) amplification, ε =0

25

5

0

0

0.16

(f) phase lag, ε = 0

π
3

6.3%
f

0.5

2.2%

0.12

π
6

0.8%
0.4

0.3%

0.08

0.1%
0 1 2 3 4 5 6
δ, R01 = 18+δ, R02 = 18−δ

0 1 2 3 4 5 6
δ, R01 = 18+δ, R02 = 18−δ

0 1 2 3 4 5 6
δ, R01 = 18+δ, R02 = 18−δ

0

Figure 3: Results for the 2-city SIR model with N1 = N2 = 2 × 105 . In all panels, the x-axis represents the heterogeneity
in terms of δ = (R01 − R02 )/2 and the why axis the coupling in terms of f . (a)-(c) AET (measured in years) as a function
of the heterogeneity parameter δ and the coupling coefficient f obtained from simulations for different levels of seasonality
ǫ (notice the logarithmic scale in the f axis). (d)-(f) Analytical results for the amplification and coherence in one of the
cities (similar results for the other city are shown in the SM, Figure S2) and phase lag between cities for ǫ = 0.

4

800
f = 0.1%, ε = 0

weekly cases

R01 = 24
600

R

02

R

= 24

R

= 12

01

= 12

02

f = 0.8%, ε = 0

400
200
0
0

20

40

60

80

100 0

20

40

year

60

80

100

year

Figure 4: Typical time series of new disease cases per week for the 2-city SIR model with N1 = N2 = 2 × 105 and ǫ = 0.

50.%

(a) AET, ε = 0

400

(b) AET, ε = 0.05

18.%
6.3%
f

2.2%
0.8%
0.3%
0.1%

125
100

300

20

75

15

50

10

25

5

0
0 1 2 3 4 5 6
δ, R01 = 18+δ, R02,03,04 = 18−δ

0
0 1 2 3 4 5 6
δ, R01 = 18+δ, R02,03,04 = 18−δ

200
100
0
0 1 2 3 4 5 6
δ, R01 = 18+δ, R02,03,04 = 18−δ

(c) AET, ε = 0.12

Figure 5: AET (measured in years) from simulations for the 4-city SIR model in which a central city with N1 = 2.1 × 105
is surrounded by 3 non-interacting satellite cities with N2 = N3 = N4 = N1 /3. Fraction of commuters from each of the
suburban cities to the central city, f , is 10 times larger than that from the central city to that suburban city. In all panels, the
x-axis represents the heterogeneity in terms of δ = (R01 − R02 )/2. Analytical results for the amplification, coherence and
phase lag of the fluctuations are given in the SM, Figure S3.
δ is weak, with only a slight increase in persistence for small
coupling strengths, independently of heterogeneity. This is
in line with results reported in the literature for uniform systems [14], and can be understood as temporal heterogeneity
superseding spatial heterogeneity for this level of seasonality, bringing the system close to extinction for a large part of
the year.

We now explore the situation where different population
patches represent very different urban environments, as may
be the case of an active city centre and its suburban satellite
towns. We will therefore consider our model for two cities
with different values of R0 , taking for simplicity equal population sizes and the symmetric coupling described in Section 2.1. The two values R01 and R02 that characterize SIR
dynamics in each patch are given in terms of a single parameter δ as 18 ± δ, thus ensuring that the average disease
infectiousness is kept constant as the spatial heterogeneity
increases with δ. The qualitative results are independent of
this assumption (results not shown), which however reduces
the number of free parameters and is consistent with the fact
that estimates of R0 come from coarse grained data. We will
study the three levels of seasonality ǫ = 0, 0.05, 0.12 considered in the study of one city, and the free parameters for
each value of ǫ are δ and the coupling strength f , the latter
ranging from f = 0 to the maximum meaningful value of
f = 1/2.

The picture that emerges for ǫ = 0 and ǫ = 0.05 is significantly different. Extinction events are rare, and when spatial
heterogeneity, measured by δ, is small, the AET increases
with the coupling strength f . This is to be expected, because disease that goes extinct in one of the identical patches
is more likely to be reignited by surviving infectives in the
other patch as f increases. More surprisingly, a second and
dominant effect of persistence enhancement shows up for intermediate coupling strengths when the degree of spatial heterogeneity is high.

In order to understand the causes of this remarkable increase in persistence, we have analyzed the amplification,
The results found for the AET (measured in years) are the coherence and the phase difference for ǫ = 0 and all
shown in Figure 3, top row. For the highest level of forcing, the parameter values used to compute the AETs. We have
ǫ = 0.12, AETs are very short and the dependence on f and used the analytic approximations derived in the SM, which
5

for the population sizes under consideration provide very
good quantitative agreement with simulations. The results
are shown in Figure 3, bottom row. In the left and middle
panels, it can be seen that the enhanced persistence effect is
associated with a reduction of the overall power of the infective number fluctuations and, more evidently, with a pronounced reduction of their coherence. In the right panel, we
see that the phase lag between patches introduced by spatial
heterogeneity, which would seem a good candidate to explain the observed effect, has no significant bearing on persistence.
In Figure 4 we plot two typical time series taken for δ = 6
and values of f that correspond to extreme values of amplification and coherence in Figure 3. These plots illustrate how
the amplification and coherence measures translate into the
amplitude and structure of the fluctuations of the infective
time series, and therefore into persistence as well. It can be
seen that in the right panel the overall amplification is more
evenly distributed over frequencies, so that large amplitude
fluctuations are absent and local persistence is increased. Using the theory developed in [28], we show in the SM how
this effect is associated with the dependence on f and δ of
the real part of one of the eigenvalue pairs of the linear approximation of the deterministic system at the endemic equilibrium.
Finally, in Figure 5 we show a plot of AETs similar to
that of Figure 3, but in this case for a configuration of four
population patches, one central city connected to three noninteracting satellite suburban areas with equal population
sizes. The results shown correspond to the central city and
to one of the suburban areas for the case when the fraction
of commuters from each of the suburban cities to the central
city, f , is 10 times larger than that from the central city to
that suburban city. Both the phenomenological description
and the theoretical interpretation given above for two cities
hold in this case as well. The overall larger AETs in this
case are due to the assymetric coupling, which increases the
effective population size of the central city.

overall power, the coherence, that measures their regularity,
and the phase lag between cities. These were computed for
the unforced system using an analytic approximation developed in [28].
In contrast with spatially structured systems formed by
similar patches [23], the inherent heterogeneity of the model
has been shown to induce well defined phase lags in the epidemic bursts that take place in different patches [28], suggesting a simple mechanism through which heterogeneity
might contribute to an increase in disease persistence. Indeed, in-phase abundance oscillations in different patches
are often associated with global extinction [10, 3, 8].
However, we have found no clear evidence of such relation. This negative result can be understood because epidemic bursts come in short spikes, after which the system
remains for a relatively long time close to extinction. The
overall duration of the regime characterized by very low population numbers in two interacting patches is only slightly reduced by the phase lag. We speculate that in systems where
the population fluctuations are smoother a relation between
persistence and the phase lags due to spatial heterogeneity
would be apparent.
We find instead a remarkable effect of enhanced persistence associated with strong spatial heterogeneity, intermediate coupling strength and moderate seasonal forcing. We
should point out that the figures illustrating this effect are
shown in logarithmic scale for the coupling strength f , and
that therefore the range of values of f that produce enhanced
persistence is quite small. For these values however the extinction times raise very significantly, both for the unforced
and the seasonally forced system, provided the forcing amplitude is not too large.
Enhanced persistence for intermediate coupling strengths
has been reported for uniform metapopulation models [18,
15]. In these systems, the parameter values are the same in
different patches, and spatial heterogeneity, instead of being
built in the model, shows up only when the coupling strength
is small enough for the dynamics in different patches to be
practically uncorrelated. The increase of persistence at intermediate coupling expresses the trade-off between heterogeneity due to patch structure, which is lost at high coupling,
and rescue events, which become negligible at low coupling.
One may try to carry this simple explanation over to the
two patch model considered here. When the parameter values are similar in the two patches, the AET increases with the
coupling strength and there is no phase lag between patches,
suggesting that rescue effects are dominant in this regime.
For highly heterogeneous patches, a phase lag shows up that
decreases with coupling strength, while the number of rescue events increases, and the balance of these effects would
explain the increase of persistence at intermediate coupling.
In this interpretation, the increase in persistence is a consequence of the patch structure, and not of a change in the
properties of the fluctuations in each patch. However, comparison of the AETs with the properties of the fluctuation
spectrum shows that, for the unforced system, enhanced
global persistence is associated with a decrease in the coher-

4 Discussion
Using a stochastic SIR metapopulation model with one population patch connected to one or several non-interacting
patches, we have explored the combined effects on disease
persistence of seasonality and spatial heterogeneity. The
parameters in this analysis are the level of seasonality, the
strength of the coupling, and the degree of heterogeneity
measured by the difference between patches in the rates of
potentially infectious contacts. We have considered only the
simplest metapopulation structures and couplings. Results
in more general settings (not shown) indicate that the effects
described in this paper are robust with respect to different
choices of these interaction parameters, and also to changes
in the average R0 . In order to understand the mechanisms at
play, we have compared for a large set of parameter choices
the AETs found in the simulations with three main properties
of the infective fluctuations: the amplitude, that measures the
6

ence of the fluctuations in both patches and therefore with
enhanced local persistence. As detailed in the SM, the analytic approximation can be used to show that this effect is
related with an increase in the stability of the attractor that
describes the system for very large population sizes. This
analysis was carried out for the unforced case only, but we
found the effect of enhanced persistence to be relatively insensitive to seasonal forcing, provided the forcing amplitude
is not so strong that it drives the system close to extinction
for a large period of the year [8]. We conclude that the effect
of enhanced persistence documented here has to be traced
back to the dependence of the stability of the attractor of the
system on the coupling strength. Rather than being the result of rescue effects between population patches, it reflects
an increase in local persistence induced by the coupling.

[11] B. T. Grenfell and J. Harwood. (Meta)population dynamics of infectious diseases. TREE, 12:395–399,
1997.
[12] T. J. Hagenaars, C. A. Donnelly, and N. M. Ferguson.
Spatial heterogeneity and the persistence of infectious
diseases. J. Theor. Biol., 229:349–359, 2004.
[13] I. Hanski. Metapopulation dynamics. Nature, 396:41–
49, 1998.
[14] I. Hanski. Metapopulation Ecology. Oxford University
Press, Oxford, 1999.
[15] M. Jesse and H. Heesterbeek. Divide and conquer?
Persistence of infectious agents in spatial metapopulations of hosts. J. Theor. Biol., 275:12–20, 2011.

Financial support from the Portuguese Foundation for Science
and Technology (FCT) under Contracts POCTI/ISFL/2/261 and
(G.R.) SFRH/BPD/69137/2010 is gratefully acknowledged.

[16] A. Källén, P. Arcuri, and J. D. Murray J. A simple
model for the spatial spread and control of rabies. J.
Theor. Biol., 116:377–393, 1985.

References

[17] M. J. Keeling, L. Danon, M. C. Vernon, and T. A.
House. Individual identity and movement networks for
[1] D. Balcan, V. Colizza, B. Goncalves, H. Hu, J. J. Ramdisease metapopulations. Proc. Natl. Acad. Sci. USA,
asco, and A. Vespignani. Multiscale mobility networks
107:8866–8870, 2010.
and the spatial spreading of infectious diseases. Proc.
Natl. Acad. Sci. USA, 106:21484–21489, 2009.
[18] M. J. Keeling
Metapopulation moments: Coupling,
stochasticity
and persistence. J. Anim. Ecol.,
[2] M. S. Bartlett. Measles periodicity and community
69:725736,
2000.
size. J. R. Stat. Soc. A, 120:48–70, 1957.

[3] B. Blasius, A. Huppert, and L. Stone. Complex dy- [19] M. J. Keeling and B. T. Grenfell. Understanding the
namics and phase synchronization in spatially extended
persistence of measles: reconciling theory, simulation
and observation. Proc. R. Soc. B, 269:335–343, 2002.
ecological systems. Nature, 399:354–359, 1999.
[4] B. Bolker and B. T. Grenfell. Space, persistence and [20] M. J. Keeling and P. Rohani. Estimating spatial coudynamics of measles epidemics. Phil. Trans. R. Soc. B,
pling in epidemiological systems: a mechanistic ap348:309–320, 1995.
proach. Ecol. Lett., 5:20–29, 2002.
[5] A. J. K. Conlan and B. T. Grenfell. Seasonality and the
persistence and invasion of measles. Proc. R. Soc. B,
274:1133–1141, 2007.

[21] R. Lande. Demographic stochasticity and Allee effect
on a scale with isotropic noise. Oikos, 83:353–358,
1998.

[6] D. J. D. Earn, P. Rohani, and B. T. Grenfell. Persis[22] R. Levins. Some demographic and genetic consetence, chaos and synchrony in ecology and epidemiolquences of environmental heterogeneity for biological
ogy. Proc. R. Soc. B, 265:7–10, 1998.
control. Bull. Entom. Soc. Am., 15:237–240, 1969.
[7] D. Gillespie. A general method for numerically simu[23] A. L. Lloyd and R. M. May. Spatial heterogeneity in
lating the stochastic time evolution of coupled chemical
epidemic models. J. Theor. Biol., 179:1–11, 1996.
reactions. J. Comp. Phys., 22:403–434, 1976.
[8] N. C. Grassly and C. Fraser. Seasonal infectious dis- [24] N. B. Mantilla-Beniers, O. N. Bjørnstad, B. T. Grenfell, and P. Rohani. Decreasing stochasticity through
ease epidemiology. Proc. R. Soc. B, 273:2541–2550,
enhanced seasonality in measles epidemics. J. R. Soc.
2006.
Interface, 7:727–739, 2010.
[9] B. T. Grenfell, O. N. Bjørnstad, and J. Kappey. Travelling waves and spatial hierarchies in measles epi- [25] I. Nåsell. A new look at the critical community size for
childhood infections. Theor. Pop. Biol., 67:203–216,
demics. Nature, 414:716–723, 2001.
2004.
[10] B. T. Grenfell, B. M. Bolker, and A. Kleczkowski.
Seasonality and extinction in chaotic metapopulations. [26] S. Riley. Large-scale spatial-transmission models of
Proc. R. Soc. B, 259:97–103, 1995.
infectious disease. Science, 316:1298–1301, 2007.
7

[27] G. Rozhnova, A. Nunes, and A. J. McKane. Stochastic oscillations in models of epidemics on a network of
cities. Phys. Rev. E, 84:051919, 2011.
[28] G. Rozhnova, A. Nunes, and A. J. McKane. Phase
lag in epidemics on a network of cities. Phys. Rev. E,
85:051912, 2012.
[29] H. E. Soper. The interpretation of periodicity in disease
prevalence. J. R. Stat. Soc. A, 92:34–61, 1929.
[30] L. Stone, R. Olinky, and A. Huppert. Seasonal dynamics of recurrent epidemics. Nature, 446:533–536, 2007.
[31] N. G. van Kampen. Stochastic Processes in Physics
and Chemistry. Elsevier, Amsterdam, 1981.
[32] C. Viboud, O. N. Bjørnstad, D. L. Smith, L. Simonsen,
M. A. Miller, and B. T. Grenfell. Synchrony, waves,
and spatial hierarchies in the spread of influenza. Science, 312:447–451, 2006.
[33] J. A. Yorke, N. Nathanson, G. Pianigiani, and J. Martin. Seasonality and the requirements for perpetuation
and eradication of viruses in populations. Am. J. Epidemiol., 109:103–123, 1979.

8

Supplementary Material
Impact of commuting on disease persistence in heterogeneous
metapopulations

arXiv:1303.6103v2 [q-bio.PE] 20 Feb 2015

G. Rozhnova, A. Nunes and A. J. McKane
In this supplementary material we will specify the model we are studying and outline
the methods we use to study it. In the final section we will also give some additional
results. Our aim in the first three sections is to give a non-technical introduction to the
methods we use; technical descriptions already exist in several of our published papers
[1-4]. In addition, [5] gives a non-technical review of stochastic modelling and [6] a more
mathematical treatment of the same topic. We will explain the formalism in detail for
the usual (one-city) model in such a way that the generalisation to two, or n, cities is
straightforward.

1
1.1

The Stochastic SIR model
Formulation of the individual-based model and the master
equation

We begin with the simple SIR model — or in the context of this paper, the one-city SIR
model. We define it in terms of “reactions” between the N constituents of the system,
which in this case are N individuals which are either of type S (susceptible), type I
(infected) or type R (recovered). These individuals are born and die at the same rate,
and in addition these events are linked, so that the total population N remains constant.
Thus instead of having distinct birth and death events, only combined birth/death events
occur. Since all newly-born individuals are susceptible, these events correspond to an
infected individual being replaced by a susceptible individual or a recovered individual
being replaced by a susceptible individual. A susceptible individual dying results in no
change in the state of the system, since they are simply replaced by another susceptible
individual.
The reactions that define the one-city SIR model are then:
1.
2.
3.
4.

Infection
Recovery
Birth/death
Birth/death

S+I
I
I
R

β

−→
γ
−→
µ
−→
µ
−→

I +I
R
S
S.

(1)

Here β, γ and µ are respectively the rate of infection, the rate of recovery and the rate of
birth/death. The reactions will be labelled by α (= 1, 2, 3, 4).
Frequently, birth and death processes are assumed to happen at the same rate, but
remain as distinct events. This still results in fluctuations in the total population size,
even if the average population size remains constant. By linking these events at the
stochastic level, the population size remains constant at any system size, so that we can
still eliminate the variable relating to recovered individuals: R = N − I − S. This means
that there are only two variables which define the state of the system: the number of
1

susceptible individuals at a given time which we will denote by S and the number of
infected individuals at a given time which we will denote by I. The use of the same
symbol for an individual of a particular type and the number of individuals of that type
should cause no confusion. The general state will then be denoted by n = (S, I).
The four processes (1) in the SIR model which cause transitions to a new state have
the following transition rates:
1.
2.
3.
4.

Infection
T1 (S − 1, I + 1|S, I)
Recovery
T2 (S, I − 1|S, I)
Birth/death T3 (S + 1, I − 1|S, I)
Birth/death
T4 (S + 1, I|S, I)

=
=
=
=

βSI/N
γI
µI
µ (N − S − I) .

(2)

We use the convention whereby the initial state is on the right and the final state is on
the left, so that T (n|n′ ) represents the transition rate from n′ to n.
The transition rates (2) define the individual-based SIR model, and when substituted
in the master equation (Eq. (1) of the main text), give an equation for the probability,
Pn (t), of finding the system in the state n at time t. Since the master equation can only
be solved for very simple linear systems, we require an approximation scheme to make
progress. Before we discuss this, we first derive the macroscopic description of the SIR
model (in the form of differential equations) from the master equation.
To do this it is useful to write the master equation in a slightly different form, by
introducing the stoichiometric coefficients να , for reaction α. They indicate by how much
S or I increase or decrease in a given reaction, that is, n = n′ + να . So for instance in
(1)
(2)
reaction 1, the components of ν1 are ν1 = −1, ν1 = +1, and for reaction 2 we have
(1)
(2)
ν2 = 0, ν2 = −1, and so on. Here the superscript (1) refers to S and (2) to I. Then
the master equation can be written as
M

dPn (t) X
=
[Tα (n|n − να )Pn−να (t) − Tα (n + να |n)Pn (t)] ,
dt
α=1

(3)

where in this case M = 4.

1.2

The macroscopic equation

The macroscopic equation is found by multiplying Eq. (3) by n, and summing over all
possible values of n. After making the change of variable n → n + να in the first
summation, one finds that
M


dhn(t)i X 

=
να Tα (n + να |n) ,
dt
α=1
where the angle brackets define the expectation value:
X
h· · · i =
(· · · )Pn (t) .

(4)

(5)

n

The first approximation we will make (which is exact in the limit N → ∞) is to
label the states of the system by the fraction of the population which are susceptible and
infected, rather than the numbers of susceptible and infected individuals. In other words,
2

we will use s = S/N and i = I/N (in the limit N → ∞) rather than S and I, and treat
these as continuous variables. This is the sometimes called the diffusion approximation.
So the state of the system will be determined by the new variables
hni
.
N →∞ N

φ = (s, i) = lim
Dividing Eq. (4) by N, we have that
M

dφ X
=
να gα (φ),
dt
α=1

(6)

where the function gα (φ) is defined by limN →∞ N −1 hTα (n + να |n)i.
Equation (6) is the usual deterministic (macroscopic) equation for the SIR model, and
specifies how the mean fraction of susceptible and infected individuals changes with time.
To write it in a more familiar form, we first note that in the limit N → ∞ the system
is deterministic, and so the variance (and higher cumulants) of n are zero. This implies
that

lim N −1 hTα (n + να |n)i = lim N −1 Tα hni + να |hni .
N →∞

N →∞

The mean value hni can now simply be replaced by Nφ, leading to the identification:
gα (φ) = lim N −1 Tα (Nφ + να |Nφ) .
N →∞

(7)

For example, from Eq. (2), T1 (S − 1, I + 1|S, I) = βSI/N, and so g1 = limN →∞ N −1 T1 =
βsi. This leads to the following characterisation of the reactions — which is the only
information we require for specifying both the deterministic and stochastic dynamics of
the system:
1.
2.
3.
4.

Infection
Recovery
Birth/death
Birth/death

(1)

ν1
(1)
ν2
(1)
ν3
(1)
ν4

= −1,
= 0,
= +1,
= +1,

We define
A(φ) =

(2)

ν1 = +1
(2)
ν2 = −1
(2)
ν3 = −1
(2)
ν4 = 0
M
X

g1
g2
g3
g4

= βsi
= γi
= µi
= µ (1 − s − i) .

να gα (φ),

(8)

(9)

α=1

so that the macroscopic equation (6) is

dφ
= A(φ).
dt

(10)

Writing this in terms of the components of φ = (s, i) we find, using Eq. (8), the well-known
equations for the deterministic SIR model:
ds
= −βsi + µi + µ (1 − s − i) ,
dt
di
= +βsi − γi − µi.
dt
3

(11)

As is also well-known these equations have two fixed points: one where there are no
infected individuals in the population, that is, (s∗ , i∗ ) = (1, 0), and the one which is of
most interest:
γ+µ
µ [β − (γ + µ)]
s∗ =
, i∗ =
.
(12)
β
β(γ + µ)
In the above the asterisk denotes a fixed point of the differential equations.

1.3

The stochastic equation

A question of immediate interest which can be answered from the deterministic equation
(11) is the long term behaviour of the model, which involves finding the stability of the
fixed points. We carry out this analysis in the usual way, by linearising the equations (11)
about the fixed point. That is, we substitute
y
i = i∗ + √ ,
N

x
s = s∗ + √ ,
N

(13)

into the equations (11), keeping only linear terms in either x or y. This leads to the
equations
dx
= J11 x + J12 y,
dt
dy
= J12 x + J22 y,
dt

(14)

where the Jacobian J is evaluated at the non-trivial fixed point

!  − βµ
−(γ + µ)
−βi∗ − µ
−βs∗
γ+µ
.
J =
=
∗
∗
[β−(γ+µ)]
βi
βs − (γ + µ)
0

(15)

β

The eigenvalues of this matrix have a negative real part, and are in fact a complex
conjugate pair for all realistic values of the rates β, γ and µ. Thus this fixed point is
stable and small perturbations undergo damped oscillations towards (s∗ , i∗ ).
The stochastic version of the model can now be easily written down. We will only
be interested in fluctuations about the stationary state of system, that is, about the
fixed point (12). Furthermore we will only investigate linear fluctuations, since numerous
studies have shown that this captures the actual dynamics very well indeed. This is
known as the linear noise approximation (LNA) or the next-to-leading order in the van
Kampen system-size expansion. It consists of implementing the expansion (13) but on
the master equation, not on the deterministic equations. The latter calculation, described
above, amounted to an analysis of what happened to a single small perturbation to the
deterministic dynamics. The linearisation carried out on the master equation, in contrast,
results in extra “noise” terms which are added to (14) and which continuously modify the
(stochastic) perturbation. In this context the factors of N −1/2 in the linearisation (13) are
important; they encode the fact that fluctuations will naively be of this order, and so pick
out the linear correction in the expansion procedure. The N −1/2 factors were included
in the linear stability analysis of the deterministic equation to highlight the connection
with the LNA, but clearly have no effect on Eq. (14), since any factor multiplying the
perturbation will cancel out in this linear equation.
4

We will not carry out the calculations leading to the equations describing the stochastic
fluctuations about the fixed point, since they have already appeared several times in the
literature in various forms. The equations are
dx
= J11 x + J12 y + η1 (t),
dt
dy
= J12 x + J22 y + η2 (t),
dt

(16)

where η1 (t) and η2 (t) are noises with a Gaussian distribution and zero mean, and with a
correlation function given by
hηJ (t)ηK (t′ )i = BJK δ(t − t′ ).

(17)

Here BJK is given by
BJK (φ) =

M
X

να(J) να(K) gα (φ),

J, K = 1, 2,

(18)

α=1

evaluated at the fixed point (12). Using Eqs. (8) and (12) one finds that


µ(γ+2µ) [β−(γ+µ)]
2µ [β−(γ+µ)]
!
−
βs∗ i∗ + µ(1 − s∗ )
−βs∗ i∗ − µi∗
β
β(γ+µ)


B=
=
.
µ(γ+2µ) [β−(γ+µ)]
2µ [β−(γ+µ)]
−βs∗ i∗ − µi∗
βs∗ i∗ + (γ + µ)i∗
−
β(γ+µ)
β
(19)
Equations (16), (17) and (19) completely specify the stochastic fluctuations about the
deterministic SIR model.
To analyse the stochastic differential equations (16) further it is convenient to take
their Fourier transforms and introduce
Z ∞
Z ∞
iωt
x̃(ω) =
e x(t) dt, ỹ(ω) =
eiωt y(t) dt.
(20)
−∞

−∞

The lower limit of the integration comes from the fact that to ensure that the system is
in a stationary state, the initial conditions have to be set in the infinitely distant past.
Since the Fourier transform of dx/dt is −iω x̃, one finds that
[−iω − J11 ] x̃(ω) − J12 ỹ(ω) = η̃1 (ω),
−J21 x̃(ω) + [−iω − J22 ] ỹ(ω) = η̃2 (ω).

(21)

Defining the matrix −iωδJK − JJK to be ΦJK (ω), Eq. (21) may be written in the more
P
concise form 2K=1 ΦJK (ω)z̃K (ω) = η̃J (ω), where z1 ≡ x and z2 ≡ y. This may be solved
to yield
2
X
z̃J (ω) =
Φ−1
(22)
JK (ω)η̃K (ω),
K=1

where Φ−1 is the inverse of the matrix Φ.

5

The nature of the stochastic fluctuations can usefully be investigated by calculating
the power spectrum defined by
2 X
2


 X

2
† −1
PJ (ω) ≡ |z̃J (ω)| =
Φ−1
JK (ω)BKL Φ LJ (ω),

(23)

K=1 L=1

where Φ† is the Hermitian conjugate of the matrix Φ. Examples of power spectra from
a number of models are given in [1-4]. To characterise different spectra we use two
measures. The amplification is defined as the overall power of the fluctuation spectrum.
The coherence is the fraction of the total power in a 10% frequency range around the
dominant frequency of the spectrum.
The explicit form of the denominator in Eq. (23) is |detΦ(ω)|2 . From this we can
deduce that a pair of complex conjugate eigenvalues of J with small real parts will give
rise to a peak in the power spectrum, whose location in frequency is determined by
the imaginary parts [3]. The file ESM.mov included as Supplementary Material shows
how the persistence enhancement effect discussed in the main text is associated with the
dependence of one such pair of eigenvalues of J on the parameters of the system.

2

The Two-City Stochastic SIR model

Having discussed in detail the formalism and general procedure in the one-city case in a
way that naturally generalises, the description of the two-city case can be more concise.
What is novel is the nature of the interactions between the two cities, which is what we
discuss first of all.

2.1

Form of the interaction between the two cities

The interaction between the two cities is only reflected in the first type of reaction in
Eq. (1); the other three remain essentially unchanged since they involve only one individual, and so only one city.
The number of individuals in the three classes belonging to city j (j = 1, 2) will be
denoted by Sj , Ij and Rj respectively. We again assume that births and deaths are coupled
at the individual level, so that when an individual dies another (susceptible) individual
is born. Therefore the number of recovered individuals is not an independent variable:
Rj = Nj − Sj − Ij , where j = 1, 2. Since we do not focus on specific individuals, we
will not be concerned with the precise movements of commuters between the cities —
the frequency or duration of their commute — but only the fraction of the population
which is away from its home city at any given time. For commuters from city j to city k
we will denote this fraction by fkj . It follows that the number of individuals in city 1 is
M1 = (1 − f21 )N1 + f12 N2 and in city 2 is M2 = (1 − f12 )N2 + f21 N1 .
We will assume that the birth/death rate and the recovery rate are the same in both
cities, but that the infection rates are city dependent: β1 in city 1 and β2 in city 2. When
including seasonal forcing, as we are in this study, the infection rates are time-dependent:
βj (t) = βj0 (1 + ǫ cos 2πt), where the time t is measured in years and ǫ represents the
amplitude of the seasonal forcing.
There are four different types of infection events.
(i) Infective residents of one city (say j) can infect susceptible residents of the same
city. The rate for this to occur is βj (1 − fkj ) Sj (1 − fkj ) Ij /Mj .
6

(ii) Infective commuters can travel from city k to city j and infect susceptible residents
in their home city j. The rate for this to occur is βj (1 − fkj ) Sj fjk Ik /Mj .
(iii) Infective residents in their home city (say k) can infect susceptible commuters from
the other city (j). The rate for this to occur is βk fkj Sj (1 − fjk ) Ik /Mk .
(iv) Infective commuters can infect susceptible commuters away from their home city of
j. The rate for this to occur is βk fkj Sj fkj Ij /Mk .
Adding these rates together we obtain the total transition rate for infection of Sj
individuals as
Sj I k
Sj I j
+ βjk
,
(24)
βjj
Nj
Nk
where
βjj =

2
Nj
βj (1 − fkj )2 Nj βk fkj
+
,
Mj
Mk

βjk =

βj (1 − fkj ) fjk Nk βk fkj (1 − fjk ) Nk
+
. (25)
Mj
Mk

Equation (24) gives us the generalisation of the infection rate to the two-city case.
There are now eight processes rather than the four processes (1) of the one-city SIR
model which cause transitions from one state to another. They are
1. Infection of S1

T1 (S1 − 1, I1 + 1|S1 , I1 ) = β11 SN1 I11 + β12 SN1 I22

2. Infection of S2

T2 (S2 − 1, I2 + 1|S2 , I2 ) = β21 SN2 I11 + β22 SN2 I22

3. Recovery of I1

T3 (S1 , I1 − 1|S1 , I1 ) = γI1

4. Recovery of I2

T4 (S2 , I2 − 1|S2 , I2 ) = γI2

(26)

5. Birth/death in city 1 T5 (S1 + 1, I1 − 1|S1 , I1 ) = µI1
6. Birth/death in city 2 T6 (S2 + 1, I2 − 1|S2 , I2 ) = µI2
7. Birth/death in city 1

T7 (S1 + 1, I1|S1 , I1 ) = µ(N1 − S1 − I1 )

8. Birth/death in city 2

T8 (S2 + 1, I2|S2 , I2 ) = µ(N2 − S2 − I2 ).

Note that we have not listed all the state variables as arguments of the transition rates
Tα (· · · | · · · ) — only those which are most relevant to the reaction under consideration.
We may now set up the master equation in the same way as for the one-city case.
Introducing n = (S1 , S2 , I1 , I2 ), the master equation takes the form (3) where now M = 8,
and the reactions with the transition rates are given by Eq. (26). The variables relevant
for the deterministic and stochastic equations are sj = Sj /Nj and ij = Ij /Nj (j = 1, 2),
with φ = (s1 , s2 , i1 , i2 ). The analogue of Eq. (8) for two cities (although now with only

7

the non-zero stoichiometric coefficients listed) is
1.
2.
3.
4.
5.
6.
7.
8.

2.2

Infection of S1
Infection of S2
Recovery of I1
Recovery of I2
Birth/death in
Birth/death in
Birth/death in
Birth/death in

(1)

city
city
city
city

1
2
1
2

(3)

ν1 = −1, ν1
(2)
(4)
ν2 = −1, ν2
(3)
ν3
(4)
ν4
(1)
(3)
ν5 = +1, ν5
(2)
(4)
ν6 = +1, ν6
(1)
ν7
(2)
ν8

= +1
= +1
= −1
= −1
= −1
= −1
= +1
= +1

g1
g2
g3
g4
g5
g6
g7
g8

= β11 s1 i1 + β12 s1 i2
= β21 s2 i1 + β22 s2 i2
= γi1
= γi2
= µi1
= µi2
= µ(1 − s1 − i1 )
= µ(1 − s2 − i2 ).

(27)

The macroscopic and stochastic equations

The information given in Eq. (27) is again sufficient to completely specify both the macroscopic and stochastic equations.
The macroscopic equation (10), where A(φ) is defined by Eq. (9), when written down
in terms of the components of φ = (s1 , s2 , ii , i2 ), is
ds1
dt
ds2
dt
di1
dt
di2
dt

= −β11 s1 i1 − β12 s1 i2 + µi1 + µ (1 − s1 − i1 ) ,
= −β21 s2 i1 − β22 s2 i2 + µi2 + µ (1 − s2 − i2 ) ,
= +β11 s1 i1 + β12 s1 i2 − γi1 − µi1 ,
= +β21 s2 i1 + β22 s2 i2 − γi2 − µi2 .

(28)

It is known for two cities (and also for n cities) that a unique non-trivial fixed point
exists which is globally stable. The Jacobian evaluated at this fixed point is





J =




−β11 i∗1 − β12 i∗2 − µ

0

−β11 s∗1

−β12 s∗1

0

−β21 i∗1 − β22 i∗2 − µ

−β21 s∗2

−β22 s∗2

β11 i∗1 + β12 i∗2

0

β11 s∗1 − (γ + µ)

β12 s∗1

0

β21 i∗1 + β22 i∗2

β21 s∗2

β22 s∗2 − (γ + µ)






.




(29)

The stochastic fluctuations about the fixed point are obtained through a generalisation
of Eq. (13):
xj
yj
sj = s∗j + p , ij = i∗j + p , j = 1, 2,
(30)
Nj
Nj

8

and keeping only linear terms in either x or y. This leads to the equations
dx1
dt
dx2
dt
dy1
dt
dy2
dt

= J11 x1 + J12 x2 + J13 y1 + J14 y2 + η1 (t),
= J21 x1 + J32 x2 + J23 y1 + J24 y2 + η2 (t),
= J31 x1 + J32 x2 + J33 y1 + J34 y2 + η3 (t),
= J41 x1 + J42 x2 + J43 y1 + J44 y2 + η4 (t),

(31)

which may be written in a more compact form by introducing the vector of fluctuations
z = (x1 , x2 , y1 , y2 ):
4
X
dzJ
=
JJK zK + ηJ (t), J = 1, . . . , 4.
(32)
dt
K=1

Here the ηJ (t) are noises with a Gaussian distribution and zero mean, and with a correlation function given by Eq. (17).
The B matrix (18) for the two-city case, evaluated at a fixed point, is
 (1)

B
B (2)
B=
,
B (3) B (4)

(33)

where these submatrices are given by
B (1) =

B

(2)

=B

and
B (4) =

β11 s∗1 i∗1 + β12 s∗1 i∗2 + µ(1 − s∗1 )

0

0

β21 s∗2 i∗1 + β22 s∗2 i∗2 + µ(1 − s∗2 )

(3)

=

−β11 s∗1 i∗1 − β12 s∗1 i∗2 − µi∗1

0

0

−β21 s∗2 i∗1 − β22 s∗2 i∗2 − µi∗2

β11 s∗1 i∗1 + β12 s∗1 i∗2 + (γ + µ)i∗1

0

0

β21 s∗2 i∗1 + β22 s∗2 i∗2 + (γ + µ)i∗2

Using Eq. (28) at the fixed point these may be simplified to
!
2µ(1 − s∗1 )
0
,
B (1) =
0
2µ(1 − s∗2 )
B (2) = B (3) =
and
B (4) =

−(γ + 2µ)i∗1

0

0

−(γ + 2µ)i∗2

2(γ + µ)i∗1

0

0

2(γ + µ)i∗2
9

!

.

!

,

(34)

,

(35)

!

(36)

!

.

(37)
!

,

(38)

(39)

We now introduce the matrix
∗
PJK (ω) ≡ hz̃J (ω)z̃K
(ω)i
4
4
XX

† −1
Φ−1
=
JL (ω)BLM Φ M K (ω),

(40)

L=1 M =1

where here (and only here) ∗ denotes complex conjugation. In the one-city case, where
the focus is on finding the frequencies and amplitudes of the stochastic oscillations, only
the power spectrum (when J = K) is usually analysed. When studying the model with
two cities, we will also be interested in the cross-correlations between infection in two
different cities, and so will also wish to calculate the cross-spectrum (when J 6= K). It is
frequently convenient to normalise this by the relevant power-spectrum, and instead work
with the complex coherence function (CCF) defined by
CJK (ω) ≡ p

PJK (ω)
PJJ (ω)PKK (ω)

.

(41)

The CCF will in general be complex for J 6= K, and so typically one calculates its
magnitude and phase. The phase is given by




−1 Im (CJK (ω))
−1 Im (PJK (ω))
φJK (ω) ≡ tan
= tan
.
(42)
Re (CJK (ω))
Re (PJK (ω))
The phase used in the main text is found by evaluating (42) at the value of ω that
maximises the modulus of the CCF (41) [4].

3

The n-City Stochastic SIR model

We will be relatively brief in this section, and only outline the results, since the formalism
and general procedure is as for the two-city case. The main difference is that there is
a fifth type of infection event — in addition to those mentioned for two cities. This is
due to the fact that infective individuals can commute from city k and infect susceptible
individuals from city j in city ℓ, where j, k and ℓ are all different. This is only possible
when there are three or more cities.

3.1

Form of the interaction between the n cities

The number of individuals in the three classes belonging to city j are denoted by Sj , Ij
and Rj = Nj − Sj − Ij as before, where now j = 1, . . . , n. We will also introduce the
notation
X
fj =
fkj ,
(43)
k6=j

so that the number of individuals in city j may be written as
h
X
X i
fjk Nk
fkj Nj +
Mj = 1 −
k6=j

k6=j

= (1 − fj ) Nj +
10

X
k6=j

fjk Nk .

(44)

As for the two city case, we will assume that the birth/death rate and the recovery rate
are the same in both cities, but that the infection rate for city j is βj .
As mentioned above, there are five different types of infection events:
(i) Infective residents of one city (say j) can infect susceptible residents of the same
city. The rate for this to occur is βj (1 − fj ) Sj (1 − fj ) Ij /Mj .
(ii) Infective commuters can travel from city k to city j and infect susceptible residents
in their home city j. The rate for this to occur is βj (1 − fj ) Sj fjk Ik /Mj .
(iii) Infective residents in their home city (say k) can infect susceptible commuters from
the other city (j). The rate for this to occur is βk fkj Sj (1 − fk ) Ik /Mk .
(iv) Infective commuters from city j infect susceptible commuters from j in city ℓ (ℓ 6= j).
The rate for this to occur is βℓ fℓj Sj fℓj Ij /Mℓ .
(v) Infective commuters from city k can infect susceptible commuters from city j in city
ℓ (ℓ 6= j, k). The rate for this to occur is βℓ fℓj Sj fℓk Ik /Mℓ .

Adding these rates together we obtain the total transition rate for infection of Sj
individuals as
n
X
Sj I k
,
(45)
βjk
Nk
k=1

where

βjj =

βj (1 − fj )2 Nj X βℓ fℓj2 Nj
+
, j = 1, . . . , n,
Mj
Mℓ
ℓ6=j

βj (1 − fj ) fjk Nk βk fkj (1 − fk ) Nk
+
Mj
Mk
X βℓ fℓj fℓk Nk
, j, k = 1, . . . , n; j 6= k.
+
Mℓ
ℓ6=j,k

βjk =

(46)

The analogue of Eq. (26) is
1. Infection of Sj
2. Recovery of Ij

T1j (Sj − 1, Ij + 1|Sj , Ij ) =

Pn

k=1

βjk

Sj I k
Nk

T2j (Sj , Ij − 1|Sj , Ij ) = γIj

(47)

3. Birth/death in city j T3j (Sj + 1, Ij − 1|Sj , Ij ) = µIj
4. Birth/death in city j

T4j (Sj + 1, Ij |Sj , Ij ) = µ(Nj − Sj − Ij ),

although we have aggregated the reactions for convenience, so that each line represents n
reactions with j = 1, . . . , n.
From this, the information required to deduce the macroscopic and stochastic equations can be found:
P
(j)
(n+j)
1. Infection of Sj
ν1j = −1, ν1j
= +1 g1j = nk=1 βjk sj ik
(n+j)
= −1 g2j = γij
2. Recovery of Ij
ν2j
(48)
(j)
(n+j)
3. Birth/death in city j ν3j = +1, ν3j
= −1 g3j = µij
(j)
4. Birth/death in city j
ν4j = +1 g4j = µ(1 − sj − ij ).
11

3.2

The macroscopic and stochastic equations

The macroscopic equation (10), where A(φ) is defined by Eq. (9), when expressed in
terms of the components of φ = (s1 , . . . , sn , ii , . . . , in ) may be written down using the
information in Eq. (48). One finds
dsj
dt

= −

dij
dt

=

n
X
k=1

n
X
k=1

βjk sj ik + µ (1 − sj ) ,

βjk sj ik − (γ + µ) ij ,

j = 1, . . . , n,

j = 1, . . . , n.

The Jacobian evaluated at the unique stable non-trivial fixed point is
 (1)

J
J (2)
J =
,
J (3) J (4)
where these submatrices are given by
" n
#
X
(1)
Jjk = −
βjℓ i∗ℓ + µ δjk ,
(3)

Jjk

" n ℓ=1 #
X
=
βjℓ i∗ℓ δjk ,

(50)

(2)

Jjk = −βjk s∗j ,
(4)

Jjk = βjk s∗j − (γ + µ) δjk .

ℓ=1

(49)

(51)

Finally, the B matrix (18) evaluated at a fixed point has the form (33) where
" n
#
X
(1)
βjℓ s∗j i∗ℓ + µ(1 − s∗j ) δjk ,
Bjk =
ℓ=1

(2)

Bjk

(4)

Bjk

(3)

"

= Bjk = −
=

" n
X

n
X
ℓ=1

#

βjℓ s∗j i∗ℓ − µi∗j δjk ,
#

βjℓ s∗j i∗ℓ + (γ + µ)i∗j δjk .

ℓ=1

(52)

Using Eq. (49) at the fixed point these may be simplified to
(1)

Bjk

(2)

Bjk

(4)

Bjk


2µ(1 − s∗j ) δjk ,


(3)
= Bjk = − (γ + 2µ)i∗j δjk ,


= 2(γ + µ)i∗j δjk .

=



(53)

The cross-spectra, complex coherence function and phase spectra are as in Eqs. (40)-(42).

12

4

Additional results

In this section, we will give additional results for the 1-city (Figure 1), 2-city (Figure 2)
and 4-city (Figure 3) SIR models.
Figure 1 shows the average extinction time (AET) from simulations of the 1-city SIR
model as a function of the basic reproductive ratio, R0 , for different population sizes, N,
and levels of seasonality, ǫ. The results for N = 4 × 105 (middle row) were shown in
Figure 1 of the main text. We observe that for smaller (N = 2 × 105 , top row)/larger
(N = 8 × 105 , bottom row) populations the dependence on R0 of the AET becomes much
less/more pronounced.
Figure 2 shows the AET from simulations of the 2-city SIR model for different levels
of seasonality, ǫ, and analytical results for the amplification, coherence for both cities and
phase lag between cities. The basic reproductive ratio is taken to be R01 = 18 + δ in one
of the cities and R02 = 18 − δ in the the other city, where δ = 0, 1, . . . , 6. Panels (a), (b),
(c), (e), (g) and (h) are repeated from Figure 3 of the main text. The new panels (d) and
(f) show that both the coherence and amplification in the first city are low in the region
where the AET is longest, similarly to the results for the second city, shown in panels (e)
and (g).
Figure 3 shows the same results as Figure 1 but for the 4-city SIR model in which a
central city with larger population is surrounded by 3 non-interacting satellite cities with
smaller (and equal) populations. The basic reproductive ratio is taken to be R01 = 18 + δ
in the larger city and R02,03,04 = 18 − δ in the smaller cities, where δ = 0, 1, . . . , 6.
The results refer to the central city and one of the satellite cities. We consider the case
when the fraction of commuters from each of the satellite cities to the central city, f ,
is 10 times larger than that from the central city to that satellite city. Panels (a), (b),
(c) repeated from Figure 5 of the main text show that the AET is maximum at strong
heterogeneity (large δ) and intermediate coupling strengths f . The additional panels (d)(h) again suggest that this behaviour can be explained in terms of the coherence and
amplification and that the phase lag between the cities does not play the dominant role
in such behaviour of the AET.

13

30

20

5

ε = 0, N = 2×10

10

ε = 0.05, N = 2×105

ε = 0.12, N = 2×105

20
10

AET (yr)

5

10
0
10

300

15

20

25

0
10
75

ε = 0, N = 4×105

200

15

20

25

0
10
30

ε = 0.05, N = 4×105

50

20

25

10

15

20

25

ε = 0.12, N = 4×105

AET (yr)
100
0
10
15
20
4
x 10
15
5
ε = 0, N = 8×10

25

0
10
1500

10

15

20

25

0
10
100

5

ε = 0.05, N = 8×10

15

20

25

ε = 0.12, N = 8×105

1000
50

AET (yr)
5
0
10

500

15

R0

20

25

0
10

15

R0

20

25

0
10

15

R0

20

25

Figure 1: AET from simulations for the 1-city SIR model. The arrows highlight the
parameter regions where the attractor of the forced system changes from annual to biennial
(black and red arrows), and from biennial to annual (grey arrows).

14

50.%

300

(a) AET, ε = 0

(b) AET, ε = 0.05

100

(c) AET, ε = 0.12

18.%
f

6.3%

200

2.2%
100

0.3%
0.1%

0

50.%

0.65

(d) city 1,
coherence,
ε=0

18.%
6.3%
f

10

50

0.8%

0.6

2.2%

(f) city 1,
amplification,
ε=0

0.55

0.8%
0.3%

0.5

50.%

(e) city 2,
coherence,
ε=0

18.%
6.3%

0.6

5

0

0

0.14
0.12

(g) city 2,
amplification,
ε=0

0.12

0.08

0.1%
0 1 2 3 4 5 6
δ, R

01

= 18+δ, R

02

= 18−δ

0 1 2 3 4 5 6
δ, R

0.4

π
3
π
6

0.16

0.8%
0.3%

(h) phase lag
between cities,
ε=0

0.08

0.5

2.2%

25

0.1

0.1%

f

15

75

01

= 18+δ, R

02

0

= 18−δ

0 1 2 3 4 5 6
δ, R01 = 18+δ, R02 = 18−δ

Figure 2: Results for the 2-city SIR model with N1 = N2 = 2 × 105 . (a)-(c) AET from
simulations for different levels of seasonality, ǫ. Analytical results for (d)-(e) coherence,
(f)-(g) amplification and (h) phase lag between cities for ǫ = 0.

15

50.%

(a) AET, ε = 0

400

(b) AET, ε = 0.05

18.%
300

2.2%
0.3%
0.1%
50.%

(d) central city,
coherence,
ε=0

18.%
6.3%
2.2%

15

50

10

100

25

5

0
0.65

0

0

0.6

(f) central city,
amplification,
ε=0

0.1

f

(h) phase lag
between cities,
ε=0

0.08

0.1%

6.3%

0.12

0.5

0.3%

18.%

0.14

0.55

0.8%

50.%

20

75

200

0.8%

f

(c) AET, ε = 0.12

100

6.3%
f

125

(e) satellite city,
coherence,
ε=0

0.6
0.5

(g) satellite city,
amplification,
ε=0

2.2%

π
6
0.15
0.1

0.4

0.8%

0 1 2 3 4 5 6
δ, R

0.3%

01

01

= 18+δ, R

02,03,04

02,03,04

= 18−δ

0 1 2 3 4 5 6

0 1 2 3 4 5 6
δ, R

= 18+δ, R

0

0.05

0.3

0.1%

π
3

= 18−δ

δ, R01 = 18+δ, R02,03,04 = 18−δ

Figure 3: Results for the 4-city SIR model in which a central city with N1 = 2.1 × 105 is
surrounded by 3 non-interacting satellite cities with N2 = N3 = N4 = N1 /3 = 7 × 104 .
Fraction of commuters from each of the suburban cities to the central city, f , is 10
times larger than that from the central city to that suburban city. (a)-(c) AET from
simulations for different levels of seasonality, ǫ. Analytical results for (d)-(e) coherence,
(f)-(g) amplification and (h) phase lag for ǫ = 0 between the central city and one of the
satellite cities.

16

References
1. D. Alonso, A. J. McKane and M. Pascual, “Stochastic amplification in epidemics”,
J. R. Soc. Interface 4, 575-582 (2007).
2. G. Rozhnova and A. Nunes, “Stochastic effects in a seasonally forced epidemic
model”, Phys. Rev. E 82, 041906 (2010).
3. G. Rozhnova, A. Nunes, and A. J. McKane, “Stochastic oscillations in models of
epidemics on a network of cities”, Phys. Rev. E 84, 051919 (2011).
4. G. Rozhnova, A. Nunes, and A. J. McKane, “Phase lag in epidemics on a network
of cities”, Phys. Rev. E 85, 051912 (2012).
5. A. J. Black and A. J. McKane, “Stochastic formulation of ecological models and
their applications”, Trends Ecol. Evol. 27, 337-345 (2012).
6. A. J. McKane, T. Biancalani and T. Rogers, “Stochastic pattern formation and
spontaneous polarisation: The linear noise approximation and beyond”, arXiv:1211.0462.

17

