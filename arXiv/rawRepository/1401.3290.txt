arXiv:1401.3290v4 [q-bio.QM] 3 Feb 2015

The Annals of Applied Statistics
2014, Vol. 8, No. 4, 2461–2484
DOI: 10.1214/14-AOAS783
In the Public Domain

PROBIT MODELS FOR CAPTURE–RECAPTURE DATA SUBJECT
TO IMPERFECT DETECTION, INDIVIDUAL HETEROGENEITY
AND MISIDENTIFICATION1
By Brett T. McClintock∗ , Larissa L. Bailey† ,
Brian P. Dreher‡ and William A. Link§
NOAA National Marine Mammal Laboratory∗ , Colorado State University† ,
Colorado Parks and Wildlife‡ ,
and USGS Patuxent Wildlife Research Center§
As noninvasive sampling techniques for animal populations have
become more popular, there has been increasing interest in the development of capture–recapture models that can accommodate both
imperfect detection and misidentification of individuals (e.g., due to
genotyping error). However, current methods do not allow for individual variation in parameters, such as detection or survival probability. Here we develop misidentification models for capture–recapture
data that can simultaneously account for temporal variation, behavioral effects and individual heterogeneity in parameters. To facilitate Bayesian inference using our approach, we extend standard
probit regression techniques to latent multinomial models where the
dimension and zeros of the response cannot be observed. We also
present a novel Metropolis–Hastings within Gibbs algorithm for fitting these models using Markov chain Monte Carlo. Using closed
population abundance models for illustration, we re-visit a DNA
capture–recapture population study of black bears in Michigan, USA
and find evidence of misidentification due to genotyping error, as
well as temporal, behavioral and individual variation in detection
probability. We also estimate a salamander population of known size
from laboratory experiments evaluating the effectiveness of a marking technique commonly used for amphibians and fish. Our model
was able to reliably estimate the size of this population and provided
evidence of individual heterogeneity in misidentification probability
that is attributable to variable mark quality. Our approach is more
Received December 2013; revised May 2014.
Funding for the bear example was provided in part by Federal Aid in Wildlife Restoration Project W-147-R-2, Michigan Department of Natural Resources, United States Fish
and Wildlife Service, and Michigan State University.
Key words and phrases. Data augmentation, individual heterogeneity, latent multinomial, mark-recapture, missing data, population size, probit regression, record linkage.
1

This is an electronic reprint of the original article published by the
Institute of Mathematical Statistics in The Annals of Applied Statistics,
2014, Vol. 8, No. 4, 2461–2484. This reprint differs from the original in pagination
and typographic detail.
1

2

MCCLINTOCK, BAILEY, DREHER AND LINK
computationally demanding than previously proposed methods, but
it provides the flexibility necessary for a much broader suite of models to be explored while properly accounting for uncertainty introduced by misidentification and imperfect detection. In the absence of
misidentification, our probit formulation also provides a convenient
and efficient Gibbs sampler for Bayesian analysis of traditional closed
population capture–recapture data.

1. Introduction. Capture–recapture methods are commonly used to estimate demographic parameters for wildlife [e.g., Williams, Nichols and Conroy (2002)] and human [e.g., Yip et al. (1995a, 1995b)] populations. Passive (or “noninvasive”) sampling techniques are becoming more common in
capture–recapture studies, largely because these techniques can be less expensive and less invasive than the physical capture of animals [e.g., Karanth
and Nichols (1998), Mackey et al. (2008), Ruell et al. (2009)]. Passive sampling techniques in capture–recapture studies include the use of photographs
[Karanth and Nichols (1998), Langtimm et al. (1998), Mackey et al. (2008)],
visual sightings [e.g., Hall, McConnell and Barker (2001), Kauffman, Frick
and Linthicum (2003)] or genetic material [Dreher et al. (2007), Ruell et al.
(2009)] to individually identify animals. When individual animals are identifiable by natural or artificial marks, these techniques can provide information
about key demographic parameters such as abundance, survival and recruitment. They are therefore very useful for informing management decisions,
as well as for testing ecological or evolutionary hypotheses.
Unfortunately, use of passive sampling techniques in capture–recapture
studies is not entirely without problems. For example, matching photographs
to individuals can be prone to identification error due to variable image quality [e.g., Hastings, Hiby and Small (2008), Link et al. (2010), Morrison et al.
(2011), Bonner and Holmberg (2013), McClintock et al. (2013a)], and genetic samples (e.g., scat or hair) are susceptible to genotyping error [e.g.,
Lukacs and Burnham (2005), Dreher et al. (2007), Wright et al. (2009)].
Individual identifications from photographs, visual sightings or genetic samples are all susceptible to observer recording error. Sampling designs can also
result in differential exposures of individuals to sampling (e.g., due to home
range behavior or opportunistic sampling). Such individual heterogeneity in
detection probabilities can severely bias estimators and is a common culprit
in the underestimation of abundance in capture–recapture studies.
Link et al. (2010) recently developed a novel approach for the analysis of capture–recapture data when individual identification errors occur.
This pioneering contribution focused on the closed population abundance
model allowing for temporal variation in parameters [Darroch (1958), Otis
et al. (1978)], and therefore does not accommodate individual-level variation
in parameters, such as detection [e.g., Coull and Agresti (1999), Fienberg,

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

3

Johnson and Junker (1999), Pledger (2000), Basu and Ebrahimi (2001),
King and Brooks (2008), Manrique-Vallier and Fienberg (2008)] or survival
[e.g., Royle (2008), Gimenez and Choquet (2010)] probability. Here, we develop models to simultaneously account for temporal variation, behavioral
response (e.g., trap “happy” or “shy” effects), individual heterogeneity and
misidentification in capture–recapture analyses. To facilitate Bayesian inference using our approach, we also extend standard probit regression data
augmentation techniques [e.g., Albert and Chib (1993)] to latent multinomial
models where the dimension and zeros of the response cannot be observed.
2. Methods.
2.1. Detailed problem description. Consider a “classic” capture–recapture
study, where sampling is conducted over T sampling occasions and the identity of each animal is known with certainty when it is observed (i.e., there
is no misidentification). When encounters are simple binary responses and
T = 2, there are three possible recorded encounter histories for each individual: “11” (encountered on both occasions), “10” (encountered on the first
occasion but not the second) and “01” (encountered on the second occasion
but not the first). If the encounter history for animal i is denoted hi , a classic
approach is to assume that hi is a realization from a multinomial process,
where the probability of observing hi is a function of unknown demographic
parameters (θ) and (usually nuisance) parameters related to the observation
process (ρ). For example, θ might consist of survival probabilities and ρ of
detection probabilities. In this case, the number of unique animals encountered (n) is known with certainty, and when conditioning on first capture, a
standard likelihood for capture–recapture data is proportional to
(1)

[h|θ, ρ] =

n
Y

Pr(hi |θ, ρ),

i=1

where [h|θ, ρ] denotes the conditional distribution for h given θ and ρ. We
note that “00” encounter histories are not observed, hence, additional modifications to equation (1) are needed to make inferences about individuals
that are never encountered.
In contrast to the preceding scenario, now consider the situation where
individuals may be misidentified. When such errors can occur, three types of
encounters for any of the T sampling occasions are possible. These include a
nonencounter (denoted by “0”), a correctly identified encounter (denoted by
“1”) or a misidentified encounter (denoted by “2”). Misidentified encounters
result in “ghost” encounter histories [Yoshizaki (2007), Link et al. (2010)],
and an individual encountered in >1 sampling occasion could therefore yield
a number of possible recorded histories. For example, when presented with
the recorded histories “10” and “01,” we do not know whether these obser-

4

MCCLINTOCK, BAILEY, DREHER AND LINK

vations arose from the same animal seen on both occasions (latent histories
“12,” “21” or “22”) or whether it was indeed two different animals each seen
on one occasion (latent histories “10” and “01,” “20” and “01,” “10” and
“02,” or “20” and “02”). Under misidentification, encounter histories are
not uniquely associated with animals, so equation (1) is no longer valid for
making inferences about θ and ρ.
Assuming the same misidentification cannot occur more than once (i.e.,
a ghost cannot be detected more than once) and an encounter cannot be
misidentified as a legitimate marked individual, Link et al. (2010) proposed
a closed population abundance model allowing for temporal variation in detection probability under this misidentification scenario. In the next section,
we generalize their approach to a much broader suite of misidentification
models that can simultaneously accommodate temporal, behavioral and individual effects on θ and ρ.
2.2. Accounting for individual heterogeneity and misidentification. Consider the marginal likelihood obtained by summing the “complete data likelihood” over all possible values of the latent encounter histories:
X
[f |θ, ρ] =
(2)
[h|θ, ρ][f |h, θ, ρ],
h

where f is a vector of recorded history frequencies indicating the number
of times each of the possible recorded histories was observed (see Table 1
for notation definitions). The complete data likelihood therefore derives
from distributions [h|θ, ρ] for latent capture–recapture data and distributions [f |h, θ, ρ] describing their conversion to observed (potentially misidentified) data (see Table 2). We note that this extension is applicable to all
sorts of capture–recapture models [e.g., those reviewed by Williams, Nichols
and Conroy (2002)] and could apply to data subject to errors other than
misidentification [e.g., incomplete mark observations sensu McClintock et al.
(2013b)]. Evaluating equation (2) involves a multidimensional summation,
thus making maximum likelihood estimation difficult. Link et al. (2010)
averted this problem by adopting a Bayesian perspective and sampling from
the posterior distribution using Markov chain Monte Carlo (MCMC), but
their approach requires the assumption of no individual variation in θ and ρ.
We will for convenience refer to the latent and recorded histories using
indices. With three possible latent encounter types (0, 1 and 2), the latent
history for individual i, hi = (hi1 , hi2 , . . . , hiT ), is identified by
j =1+

T
X

hit 3t−1 ,

t=1

such that Hi = j indicates individual i has latent encounter history j. For
example, Hi = 16 for T = 3 indicates individual i has latent history hi = 021,

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

5

Table 1
Definitions of parameters, latent variables, data and modeling constructs used in the
latent multinomial model allowing misidentification with temporal, behavioral and
individual-level variation in parameters. Note that bold symbols represent collections
(vectors) of parameters
Parameters

Definition

θ

Vector of demographic process parameters (e.g., abundance or survival probability).

ρ

Vector of observation process parameters (e.g., encounter or
misidentification probability).

pit

Probability that individual i is encountered at time t.

α

Probability that an individual, encountered at time t, is correctly
identified.

Latent variables
hi

The latent encounter history for individual i, (hi1 , hi2 , . . . , hiT ).

hit

Encounter type for the latent encounter history of individual i at
time t; hit = 0 represents no encounter, hit = 1 a correctly identified
encounter, and hit = 2 a misidentified encounter.

Hi

Latent encounter history index for individual i, such that Hi = j
indicates individual i has latent history j. For hitP
∈ {0, 1, 2} the 3T
possible latent histories are identified by j = 1 + Tt=1 hit 3t−1 (see
Table 2).
P
Latent frequency of encounter history j, where xj = i I(Hi = j).
Note that x denotes a column vector of such frequencies, for example, x = (x1 , x2 , . . . , x3T )′ for hit ∈ {0, 1, 2}.

xj

Data
T

Number of sampling occasions.

fk

Frequency for recorded (observed) encounter history k. Note that
f denotes a column vector of such frequencies, for example, f =
(f1 , f2 , . . . , f2T −1 )′ for ωt ∈ {0, 1}.

Modeling constructs
ω

Recorded encounter history, (ω1 , ω2 , . . . , ωT ).

ωt

Observation type for a recorded history at time t; ωt = 0 represents
no detection and ωt = 1 a detection. For ωt ∈ {0,
2T − 1
PT1} thet−1
possible recorded histories are identified by k = t=1 ωt 2
(see
Table 2).

Ci

Occasion of first capture for individual i. For example, Ci = 3 if
individual i has latent encounter history hi = 0021 (Hi = 46).

6

MCCLINTOCK, BAILEY, DREHER AND LINK

Table 2
Latent and recorded histories from marked individual encounters with T = 3 sampling
occasions subject to misidentification. The probability of each latent history for individual
i, Pr(Hi = j), is for a closed population abundance model, where pit is the probability
that individual i is encountered at time t, and α is the probability that an individual,
encountered at time t, is correctly identified. Contributed records column shows the
recorded histories (k) arising from specific latent histories (j). For example, latent history
25, “022,” gives rise to recorded histories “010” and “001” (for which k = 2 and 4)

j

Latent
history
(hi )

Pr(Hi = j)

Contributed
records
(k from j)

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27

000
100
200
010
110
210
020
120
220
001
101
201
011
111
211
021
121
221
002
102
202
012
112
212
022
122
222

(1 − pi1 )(1 − pi2 )(1 − pi3 )
pi1 α(1 − pi2 )(1 − pi3 )
pi1 (1 − α)(1 − pi2 )(1 − pi3 )
(1 − pi1 )pi2 α(1 − pi3 )
pi1 αpi2 α(1 − pi3 )
pi1 (1 − α)pi2 α(1 − pi3 )
(1 − pi1 )pi2 (1 − α)(1 − pi3 )
pi1 αpi2 (1 − α)(1 − pi3 )
pi1 (1 − α)pi2 (1 − α)(1 − pi3 )
(1 − pi1 )(1 − pi2 )pi3 α
pi1 α(1 − pi2 )pi3 α
pi1 (1 − α)(1 − pi2 )pi3 α
(1 − pi1 )pi2 αpi3 α
pi1 αpi2 αpi3 α
pi1 (1 − α)pi2 αpi3 α
(1 − pi1 )pi2 (1 − α)pi3 α
pi1 αpi2 (1 − α)pi3 α
pi1 (1 − α)pi2 (1 − α)pi3 α
(1 − pi1 )(1 − pi2 )pi3 (1 − α)
pi1 α(1 − pi2 )pi3 (1 − α)
pi1 (1 − α)(1 − pi2 )pi3 (1 − α)
(1 − pi1 )pi2 αpi3 (1 − α)
pi1 αpi2 αpi3 (1 − α)
pi1 (1 − α)pi2 αpi3 (1 − α)
(1 − pi1 )pi2 (1 − α)pi3 (1 − α)
pi1 αpi2 (1 − α)pi3 (1 − α)
pi1 (1 − α)pi2 (1 − α)pi3 (1 − α)

.......
1......
1......
.2.....
..3....
12.....
.2.....
12.....
12.....
...4...
....5..
1..4...
.....6.
......7
1....6.
.2.4...
.2..5..
12.4...
...4...
1..4...
1..4...
.2.4...
..34...
12.4...
.2.4...
12.4...
12.4...

k

Recorded
history
(ω)

1
2
3
4
5
6
7

100
010
110
001
101
011
111

Hi > 1 indicates individual i was encountered at least once, and Pr(Hi = j)
is the probability that individual i has latent history j. Similarly, a binary
recorded history ω = (ω1 , ω2 , . . . , ωT ) is identified by
k=

T
X

ωt 2t−1 ,

t=1

such that fk is the observed frequency of recorded history k.

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

7

To implement our method, it is necessary to construct a matrix A, such
that P
f = A′ x, where the latent history frequency vector x has elements
xj = i I(Hi = j) indicating the number of individuals with latent history
j, and I(Hi = j) is an indicator function having the value 1 when Hi = j
and 0 otherwise. The matrix A formally describes the relationship between
the recorded and latent histories, and intuition about how A is constructed
is best provided through a simple example. Suppose T = 3 for binary (i.e.,
detection, nondetection) recorded histories as in Table 2. The 3T × (2T −
1) matrix A for this example can be constructed from the corresponding
contributed records column in Table 2 by simply replacing each dot (.) with
a 0 and any other entry with a 1. Thus, the rows of A correspond to the 3T
possible latent encounter histories and the columns correspond to the 2T − 1
possible recorded histories. For example, the sixth row of A indicates that
latent history 210 (j = 6) gives rise to the recorded histories 100 (k = 1) and
010 (k = 2) for binary recorded histories when T = 3.
We treat the latent individual encounter histories as unobserved quantities
(just like θ and ρ) and use Bayesian analysis methods to evaluate the joint
posterior distribution
(3)

[h, θ, ρ|f ] ∝ [h|θ, ρ][f |h, θ, ρ][θ, ρ],

where [f |h, θ, ρ] = I(A′ x = f ). We note that [f |h, θ, ρ] does not depend on
θ or ρ; the relation is deterministic rather than stochastic in the cases we
consider here. One of the keys to sampling from equation (3) using MCMC
is proposing latent history frequencies x that satisfy A′ x = f . This is accomplished by utilizing basis vectors for the null space of A′ . Once the
A matrix is defined, a basis for the null space of A′ can be determined
by solving the system of equations A′ x = 0. For binary recorded histories with T = 2, one such basis is the set of 3T − 2T + 1 = 6 column vectors {v}, where v1 = (1, 0, 0, 0, 0, 0, 0, 0, 0)′ , v2 = (0, −1, 1, 0, 0, 0, 0, 0, 0)′ , v3 =
(0, −1, 0, −1, 0, 1, 0, 0, 0)′ , v4 = (0, 0, 0, −1, 0, 0, 1, 0, 0)′ , v5 = (0, −1, 0, −1, 0,
0, 0, 1, 0)′ and v6 = (0, −1, 0, −1, 0, 0, 0, 0, 1)′ .
When there is no individual heterogeneity in parameters, one may propose
and update x from the set of basis vectors without explicit consideration of
hi [Link et al. (2010)]. However, when allowing for individual heterogeneity,
one must explicitly consider hi for each individual in the population. An
efficient MCMC algorithm therefore needs to regularly propose reasonable
hi in combinations that satisfy A′ x = f . As illustrated in Sections 2.2.1 and
2.2.2 for closed population abundance models, we accomplish this by apportioning each latent history frequency xj to individuals with probabilities
proportional to Pr(Hi = j).

8

MCCLINTOCK, BAILEY, DREHER AND LINK

2.2.1. Model Mt,b,h,α . For illustration, we now focus our efforts on extending the closed population capture–recapture model Mt,b,h [Otis et al.
(1978), King and Brooks (2008)], which estimates abundance (N ) assuming
temporal variation, behavioral effects and individual heterogeneity in detection probabilities. Our extension includes all of these effects while accounting
for misidentification; we denote this model as Mt,b,h,α . Before proceeding,
we again note that our proposed approach may be used for other capture–
recapture models [e.g., Williams, Nichols and Conroy (2002)] by modifying them accordingly for misidentification; the mathematical form for the
Mt,b,h,α likelihood is simply substituted directly for [h|θ, ρ] in equation (3).
We adopt a Bayesian perspective and utilize data augmentation both to
account for individuals that were never detected [e.g., Royle, Dorazio and
Link (2007)] and to formulate a probit model for detection probability [e.g.,
Albert and Chib (1993)]. The data augmentation framework is useful because of computational efficiencies it produces, and our procedure treats N
as a binomial random variable with known index M (typically M ≫ N )
and parameter ψ. In this context, M is often described as a “superpopulation” size of indicators qi ∼ Bernoulli(ψ), where individuals with qi = 1
are considered “real individuals” or “individuals available for capture,” and
P
P3T
N= M
j=2 xj individuals with Hi > 1, we know qi = 1. For
i=1 qi . For the
P3T
the remaining M − j=2 xj individuals that were never detected, Hi = 1 and
qi is unknown. A closed population misidentification model allowing temporal and individual variation in detection probability may then be represented
as
qi |ψ ∼ Bernoulli(ψ),
hit |qi , pit ∼ Categorical(1 − qi pit , αqi pit , (1 − α)qi pit )
for hit ∈ {0, 1, 2}, where pit is the probability of detection for individual
i at time t, and α is the probability that an individual is correctly identified, given detection. Because we assume N |ψ ∼ Binomial(M, ψ), a judicious
choice of prior can yield the desired prior for N when marginalized over ψ.
For example, ψ ∼ Beta(1, 1) produces a discrete uniform prior on N .
As a more computationally efficient alternative to the ubiquitous logit
link function for heterogeneous detection probabilities in Bayesian capture–
recapture analyses [e.g., Castledine (1981), George and Robert (1992), Fienberg, Johnson and Junker (1999), Royle, Dorazio and Link (2007), King and
Brooks (2008), Link (2013)], we use data augmentation to formulate a pro′ β + γ ), where Φ is the standard normal cumulative
bit model, pit = Φ(wit
i
distribution function, wit is a vector of covariates for individual i at time t,
β is a vector of regression coefficients, and γi is an individual-level effect. Let
yit = I(hit > 0) be an indicator for the binary detection process, and let ỹit be
′ β + γ , 1).
a continuous latent version of this process, where ỹit |β, γi ∼ N (wit
i

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

9

Assuming yit = 1 if ỹit > 0 and qi = 1, and assuming yit = 0 if ỹit < 0 and
qi = 1 or qi = 0, then it follows that yit |qi , ỹit ∼ Bernoulli(qi I(ỹit > 0)). This
approach shares some similarities with recent extensions of the probit regression model of Albert and Chib (1993) to imperfectly-detected species
occurrence data [Dorazio and Rodriguez (2012), Johnson et al. (2013)], but
our extension allows for individual-level effects and a response variable of
unknown dimension.
For our probit model allowing temporal, behavioral and individual effects in detection probability, we define wit = (I(t = 1), I(t = 2), . . . , I(t =
T ), I(t > Ci )) and β = (β1 , β2 , . . . , βT +1 ), where Ci denotes the first capture
occasion for individual i (with Ci = ∞ for individuals with Hi = 1). Given
the recorded history frequencies f = (f1 , f2 , . . . , f2T −1 ), the joint posterior
distribution for model Mt,b,h,α is then
[h, q, ỹ, β, γ, ψ, α, σγ2 |f ] ∝ [h|q, ỹ, α]I(A′ x = f )
× [q|ψ][ỹ|β, γ][β|µβ , Σβ ][γ|σγ2 ]

(4)

× [ψ][α][σγ2 ],
where
T
M Y
Y
{qi I(ỹit > 0)}I(hit >0) {1 − qi I(ỹit > 0)}I(hit =0)
[h|q, ỹ, α] ∝
i=1 t=1

× αI(hit =1) (1 − α)I(hit =2)

and
x=

M
X
i=1

I(Hi = 1),

M
X
i=1

I(Hi = 2), . . . ,

M
X

T

!

I(Hi = 3 ) = (x1 , x2 , . . . , x3T ).

i=1

We complete our Bayesian formulation by assigning the priors
β|µβ , Σβ ∼ N (µβ , Σβ ),
γi |σγ2 ∼ N (0, σγ2 ),
α ∼ Beta(aα , bα ),
ψ ∼ Beta(aψ , bψ ),
and σγ2 ∼ Γ−1 (aσγ , bσα ), where µβ and Σβ are the prior mean and covariance
matrix for β. By choosing bψ = 1 and a very small positive value for aψ , one
can approximate the scale prior [N ] ∝ 1/N [Link (2013)]. We note that
simpler closed population abundance models may be specified by modifying
model Mt,b,h,α accordingly. For example, set βT +1 = 0 to remove behavior

10

MCCLINTOCK, BAILEY, DREHER AND LINK

effects, set β1 = β2 = · · · = βT to remove temporal variation, or set γi = 0 for
i = 1, . . . , M to remove individual effects.
Given the 3T × (2T − 1) matrix A for binary recorded histories and a set
of basis vectors {v} = {v1 , v2 , . . . , v3T −2T +1 } for the null space of A′ (where
v1 is the basis vector corresponding to the all-zero latent history frequency),
we propose the following MCMC algorithm for sampling from the posterior
distribution of model Mt,b,h,α [equation (4)]. We utilize Metropolis–Hastings
updates for the latent encounter histories, but our judicious choice of priors
enables Gibbs updates for q, ỹ and all parameters:
1. Initialize all parameters and latent variables, including an initial feasible
set of M latent individual histories (h) with corresponding frequencies
x satisfying A′ x = f . One such initial vector x is readily available by
assuming α = 1, such that latent frequencies corresponding to histories with 2’s are zeros, with a one-to-one matching of the remaining
latent frequencies with the recorded history frequencies (f ). This creP2T −1
ates
k=1 fk individual histories (with corresponding Hi > 1), none
of which is the all-zero history. To complete the initialization, assign
P2T −1
x1 = M − k=1
fk individuals to the all-zero history (with corresponding Hi = 1).
2. Update ỹit for i = 1, . . . , M and t = 1, . . . , T from the full conditional
distribution:

′
if hit > 0 and qi = 1,
 T N (0,∞) (wit β + γi , 1),
′
ỹit |· ∼ T N (−∞,0) (wit β + γi , 1),
if hit = 0 and qi = 1,

′
N (wit β + γi , 1),
otherwise,
where T N (L,U ) is a normal distribution truncated at L and U .
3. Update β from the full conditional distribution:

−1
−1
′
′
−1
′
−1
β|· ∼ N ((Σ−1
β +W W) (Σβ µβ +W (ỹ − γ ⊗ 1T )), (Σβ +W W) ),
′ and 1 is
where W is the M T × (T + 1) design matrix with rows wit
T
the all-ones vector of length T .
4. Update γi for i = 1, . . . , M from the full conditional distribution:
 2 PT

′ β)
σγ t=1 (ỹit − wit
σγ2
γi |· ∼ N
,
.
1 + T σγ2
1 + T σγ2

5. Update σγ2 from the full conditional distribution:


γ′γ
M
2
−1
, bσγ +
.
σγ |· ∼ Γ
aσγ +
2
2

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

11

6. Update α from the full conditional distribution:
α|· ∼ Beta aα +

M X
T
X

I(hit = 1), bα +

M X
T
X

!

I(hit = 2) .

i=1 t=1

i=1 t=1

7. Update qi for the x1 individuals with Hi = 1 from the full conditional
distribution by drawing from a Bernoulli distribution with probability
Q
′ β + γ )}
ψ Tt=1 {1 − Φ(wit
i
.
Pr(qi = 1|Hi = 1) = QT
′
ψ t=1 {1 − Φ(wit β + γi )} + (1 − ψ)
8. Update ψ from the full conditional distribution:
ψ|· ∼ Beta aψ +

M
X

qi , bψ + M −

i=1

M
X
i=1

!

qi .

9. Update the set of M latent encounter histories (h) using a Metropolis–
Hastings step.
(a) Set Hi∗ = Hi for i = 1, . . . , M and x∗1 = x1 . Randomly draw r
from the integer set {2, . . . , 3T − 2T + 1} corresponding to basis vectors
{v2 , . . . , v3T −2T +1 }. Next draw kr from a discrete uniform distribution
over the integers {−Dr , . . . , −1, 1, . . . , Dr }, where Dr is a tuning parameter. Propose a latent history frequency vector
x∗ = x + kr vr .
PT
If any x∗j < 0 for j = 2, . . . , 3T or M − 3j=2 x∗j < 0, go to step 10.
(b) Apportion x∗ to individuals with probabilities proportional to
Pr(Hi = j). With probability 0.5, continue to step 9(b)(i) followed by
step 9(b)(ii); otherwise proceed with step 9(b)(ii) followed by step 9(b)(i).
j−
(i) For each x∗j < xj (j = 2, . . . , 3T ), draw a set {Orj− } = {oj−
1 , o2 , . . . ,
oj−
kr } of individuals (of size kr ) without replacement from the xj
individuals with capture history j (i.e., Hi∗ = j) with respective
probabilities

Pr(Hi∗∗ = 1) =

T
Y
′
{1 − Φ(wit
β + γi )},
t=1

and set Hi∗ = 1 for individuals i ∈ {Orj− }. After cycling through each
P
∗
j for which x∗j < xj (j = 2, . . . , 3T ), set x∗1 = M
i=1 I(Hi = 1).

12

MCCLINTOCK, BAILEY, DREHER AND LINK
j+
(ii) For each x∗j > xj (j = 2, . . . , 3T ), draw a set {Orj+ } = {oj+
1 , o2 , . . . ,
∗
oj+
kr } of individuals (of size kr ) without replacement from the x1
individuals that were never captured with respective probabilities

Pr(Hi∗∗

= j) =

T
Y

∗∗

∗∗

′
′
Φ(wit
β + γi )I(hit >0) {1 − Φ(wit
β + γi )}I(hit =0)

t=1

∗∗

∗∗

× αI(hit =1) (1 − α)I(hit =2) .

Set Hi∗ = j and qi∗ = 1 for individuals i ∈ {Orj+ }, and set x∗1 =
PM
∗
∗
T
i=1 I(Hi = 1). Cycle through each j for which xj > xj (j = 2, . . . , 3 ).
∗
∗
∗
(c) Propose qi for the x1 individuals with Hi = 1 as in step 7. Accept
the proposed latent histories (i.e., set x = x∗ , Hi = Hi∗ and qi = qi∗ ) with
probability min(1, Rr ), where
"
)#
( 3T
Y X
Rr =
Pr(Hi∗∗ = j)I(Hi∗ = j)
i : qi∗ =1

j=1

!

× [q∗ |ψ][h|h∗ , β, γ, α][q|ψ, β, γ]
.

"

Y

( 3T
X

i : qi =1

j=1

Pr(Hi∗∗

)#

= j)I(Hi = j)

!

× [q|ψ][h∗ |h, β, γ, α][q∗ |ψ, β, γ] ,
[h∗ |h, β, γ, α] is the proposal density for h∗ , and [q∗ |ψ, β, γ] is the proposal density for q∗ . Here, [h∗ |h, β, γ, α] is the product of the (ordered) conditional inclusion probabilities, Pr(Hi∗∗ = 1) for i ∈ {Orj− } and
Pr(Hi∗∗ = j) for i ∈ {Orj+ }, that were, respectively, selected in
steps 9(b)(i) and 9(b)(ii) under unequal probability sampling without
replacement [e.g., Thompson (1992), page 53]:
[h∗ |h, β, γ, α]
"
Y
=

j : x∗j <xj
j>1

×

"

Pr(H ∗∗j− = 1)
os
P
Ps−1
∗∗ = 1) −
∗∗
Pr(H
i : Hi =j
i
m=1 Pr(H j− = 1)
; s=1
kr
Y

Y

j : x∗j >xj
j>1

om

#

Pr(H ∗∗j+ = j)
os
P
Ps−1
∗∗
∗∗
i : H ∗ =1 Pr(Hi = j) −
m=1 Pr(H j+ = j)
; s=1
kr
Y

i

om

#

13

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

and
[h|h∗ , β, γ, α]
"
Y
=

j : x∗j <xj
j>1

×

"

Pr(H ∗∗j− = j)
os
Ps−1
P
∗∗
∗∗
i : H ∗ =1 Pr(Hi = j) −
m=1 Pr(H j− = j)
; s=1
kr
Y

Y

j : x∗j >xj
j>1

om

i

#

#
Pr(H ∗∗j+ = 1)
os
.
P
Ps−1
∗∗ = 1) −
∗∗ = 1)
Pr(H
∗ =j Pr(Hi
j+
i
:
H
m=1
s=1
;
kr
Y

om

i

10. Return to step 2 and repeat as needed.
Note that N is obtained by calculating N =
algorithm.

PM

i=1 qi

at each iteration of the

2.2.2. Model Mt,b,αh . In some applications, one may be more concerned
about individual heterogeneity in misidentification than detection probability. For example, the quality of visual identifiers (e.g., artificial marks,
naturally occurring pelt or scar patterns) or genetic material (e.g., hair or
fecal samples) may vary by individual [Lukacs and Burnham (2005)], and
some individuals may therefore be more or less likely to spawn ghost histories (see Blue Ridge two-lined salamander ). We can modify model Mt,b [Otis
et al. (1978), King and Brooks (2008)] to accommodate temporal variation,
behavioral effects and individual heterogeneity in correct identification probability, obtaining a model we call Mt,b,αh .
Similar to Section 2.2.1, we specify a probit model for the probability of
correctly identifying an individual, given detection, αi = Φ(µα + εi ), where
µα is an intercept term and εi is an individual-level effect. Let uit be an indicator for the binary correct identification process, and let ũit be a continuous latent version of this process, where ũit |µα , εi ∼ N (µα + εi , 1). Assuming
uit = 1 if ũit > 0 and hit = 1, and assuming uit = 0 if ũit < 0 and hit = 2 or
hit = 0, then it follows that uit |hit , ũit ∼ Bernoulli(I(hit > 0)I(ũit > 0)). The
joint posterior distribution for model Mt,b,αh is then
[h, q, ỹ, ũ, β, µα , ε, ψ, σε2 |f ] ∝ [h|q, ỹ, ũ]I(A′ x = f )
× [q|ψ][ỹ|β][ũ|µα , ε][β|µβ , Σβ ][ε|σε2 ]

(5)

× [ψ][µα ][σε2 ],
where
[h|q, ỹ, ũ] ∝

M Y
T
Y

i=1 t=1

{qi I(ỹit > 0)}I(hit >0) {1 − qi I(ỹit > 0)}I(hit =0)

14

MCCLINTOCK, BAILEY, DREHER AND LINK

× {I(hit > 0)I(ũit > 0)}I(hit =1)
× {1 − I(hit > 0)I(ũit > 0)}I(hit =2) ,
′ β, 1), and all other components of the model are specified as
ỹit |β ∼ N (wit
in Section 2.2.1 for model Mt,b,h,α . We assign the additional priors µα ∼
N (µµα , σµ2 α ), εi |σε2 ∼ N (0, σε2 ), and σε2 ∼ Γ−1 (aσε , bσε ).
It is straightforward to modify the MCMC algorithm described in Section 2.2.1 for sampling from the posterior distribution of model Mt,b,αh [equation (5)]. The additional parameters and ũ are simply updated from their
full conditional distributions:

if hit = 1,
 T N (0,∞) (µα + εi , 1),
ũit |· ∼ T N (−∞,0) (µα + εi , 1),
if hit = 2,

N (µα + εi , 1),
otherwise,
! 
−1
−1 !

M T
µµα X X
1
1
,
{ũit − εi } ,
+ MT
+
+ MT
µα |· ∼ N
σµ2 α
σµ2 α
σµ2 α
i=1 t=1
 2 PT

σε t=1 {ũit − µα }
σε2
εi |· ∼ N
,
1 + T σε2
1 + T σε2

and


ε′ ε
M
.
σε2 |· ∼ Γ−1 aσε + , bσε +
2
2
The only other notable difference from our algorithm for model Mt,b,h,α is
that we instead use Pr(Hi∗∗ = 1) = 1 − Pr(Hi∗∗ = j) to propose individuals
that were never detected in the step corresponding to 9(b)(i) above. This
is because under model Mt,b,αh , all individuals have the same probability of
never being detected.
3. Example applications.
3.1. Black bears of the Northern Lower Peninsula, Michigan, USA. In
an impressive field and analytical effort, Dreher et al. (2007) applied a closed
population model that incorporates individual misidentification due to genotyping error [Lukacs and Burnham (2005)] to estimate black bear (Ursus
americanus) abundance in the Northern Lower Peninsula of Michigan, USA.
DNA samples were collected from baited barbed wire hair snares on five occasions from 22 June–26 July 2003. A sixth DNA sampling occasion occurred
through the extraction of teeth and muscle tissue from bears registered during the recreational harvest in the autumn (hence, T = 6). In addition, a
random sample of hand-pulled hair samples collected from harvested bears

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

15

provided auxiliary information about the probability of a genotyping error
using hair-snare samples. Complete details of the data collection, genetic
analysis and statistical analysis can be found in Dreher et al. (2007).
Here we re-visit the DNA capture–recapture data of Dreher et al. (2007)
using our closed population abundance model allowing for temporal variation, behavioral effects, individual heterogeneity and misidentification (Section 2.2.1). Our motivation is twofold: (1) individual heterogeneity in detection from hair-snare samples was suspected by Dreher et al. (2007), but
not incorporated into their misidentification model; and (2) the misidentification model proposed by Lukacs and Burnham (2005) relies on several
assumptions that are unlikely to be met in practice and does not properly account for ghost capture histories that result from misidentification
[Yoshizaki (2007), Link et al. (2010), Yoshizaki et al. (2011)].
Based on the best-supported model from Dreher et al. (2007), we fit
model Mhunt,b,h,α , which allows for different detection probabilities for the
two methods of capture (i.e., hair snare or harvest; indicated by “hunt”),
a behavioral response to the baited hair snares, individual heterogeneity in
detection probability from hair-snare sampling, and misidentification of hair
snare samples due to genotyping error. Allowing misidentification to occur
only for the hair-snare sampling occasions (t = 1, . . . , 5), we have
" 5
M Y
Y
{qi I(ỹit > 0)}I(hit >0) {1 − qi I(ỹit > 0)}I(hit =0)
[h|q, ỹ, α] ∝
i=1 t=1

I(hit =1)

×α

I(hit =2)

(1 − α)

#

× (qi phunt )hi6 (1 − qi phunt )1−hi6 ,
′ β + γ ) for t = 1, . . . , 5, w = (1, I(t > C )), β = (β , β ), and
pit = Φ(wit
i
it
i
1 2
phunt |ap , bp ∼ Beta(ap , bp ).
The A matrix, posterior and MCMC algorithm described in Section 2.2.1
are modified accordingly, where the reduced [2(3T −1 )] × (2T − 1) A matrix
does not include misidentification for the harvest sampling occasion (t =
6), and phunt is updated from the full conditional distribution: phunt |· ∼
P
PM
Beta(ap + M
i=1 qi hi6 , bp +
i=1 qi (1 − hi6 )). We used weakly informative
priors by setting µβ = 0 and Σβ = diag(10, 10), aψ = 10−6 and aσγ = bσγ =
ap = bp = bψ = 1. Based on the auxiliary data about genotyping error of hair
samples collected from harvested bears (where 91 out of 95 samples were
correctly assigned to genotype), we used an informative prior with aα =
91 and bα = 4. To investigate prior sensitivity, we conducted an additional
analysis using an uninformative prior on α by specifying aα = bα = 1.

16

MCCLINTOCK, BAILEY, DREHER AND LINK

Fig. 1. Posterior distributions for abundance of black bears in the Northern Lower Peninsula of Michigan, USA, from DNA capture–recapture surveys conducted in summer and
autumn 2003. Results are for analyses using an uninformative prior (light) and an informative prior (dark) on the probability of correctly identifying an individual, given detection
(α).

Our MCMC algorithm was written in the C programming language
[Kernighan and Ritchie (1988)] with data pre- and post-processing performed in R via the .C interface [R Core Team (2012)]. Starting with Dr = 1
and rounding to the nearest integer, we tuned the MH sampler every 5000
iterations by multiplying or dividing Dr by 0.95 if the acceptance rate for
basis vector r was ≤0.44 or >0.44, respectively, where acceptance rates were
calculated as the number of accepted moves divided by the number of attempted moves. After pilot tuning and burn-in of 500,000 iterations from
overdispersed starting values, we obtained three chains of 10 million iterations for both analyses. With M = 5000, our analyses required about 48 hrs
on a computer running 64-bit Windows 7 (3.4 GHz Intel Core i7 processor,
16 Gb RAM). Slow mixing necessitated long runs, likely due to correlated
parameters and low movement rates for the MH sampler. Similar to Link
et al. (2010), low movement rates for the MH sampler resulted from many
of the 486 possible latent histories having very low probability. Chain convergence was assessed by visual inspection and the Gelman–Rubin–Brooks
(GRB) diagnostic in the R package CODA [Plummer et al. (2006)]. For both
analyses, all univariate GRB diagnostics were <1.002 and the multivariate
GRB diagnostic was 1.001 for monitored parameters (N, β1 , β2 , σγ2 , phunt , α).
Based on sample autocorrelations, mixing was somewhat slower using the
uninformative prior on α, but effective sample sizes exceeded 5000 for all
parameters.
Using the informative prior on α, we estimated posterior median N = 1945
with a 95% credible interval (CI) of 1470–2681 (Figure 1). Similar to Dreher
et al. (2007), we found evidence of a trap “happy” behavioral response to

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

17

Table 3
Posterior summaries and effective sample sizes (ESS) for model Mhunt,b,h,α using black
bear DNA capture–recapture data collected in the Northern Lower Peninsula of Michigan,
USA
probabilities were derived as
R ∞ in 2003. Mean capture and Rrecapture
∞
p̄ = −∞ Φ(β1 + γ)[γ|σγ2 ] dγ and c̄ = −∞ Φ(β1 + β2 + γ)[γ|σγ2 ] dγ, respectively
95%
Parm.

Mean

Median

Mode

SD

LCI

UCI

ESS

N
p̄
c̄
phunt
α
β1
β2
σγ

1978.9
0.02
0.05
0.21
0.95
−2.48
0.50
0.64

1945
0.02
0.05
0.21
0.96
−2.46
0.51
0.63

1875
0.02
0.04
0.21
0.96
−2.44
0.53
0.61

310.5
0.00
0.02
0.03
0.02
0.16
0.21
0.13

1470
0.01
0.02
0.15
0.90
−2.84
0.08
0.42

2681
0.03
0.10
0.28
0.99
−2.21
0.89
0.92

69,711
89,171
31,380
80,241
11,107
16,568
55,550
16,371

the baited hair snares, with posterior mean β2 = 0.50 (95% CI = 0.08–0.89).
Estimates for phunt suggest about 21% of this population was harvested and
reported to officials (Table 3).
As suspected by Dreher et al. (2007), we found evidence of individual
heterogeneity in detection from hair snares, with posterior median σγ = 0.63
(95% CI = 0.42–0.92). Because unmodeled individual heterogeneity tends to
cause underestimation of abundance, this likely explains our posterior distribution for N having support at higher values than the original estimates
using models that did not account for individual heterogeneity. For example,
Dreher et al. (2007) estimated N = 1882 with a 95% confidence interval of
1389–2551 for model Mhunt,b using the misidentification model proposed by
Lukacs and Burnham (2005).
We estimated posterior mean α = 0.95 (95% CI = 0.90–0.99), with slight
evidence of higher misidentification probabilities from the hair-snare samples than from the auxiliary hair samples collected from harvested bears
(Figure 2). The auxiliary genotyping error data proved quite informative;
the analogous analysis using an uninformative Beta(1, 1) prior on α yielded
posterior median N = 1436 (95% CI = 988–2203; Figure 1) and posterior
mean α = 0.77 (95% CI = 0.61–0.95; Figure 2). In the absence of prior information, the recorded histories may only provide minimal information about
misidentification, such as the range of α for which there is very little support.
Put another way, the frequencies of potential ghost histories alone suggest
α > 0.55. If α were in fact ≪0.55, we would expect many more ghost histories to have been observed relative to the observed nonghost histories [see
Section 4.1 in Link et al. (2010) for further discussion]. Nevertheless, when
using the informative prior for α, we found relatively little contrary information about misidentification from the recorded histories. Given this prior

18

MCCLINTOCK, BAILEY, DREHER AND LINK

Fig. 2. Posterior (solid lines) and prior (dashed lines) densities for the probability of
correctly genotyping DNA hair-snare samples (α) collected from black bears in the Northern
Lower Peninsula of Michigan, USA. Results are for analyses using an uninformative prior
(light) and an informative prior (dark) on α.

sensitivity, care should be taken in specifying informative priors for α. For
example, there could be reason to suspect that hair samples collected from
harvested bears are of higher quality than hair-snare samples (e.g., due to
degradation by environmental factors), in which case hair-snare misidentification could potentially be underestimated (and abundance overestimated)
from this prior.
3.2. Blue Ridge two-lined salamanders. Bailey (2004) conducted a laboratory experiment evaluating the ability of observers to individually identify Blue Ridge two-lined salamanders (Eurycea bislineata wilderae) marked
with a subcutaneous injection of elastomer (a silicone-based material manufactured by Northwest Marine Technology, Inc., Shaw Island, Washington,
USA). Out of a pool of 20 marked salamanders, each of 14 observers viewed
10 randomly chosen individuals. Two different lights were used for viewing
the marks: a dive light with blue filter lens (hereafter blue light) and a deep
blue 7-LED flashlight (hereafter black light). Observers first viewed each
salamander with one light (randomly assigned), and then the 10 individuals
were re-randomized and presented to the observers for identification using
the other light. Bailey (2004) found no difference in observer ability to correctly identify individuals based on the light used, but found mark quality
strongly influenced observers’ ability to correctly identify individuals. For example, one individual salamander accounted for 10 of 15 misidentifications
resulting from missed marks (because one of its marks was quite small).
This laboratory experiment affords an opportunity to apply model Mt,αh
on a population of known size (N = 20) with no individual variation in detection and suspected individual variation in misidentification probability.

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

19

Although some ghosts were identified by multiple observers, here we analyze
a subset of T = 8 observers for which all ghost encounter histories contain
a single detection and no identification errors matched a legitimate individual (thus satisfying these assumptions of the model). Because the true
encounter history for each marked individual was known, recorded history
data were simply generated from the true histories. For example, suppose
an individual was presented to 4 of the 8 observers and, using the blue light,
they recorded the true encounter history .12...21 (where a dot indicates this
individual was not presented to the corresponding observer), then the blue
light recorded histories spawned from this true encounter history would be
01000001, 00100000 and 00000010. We performed separate analyses for the
blue and black light recorded histories to examine potential differences in
misidentification probabilities, as well as our model’s ability to accurately
estimate the number of salamanders used in the experiment.
Allowing for temporal variation in detection and individual variation in
misidentification probability, we modify the posterior and MCMC algorithm described in Section 2.2.2 accordingly. Setting pit = pt and assuming
pt |ap , bp ∼ Beta(ap , bp ), pt can be updated from the full conditional distriP
PM
bution: pt |· ∼ Beta(ap + M
i=1 qi I(hit > 0), bp +
i=1 qi I(hit = 0)). We used
weakly informative priors by setting µµα = 0, σµ2 α = 10, aψ = 10−6 , and
aσε = bσε = ap = bp = bψ = 1.
For both the blue and black light analyses, we obtained three chains of
10 million iterations after initial pilot tuning and a burn-in of 500,000 iterations from overdispersed starting values. With M = 200, our analyses
required about 2 hrs to complete. As in the black bear example, relatively
slow mixing necessitated long runs, likely due to correlated parameters and
low movement rates for the MH sampler. For both analyses, all univariate GRB diagnostics were <1.05 and the multivariate GRB diagnostic was
<1.008 for monitored parameters (N, pt , µα , σε2 , α). Based on sample autocorrelations, mixing was somewhat slower for several parameters in the blue
light analyses, but all effective sample sizes exceeded 8000 for both analyses.
For the blue light analysis, we found posterior median N = 20 with a 95%
credible interval of 18–23. For the black light analysis, we found posterior
median N = 21 (95% CI = 19–25) (Table 4). Hence, our model was able to
reliably estimate N using either light source. As in Bailey (2004), we found
misidentification probabilities
were similar for the blue and black lights, with
R∞
posterior mean ᾱ = −∞ Φ(µα + ε)[ε|σε2 ] dε = 0.88 (95% CI = 0.74–0.97) and
0.88 (95% CI = 0.76–0.97), respectively. We found some evidence of individual heterogeneity in misidentification probabilities attributable to variable
mark quality, with posterior median σε = 1.34 (95% CI = 0.54–4.51) and
σε = 1.07 (95% CI = 0.50–3.45) for the blue and black lights, respectively.

20

Blue light

Black light

95%
Parm.
N
p1
p2
p3
p4
p5
p6
p7
p8
µα
σε
α

Mean
19.8
0.51
0.51
0.51
0.51
0.51
0.51
0.51
0.51
2.37
1.65
0.88

Median
20
0.51
0.51
0.51
0.51
0.51
0.51
0.51
0.51
2.06
1.34
0.89

Mode
20
0.51
0.50
0.51
0.51
0.51
0.50
0.51
0.50
1.62
0.88
0.90

SD
1.3
0.11
0.11
0.11
0.11
0.11
0.11
0.11
0.11
1.11
1.06
0.06

LCI
18
0.30
0.30
0.30
0.30
0.30
0.30
0.30
0.30
1.05
0.54
0.74

95%
UCI
23
0.72
0.72
0.72
0.72
0.72
0.72
0.72
0.72
5.37
4.51
0.97

ESS
11,935
1,378,542
1,383,346
1,379,963
1,381,844
1,389,232
1,379,287
1,384,098
1,381,843
8667
8264
58,385

Mean
21.3
0.47
0.47
0.47
0.43
0.47
0.47
0.47
0.47
2.06
1.30
0.88

Median
21
0.47
0.47
0.47
0.43
0.47
0.47
0.47
0.47
1.83
1.07
0.89

Mode
21
0.46
0.47
0.47
0.42
0.47
0.47
0.47
0.47
1.59
0.79
0.90

SD
1.7
0.11
0.11
0.11
0.10
0.11
0.11
0.11
0.11
0.88
0.80
0.05

LCI
19
0.27
0.27
0.27
0.24
0.27
0.27
0.27
0.27
1.02
0.50
0.76

UCI
ESS
25
34,562
0.68 924,064
0.68 925,735
0.68 922,474
0.64 1,175,373
0.68 924,540
0.68 924,655
0.68 920,696
0.68 927,481
4.44
11,134
3.45
10,593
0.97
71,694

MCCLINTOCK, BAILEY, DREHER AND LINK

Table 4
Posterior summaries and effective sample sizes (ESS) for model Mt,αh using salamander data generated from laboratory experiments
evaluating the effectiveness of a subcutaneously injected marking material with two light sources (blue and black). The population was of
known size (N = 20) with 8 total misidentifications (0–3 per individual) using the blue light and 9 total misidentifications (0–2 per
individual) using the black light

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

21

4. Discussion. We have presented a general model formulation and
MCMC model-fitting algorithm for capture–recapture models allowing for
misidentification and individual heterogeneity in parameters. Our approach
is computationally more demanding than the closed population misidentification model proposed by Lukacs and Burnham (2005), implemented in
Program MARK [White and Burnham (1999)], that allows for individual
heterogeneity in detection probability using a finite mixture distribution.
However, Lukacs and Burnham (2005) do not properly account for misidentification [Yoshizaki (2007), Link et al. (2010), Yoshizaki et al. (2011)], and
their approach performs particularly poorly when detection probabilities
are too low (<0.1) or too high (>0.3), as well as when α < 0.95 [Lukacs
and Burnham (2005)]. The computational cost of our approach may therefore be worth the additional effort, but similar to Link et al. (2010), the
computational demands of using basis vectors to propose x (and allocate h
accordingly) can be impractical for large T . These computational demands
can be somewhat reduced by eliminating basis vectors that will always produce negative latent history frequencies for a given f , but in the absence of
gains in computing power, more efficient methods for evaluating equation
(2) will likely be needed for T > 10.
Owing to the complexity of the model, we found mixing to be relatively
slow and recommend long runs when implementing our proposed MCMC
algorithm. Other capture–recapture models of somewhat similar complexity
have also exhibited slow mixing that is likely due to correlated parameters
[e.g., Fienberg, Johnson and Junker (1999), Bonner and Schofield (2013),
Link (2013)] and low movement rates for the MH sampler [e.g., Link et al.
(2010)]. Computational efficiency could potentially be improved by accounting for individual heterogeneity using observed or “semi-complete” data likelihoods in place of complete data likelihoods [Fienberg, Johnson and Junker
(1999), Bonner and Schofield (2013), R. King, B. T. McClintock, D. Kidney and D. L. Borchers, unpublished manuscript]. Capture–recapture data
tend to be somewhat sparse, and in application many of the possible latent
histories could have very low probability. Instead of drawing basis vectors
with equal probability in step (a) of the algorithm described in Section 2.2.1,
movement rates of the MH sampler could potentially be improved by drawing r with probabilities proportional to those of the corresponding latent
histories proposed by each basis vector.
Alternative models have been proposed for handling matching uncertainty
in wildlife populations [e.g., Wright et al. (2009), Tancredi et al. (2013)] or
“record linkage” in human populations [e.g., Tancredi and Liseo (2011)].
These approaches rely on auxiliary information, such as genotype or family
name, to match recorded histories, but they do not account for individual
heterogeneity in parameters. By integrating a simpler form of record linkage
and individual heterogeneity into a unified missing data framework, our

22

MCCLINTOCK, BAILEY, DREHER AND LINK

work constitutes a step toward the “grand synthesis” identified by Fienberg
and Manrique-Vallier (2009) in the context of multiple recapture estimation,
but further development is needed to integrate auxiliary information into the
matching process.
To facilitate Bayesian inference using our approach, we extended standard
probit regression techniques to latent multinomial models where both the dimension and zeros of the response are unobserved due to imperfect detection
and misidentification. We note that in the absence of misidentification (i.e.,
α = 1), our probit model provides a convenient Gibbs sampler for Bayesian
analysis of traditional closed population capture–recapture data with heterogeneous detection probabilities. By avoiding the need to tune proposal
distributions, our probit formulation is potentially a more efficient alternative to traditional capture–capture models that rely on the logit link function
to account for variability in detection probability or other parameters. However, we note that the logit link is sometimes desirable due to its ease of
interpretation of the resulting odds-ratio; recent work by Polson, Scott and
Windle (2013) could potentially be adapted to yield a Gibbs sampler for
capture–recapture models using the logit link.
Capture–recapture models are more robust to individual capture heterogeneity when absolute abundance is not the focal parameter [e.g., Williams,
Nichols and Conroy (2002)]. In this case, it may be more sensible to focus on individual heterogeneity in demographic parameters, such as survival
probability [e.g., Royle (2008), Gimenez and Choquet (2010)]. A similarlystructured MCMC algorithm to those described in Sections 2.2.1 and 2.2.2
can be employed for other capture–recapture models extended for misidentification, including open population models, such as the Cormack–Jolly–
Seber (CJS) and more recent multi-state formulations [e.g., Pradel (2005),
Morrison et al. (2011)]. This is accomplished by substituting the desired
form for the likelihood [h|θ, ρ] in equation (3) and assigning corresponding
priors for θ and ρ. The proposal density [h∗ |h, θ, ρ] and the set of basis vectors {v} used to update h and x, respectively, will depend on the particular
model and the relationship between recorded and latent histories (formally
described by A).
Bonner and Holmberg (2013) and McClintock et al. (2013a) recently developed methods for integrated analyses of multiple sources of capture–
recapture data, such as those arising from photo and DNA records. The
methods developed in this paper for incorporating parameter heterogeneity
could be extended to these latent multinomial models as well. Covariates
explaining individual heterogeneity in parameters [e.g., King, Brooks and
Coulson (2008)] could also be accommodated. While we have generalized
the approach of Link et al. (2010) to a broader suite of misidentification
models, we have maintained several key assumptions that may not be reasonable for many passive sampling data sets (e.g., those based on visual

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

23

sightings). Some challenging (but needed) extensions include the evolving
mark problem examined by Yoshizaki et al. (2009), allowing for ghost histories to consist of multiple encounters, and allowing identification errors to
match legitimate individuals.
Acknowledgments. D. Etter and P. Lukacs for helpful discussions and
assistance with the bear data. K. Scribner and S. Winterstein for pivotal
roles in the bear study. D. Johnson for helpful discussions. The findings and
conclusions in the paper are those of the author(s) and do not necessarily
represent the views of the National Marine Fisheries Service, NOAA. Any
use of trade, product or firm names does not imply an endorsement by the
US Government.
REFERENCES
Albert, J. H. and Chib, S. (1993). Bayesian analysis of binary and polychotomous
response data. J. Amer. Statist. Assoc. 88 669–679. MR1224394
Bailey, L. L. (2004). Evaluating elastomer marking and photo-identification methods
for terrestrial salamanders: Marking effects and observer bias. Herpetological Review 35
38–41.
Basu, S. and Ebrahimi, N. (2001). Bayesian capture–recapture methods for error detection and estimation of population size: Heterogeneity and dependence. Biometrika 88
269–279. MR1841274
Bonner, S. J. and Holmberg, J. (2013). Mark-recapture with multiple, non-invasive
marks. Biometrics 69 766–775. MR3106605
Bonner, S. J. and Schofield, M. R. (2013). MC(MC)MC: Exploring Monte Carlo
integration with MCMC for mark-recapture models with individual covariates. Methods
in Ecology and Evolution. DOI:10.1111/2041-210X.12095.
Castledine, B. J. (1981). A Bayesian analysis of multiple-recapture sampling for a closed
population. Biometrika 68 197–210. MR0614956
Coull, B. A. and Agresti, A. (1999). The use of mixed logit models to reflect heterogeneity in capture–recapture studies. Biometrics 55 294–301.
Darroch, J. N. (1958). The multiple-recapture census. I. Estimation of a closed population. Biometrika 45 343–359. MR0119360
Dorazio, R. M. and Rodriguez, D. T. (2012). A Gibbs sampler for Bayesian analysis
of site-occupancy data. Methods in Ecology and Evolution 3 1093–1098.
Dreher, B. P., Winterstein, S. R., Scribner, K. T., Lukacs, P. M., Etter, D. R.,
Rosa, G. J. M., Lopez, V. A., Libants, S. and Filcek, K. B. (2007). Noninvasive estimation of black bear abundance incorporating genotyping errors and harvested
bears. Journal of Wildlife Management 71 2684–2693.
Fienberg, S. E., Johnson, M. S. and Junker, B. W. (1999). Classical multilevel and
Bayesian approaches to population size estimation using multiple lists. J. Roy. Statist.
Soc. Ser. A 162 383–406.
Fienberg, S. E. and Manrique-Vallier, D. (2009). Integrated methodology for multiple
systems estimation and record linkage using a missing data formulation. AStA Adv.
Stat. Anal. 93 49–60. MR2476299
George, E. I. and Robert, C. P. (1992). Capture–recapture estimation via Gibbs sampling. Biometrika 79 677–683. MR1209469

24

MCCLINTOCK, BAILEY, DREHER AND LINK

Gimenez, O. and Choquet, R. (2010). Individual heterogeneity in studies on marked
animals using numerical integration: Capture–recapture mixed models. Ecology 91 951–
957.
Hall, A. J., McConnell, B. J. and Barker, R. J. (2001). Factors affecting first-year
survival in grey seals and their implications for life history strategy. Journal of Animal
Ecology 70 138–149.
Hastings, K. K., Hiby, L. A. and Small, R. J. (2008). Evaluation of a computer-assisted
photograph-matching system to monitor naturally marked harbor seals at Tugidak
Island, Alaska. Journal of Mammalogy 89 1201–1211.
Johnson, D. S., Conn, P. B., Hooten, M. B., Ray, J. C. and Pone, B. A. (2013).
Spatial occupancy models for large data sets. Ecology 94 801–808.
Karanth, K. U. and Nichols, J. D. (1998). Estimation of tiger densities in India using
photographic captures and recaptures. Ecology 79 2852–2862.
Kauffman, M. J., Frick, W. F. and Linthicum, J. (2003). Estimation of habitatspecific demography and population growth for peregrine falcans in California. Ecological Applications 13 1802–1816.
Kernighan, B. W. and Ritchie, D. M. (1988). The C Programming Language, 2nd ed.
Prentice Hall, Englewood Cliffs, NJ.
King, R. and Brooks, S. P. (2008). On the Bayesian estimation of a closed population
size in the presence of heterogeneity and model uncertainty. Biometrics 64 816–824.
MR2526632
King, R., Brooks, S. P. and Coulson, T. (2008). Analyzing complex capture–recapture
data in the presence of individual and temporal covariates and model uncertainty.
Biometrics 64 1187–1195. MR2522267
Langtimm, C. A., O’Shea, T. J., Pradel, R. and Beck, C. A. (1998). Estimates of
annual survival probabilities for adult Florida manatees Trichechus manatus latirostris.
Ecology 79 981–997.
Link, W. A. (2013). A cautionary note on the discrete uniform prior for the binomial N.
Ecology 94 2173–2179.
Link, W. A., Yoshizaki, J., Bailey, L. L. and Pollock, K. H. (2010). Uncovering a
latent multinomial: Analysis of mark-recapture data with misidentification. Biometrics
66 178–185. MR2756704
Lukacs, P. M. and Burnham, K. P. (2005). Estimating population size from DNAbased closed capture–recapture data incorporating genotyping error. Journal of Wildlife
Management 69 396–403.
Mackey, B. L., Durban, J. W., Middlemas, S. J. and Thompson, P. M. (2008).
A Bayesian estimate of harbour seal survival using sparse photo-identification data.
Journal of Zoology 274 18–27.
Manrique-Vallier, D. and Fienberg, S. E. (2008). Population size estimation using
individual level mixture models. Biom. J. 50 1051–1063. MR2649394
McClintock, B. T., Conn, P. B., Alonso, R. S. and Crooks, K. R. (2013a). Integrated modeling of bilateral photo-identification data in mark-recapture analyses.
Ecology 94 1464–1471.
McClintock, B. T., Hill, J. M., Fritz, L., Chumbley, K., Luxa, K. and
Diefenbach, D. R. (2013b). Mark-resight abundance estimation under incomplete identification of marked individuals. Methods in Ecology and Evolution.
DOI:10.1111/2041-210X.12140.
Morrison, T. A., Yoshizaki, J., Nichols, J. D. and Bolger, D. T. (2011). Estimating
survival in photographic capture–recapture studies: Overcoming misidentification error.
Methods in Ecology and Evolution 2 454–463.

PROBIT CAPTURE–RECAPTURE MISIDENTIFICATION MODELS

25

Otis, D. L., Burnham, K. P., White, G. C. and Anderson, D. R. (1978). Statisticalinference from capture data on closed animal populations. Wildlife Monographs 62 7–
135.
Pledger, S. (2000). Unified maximum likelihood estimates for closed capture–recapture
models using mixtures. Biometrics 56 434–442.
Plummer, M., Best, N., Cowles, K. and Vines, K. (2006). CODA: Convergence diagnosis and output analysis for MCMC. R News 6 7–11.
Polson, N. G., Scott, J. G. and Windle, J. (2013). Bayesian inference for logistic
models using Pólya–Gamma latent variables. J. Amer. Statist. Assoc. 108 1339–1349.
MR3174712
Pradel, R. (2005). Multievent: An extension of multistate capture–recapture models to
uncertain states. Biometrics 61 442–447. MR2140915
R Core Team (2012). R: A Language and Environment for Statistical Computing. R
Foundation for Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0.
Royle, J. A. (2008). Modeling individual effects in the Cormack–Jolly–Seber model: A
state-space formulation. Biometrics 64 364–370, 664. MR2432405
Royle, J. A., Dorazio, R. M. and Link, W. A. (2007). Analysis of multinomial models
with unknown index using data augmentation. J. Comput. Graph. Statist. 16 67–85.
MR2345748
Ruell, E. W., Riley, S. P. D., Douglas, M. R., Pollinger, J. P. and Crooks, K. R.
(2009). Estimating bobcat population sizes and densities in a fragmented urban landscape using noninvasive capture–recapture sampling. Journal of Mammalogy 90 129–
135.
Tancredi, A. and Liseo, B. (2011). A hierarchical Bayesian approach to record linkage
and population size problems. Ann. Appl. Stat. 5 1553–1585. MR2849786
Tancredi, A., Auger-Méthé, M., Marcoux, M. and Liseo, B. (2013). Accounting for
matching uncertainty in two stage capture–recapture experiments using photographic
measurements of natural marks. Environ. Ecol. Stat. 20 647–665. MR3128764
Thompson, S. K. (1992). Sampling. Wiley, New York. MR1193031
White, G. C. and Burnham, K. P. (1999). Program MARK: Survival estimation from
populations of marked animals. Bird Study 46 Supplement 120–138.
Williams, B. K., Nichols, J. D. and Conroy, M. J. (2002). Analysis and Management
of Animal Populations. Academic Press, San Diego, CA.
Wright, J. A., Barker, R. J., Schofield, M. R., Frantz, A. C., Byrom, A. E.
and Gleeson, D. M. (2009). Incorporating genotype uncertainty into mark-recapturetype models for estimating abundance using DNA samples. Biometrics 65 833–840.
MR2649856
Yip, P. S. F., Bruno, G., Tajima, N., Seber, G. A. F., Buckland, S. T., Cormack, R. M., Unwin, N., Chang, Y. F., Fienberg, S. E., Junker, B. W., LaPorte, R. E., Libman, I. M. and McCarty, D. J. (1995a). Capture–recapture and
multiple-record systems estimation I: History and theoretical development. American
Journal of Epidemiology 142 1047–1058.
Yip, P. S. F., Bruno, G., Tajima, N., Seber, G. A. F., Buckland, S. T., Cormack, R. M., Unwin, N., Chang, Y. F., Fienberg, S. E., Junker, B. W., LaPorte, R. E., Libman, I. M. and McCarty, D. J. (1995b). Capture–recapture and
multiple-record systems estimation II: Applications in human diseases. American Journal of Epidemiology 142 1059–1068.
Yoshizaki, J. (2007). Use of natural tags in closed population capture–recapture studies:
Modeling misidentification. Ph.D. thesis, North Carolina State Univ., Raleigh, NC.

26

MCCLINTOCK, BAILEY, DREHER AND LINK

Yoshizaki, J., Pollock, K. H., Brownie, C. and Webster, R. A. (2009). Modeling
misidentification errors in capture–recapture studies using photographic identification
of evolving marks. Ecology 90 3–9.
Yoshizaki, J., Brownie, C., Pollock, K. H. and Link, W. A. (2011). Modeling
misidentification errors that result from use of genetic tags in capture–recapture studies.
Environ. Ecol. Stat. 18 27–55. MR2783681
B. T. McClintock
National Marine Mammal Laboratory
Alaska Fisheries Science Center, NOAA-NMFS
7600 Sand Point Way NE
Seattle, Washington 98115
USA
E-mail: brett.mcclintock@noaa.gov
B. P. Dreher
Colorado Parks and Wildlife
4255 Sinton Road
Colorado Springs, Colorado 80907
USA
E-mail: brian.dreher@state.co.us

L. L. Bailey
Department of Fish, Wildlife,
and Conservation Biology
Colorado State University
Fort Collins, Colorado 80523
USA
E-mail: larissa.bailey@colostate.edu
W. A. Link
USGS Patuxent Wildlife
Research Center
12100 Beech Forest Road
Laurel, Maryland 20708
USA
E-mail: wlink@usgs.gov

