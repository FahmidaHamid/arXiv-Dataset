A thermodynamical perspective of immune capabilities
Elena Agliari∗, Adriano Barra† Francesco Guerra‡, Francesco Moauro§

arXiv:1105.3146v2 [physics.bio-ph] 6 Apr 2012

April 9, 2012

Abstract
We consider the mutual interactions, via cytokine exchanges, among helper lymphocytes, B lymphocytes and killer lymphocytes, and we model them as a unique system by means of a tripartite network.
Each part includes all the different clones of the same lymphatic subpopulation, whose couplings to the
others are either excitatory or inhibitory (mirroring elicitation and suppression by cytokine). First of
all, we show that this system can be mapped into an associative neural network, where helper cells
directly interact with each other and are able to secrete cytokines according to “strategies” learnt by
the system and profitable to cope with possible antigenic stimulation; the ability of such a retrieval
corresponds to a healthy reaction of the immune system. We then investigate the possible conditions for
the failure of a correct retrieval and distinguish between the following outcomes: massive lymphocyte
expansion/suppression (e.g. lymphoproliferative syndromes), subpopulation unbalance (e.g. HIV, EBV
infections) and ageing (thought of as noise growth); the correlation of such states to auto-immune diseases
is also highlighted. Lastly, we discuss how self-regulatory effects within each effector branch (i.e. B and
killer lymphocytes) can be modeled in terms of a stochastic process, ultimately providing a consistent
bridge between the tripartite-network approach introduced here and the immune networks developed in
the last decades.
Keywords: Theoretical Immunology, Statistical Mechanics, Autoimmunity

1

Introduction

The immune system is one of the most advanced and complex biological systems, made up of many different
kinds of cells, and hundreds of different chemical messengers, which must be properly orchestrated for
ensuring a safe collective performance, that is, to protect the host body against foreign organisms and
substances, also recognizing objects as either damaging or non-damaging. The system includes different
classes of cells working as “soldiers” and different classes of proteins working as “weapons”, each carrying out
specialized functions (e.g. alert, activate, engulf, kill, clean up, etc.); all the immune cells synthesize and
secrete special proteins that act as antibodies, regulators, helpers or suppressors of other cells in the whole
process of defending against invaders.
Like the nervous system, the immune system performs pattern recognition, learns and retains a memory
of the antigens that it has fought off. Accomplishing such complex tasks requires the cooperation (via cellto-cell contacts and exchanges of secreted messengers) among a huge number of components and this allows
for using the methods and the concepts of statistical mechanics. Indeed, a systemic viewpoint, embedded in
a statistical mechanics framework, may be a strategic approach to evidence which are the key mechanisms
underlining the (mis)functioning of the system and therefore to prevent diseases and derangements.
∗ Dipartimento di Fisica, Università di Parma, viale G.P. Usberti 7/A, 43100 Parma (Italy) and INFN, Gruppo collegato di
Parma (Italy)
† Dipartimento di Fisica, Sapienza Università di Roma, Piazzale A. Moro 2, 00185 Roma (Italy) and GNFM, Gruppo di
Roma1 (Italy)
‡ Dipartimento di Fisica, Sapienza Università di Roma, Piazzale A. Moro 2, 00185 Roma (Italy) and INFN, Gruppo di Roma1
(Italy)
§ Dipartimento di Fisica, Sapienza Università di Roma, Piazzale A. Moro 2, 00185 Roma (Italy)

1

Basically, the architecture of the model we introduce keeps track of the (manifest) interactions among
agents, while statistical mechanics gives the rules, through thermodynamical variational principles, and
ultimately allows to uncover the key mechanism and, possibly, hidden correlations.
Beyond a general picture, the particular phenomenon we want to deepen and explain in terms of a cooperative behavior of immune cells is the emergence and the effects of lymphocytosis (i.e. an abnormal
immune response by lymphocytes): The correlation between a strong lymphocytosis and autoimmune manifestations is a well-known experimental finding for which a plethora of interpretations and descriptions have
been provided, yet a unifying, sytematic picture is still missing [1, 2, 3, 4, 5, 6, 7]. Essentially, two types of
lymphocytosis exist: as a response to a pathogen (i.e. Epstein-Barr virus, EBV, or Human immunodeficiency
virus, HIV, etc), which may affect the host for a while and then disappear, becoming latent (and is coupled with a short term or pulsed autoimmunity) [8, 9], and as Autoimmune Lymphoproliferative Syndrome
(ALPS), a chronic lymphocytosis due to the lack, in killer cells, of the Fas genetic expression, a regulatory
intracellular mechanism that induces the apoptosis [10, 11]. ALPS is a severe disease which develops in
strong, persistent, autoimmune manifestations and, despite well understood at micro (genetic) and macro
(clinical) levels of description, a consistent, merging description is still missing [12].
The model we introduce includes effector cells (killer lymphocytes TK and B cells) and helper cells
TH , whose mutual interactions, occurring via cytokines exchange, give rise to a network, where helpers are
connected to both effector cells (B, TK ), while there is no direct connection among the latter. Since the effect
of cytokines exchanged can be either excitatory or inhibitory, this realizes a tripartite spin-glass system. We
firstly show that such a system is equivalent to an associative neural network where helper cells are able,
thanks to a cooperative synergy, to perform retrieval of “strategies” learnt by the system and profitable to
cope with possible antigenic stimulation. Hence, the ability of such a retrieval corresponds to a healthy
reaction of the immune system.
A state of poly-clonal lymphocytosis is then realized by increasing the average size of effector populations, hence mimicking a persistent clonal expansion. Interestingly, we find that this alteration is formally
equivalent to a random field acting on helper cells, which induces “disorder” within the system. As we will
explain, this can be read from a thermodynamic perspective: The presence of a (sufficiently large) antigenic
concentration induces the system to do some “work” (a clonal expansion), which turns out to be split in
an internal energy term (necessary to make the network able to recognize) and in a heat term (emerging
as an unavoidably feature of this conversion). Otherwise stated, it is not possible to obtain an extensive
immune response (a clonal expansion of B or TK cells), which play the role of a “work” (as it is an ordered
result), without introducing some noise (heat) in the network of interacting cells, the whole resembling the
well known principles of thermodynamics.
Furthermore, we find that the average extent of effector population must range within a given interval
in order for the system to be performing: If the population is too small, the interplay among components is
too weak in order to establish a mutual interaction and regulation; on the contrary, if, e.g. due to a strong
immune response, the population gets too large, the level of noise in the network may become so high that
the system starts to fail to select the right strategies to fight, and ultimately, it attacks the self, producing
the autoimmune response. Similarly, we will show that if the balance between lymphocyte sub-populations is
lost (as it happens in HIV and EBV infections), another kind of “noise” prevails and, again, the system is no
longer able to work correctly. Bad signaling can also prevail due to a progressive growth of the randomness
in the stochastic process we consider; increasing white noise corresponds to an aging process, consistently
with the evidenced malfunctioning of elder systems: Debris from e.g. lysis of infected cells by killers, may
act as “dust” in the ‘gears” of pattern recognitions.
Hence, our model highlights three ways to escape from the “healthy region”: massive clonal expansion/suppression, unbalance in subpopulations, aging. Despite not yet quantitatively comparable to real
data, a clear theory of this mechanism opens completely new paths to deal with autoimmune diseases, which
affects almost one fourth of the worldwide population [13].
The paper is organized as follows: in Sec. 2 we describe, from an immunological point of view, the agents
making up the system we are focusing on; in Sec. 3 we describe in details the formal model used to describe
the system itself, and in Sec. 4 we analyze its behavior, stressing the conditions leading to an incorrect

2

performance; our conclusions and perspectives are collected in Sec. 5. The technical passages involved in
the statistical mechanics analysis of our model are gathered in the appendices, together with a discussion on
the hidden effects of mutual interactions within the effector branches.

2

The immunological scenario

The system we are focusing on provides a modeling for the interplay among lymphocytes (B cells, TK cells
and TH cells) mediated by cytokines (interleukin family, interferon family, etc.); before proceeding, we sketch
the main functions of such agents [1] and of some pathologies (e.g. HIV infection or ALPS), which stem
from an improper functioning of these agents.
B lymphocytes. The main role of these cells is to make antibodies (primarily against antigens 1 ) and to
develop into memory B cells after activation by antigen interaction. When receptors on the surface of a B
cell match the antigens present in the body, the B cell (aided by helper T cells) proliferates and differentiates
into effector cells, which secrete antibodies with binding sites identical to those displayed by receptors on
the ancestor-cell surface (hypersomatic mutation apart [1]), and into memory cells, which survive for years
preserving the ability to recognize the same antigen during a possible re-exposure. According to the shape
of the receptors they display, B cells are divided into clones: cells belonging to the same clone can recognize
and bind the same specific macromolecules (epitopes) of a given antigen. A set of up to 109 different clones
allows for deeply diverse and specific immune responses.
Another important role of B cells is to perform as antigen-presenting cells (APC) to other agents; this
makes B cells able to interact with (mature) T cells, through the so-called “immunological synapse”.Indeed,
the recognition of an antigen is not sufficient for B cell activation: An additional signal from helper T cells
is in order and this is realized by means of chemical messengers (cytochines, see below) secreted by the
matching T cell [14].
TK lymphocytes. Cytotoxic CD8+ cells (also known as “Killer cells") belong to the group of T lymphocytes. TK cells are capable of inducing the death of infected, tumoral, damaged or dysfunctional cells.
Analogously to B cells, the activation of cytotoxic T cells requires not only the presence of the antigen, but
also a second signal provided by the cytokines released from helper T cells.
In fact, cytotoxic T cells express receptors (TCRs) that can recognize a specific antigenic peptide bound
to the so called class-I MHC molecules (present on nearly every cell of the body); upon recognition CD8+
cells are regulated by the chemical messengers (cytochines, see below) secreted by active helper T cells. More
precisely, CD8+ cells undergo clonal expansion and differentiation into memory and effector cells with the
help of a cytokine called Interleukin-2; as a result, the number of effector cells for the target antigen increases
and they can then travel throughout the body in search of antigen-positive cells.
TH lymphocytes. Helper CD4+ cells are a sub-group of T lymphocytes that play a crucial role in
optimizing the performance of the immune system. These cells do not posses cytotoxic or phagocytic activity,
neither they can produce antibodies, yet, they are actually fundamental for regulation of the effector branches
of the immunity and this job is basically accomplished by secretion and absorbtion of cytokines.
CD4+ T cells exhibit TCRs with high affinity for the so called class-II MHC proteins, generally found on
the surface of specialized APCs, e.g. dendritic cells, macrophages and B cells. The presentation of antigenic
peptides from APCs to CD4+ T cells provides the first signal, which ensures that only a T cell with a
TCR specific to that peptide is activated. The second signal involves an interaction between specific surface
receptors on the CD4+ and on APC and it licenses the T cell to respond to an antigen. Without it, the T
cell becomes anergic, and does not respond to any antigen stimulation, even if both signals are present later
on. This mechanism prevents inappropriate responses to self, as self-peptides are not usually presented with
suitable co-stimulations [15].
1 A healthy immune system produces also a small amount of self-reactive lymphocytes, whose antibody production is low
and regulated by the network of cells making up the whole system, so that it is not dangerous for the host body [1].

3

Once the two signal activation is complete, the T helper cell proliferates and releases and/or absorbs
regulatory agents called cytokines, then they differentiate into the subfamilies TH1 or TH2 depending on
cytokine environment (however for our purposes this further distinction is not needed).
Cytokines. Cytokines are small cell-signaling proteins secreted and absorbed by numerous cells of the
immune system, functioning as intercellular messengers: Cytokines include e.g. interleukins, interferons and
chemochines.
These are usually produced by stimulated cells and are able to modify the behavior of secreting cells
themselves (autocrine effect) or of others (paracrine effect), not necessarily spatially close (endocrine effect),
inducing growth, differentiation or death. Most cytokines are produced by CD4+ cells and to a lesser degree
by monocytes and macrophages. In general, cytokines display both agonist and antagonist action in such a
way that if the pro-inflammatory milieu exceeds that of the anti-inflammatory mediators the net effect will
result in prolonged inflammation.
Moreover, cytokines attach to receptors on the outside of cells causing the target cell to produce other
cytokines; this complicated relationship is called the cytokine network, and it is one of the most important
ways used by the immune system, spread throughout the body, to communicate and orchestrate appropriate
responses to the various challenges. Indeed, cytokines act as key communicators for immune cells and the
delicate balance in the level of these communicators is vital for health: Many chronic diseases arise due to
a disruption of this balance [16].
In fact, plasma levels of various cytokines may give information on the presence of inflammatory processes
involved in autoimmune diseases such as rheumatoid arthritis, as well as immunomodulatory effects of foods
or drugs; in addition, cytokines play an important part in the progression from HIV infection to AIDS
disease and in many AIDS-related illnesses: In particular, the initial HIV infection disrupts the normal
balance of cytokines by causing the levels of certain cytokines to rise; cytokine imbalances then helps HIV to
target CD4+ cells and the lymph nodes, leading to the progressive immunosuppression and the opportunistic
infections that follow [9, 17].
Autoimmune diseases. These pathologies stem from a failure of the immune system to recognize its host
body as self, and this causes an immune response against host’s own cells and tissues [2, 3, 4, 5, 6, 7].
In the early development of theoretical immunology the main strand to tackle the problem of self/non-self
discrimination by immune cells was the clonal deletion: In the bone-marrow (for the B) or in the thymus
(for the T) all the cells are tested and those self-reacting are deleted in such a way that cells making up
the effective repertoire are only those specific for foreign antigens. Actually, it is now established (both
experimentally and theoretically) that a low level of self-reactivity is normal and even necessary for the
immune system to work properly. From a systemic point of view it is just the synergic interplay between
immune agents, in particular cytokines, immunoglobulins and lymphocytes, that keeps the concentrations of
self-reactive cells at the right values [4, 6, 18, 19].
Lymphocytosis. Lymphocytosis refers to an abnormal increase in the count of white cells (i.e. ≥ 109
cells/litre [1]), sometimes evolving in chronic lymphocytic leukemia. Lymphocytosis can be essentially of two
types, either mono-clonal or poly-clonal, referring to the expansion of a particular clone or of an ensemble;
in this work we deal with the latter. This pathology essentially happens as a response to particularly
“smart” antigens (i.e. EBV, HIV, etc), as a chronic condition of long term infections (i.e. tuberculosis,
brucellosis, syphilis), from malignancies (i.e. leukemia) or, lastly, due to a genetic alteration causing the lack
of lymphocyte apoptosis after their clonal expansion (autoimmune lymphoproliferative syndrome, ALPS).
More precisely, ALPS patients have been found to carry mutations in genes Fas and FasL, which are upstream
effectors of the apoptotic pathway [10, 11]. This inefficacy of apoptosis causes an increase in the number
of lymphocytes in the body, including cells that are too old and less effective, and a consequential bad
regulation of cytokines secretion [20, 21, 22]. As a result, there is the failure of immunological homeostasis,
possibly leading to autoimmunity, and the development of lymphoma. ALPS can be diagnosed by blood
tests; it occurs in both sexes and has been described in patients (mostly children) from all over the world.

4

hi
H

ξ

ξ

B

K
P (b i )

P (k i )

bi

ki
b0

k0

Figure 1: (Color on line) Schematic representation of the tripartite system considered. Each node envisages
a set of B, H, K different clones of B, CD4+ and CD8+ cells respectively. The activity of each clone is
described by a dichotomic variable hi or by a Gaussian variable bi and ki centered around a value k0 and b0 ,
respectively.

ALPS is a rare condition which has been defined only within the past few years; its incidence has not yet
been estimated [23, 24].

3

The model

As anticipated, the protagonists of our model are B cells (which produce antibodies), CD8+ cells (“killers”
which delete infected cells), and CD4+ cells (“helpers” which coordinate the two effector branches) of the
immune response. Each type is constituted by clones with a given specificity and the overall number of
different clones is denoted as B, K and H, respectively. The number of cells making up a given clone is not
constant in time, but may increase due to an antigenic stimulation addressed to the pertaining specificity (the
Burnet clonal expansion [25]); in the following we call “activity” a logarithmic measure of the amplitude of a
clone and we denote it by the set of variables bν (ν ∈ (1, ..., B)), kµ (µ ∈ (1, ...,
PK)), and hi (iP∈ (1, ..., H)),
in
such
a
way
that
the
actual
concentration
of
B
cells,
killers
and
helpers
is
∼
ν exp(bν ), ∼
µ exp(kµ ), ∼
P
i exp(hi ), respectively [18, 19, 26].
Of course, different clones of the same branch can interact with each other (see e.g. [18, 19, 27, 28, 29]);
these interactions, at least for B and TK , play a role in the development of memory of previous antigens
or in self/non-self discrimination and it is effectively accounted for by taking Gaussian distributions for
their activity (as explained in Appendix A), yet, here we focus on the interactions mediated by cytokines
which provide signals acting between CD4+ and B cells, as well as between CD4+ and CD8+ cells. Such
interactions give rise to a tripartite network, where parties are made up of CD4+, B and CD8+ clones,
respectively, and links are drawn whenever interleukins and/or interferons are exchanged among them (see
Fig. 1).
Now, as anticipated, the activity of both effector branches (i.e. CD8+ and B cells), is assumed to be
distributed around a given mean value, which, at equilibrium, must be very small denoting a typical low
activity; in agreement with experimental findings [30] and with the arguments developed in Appendix A, we
say that, at rest, (for any µ, ν) kµ and bν follow a Gaussian distribution N [0, 1], peaked at zero and with
unitary standard deviation. On the other hand, CD4+ cells are described by dichotomic variables, that is
hi = ±1, for any i2 ; positive values mean that the relevant clone is in an active state, namely high rate of
2 This

assumption implicitly suggests that the time scale for helper reaction is slower than those of the branches: indeed in

5

cytokines production, viceversa −1 stands for quiescence. Anyhow, it is worth underlining that the picture
we are going to offer does not depend qualitatively on the kind of distribution, either Gaussian or binary,
chosen for the activity3 .
Finally, the state of cytokines acting between the i-th helper clone and the µ-th B or ν-th killer clone,
is encoded by a dichotomic variable ξiµ = ±1, ξiν = ±1; a positive (negative) value means that there is an
excitatory (inhibitory) stimulation. Here we adopt a minimal assumption and we say that the probability
distributions for ξ is given by P (ξi,µ/ν = 1) = P (ξi,µ/ν = −1) = 1/24 . In the following, the cytokine pattern
{ξiµ , ξiν } is supposed to be quenched and, as we will see, such pattern encodes proper “strategies” learnt by
the system during life and profitable to cope with possible antigenic stimulation5 .

3.1

The statistical mechanics approach

The following analysis addresses the functioning of the system considered, that is, we look at the conditions
for the establishment of stable configurations and/or for the rearrangement of configurations following an
external stimulation.
In order to describe the system we introduce the “Hamiltonian”
H,K
H,B
1 X
−1 X
ξi,µ hi kµ − √
ξi,ν hi bν ,
HH,B,K (h, k, b; ξ) = √
H i,µ
H i,ν

(1)

where the first term accounts for the interactions between clones of CD4+ and CD8+ populations, while the
second term for the interactions between clones of CD4+ and B populations. Following statistical mechanics prescriptions, the Hamiltonian HH,B,K (h, k, b; ξ)6 is nothing but a cost function for the configuration
{hi , kµ , bν }: The smaller its value and the more likely the correspondent configuration; in the jargon of
disordered system, Eq. (1) represents a tripartite spin-glass.
Since the statistical mechanics analysis will be performed in the infinite system size limit, i.e. in the limit
of large H, B and K, we need to specify a meaningful scaling for their ratios by introducing the parameters
α, γ ∈ R+ such that
B
K
α ≡ lim
, γ ≡ lim
.
(2)
H→∞ H
H→∞ H
The performance of the system described by Eq. (1) can then be studied following the standard routine
used for disordered systems [32, 35]. First of all, one calculates the partition function
ZH,B,K (β; ξ)

=

B
XZ Y
{h}

ν=1

dµ(bν )

Z Y
K

dµ(kµ ) exp [−βHH,B,K (h, b, k; ξ)] ,

(3)

µ=1

our perspective the latter act as inputs of information for helpers which then need further time to elaborate and readjust their
state; this is also consistent with the fact that, due to the interplay of the subfamilies TH1 , TH2 , the time needed by helper
cells to respond to a stimulation is relatively large (see for instance the discussion in [31]). Furthermore, if the timescale for
helper cells was faster, their contribution to the potentials V (b) and V (k), introduced in appendix A and ruling the activity of
effector cells, would be zero since the integral over helper states is null.
3 Here we choose the latter for helpers as the discrete nature of h variables is consistent with integrate-and-fire models [32],
where the action of the agent considered (e.g. a neuron, a lymphocyte, etc.) is generated when the received input (e.g. a
voltage, a cytokine concentration, etc.) reaches a threshold, as this will simplify the mathematical handling of our model later
on.
4 The assumption of identically, symmetrically distributed cytokines can be possibly relaxed as done for instance by Amit
[32] in the neural scenario to reflect more realistic biological features.
5 So far we assumed that learning is already achieved during ontogenesis and we focus only on the ability in retrieval of
mature immune systems. However, the model we present, whose associative memory ability is obtained bridging it to an
associative neural network, is a tripartite spin-glass that naturally describes a two-layered restricted Boltzmann machine as
those commonly used to store information in Machine Learning [33, 34].
6 The system considered admits an Hamiltonian representation due to the assumed symmetry in couplings which ensures detailed balance, which, in turn, ensures the existence of canonical equilibrium. Surely a step forward would be the off-equilibrium
analysis of the non-symmetrical version of the model, which may also allow a quantitative matching with experimental data.

6

where dµ(x) represents the Gaussian measure on x, that is exp(−x2 /2), and β ∈ R+ is the degree of (white)
noise in the network: Large values of β (small noise limit) make the Boltzmann weight exp(−βH) more
significant. From the partition function all the thermodynamic observables can be derived: for the generic
continuous function O(h, b, k) one has the so-called Boltzmann state ω(O) as
ω(O) =

B
XZ Y

1
ZH,B,K (β; ξ)

{h}

dµ(bν )

Z Y
K

ν=1

dν(kµ )O(h, b, k) exp [−βHH,B,K (h, b, k; ξ)] .

(4)

µ=1

For our concerns, the main quantity of interest is the free-energy (or pressure), which here, in the infinite
system size limit, can be evaluated as
Aα,γ (β) = lim

H→∞

1
E log ZH,B,K (β; ξ),
H

(5)

where we also applied the average E over all the (quenched) values of {ξiµ , ξiν }, in order to get an estimate
on the typical realization of the cytokine network.
Now, the minimization of the free energy with respect to proper order parameters (see appendix B) is the
main path to follow in order to get the most likely states, as this contemporary entails energy minimization
and entropy maximization; moreover, singularities in any derivative of the free-energy are signatures of phase
transitions demarcating regions (in the α, β, γ space) where the system may or may not work cooperatively
(see e.g. [32]).
Before analyzing Aα,γ (β), we need to compute explicitly the partition function ZH,B,K ; by noticing that
it does not involve two-body interactions within each B, TK branch, but only
P one-body terms in b and k, we
can directly carry out the relevant Gaussian integrals so to get ZH,B,K = {h} exp(−HHopfield (h; ξ)), being
HHopfield the effective Hamiltonian
HHopfield (h; ξ) = −

B
H
K
β X  X µ µ X ν ν
ξi ξj hi hj ,
ξi ξj +
H i<j µ=1
ν=1

(6)

which, interestingly, recovers the Hopfield representation of a neural network (see next subsection) [32, 36].
Such equivalence states that a n-partite spin-glass and a sum of n−1 independent neural networks display
equivalent thermodynamic behaviors (same free-energy, phase diagram, collective properties, etc.).
From an immunological perspective, we see that the behavior of a system where helpers promote/suppress,
via cytokines, the two effector branches underlies an effective system where cytokines directly connect helper
cells via an Hebbian interaction making them able to learn, store and retrieve patterns of branch activations:
B and TK branches work as sources of information (stimulative layers in the neuronal counterpart [33])
for TH ’s, which, in turn, store such information trough effective pairwise interactions (similarly to the
mechanisms applied by neurons [32]).
Finally, we would like to emphasize that this model, although being a minimal one, is able to capture
the crucial traits of the system: Qualitative differences in time-scales as well as the basic properties of
interactions are accounted for, also showing that the description obtained is robust with respect to some
technical details. Moreover, as we will show, the model displays several emerging properties, finely matching
real systems. By the way, the same tripartite system proved to be a proper effective model also for explaining
the emergence of Chronic Fatigue Syndrome [31]: In that case the focus was on the evolution of the synapse
realized by CD4+ cells between CD8+ and B cells, and on the possibility to develop a Pavlovian associative
learning of a prolonged infected status.

3.2

On the mapping with the neural network

As already underlined in the past (see e.g. [18, 29, 31, 37, 38, 39, 40]), there is a strong analogy between
neural and immune systems: Both are able to learn from previous experiences and to exhibit features of
associative memory as pattern recognition [18, 32, 35, 41]. In the following we briefly sketch how neural
7

networks are formalized and how they do perform, also clarifying step by step the immunological counterpart
within our model.
Hopfield neural networks consist of interacting neurons described by the Hamiltonian (see e.g. [32, 42, 43])
HN = −

1 X
Jij σi σj ,
N i<j

where the states (σi = ±1) represent the two main levels of activity (i.e. firing/not-firing a spike) of
the corresponding neuron, while the coupling Jij are the synaptic couplings between pairs of neurons (i, j).
Moreover, one considers P “patterns” (denoted as {ξiµ }µ=1,2,...,P ), which represent the embedded memorizable
information and assumes that, as a result of a learning process, the synapses Jij ({ξ}) bear values which ensure
the dynamic stability of certain neuronal configurations {σi }, corresponding to the memorized patterns; in
this sense the network displays associative memory. In the standard theoretical analysis, the P patterns are
usually taken quenched7 and random, with equal probabilities for ξiµ = ±1. The specific form of storage
prescription usually considered is given by the Hebbian learning rule
Jij =

P
X

ξiµ ξjµ ,

(7)

µ=1

and it is straightforward to see that, by plugging Eq. (7) into HN , once having renamed P as B and K one
recovers each of the terms in Eq. (6).
Hence, in the immunological scenario, each CD4+ cell plays the role of a neuron, and its state (hi = ±1)
represents the two main levels of activity (i.e. secreting/not-secreting a cytokine signal) for the corresponding
specificity. The coupling Jij derives from the combination of the set of cytokines secreted by clones i and
j, respectively: if these clones interact in the same way (ξiµ = ξjµ = ±1) with the clone kµ (bµ ) there is a
positive contribute to the coupling Jij and vice versa. In this way the interaction between different kinds of
lymphocytes is bypassed and allowed for by a direct interaction between CD4+ cells only, which effectively
coordinate the effector responses.
Let us now consider memory features: Patterns are said to be memorized when every network configuration σi = ξiµ for i = 1, ..., N for every of the P patterns labeled by µ, corresponds to free-energy minima
(i.e. stable to all single-state flips), also called attractors. In the immunological scenario patterns can still
be thought of as the “background” of the system, that is, they encode successful “strategies” adopted by the
system during previous diseases and infections and then properly stored for being retrieved in case of future
attack by those antigens. Therefore, we define a “strategy” as a pattern of information that the helpers send
(exchange) to a particular clone of a branch: If, for example, focusing only on B −TH interactions, the
system wants to tackle a response against an antigen and, say, both clones ν1 and ν2 are able to bind to
it, then helpers are expected to arrange in such a way that, according to the values of {ξiν1 , ξiν2 }, both bν1
and bν2 result to be excited, conversely, B cells which do not bind to the antigen are not involved as they
receive suppressive signals8 . Of course, the implicit assumption is that the antigen considered has already
been dealt with and the strategy {ξiν1 , ξiν2 } has been properly stored.
We recall that the retrieval of a strategy is realized when the corresponding activity configuration for
helper lymphocytes, i.e. {hi }, is stable in time, which means that CD4+ cells secrete and absorb cytokines in
a collective fashion. Now, despite the fact that the Jij ’s have been constructed to guarantee certain specified
patterns to be attractors, namely fixed points of the dynamics, the non-linearity of the dynamical process
induces additional non-global minima (linear combinations of pure states), referred to as spurious states
7 It is usually assumed that the performance of the network can be analyzed keeping the synaptic values fixed, or quenched.
This implies that during a typical retrieval time the changes that may occur in synaptic values are negligible.
8 Within our framework, the need for suppression of non-involved clones is clear as they would contribute only raising the
noise level, implying bad functioning and dangerous correlations. This is in agreement with the experimental finding that
(leukemia or lymphocytosis apart which imply a pathological activation of the immune system) the amount of lymphocytes in
the blood is roughly constant over time (ranging from O(1012 ) to O(1014 ), that means on logarithmic average 13 ± 1), which
means that only a very small number of families is activated.

8

[32]: In neural networks such states are considered as erroneous retrieval of an attractor, because the system
is meant to retrieve a given pattern of information at each time, while, in the immunological counterpart,
their interpretation is rather different as their existence allows for broad, parallel immune responses. More
precisely, spurious states realize the overlap of several strategies so that the immune response can address
contemporary different kinds of antigen infections. For instance, if two antigens are contemporary present,
each with high chemical affinity with, say, three different lymphocytes, the helpers would perform parallel
six-strategies by sending the correct signals to the involved cells, eliciting the useful cells and suppressing
the non-involved ones. Incidentally, we notice that Hopfield networks (as actually close to spin-glasses where
the amount of minima scales exponentially with the volume) work much better as spurious state collectors
than pure state retrievers.
In order to quantify the ability of these models in working as associative networks, we consider a set
of order parameters (see also next section), among which the B + K Mattis magnetizations mµ , mν which
measure the overlap of the actual configuration of the helpers with the µ-th and ν-th pattern, that is
mµ ≡

H
1 X µ
ξ hi ,
H i=1 i

mν ≡

H
1 X ν
ξ hi ,
H i=1 i

(8)

both ranging in [−1, 1]. It is easy to see that if the configuration is correlated (uncorrelated) with a given
pattern µ, ν, the corresponding overlap is macroscopic (vanishes ∼ O(1/N )); of course, for full correlation
the overlap is unity.
By tuning the parameters of the system, i.e. the noise level β and the relative size of the branches with
respect to H (namely α, γ), its ability to retrieve varies significantly. Starting from a high level of noise in a
network with a fixed (relative) number of patters α + γ, there exists an ergodic phase and no retrieval can be
accomplished (mµ,ν = 0); indeed, in the limit β → 0, any configuration is equally likely. By decreasing the
noise level one crosses a “spin-glass” phase9 ; the noise level at which this happens is βG (α + γ). Below this
line there is no retrieval (m = 0), yet the system is no longer full-ergodic. Now, if the number of patterns is
larger than a certain critical value, i.e. (α + γ) > [αc (β = ∞) + γc (β = ∞)] = 0.13810 , the reduction of noise
is useless for retrieval. While the existence of such a threshold in α is rather intuitive in neural networks
(because if we try to store too many patterns, then the interference among them becomes large, making them
ultimately unrecognizable), here (α + γ) = (B + K)/H represents the relative ratio among the inner and
the effector branches: As the amount of helpers decreases, the network falls off the retrieval region and the
system is no longer able to display a collective performance; this situation closely resembles the transition
from HIV infection to AIDS (we recall that the immunodeficiency virus kills CD4+ cells). Furthermore,
we notice a nice consistency between the requirement of a low ratio between the effectors and the helpers
expected for a healthy performing system and the fact that antigen recognition is actually spread over the
whole lymphocyte network. In fact, the length of an antibody is L ∼ 102 epitopes; without recognition
spreading (i.e. according to a single particle approach) the system would need O(2L ) = O(2100 ) different
clones to manage antigen attacks. Conversely, the total amount of lymphocytes is estimated to be O(1014 ),
which implies the existence of inner interactions among the clones (see for instance [45] for experimental
findings, [18] for theoretical ones).
On the other hand, for 0.05 < α + γ < 0.138, by further decreasing the level of noise, one eventually
crosses a line βM (α + γ) below which the system develops 2P meta-stable retrieval states, each with a
9 Spin-glasses are complex systems which, above a certain noise threshold (freezing temperature), are ergodic with spins
randomly oriented (paramagnetic phase); at low noise, spin-glasses display a non-ergodic behavior characterized by an enormous
amount of metastable configurations, due to the contradictory (frustrating) interactions preventing long range correlations
between the orientations of the different spins. Hence, freezing takes place with the spins oriented at random with respect to
each other; the magnetization upon freezing is therefore zero, just like in the paramagnetic state. Therefore, in order to evaluate
spin-glass emergence, additional order parameters are necessary, often denoted with q, such that their average can discriminate
between spin-glass freezing (q > 0) and paramagnetism (q > 0), (see also next section).
10 We recall that these values have been calculated for a fully-connected (FC) network, which means than each agent i
is connected to any other agent j 6= i. Actually, real systems display a non-negligible degree of dilution, for this reason a
quantitative comparison should be carried out only once the theory for diluted system will be accomplished, on which we plan
to report soon. Here we just mention that values calculated for FC systems underestimate experimental measures and we know
that, indeed, the introduction of dilution yields a rise in the critical values [44].

9

macroscopic overlap (m 6= 0) with some strategy. Finally, when α + γ < 0.05, a further transition occurs
at βC (α + γ), such that below this line the single-strategy retrieval states become absolute minima of the
free-energy.

4

Poly-clonal activation: formalization and outcomes

The system we described via the Hamiltonian (1) is actually always subjected to external stimuli (viruses,
bacteria, tumoral cells) on the effector branches. As a response to this “work" made on the system, the mean
activation of effectors may vary. Adiabatically (which is the correct limit as we are working in equilibrium
statistical mechanics), this can be modeled by assuming drifted Gaussian distributions for the activity of B
and CD8+ cells, that results in shifting their mean activity levels from zero to positive values b0 and k0 ,
respectively. As the theory is symmetric under the switch bν ↔ kµ , for the sake of simplicity (and with
ALPS scenario in our mind) we can focus only on the CD8+ ensemble and we write
!
!
PK
PK
2
2
µ=1 (kµ − k0 )
µ=1 kµ
⇒ P̃ (k) ∝ exp −
,
(9)
P (k) ∝ exp −
2
2
where we used the bold style to denote a vector. Notice that, for simplicity, we assumed that all clones feel a
stimulus, regardless of their specificity and this corresponds to a mathematical representation of poly-clonal
activation. As a consequence, the partition function (3) turns out to be
ZH,B,K (β) =

B
XZ Y
h

ν

dbν e−

PB
ν

b2ν /2

Z Y
K

dkµ e−

PK
µ

(kµ −k0 )2 /2 −βHH,B,K (h,b,k;ξ)

e

.

(10)

µ

By introducing the change of variables yµ = (kµ − k0 ), we can solve the Gaussian integral and notice that
this maps our original system into one described by the following Hamiltonian
β H̃(h; ξ, Φ) =

B
H
K
H
X
p
β X  X µ µ X ν ν
ξi ξj hi hj + βΦ
ξi ξj +
χi hi ,
H i<j µ=1
ν=1
i=1

(11)

PK
√
where Φ ≡ γk0 is a properly rescaled measure of the mean activity, and χi = √1K µ ξiµ is a random
field, which in the infinite system size limit converges to a standard Gaussian N [0, 1]. From a statistical
mechanics point of view we know that the system with shifted Gaussians for the set of variables kµ can be
recast into the previous one plus an external random field acting on the clones hi and whose strength is set
by k0 , namely the width of TK clonal expansion; otherwise stated, the stimulation of an effector branch acts
as a perturbation on helper activities.
Actually, it is easy to see that a random field also emerges in the presence of a monoclonal activation,
elicited by a given antigen, and, in general, it is able to yield a small activation of arbitrary clones, possible
against self. This picture provided by our model is in agreement with the existence of low-titer self-antibodies
also in hosts not affected by autoimmune diseases. Indeed, the concentration of such byproduct antibodies
allows to determine a reference threshold to discriminate between low and significant activation.
There is another deep implication in the transformation H → H̃, induced by the stimulation: A nonnegligible activation of B or CD8+ lymphocytes (i.e. b0 and/or k0 6= 0) necessarily generates some sort of
disorder (i.e. χ) within the system. Indeed, on the one hand we have an organized immune response due
to effector activation, on the other hand we have an disorganized immune response due to the emergence of
a random perturbation on helper branch. Interestingly, this encodes a basic thermodynamical prescription
(close to the second principle) in the framework of theoretical immunology: an ordered work can not be
accomplished without introducing some sort of disorder inside the system and, the larger the former the
higher the level of noise introduced (note that the Hopfield network “naturally” represents the internal energy
contribution).
10

It is worth remarking that, consistently with this thermodynamical picture, in physics the energy is
coupled with time t√and, typically, ordered energy flows linearly with time (∼ t), while heat (disordered
by looking at eq. (11), we notice that the internal energy is
energy) diffuses (∼ t). In complete analogy,
√
coupled to β, while the heat source with β.
Finally, we stress that the same formalism still holds for lymphocyte suppression, where activation is
shifted towards negative values, again yielding the emergence of a random field which deranges the immune
performance. Indeed, too low levels of activity of effector cells would yield to a lack of communication
among them with consequent falling off of systemic regulation; otherwise stated a non-null activation level
is necessary to maintain a network, that is to encode information [46, 47, 48].

4.1

The statistical mechanics analysis of autoimmunity

In this section we want to investigate how too strong an activity k0  0 (lymphocytosis) can possibly
determine pathological degenerations in the system under consideration (autoimmunity). As we are going
to show, if the activation k0 is too massive, the random-field term in Eq. (11) prevails against the Hopfield
interaction term (responsible for strategy retrieval) such that the system behaves essentially randomly,
inducing wrong signalling among CD4+ cells and other lymphocytes, and consequently auto-immunity. In
general, the ability of the system to retrieve stored patterns depends on the parameter set (β, α + γ, Φ): The
mutual balance between such quantities determines whether, in the presence of a stimulation, the system
succeeds in properly cope with it according to what learned in the past.
The statistical mechanics solution of the model is rather technical and details are left to Appendix B,
while here we sketch the main results. At first, in order to get familiar with the model, we consider a very
simple situation where the antigen is detected only by, say, lymphocyte b1 , so that we simply focus on the
retrieval of the first pure state, that is we look at the regions, in the (α, β, Φ) space, where only one generic
Mattis magnetization, i.e. m1 = m, may increase (for suitably initial conditions), while all the others remain
PH
zero. Beyond m, another parameter which turns out to be useful is q ≡ E(1/N ) i=1 ω(hi )2 , which measures
the spin-glass weight [32]. Exploiting replica trick techniques [35, 49], the free energy of the system is found
to be
f (α, β, γ, Φ; m, q)

1 X 2
log 2 α + γ
+
[1 + βr(1 − q)] + β
mµ +
β
2
2 µ
i
α+γh
βq
log[1 − β(1 − q)] −
2β
1 − β(1 − q)
p
Z
Z


p
β (α + γ)q
1
h dµ(η) dµ(z) log 2 cosh βm +
z + βΦη iξ ,
β
1 − β(1 − q)

= −
+
−

(12)

where we fixed mµ = m(1, 0, 0, ..., 0).
Extremizing again the replica symmetric free energy f (α, β, γ, Φ; m, q) with respect to m, q, we can find the
self-consistent relations
p
Z
Z


p
β (α + γ)q
µ
m = M (α, β, γ, Φ; m, q) = hξ dµ(η) dµ(z) tanh ξ βm +
(13)
z + βΦη iξ ,
1 − β(1 − q)
p
Z
Z


p
β (α + γ)q
q = Q(α, β, γ, Φ; m, q) = h dµ(η) dµ(z) tanh2 βm +
z + βΦη iξ
(14)
1 − β(1 − q)
Now, for a given set of parameters α, β, γ, Φ, the values of such observables allow to understand whether
the retrieval can be successful, thus we solve numerically (details can be found in appendix C) Eqs. (13-14).
In general, we find that ∀β > 1 and Φ ≥ 0, there always exists a solution with m = 0 and q > 0, which
corresponds to a spin-glass phase. Beyond such a solution, a pure state solution (m > 0) appears below
a critical noise βM (α + γ, Φ) and in order to discriminate which is the more stable solution (between the
pure state and the spin glass), we compared the relative free-energies to look for the lowest, finding that at

11

0.8

0.8

0.6

0.6
1/!

1

1/!

1

0.4

0.4

0.2

0.2

0
0

0.02

0.04

0.06

0.08

0.1

0.12

0
0.14

"

1

0

0.02

0.04

0.06

1

0.6

0.6

0.1

0.12

0.14

0.08

0.1

0.12

0.14

1/!

0.8

1/!

0.8

0.08
"

0.4

0.4

0.2

0.2

0
0

0.02

0.04

0.06

0.08

0.1

0.12

0.14

0
0

"

0.02

0.04

0.06
"

Figure 2: Phase diagrams: the dashed line represents the critical line βM , which distinguishes among
retrieval (in general sense) and spin glass phases, while the continuous line represents the critical line βC ,
which confines the pure state phase. Upper panel: Φ = 0 (left) and Φ = 0.5 (right); Lower panel: Φ = 1
(left) and Φ = 1.5 (right).
relatively large noise the pure state is not stable, that is it is only a local minimum; by further decreasing
the noise β, the pure state becomes a global minimum.
Hence, similarly to what happens in the traditional Hopfield model (k0 = 0), the amplitude of the pure
state appears in a discontinuous way as far as the noise is lowered below a certain point, which defines a
critical line βM (α + γ, Φ), but only when the noise is further lowered below a certain point, that defines a
second critical line βC (α+γ, Φ) the pure state become the lowest free energy state that is, a global minimum.
Results are summarized in the phase diagrams of Fig. 2.
We recall that, in our framework, the pure retrieval phase represents the exposition of immune system to
a particular antigen (only one particular activation pattern is retrieved) and summarizes the simplest case.
Beyond this, one can also consider spurious states: For instance, a "spurious state" with three strategies of
activation will be described by three Mattis magnetizations m1 6= 0, m2 6= 0, m3 6= 0, while the remaining
√ −1
are vanishing, that is O( H ) at finite volume (and zero in the infinite system size limit). Spurious (or
mixed) states represent the ability of the system to follow multiple paths of cytokines activations at the same
time, interestingly turning the large spurious land of these associative models as the main interesting part
in this context. Of course, one could solve numerically the set of self-consistency equations for amplitude of
mixture states under whatever ansatz, calculations are just more complex and lengthy and we plan to report
soon on this investigation.

12

4.2

ALPS, HIV and Ageing

The schematic representation of Fig. 3 shows that there are basically three ways to escape from the performing region: By increasing the extent of activation Φ (toward a Random Field Phase), by breaking the balance
of the ratios among different lymphocytes B/TH , TK /TH (toward a Spin Glass Phase), or by increasing the
level of noise β (toward a Paramagnetic Phase). Interestingly, all these scenarios can be easily related to
well-known conditions:
• Example of the random field escape: Lymphocytosis.
Autoimmune lymphoproliferative syndrome (or similar variants, see e.g. [50, 51]) arises in people who
inherit mutations in genes that mediate T-lymphocyte apoptosis, which is fundamental for the immune
homeostasis (a healthy steady state for the host), by limiting lymphocyte accumulation and minimizing
reactions against self-antigens. As a result of inefficient apoptosis, lymphocytes grow monotonically in
time and already in childhood severe autoimmune phenomena appear [12].
Such phenomenology emerges consistently within our model: In the presence of a large activation of
lymphocytes, the random field phase prevails against the retrieval one; intuitively, the broad range
of active killer lymphocytes makes helper cells to secrete arbitrary amounts of cytokines, ultimately
loosing any capability of synergy.
• Example of the spin-glass escape: Chronic Infection.
An imbalance between the relative sizes of the subpopulations determines an increase of the parameters
α, γ and this may yield the system far from the retrieval region. Note, however, that the system now
degenerates into a spin glass, a different scenario with respect to the previous case (random field). These
different zones in statistical mechanics correspond, in fact, to different immunological complications:
While the former corresponds to an autoimmune manifestation, the latter is close to the well known
transition from simple HIV infection to the overt AIDS disease. In fact, HIV infects and kills helpers
decreasing monotonically in time the amount of these cells and consequently increasing the α, γ values.
A similar effect occurs in the presence of EBV infection since it somehow immortalizes B cells, with
consequent anomalous increase of α. We stress that, although in both cases the net effect is a spinglass escape from the retrieval region, the causes are completely different. The whole picture gives a
rationale for the understanding of the CD4+/CD8+ ratio inversion phenomenon11 .
• Example of the paramagnetic escape: Ageing.
In our framework the causes of ageing can be free-radicals, by products, molecular cross-linking, damage
accumulation and so on, which may preclude a firm binding between molecules and/or a slowdown in
recognition processes [53, 54]. Even though we have only heuristic arguments, this kind of aging can
be bridged with the “real” aging of the living host. It is also interesting to notice that a smaller value of
β (larger disorder) makes the critical level for Φ smaller, consistently with the well-known correlations
found in ALPS patients, that is, the risk of neoplastic complications grows with patient’s age [12].

5

Outlook

In this work we introduced and analyzed a model to describe the mutual interactions occurring among
lymphocytes via cytokine exchanges. While the activity of helper cells is described by a dichotomic variable
hi = ±1 (where i denotes the specificity of the clone), the activity, or clonal extent, of B and killer cells is
described by continuous, Gaussian-distributed variables denoted as bν and kµ , respectively: This choice is
a result of a relaxation of an opportune Ornstein-Uhlembeck process where the interactions among agents
belonging to the same branch (B − B, and TK − TK ) create a quadratic self-interaction term in a mean-field
approximation which implies Gaussian distribution in their equilibrium values. Interestingly, this result
11 Notice that diluting the network towards more realistic descriptions α approaches 1 [52] in agreement with the experimental
c
findings [1].

13

Figure 3: Schematic representation of the retrieval region. The three normal ways for escape have been
depicted: Random Field (too large or too low mean activity), Spin-Glass (too large relative number of
patterns) and Paramagnetic (too large degree of noise). Such states correspond to unhealthy situations,
namely lymphocytosis, chronic infections and senescence, respectively. Notice that in this plot the quantity
α + γ has been renamed α, consistently with the appendices, and that, the retrievial region is restricted, by
definition, to the quadrant α > 0, β > 0.

allows to bypass a direct estimate of the number of cells which means we can avoid dealing with chemical
potentials and grand-canonical environments; in fact, we can let the clonal activity vary still retaining a
canonical framework by considering not the cells, but the clones as quasi-particles. As for cytokine, the
inhibitory/excitatory function of messages they carry from helper i on the effector clone µ is encoded by
ξiµ = −1/ + 1. The whole ensemble is then formalized by a tripartite spin-glass system where CD4+ cells
can interact with the so called effector branches, i.e. CD8+ cells and B lymphocytes via these exchanges.
Firstly, we showed that such a system is equivalent to a neural network where stored patterns correspond
to strategies to fight against antigens and are possibly memorized during previous infections. More precisely,
cytokines patterns work as synapses providing Hebbian-like interactions among helpers: Helpers effectively
behave as an associative neural network able to store and retrieve specific strategies in cytokine secretions
for effector regulations.
Then, we have mimicked the occurrence of a (poly-clonal) activation of the branches by shifting the
Gaussian distribution of these effector lymphocytes to a non null value: We proved that a state of clonal
expansion (lymphocytosis) or, similarly, of clonal suppression (immunodeficiency), is formally equivalent to
a random field acting on helper cells; obviously, if the strength of such a field prevails against the normal
interactions, the immune system would not work correctly, possibly giving rise to autoimmune diseases.
Such a mapping also reveals a kind of immunological version of the second principle of thermodynamics:
An ordered work (clonal expansion/suppression) can not be accomplished without introducing some sort of
disorder, here random fields, inside the system itself (possibly giving rise to low-titer self-antibodies).
We also performed an analytical study of the model via the replica trick obtaining (at the replica symmetric level) a set of self-consistent equations for the order parameters as functions of the parameters β (degree of
noise), α (repertoire width ratio) and Φ (clonal expansion extent). The numerical solution of these equations
allows to build up a phase diagram for the performance of the system; in particular, we found that there
is a region in the space (β, α, Φ), where helper lymphocytes can correctly work as an associative network.
The system may escape from this healthy state in three ways: Unbalancing the amount of the relative sizes

14

of the lymphocytes (e.g. HIV and EBV infections where the formula CD4+/CD8+ is reversed), performing
too strong a response, namely a lymphocytosis (e.g. ALPS) or simply increasing the level of white noise
(e.g. ageing of the system). The correlation between lymphocytosis and autoimmunity, or between ageing
and autoimmunity, which still lacks a complete justification, at least in terms of statistical mechanics, finds
here a clear explanation.
Furthermore, from these results we can also observe that a performing immune system is a system able
to spread information over the network of cells: In fact, as α can not exceed a threshold, the system must
be able to respond to a large number of different antigens with the smallest possible repertoire, which is in
agreement with every systemic observation on the immune network [5]. A performing system must disentangle
in multiple pattern recognitions via spurious states, minimizing in this way the amount of required antigenic
information for binding, in agreement with the experimental findings [28, 45, 56]. Along this line we notice
that such network can be established only in the presence of some intrinsic activity: If k0 or b0 is too low,
no connection among lymphocytes can be established and no information can be spread [46, 47, 48].
A considerable amount of research is clearly opened: First of all, one could investigate about the lack of
symmetry in the interaction matrix because, so far, we assumed that the signal sent by a given helper to,
say, a given killer is the same as the other way round. Despite in physics (especially in equilibrium statistical mechanics) this symmetry (the third law of dynamics) ensures convergence to the Maxwell-Boltzmann
equilibrium, in biology this property does not hold straightforwardly. However, once related the capacity
of the network with the ratios among different types of lymphocytes, and properly introduced the clonal
expansion, the whole approach à la Gardner [55] for unbalanced neural networks applies and could bring us
closer to the quantitative world.

Acknowledgements
This work is supported by FIRB grant RBFR08EKEV.
The authors are pleased to thank Alberto Bernacchia, Raffaella Burioni, Bernard Derridà, Silvio Franz,
Giancarlo Ruocco, Anna Tramontano and Guido Valesini for useful discussions. The authors are also indebted
to Cristina Cerboni for precious discussions on immunological issues.

Appendix A: The hidden role of interactions in the Gaussian activities
In this appendix we provide an explanation about the Gaussian activity assumption we made for the effector branches B, TK ; our arguments are based on the idea that their activity is also regulated by intrinsic
interactions within each branch, which can be looked at in terms of an interaction network connecting B
cells and TK cells, respectively. Indeed, it has been evidenced that both cells exhibit, even in the absence of
antigenic stimulation, a non-null activity which allows the maintenance of a network of mutual regulation
even in rest conditions [46, 47, 48]. From a mathematical point of view, an analogous behavior for B and
TK cells is intrinsic in our model due to the symmetry under the change B ↔ TK .
We summarize the underlying mechanisms focusing only on B cells. Now, B lymphocytes secrete antibodies, which, given the huge amount of different clones, may detect antibodies secreted by other lymphocytes:
Via this mechanism, antibodies not only detect antigens, but also function as individual internal images of
certain antigens and are themselves being detected and acted upon. In this way an interaction network for
B cells is formed and it provides the immune system with a "dynamical memory", by keeping the concentrations of antibodies and of lymphocytes at appropriate levels.
This part of theoretical immunology (early experimentally investigated in [28, 45, 56], then formalized in
[29, 57, 58] and within a statistical mechanics framework in [18, 19] can be intuitively understood as follows:
At a given time an antigen is introduced in the body and starts replication; let us consider, for simplicity,
a virus as a string of information (i.e. 1001001). At high enough concentration, the antigen is detected by
the proper B-lymphocyte counterpart (producing the antibody Ig1, which can be thought of as the string
15

0110110), which then starts a clonal expansion and will release high levels of Ig1. As a consequence, after a
while, other B-cells with a consistent anticorpal affinity with Ig1 (say 1001011, 1001000) will meet it and, as
this string never (macroscopically) existed before, attack it by releasing the complementary string 1001000
and 1001011, that, actually, are spurious copies (internal images) of the original virus but with no DNA or
RNA charge inside: The interplay among such antibody concentrations keeps memory of the past infection
and allows a network of mutually interacting lymphocytes whose topological properties have also been shown
to be able to explain basic phenomena such as self/non-self recognition and low-dose tolerance [18, 19]. Another issue following this point is that, while B cells of the same clone do not interact among themselves, B
cells belonging to different clones (provided that their anticorpal matching is strong enough) tend to imitate
reciprocally: if the first clone undergoes clonal expansion, the clone corresponding to the anti-antibody will
follow it, and viceversa.
Let us now build a dynamical system where B cells and killers interact with each others in this way (i.e.
ferromagnetically) and with helpers via cytokine exchange as well: the evolution of their activity then follows
an Ornstein-Uhlenbeck process [59] like
H
B
√
1 X (b)
β X ν
dbν
ξi hi − τ ην(b) ,
=−
Jνl bν − √
dt
B
H i=1
l=1

(15)

K
H
√
1 X (k)
β X µ
dkµ
=−
Jµl kµ − √
ξi hi − τ ην(k) ,
dt
K
H i=1
l=1

(16)

τ

τ

where τ represents the typical time-scale for the B-cells and killers diffusion (for simplicity is taken the same
for both kinds of lymphocytes), J is the coupling among cells themselves, hi is the activity of the i-th helper,
ξiµ is the cytokine message between the effector agent µ and the helper i, while η accounts for a standard
white noise. Equations 15 and 16 state that the rate of change for the ν-th clone belonging to B (TK ) cells
population is proportional to the stimulation provided by other B (TK ) cells via antibody exchange (via
direct contact through T cell receptors) and by TH cells via cytokines exchange, in the presence of white
noise.
Given the ferromagnetic (imitative) nature of the interactions among analogous cells (if present), i.e. Jµν ≥
0 ∀µ, ν, we can properly rescale the parameters by the mean interaction hJi and, under a mean-field asP (b)
sumption µ Jνµ bν /(hJi B) = bν , we can rewrite the process as
τ

τ

0 dbν

H
X

ξiν hi −

√

τ 00 ην(b) ,

(17)

H
X
√
dkµ
= −kµ − β 0
ξiµ hi − τ 00 ην(k) ,
dt
i=1

(18)

dt

= −bν − β

0

i=1

√
where τ 0 hJi = τ , β 0 hJi H = β and τ 00 hJi2 = τ . The right-hand-sides of Eqs. 17 − 18 can be looked at as
the forces eliciting the dynamic process, hence the related potentials read as (using the bold symbol to mean
a vector)
X
X
V (b) = −
b2ν /2 − β
ξiν hi bν ,
(19)
µ

V (k) = −

X

i,ν

kµ2 /2

−β

µ

X

ξiµ hi kµ .

(20)

i,µ

In this way, if we assume a Gaussian distribution N [0, 1] for√the activity
of B and T√
K cells,
P
P the overall system
can be described by means of the Hamiltonian H = −(1/ H) i,ν ξiν hi bν − (1/ H) i,µ ξiµ hi kµ , exactly
the one introduced in our approach (see Eq. 1).
Therefore, the network approach developed in the last decades and based on the mutual interaction among
B lymphocytes and the tripartite system approach introduced here turn out to be in perfect agreement: in
16

particular, within our merging the two possible mechanisms for the implementation of memory (long-lived
cells or clone-clone activation in a network ła Jerne) can be regarded no longer as competing but rather as
synergic.
We stress that, at this stage, the detailed form of the antibody matrix Jµν does not matter (see e.g. [18]
for details), the key ingredient being only its positive definiteness (given by the imitative nature of B and
TK cells), to ensure its mean value hJi to exist strictly positive. If interactions among B lymphocytes and
among T lymphocytes were both inhibitory and excitatory, i.e. J is non-positive-definte like in spin-glass
systems, then convergence would not hold in general and we would not be able to merge the two approaches.

Appendix B: The replica trick calculation for the evaluation of the
free energy
The system, whose thermodynamics we want to tackle, is ruled by the following Hamiltonian12 (see Eq. 11):
βH(h; ξ) = −

B
H
K
H
X
p
β X  X µ µ X ν ν
ξi ξj hi hj − βγk0
ξi ξj +
χi hi ,
H i<j
ν
µ
i

(21)

PK
where χi = √1K µ ξiµ , in the infinite system size limit, converges to a standard Gaussian N [0, 1] via a
standard CLT argument13 .
In order to study the retrieval phase of this system trough disordered statistical mechanics, we apply the
so-called replica trick technique [60] (under the assumption of replica symmetry) following the derivation of
Coolen, Kuhn and Sollich [35]: The idea is to force the retrieval toward a particular ensemble of patterns
l < B + K mimicking a reasonable dynamics toward one of the attractors which, indeed, can be identified
by these l patterns; then, one needs to check where, in the region of the space [(α + γ), β, Φ], suitably order
parameters (the Mattis magnetizations that we introduce later) are stable and, further, where these minima
are even absolute minima of the free energy, such that we have "thermodynamical stability"14 . Of course all
the "not-recalled" patterns P − l now act as a quenched noise on the retrieval of the selected l patterns and
we know how to deal with these remaining ξ-terms.
Before proceeding we notice that there is permutational invariance: thinking at the first l as the retrieved
patterns is completely fictitious as any set of l patterns can work finely as well. As a consequence, we
introduce a new symbol P = B + K because, as far as no differentiation among the subclasses H1 , H2 is
made, the two effector branches are indistinguishable and only their total amount versus the amount of the
available helpers matters.
We now properly elaborate the Hamiltonian (21) by adding a finite number l of Lagrange multipliers λµ
PH
to the Hamiltonian so to easily express Mattis order parameters mµ ≡ i=1 ξiµ hi /H as derivatives of the
free energy w.r.t. them; more precisely, one has
H(h; ξ) ⇒ H(h; ξ) + β

l
X
µ=1

λµ

H
X

ξiµ hi ,

i

12 Strictly speaking, in standard statistical mechanics, the noise level plays a uniform role on the interactions, while we face
with its linear coupling to the Hopfield terms and a square root one to the random field term. The need of a uniform influence
is of course nor a biological must neither a mathematical restriction and can then be easily relaxed.
13 Two correlated observations are needed here. First the approximation to a Gaussian may appear dangerous because for
the same CLT argument the Hebbian kernel converges to a N [0, 1], too; this actually onsets the transition from an associative
behavior to a spin glass phase. However, while the Hebbian kernel in this procedure loses its peculiar organization of the phase
space able to store and retrieve information, η is a random object even without the CTL limit and its convergence to a standard
Gaussian only simplifies calculations.
14 We will find even a large region where only spin glass states exist and a large mixed region where these minima exist but
are local minima, the spin glass being still the global one; the latter is the "spurious states" scenario, where, despite these are
not thermodynamically stable, are still of primary interest in the dynamics as are however well defined attractors with long
meta-stable lifetimes [32].

17

from which, recalling A(α, β, γ) = −βF (α, β, γ), one gets
hmµ i =

∂ F
|λ=0
∂λµ H

Basically, the role of multipliers is to force to end up in the selected attractors. One has three different
kinds of noise which are not part of attractors: β, the RF and the excluded patterns B + K − l. Hence, the
complete Hamiltonian which we study is
− βH(h; ξ, λ) =

H
K
H
B
l
H
X
X
X
p
β XX µ µ X ν ν
(
ξi ξj +
ηi hi − β
ξi ξj )hi hj + βγκ0
λµ
hi ξiµ .
H i<j µ
ν
µ=1
i
i

(22)

We want to solve the thermodynamics (i.e. obtain an explicit expression for the free energy and a picture of
the phase diagram by its extremization) via the replica trick, which consists in evaluating the logarithm of
the partition function trough its power expansion, namely
log Z

hZ n i − 1
1
Zn − 1
⇒ hlog Zi = lim
= lim loghZ n i.
n→0
n→0 n
n→0
n
n

=

lim

(23)

This implies that in order to obtain the mean of log Z one can average Z n , which is itself a partition function
of n identical systems which, for any given set of random variables, do not interact: these are the “replicas”.
The intensive, i.e. divided by H, free energy reads off as
hF i
H

lim √

=

n→0

1
log
βHn

X

exph−β

n
X

H(ha ; ξ)i,

(24)

a=1

{h1 ,...,hn }

where we introduced the symbol a ∈ (1, ..., n) to label the n different replicas of the system (with the same
quenched distribution of the ξ).
By plugging Eq. 22 into Eq. 24 we get
hF i
H

=

·

n
H
l X
H

X
X
α+γ
log 2
1
1 X a µ 2
[λµ
hai ξiµ −
−
− lim
hexp − β
(
h ξ ) ]
n→0 βnH
2
β
2H i i i
a
µ
i

exp

p

βγκ0

H X
n
X
a

i

H
n X
P X


 β X
ξiµ hai )2 iξ iha ,
(
ηi hai iξ hexp
2H a
i

(25)

µ>l

where we can linearize the quadratic
√ exponential terms for the µ < l with the Gaussian integral, and apply
for convenience the shift maµ → βHmaµ , as
H

exp

β X a µ 2
(
h ξ )
2H i i i

!

Z

+∞

=

dµ(zaµ ) exp
−∞

!
√ X
H
β
a µ
√
hi ξi zaµ .
H i

The intensive free energy can be written now as
hF i
H

=

α+γ
log 2
−
−
2
β

−

1 βH ( nl )
(
) 2
n→0 βHn 2π

·

(26)

lim

hexp

 β
2H

n X
P
X

Z Y
nl

µ>l

βH
2

P

aµ

m2aµ

l X
n X
H
 X
hexp β
hai ξiµ [mµa − λµ ]) ·

aµ

H
X

(

a

dmaµ e−

ξiµ hai )2 +

µ

p

βγκ0

n X
H
X
a

i

18

i

a


ηi hai iξ,η iha .

i

We note that, as B and K act together as identical interacting terms, among the l retrieved patterns we do
not distinguish between those from the B components and the K ones; it is then useful to "diagonalize the
perspective" by introducing the variable P̃ as follows:
We have a global amount of B + K = P clones. In this set, l are retrieved, P − l are the remaining
terms. Among these, P − l − P̃ can be though of as the responsible for the (not retrieved) interactions
with the B (in the corresponding 3-parties spin glass) and P̃ are left for the interactions with the K (in
a nutshell
it is a reshuffling). 
We can then average over the quenched noise and linearize even the term

PH µ a 2
β Pn PP
hexp 2H a µ>l ( i ξi hi ) iξ so to write the free energy as


hF i
α+γ
log 2
1
=
−
− lim
n→0 βHn
H
2
β

βH
2π

 nl
Z Y
n,l
2

·1 · e−

βH
2

Pn,l

a,µ

m2aµ

(27)

a,µ



Z Y
H,n
n


p X X

X
X
p
β
β
hi ξiµ (mµa − λµ ) exp H(α + γ) log 
z a qaβ z β ) + βγκ0
hexp
dµ(za ) exp(
ηi hai ihai ,
2
a
a,i
i,a
µ<l

a,β

where the term 1 has been introduced symbolically into the expression so to be rewritten as
1=

Z Y
αβ

Z
Z Y
H
X
1 X α β
1 X a β
βH n2 Y
h h ]=(
)
dqαβ
dq̃αβ exp(iH
q̃αβ [qαβ −
h h ]). (28)
dqδ[qαβ −
H i i i
2π
H i i i
αβ

αβ

αβ

Now we assume the commutation of the limits limn→0 , limH→∞ and get
lim

H→∞

hF i
H

α+γ
log 2
−
2
β
Z Y
Z Y
Z Y
1
lim lim
E
dmaµ
dqαβ
dq̃αβ
n→0 H→∞ βHn
aµ
αβ
αβ
Z Y
n
i
h  X
β P
1 X 2
exp H i
q̃αβ qαβ − β
maµ + (α + γ) log
dµ(za )e 2 αβ za qαβ zβ
2 aµ
a

=
−

·

(29)

αβ

H
n X
H
H X
n
h XX
i
X
X
X
p
hexp β
hai ξiµ [mµa − λµ ] − i
q̃αβ
hai hβi + βγκ0
ηi hai iha .

·

µ<l

a

i

i

αβ

i

a

The n-dimensional Gaussian integral over z factorizes in a standard way after appropriate rotation of the
integration variable as
Z
β X

1
zα qαβ zβ = − log det[I − βQ],
(30)
log dµ(za ) exp
2
2
αβ

which allows to rewrite the free energy as
hF i
lim
H H

Z
Z
Z
1
(α + γ) log 2
=
−
− lim lim
Eξ,η dmaµ dqαβ dq̃αβ
n→0 H→∞ βHn
2
β



X
1 X 2 
α+γ
· exp [H(i
q̃αβ qαβ − β
maµ )] exp [H(−
log det[I − βQ])]
2 aµ
2
αβ

·

H
Y

n
n
 XX

X
X
p
hexp β
ha ξiµ (maµ − λµ ) − i[
hα qαβ hβ + βγκ0 η
ha ] iha ,

i

µ<l

a

αβ

(31)

a

where Eξ,η represents the average over the quenched variables ξ, η As we reached a formulation where all the
exponents are extensive in the volume H, we are allowed to apply the saddle point method such that the
19

extremal hf (m, q, q̃)i∃ : limH→0 hF iξ H −1 = limn→0 limH→∞ hf (m, q, q̃)i, being
hf (m, q, q̃)i =

n
h
 XX

α+γ
log 2
1
−
− lim
Eη hloghexp β
ha ξµ (maµ − λµ )
n→0 βn
2
β
a
µ<l

·



exp − i

X

hα qαβ hβ +

p

βγκ0 η

n
X

n
X
αβ

ha +

(32)

a

αβ

+ i



nl
i
1 X 2
1
q̃αβ qαβ − β
maµ − (α + γ) log det[I − βQ] iξ iha .
2 aµ
2

(33)

Let us study the behavior of the replica-symmetric matrix
Λaβ = [1 − β(1 − q)]δaβ − βQ,
where the matrix Q has all the off diagonal entries equal to q and the diagonal ones to 1. There exist two
eigenvectors,
namely x = (1, 1, ..., 1) with algebraic multiplicity 1 and eigenvalue λ1 = 1−β(1−q)−βqn, and
P
x̂ = a xa = 0, namely the whole hyperspace orthogonal to the first eigenvector. Of course the algebraic
multiplicity of the latter is n − 1 and its eigenvalue λ1̂ = 1 − β(1 − q). So we can write the determinant of
the matrix Λ as the product of all its eigenvalues to get
Y
log det Λ = log
λi = log[1 − β(1 − q) − βqn] + (n − 1) log[1 − β(1 − q)]
i

h

= n log[1 − β(1 − q)] −

i
βq
+ O(n2 ),
1 − β(1 − q)

(34)

as we are expanding around small n because we are approaching the n → 0 limit.
Overall we can rewrite the free energy as
f (m, q, r)

=
+
−

 1X
log 2 α + γ 
+
1 + βr(1 − q) +
m2µ +
β
2
2 µ


i
α+γh
βq
log 1 − β(1 − q) −
−
(35)
2β
1 − β(1 − q)

 X
X
X
X
p
1
1
ha )] ih iξ .
Eη hloghexp [β(
ha )(
mµ ξ µ ) + (α + γ)β 2 r(
ha )2 + βγκ0 η(
βn
2
a
a
a

−

µ<l

P
Now, focusing on the last line of the expression above we can linearize the quadratic term ( a ha )2 through
a standard Gaussian integral representation,
 1
 Z
 p

X
X
a 2
exp − (α + γ)βr(
h ) = dµ(z) exp β (α + γ)rz(
ha ) ,
2
a
a
and get (writing once again only the last line of expression (35))
h X
 X
i
p
p
1
Eη hloghdµ(z) exp
ha ) β(
mµ ξ µ ) + β (α + γ)rz + βγκ0 η ih iξ =
βn
a
µ<l
Z
 X
 p

p
1
Eη hlog dµ(z)2n coshn β (
mµ ξ µ ) + (α + γ)rz + βγκ0 η iξ
βn

−

µ<l

20

(36)

Now, using coshn (x) ∼ 1 + n log cosh(x) and writing the whole free energy we get
f (m, q, r)

=
+
−

log 2 α + γ
1 X 2
+
[1 + βr(1 − q)] + β
mµ +
β
2
2 µ
i
βq
α+γh
log[1 − β(1 − q)] −
2β
1 − β(1 − q)
Z
Z
h X
 p
i
p
1
h dµ(η) dµ(z) log 2 cosh β (
mµ ξ µ ) + (α + γ)rz + βγκ0 η iξ .
β

−

(37)

µ<l

Extremizing again the replica symmetric free energy we can find the self-consistent relations
Z
Z
 X

p
p
m = h dµ(η) dµ(z) tanh β(
mµ ξ µ + (α + γ)rz) + βγκ0 η iξ ,

(38)

µ<l

Z
q

= h

Z
dµ(η)

 X

p
p
dµ(z) tanh2 β(
mµ ξ µ + (α + γ)rz) + βγκ0 η iξ ,

(39)

µ<l

r



= q/ 1 − β(1 − q)2 .

(40)

These equations must be solved numerically (the difficulty in the involved mathematics mirrors the sudden
jumps in the order parameters values), to which the next section is dedicated.

Appendix C: Numerical solutions of the self-consistency equations
As shown in Eq. (11), both the ratio α + γ between killers and helpers and the strength of the killer clonal
√
expansion k0 multiply the random field at once: We use Φ = γκ0 as a single tunable parameter and we
stress once more that, analogously to P and P̃ in the previous appendix, only the total amount of branch
lymphocytes matter in the ratio with the helpers (namely (B + K)/H), so we shift α + γ → α for the sake
of simplicity.
In analogy with the standard Hopfield model, the phases where our system may show emergent cooperative
behavior among its constituents are several and here we outline our strategy to detect the two (limiting)
simpler cases. As for the pure states, we look at the regions, in the (α, β, Φ) space, where only one generic
Mattis magnetization, say m1 = m, may increase (for suitably initial condition), while all the others remain
zero; further, with the overlap qαβ we can measure the spin glass weight; in fact, for high noise level (β < 1),
m = q = 0 and the system is ergodic (of no interest in theoretical immunology), while focusing on the
low noise level (β > 1), we can distinguish a spin-glass phase with m = 0, q > 0 and a phase where the
system displays associative memory with m > 0, q > 0. Beyond this extremum case, there is a whole
family of other cases where spurious states appear. For instance, a "spurious state" with two patterns
of activation will be described by two Mattis magnetizations m1 6= 0, m2 6= 0, while the remaining are
√ −1
vanishing, that is O( H ) at finite volume. Of course, increasing the number of antigens means increasing
the B, K repertoires, which lastly falls off the system toward a spin glass phase15 . This other extremum (the
maximum amount of parallel paths of activations before collapsing into the spin-glass region) is the second
case we analyze. Here we study the RS spin-glass and RS pure state solutions numerically: We insert the
pure state ansatz mµ = m(1, 0, ..., 0) in the self-consistency RS equation system (38,39,40), then we eliminate
the equation for r substituting it in the formers, so to obtain a new set of equations for m, q and the free
15 Physically the transition to a spin-glass state is accomplished with an exponential increasing of the minima of the free
energy which pushes the network into the "blackout scenario" [32]. This can be understood intuitively as the amount of
spurious states, namely linear combination of pure states (with smaller basins of attractions) grow as the Newton binomial, i.e.
in a non polynomial way.

21

q

q

q

q

1.0

1.0

1.0

1.0

0.8

0.8

0.8

0.8

0.6

0.6

0.6

0.6

0.4

0.4

0.4

0.4

0.2

0.2

0.2

0.2

0.2

0.4

0.6

0.8

1.0

m

0.2

0.4

0.6

0.8

1.0

m

0.2

0.4

0.6

0.8

1.0

m

0.2

0.4

0.6

0.8

1.0

m

Figure 4: From left to right: Solutions of the RS self-consistency equations for (Φ = 0.5, α + γ = 0.01). Red
line: solution of m − M (m, q, α + γ, Φ, β) = 0, Blue line: solution of q − Q(m, q, α + γ, Φ, β) = 0.
(a) 1/β = 0.8. Only the upper branch counts, under the value q = 1 − 1/β the free energy has only complex
values.
(b) 1/β = 0.6. In this particular point α + γ, Φ, β −1 a pure state solution m > 0 appears as the two contourplot lines -for m and for q- are tangent.
(c) 1/β = 0.5. Solution of the RS self-consistency equations for (Φ = 0.5,α + γ = 0.01). Free energy is
complex along the lower branches which are therefore rejected (note that they never cross in fact). Above
two intersections appear. Only the higher m, q intersection is the thermodynamical pure state solution
because it is coupled with the lower free energy.
(d) 1/β = T = 0.2. Note that lowering the noise, (for α + γ < (α + γ)c = 0.138) we always find the pure
state retrieval solution.
energy (37):
m
q

p
Z
Z


p
β (α + γ)q
z + βΦη iξ ,
= M (m, q; β, α + γ, Φ) = h dµ(η) dµ(z) tanh βm +
1 − β(1 − q)
p
Z
Z


p
β (α + γ)q
2
z + βΦη iξ ,
= Q(m, q; β, α + γ, Φ) = h dµ(η) dµ(z) tanh βm +
1 − β(1 − q)

f (m, q, r)

log 2 α + γ
1 X 2
+
[1 + βr(1 − q)] + β
mµ +
β
2
2 µ
i
α+γh
βq
log[1 − β(1 − q)] −
2β
1 − β(1 − q)
p
Z
Z


p
β (α + γ)q
1
h dµ(η) dµ(z) log 2 cosh βm +
z + βΦη iξ .
β
1 − β(1 − q)

= −
+
−

(41)
(42)

(43)

We have used the software Wolfram Mathematica 7.0 to compute numerical solutions of eqs. (41,42) and
calculate the free energy (43) of these solutions: To speed up the evaluation, we noticed that the integrand
of the RS self-consistency equations is a product of a hyperbolic tangent and two Gaussians. The hyperbolic
tangent is always bounded by one and the Gaussians go quickly to zero. As we have fixed the precision of
the integration in the software, and therefore the zero, to 10−10 , we decided to fix the extreme of the z and
η integration to −5 and 5 as e−25 ∼ 10−11 .
In Figure 5 the solutions of m − M (m, q, 1/β, α, Φ) = 0 and q − Q(m, q, 1/β, α, Φ) = 0 for fixed α = 0.01
and Φ = 0.5 at decreasing noise level are shown: Above a certain level of noise the two lines representing
the solutions in the plane (m, q) do not intersect at m > 0; they cross each other only in a spin-glass state
point, m = 0 and q > 0. Of course the line m = 0 is always a solution of m = M (m, q, β, α + γ, Φ).
For every fixed Φ and α + γ there is a noise threshold at which these two lines are tangent, so a pure state
solution m > 0 appears beyond the spin-glass state: We computed all the corresponding free-energies and
22

1

-0.48

PS,"=0.01
PS,"=0.02
PS,"=0.03
PS,"=0.04
PS,"=0.05
SG,"=0.01
SG,"=0.02
SG,"=0.03
SG,"=0.04
SG,"=0.05

-0.49

0.8

-0.5
0.6
m

f

-0.51

0.4
-0.52
"=0.01
"=0.02
"=0.03
"=0.04
"=0.05

0.2

0
0

0.1

-0.53

0.2

0.3
1/!

0.4

0.5

0.6

-0.54
0

0.1 0.2 0.3 0.4 0.5 0.6
1/!

Figure 5: Left: RS amplitudes of the Mattis order parameter of the pure states at Φ = 0.5 as function of
the noise. From top to bottom: α + γ = 0.01 − 0.05, (∆[α + γ] = 0.01). Right: Solid lines represent free
energies of the pure states (PS) for α + γ = 0.01 − 0.05 at Φ = 0.5. Dashed lines represent free energies of
the spin glass (SG) states for α + γ = 0.01 − 0.05 at Φ = 0.5. Each different α + γ is called simply α in
the plots and each couple of same lines has a different color for comparison. The higher 1/β of the PS line
defines βM point at each α + γ. The PS and spin glass lines cross in the βC point for each α + γ.
verified that, for every fixed α+γ and Φ, the free energy for the spin-glass state is lower than free energy of the
pure RS state until noise is further lowered, so the pure state that appears among candidate solutions is not
immediately stable, that is, we are crossing the region of the "spurious states". At lower levels of noise, two
pure state solutions bifurcate from the former point, both with strictly positive magnetization, m1 > m2 > 0
and q1 > q2 > 0. The second solution (m2 , q2 ), the one with lower magnetization, has always higher free
energy than the first one or the respective spin-glass state, so can be rejected in the thermodynamical sense:
Only the higher magnetization pure state is relevant and becomes a global minimum as far as the noise is
further lowered.
Lastly we know that in the limit of β → ∞ we reach always a pure state with m = 1 and q = 1: this
is verified for each α + γ < 0.138 and whatever Φ and can easily be understood by a scaling argument
on the Hamiltonian βH(h; ξ, Φ)16 . In order to depict the two first order critical surfaces, we have repeated
calculations of order parameters and of free-energy in different regions of the space (Φ, α+γ, β); in particular,
we have calculated free energies of the pure state and of the spin-glass state solutions collected for different
values of Φ, α + γ and β, and compared each other to find the lowest: Where they cross we have the onset of
the transition from one phase to another; in Fig. (5), left panel, we show results of the computation of the
free energy for Φ = 0.5 at various α, while the related Mattis magnetization is depicted in the right panel.
Starting from the low noise limit and decreasing in β, the Mattis magnetization suddenly disappears in the
α + γ, Φ plane, implicitly defining the critical surface βM (α, Φ), but only for noise further reduced, namely
on the critical surface βC (α + γ, Φ), these minima are the global minima of the free energy (the former are
dominated by the underlying spin-glass phase, mirroring the spurious land of the neural counterpart) and
so can be labeled as pure states.
We can see these boundaries (βM (α + γ, Φ) and βC (α + γ, Φ)) together, calculated for various values of Φ in
Fig. 6, upper panel. The curve βM (α + γ, Φ) and βC (α + γ, Φ) in the (α + γ, Φ) plane demarcate different
phases. The phase diagram is depicted for several choices of Φ. Finally, the first-order phase diagram for
βM (α + γ, Φ) and βC (α + γ, Φ) critical surfaces at various Φ all together is shown in Fig. 6, lower panel. The
phase defined by the βC surface is the one under which every pure state is recalled stably by the network
16 It

is straightforward to see that in the β → ∞ limit the random field term can always be neglected with respect to the
Hopfield terms.

23

1

1
#=0.0
#=0.5
#=1.0
#=1.5
#=3.0
#=3.5

0.8

0.8

1/!

0.6

1/!

0.6

0.4

0.4

0.2

0.2

0
0

0.02

0.04

0.06

0.08

0.1

0.12

0
0.14

"

1

0.8
0.7

0.01

0.02

0.03

0.04

0.7
1/!

0.6
0.5

0.4

0.4

0.3

0.3

0.2

0.2

0.1

0.1
0

0.5

1

1.5

2

2.5

3

3.5

0

0.06

#=10-6
#=0.01
#=0.02
#=0.03
#=0.04
#=0.05
#=0.06
#=0.07
#=0.08
#=0.09
#=0.10
#=0.11
#=0.12
#=0.13

0.8

0.5

0.05

"

0.9

0.6

0

0
1

#=10-6
#=0.01
#=0.02
#=0.03
#=0.04
#=0.05

0.9

1/!

#=0.0
#=0.5
#=1.0
#=1.5
#=3.0
#=3.5

0

"

0.5

1

1.5

2

2.5

3

3.5

"

Figure 6: Left panels: Phase diagrams given by the critical surface βM at various α (upper panels) and at
various Φ (lower panel). Right panels: Phase diagrams given by the critical surface βC at various α (upper
panels) and at various Φ (lower panel). As usual, α in the plots stands for α + γ.
given appropriate initial conditions

17

.

References
[1] A. K. Abbas, A.H. Lichtman, S. Pillai, Basic Immunology: Functions and Disorders of the Immune
System, Saunders Elsevier, Philadelphia, PA (2009)
[2] C. Wang, M. Khalil, J. Ravetch, B. Diamond, The naive B cell repertoire predisposes to antigen induced
systemic lupus erimatosus, Journ. of Immunology 170, 4826-4832, (2003).
[3] Y. Shoenfeld, Infections, vaccines and autoimmunity, Lupus 18, 1127-1128, (2009).
[4] A. Davidson, B. Diamond, Autoimmune diseases, New England Journ. of Medicine 345, 5, (2001).
[5] A.A. Sinha, M.T. Lopez, H.O DeVitt, Autoimmune diseases: the failure of self-tolerance, Science 248,
1380, (1990).
[6] G. Dighiero, N.R. Rose, Critical self-epitopes are key to the understanding of self tolerance and autoimmunity, Immunology Today 20, 423, (1999).
[7] S. Kivity, N. Agmon-Levin, M. Blank, Y. Shoenfeld, Infections and autoimmunity, Trends Immunol. 30,
409:414, (2009).
p
appropriate condition we intend a state that has non zero significant overlap (greater than 1/ (H) in the finite network)
with some stored pattern.
17 For

24

[8] B.D. Poole et al., Aberrant Epstein-Barr viral infection in systemic lupus erythematosus, Autoimmun.
Rev. 8, 337:342, (2009).
[9] J.A. Levy, HIV and the Pathogenesis of AIThe Cytokine Network and Immune Functions, ASM Press,
Washington, DC (2007).
[10] G.H. Fisher, F.J. Rosenberg, S.E. Strauss, J.K. Dale, L.A. Middleton, A.Y. Lin, Dominant interfering
Fas gene mutations impair apoptosis in a human autoimmune lymphoproliferative syndrom, Cell, 81,
935-946, (1995).
[11] M.C. Sneller, J. Wang, J.K. Dale, W. Strober, Middleton L.A. Y. Choi, Clinical, immunologic and
genetic features of an autoimmune lymphoproliferative syndrome associated with abnormal lymphocyte
apoptosis, Blood, 89, 1341-1348, (1997).
[12] E.R. Stiehm, H.D. Ochs, J.A. Winklestein and E. Rich, Immunologic Disorders in Infants & Children,
Elsevier Inc., Philadelphia, Pennsylvania (1996).
[13] A. Radbruch, P.E. Lipsky, Current Concepts in Autoimmunity and Chronic Inflammation (Current
Topics in Microbiology and Immunology), Springer-Verlag, Berlin (2010).
[14] G. Parisi, Two signals from B cells control the expansion of T cells: Only one is immunologically specific,
Ann. Inst. Pasteur/Immunol. 139, 177-185, (1988).
[15] D. Kitamura, How the Immune System Recognizes Self and Nonself, Springer-Verlag, Berlin, (2008).
[16] J. Thèze, The Cytokine Network and Immune Functions, Oxford University Press, Oxford, UK (1999).
[17] G. Zandman-Goddard and Y. Shoenfeld, HIV and autoimmunity, Autoimmunity Rev. 1, 329:337,
(2992).
[18] A. Barra and E. Agliari, Autopoietic immune networks from a statistical mechanics perspective, J. Stat.
Mech. P07004, (2010).
[19] A. Barra and E. Agliari, Stochastic dynamics for idiotypic immune networks, Physica A 389, 5903-5911
(2010).
[20] M. Sneller, M.J Leonardo, J.M Puck and W. Strober, An inherited disorder of lymphocyte apoptosis;
The autoimmune lymphoproliferative syndrome, Annals of Internal Medicine, 130, 7, 591, (1999).
[21] M. Sneller et al., Clinical, immunologic and genetic features of an autoimmune lymphoproliferative
syndrome associated with abnormal lymphocyte apoptosis, Blood, 89, 1341-1348, (1997).
[22] M. Sneller, J. Dale and S. Strauss, Autoimmune lymphoproliferative syndrome, Current Opinion in
Rhematology 15, 417-421, (2003).
[23] C.E. Jackson, R.E. Fischer, A.P. Hsu et al., Autoimmune lymphoproliferative syndrome with defective
Fas: genotype influences penetrance. Am. J. Hum. Genet. 1002-1014 (1999)
[24] F. Rieux-Laucat, F. Le Deist, A. Fischer, Autoimmune lymphoproliferative syndromes: Genetic defects
of apoptosis pathways., Cell Death Differ 10, 124-133 (2003)
[25] F.M. Burnet, The clonal selection theory of acquired immunity, Cambridge University Press, (1959).
[26] A. Di Biasio, E. Agliari, A. Barra and R. Burioni, Mean-field cooperativity in chemical kinetics, submitted (available at arXiv:1104.3783).
[27] N.K. Jerne, Towards a network theory of the immune system, Ann. Immunol. (Paris) 125C, 373Ð389
(1974)
25

[28] F.J. Varela and A. Coutinho, Second generation immune networks., Immunol Today, 2 (5),159-66 (1991).
[29] G. Parisi, A simple model for the immune network, Proc. Natl. Acad. Sci. USA 87 (1), 429Ð433 (1990)
[30] C. Janeway, P. Travers, M. Walport, M. Shlomchik Immunobiology, Garland Science Publishing, New
York, NY (2005).
[31] E. Agliari, A. Barra, K. Gervasi-Vidal and F. Guerra, Can persistent Epstein-Barr virus infection
induce Chronic Fatigue Syndrome as a Pavlov feature of the immune response?, submitted (available at:
arXiv:1102.0933)
[32] D.J. Amit, Modeling Brain Function, Cambridge University Press (1989)
[33] G.E. Hinton, R. R. Salakhutdinov, Reducing the Dimensionality of Data with Neural Networks, Science
313, 5786, 504-507, (2006).
[34] Y. Bengio, Learning Deep Architectures for Artificial Intelligence, Machine Learning 2, 1, 127, (2009).
[35] A.C.C. Coolen, R. Kuehn and P. Sollich, Theory of neural information processing systems, Oxford
University Press, (2005).
[36] J. Hopfield, Proc. Nat. Acad. Sci. U.S.A. 79, 2554 (1982)
[37] G. W. Hoffmann, Nature Preceedings (2010)
[38] D. Dasgupta, Systems, Man, and Cybernetics, 1997. ‘Computational Cybernetics and Simulation’., 1997
IEEE International Conference on, 873 - 878 vol.1 (2002)
[39] F. T. Vertosick, R. H. Kelly, Journal of Theoretical Biology, 150 (2), 225-237 (1991)
[40] E. Ahmed and A. H. Hashish, Theory in Biosciences, 124, (3-4), 413-418 (2006)
[41] D.J. Amit, H. Gutfreund, H. Sompolinsky, Information storage in neural networks with low levels of
activity, Phys. Rev. A 35, (1987).
[42] A. Barra, F. Guerra, About the ergodicity in Hopfield analogical neural network, J. Math. Phys. 49,
125217, (2008).
[43] A. Barra, F. Guerra, G. Genovese, The replica symmetric behavior of the analogical neural network, J.
Stat. Phys. 140, 4, 784, (2010).
[44] H. Sompolinsky, Phys. Rev. A 34, 2571 (1986)
[45] P.A. Cazenave, Idiotypic-anti-idiotypic regulation of antibody synthesis in rabbits, P.N.A.S. 74, vol 11,
5122-5125, (1977).
[46] J.M. Seigneurin, B. Guilbert, M.J. Bourgeat and S. Avrameas, Polyspecific natural antibodies and autoantibodies secreted by human lymphocytes immortalized with Epstein-Barr virus , Blood, 71, 3, 581-585,
(1988).
[47] P. Pereira, L. Forni, E.L. Larsson, M. Cooper, C. Heusser, A. Coutinho, Autonomous activation of B
and T cells in antigen free mice, Eur. Journ. Immun., 16, (1986).
[48] P. Pereira, E.L. Larsson, L.Forni, A. Bandeira, A. Coutinho, Natural effector T lymphocytes in normal
mice, PNAS 82, pp 7691-7695, (1985)
[49] M. Mezard, G. Parisi, M. A. Virasoro, Spin glass theory and beyond, World Scientic, Singapore (1987).

26

[50] A. Strasser, S. Whittingham, D. L. Vaux, M. L. Bath, J.M. Adams, S. Cory, A. W. Harris, Enforced
BCL2 expression in B lymphoid cells prolongs antibody responses and elicits autoimmune disease, Proc.
Matl. Acad. Sci. 88, 8661-8665 (1991).
[51] S. Nagata, T. Suda, Fas and Fas ligand: LPR and GLD mutations, Immunol. Today 16, 39-43 (1995).
[52] T. L. H. Watkin and D. Sherrington, A Neural Network with Low Symmetric Connectivity, Europhys.
Lett. 14 791 (1991)
[53] T.B. Kirkwood, S.N. Austad, Why do we age, Nature Genet., 408, (2000).
[54] R. Holliday, A. Gerentol, The multiple and irreversible causes of aging, Biol. Sci. Med. Sci., 59, (2004).
[55] E. Gardner, Maximum Storage Capacity in Neural Networks, Europhys. Lett. 4 481, (1987).
[56] I. Lundkvist, A. Coutinho, F. Varela, D. Holmberg Evidence for a functional idiotypic network among
natural antibodies in normal mice, Proc. Natl. Am. Soc. 86, 5074-5078, (1989).
[57] A.S. Perelson and G. Weisbuch, Immunology for physicists. Rev. Modern Phys. 69, 1219Ð1267 (1997)
[58] A.S. Perelson, Immune network theory, Immunol. Rev. 110, 5Ð36 (1989)
[59] G.E.Uhlenbeck, L.S.Ornstein, On the theory of Brownian Motion, Phys. Rev. 36 823Ð41 (1930)
[60] M. Mezard, G. Parisi, M. Virasoro, Spin Glass Theory and Beyond, World Scientific, 1987

27

