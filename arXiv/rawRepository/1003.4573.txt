arXiv:1003.4573v1 [physics.bio-ph] 24 Mar 2010

Scaling Behaviors of Weighted Food Webs as Energy
Transportation Networks
Jiang Zhang, Liangpeng Guo
Department of Systems Science, School of Management, Beijing Normal University,
Beijing, 100875

Abstract
Food webs can be regarded as energy transporting networks in which the
weight of each edge denotes the energy flux between two species. By investigating 21 empirical weighted food webs as energy flow networks, we found
several ubiquitous scaling behaviors. Two random variables Ai and Ci defined
for each vertex i, representing the total flux (also called vertex intensity) and
total indirect effect or energy store of i, were found to follow power law distributions with the exponents α ≈ 1.32 and β ≈ 1.33, respectively. Another
scaling behavior is the power law relationship, Ci ∼ Aηi , where η ≈ 1.02. This
is known as the allometric scaling power law relationship because Ai can be
treated as metabolism and Ci as the body mass of the sub-network rooted
from the vertex i, according to the algorithm presented in this paper. Finally,
a simple relationship among these power law exponents, η = (α − 1)/(β − 1),
was mathematically derived and tested by the empirical food webs.
Keywords: Power Law, Allometric Scaling, Energy Flow Network
1. Introduction
Scientists look for universal patterns of complex systems because such invariant features may help to unveil the principles of system organization(Waldrop,
1992). Complex network studies can not only provide a unique viewpoint
of nature and society but also reveal ubiquitous patterns, e.g., small world
and scale free, characteristic of various complex systems(Watts and Strogatz,
1998; Albert and Barabasi, 2002). However, ecological studies have shown
Email address: zhangjiang@bnu.edu.cn ()
Preprint submitted to Journal of Theoretical Biology

March 25, 2010

that binary food webs, which depict trophic interactions in ecosystems, refuse
to become part of the small world and scale free networks family (Montoya and Sole,
2002; Dunne et al., 2002). Although some common features, including ”two
degrees separation”, which means the very small average distance, are shared
among food webs (Williams et al., 2002), other meaningful attributes such
as degree distribution and clustering coefficient change with the size and
complexity (connectance) of the network (Dunne et al., 2002).
Weight information of complex networks such as air traffic network or
metabolism networks, etc., can reveal more unique patterns and features that
are never found in binary relationships(Barrat et al., 2004; Almaas et al.,
2004; Montis et al., 2007). Food web weights have two different, yet correlated, meanings in ecology. One is the strength of the trophic interaction(Emmerson and Raffaelli,
2004; Berlow et al., 2004); the other is the amount of energy flow. They are
correlated because interaction strength is the per capita measure of energy
flow. Interaction strength-based weighted food webs exhibit new features
such as a relationship between predator-prey body size ratio and interaction
strength (McCann et al., 1998; Wootton, 2002; Berlow et al., 2004).
Additionally, weights of food webs can also be denoted as the total
amount of energy flow between two species when the whole system is in the
steady state. Studies of energy flow networks in ecosystems have a long history (Odum, 1988; Finn, 1976; Szyrmer and Ulanowicz, 1987; Higashi, 1986;
Baird and Ulanowicz, 1989; Higashi et al., 1993; Patten, 1981, 1982). Many
systematic indicators were designed to depict the macro-state of energy flow
in ecosystem (Fath and Patten, 1999; Fath et al., 2001), of which some can
not only reflect the direct energy flows between species but also indirect effects and inter-dependence of species(Fath and Patten, 1999; Finn, 1976).
Although some important discoveries were made about the general structure and function of ecological networks(Fath and B.C., 1998; Hannon, 1973;
Levine, 1980; Hannon, 1986; Patten, 1985; Ulanowicz, 1986, 1997), few focus
on power law distributions and relations(Ulanowicz and Wolff., 1990).
Allometric scaling is an important universal pattern of flow systems.
Kleiber (1932) found that the metabolism and body size of all species follow a ubiquitous power law relationship, with an exponent around 3/4.
West et al. (1997) and Banavar et al. (1999) explained this pattern as an
emergent property of nutrient and energy transportation networks. This
recognition encouraged people to realize that allometric scaling may be a
universal feature for all transportation systems. Garlaschelli et al. (2003)
extended Banavar’s approach to binary food webs and found a similar al2

lometric scaling power law relationship. Although Garlaschelli’s method as
an algorithm had been applied to various networks, including the worldwide
trade network(Duan, 2007) and tree of life(Herrada et al., 2008), it had several shortcomings. The first step of his algorithm is to obtain a spanning
tree by cutting many edges in the original network so that a certain amount
of information is lost(Garlaschelli et al., 2003). Allesina and Bodini (2005)
improved this method by reducing the original network to a directed acyclic
graph. Although less information is lost, cutting edges is still unavoidable.
The second shortcoming of Garlaschelli’s approach and Allesina’s improvement is they can be applied to binary networks, but not weighted ones.
This paper will combine the successful approaches in complex weighted
networks and earlier studies on ecological flow networks to reveal the underlying heterogeneities and universal scaling behaviors of food webs. The study
is organized as follows. In section 2, the basic ideas and steps for obtaining
Ai and Ci are introduced. Afterwards, we apply these tools on 21 empirical food webs with energy flow information. Section 3.2 and 3.3 study the
power law distributions of Ai and Ci . We extend Garlarschelli’s approach
to weighted food webs without cutting edges. The allometric scaling power
law relationship between Ai and Ci is shown in section 3.4. A simple mathematical relationship among scaling exponents of power law distributions and
power law relation is derived and tested using empirical food webs in section
3.5. Finally, the ecological meaning of Ai and Ci , the distributions of flux
matrix and fundamental matrix, consideration of node information, etc., are
discussed in section 4. A simple example of our approach, a comparison to
the existing methods, and the theorem regarding power law exponents are
presented in the Appendix.
2. Methods
In this section, we outline the basic idea and mathematical definition of
our method. One simple example showing how the approach works will be
discussed in the Appendix A in detail.
2.1. Flux Matrix
An ecological energy flow network is a weighted directed graph that represents relationships of ecological energy transfer. For a given graph, a matrix
called flux matrix in this paper can be defined as representing the energy

3

flux between species.
F(N +2)×(N +2) = {fij }(N +2)×(N +2)

(1)

where fij is the energy flux from species i to j. Two special vertices represent
the environment: vertex 0 and vertex N + 1. Vertex 0 denotes the source of
energy flow, whereas vertex N + 1 represents the sink. We expect that the
dissipative and exported energy will flow to vertex N + 1. Therefore, there
are in total (N + 2) × (N + 2) entries in the flux matrix.
2.2. Fundamental Matrix
Suppose that the flow network is balanced, meaning that the total influx
equals the efflux for each vertex i ∈ [1, N]. We can then define an N × N
matrix M from F follows,
mij = fij /(

N
+1
X

fik ), ∀i, j ∈ [1, N]

(2)

k=1

and the fundamental matrix can be derived as
2

U = I +M +M +··· =

∞
X

M i = (I − M)−1

(3)

i=0

where, I is the unity matrix. Any element uij in U matrix denotes the
influence i to j along all possible pathways. U matrix was first introduced
in economic input-output analyses(Leontief, 1951, 1966) to indicate the direct and indirect effects of good flows in various economic sectors. Hannon
(1973) was the first to apply this matrix to ecology(Fath and Patten, 1999;
Ulanowicz, 2004).
Given the flux matrix and fundamental matrix, two vertex-related variables, Ai and Ci , which will later be shown to follow power law distributions,
are defined.
2.3. Ai
We can calculate the total flux through any given vertex i according to
F . This value is also called node intensity in complex weighted network
studies(Almaas et al., 2004). Because the network is balanced, we need only

4

calculate the efflux of each node as Ai ,
Ai =

N
+1
X

fij , ∀i ∈ [1, N]

(4)

j=1

2.4. Ci
Another vertex-related index called Ci can be defined to reflect the total
indirect effects or the total energy store of the sub-network rooted from vertex
i.
Ci =

N X
N
X

(f0j uji /uii )uik

(5)

k=1 j=1

We will provide an explanation of the indicator Ci in Appendix A by a
simple example.
Ai is the total flow-through or intensity of vertex i. Ci is the total influence of vertex i on all vertices in the whole network. Suppose that of the
many particles flowing in the network (Higashi et al., 1993), those passing
vertex i will be colored red. Ci would then be the total number of red particles flowing in the network. Actually, these two variables are extended from
the approach of Garlaschelli et al. (2003) to calculate the allometric scaling
of food webs (see Appendix B).
2.5. Balancing the Network
Sometimes the empirical network is not strictly balanced.
To facilitate
PN
PN +1 our
algorithm, we can balance them artificially. Suppose j=0 fji 6= j=1 fij for
P
PN +1
vertex i. We can add an edge with the weight |fij′ |, fij′ = N
j=0 fji −
j=1 fij
′
to connect the vertex i to N + 1 or 0. If fij > 0, the direction of this artificial
edge is from i to N + 1. If fij′ < 0, the direction is from 0 to i. Normally, the
artificial edges have very small weights because most empirical food webs are
almost balanced already.
2.6. Power Laws
After calculating the indicators of Ai and Ci for each vertex i, we will
show that they follow the power law distributions in the high tails, which
means that,
P (Ai > x) ∼ x1−α
5

(6)

and
P (Ci > y) ∼ y 1−β

(7)

for given Ai and Ci which are larger than given thresholds x0 , y0 (Clauset et al.,
2007), and where ∼ represents ”proportional to.” The cumulative probability
distribution curves will be shown and the power law exponents α, β calculated
in the next section.
Furthermore, we will show that Ai and Ci satisfy a power law relationship,
Ci ∼ Aηi

(8)

This relationship is also called the allometric scaling law because Ai represents metabolism and Ci is the equivalent body mass of the sub-system
rooted from vertex i (see Appendix A).
3. Results
3.1. Dataset
Twenty one food webs containing energy flow information from different
habitats were studied(Table 1). These food webs were obtained from an
online database1 , and most are from published papers. In Table 1, we list
the name and the number of nodes (|N|) and edges (|E|) in each web. The
number of nodes does not include the ”respiration” node, and the number of
edges only counts the energy flows between species, and does not include the
edges from (to) ”input” and ”output.” The weights of edges in these food
webs are energy flows whose values vary across a large range because the
units and time scales of the measurements are very different.
After studying the scaling laws of these food webs, we divided the results
into two main sections. First, the power law distributions that reflect the
heterogeneity of Ai and Ci are shown. Second, the allometric scaling power
law relationship that depicts the self-similar structures of energy flows is
discussed.
3.2. Power Law Distributions of Ai
We calculated the random variables Ai for each of the 21 empirical food
webs. Four of them are selected to plot in Figure 1.
1

http://vlado.fmf.uni-lj.si/pub/networks/data/bio/foodweb/foodweb.htm

6

Table 1: Empirical Food Webs and Their Topological Properties

(|N | stands for the number of vertices of the network and |E| is the number of
edges. The webs are sorted by their number of edges.)

Food web
Florida Bay, Dry Season
Florida Bay, Wet Season
Florida Bay
Mangrove Estuary, Dry Season
Everglades Graminoid Marshes
Everglades Graminoids, Dry Season
Everglades Graminoids, Wet Season
Cypress, Dry Season
Cypress, Wet Season
Mondego Estuary - Zostrea site
St. Marks River (Florida)
Lake Michigan
Narragansett Bay
Upper Chesapeake Bay in Summer
Middle Chesapeake Bay in Summer
Chesapeake Bay Mesohaline Net
Lower Chesapeake Bay in Summer
Crystal River Creek (Control)
Crystal River Creek (Delta Temp)
Charca de Maspalomas
Rhode River Watershed - Water Budget

7

Abbre.
BayDry
BayWet
Florida
MangDry
Everglades
GramDry
GramWet
CypDry
CypWet
Mondego
StMarks
Michigan
Narragan
ChesUpper
ChesMiddle
Chesapeake
ChesLower
CrystalC
CrystalD
Maspalomas
Rhode

|N|
127
127
127
96
68
68
68
70
70
45
53
38
34
36
36
38
36
23
23
23
19

|E|
1969
1938
1938
1339
793
793
793
554
545
348
270
172
158
158
149
122
115
81
60
55
35

0

0

10
Cumulative Probability

Cumulative Probability

10

−1

10

−2

10

(a) BayDry
−3

10

−3

10

−1

10
Ai

1

10

10

3

10

−7

10

−5

10

−3

10

−1

1

10

3

10

10

x

0

0

10
Cumulative Probability

10
Cumulative Probability

(b) CypWet
−2

−5

10

−1

10

−2

10

(c) Florida
−3

10

−1

10

−1

10

(d) MangDry
−2

−5

10

−3

10

−1

10
Ai

1

10

10

3

10

−6

10

−4

10

−2

0

10

10

2

10

Ai

Figure 1: Cumulative probability of the variable Ai for four selected food webs with the
best fitted lines. The fitted lines start from x0 , and their slopes are listed in Table 2

8

4

10

Ai s of real food webs decay as power law in the high tail; therefore, the
fitted lines start from given lower bounds x0 (Clauset et al., 2007). These
figures show that Ai follows the power law distribution.
There are obvious cutoffs in the tails that may be attributed to sampling
effects(Newman, 2005). According to equation 6, the cumulative probability
decays as x slowly. The probability of finding a higher Ai value (in the
tail of the curve) is very small. Therefore, the number of samples in this
interval becomes very few and statistical fluctuations are unavoidably large
as a fraction of sample number. This phenomenon is obvious in other fields
such as income(Clementi et al., 2006), personal donations(Chen et al., 2009)
and the number of species per genus of mammals(Newman, 2005).
The scaling exponent α for each food web was estimated according to
the maximum likelihood approach (Clauset et al., 2007). The exponents and
relative errors of power law fittings for all 21 food webs are listed in Table 2.
In Table 2, x0 s represent the lower bounds of the power law distributions.
We normalized x0 by dividing the maximum Ai of each food web to avoid
the large range variance of x0 among different webs because their units and
the measurement time scales are very different.
D is the statistic of the KS test(Rousseau and Rousseau, 2000; Goldstein et al.,
2004). Its value reflects the maximum distance between the cumulative probability of real data and the fitted model. Therefore, the smaller D values
indicate the better power law fitting. σ is the quantile of the 95% confidence
interval for different numbers of samples(Noether, 1967), and is only a reference for D. If D is smaller than σ, then we should accept the power-law
hypothesis(Noether, 1967). From Table 2, we know that all food webs pass
the KS test. In the last column, ”No. of samples” means the number of
sample points that are larger than x0 and follow the power law distribution.
By comparing different rows, we know that the food webs with more
edges can be better described by power laws because their Ds are smaller.
Further, the scaling exponent α and x0 /xmin increase as the scale of the
network decreases. All α values fall into the interval [1.23, 1.77], with an
average of 1.32.
The power law distributions of Ai s reflect the heterogeneities of energy
flux. Few nodes possess high Ai values, while most nodes only share a small
fraction of the energy flux. The exponent of power law reflects the degree
of heterogeneity of the whole network. Therefore, larger food webs are more
heterogeneous than smaller ones because their exponents are lower (Table
2). Although the power law distribution of Ai can not give us concrete
9

Table 2: Parameters of the power law distributions for Ai

(α is the power law distribution exponent of equation 6; x0 is the smallest value
of Ai that follows power law, xmax is the largest Ai ; D is the KS statistic; σ is
the quantile of 95% confidence interval; and the number of samples is the total
number of nodes following the power law distribution. The webs are sorted by
their number of edges)

Food web
Baydry
Baywet
Florida
Mangdry
Everglades
Gramdry
Gramwet
Cypdry
Cypwet
Mondego
StMarks
Michigan
Narragan
ChesUpper
ChesMiddle
Chesapeake
ChesLower
CrystalC
CrystalD
Maspalomas
Rhode

α
1.25
1.23
1.23
1.24
1.23
1.25
1.23
1.28
1.23
1.33
1.35
1.32
1.26
1.28
1.29
1.41
1.77
1.27
1.25
1.54
1.56

x0 /xmax
8.45e-006
4.24e-006
4.24e-006
1.55e-006
4.20e-006
9.55e-006
4.20e-006
5.95e-005
2.06e-005
3.87e-004
9.36e-004
1.80e-003
1.10e-004
9.54e-004
9.47e-004
8.25e-003
5.79e-002
1.04e-004
3.10e-005
2.22e-002
1.35e-002

10

D
0.09
0.08
0.08
0.06
0.12
0.11
0.12
0.10
0.10
0.11
0.17
0.18
0.16
0.21
0.17
0.22
0.20
0.13
0.12
0.18
0.17

σ
No. of samples
0.13
102
0.13
105
0.13
105
0.16
75
0.20
44
0.21
41
0.20
44
0.20
44
0.21
42
0.26
26
0.21
43
0.31
18
0.23
33
0.23
32
0.24
30
0.29
21
0.33
16
0.32
17
0.30
19
0.29
20
0.34
15

0

0

10
Cumulative Probability

Cumulative Probability

10

−1

10

−2

10

(a) BayDry
−3

10

−1

10

(b) CypWet
−2

−5

10

−3

10

−1

10

1

10

10

3

10

−6

10

−4

10

−2

Ci
0

2

10

4

10

0

10
Cumulative Probability

Cumulative Probability

10
Ci

10

−1

10

−2

10

(c) Florida
−3

10

0

10

−1

10

(d) MangDry
−2

−5

10

−3

10

−1

10

1

10

10

3

10

−6

10

Ci

−4

10

−2

0

10

10

2

10

4

10

Ci

Figure 2: Cumulative probability of the variable Ci s for four selected food webs with the
best fitted lines. The slopes of the fitted lines are listed in Table 3

information about each vertex (Fath and Patten, 1999; Patten, 1981, 1982),
it helps us to understand the network as a whole.
3.3. Power Law Distributions of Ci
The same approach can be applied to Ci s. The distributions of Ci s for
four selected food webs are shown in Figure 2.
The curves of Ci distributions are very similar to the curves in Figure 1.
The estimated exponents and the KS test parameters are listed in Table 3.
Comparing Table 3 with Table 2, the exponents of Ci distributions are
slightly higher than those of Ai distributions. The exponent β and KS test
statistic D decrease with the scale of the network. The average exponent of
these food webs is 1.33, with all Ci values falling into the interval [1.23, 1.84].
11

Table 3: Parameters of the power law distributions for Ci

(β is the power law distribution exponent of equation 7; y0 is the smallest value
of Ci that follows the power law, ymax is the largest Ci ; D is the KS statistic; σ is
the quantile of 95% confidence interval; the number of samples is the total
number of nodes following the power law distribution. The webs are sorted by
their number of edges)

Food web
Baydry
Baywet
Florida
Mangdry
Everglades
Gramdry
Gramwet
Cypdry
Cypwet
Mondego
StMarks
Michigan
Narragan
ChesUpper
ChesMiddle
Chesapeake
ChesLower
CrystalC
CrystalD
Maspalomas
Rhode

β
1.23
1.23
1.23
1.25
1.23
1.25
1.23
1.28
1.25
1.29
1.42
1.30
1.24
1.28
1.26
1.61
1.84
1.28
1.23
1.56
1.52

y0 /ymax
2.97e-006
2.71e-006
2.71e-006
2.03e-006
2.16e-006
4.57e-006
2.16e-006
4.88e-005
3.13e-005
9.61e-005
1.27e-003
7.22e-004
1.22e-004
6.03e-004
3.88e-004
2.41e-002
5.02e-002
1.04e-004
1.35e-005
1.63e-002
8.93e-003

12

D
0.08
0.08
0.08
0.07
0.10
0.10
0.10
0.10
0.11
0.12
0.16
0.17
0.17
0.20
0.19
0.18
0.22
0.13
0.12
0.19
0.23

σ
No. of samples
0.13
107
0.14
101
0.14
101
0.16
68
0.20
44
0.21
42
0.20
44
0.20
44
0.21
39
0.24
30
0.21
40
0.31
18
0.23
33
0.23
32
0.24
30
0.33
16
0.35
14
0.32
17
0.29
20
0.29
20
0.32
17

We have studied the heterogeneity of Ci s node by node. The nodes with
high Ai values always have high Ci values, indicating a possible positive
correlation between Ai and Ci .
3.4. Allometric Scaling Relations
The similarity between Figure 2 and Figure 1 shows that there must
be some connections between Ai and Ci . Allometric scaling of these flow
networks revealed that the relationship between Ai and Ci is actually a power
law.
As shown in Figure 3, the sample points aggregate around their fitted
lines very well. This relationship is ubiquitous for all 21 food webs as shown
in Table 4.
We used the minimum square error method to find the best-fitted line
(Table 4). R2 s were larger than 0.9 for all food webs except CrystalC, CrystalD and Rhode, whose scales are very small (|N| < 23). The R2 s and
exponents decrease with the scale of the network because the statistical significance decreases as the number of samples declines. All exponents η fall
into the interval [0.83, 1.05]. The mean value of ηs for these food webs, except
CrystalC,CrystalD and Rhode, is 1.02.
We also show the Ai and Ci values of root nodes for all food webs, and
fit them with a line on the log-log plot (Figure 4). These power law relations
reflect the self-similar nature of the weighted food webs.
3.5. Relationship of Scaling Exponents
As we have shown, Ai and Ci are random variables following power law
distributions with scaling exponents α and β, respectively. They also follow
a power law relationship with the scaling exponent η. Is there any universal
relationship among α, β and η?
Actually, for any random variables following power law distributions and
power law relations, we can prove a mathematical theorem (see Appendix C).
According to this theorem, the power law exponents α, β, η of the food webs
should also satisfy equation C.1. We tested this hypothesis by calculating
(α − 1)/(β − 1) − η for each of the 21 empirical food webs to obtain Figure
5.
From Figure 5, we know that most exponents of food webs satisfy this
relation, and that the errors become larger as the scale of the network decreases. As the scaling behaviors we are studying are statistical properties,

13

100

100

1
Ci

Ci

1
0.01

1.01

0.01

0.998
1

10-4

1

-4

10

10-6
10-5

0.001

0.1

10

10-6

10-4

Ai

0.01

1

100

Ai

Baydry

Cypwet

1000

10

10

Ci

Ci

1000

0.1

0.1
1.01

1.02
0.001
0.001

1

1
10-5
0.001

0.1

10

1000

Ai

10-5

0.001

0.1

10

Ai
Mangdry

Florida

Figure 3: Allometric Scaling relationship between Ai s and Ci s of four selected food webs
with the best fitted lines

14

1000

Table 4: Allometric scaling of Empirical Food Webs

(The second column lists ηs of each food web with the errors; The webs are
sorted by their number of edges)

Food web
Baydry
Baywet
Florida
Mangdry
Everglades
Gramdry
Gramwet
Cypdry
Cypwet
Mondego
StMarks
Michigan
Narragan
ChesUpper
ChesMiddle
Chesapeake
ChesLower
CrystalC
CrystalD
Maspalomas
Rhode

η
1.01±0.01
1.02±0.01
1.02±0.01
1.01±0.01
1.02±0.01
1.03±0.01
1.02±0.01
1.00±0.02
1.00±0.01
1.01±0.01
1.03±0.04
1.01±0.01
1.01±0.04
1.05±0.02
1.04±0.02
0.99±0.02
1.05±0.02
0.89±0.23
0.90±0.23
0.96±0.09
0.83±0.17

15

R2
0.9946
0.9946
0.9946
0.9967
0.9992
0.9990
0.9992
0.9957
0.9970
0.9989
0.9784
0.9986
0.9910
0.9966
0.9959
0.9966
0.9974
0.7706
0.7722
0.9656
0.8658

Ci

106

10

5

10

4

1.02
1

1000

5000

1 ´ 10

4

5 ´ 10

4

1 ´ 10

5

5 ´ 10

5

1 ´ 10

6

Ai

Figure 4: Ai , Ci plot for root nodes of 21 food webs. The slope η (the power law exponent)
is 1.02±0.02

the significance of these regularities will increase with the number of samples. Therefore, scaling behaviors are more obvious and accurate for large
scale networks because larger webs have more sample points.
4. Discussion
4.1. Ecological Meaning of Power Law Exponents
As demonstrated above, food webs as energy transportation networks
always follow power law distributions and relations. Three important exponents (α,β and η) are derived from these power law regularities. The
question of whether these exponents carry ecological meaning naturally follows, and at first, the three exponents all reflect integral properties of whole
networks. α describes the heterogeneity of first passage energy flux distributions among vertices. The heterogeneity decreases with α. Therefore the
distributions of energy flows are more uneven in large food webs than the
small ones. From table 2, we also know that all α values fall into the interval
[1.23, 1.77]. According to the features of power law distributions, the means
and variances of power law random variables with exponents smaller than
16

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21
Rhode

CrystalD

0.2
Mondego
0.1 Baydry

Narragan ChesMiddle
Michigan

CrystalC

Differences

Maspalomas
0.0

Cypdry
Baywet
Florida

Everglades Gramwet
Gramdry

Mangdry

ChesUpper
Cypwet

-0.1

ChesLower
-0.2
StMarks

-0.3
Chesapeake
1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

Food Webs

Figure 5: The differences between η and (α − 1)/(β − 1) are calculated for all food webs
to test the exponents relationship (equation C.1). The food webs are sorted according to
their number of edges

17

2 are divergent(Newman, 2005). Therefore, energy flux on food webs has
no characteristic value. It is meaningless to find a specific species with the
average energy flux as the representation of other species(Newman, 2005).
The allometric scaling relation describes the self-similarity of flow networks. Garlaschelli et al. (2003); Allesina and Bodini (2005) pointed out
that allometric scaling exponents describe the transportation efficiency of
binary food webs because Ci is treated as the cost of transportation. The
range of these exponents is between 1 (most inefficient network) and 2 (most
efficient network). However, we believe that the exponent η discussed in this
paper does not describe the efficiency of the whole network. As pointed out
in section 2 and Appendix A, Ci can be understood as the energy store by
the system, rooted from i but not the cost of the transportation. Thus, the
food web with higher η can store more energy with the same consumption
of metabolites (Ai ). Therefore, we believe that the food webs with higher
η are more capable of storing energy by means of cycling the flows in the
network. In Table 4, we see that the networks with larger scales have larger
η values. Consequently, food webs can increase their ability to store energy
by increasing their complexity.
Further, the range of exponents η is not simply [1, 2] (see Table 4). As
Garlaschelli et al. (2003); Allesina and Bodini (2005); Banavar et al. (1999)
pointed out, the range [1, 2] is only suitable for spanning trees or directed
acyclic graphs of the original binary food webs. However, our method considers more ingredients, including the energy flux as the weight of edges, the
loop structures of energy flows, and the heterogenous energy dissipation of
each node, than the mere topology of the food webs with homogenous nodes.
That is the reason why the exponents are out of the range [1, 2].
The exponent β also describes the heterogeneity of indirect effects. It is
determined by exponents α and β via the theorem mentioned in section 3.5.
4.2. Flux Matrices and Fundamental Matrices
As discussed in section 2, Ai and Ci are defined according to the flux
matrix and fundamental matrix. Therefore, the scaling behaviors of the food
webs are determined by the matrices. The properties of these matrices may
help us to understand the origin of the scaling behaviors.
The elements in flux matrices also follow power law distributions, with
an average exponent 1.46 (see Table 5). We hypothesis that this power law
determines the power law distribution of Ai .

18

Table 5: Parameters of the power law distributions for fij

(α is the power law distribution exponent; F0 is the smallest value of fij that
follows the power law; Fmax is the largest fij ; D is the KS statistic; σ is the
quantile of 95% confidence interval; number of samples is the total number of
edges following the power law distribution. The webs are sorted by their number
of edges)

Food web
Baydry
Baywet
Florida
Mangdry
Everglades
Gramdry
Gramwet
Cypdry
Cypwet
Mondego
StMarks
Michigan
Narragan
ChesUpper
ChesMiddle
Chesapeake
ChesLower
CrystalC
CrystalD
Maspalomas
Rhode

α
1.33
1.33
1.33
1.32
1.37
1.39
1.37
1.34
1.29
1.40
1.84
1.43
1.70
1.32
1.31
1.64
1.65
1.37
1.29
1.71
1.84

F0 /Fmax
3.82e-006
4.91e-006
4.91e-006
2.81e-007
2.98e-006
3.32e-006
2.98e-006
5.93e-005
1.15e-005
4.80e-005
1.29e-002
5.88e-004
1.43e-002
1.95e-004
1.28e-004
2.05e-002
1.17e-002
1.01e-004
6.56e-005
2.10e-002
2.65e-002

19

D
0.03
0.02
0.02
0.04
0.06
0.06
0.06
0.05
0.06
0.05
0.10
0.11
0.09
0.09
0.11
0.17
0.16
0.08
0.09
0.13
0.13

σ
No. of Samples
0.05
761
0.06
608
0.06
608
0.05
614
0.09
222
0.10
194
0.09
222
0.10
203
0.09
240
0.12
123
0.19
53
0.17
62
0.23
34
0.11
151
0.12
134
0.24
30
0.18
55
0.24
30
0.27
24
0.19
53
0.29
20

0

0

10
Cumulative Probability

Cumulative Probability

10

−1

10

−2

10

−3

10

−4

(a) BayDry

10

−5

10

−8

10

−6

−4

−2

−3

10

10
10
10
Fundamental Matrix

10

0

10

(b) CypWet
−11

10

0

−9

10

−7

−5

−3

−1

−5

−3

−1

10
10
10
10
Fundamental Matrix

1

10

0

10
Cumulative Probability

10
Cumulative Probability

−2

10

−4

−10

10

−1

10

−2

10

−3

10

−4

(c) Florida

10

−5

10

−1

10

−1

10

−2

10

−3

10

(d) MangDry

−4

−10

10

−8

10

−6

−4

−2

10
10
10
Fundamental Matrix

10

0

10

−11

10

−9

10

−7

10
10
10
10
Fundamental Matrix

1

10

Figure 6: Cumulative distribution of fundamental matrices of four selected food webs

However, unlike other variables, the distributions of fundamental matrices
are not power laws but rather more like log-normal because the tails of the
curves decline quickly (see Figure 6). We also studied all of the fundamental
matrices of 21 empirical food webs, and noted that very few could pass the
KS test.
We presume that the calculation of the fundamental matrix in equation 3
needs infinite operations on F matrix (see section 2). As a result, the noise in
F matrices is enlarged and accumulated in the tails of the distribution curves
of U matrix. However, the means by which the non-power law distribution
of fundamental matrices determines power law distributions of Ci and the
allometric scaling power law relationship is an interesting problem for future
studies.
20

4.3. Information on Nodes
One of the weak points of our study on allometric scaling power law relationships is that the exponents are very close to 1. However, in this case,
”allometry” just means the non-linear relationship between two variables,
so, the relationship between Ai and Ci cannot be rigorously defined as an
allometric scaling relationship. Because the calculations of fundamental matrices and Ci s are always based on linear algebra, the results are close to
linear relationship. One possible way to mend this weak point is to further
consider the information available about nodes.
Indeed, much information on nodes, i.e., each species in the web, is ignored in this work. The biomass as the weight of each node is available for
many food webs. According to the definition, Ci is simply the energy store
of the sub-system rooted from the vertex i. Therefore, biomass information
should be included in Ci because a large part of energy will flow into the
species node stored as biomass. It is possible that a new approach of calculating Ci including the biomass information for all species may break the
linear relationship between Ai and Ci .
Another important node characteristic is the body size of a given species.
The metabolic theory predicts that species body size of the species can not
only determine metabolism, life span, and birth rate, etc. (Brown, 2004),
but also play an important role in energy flows and food webs (Cohen et al.,
2003). An integrated theory of weighted food webs based on energy flow
networks should contain body size data.
5. Concluding Remarks
This paper presents a new approach to reveal the scaling natures of
weighted food webs as energy flow networks based on flux and fundamental
matrices. The Ai ,Ci distributions and the relationship between them always
follow power laws. The power law exponents α,β and η satisfy a relationship, η = (α − 1)/(β − 1) as proved by the theorem 1. Power law exponents
consistently change with network scales.
We note that the allometric scaling exponent does not reflect the transportation efficiency of networks but rather the capability of storing energy,
which is very different from previous studies. We also investigated the distributions of flux matrices and fundamental matrices, and suggested that
biomass information should be incorporated into future studies.

21

Acknowledgement. Thanks for the support of National Natural Science Foundation of China(No.70601002 and No.70771011). We acknowledge Clauset,
A. for providing the source code of power law fitting and KS test on his web
site; and also the Pajek web site to provide food web data online. We also
acknowledge three anonymous reviewers for advices.
Appendix A. A Simple Example
To understand the method introduced in the section 2, let’s look at a
simple example (Figure A.7).
20

2

10

4

2

50
100

1

10
20

10

100
20

30
3

5
HaL

4

1

12
13

2

50

30

10

16

4

12
30

10

10

1

1
15

30

5

3
25

5

5
HaL
b

35

12

27

12

310
3
57

18
HcL

5
78

Figure A.7: An example to illustrate our method on deriving Ai s and Ci s

(a) is the original flow network; (b) is the balanced network from (a), the dashed
arrows are artificial edges pointing to the sink node; (c) is the Markov chain
calculated according to (b).

As shown in Figure A.7, the balanced flow network and the derived matrix
M can be obtained step by step according to the method described in section
2. The fundamental matrix U can then be calculated for this simple network.


1 3/5
7/20
1/5
2/5
 0 42/41 7/82
14/41 28/41 


2

4/41
8/41 
U = I + M + M + · · · =  0 12/41 42/41
 (A.1)
 0 3/164 21/328 165/164 21/41 
0 3/82 21/164
1/82
42/41
Any entry mij in the matrix M is merely the probability of one particle
flowing from vertex i to vertex j(Barber, 1978). Furthermore, any entry (i, j)
22

in M · M represents the probability of a particle flowing from i to j along
any path in 2 steps. M · M · M represents the probabilities after 3 steps, etc.
(Higashi et al., 1993). Thus, the matrix U simply takes in consideration all
transfers of particles along all possible paths.
Now, we will show how to calculate Ai and Ci for vertex 2.
to
PAccording
6
the definition, Ai is the total flow-through of vertex i, so A2 = j=1 f2,j = 60.
Suppose many particles are flowing in the network. They will be colored
red once they flow through vertex 2. These particles will keep their color and
flow around the whole network along all possible pathways. Hence, the total
number of red particles in the network is just C2 , which is computed as,

C 2 = G2

5
X

u2k = ((100 × 3/5 + 0)/(42/41))

k=1

5
X

u2k = 125

(A.2)

k=1

P
where the term G2 = 5j=1 f0j uj2/u22 in equation A.2 is the total number
PN of new particles which are colored red by vertex 2 in each time step.
j=1 f0j uj2 is the number of particles that flow into the system from the
environment 0 to the vertex i along all possible pathways at each time step,
with f0j = (100, 0, 0, 0, 0) in this example. By dividing by the term uii to
derive Gi one avoids
PN double counting the red particles(Higashi et al., 1993).
Thus, Ci = Gi k=1 uik is the total number of particles that have been colored red and flow to other nodes along all possible pathways at each time
step.
If we treat the red particles flowing in the network as a metabolic subsystem, we can calculate its allometric scaling relationship as Garlaschelli
has done for binary food webs (Garlaschelli et al., 2003). Thus, Ai is the
metabolism and Ci is the energy store or body mass of the sub-system.
Indeed, Garlaschelli’s approach can be recovered by our method, as shown
in the next section.
Appendix B. Comparisons to Existing Approaches
In this section, we will compare our approach to Garlaschelli et al. (2003)’s
method and Allesina and Bodini (2005)’s method.
Figure B.8(a),(b) shows how Garlaschelli’s approach can be applied to
a hypothetical food web to calculate Ai and Ci for each vertex. At first,
a spanning tree is constructed from the original food web (Figure B.8 (a))
23

g

1

1

1

h

1

f

2

g

1

1
h

1 1
f

3

1

2
1
b

c

d

3

e

6

1

1

2

3

1

1
b

1

3
1

2

1
3

2

g

1

1

6

17

3

6

2

3

2

3

1

2
b

2

Figure B.8:
methods.

1
c

1

1
1

a
11

3

6

1

1

1

HdL

3
3

6
8 27

3

h

3

6

a

3

1 2
f

1

HcL

1

3

2

e

8

HbL

HaL

1
d

1

8 19

a

1
c

1
d

e

6

15

3

92

2

3

2

2
11 32
HfL

HeL

Calculations of allometric scaling of a hypothetical food web by various

(a) is a hypothetical food web (The letter in each vertex is its index). The black
vertex is the root; (b) is a spanning tree of the original network (a). Ai and
Ci are denoted inside and beside vertex i; (c) is the implicated flow network of
(b), the numbers beside edges are flux. The dashed lines are additional edges;
(d) is a directed acyclic graph of the original network, the numbers are Ai s and
Ci s calculated by the method of (Allesina and Bodini, 2005); (e) is a constructed
flow network according to (d); (f) is the network with numbers of Ai s and Ci s
calculated by our method according to the flow structure of (e).

24

3

by cutting edges. That way, each sub-tree rooted from any vertex can be
viewed as a sub-system of the spanning tree. For example, the sub-tree with
three vertices (b,f,g) rooted from the vertex b is a sub-system of the spanning
tree. Ai is the total number of vertices involved in this sub-tree and Ci is the
summation of Ai s for each vertex in this sub-tree. Therefore, in this example,
Ab is 3 and Cb is 6. Finally, the universal allometric scaling relationship of Ai s
and Ci s, with an exponent around 1.3, was found for all food webs, according
to Garlaschelli et al. (2003).
Garlaschelli’s method was inspired by Banavar et al. (1999)’s model to
explain the Kleiber’s law (See Figure B.8(c)). The spanning tree is simply
Banavar’s optimal transportation network. Thus, energy flows into the whole
system from the root along the links of the network to all nodes. Suppose
that each node would consume 1 unit of energy in each time step. A flux
with 1 unit representing the energy consumption by each node should then be
added to the original spanning tree. In Figure B.8(c), the energy dissipation
by each node is added as a dotted line. As a result, Ai of each node is just
the total influx of this node. Ci is the total flux (the total number of red
particles colored by i) of the sub-tree rooted from i. Essentially, calculation
of allometric scalings using Garlaschelli’s approach is based on this weighted
flow network model. Therefore, our algorithm can derive the exact same
values of Ai and Ci for the flow network (Figure B.8(c)).
Allesina and Bodini (2005) extended Garlaschelli’s method. First, the
original network is converted to a directed acyclic graph (DAG) as shown
in Figure B.8(d), then the sub-network originated from vertex i is identified
as the set of vertices that have at least one path from i. Therefore, vertices
b,c,d,f,g,h belong to the sub-network rooted from b because they are all
connected with b. Ai is the number of vertices in the sub-network, and Ci
is the summation of all Ai s in this sub-network as shown in Figure B.8(d).
Because Allesina and Bodini’s approach is not based on weighted flows, it
cannot be covered by our approach.
However, we can construct a balanced flow network according to the
original network as shown in Figure B.8(e). The information of edges is
added. Our approach can be applied to this flow network to calculate Ai
and Ci values (Figure B.8(f)). Comparing Figure B.8(d) to (f), we find their
Ai s are almost the same, except vertices a and h. To balance the network,
more flows are added in vertex h and a, so their Ai values are larger than
those in Figure B.8(d). This modification can not only influence Ai values
but also Ci s. The vertices in networks B.8(d) and (f) therefore have different
25

Ci values.
Although our approach requires weight information, it can be extended
to more general flow networks, even those with cycles and loops. Also, as
demonstrated by our approach, Ci merely means the energy stored in the subsystem rooted from vertex i, which provides much clearer and more significant
ecological meaning than previous works.
Appendix C. A Theorem about Power Law Exponents
Theorem 1. Suppose X and Y are two random variables following power
law distributions. Their density functions, p(x) ∼ x−α and p(y) ∼ y −β hold
for any positive x > x0 , y > y0 , where x0 and y0 are lower bounds of X and
Y . Additionally, X and Y satisfy a power law relation, Y ∼ X η , then the
exponents α, β, η have following relationship:
η = (α − 1)/(β − 1)

(C.1)

Proof. Because X and Y follow power law distributions, p(x) = cx−α , where
c is a constant that satisfies the normalization condition. And Y = kX η ,
where k is a constant, so, for any y > kxη0 ,
Z +∞
η
1/η
P {Y > y} = P {kX > y} = P {X > (y/k) } =
cx−α dx (C.2)
(y/k)1/η

Let t = kxη , so x = (t/k)1/η , dx = (1/η)k −1/η t(1/η)−1 dt. Take it into equation
C.2,
Z +∞
Z +∞
(α−1)/η
(1−α)/η−1
P {Y > y} =
(ck
/η)t
dt =
k ′ t(1−α)/η−1 dt (C.3)
y

y

where k ′ = ck (α−1)/η /η is a constant. Because Y follows power law distribution,
Z +∞
P {Y > y} =
c′ y −β dy
(C.4)
y

Compare equation C.3 with equation C.4, we know that,
− β = (1 − α)/η − 1

26

(C.5)

Finally,
η = (α − 1)/(β − 1)

(C.6)

Albert, R., Barabasi, A., 2002. Statistical mechanics of complex networks.
Rev. Mod. Phy. 74, 47–97.
Allesina, S., Bodini, A., 2005. Food web networks: Scaling relation revisited.
Ecol. Complex. 2, 323–338.
Almaas, E., Kovcs, B., Vicsek, T., Oltvai, Z., Barabasi, A., 2004. Global
organization of metabolic fluxes in the bacterium escherichia coli. Nature
427, 839–843.
Baird, D., Ulanowicz, R. E., 1989. The seasonal dynamics of Chesapeake bay
ecosystem. Ecol. Monogr. 59, 329–364.
Banavar, J., Maritan, A., Rinaldo, A., 1999. Size and form in efficient transportation networks. Nature 399, 130–132.
Barber, M., 1978. A markovian model for ecosystem flow analysis. Ecol.
Model. 5, 193–206.
Barrat, A., Barthelemy, M., Pastor-Satorras, R., Vespignani, A., 2004. The
architecture of complex weighted networks. Proc. Natl. Acad. Sci. U. S. A.
101, 3747–3752.
Berlow, E., Neutel, A., Cohen, J., De Ruiter, P., Ebenman, B., Emmerson,
M., Fox, J., Jansen, V., Jones, J., Kokkoris, G., Logofect, D., Mckane,
A., Montoya, J. M., Petchey, O., 2004. Interaction strengths in food webs:
issues and opportunities. J. Anim. Ecol. 73, 585–598.
Brown, J., 2004. Toward a metabolic theory of ecology. Ecology 85 (7), 1771–
1789.
Chen, Q., Wang, C., Wang, Y., 2009. Deformed zipf’s law in personal donation. Europhys. Lett. 88, 38001.
Clauset, A., Shalizi, C. R., Newman, M. E. J., Jun 2007. Power-law distributions in empirical data.
URL http://arxiv.org/abs/0706.1062
27

Clementi, F., Matteo, T. D., Gallegati, M., 2006. The power-law tail exponent of income distributions. Physica A 370, 49–53.
Cohen, J., Jonsson, T., Carpenter, S., 2003. Ecological community description using the food web, species abundance, and body size. Proc. Natl.
Acad. Sci. U. S. A. 100 (4), 1781–1786.
Duan, W., 2007. Universal scaling behavior in weighted trade networks. Eur.
Phys. J. B. 59, 271–276.
Dunne, J. A., Williams, R. J., Martinez, N. D., 2002. Food-web structure
and network theory: The role of connectance and size. Proc. Natl. Acad.
Sci. U. S. A. 99 (20), 12917–12922.
Emmerson, M., Raffaelli, D., 2004. Predator-prey body size, interaction
strength and the stability of a real food web. J. Anim. Ecol. 73, 399–409.
Fath, B., B.C., P., 1998. Network synergism: emergence of positive relations
in ecological systems. Ecol. Model. 107, 127–143.
Fath, B., Patten, B., 1999. Review of the foundations of network environ
analysis. Ecosystems 2, 167–179.
Fath, B., Patten, B., Choi, J. S., 2001. Complementarity of ecological goal
functions. J. Theor. Biol. 208, 493–506.
Finn, J., 1976. Measures of ecosystem structure and function derived from
analysis of flows. J. Theor. Biol. 56, 363–380.
Garlaschelli, D., Caldarelli, G., Pietronero, L., 2003. Universal scaling relations in food webs. Nature 423, 165–168.
Goldstein, M. L., Morris, S. A., Yen, G. G., 2004. Problems with fitting to
the power-law distribution. Eur. Phys. J. B. 41, 255–258.
Hannon, B., 1973. The structure of ecosystems. J. Theor. Biol. 41, 535–546.
Hannon, B., 1986. Ecosystem control theory. J. Theor. Biol. 121, 417–437.
Herrada, E., Tessone, C., Klemm, K., Eguiluz, V., Hernandez-Garcia, E.,
Duarte, C., 2008. Universal scaling in the branching of the tree of life. Plos
one 3, e2757.
28

Higashi, M., 1986. Extended input-output flow analysis of ecosystems. Ecol.
Model. 32, 137–147.
Higashi, M., Patten, B., Burns, T., 1993. Network trophic dynamics: the
modes of energy utilization in ecosystems. Ecol. Model. 66, 1–42.
Kleiber, M., 1932. Body size and metabolism. Hilgardia 6, 315–353.
Leontief, W., 1951. The Structure of the American Economy, 1919-1939. New
York: Oxford University Press.
Leontief, W., 1966. Input-Output Economics. Oxford University Press.
Levine, S., 1980. Several measures of trophic structure applicable to complex
food webs. J. Theor. Biol. 83 (2), 195–207.
McCann, K., Hatings, A., Huxel, G., 1998. Weak trophic interactions and
the balance of nature. Nature 395, 794–798.
Montis, A. D., Barthlemy, M., Chessa, A., Vespignani, A., 2007. The structure of interurban traffic: a weighted network analysis. Environ. Plann. B.
34, 905–924.
Montoya, J., Sole, R., 2002. Small world patterns in food webs. J. Theor.
Biol. 214, 405–412.
Newman, M. E. J., 2005. Power laws, pareto distributions and zipf’s law.
Contemporary Physics 46, 323–351.
Noether, G., 1967. Elements of Nonparametric Statistics. John Wiley and
Sons, New York.
Odum, H., 1988. Self-organization, transformity, and information. Science
242, 1132–1139.
Patten, B., 1981. Environs: the superniches of ecosystems. American Zoologist 21, 845–852.
Patten, B., 1982. Environs: relativistic elementary particles or ecology. American Natualist 119, 179–219.
Patten, B., 1985. Energy cycling in the ecosystem. Ecol. Model. 28, 1–71.
29

Rousseau, B., Rousseau, R., 2000. Lotka: A program to fit a power law distribution to observed frequency data. International Journal of Scientometrics,
Informetrics and Bibliometrics 4, 1–6.
Szyrmer, J., Ulanowicz, R., 1987. Total flows in ecosystems. Ecol. Model. 35,
123–136.
Ulanowicz, R., 1986. Growth and Development, Ecosystems Phemomenology.
Springer-Verlag, New York.
Ulanowicz, R., 2004. Quantitative methods for ecological network analysis.
Comput. Biol. Chem. 28, 321–339.
Ulanowicz, R., Wolff., W., 1990. Ecosystem flow networks: Loaded dice?
Math. Biosci. 103, 45–68.
Ulanowicz, R. E., 1997. Ecology, the Ascendent Perspective. Columbia University Press, New York.
Waldrop, M., 1992. Complexity: The Emerging Science at the Edge of Order
and Chaos. Tocuhstone, New York.
Watts, D., Strogatz, S., 1998. Collective dynamics of ’small-world’ networks.
Nature 393, 409–410.
West, G., Brown, J., Enquist, B., 1997. A general model for the origin of
allometric scaling laws in biology. Science 276, 122–126.
Williams, R. J., Berlow, E. L., Dunne, J. A., Barabasi, A., Martinez, N. D.,
2002. Two degrees of separation in complex food webs. Proc. Natl. Acad.
Sci. U. S. A. 99 (20), 12913–12916.
Wootton, J., 2002. Indirect effects in complex ecosystems: recent progress
and future challenges. J. Sea Res. 48, 157–172.

30

