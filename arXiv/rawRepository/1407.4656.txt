Fixation properties of subdivided populations with balancing selection
Pierangelo Lombardo,1 Andrea Gambassi,1 and Luca Dall’Asta2, 3

arXiv:1407.4656v2 [q-bio.PE] 20 Mar 2015

1

SISSA – International School for Advanced Studies and INFN, via Bonomea 265, 34136 Trieste, Italy
2
Department of Applied Science and Technology – DISAT,
Politecnico di Torino, Corso Duca degli Abruzzi 24, 10129 Torino, Italy
3
Collegio Carlo Alberto, Via Real Collegio 30, 10024 Moncalieri, Italy
(Dated: March 24, 2015)
In subdivided populations, migration acts together with selection and genetic drift and determines
their evolution. Building up on a recently proposed method, which hinges on the emergence of a time
scale separation between local and global dynamics, we study the fixation properties of subdivided
populations in the presence of balancing selection. The approximation implied by the method is
accurate when the effective selection strength is small and the number of subpopulations is large.
In particular, it predicts a phase transition between species coexistence and biodiversity loss in the
infinite-size limit and, in finite populations, a nonmonotonic dependence of the mean fixation time
on the migration rate. In order to investigate the fixation properties of the subdivided population for
stronger selection, we introduce an effective coarser description of the dynamics in terms of a voter
model with intermediate states, which highlights the basic mechanisms driving the evolutionary
process.
PACS numbers: 05.40.-a, 87.23.Kg, 87.23.Cc, 05.70.Fh

I.

INTRODUCTION

In a natural population without any structure or subdivision — usually referred to as a well-mixed population
— the temporal evolution results from the competition
between the deterministic evolutionary forces (selection)
and the stochastic effects generated by the death and
reproduction of individuals (genetic drift). Because of
stochasticity, every finite population in the absence of
mutations eventually reaches an absorbing state (fixation) in which all individuals have a unique trait (e.g.,
species/language/opinion) and biodiversity, defined as
the coexistence of various traits, is lost. When a population presents an internal structure, e.g., it is subdivided
in subpopulations, the individuals can move between different subpopulations and migration acts together with
selection and genetic drift, influencing relevant long-time
properties of the dynamics, such as the mean fixation
time (MFT). It is widely observed that habitat fragmentation and population subdivision play a major role in the
process of ecological change and biodiversity loss. Understanding and predicting the effects of migration on the
collective behavior of a subdivided population is therefore of primary importance in order to preserve ecosystems and species abundance.
Depending on the specific landscape into which the
natural population is embedded, its spatial structure can
be conveniently modeled by means of either one-, two-,
three-dimensional regular lattices or, more generally, by
a network with certain connections. If the degree of connectivity of each node of this network is sufficiently large
and the connected subpopulations have constant and
equal sizes, the effects of subdivision typically amount
to a rescaling of the relevant parameters of the population, such as the effective population size Ne and the
effective strength se of selection [1, 2]. However, both Ne

and se are functions of the rate with which individuals
migrate between subpopulations, therefore both the fixation probability and the MFT depend on it. In the
absence of selection or when it is constant, the MFT
monotonically decreases upon increasing the migration
rate [3–5]. When evolutionary forces which favor biodiversity are present, instead, it was recently shown that
the MFT can display a nonmonotonic dependence on the
migration rate [6]. Even in the absence of mutation, this
kind of evolutionary forces are common to natural populations. In particular the balancing selection [7, 8] associated with them is an umbrella concept, encompassing
mechanisms such as over-dominance or heterozygote advantage, which act for the maintenance of biodiversity in
several contexts, most notably mammalian [9] and plants
[10]. For example, it has been proposed that some genetic
diseases in humans, such as sickle-cell anemia [11], cystic fibrosis [12], and thalassemia [13] actually persist as
a consequence of balancing selection. Analogous mechanisms are responsible for the emergence of bilingualism
in language competition [14] or for cooperative behaviors
in ecology and coevolutionary dynamics [15, 16], such as
those recently observed in microbial communities [17].
The present work builds on the approach introduced
in Ref. [6] and extends the investigation reported therein
in several respects. We consider a group of equally sized
subpopulations (i.e., a metapopulation) which balancing
selection acts on, while migration takes place between
any pair of subpopulations, such as to form a fully connected graph with each subpopulation occupying one of
its vertices. For concreteness we adopt below the terminology and notation specific of population genetics. In
Sec. I we review the details of the model and the approximation proposed in Ref. [6], which hinges on the
emergence of a separation between the time scale of the
local dynamics occurring at each vertex of the network

2
and that of the global dynamics at the level of the whole
network. The resulting approximation turns out to be accurate when the effective selection strength is sufficiently
small and the number N of subpopulations is sufficiently
large in the sense specified further below. In Sec. III
we show that in this case a phase transition takes place
between species coexistence and biodiversity loss. In order to be able to investigate the fixation properties of
the system for larger values of the selection strength —
which are not immediately accessible with the previous
approach — we propose in Sec. IV A an effective description in terms of a voter model, which is generically
accurate for small values of the migration rate. This
coarser description applies to a generic metapopulation
model, independently of the specific form of the natural
selection; in addition, in the presence of balancing selection, the range of values of migration rate for which
the effective voter model provides accurate predictions
can be extended by introducing an additional intermediate state in the voter model, as we discuss in Sec. IV B.
In contrast to the standard voter model, the one with
the additional state is actually able to reproduce the distinctive nonmonotonic dependence of the MFT on the
migration rate found in Ref. [6]. Moreover, it provides a
semi-quantitative explanation of a nonmonotonic behavior observed in the MFT as a function of the selection
coefficient s, which appears for small migration rate m
in addition to the one discussed in Ref. [6]. A summary
of our findings and the conclusions are then presented in
Sec. V.

II.

A.

METAPOPULATION MODEL

From microscopic to mesoscopic dynamics

The evolution of finite well-mixed populations is conveniently described at the microscopic level by the WrightFisher model [18, 19], which consists of a (haploid) population of Ω individuals, each one carrying one of two
possible alleles A or B. At each time step of the dynamics the original population is substituted by a new
generation obtained by a binomial random sampling determined by the features of the previous one: the allele
of each new individual is randomly drawn with a probability which depends on the frequency of occurrence of A
(or, equivalently B) in the parent generation. The time
interval τg between two consecutive steps of this dynamics represents the duration of a generation. In a neutral
model, i.e., in the absence of selection, each new individual carries allele A (respectively B) with probability
x = ΩA /Ω (respectively 1 − x), where ΩA is the number
of individuals carrying allele A in the preceding generation. In order to mimic the effects of natural selection,
one introduces different allele fitnesses wA = 1 + s̃ and
wB = 1 for alleles A and B, respectively, which affect

the probability pr (x) that a new individual carries allele
A after reproduction as
pr (x) =

wA ΩA
(1 + s̃)x
=
.
wA ΩA + wB ΩB
1 + s̃x

(1)

Alternatively, the dynamics of the same population can
be described by the Moran model [20]. At each time step
of the dynamics two individuals (not necessarily distinct)
are randomly selected in the population. In the absence
of selection, an exact copy of the first one is introduced
in order to replace the second one, which is therefore
removed from the population. Since individuals are randomly chosen, the probability dA = ΩA /Ω = x of removing an individual with allele A from the population equals
the probability rA of reproducing one of them. Analogously, for an individual carrying allele B these probabilities are dB = rB = 1 − x. Within the Moran model,
a selective advantage can be accounted for by modifying the reproduction probability rA,B of the alleles with
the fitnesses wA and wB specified above, according to
rA (x) = (1 + s̃)x/(1 + s̃x) and rB (x) = x/(1 + s̃x). With
these probabilities, the number of individuals carrying
allele A increases/decreases by one at each step of the
dynamics with rates W+1 /W−1 , respectively, with
W+1 δt = rA dB = (1 + s̃)x(1 − x)/(1 + s̃x),
W−1 δt = rB dA = x(1 − x)/(1 + s̃x),

(2)

where δt is the duration of the time step [21].
Although the Wright-Fisher and Moran models are implemented with different rules at the microscopic level,
for a wide range of values of the parameters and sufficiently large populations, they turn out to be effectively
described by the same Langevin equation (with Itô prescription, see Appendix A)
p
ẋ = µ(x) + v(x) η(t),
(3)
where the evolution of the frequency x of allele A in
the population is driven by the sum of a deterministic
force µ(x) = s̃x(1 − x) generated by selection and of
a stochastic term — referred to as genetic drift in the
literature — which is a delta-correlated Gaussian noise
with zero mean and variance v(x) = x(1p− x)/(Ωτg ).
This noise is conveniently expressed as
v(x) η(t) in
terms of the normalized Gaussian noise η with hηi = 0
and hη(t)η(t0 )i = δ(t − t0 ). Note that Eq. (3) provides
an approximate description of the dynamics in terms of
an effective diffusion process. While this approximation
turns out to be accurate for the Wright-Fisher and Moran
models, at least within a suitable parameter range (see
Refs. [6, 22]), it is known to fail in other cases, e.g., in the
susceptible-infected-susceptible (SIS) model of epidemiology [23].
Without loss of generality, time can be measured in
units of generations, so that τg = 1 and the rates become
dimensionless quantities. Balancing selection is charac-

3
terized by a selective advantage s̃ which favors the evolution towards a state of the population characterized
by an optimal frequency x∗ of allele A; in the simplest
case one can assume a linear dependence s̃ = s(x∗ − x),
with a constant s > 0. Note that in an infinitely large
population (with Ω → ∞), the fluctuation effects represented by η in Eq. (3) are suppressed, and the resulting
deterministic dynamics due to the selection term µ drives
the population towards the optimal frequency x∗ of allele A. In a finite population, instead, the presence of
fluctuations due to the random genetic drift eventually
drives x towards one of the two possible absorbing states
x = 0 and 1, corresponding to the fixation of allele B
and A, respectively. The mean fixation time and the fixation probability of a population described by Eq. (3) can
be evaluated within the diffusion approximation by the
standard methods introduced in Ref. [24]. A summary
of the relevant results and expressions is provided in the
Appendix B.
In the absence of spatial embedding, a celebrated prototype model of subdivided populations is the so-called
“island model”, originally proposed by Wright [25] for
neutral evolution. It consists of N interacting subpopulations (demes) of identical size Ω, labeled by an integer i = 1, . . . , N and characterized by the frequencies {x1 , x2 , . . . , xN } for the occurrence of allele A, with
xi ∈ [0, 1]. Within each deme, the internal dynamics (assumed to be identical in the absence of migration) proceeds as in either Moran’s or Wright-Fisher’s stochastic models, while different demes interact by exchanging randomly selected individuals, such that the sizes Ω
of the demes involved in the exchange are not affected.
The rate m with which migration occurs is defined as
m = ni↔j N/Ω, where ni↔j is the mean number of individuals exchanged between the deme i and j in one
generation. As a consequence of this exchange, the transition rates which define the Moran and Wright-Fisher
models are modified as described in Appendix A. For
sufficiently large Ω and small m and s (see Appendix A),
the evolution of the allele frequency xi in the i-th deme
can be described, both within the Moran and WrightFisher models by the following Langevin equation with
Itô prescription
p
ẋi = µ(xi ) + m(x̄ − xi ) + v(xi ) ηi ,
(4)
where ηi are the independent Gaussian noises with correlation hηi (t)ηj (t0 )i = δi,j δ(t−t0 ), while the term m(x̄−xi )
accounts for the migration of individuals between the
demes and it depends on xj6=i only through the interPN
deme mean frequency x̄ = i=1 xi /N .
In the presence of migration, each deme exchanges individuals with the others, a process that effectively acts
as a source of biodiversity inside each deme, preventing
them from achieving independent fixation. In fact, the
single-deme states xi = 0 and 1 are no longer per se
absorbing for m 6= 0 and global fixation requires a coordinate evolution towards the two global absorbing states

X0 ≡ {xi = 0}i=1,...,N or X1 ≡ {xi = 1}i=1,...,N in which
all demes fixate the same allele. In this case, the dynamics of the population can be conveniently described via
the exact evolution equation for the mean frequency x̄,
which can be obtained directly from Eq. (4) (see, e.g.,
Eq. (S10) in the Supplemental Material of Ref. [6]),
q
ẋ = s[x∗ x − (1 + x∗ )x2 + x3 ] + (x − x2 )/(ΩN ) η, (5)
where η is a Gaussian noise with hη(t)η(t0 )i = δ(t − t0 )
PN
and xk = i=1 xki /N . Due to the non-linear nature of
Eq. (4), the evolution equation for x̄ involves higher-order
moments x2 and x3 which in principle could be determined by solving a whole hierarchy of coupled differential
equations.

B.

Disentangling time scales

As recently discussed in Ref. [6], for a large number
of demes N and small selection strength s (see [26] for
a precise statements of these conditions), a time scale
separation emerges between the local dynamics and the
global one, i.e., between the dynamics of xi and that of x̄:
this allows one to express the moments xk in Eq. (5) in
terms of x̄. In fact, on the typical time scale of variation
of the inter-deme mean frequency x̄, the local frequencies {xi }i=1,...,N are rapidly fluctuating and their statistics can be described by a quasi-stationary distribution
Pqs (xi |x̄). Conversely, on the time scale which characterizes the fast fluctuations of each single local frequency xi ,
the mean frequency x̄ is practically constant. In passing,
we mention that an analogous separation of time scales
occurs in non-homogeneous metapopulations [27]. In the
present case, it suggests that the quasi-stationary distribution could be accurately approximated by the stationary solution of the Fokker-Planck equation associated
with Eq. (4) with fixed x̄, which is
0

0

0

Pqs (xi |x̄) ∝ x2m x̄−1 (1 − x)2m (1−x̄)−1 es x(2x∗ −x) ,

(6)

where m0 = Ωm and s0 = Ωs are a conveniently rescaled
migration rate and selection coefficient. Figure 1 shows
the histogram of the single-deme frequencies xi in a
certain metapopulation with a mean x̄ = 0.5, as obtained from the numerical simulation of the WrightFisher model. The dashed line in the figure indicates the
theoretical prediction given by the quasi-stationary distribution Pqs (xi |x̄ = 0.5) in Eq. (7) and it clearly shows
significant discrepancies with the actual histogram. According to Ref. [6], this discrepancy can be resolved by
considering a quasi-stationary distribution of the same
functional form as Eq. (6) but in which an effective parameter y(x̄) replaces x̄ in order to account for the fact
that the latter actually varies in time:
0

0

0

Pqs (x|y) ∝ x2m y−1 (1 − x)2m (1−y)−1 es x(2x∗ −x) .

(7)

4

1.4

In turn, y(x̄) is determined in such a way to satisfy the
consistency condition
Z 1
dx x Pqs (x|y(x̄)).
(8)
x̄ =

1.2
1.0

When the selection coefficient s vanishes, the time scale
separation is very pronounced and this equation gives
y(x̄) = x̄. In the presence of a non-vanishing selection
strength, one can either solve Eq. (8) numerically or do
an expansion in the small parameter se /m, with
se =

s
1+

1
m0



1+

1
2m0

,

(9)

y(x̄) = x̄ − (se /m)x̄(1 − x̄)(xe∗ − x̄) + O((se /m)2 ), (10)
where
(11)

is another effective parameter that will be discussed further below. By solving Eq. (8) for the choice of parameters in Fig. 1, one obtains y(x̄ = 0.5) ' 0.53; the corresponding distribution Pqs (xi |y(x̄ = 0.5)) is reported as
a solid line in Fig. 1 and, in fact, it turns out to describe the actual distribution significantly better than
Pqs (xi |x̄ = 0.5). We emphasize the fact that in this
comparison there are no fitting parameters. A similar
improvement is found also for different values of x̄ and of
the parameters which characterize the population.
When the time scales separation holds, the moments
xk on the r.h.s. of Eq. (5) can be approximated by the corR1
responding moments hxk i = 0 dx xk Pqs (x|y(x̄)), leading
to the effective Langevin equation
p
(12)
x̄˙ = M (x̄) + V (x̄) η(t),
where the deterministic term and the variance of the
noise are respectively given by
Z 1
M (x̄) = s
dx x(1 − x)(x∗ − x)Pqs (x|y(x̄)) (13a)
0

and
V (x̄) = (ΩN )−1

Z

1

dx x(1 − x)Pqs (x|y(x̄)).

(13b)

0

At the lowest non-trivial order in small se /m, the population behaves as a well-mixed one with effective parameters which are rescaled due to the finite migration
rate m, in agreement with the results of Refs. [1, 2, 4].
In particular, the deterministic force and the variance of
the stochastic term turn out to be
M (0) (x̄) = se x̄(1 − x̄)(xe∗ − x̄),
V

(0)

(x̄) = x̄(1 − x̄)/Ne ,

0.8
0.6

Pqs Hx i Èy Hx LL
Pqs Hx i Èx L
WF

0.4
0.2
0.0
0.0

0.2

0.4

0.6

0.8

1.0

xi

which renders

xe∗ = x∗ + (x∗ − 1/2)/m0

Pqs

0

(14a)
(14b)

Figure 1. (Color online) Single-deme frequency distribution
in a metapopulation of N = 100 demes with Ω = 100 individuals each, with s0 = m0 = 1 and x∗ = 0.3, conditioned to
having a mean frequency x̄ = 0.5 ± 10−3 . The histogram
has been obtained by simulating the Wright-Fisher model
(WF) with migration (see Appendix A). The dashed line corresponds to the quasi-stationary distribution Pqs (xi |x̄ = 0.5)
in Eq. (7), while the solid line indicates Pqs (xi |y(x̄ = 0.5))
with y(x̄ = 0.5) ' 0.53 determined by solving numerically
the consistency equation (8). The histogram refers to the set
of single-deme frequencies {xi } recorded during the evolution
of the population after an initial transient but much before
fixation occurs and such that the corresponding fluctuating
mean x̄(t) is close to 0.5, i.e., with |x̄(t) − 0.5| < 10−3 . In
order to avoid correlations between successive recordings, we
assumed a minimal time-lag of 10 Tcorr where Tcorr = 1/m
is the time scale associated with a change of xi of the same
order as xi , due to migration.

where the effective selection strength se and the effective optimal frequency xe∗ are given in Eq. (9) and (11)
respectively, while


1
(15)
Ne = N Ω 1 +
2m0
is the effective population size. (In Eqs. (14) and in what
follows, the superscript (0) indicates that the corresponding quantity has been calculated at the lowest order in
an expansion in se /m.) It is worth noting that as the
migration rate m0 increases, the effective parameters se
and x∗e approach the values they have for the isolated
demes, while the effective size Ne tends to the total number N Ω of individuals in the metapopulation; accordingly, in the limit m0 → ∞, the internal structure of the
metapopulation does not affect its dynamics and subdivision plays no actual role. (This might not be the case in
non-homogeneous populations, as discussed in Ref. [27].)
If balancing selection is not symmetric, i.e., x∗ 6= 1/2,
the effective drift M (0) (x̄) in Eq. (14a) can be written as
the sum of a symmetric term
(0)
Msymm
(x̄) = se x̄(1 − x̄)(1/2 − x̄)

(16)

5
and a directional selection term [28]
(0)

(17)

σe = se (xe∗ − 1/2)

(18)

where

(0)
Msymm

is an effective directional selection coefficient.
promotes coexistence of the two alleles and therefore it
increases the biodiversity of the system, slowing down
(0)
fixation; Mdir , instead, favors fixation of one of the alleles (depending on the sign of σe ). The competition
between these two terms determines whether balancing
selection actually slows down or speeds up fixation of the
population as a whole. One can therefore expect that,
depending on the ratio |σe /se | being larger than some
(0)
(0)
threshold θ, Mdir prevails over Msymm such that balancing selection eventually accelerates fixation. According
to Eq. (11), this occurs for
|x∗ − 1/2| >

m0 θ
,
m0 + 1

(19)

which provides a heuristic estimate of the region of the
parameter space within which balancing selection should
facilitate fixation. The fact that balancing selection slows
down fixation only if the optimal frequency x∗ is far
enough from the absorbing boundaries (i.e., if it is close
enough to x∗ = 1/2) was first noticed in Ref. [29] for the
case of balancing selection in well-mixed populations, by
analyzing the eigenvalues of the transition matrix of the
Moran-like dynamics. In the next section, we argue that
this change of behavior becomes an actual phase transition in the limit N → ∞ of subdivided populations.
III.

PHASE TRANSITION IN THE INFINITE
ISLAND MODEL (N = ∞)

In the limit of an infinite number of demes, Eq. (12)
becomes deterministic because the variance V (x̄) of the
noise vanishes; this is not the case for the noise in the
single-deme equation (4), which is finite as long as Ω
is finite and therefore determines a non-trivial quasistationary distribution Pqs (x|y(x̄)) which, in turn, affects
Eq. (12). Depending on the values of the parameters s0 ,
m0 , and x∗ , the internal stochasticity of the demes might
be sufficiently strong to drive the metapopulation to fixation even in the infinite-size limit N → ∞. In fact,
the deterministic part of Eq. (12) might drive x̄ towards
one of the two absorbing states X0 and X1 corresponding to x̄ = 0 and x̄ = 1, respectively. In addition to
these latter solutions, Eq. (12) admits also a stationary
state with x̄ = x∞ , which can be determined by requiring
that M (x∞ ) vanishes, i.e., by solving the equation [see
Eq. (13a)]
Z

1

dx x(1 − x)(x∗ − x)Pqs (x|y) = 0,
0

(20)

0.05
MHxLs

Mdir (x̄) = σe x̄(1 − x̄),

0.00
-0.05

0.0

x* =0.9
x* =0.7
x* =0.5
x* =0.1
0.2

0.4

0.6

0.8

1.0

x
Figure 2. (Color online) Drift M (x̄) as a function of x̄, as
obtained from the numerical solution of Eq. (13a) for m0 = 2,
s0 = 1 (corresponding to se /m ' 0.3), and for various values
of x∗ . It can be noticed that, depending on the value of x∗ ,
a non-trivial zero x∞ emerges, which is always an attractive
state for the deterministic evolution of x̄.

where y = y(x∞ ) is defined by the consistency condition
in Eq. (8). Figure 2 shows the numerical determination
of M (x̄) (based on Eqs. (8) and (13a)) as a function of
x̄ for various values of x∗ in a population characterized
by the parameters reported in the caption. Figure 3,
instead, shows the comparison between M (x̄)/s calculated as in Fig. 2 (solid line) for x∗ = 0.35 (indicated by
the crossed circle) and the one inferred from the numerical simulations (symbols with errorbars) of a population
with N = 100 demes of Ω = 100 individuals each and the
same values of parameters as in Fig. 2. The evolution was
performed according to the Moran model, as the latter
turns out to be numerically more efficient for the determination of M than the Wright-Fisher model considered in
Fig. 1. This comparison shows that the effective description introduced in Sec. I captures also the quantitative
aspects of the actual dynamics of the subdivided population, at least within the range of parameters investigated
here. In particular, x∞ computed from Eq. (20) provides
an accurate estimate of the one inferred from numerical
simulations (circle in the figure). This non-trivial zero
x∞ of M in Figs. 2 and 3 corresponds to an attracting
stable state for the deterministic part of Eq. (12), which
is asymptotically reached for t → ∞ unless the initial
conditions are exactly on a boundary. The stability of
the point x∞ follows from the fact that M 0 (x∞ ) < 0.
When x∞ ∈ (0, 1), it represents a stable “active” state for
the infinite population and it corresponds to the infinitesize limit (N → ∞) of the metastable state in which a
finite system (N < ∞) would spend a long time before
reaching fixation [6]. However x∞ might coincide with
one of the two boundaries 0 and 1, depending on the
values of the parameters x∗ , m0 , and s0 and correspondingly M (x̄) has the same sign within the whole interval
(0, 1): when this happens, the deterministic part of the
dynamics drives the system towards fixation. Note that

6
-

-

-

æ

0.00
M HxLs

-

æ

- Ä
æ

-

-0.01

æ

æ

-

-0.02
-0.03

-

0.3
0.2

-

0.0

0.2

0.4

Ä

0.4

æ

-0.04
-0.05

Ä


0.5

num. integration
Moran
x*
x¥

x*c

0.01

Ä


0.1
0.6

0.8

0.0
10-4

1.0

x
Figure 3. (Color online) Deterministic term M (x̄) as a function of the mean frequency x̄ in a population of N = 100
demes with Ω = 100 individuals each and parameters m0 = 2,
s0 = 1, and x∗ = 0.35 (this latter value is indicated by the
crossed circle). The solid line corresponds to the numerical
solution of Eq. (13a), from which we can read the estimate of
x∞ (empty circle). Symbols with errorbars, instead, are the
results of the numerical simulations of this metapopulation,
based on the Moran model (see Appendix A for the definition
of the rates). In order to estimate M (x0 ) from the numerical
data, the increment δ x̄(t) is recorded at each Moran step of
the dynamics such that, correspondingly, |x̄(t) − x0 | < 10−3 ,
where x̄(t) is the fluctuating mean value of xi (t) within the
population. These increments are recorded from a time 5 Tcorr
after the beginning of the evolution to well before the eventual fixation occurs, and their mean gives M (x0 ). This figure
can be compared with Fig. 2 corresponding to different values
of x∗ .

active Hs'=1L
abs. Hs'=1L
x*c H0L Hs'=0L
s'=1
s'=10
s'=20
s'=40
10-3

10-2



10-1
m'

100

101

102

Figure 4. (Color online) Critical value xc∗ as a function of m0
for several values of s0 . For x∗ < xc∗ or x∗ > 1 − xc∗ the system
is driven deterministically to fixation for N → ∞. The solid
line is the estimate in Eq. (22), valid for small s, while the
dashed lines correspond to the numerical solution of Eq. (20)
for larger values of s0 . Focussing on the case s0 = 1 and
m0 = 1, metapopulations with N → ∞ and x∗ larger than
xc∗ ' 0.25 (dashed curve) are expected to be in the active
phase, whereas those with x∗ smaller than that rapidly fixate. This expectation is confirmed by numerical simulations
of metapopulations with finite but large N : the crossed and
dotted circles indicate the values of x∗ for which there is numerical evidence for them to correspond to an active and an
absorbing phase, respectively, as discussed in, c.f., Fig. 6 and
further below.

gets
x(0)
∞


 xe∗ for xe∗ ∈ [0, 1],
0 for xe < 0,
=
 1 for x∗e > 1,
∗

(21)

this fixation process is deterministic in nature and the
system always reaches (asymptotically in time) the absorbing state determined by x∞ , differently from the case
with finite N in which fixation is a stochastic process and
both boundaries are attainable.

where xe∗ is given in Eq. (11), while

When computing the stationary value x∞ as a function of the optimal frequency x∗ for fixed s0 and m0 ,
there exists a critical value xc∗ (s0 , m0 ), such that for
x∗ ∈ (xc∗ , 1 − xc∗ ) the infinite population is in the active phase, i.e., x∞ ∈ (0, 1), while it otherwise reaches
one of the two absorbing states x∞ = 0 or 1. Figure 4
displays the dependence of the critical value xc∗ on the
migration rate m0 for several values of selection strength
s0 . In addition, for m0 = 1 and s0 = 1, Fig. 4 compares
the prediction of having fixation for x∗ < xc∗ ' 0.25 and
an active state for x∗ > xc∗ ' 0.25 with the numerical
evidences discussed further below (see also, c.f., Fig. 4),
corresponding to the conditions indicated by the dotted
and crossed circles, respectively. Analytic estimates for
the stationary value x∞ and for the critical value xc∗ can
be easily obtained for small se /m, in which case the condition (20) reduces to M (0) (x̄) = 0. Using Eq. (14a) one

(We remind here that the superscript (0) denotes that the
corresponding quantity has been calculated on the basis of the zeroth-order approximation M (0) (x̄) for M (x̄)
in Eq. (12).) This expression agrees with the heuristic
estimate of Eq. (19) if one sets the numerical threshc(0)
old θ to θ = 1/2. The analytic determination of x∗
in Eq. (22) is reported in Fig. 4 as a solid line and it
coincides, as expected, with the estimate based on the
numerical solution of Eq. (20) for small s0 (uppermost
dashed line). Within the same approximation, the mean
frequency x̄ in the active phase approaches the effective optimal frequency xe∗ exponentially fast in time, i.e.,
x̄(t) − xe∗ ∝ exp[−se xe∗ (1 − xe∗ )t]. In the absorbing phase,
instead, an equally rapid evolution drives the system to
fixation: for example x̄(t) ∝ exp[−se |xe∗ |t] for xe∗ < 0,
with an equivalent expression holding for xe∗ > 1.

c(0)

x∗

=

1
.
2(m0 + 1)

(22)

7

0.5
0.4

x∗ . It can be noticed that, as expected from the arguments presented above, Tfix /N increases upon increasing
N in the active phase (red squares), while it decreases in
the absorbing phase (blue circles), and this supports the
fact that a bona-fide phase transition should be present
in the limit N → ∞. A numerical interpolation reveals
indeed an exponential dependence of Tfix /N (red solid
line) as a function of N in the active phase while a logarithmic one (blue dashed line) of Tfix in the absorbing
phase.

m'=2
m'=0.5

H

0.3
0.2
0.1
0.0
0.0

0.2

0.4

0.6

0.8

1.0
à

x*
à

10.0
Tfix HWNL

Figure 5. (Color online) Global heterozygosity H in the stationary state x̄ = x∞ for N → ∞, as a function of the optimal
frequency x∗ for s0 = 1 and various values of m0 . The value
of H has been obtained by the numerical solution of Eq. (20).

5.0
æ

1.0

According to Fig. 4, a population with a certain m0 and
x∗ may undergo the transition between coexistence and
fixation upon varying s0 , while for x∗ = 1/2 coexistence
is maintained for any positive value of s0 . In this respect,
the present phase transition resembles the one observed
numerically in Ref. [30] for the dynamics of the steppingstone model [31] in two spatial dimensions with mutualistic forces, which has been verified experimentally in
bacterial populations with similar properties [32, 33]. In
addition, in the case of populations embedded in one spatial dimension, this fixation-coexistence phase transition
— emerging in the limit of infinite size — has been argued
[34, 35] to belong to the so-called DP2 universality class
[36], with which it shares only some universal features
(but, generically, not quantities such as the MFT). The
analytical results presented here are in fact in agreement
with the behavior expected for the DP2 phase transition
within the mean-field approximation.
The global heterozygosity H = 2x̄(1 − x̄) provides an
index of the biodiversity of the population, as it vanishes
in the absorbing states X0 and X1 , while it does not in
the active phase. In this respect it can be considered
as an order parameter for the phase transition occurring
at x∗ = xc∗ and x∗ = 1 − xc∗ . Figure 5 reports H as a
function of x∗ , as obtained from the numerical solution
of Eq. (20) for s0 = 1 and m0 = 1.
The picture presented above approximately carries
over to the case in which the number of demes N is finite
but large. In this case one can heuristically assume that,
in the absorbing phase x∗ < xc∗ or x∗ > 1−xc∗ , fixation to
a boundary (x̄ = 0 or 1) is effectively reached when the
distance of x̄ to that boundary is smaller than 1/(ΩN )
(corresponding to having in the metapopulation only one
individual different from the others) and therefore we expect the MFT to scale as Tfix ∝ log(ΩN ) because of the
exponential law with which x̄(t) approaches the boundary as a function of time. Figure 6 reports the MFT as a
function of N for various values of the optimal frequency

à

à à

à

æ

æ

æ

0.5
10

20

à à

à

à

à

x* =0.4 WF
exponential fit
x* =0.2 WF
logarithmic fit

à
æ

æ æ

æ

æ

50
N

æ

æ

100

æ

æ

æ

200

æ

Figure 6. (Color online) Dependence of the MFT Tfix on the
size N of the metapopulation, for Ω = 100, s0 = 1 and m0 = 1.
The MFT has been determined via numerical simulations of
the Wright-Fisher (WF) model. For x∗ = 0.4 (red squares)
Tfix /N shows an approximate exponential increase upon increasing N (red solid line, Tfix /(ΩN ) = exp [0.46 + 0.025N ])
while for x∗ = 0.2 (blue circles) Tfix displays an approximate
logarithmic dependence on N (blue dashed line, Tfix /(ΩN ) =
[−27 + 16 logN ] /N ).

IV.

THE CASE OF SLOW MIGRATION

The effective description of the island model with migration introduced in Ref. [6] and summarized in Sec. I
relies on a perturbative expansion in the parameter se /m.
The predictions concerning the collective behavior of the
metapopulation and, in particular, the mean fixation
time are therefore valid only within the region of the
parameter space corresponding to small se /m. If the migration rate m is large, this region stretches and includes
large values of the selection strength s ' m. Interestingly
enough, this case can also be described by using a fastmode elimination method recently proposed in Ref. [37].
For small migration rate m, the approximation discussed
in Sec. I is expected to be accurate only for a small selection coefficient s. √
In particular, it requires s  1/Ω for
the value m ' 1/( 2Ω) of the migration rate m at which
the parameter se /m reaches its maximum as a function of
m. However, Fig. 2 in Ref. [6] suggests that the approximation discussed in Sec. I provides accurate predictions
beyond the cases mentioned above. In order to rational-

8
1

xi

ize this fact, in this Section we develop an alternative
description of the system for small migration rate m.

Effective voter model

With a small but non-vanishing migration rate m, the
typical time scale Tmigr ∝ 1/m0 associated with the occurrence of migration can exceed the typical time Tfix1
needed by a single deme to reach fixation in the absence
of migration (the determination of Tfix1 is discussed in
some detail in Appendix B 1) . As a result, during the
time interval separating two consecutive migrations, each
deme of the population rapidly evolves towards one of the
“boundary states” xi = 0 or 1, which are no longer absorbing due to m0 6= 0, and it spends most of the time
close to it. However, sometimes it happens that a different allele is received by a deme because of migration and
it rapidly fixates, causing the variable xi to “jump” to the
other boundary state. This is illustrated in Fig. 7 (see
also Fig. 1 in Ref. [6]) which shows the time evolution of
the allele frequencies xi (t) in the various demes of a population with xi (t = 0) either equal to 0.05 or 0.95, for two
values of migration rate (a) m0 = 0.1 and (b) m0 = 0.01
and some values of selection strength s0 . According to
Eq. (B3) of Appendix B one has Tfix1 /Tmigr ' 10−1
and ' 10−2 for panel (a) and (b), respectively and, in
fact, the demes in panel (a) attempt a jump between the
two boundary states more frequently than the demes in
panel (b), which spend most of their time close to these
boundaries. This dynamics can be effectively described
in terms of an effective voter model, in which each deme
of the metapopulation is mapped onto a voter with one of
the two possible opinions which corresponds to the states
xi = 0 or 1. Migration then acts as an effective interaction among the voters, which can influence and change
each other’s state. More precisely, with a rate [38]
0

r = m N/2

0.5
0

(23)

two randomly selected voters interact and, if they are in
different states, their interaction can cause one voter (or
both) to change its state. In particular, as a consequence
of the interaction between voters i and j with xi = 0 and
xj = 1, they change state with probability p = p(1|1/Ω)
and q = p(0|1 − 1/Ω) respectively, where p(x0 |x) is the
probability for a single isolated deme to reach the value
x0 starting from an initial value x before fixation occurs,
and is reported in Eq. (B4) of Appendix B. Accordingly
p quantifies the probability that an isolated deme originally in the absorbing state xi = 0 (all individuals carry
allele B) fixates to the opposite boundary xi = 1 when,
because of migration, it receives an individual carrying
allele A, such that the ensuing, single-deme fast dynamics of xi starts from the initial value 1/Ω. An analogous
interpretation holds for q. The probability that this interaction increases (respectively decreases) by one unit
the number of individuals in state 1 is therefore p(1 − q)

0

20

40

60

80

100

60

80

100

tHW NL
1

xi

A.

HaL

HbL

0.5
0

0

20

40
tHW NL

Figure 7. (Color online) Time evolution of the frequency xi of
allele A in the various demes (represented by different colors)
of a fully-connected metapopulation consisting of N = 12
demes with Ω = 100 individuals each with (a) m0 = 0.1 or
(b) m0 = 0.01 migration rate. These curves are obtained
from the numerical simulation of the Wright-Fisher model
with balancing selection characterized by x∗ = 0.5 and (a)
s0 = 5, (b) s0 = 1. At time t = 0, half of the demes have
xi = 0.05, while the remaining ones xi = 0.95, which results
in the ratio Tfix1 /Tmigr ' 10−1 and ' 10−2 for panel (a) and
(b), respectively.

(respectively q(1 − p)). Accordingly, the rates W+/− at
which the number of voters in state 1 increases (+) or
decreases (−) by one unit are, respectively,
W+ = m0 N p(1 − q)x̄(1 − x̄),
W− = m0 N q(1 − p)x̄(1 − x̄),

(24)

where the factors 2x̄(1 − x̄) account for the probability
that the interacting voters are in different states. When
the number N of demes is large, the master equation
associated with the rates in Eq. (24) can be approximated
by a Langevin equation
s
x̄(1 − x̄)
vot
x̄˙ = σe x̄(1 − x̄) +
η,
(25)
Nevot
where σevot = m0 (p−q) is an effective directional selection
coefficient, Nevot = N/[m0 (p + q − 2pq)] is an effective
population size, and η the normalized Gaussian white
noise such as the one in Eq. (3). For small s0 , m0 and
large Ω, these effective coefficients reduce to
σevot = 2m0 s(x∗ − 1/2),
NΩ
Nevot =
,
2m0

(26)

and they coincide with the coefficients σe , Ne evaluated
in Eq. (18) and (15), respectively. Since the expressions

9

The mean fixation time Tfix (m) of a metapopulation
as a whole (see Appendix B 2 for its determination) depends on the initial state xi of each single deme but the
mean frequency x̄ actually provides an effective description of the state of the system at any time. For simplicity, in the following we focus on an initial state with
x̄ = 1/2: for x∗ ' 1/2 and a large enough migration rate
m, the state with x̄ ' 1/2 actually corresponds to the
metastable state onto which the population quickly revot
laxes from its initial state [6]. The MFT Tfix
of the voter
model, instead, can be evaluated from Eq. (25) via the
standard methods [24] which we used in order to derive
Tfix1 (see Eqs. (B2) and (B3) in Appendix B) from the
analogous Langevin equation (3): in the expression (B3)
for the single-deme MFT in the symmetric case x∗ = 1/2,
the parameters s, Ω have to be replaced by the migrationdependent renormalized parameters σevot , Nevot , while the
functions S(a, b) and F (a, b) in the analogous expression
(B2) for generic x∗ , have to be replaced by the corresponding ones for the directional selection
exp[−2σevot Nevot a] − exp[−2σevot Nevot b]
,
2σevot Nevot
Z b Z 1
exp[2σevot Nevot (y − z)
.
Fvot (a, b) =
dz
dy
y(1 − y)
a
z
(27)
Svot (a, b) =

In the symmetric case x∗ = 1/2 one eventually finds
vot
Tfix
=

N log 2
.
m0 p(1 − p)

(28)

vot
This MFT Tfix
is reported in Fig. 8 (blue dashed line) as
a function of m0 , for Ω = 100, N = 30, and s0 = 1. For
vot
small values of m0 . 0.03, Tfix
is in excellent agreement
with the data from numerical simulations of the WrightFisher microscopic model (symbols, WF), with the first(1)
order estimate Tfix described in Ref. [6] (green solid line),

1000
500

THWNL

in Eqs. (26), (18) and (15) have been obtained on the basis of the diffusion approximation of the dynamics of two
microscopically different models, (i.e., the original microscopic dynamics of the island model and the effective
voter model, respectively) their agreement demonstrates
that both of them correctly capture the dynamics of the
system at a coarser scale. As it was the case in Sec. I,
the system behaves effectively as a well-mixed population
with rescaled effective coefficients. Note, however, that
the deterministic term in Eq. (25) has the same functional
(0)
form (typical of directional selection) as Mdir (x̄), while
(0)
the analogous of Msymm (x̄) — the footprint of balancing selection — is missing completely. This is due to the
fact that the specific form of the selection does not enter into the definition of the effective voter model; on the
one hand, this model provides a viable approximation for
the dynamics of any metapopulation with small enough
migration rate but, on the other, it fails to capture some
qualitative features of balancing selection.

æ
-

100
50

H0L
Tfix
H1L
Tfix
vot
Tfix
vi
Tfix

10
5
æ

1
0.001

æ
æ
-

æ
-

æ
-

æ
æ
-

æ
-

WF

0.01

0.1
m'

1

10

Figure 8. (Color online) Mean fixation time as a function
of the migration rate m0 , for a metapopulation consisting of
N = 30 demes of Ω = 100 individuals each, with s0 = 1 and
x∗ = 1/2. Symbols correspond to the MFT of the WrightFisher (WF) model obtained via numerical simulations. The
red dash-dotted and green solid curves correspond to the an(0)
(1)
alytic prediction Tfix and its improvement Tfix , respectively,
vot
obtained in Ref. [6]. The blue dashed line is the MFT Tfix
[see
Eq. (28)] of the effective voter model described in the main
text. The brown dashed curve, instead, corresponds to the
vi
MFT Tfix
of the voter model with an intermediate state (see
Sec. IV B), which reproduces qualitatively the nonmonotonic
behavior observed in the numerical data. The “lifetime” Tu of
the intermediate state introduced in Sec. IV B is estimated as
described in Appendix C.

vi
and with the MFT Tfix
(brown dashed line) obtained
by introducing an intermediate state in the voter model,
which we discuss further below.

B.

Effective voter model with an intermediate state

In the previous section, the fixation process of the single demes was considered to occur instantaneously and
therefore each deme was supposed to be always in one of
the two boundary states xi = 0 or 1. However, the transition from one boundary state to the other — triggered
by the exchange of individuals between demes — takes
some time and this fact can be accounted for by introducing in the model an intermediate uncertain voter with
no definite opinion. This intermediate state is associated
with a single-deme frequency xi = xu , where xu ' x∗
is an effective parameter, which depends on the optimal
frequency x∗ and on the rates s0 and m0 . This state is
supposed to be metastable, with a “lifetime” Tu proportional to the single-deme fixation time Tfix1 reported in
Eq. (B2); this means that the intermediate state decays
with a rate 1/Tu into one with definite opinion xi = 0
or 1. In Appendix C we discuss a possible heuristic estimate of the effective parameter Tu . Following the line
of argument outlined in the previous subsection, and the
notation introduced there, the state xi = 1 is reached

10
from the intermediate state with probability p̃ = p(1|xu ).
The presence of an intermediate state is known to change
completely the nature of the ordering process of the voter
model [39]. Here such a state is introduced in order to
mimic the effect of balancing selection and, as we discuss further below, it is sufficient to cause the emergence
of an internal attractive point in the dynamics of x̄ and
nonmonotonic dependences of the MFT on the relevant
parameters.
With a rate r = m0 N/2 (the same as for the effective
voter model, described in the previous subsection) an interaction takes place between any pair of voters. After an
interaction with a voter having a different definite opinion or an indefinite one, a voter with a definite opinion
can lose its own, entering the intermediate state. More
specifically, consider a voter i in the state xi = 0: its
interaction with a voter j in a different state (xj = 1)
consists of the exchange of one individual between them,
which introduces in the i-th deme an individual with allele A into a background population of individuals with
allele B (and viceversa in the deme j). The probability that the i-th deme, with a frequency xi = 1/Ω after the exchange, reaches the value xi = xu is given by
P = p(xu |1/Ω), which represents the probability that the
i-th voter, initially in the state xi = 0, reaches the intermediate state after the interaction with the j-th deme.
Similarly, the probability that the voter j, initially in the
state xj = 1, reaches the intermediate one due to its interaction with the voter i is Q = p(xu |1 − 1/Ω). Let us
consider now the case of a voter in the state xi = 0 interacting with a voter j in the intermediate one: due to this
interaction, i reaches the value xi = xu with probability
xu P . Indeed, deme i receives from deme j an individual with allele A with probability xu , in which case the
frequency xi of allele A in deme i reaches the value xu
with probability P . It is important to note that we assumed that such an interaction has no effect on the voter
in the intermediate state because, for large Ω, the state
xu ± 1/Ω has almost the same fixation probability as xu
(i.e., p(0|xu ± 1/Ω) ' p(0|xu )). For later purposes we
emphasize here that generically P increases monotonically upon increasing the selection strength s0 , at least
for 0.25 . x∗ . 0.75. This feature turns out to be crucial for understanding the nonmonotonic behavior of the
MFT as a function of s0 (for fixed m0 ), which is discussed
in detail further below.
In order to describe the dynamics of this voter model,
we denote by N0 , N1 , and Nu the numbers of voters in
states 0, 1, and xu , respectively. Since N0 +N1 +Nu = N ,
the state of the metapopulation is fully determined by N0
and N1 . The rates of the possible transitions previously
described are, in the (N0 , N1 ) space,
W

A
• (N0 , N1 ) −→
(N0 − 1, N1 ),

W

B
• (N0 , N1 ) −→
(N0 , N1 − 1),

W

C
• (N0 , N1 ) −→
(N0 − 1, N1 − 1),

W

D
(N0 + 1, N1 ),
• (N0 , N1 ) −→

W

E
(N0 , N1 + 1),
• (N0 , N1 ) −→

where
WA =
WB =
WC =
WD =
WE =

m0 P N0
[N1 (1 − Q) + Nu xu ],
N
0
m QN1
[N0 (1 − P ) + Nu (1 − xu )],
N
m0 P QN0 N1
,
N
1 − p̃
Nu ,
Tu
p̃
Nu .
Tu

(29)

These rates define the transition matrix WN~ →N~ 0 of the effective voter model with intermediate states, the stochastic evolution of which is described by the master equation
[40]
i
Xh
~ , t) =
~ , t)W ~ ~ 0 ,
~ 0 , t)W ~ 0 ~ − P (N
∂t P (N
P (N
N →N
N →N
~0
N

(30)
~ , t) is the probability to find the system in the
where P (N
~ = (N0 , N1 ) at time t.
state N

1.

Numerical evaluation of the MFT

On the basis of the (forward) master equation (30),
a backward master equation for the fixation probability
~ , t) = P ((N, 0); t|N
~ ; 0) + P ((0, N ); t|N
~ ; 0) immediu(N
ately follows [40]
i
Xh
~ ; t) =
~ 0 , t) − W ~ ~ 0 u(N
~ , t) .
∂t u(N
WN~ →N~ 0 u(N
N →N
~0
N

(31)
This equation can be solved numerically by introducing
a time discretization tn = nδt (where δt is a time interval
chosen to be small enough to ensure that WN~ →N~ 0 δt  1
~,N
~ 0 )) and by using the finite difference
for every pair (N
approximation of the time derivative (Euler’s method).
The state is described by an (N + 1) × (N + 1) array
un (N0 , N1 ) with N0 , N1 = 0, ...N , whose entries are constrained to vanish for N0 + N1 > N . At each time step,
the entries of un evolve according to the discrete version
of Eq. (31).
If the system starts from a state different from the
absorbing boundaries X1 = (N0 = 0, N1 = N ) and
X0 = (N0 = N, N1 = 0), the initial condition for the fixation probability is u0 (N0 , N1 ) = δN0 ,N δN1 ,0 + δN0 ,0 δN1 ,N ,
where δi,j = 1 for i = j, 0 otherwise. Since we are interested in the determination of the MFT for a system
which starts from the state (N0 = N/2, N1 = N/2) [41],
we focus on the quantity Un ≡ u((N/2, N/2), tn ). The

11
probability density pfix (t) for reaching one of the two absorbing states as a function of the time t is therefore given
by the discrete derivative of U for sufficiently small δt,
which reads as
pfix
n =

Un − Un−1
.
tn − tn−1

(32)

vi
In terms of this density, the MFT Tfix
of the voter model
vi
with
intermediate
state
is
given,
for
δt
→ 0, by Tfix
=
P∞
fix
n=1 tn pn , which can be estimated as
vi
Tfix
'

nX
max

tn pfix
n + Ttail ,

(33)

n=1

where the term Ttail is associated with the tail of the
distribution pfix (t) for t > tmax = tnmax and it can be
~ , t) with an expoconveniently estimated by fitting u(N
nential function in the corresponding range. In fact,
Un ' 1 − e−µtn for large tn , from which we obtain


1
e−µtmax ,
(34)
Ttail ' tmax +
µ
where the value of µ is determined from the fit.
Figure 8 compares the various estimates of the MFT,
vot
as obtained from the simple voter model (Tfix
, blue
dotted line), the voter model with intermediate states
(0)
vi
(Tfix
, brown dashed line) or from the lowest-order (Tfix ,
(1)
red dash-dotted line) and first-order (Tfix , green solid
line) expansion in the small se /m parameter obtained in
Ref. [6] (with the approximation described in Section I);
symbols with errorbars, instead, correspond to the numerical results of simulations based on the Wright-Fisher
vot
vi
model. For small m, the estimates Tfix
and Tfix
agree
with the results of simulations and with the first-order
(1)
Tfix in the small-s expansion. It can be noticed that the
introduction of the intermediate state extends to larger
values of m the range within which the approximation
is accurate and, more importantly, it makes the model
able to capture qualitatively the nonmonotonic behavior
of the MFT as a function of m. This demonstrates that
the existence of the intermediate (metastable) state plays
a crucial role in determining the emergence of the nonmonotonicity in the mean fixation time, as it was argued
in Ref. [6].
In Fig. 9 we report the MFT as a function of the selection rate s0 for a fixed small value of the migration rate
vi
m0 = 0.005. It can be noticed that Tfix
from Eq. (33) is
in excellent agreement with the results of the numerical
simulations of the Wright-Fisher model (symbols) also for
quite large values of the selection rate s0 ; the introduction
of the intermediate state in the voter model significantly
improves the accuracy of the approximation compared to
(0)
(1)
vot
both Tfix and Tfix discussed in Ref. [6] and to Tfix
of
the voter model without intermediate state.
Since balancing selection tends to push all the demes
towards the configuration with allele frequency x∗ which

is far from the boundaries (at least for x∗ ' 1/2), it is
heuristically expected to cause a slowing down of fixation
and therefore to increase the MFT; however, Fig. 9 shows
that this is not always the case and in fact the MFT plotted there displays a nonmonotonic behavior as a function
of the selection rate. This nonmonotonicity appears for
small enough m0 and it can be rationalized on the basis of the effective voter model with intermediate states.
vi
In fact, the MFT Tfix
is expected to be proportional to
the mean time Tchange that a voter needs to change its
opinion, which can be estimated as Tchange ' Tint + Tu ,
where Tint is the time scale associated with an interaction able to drive a voter initially in states 0 or 1 into the
intermediate one xu with “lifetime” Tu . Since a voter interacts with a typical rate m0 and, after this interaction,
it reaches the intermediate state xu with probability P ,
−1
the rate Tint
associated with the transitions towards the
−1
intermediate state is given by Tint
' m0 P , so that
Tchange '

1
+ Tu .
m0 P

(35)

For small s0 , the mean time Tchange is predominantly determined by the term 1/(m0 P ), which in fact increases
upon decreasing s0 , while in the opposite limit of large
s0 it is actually determined by Tu , which increases upon
increasing s0 . The interplay between these two terms results in the nonmonotonic dependence of Tchange — and
vi
therefore of Tfix
— on s0 . However, upon further increas0
ing s , it is no longer correct to assume that each deme
spends a large part of its time into a boundary state, and
vot
vi
therefore in this regime one cannot expect Tfix
and Tfix
to
reproduce accurately the corresponding results of numerical simulations of the Wright-Fisher model; nonetheless
vi
Tfix
still captures the qualitative behavior of Tfix of such
a model, as it is clearly seen in Fig. 9 by comparing the
symbols (numerical simulations) with the dashed line.

2.

Effective equation for the mean frequency x̄

When the migration rate m is small (and therefore
the interaction rate r among the voters is small — see
Eq. (23)) only a relatively small fraction of voters is in
the intermediate state, i.e., Nu  N . For large N , the
evolution of x̄ is expected to be slow compared to that of
Nu , because every interaction causes a change ∆Nu = ±1
of Nu , but only a change ∆x̄ . 1/N of x̄ ∼ 1, so that the
relative variation |∆Nu |/Nu of the former is significantly
larger than that of the latter |∆x̄|/x̄  |∆Nu |/Nu . This
time scale separation allows us to consider Nu as a fast
fluctuating variable on the time scale which characterizes
the dynamics of x̄. Conversely, x̄ can be considered as
a slowly varying (or almost constant) parameter on the
time scale of the dynamics of Nu .
For the sake of simplicity, we focus here on the case
of symmetric balancing selection (x∗ = 1/2 and therefore xu = 1/2, p̃ = 1/2, and P = Q), but the discussion

12

THWNL

150

æ
- æ

100

-

50
0

æ
-

æ
-

æ

H0L
Tfix
H1L
Tfix
vot
Tfix
vi
Tfix
WF

approximation of the dynamics of two microscopically
different models (the original island model and the effective voter model, respectively), their agreement show the
emergence of a coherent effective dynamics at a coarser
scale. Note that the deterministic term in Eq. (37) has an
internal attractive point x̄∗ = 1/2, which is the footprint
of balancing selection, and this means that the intermediate state xu is the crucial ingredient in order to capture
the main features of balancing selection; note also that
svi ∝ m02 for small m0 , where indeed the approximation
in Eq. (25) is accurate.

æ
-

æ
-

5

10

15

s'
V.
Figure 9. (Color online) MFT for a metapopulation of N = 30
demes with Ω = 100 individuals, m0 = 0.005, and x∗ = 1/2.
Symbols correspond to the MFT of the Wright-Fisher (WF)
model obtained via numerical simulations. The red dashdotted and green solid lines correspond to the analytical pre(0)
(1)
dictions Tfix and Tfix obtained in Ref. [6]. The blue dashed
vot
line is the MFT Tfix [see Eq. (28)] of the effective voter model
described in the main text. The brown dashed curve, instead,
vi
of the voter model with an intercorresponds to the MFT Tfix
mediate state (see Sec. IV B), which reproduces qualitatively
the nonmonotonic behavior observed in the numerical data.
We have estimated the lifetime Tu of the intermediate state as
described in Appendix C. The scenario presented here carries
over to different choices of m0 . 0.05.

below can be straightforwardly generalized to the nonsymmetric case, with similar conclusions. Considering
the characteristic time scale over which the number Nu
of voters in the intermediate state evolves, an estimate of
the mean hNu i in the large-N and small-m limit can be
found by solving the stationary master equation which
describes the evolution of Nu (see Appendix D 1 for details)
hNu i '

2m0 N P Tu x̄(1 − x̄)
.
1 − m0 P Tu /2

(36)

Note that, as expected, the mean number hNu i of voters
in the intermediate state vanishes as m0 → 0. On the
time scales over which x̄ varies, we can approximate Nu
with its mean hNu i [see Eq. (36)]; this allows us to write
an effective Langevin equation for the evolution of the
mean frequency x̄, which reads as
s
x̄(1 − x̄)
x̄˙ = svi x̄(1 − x̄)(1/2 − x̄) +
η(t),
(37)
Nvi
for large N and Ω and small m (see Appendix D 2 for a detailed derivation), where svi = m02 P 2 Tu /(1 − m0 P Tu /2)
is an effective selection coefficient and Nvi = N/(m0 P )
is an effective population size. These effective parameters coincide with se and Ne (see Eqs. (9) and (15)),
respectively, for large Ω and small s0 . Since se , Ne and
svi , Nvi have been obtained by considering the diffusion

SUMMARY AND CONCLUSIONS

Balancing selection is a major mechanism responsible
for promoting and maintaining biodiversity, as it favors
the coexistence of different alleles in the same population. Under balancing selection, the evolution of a population is characterized by the emergence of a long-lived
metastable state (at least for sufficiently strong selection), which is eventually destabilized by stochasticity
(genetic drift). When the population is subdivided in
many subpopulations of equal size and features, migration interacts with balancing selection and with genetic
drift to determine the ultimate fate of the population.
In Ref. [6] we noticed that the interplay of these evolutionary “forces” leads to the emergence of a separation of
time scales between the global and the local dynamics,
which can be used in order to develop an approximate
description of the dynamics and therefore to determine
the fixation properties of the population as a whole. In
the present work, we have extended this approach in two
directions. First, we have shown that, contrary to the
heuristic expectation, balancing selection actually speeds
up fixation with respect to a neutral model (i.e., a model
without selection) if the allele frequency x∗ promoted by
balancing selection in the coexistence state is close to extinction of one of the alleles. This phenomenon, already
observed in Ref. [29] for well-mixed populations, carries
over to a subdivided population, where, in addition, it is
responsible for the emergence of a phase transition in the
limit of an infinite number N of subpopulations, each of
finite size Ω. We heuristically explain this behavior in
Sec. III by decomposing the effect of asymmetric balancing selection on the evolution of the mean allele frequency x̄ as a sum of a symmetric balancing selection
term Msymm (x̄) and a directional term Mdir (x̄), which
favor coexistence and fixation, respectively. In fact, it
turns out that Mdir (x̄) becomes stronger than Msymm (x̄)
as x∗ approaches one of the two boundaries x∗ = 0 or 1,
corresponding to the extinction of one of the alleles. The
results presented here are compatible with the critical
behavior expected for the DP2 universality class within
the mean-field approximation [36].
It is then possible to characterize in detail the mean
fixation time of finite populations as a function of the
migration rate m and of the other relevant parameters,

13
the selection strength s0 and the optimal frequency x∗ .
While the perturbative results provided in Ref. [6] are
limited either to fast migration or to moderate balancing selection, we have shown here how to extend them
to slow migration and larger values of selection strength.
In fact, a metapopulation with a small migration rate m
can be effectively described at a coarser level by a voter
model with an interaction rate proportional to the migration rate m in the metapopulation. In Sec. IV A we
demonstrate that the MFT of this effective voter model
correctly reproduces the one of the original metapopulation for slow migration. However, the standard voter
model fails to reproduce some qualitative features of the
MFT of the subdivided population, which are recovered
once we introduce into the model an additional intermediate state, corresponding to a voter with no definite
opinion. This intermediate state turns out to be crucial
for reproducing the nonmonotonic behavior of the MFT
as a function of the migration rate, originally observed in
Ref. [6] (see Fig. 8 here); in addition, this model provides
prediction for the MFT in good quantitative agreement
with simulations up to larger values of the migration rate.
We have also shown that an analogous nonmonotonic behavior of the MFT emerges as a function of the selection strength for a sufficiently small and fixed migration
rate, in qualitative and partially quantitative agreement
with numerical simulation of the microscopic model (see
Fig. 9).
In summary, the three-state effective model proposed
here provides a coarser description of the collective behavior of the metapopulation that is useful in order to understand the mechanisms underlying the emerging phenomena observed in the population. Such a description
is expected to carry over to other population models in
which it is possible to identify a separation of time scales
between local and global dynamics. In this respect, the
metapopulation considered here has a very simple internal structure (it is a fully-connected graph), therefore it
would be important to investigate whether the features
discussed above are present on more general networked
(or even spatially-embedded) systems and to understand
their potential interplay with other dynamical phenomena, such as diffusion and coarsening. Since the validity
of the effective voter models presented in this work only
relies on the “slowness” of migration compared to the
other forces driving the dynamics, these approximations
could be adapted to various networks and spatial lattices,
or even to different form of the inter-deme dynamics, as
long as the migration between the demes is slow enough.

Appendix A: Diffusion approximation for the
microscopic models

Given a microscopic model (e.g., the Wright-Fisher
model) with certain transition rates, the evolution equation for the probability P (x, t) of finding the population
in a certain configuration x at time t can be written in

the form of a master equation. The diffusion approximation then consists in approximating this equation with
a Fokker-Planck (or equivalently, a Langevin) equation,
i.e., with a diffusion equation with suitable x-dependent
drift and diffusion coefficients µ and v, respectively:
1
∂t P (x, t) = −∂x [µ(x)P (x, t)] + ∂x2 [v(x)P (x, t)]. (A1)
2
In particular, only the mean value h∆xi ∝ µ(x) and
the variance h(∆x)2 i ∝ v(x) of the change ∆x per unit
time of the variable x resulting from the implementation of these microscopic dynamical transitions are accounted for in the evolution equation. Although this approach is known to fail in some cases, for example for the
susceptiple-infected-susceptible (SIS) model of epidemiology (see, e.g., Ref. [23]), it turns out to be quite accurate for the Wright-Fisher and Moran models discussed
in the present work [6, 22]. Below we illustrate how to
implement the diffusion approximation for the WrightFisher and Moran models; in addition, we also discuss
how one can modify the microscopic rules of these two
stochastic models in order to account for the migration
occurring within the island model, which takes the form
of exchanges of individuals among subpopulations.

1.

Wright-Fisher model

For a well-mixed population of sufficiently large size
Ω, one can readily calculate the mean and the variance
of the change ∆x per unit time of the allele frequency
x from the binomial sampling probability pr (x) given in
Eq. (1), obtaining
µ(x) = h∆xi = s̃x(1 − x) + O(s̃2 ),
x(1 − x) + O(s̃)
v(x) = h(∆x)2 i =
+ O(s̃2 ).
Ω

(A2)

A standard way to account for migration in the WrightFisher model is to modify the probability pr (x) with
which a new generation is sampled. In fact, in the migration process which occurs between two subsequent generations, a mean number mΩ of randomly chosen individuals leaves each deme and it is then randomly redistributed in the other demes. One can effectively think of
all the individuals leaving the N demes as merging in a
sort of “reservoir”, with a mean of mΩN individuals, and
a mean fraction of type-A individuals determined by the
PN
inter-deme mean frequency x̄ = N −1 i=1 xi . Individuals are then randomly chosen from this reservoir in order
to replace those which migrated from each deme. Accordingly, the mean fraction of type-A individuals arriving in
the i-th deme because of this redistribution is mΩx̄, while
the mean fraction of type-A individuals leaving deme i
is mΩxi . As a result of migration, in each deme of the
metapopulation, the original fraction xi has changed into
mx̄ + (1 − m)xi . This simplified description of the migra-

14
tion process neglects fluctuations in the number and in
the composition of migrants during each generation and
in fact, it accounts for migration only by modifying the
probability pr that a new individual carries allele A [4, 6].
In particular, due to migration, the probability pr (xi , x̄)
that a new individual in deme i carries allele A acquires
a dependence on the mean frequency x̄, and it has the
form
pr (xi , x̄) =

(1 + s̃i )[mx̄ + (1 − m)xi ]
,
1 + s̃i [mx̄ + (1 − m)xi ]

(A3)

where s̃i = s̃(x = mx̄ + (1 − m)xi ) is the value of the
function s̃(x) [for balancing selection s̃(x) = s(x∗ − x)]
evaluated at x = mx̄ + (1 − m)xi . At this point, it is easy
to extend the diffusion approximation to a subdivided
population (island model) characterized by the binomial
sampling probability given in Eq. (A3), obtaining the
mean and the variance of the change in the fraction of
A-type individuals of a subpopulation i as
µ(xi ) = h∆xi i = s̃xi (1 − xi ) + m(x̄ − xi ) + O(s̃2 , s̃m),
xi (1 − xi ) + O(m, s̃)
v(xi ) = h(∆xi )2 i =
+ O(s̃2 , m2 , ms̃).
Ω
(A4)
These expressions lead directly to the Langevin equation (4).

2.

Moran model

where we neglect the O((mδt)2 ) probability that more
than one individual per deme migrates within one evolutionary step. Because of the simultaneous action of
death, reproduction, and migration, the probability Qk
to have a change k = ±1, ±2 in the number of alleles A
in the i-th deme between two subsequent generations is
given by
m
Q+2 = W+1 δt W+1
δt,


m
m
Q+1 = W+1 δt 1 − (W+1
+ W−1
)δt

Q−1

m
+ [1 − (W+1 + W−1 )δt] W+1
δt,


m
m
= W−1 δt 1 − (W+1 + W−1 )δt

Q−2

m
+ [1 − (W+1 + W−1 )δt] W−1
δt,
m
= W−1 δt W−1 δt.

If one neglects the contribution of order O(δt2 ), and for
Ω  1, the evolution turns out to be described by the
rates
W+1 = (1 + s̃)xi (1 − xi )/(1 + s̃xi ) + mx̄(1 − xi ),
W−1 = xi (1 − xi )/(1 + s̃xi ) + m(1 − x̄)xi ,

N
X

∂xj [µ(xj )P ({xi }, t)]

j=1

W1 − W−1
s̃
= x(1 − x) + O(s̃2 ),
Ω δt
2
W1 + W−1
x(1 − x) + O(s̃)
v(x) =
=
.
Ω2 δt
Ω

µ(x) =

(A5)

In a metapopulation consisting of N demes, instead,
the allele frequency xi of each deme i can additionally
change, during each step of the evolution, because of
migration. More precisely, the probability that in the
i-th deme the number ΩA of individuals carrying allele
A increases (decreases) by one unit is given by W1m δt
m
(W−1
δt), where δt = O(τg /Ω) is the duration of the evolutionary step and the rates are given by
m
W+1
= mx̄(1 − xi ),
m
W−1 = m(1 − x̄)xi ,

(A6)

(A8)

associated with the Qk ’s discussed above. The probability distribution P ({xi }, t) describing the evolution of
the state of the whole metapopulation satisfies a master
equation that, in the diffusion approximation, gives the
multivariate Fokker-Planck equation
∂t P ({xi }, t) = −

In a well-mixed population, the time evolution of the
probability distribution P (x, t) of the frequency x can be
determined from the corresponding master equation with
the rates given by Eq. (2). For large Ω and in the limit of
continuous time δt → 0 (where δt denotes the duration
of a step in the dynamics of the Moran model), standard
expansions, such as the Kramers-Moyal expansion [40],
lead to Eq. (A1) in which the drift µ and the variance v
are given by

(A7)

N

(A9)

1X 2
+
∂ [v(xj )P ({xi }, t)],
2 j=1 xj
in which the drift µ and the variance v are given by
s̃
m
W1 − W−1
= xi (1 − xi ) + (x̄ − xi ) + O(s̃2 ),
Ω δt
2
2
W1 + W−1
xi (1 − xi ) + O(s̃, m)
v(xi ) =
=
,
Ω2 δt
Ω
(A10)

µ(xi ) =

where we have chosen the temporal step to be δt = 2/Ω.
With this choice of time scales, the resulting genetic drift
v(xi ) for small s̃ and m is the same as the one of the
Wright-Fisher model for a population of the same size,
see Eq. (A4). Note that, in order to recover the same expression also for the drift µ(xi ), it is necessary to rescale
the migration and the selection coefficients as m → 2m
and s̃ → 2s̃, respectively. Equation (A9) is nothing but
the Fokker-Planck equation associated with the set of N
single-deme Langevin equations (4), which, as we argued
above, also describe the dynamics of the Wright-Fisher
model in the presence of migration.

15
2.

Appendix B: Mean fixation time and fixation
probability
1.

Well-mixed population

The time required in order to reach fixation in a wellmixed population of size Ω is a stochastic variable. Its
mean, i.e., the MFT Tfix1 , can be evaluated by standard
methods [24] in the diffusion approximation with drift
µ(x) and variance v(x) defined in Section I . Let us define the quantity G(x) = e
S(a, b) and F (a, b)
Z

b

−

Z

b

F (a, b) =

1

Z
dz

a

Z

z
b

and the functions

dx exp [−s0 x(2x∗ − x)] ,

a

G(z)
dy
Ωv(y)G(y)

1

Z
dz

=

2µ(x0 )
dx0
v(x0 )

a

a

Z

0

b

dx G(x) =

S(a, b) =

Rx

dy
z

exp {s0 [y(2x∗ − y) − z(2x∗ − z)]}
,
y(1 − y)
(B1)

where we conveniently introduced the rescaled selection
coefficient s0 = Ωs. The mean fixation time reads as
Tfix1 (x)
2 [S(x, 1)F (0, x) − S(0, x)F (x, 1)]
=
,
Ω
S(0, 1)

(B2)

where x is the initial condition. In the symmetric case
x∗ = 1/2, Eq. (B2) reduces to
Tfix1 (x)
=
Ω

Z

1

Z
du

(1−2x)2

0

1

dz
0

Metapopulation

As argued in the main text, for a metapopulation,
the mean fixation time Tfix (m) effectively depends on
the mean frequency x̄ and for simplicity, we focus on
a symmetric initial state with x̄ = 1/2 [6]. Tfix (m) differs from the one of a single deme Tfix1 also in the absence of migration, i.e., for m = 0, when each deme
evolves independently of the others. In this case, the
mean time Tfix (m = 0) required by the overall population to reach one of the two absorbing states is given
by the mean time necessary for all demes to reach it,
after which no evolution occurs within the metapopulation. This is given by the maximum of the single-deme
fixation times calculated over N demes, and it turns out
to be Tfix (m = 0) ' Tfix1 log N [6]. For non-zero migration, the approximation proposed in Ref. [6] and summarized in Sec. I makes possible to calculate the mean
fixation time for the metapopulation using formula (B2)
with modified expressions for the drift and the variance.
In particular, by using the drift and the variance reported
in Eqs. (14a) and (14b), one obtains
(0)

Tfix =

Ne
2

Z

1

Z
dy

0

0

1

2

ese Ne y(1−z )/4
,
1 − yz 2

(B5)

i.e., Eq. (5) of Ref. [6]. Analogously, by using the improved approximations for the drift and the variance dis(1)
cussed therein, one obtains the estimate Tfix provided in
the supplemental material of that work.

2

es u(1−z )/4
.
1 − uz 2

(B3)

As expected, Tfix1 (x) vanishes if the initial condition x
corresponds to one of the two absorbing states, x = 0
or 1, while it reaches smoothly its maximum value as the
initial condition moves towards x = 1/2. In this work (as
well as in Ref. [6]) we focused on the initial condition x =
1/2, which, for x∗ ' 1/2 and s large enough, corresponds
to a long lived metastable state promoted by balancing
selection.
Note that starting from an initial value x0 , the frequency x does not typically visit the whole interval of
possible values x ∈ (0, 1) during its evolution because of
the presence of absorbing states which cause fixation: in
fact, the probability p(x1 |x0 ) that the population reaches
the value x1 during the evolution which precedes fixation
can be evaluated via a standard procedure [42] and it
reads
 R x0
dy G(y)


R0

if x1 > x0 ,

 x1 dy G(y)
0
R1
p(x1 |x0 ) =
(B4)

dy G(y)

x0

if x1 < x0 .

 R1
dy G(y)
x1

Appendix C: Estimate of the “lifetime” Tu of the
intermediate state

If the migration rate m0 is sufficiently small, such that
Tfix1  Tmigr ∝ 1/m0 , each deme spends most of its time
into one of the two boundary states, until it receives, due
to migration, one individual different from the majority.
In turn, this individual triggers an attempt to leave the
boundary state which leads to the intermediate one xu
(and possibly to the opposite boundary) with an overall
rate m0 P , as discussed in Sec. IV B (see also Fig. 7). Under our assumption of small migration rate, this transition takes place before any other individual is exchanged
by the deme with the rest of the population, and therefore
it occurs as in an isolated deme, i.e., it takes a mean time
Tfix1 . During this transition, the deme will spend a mean
time Tu close to the intermediate state xu before reaching the final boundary. Figure 10 provides a schematic
representation of the time evolution of the allele frequencies of the various demes (indicated by solid and dashed
lines of different colors) in the regime described above. In
particular, the deme represented by the solid line has received an individual with allele A from another deme and
has fixed it after a time Tfix1 , of which Tu spent close to
the intermediate state promoted by balancing selection.
Other demes of the metapopulation (indicated by dashed

16
lines) evolve similarly, i.e., they move from one boundary
state to the other, with possible unsuccessful attempts.

approximated as
ρ(x̄, s0 , m0 ) =

Pu (x̄)
.
Pnon−fix (x̄)

(C3)

A numerical study of the estimate of ρ according to

1.0

s'=12
s'=8
s'=4
s'=0

0.8

Ρ

0.6
Figure 10. (Color online) Schematic representation of the
evolution of the frequencies xi of various demes (represented
by different colors) in a metapopulation with small migration
−1
rate m0  Tfix1
. Under this assumption, the possible transition between the two boundary states is triggered with a
typical time scale ∼ 1/m0 which is much longer than the one
Tfix1 taken by the transition itself, where Tfix1 is the singledeme MFT. Part of this time, corresponding to the “lifetime”
Tu , is spent by the various demes in the vicinity of the intermediate state.

In order to estimate Tu , we focus on the ratio ρ =
Tu /Tfix1 , i.e., on the fraction of the time spent outside
the boundaries in which the deme is actually close to
xu ; in the quasi-stationary state associated with a certain value of the mean frequency x̄ (and described by the
density Pqs (x|x̄)), ρ can be estimated as the ratio of the
corresponding probabilities, i.e., of the probability to find
a deme close to the intermediate state (that is x ' xu )
to the one of finding it outside the boundaries. In order
to specify properly the condition of xi being “close to”
xu , hereafter we focus for simplicity on the symmetric
case with x∗ = xu = 1/2. In the effective voter model
with the intermediate state, the continuous interval of
states x ∈ [0, 1] is represented by the three coarse states
{0, 1/2, 1}. It is then natural to associate to every value
of x in the interval [0, 1] its closest representative state.
With this definition, the probability Pu to find the deme
close to the intermediate state is
Z 3/4
Pu (x̄) =
dx Pqs (x|x̄).
(C1)
1/4

On the other hand, the probability to find the deme outside the boundary states can be estimated as
Z

1−1/Ω

Pnon−fix (x̄) =

dx Pqs (x|x̄),

(C2)

1/Ω

where a minimal distance 1/Ω of the deme frequency from
a boundary corresponds to having one individual different from the background. The ratio ρ can therefore be

0.4
0.2
0.0
0.0

0.2

0.4

0.6

0.8

1.0

x
Figure 11. (Color online) Estimate of the ratio ρ = Tu /Tfix1
as a function of x̄ for m0 = 0.2, xu = x∗ = 1/2, Ω = 100
and s0 = 0, 4, 8, and 12 from bottom to top, calculated as
explained in the main text on the basis of the quasi-stationary
distribution.

Eq. (C3) is reported in Fig. 11 as a function of x̄ for
m0 = 0.2, xu = x∗ = 1/2, Ω = 100, and for various values
of s0 . In particular, ρ turns out to increase uniformly as
s0 increases, which indicates that Tu grows faster than
Tfix1 as a function of this parameter. It can be noticed
that, while generically ρ depends on x̄, this dependence
becomes increasingly less important as m0 decreases. The
typical x̄-independent estimate of ρ (and therefore of Tu )
can be obtained by considering the mean value
Z 1
ρ(s0 , m0 ) =
dx̄ A(x̄)ρ(x̄, s0 , m0 ),
(C4)
0

which depends on the a-priori distribution A(x̄) of
the frequency x̄. However, as we pointed out above,
ρ(x̄, s0 , m0 ) is approximately independent of x̄ at least
for sufficiently small m0 and therefore the specific form
of A(x̄) is inconsequential, so that we can set A ≡ 1 in
Eq. (C4). Figure 12 shows the dependence of ρ on the
migration rate m0 , as obtained from the numerical integration of Eq. (C4) for various values of the selection
coefficient s0 . We note again that ρ is an increasing function of the selection coefficient s0 , and this can be heuristically understood from the fact that balancing selection
favors the location of the deme frequency xi around the
optimal frequency x∗ . Using Eq. (C4), it is straightforward to obtain a numerical estimate for the lifetime of
the intermediate state as Tu ' ρTfix1 .

17

1.0

can be written as
WNu →Nu +1 = m0 P [2N (1 − P )x̄(1 − x̄) + Nu /2],

0.6

WNu →Nu +2 = m0 N P 2 x̄(1 − x̄),
WNu →Nu −1 = Nu /Tu ,

Ρ

0.8

0.4

m'=0.5
m'=0.2
m'=0.001

0.2
0.0

0

2

4

6
s'

8

10

12

Figure 12. (Color online) Mean fraction ρ of time that a
deme spends close to the intermediate state xu as a function
of the migration rate m0 , for xu = x∗ = 1/2, Ω = 100, and
m0 = 0.001, 0.2, and 0.5 from bottom to top; these values of ρ
have been estimated on the basis of Eq. (C4) with an uniform
a-priori distribution A(x̄) ≡ 1.

where P = p(xu |1/Ω) is the probability that a deme with
initial frequency x = 1/Ω reaches the intermediate state
x = xu before fixation. Since the rates WNu →Nu0 are
linear functions
P∞ of Nu , the evolution of the mean value
hNu i =
Nu =0 Nu Pqs (Nu |x̄) can be written in closed
form:
X
∂t hNu i =
nWn (hNu i).
(D3)
n

The approximate expression reported in Eq. (36) can be
obtained from the stationary condition ∂t hNu i = 0, under
the assumption of large N and small m0 .

2.
Appendix D: Derivation of the effective equation for
x̄ in the voter model with intermediate state

In Sec. IV B we introduced a simplified description of
the metapopulation consisting of N demes in terms of a
voter model with N individuals which can have a definite
(0,1) or no definite opinion. Each deme of the original
island model is represented by a voter, with opinion 0
or 1 depending on whether the deme has almost fixated
at the values x = 0 or 1 of the frequency x of allele A,
while individuals with no definite opinion correspond to
demes with x = xu ' x∗ fluctuating in an intermediate
long-lived state. The dynamics of the island model can
therefore be described at this coarser level by following
the evolution of the numbers Nu , N0 , and N1 = N −Nu −
N0 of individuals with intermediate opinion, or opinions
0 and 1, respectively.

1.

Evolution of Nu

Under the assumption that x̄ = (N1 +xu Nu )/N is constant (or slowly varying), the behavior of Nu is described
by a conditional quasi-stationary distribution Pqs (Nu |x̄);
this distribution is the stationary solution of the master
equation
X
0=
[WNu −n→Nu PNu −n − WNu →Nu +n PNu ]
n=−1,1,2

(D1)
where, for small Nu /N and considering the symmetric
case xu = x∗ = 1/2 for simplicity, the rates in Sec. IV B

(D2)

Evolution of x̄

We study here the evolution of x̄ by considering the
fluctuations of Nu around its mean given in Eq. (36); for
the sake of simplicity we focus on the symmetric case
x∗ = 1/2, but the discussion below carries over to a
generic value of x∗ . Because of the presence of demes
in the intermediate state, the value of x̄ receives a contribution of the form
x̄ =

N1
Nu
+
,
N
2N

(D4)

and therefore
N1 = N x̄ − Nu /2,
N0 = N (1 − x̄) − Nu /2.

(D5)

These relations can now be used in order to express the
rates WA,...,D in Eq. (29) as functions of Nu . For large
Ω these expressions can be further simplified by taking
into account that P , Q ∝ 1/Ω for s0 not too large (we
recall here that P = p(xu |Ω−1 ), Q = p(xu |1 − Ω−1 ) —
see Sec.IV B — with p given in Eq. (B4)), and that Tu ∝
Tfix1 ∝ Ω; one eventually finds


Nu x̄
WA = m0 N P x̄(1 − x̄) −
+ O(1/Ω2 ),
N 2


Nu 1 − x̄
WB = m0 N P x̄(1 − x̄) −
+ O(1/Ω2 ),
N 2
WC = O(1/Ω2 ),
WD = WE = Nu /(2Tu ).
(D6)
As discussed in Sec. IV B 2, the evolution of x̄ can be described by an effective Langevin equation (diffusion ap-

18
proximation, see Appendix A) in the large N limit,
p
(D7)
x̄˙ = Mvi (x̄) + Vvi (x̄) η(t),
where the drift and variance are given by
X
Mvi (x̄) =
Wi ∆x̄i ,
i=A,B,C,D,E

Vvi (x̄) =

X

Wi (∆x̄i )2 ,

and the relevant increments are ∆x̄A = ∆x̄E = 1/(2N )
and ∆x̄B = ∆x̄D = −1/(2N ). Then, by replacing Nu
with its mean hNu i reported in Eq. (36), we eventually
obtain the result anticipated in Eq. (37).

(D8)

i=A,B,C,D,E

[1]
[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]
[10]

[11]

[12]
[13]
[14]
[15]
[16]
[17]
[18]
[19]
[20]
[21]

[22]

[23]
[24]
[25]

T. Maruyama, Genet. Res. 15, 221 (1970).
M. Slatkin, Evolution 35, 477 (1981).
M. C. Whitlock, Genetics 164, 767 (2003).
J. L. Cherry and J. Wakeley, Genetics 163, 421 (2003);
J. L. Cherry, Genetics 163, 1511 (2003).
G. J. Baxter, R. A. Blythe, and A. J. McKane, Phys.
Rev. Lett. 101, 258701 (2008).
P. Lombardo, A. Gambassi, and L. Dall’Asta, Phys. Rev.
Lett. 112, 148101 (2014).
M. Hamilton, Population Genetics (Wiley-Blackwell,
New York, 2009).
A. Robertson, Genetics 47, 1291 (1962); M. Nei and A.
K. Roychoudhury, Genetics 74, 371 (1973).
A. L. Hughes and M. Nei, Nature (London) 335, 167
(1988); N. Takahata, PNAS 87, 2419 (1990).
S. Wright, Genetics 24, 538 (1939); A. D. Richman,
M. K. Uyenoyama, and J. R. Kohn, Science 273, 1212
(1996).
M. Aidoo, D. J. Terlouw, M. S. Kolczak, P. D. McElroy,
F. O. ter Kuile, S. Kariuki, B. L. Nahlen, A. A. Lal, and
V. Udhayakumar, Lancet 359, 1311 (2002).
S. A. Schroeder, D. M. Gaughan, and M. Swift, Nat.
Med. 1, 703 (1995).
D. J. Weatherall, Ann. Trop. Med. Parasitol. 91, 885
(1997).
D. M. Abrams and S. H. Strogatz, Nature (London) 424,
900 (2003).
M. A. Nowak and K. Sigmund, Science 303, 793 (2004).
A. Traulsen, J. C. Claussen, and C. Hauert, Phys. Rev.
Lett. 95, 238701 (2005).
J.B. Xavier, Mol. Syst. Biol. 7, 483 (2011).
R. A. Fisher, The genetical theory of natural selection
(Clarendon Press, Oxford, 1930).
S. Wright, Genetics 16, 97 (1931).
P. A. P. Moran, The Statistical Processes of Evolutionary
Theory (Clarendon Press, Oxford, 1962).
In order to recover for large Ω the same behavior as
the previously described Wright-Fisher model, we have
to choose a duration δt = 2τg /Ω for the Moran time step
and to replace the rates m and s with 2m and 2s respectively (see Ref. [6]).
See for instance: M. Kimura, PNAS 41, 144 (1955); S.
N. Etheier and M. F. Norman, PNAS 74, 5096 (1977);
E. Aalto, J. Theor. Biol. 140, 317 (1989).
C. R. Doering, K. V. Sargsyan, and L. M. Sander, Multiscale Model. Simul. 3, 283 (2008).
M. Kimura and T. Ohta, Genetics 61, 763 (1969).
S. Wright, Genetics 16, 97 (1931).

[26] More precisely, the time scale separation emerges when
N  1 and either N s0 < 1 + 1/m0 , or

N s0 > 1 + 1/m0
,
se /m  1



1
is an effective selecwhere se = s/ 1 + m10 1 + 2m
0
tion coefficient.
[27] M. Khasin, E. Khain, and L. M. Sander, Phys. Rev. Lett.
109, 248102 (2012)
[28] The term in Eq. (17) is often referred to as selection term
in the literature, since it corresponds to the simplest possible form of selection, characterized by having a constant
s̃ in Eqs. (1) and (2).
[29] A. Robertson, Genetics 47, 1291 (1962).
[30] M. O. Lavrentovich and D. R. Nelson, Phys. Rev. Lett.
112, 138102 (2014).
[31] K. Korolev, M. Avlund, O. Hallatschek, and D. R. Nelson,
Rev. Mod. Phys. 82, 1691 (2010).
[32] B. Momeni, K.A. Bailey, M.W. Fields and W. Shou, eLife
2, e00230 (2013).
[33] M. J. I. Müller, B.I. Neugeboren, D. R. Nelson, and A.
W. Murray, PNAS 111, 1037 (2014).
[34] K. Korolev and D. R. Nelson, Phys. Rev. Lett. 107,
088103 (2011).
[35] L. Dall’Asta, F. Caccioli and D. Beghé, Europhys. Lett.
101, 18003 (2013).
[36] H. Hinrichsen, Advances in Physics 49, 815 (2000).
[37] G. W. A. Constable and A. J. McKane, Phys. Rev. E 89,
032141 (2014).
[38] This is the rate associated with the probability P ≥1 (δt)
that at least one individual is exchanged between one
of the possible N (N − 1)/2 pairs of demes of the population in the small time interval δt, thus establishing
an “interaction” between the corresponding voters. In
this time interval, each pair of demes exchanges a mean
number ε ≡ mΩδt/(N − 1) of individuals and, according to the Poisson counting, the probability that there
is no exchange is e−ε ' 1 − ε in that pair and therefore ' (1 − ε)N (N −1)/2 ' 1 − m0 N δt/2 in all possible pairs. This probability equals 1 − P ≥1 (δt) and thus
P ≥1 (δt) ' m0 N δt/2, which results in the rate reported
in Eq. (23).
[39] L. Dall’Asta and C. Castellano, Europhys. Lett. 77,
60005 (2007); L. Dall’Asta and T. Galla, J. Phys. A:
Math. Theor. 41, 435003 (2008).
[40] C. W. Gardiner, Handbook of stochastic methods, Vol. 3
(Springer, Berlin, 1985).
[41] Since the number of uncertain voters is supposed to be
small (Nu  N ), the state x̄ = 1/2 of the voter model can

19
be essentially realized only by having (N0 = N/2, N1 =
N/2) as the initial condition, which is, in fact, the same
initial condition as in Ref. [6] and for x∗ ∼ 1/2 is also a
good approximation of the metastable state into which

the system quickly relaxes.
[42] M. Kimura, Genetics 47, 713 (1962).

