Optimal Wavelets for Electrogastrography
R. J. Cintra∗ I. V. Tchervensky† V. S. Dimitrov‡ M. P. Mintchev§

arXiv:1502.00239v1 [stat.AP] 1 Feb 2015

Abstract
Matching a wavelet to class of signals can be of interest in feature detection and classification based on wavelet representation.
The aim of this work is to provide a quantitative approach to the problem of matching a wavelet to electrogastrographic (EGG)
signals. Visually inspected EGG recordings from sixteen dogs and six volunteers were submitted to wavelet analysis. Approximated
wavelet-based versions of EGG signals were calculated using Pollen parameterization of 6-tap wavelet filters and wavelet compression techniques. Wavelet parameterization values that minimize the approximation error of compressed EGG signals were sought
and considered optimal. The wavelets generated from the optimal parameterization values were remarkably similar to the standard
Daubechies-3 wavelet.
Keywords
Electrogastrography, gastric electrical activity, matching wavelets, optimization techniques.

1

I NTRODUCTION

The present study addresses the problem of finding a wavelet
that best “matches” the waveshape of EGG signals in basal state.
Although there are numerous issues concerning the choice of
wavelet for signal analysis [9], generally, a wavelet can be regarded as best suited to a class of signals if the latter can be
represented by as few wavelet coefficients as possible [10, 11].
Thus, wavelets which resemble the waveshape of the signal under analysis are often selected.
In the framework of the proposed research methodology,
an optimal wavelet is sought that can adequately represent a
wavelet-compressed EGG signal at a given compression ratio.
The optimality is detected by minimizing an error measure between the original signal and its compressed version, subject to
the choice of wavelet. If, for a given wavelet, the error associated with the compressed signal were minimal, then its wavelet
coefficients were considered to best represent the original signal.
Therefore, the selected wavelet would more effectively “match”
the signal under analysis when compared to other wavelets in
consideration [12].
Consequently, the ultimate aim of this study is to quantitatively determine a wavelet suitable for the analysis of basal EGG
recordings in canine and human models.

Cutaneous recordings of gastric electrical activity (GEA) known
as electrogastrography (EGG), can play a major role in the diagnosis of gastric motility disorders [1]. Because of its low-cost
and non-invasiveness, the EGG technique has great appeal as a
clinical tool and has been related to various gastric motility abnormalities [2]. Multiple studies have been conducted in other
to analyze EGG recordings. Although signal processing of EGG
signals has been considered essential for extracting clinically relevant information, various traditional methods have been utilized
with limited success [3].
Recently, advanced signal processing techniques, such as
wavelets, have been employed to analyze electrogastrograms [4–
8]. This approach has been used to (i) propose new wavelets that
can offer a better time-frequency localization of EGG recordings [4, 5]; (ii) perform noise detection in EGG signals [6];
(iii) cancel artifacts related to stimulation [7]; and (iv) characterize global gastric electrical dysrhythmias [8]. An important
aspect of wavelet analysis is related to designing a wavelet that
matches a class of signals. Although wavelet matching can be
of great importance for detection and classification [9], wavelets
that match EGG signals have not been systematically sought.

2

∗ R. J. Cintra was with the Low-Frequency Instrumentation Laboratory,
University of Calgary, Canada. Currently he is with the Signal Processing Group, Departamento de Estatı́stica, Universidade Federal de Pernambuco.
Email: rjdsc@de.ufpe.br
† I. V. Tchervensky was with the Low-Frequency Instrumentation Laboratory,
University of Calgary, Calgary, Alberta, Canada T2N 1N4.
‡ V. S. Dimitrov is with Department of Electrical and Computer Engineering,
University of Calgary, Calgary, Alberta, Canada T2N 1N4.
§
M. P. Mintchev is with Department of Electrical and Computer Engineering, University of Calgary, Calgary, Alberta, Canada T2N 1N4 and the Department of Surgery, University of Alberta, Edmonton, Alberta, Canada T6G 2B7.
Email: mintchev@ucalgary.ca

M ETHODS

2.1
2.1.1

E XPERIMENTAL S ETUP
C ANINE E XPERIMENTS

After a laparotomy and the installment of six pairs of internal
subserosal stainless steel wire electrodes into the antral gastric
wall of sixteen acute dogs (seven female and nine male), the
abdominal wall was closed and five neonatal electrodes (Con-

1

2.1.3

l
f

g
h
kj i

5

b

e

a

1
2
3
4
5
6

3

2

Since both canine and human recordings were of significant duration, the raw EGG data were intermittently contaminated with
a multitude of artifacts, including: (i) motion artifacts; (ii) spontaneous variations in electrode potentials; (iii) respiration; (iv)
signal saturation during recording; (v) electrocardiac activity;
and (vi) loss of signal during recording. Usually these artifacts appeared simultaneously in all recording channels. Some
of these noisy patterns were visually evident (e.g., iv and vi) and
could be easily identified and discarded [3]. This practice has
been recommended before in order to obtain a more reliable signal for subsequent analysis [13].
Therefore, for each subject, a 10-minute time interval of
channel-synchronized data was manually selected. These data
were considered to be free from identifiable noise patterns.

1

d c
(a)

Channel

4

Electrode
Combination
a–b
c–d
e–f
g–h
i–j
k–l
(c)

(b)
Channel
7
8
9
10
11
12
13
14

Electrode
Combination
1–2
2–3
3–4
4–5
1–3
1–4
2–5
1–5
(d)

2.2
2.2.1

S IGNAL A NALYSIS
WAVELET C OMPRESSION

In a discrete-time formalism wavelet transforms are performed
via the Fast Wavelet Transform using Mallat’s pyramid algorithm for decomposition (forward transform) and reconstruction
(inverse transform) [10].
Let x be a discrete signal with N = 2J points (a sampled version of the analog signal x(t)). The discrete wavelet transform
(DWT) of x is computed in a recursive cascade structure consisting of decimators ↓2 and complementing filters h (low-pass) and
g (high-pass), which are uniquely associated with a wavelet [14].
Fig. 2 depicts a diagram of the filter bank structure.
At the end of the algorithm computation, a set of vectors is
obtained {d1 , d2 , . . . , d j , . . . , dJ0 , aJ0 }, where J0 is the number of
decomposition scales of the DWT. This set of approximation and
detail vectors represents the DWT of the original signal. Vectors d j contain the DWT detail coefficients of the signal in each
scale j. As j varies from 1 to J0 , a finer or coarser detail coefficient vector is obtained. On the other hand, the vector aJ0
contains the approximation coefficients of the signal at scale J0 .
It should be noted that this recursive procedure can be iterated J
times at most. Usually, the procedure is iterated J0 < J times.
Depending on the choice of J0 , a different set of coefficients can
be obtained. Observe that the discrete signal x and its DWT have
the same length N. The inverse transform can be performed using a similar recursive approach [10]. Generally, a signal can be
subject to various wavelet decompositions. The analysis depends
on (i) the choice of wavelet (filters h and g); and (ii) the number
of decomposition levels (scales) J0 .
A wavelet-based compression scheme aims to satisfactorily
represent an original discrete signal x with as few DWT coefficients as possible [11, 15, 16]. One simple and effective way of
doing that is to discard the coefficients that, under certain criteria, are considered insignificant. Consequently, the signal reconstruction is based on a reduced set of coefficients [11, 17].
In the present work the classic scheme for non-linear compression was used [11]. This procedure considers an a posteriori
adaptive set, which keeps M wavelet transform coefficients that
have the largest absolute values. A hard thresholding was used

Figure 1: Internal (a) and cutaneous (b) electrode positioning in
canine experiments. Various electrode combinations were used
for the GEA (c) and the EGG (d) recordings. The electrode combination for the EGG recordings in human experiments was similar.
med, Andover Medical, Haverhill, MA, USA) were placed cutaneously along the projection of the gastric axis. These five electrodes were grouped to form eight EGG channels. In addition,
the setup provided six internal GEA channels. However, in the
present study only the EGG channels were processed, while the
internal GEA recordings were used as a visual reference only to
verify that normal electrical activity was present. The electrode
combination set and a diagram of the physical location of the
electrodes are depicted in Figure 1.
Thirty-minute EGG recordings were performed in the basal
state. The captured EGG signals were conditioned by a 0.02–
0.2 Hz low-pass first order Butterworth active filter. After amplification, 12-bit analog-to-digital conversion was performed using
a sampling frequency of 10 Hz and L ABMASTER 20009 16channel analog-to-digital converter (Scientific Solutions, Vancouver, BC, Canada).
2.1.2

S IGNAL P REPROCESSING

H UMAN E XPERIMENTS

Using a similar 8-channel EGG configuration, one-hour recordings from six normal volunteers (two female, four male) in postprandial state (500 Kcal, 52% carbohydrates, 19% proteins, and
29% fat) were obtained. The average body mass index for the
volunteers was 22.2 kg·m−2 (SD 3.0 kg·m−2 ). Signal conditioning, amplification and digitization process similar to the ones utilized in the canine experiments were implemented.
All experiments were approved by the Animal Welfare Committee and the Ethics Committee at the Faculty of Medicine, University of Alberta.

2

Table 1: Number of decomposition scales J0 for some wavelets
J0
Wavelet
Canine Human
Haar
7
8
Daubechies-2
6
7
Daubechies-3
7
7
Coiflet-1
7
7

2.3.2

C OMPRESSION R ATIO

A compression ratio set CR ∈ {3, 5, 7, 10} was selected and a
Figure 2: Wavelet analysis filter bank. The signal is iteratively matching procedure was carried out aiming at optimizing the
decomposed through a filter bank to obtain its discrete wavelet choice of wavelet.
transform.
2.4 O PTIMIZATION OF THE WAVELET C HOICE
to set the remaining coefficients to zero. The number of coeffi- In the context of the present study, a wavelet was sought that
cients M to be retained was determined according to the desired minimized the PRD between the original EGG signal and its recompression ratio CR, which was defined by
construction for a given compression ratio.
However, the abundance of wavelets [10] makes such apN
,
(1)
proach prohibitive. As a result, some constraints on the choice
M
where N and M are the number of wavelet transform coefficients of wavelet were introduced.
It is well known that wavelets can be generated from discrete
of the original and the compressed signals, respectively.
finite impulse response (FIR) filters [14]. In the present work,
the analysis was limited to wavelets generated by FIR filters with
2.2.2 M EASUREMENT OF D ISTORTION
length no greater than six coefficients. In this subset of wavelets
To further the analysis, it is necessary to introduce an error mea- one may find Haar, Daubechies-2, Daubechies-3, and Coiflet-1
sure to compare the original discrete signal x with its reconstruc- wavelets, to name the most popular ones [10].
This restriction is quite convenient, since all FIR filters of
tion x̃. Several measures that allow the evaluation of the effect
of compression schemes have been suggested [18]. However, length up to six that can be utilized to generate wavelets have
one of the most commonly used is the Percent Root-mean-square simple parameterizations of their coefficients [20]. For examDifference (PRD) [15, 16, 18], which was utilized in the present ple, Pollen parameterization of 6-tap wavelet filters [21] has two
study as a measure of distortion in the compression scheme. The independent variables (a, b) ∈ [−π , π ] × [−π , π ]. Varying these
two parameters, a filter that generates a new wavelet can be dePRD of two signals, x and x̃, both of length N, is defined by:
s
fined. Consequently, the Pollen parameterization defines a plane
2
∑N−1
i=0 (xi − x̃i )
× 100%.
(2) on which every point is connected to a wavelet [21].
PRD(x, x̃) =
2
Using the discussed compression scheme, one can compute
x
∑N−1
i
i=0
a PRD value for each wavelet generated from a point with coordinates (a, b) on the parameterization plane. Doing so, a surface
2.3 C HOICE OF PARAMETERS
can be defined by the points (a, b, PRD). Thus, the minima of
2.3.1 N UMBER OF S CALES
this surface correspond to the point coordinates (a, b) that generate
a wavelet with good “matching” properties, since the PRD
In order to select the number of scales J0 ∈ {1, . . ., J} of the
values
at these minima are small.
wavelet transform decomposition, the following criterion was inAs
a result, a set of point coordinates (ai , bi ) could be detertroduced: J0 was chosen so that the coarsest approximation scale
had a pseudo-frequency close to the EGG dominant frequency fc mined on the parameterization plane, which minimizes the PRD
of 4–6 cycles per minute for the canine subjects [19] and 3 cycles for each EGG recording i. Fig. 3 shows typical surfaces generated for basal canine and human EGG signals.
per minute for the humans.
Taking the mean value of the minima, the best wavelet paThe pseudo-frequency fpseudo of a given scale j is
rameterization (a∗ , b∗ ) could be defined. Thus, (a∗ , b∗ ) generfψ
,
j = 1, 2, . . . , J,
(3) ates a wavelet that on average “matches” best the normal EGG
fpseudo =
j · Ts
recordings.
CR =

where Ts is the sampling period (0.1 s) and fψ is the center frequency of a wavelet (the frequency that maximizes the mag- 3 R ESULTS
nitude of the Fourier transform of the wavelet) [14]. Consequently, a scale J0 was selected which minimized the difference The optimal values of the wavelet parameterization were deter( fpseudo − fc ). Table 1 shows the number of decomposition levels mined for the selected compression ratios (Table 2). The values for compression ratio of 3 were associated with the wavelets
for some common wavelets.
3

(a) CR = 3

(b) CR = 10

(c) CR = 3

(d) CR = 10

Figure 3: Plots generated after computing the PRD surface for all possible wavelets on the parameterization plane, using a canine
EGG signal with CR = 3 (a), and CR = 10 (b). A representative human EGG signal was used to build PRD surfaces with CR = 3 (c),
and CR = 10 (d). The minimum value is depicted by a circle (◦). The coordinate points that correspond to Haar (∗), Daubechies-2
(×), Daubechies-3 (•), and Coiflet-1 (△) wavelets are shown. The axes are normalized by π .

4

R EFERENCES

Table 2: Optimal values of the parameterization
CR
3
5
7
10
a

Caninea

Humanb

a∗

b∗

a∗

b∗

0.4329
0.4323
0.4323
0.4293

−0.2608
−0.2638
−0.2700
−0.2736

0.3976
0.4293
0.4276
0.4279

−0.2335
−0.2550
−0.2551
−0.2600

[1] A. J. P. M. Smout, E. J. Van Der Schee, and J. L. Grashuis, “What
is measured in electrogastrography?” Dig. Dis. Sci., vol. 25, no. 3,
pp. 179–186, Mar. 1980.
[2] M. Bortolotti, “Electrogastrography: A seductive promise, only
partially kept,” Amer. J. Gastroenterol., vol. 93, no. 10, pp. 1791–
1794, Oct. 1998.
[3] M. A. M. T. Verhagen, L. J. Van Schelven, M. Samsom, and
A. J. P. M. Smout, “Pitfalls in the analysis of electrogastrographic
recordings,” Gastroenterology, vol. 117, no. 2, pp. 453–460, 1999.

Based on 16 canine subjects.
on 6 volunteers.

b Based

[4] X. Xie and H. H. Sun, “Sinusoidal time-frequency wavelet family and its application in electrogastrographic signal analysis,” in
Proc. 20th Ann. Int. Conf. IEEE Eng. Med. Biol. Soc., vol. 3, Hong
Kong, China, 1998, pp. 1450–1453.
[5] C. Ryu, K. Nam, S. Kim, and D. Kim, “Comparison of digital
filters with wavelet multiresolution filter for electrogastrogram,”
in Proc. Second Joint BMES/EMBS Conf., Houston, USA, Oct.
2000, pp. 137–138.
[6] J. Liang, J. C. Cheung, and J. D. Z. Chen, “Noise detection and
denoising on electrogastrography using nonorthogonal multiresolution wavelet analysis,” in Proc. 18th Ann. Int. Conf. IEEE Eng.
Med. Biol. Soc., vol. 3, Amsterdam, Netherlands, 1996, pp. 1039–
1040.

Figure 4: Comparison between the obtained optimal wavelets for
canine (dotted curve) and human (solid bold curve) EGG signals
and the standard Daubechies-3 wavelet (solid thin curve) using
the optimal parameterization for compression ratio of 3. The
similarity between Daubechies-3 and the optimal EGG wavelets
is clearly evident.

[7] H. Liang and Z. Lin, “Stimulus artifact cancellation in the serosal
recordings of gastric myoelectric activity using wavelet transform,” IEEE Trans. Biomed. Eng., vol. 49, no. 7, pp. 681–688,
Jul. 2002.
[8] W. Qiao, H. H. Sun, W. Y. Chey, and K. Y. Lee, “Continuous
wavelet analysis as an aid in the representation and interpretation
of electrogastrographic signals,” in Proc. 15th Southern Biomed.
Eng. Conf., Dayton, USA, Mar. 1996, pp. 140–141.

depicted in Fig. 4. It is worth mentioning that the proposed
wavelets were very similar to the classic Daubechies-3 wavelet.
[9] J. O. Chapa and R. M. Rao, “Algorithms for designing wavelets to
The correlation coefficient between Daubechies-3 and the optimatch a specified signal,” IEEE Trans. Signal Processing, vol. 48,
mal EGG wavelet was 0.996 and 0.965, for canine and human
no. 12, pp. 3395–3406, Dec. 2000.
signals respectively. Since Daubechies-3 is (i) very similar to
[10] S. G. Mallat, A Wavelet Tour of Signal Processing, 2nd ed. Acathe proposed wavelet; and (ii) easily available in many software
demic Press, 1999.
packages (e.g., M ATLAB (The Mathworks, Inc., Natick, MA,
USA)), it can be chosen instead of the proposed wavelets. Previ- [11] M. Vetterli, “Wavelets, approximation, and compression,” IEEE
Signal Processing Mag., vol. 5, pp. 59–73, Sep. 2001.
ous empirical findings [5] confirm this observation.
4

[12] R. A. Gopinath, J. E. Odegard, and C. S. Burrus, “Optimal wavelet
representation of signals and the wavelet sampling theorem,” IEEE
Trans. Circuits Syst. II, vol. 41, no. 4, pp. 262–277, Apr. 1994.

C ONCLUSION

The problem of finding optimal wavelets to “match” EGG sig- [13] H. P. Parkman, W. L. Hasler, J. L. Barnett, and E. Y. Eaker, “Electrogastrography: a document prepared by the gastric section of the
nals was quantitatively addressed. The proposed wavelets can be
american motility society clinical GI motility testing task force,”
considered as tools to further EGG signal analysis. Moreover,
Neurogastroenterology and Motility, vol. 15, pp. 89–102, 2003.
the suggested methodology opens an avenue towards the classification of electrogastrograms based on the PRD value of their [14] M. Misiti, Y. Misiti, G. Oppenheim, and J.-M. Poggi, Wavelet
Toolbox User’s Guide, 2nd ed. New York: The MathWorks, Inc.,
wavelet compressed version, either applying the obtained opti2000.
mal wavelets or the standard Daubechies-3.
[15] A. Chagas, E. Da Silva, and J. Nadal, “ECG data compression
using wavelets,” in Computers in Cardiology, Cambridge, USA,
Sep. 2000, pp. 423–426.

ACKNOWLEDGMENTS

This work was partially supported by Natural Sciences and Engi- [16] Z. Lu, D. Y. Kim, and W. Pearlman, “ECG signal compression
with a new wavelet method,” in Proc. First Joint BMES/EMBS
neering Research Council of Canada (NSERC) and the National
Conf., Troy, USA, Oct. 1999, p. 955.
Council for Scientific and Technological Development (CNPq,
Brazil).
[17] M. Unser and A. Aldroubi, “A review of wavelets in biomedical
applications,” Proc. IEEE, vol. 84, no. 4, pp. 626–638, Apr. 1996.

5

[20] H. Zhou and A. H. Tewfik, “Parametrization of compactly supported orthonormal wavelets,” IEEE Trans. Signal Processing,
vol. 41, no. 3, pp. 1428–1431, Mar. 1993.

[18] R. Besar, C. Eswaran, S. Sahib, and R. J. Simpson, “On the choice
of the wavelets for ECG data compression,” in Proc. Int. Conf.
Acous., Speech, and Signal Processing, Jun. 2000, pp. 1011–1014.

[21] A. H. Tewfik, D. Sinha, and P. Jorgensen, “On the optimal choice
of a wavelet for signal representation,” IEEE Trans. Inform. Theory, vol. 38, no. 2, pp. 747–765, Mar. 1992.

[19] M. P. Mintchev, A. Girard, and K. L. Bowes, “Nonlinear adaptive
noise compensation in electrogastrograms recorded from healthy
dogs,” IEEE Trans. Biomed. Eng., vol. 47, no. 2, pp. 239–248, Jan.
2000.

6

