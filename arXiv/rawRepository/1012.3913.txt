The Moran model as a dynamical process on networks and its
implications for neutral speciation
Marcus A.M. de Aguiar1,2 and Yaneer Bar-Yam1

arXiv:1012.3913v3 [q-bio.PE] 16 Apr 2011

1

New England Complex Systems Institute,
Cambridge, Massachusetts 02142
2

Instituto de Fı́sica ‘Gleb Wataghin’,

Universidade Estadual de Campinas, Unicamp
13083-859, Campinas, SP, Brasil

Abstract
In genetics the Moran model describes the neutral evolution of a bi-allelic gene in a population of
haploid individuals subjected to mutations. We show in this paper that this model can be mapped
into an influence dynamical process on networks subjected to external influences. The panmictic
case considered by Moran corresponds to fully connected networks and can be completely solved in
terms of hypergeometric functions. Other types of networks correspond to structured populations,
for which approximate solutions are also available. This new approach to the classic Moran model
leads to a relation between regular networks based on spatial grids and the mechanism of isolation
by distance. We discuss the consequences of this connection for topopatric speciation and the
theory of neutral speciation and biodiversity. We show that the effect of mutations in structured
populations, where individuals can mate only with neighbors, is greatly enhanced with respect
to the panmictic case. If mating is further constrained by genetic proximity between individuals,
a balance of opposing tendencies take place: increasing diversity promoted by enhanced effective
mutations versus decreasing diversity promoted by similarity between mates. Stabilization occurs
with speciation via pattern formation. We derive an explicit relation involving the parameters
characterizing the population that indicates when speciation is possible.

1

I.

INTRODUCTION

A basic problem in population genetics is to predict how allele frequencies change in a
population according to the underlying rules governing reproduction. For very large populations the Hardy-Weinberg law applies and no change is expected between consecutive
generations. However, for finite populations this is not necessarily true, and drift can play
an important role.
One of the first models to describe genetic drift in a finite population is the Wright-Fisher
model [1]. It considers a population of N diploid individuals and a single gene with two
alleles A0 and A1 , so that there are a total of 2N genes. Given that the number of alleles
A1 in the population at time t is i, one can easily compute the probability to have j alleles
A1 at time t + 1. Assuming that reproduction occurs by randomly picking 2N genes among
the previous population with replacement and that there is no mutation, this probability is
given by the binomial distribution


2N
 (i/2N)j [1 − (i/2N)]2N −j .
pij = 
j

These transition probabilities form a matrix whose eigenvalues and eigenvectors contain

all the information about the evolution of the system. Although the Wright-Fisher matrix
is rather complicated, several analytical results can be extracted from it and even mutations
can be included [1].
Other models were developed later that allowed for simpler mathematical treatment than
the Wright-Fisher model or its generalization by Cannings [2]. Of particular importance is
the Moran model [1, 3, 4], which considers haploid individuals and overlapping generations.
Here a single hermaphroditic individual reproduces at each time step, with the offspring
replacing the expiring parent. The transition probabilities can also be written down explicitly
and all its eigenvalues and eigenvectors can be calculated for the case of zero mutations [5, 6].
When mutations are included the eigenvalues of the transition matrix and the stationary
probability distribution, corresponding to the first eigenvector, can still be calculated [2, 7].
Here we show that the Moran model can be mapped into a dynamical problem on networks, putting this classic model of population genetics in a broader and modern perspective.
The mapping takes a panmictic population into a fully connected network, where the dynamical problem can be completely solved in terms of generating functions [8, 9]. This provides
2

a simple and elegant representation of the complete set of eigenvectors of the problem. The
connection with the network dynamics gives, to our knowledge, the first complete solution
of the Moran model.
Networks that are not fully connected map into non-random mating in structured populations. In particular, regular networks based on two-dimensional grids relate to spatially
structured populations where mating is allowed only between neighbors. This, in turn, provides the basic mechanism of isolation by distance, as first proposed by Sewall Wright [10].
It has been recently shown [11] that this process can lead to speciation, termed topopatric
speciation, and that the patterns of diversity that arise are fully compatible with the characteristics of biodiversity observed across many types of species in nature [12] . Although no
exact solution exists for the Moran model for structured populations, approximate solutions
do exist for the equivalent network problem [9]. In this paper we explore this connection to
discuss the mechanisms underlying topopatric speciation [11].
The paper is organized as follows: in sections II and III we define the network dynamical
system associated to the Moran process and write down its master equation and transition
probabilities. In section IV we show how the Moran model can be mapped into this network
problem. In section V we summarize the Moran-network properties: the distribution of
allele frequencies at equilibrium, with its mean value and variance, and the limit of large
populations. In section VI we discuss approximations for other network topologies and, in
section VII, their consequences for speciation.

II.

THE NETWORK DYNAMICAL SYSTEM

Networks are mathematical structures composed of nodes and links between the nodes.
The nodes often represent parts of a system and the links the interaction between the parts.
Networks can model a wide range of systems in biology, engineering and the social sciences
[13]. In this work we will associate nodes to a particular gene carried by individuals in a
population and links will be established between individuals that can mate with each other.
In this section networks will be treated as mathematical abstractions with a particular
dynamics of network states; the connection with population genetics will be established in
section IV, although the correspondence with the Moran process is going to become evident
as we proceed.
3

Consider a network with N + N0 + N1 nodes. To each node i we assign an internal state
xi which can take only the values 0 or 1. The nodes are divided into three categories: N
nodes are free to change their internal state (according to the rule stated below); N1 nodes
are frozen in the state xi = 1 and N0 nodes are frozen in xi = 0. The frozen nodes are
assumed to be connected to all free nodes and we consider them as perturbations to the
‘free’ network, composed of the free nodes only. The information about the free network
topology is contained in its adjacency matrix A defined as Aij = 1 if nodes i and j are
connected, Aij = 0 if they are not and Aii = 0. We refer to the free nodes connected to i as
P
their neighbors. The degree ki = j Aij is the number of neighbors of node i.
The dynamics on the free nodes is defined as follows: at each time step a node is selected

at random to be updated. With probability p the state of the node does not change, and
with probability 1 − p it copies the state of one of its connected nodes, selected randomly
among the ki free neighbors or N0 + N1 frozen nodes. If the node to be updated is i, then

 xt
with probability p
i
xt+1
=
i
1−p
 xt
with probability ki +N
j
0 +N1

where j is connected to i.

We call this process an influence dynamics, since the state of a node changes according
to the state of its neighbors. This system can model a number of interesting situations, such
as, for example:

(a) An election with two candidates where part of the voters have a fixed opinion while
the others change their intention according to the opinion of the others.

(b) A sexually reproducing population of N haploid individuals where the internal state
represents two alleles of a gene. Taking p = 1/2, the update of a node mimics the mating
of the focal individual with one of its neighbors. The focal individual is replaced by the
offspring, which can take the allele of each parent with 50% probability. Since the free node
can also copy the state of a frozen node, the values of N0 and N1 can be associated with
mutation rates, as we will show later.

(c) A ferromagnetic material composed of atoms with magnetic moment ±1/2 interacting
4

with an external magnetic field.

Although the influence process is very simple, its analysis can be quite complicated for
networks of arbitrary topology. We will first consider the simpler case of fully connected
networks, where Aij = 1 if i 6= j, Aii = 0 and ki = N − 1. Later we will discuss the
consequences of other topologies and provide approximate results for these cases using the
fully connected case as a basis.

III.

MASTER EQUATION AND TRANSITION PROBABILITIES

For fully connected networks the nodes are indistinguishable and there are only N + 1
global states, that we call σk , k = 0, 1, ..., N. The state σk has k free nodes in the state
1 and N − k free nodes in the state 0. There is no need to count the frozen nodes, since
they never change. If Pt (m) is the probability of finding the network in the state σm at the
time t then, Pt+1 (m) can depend only on Pt (m), Pt (m + 1) and Pt (m − 1), since only one
node is updated per time step. According to the updating rule above, the dynamic of the
probabilities is described by the following equation:

Pt+1 (m) = Pt (m) p +


(1 − p)
[m(m + N1 − 1) + (N − m)(N + N0 − m − 1)] +
N(N + N0 + N1 − 1)

Pt (m − 1)

(1 − p)
(m + N1 − 1)(N − m + 1) +
N(N + N0 + N1 − 1)

Pt (m + 1)

(1 − p)
(m + 1)(N + N0 − m − 1) .
N(N + N0 + N1 − 1)

The term inside the first brackets gives the probability that the state σm does not change
in that time step and is divided into two contributions: the probability p that the node
does not change plus the probability 1 − p that the node does change. In latter case, the
state of the node is xi = 1 with probability m/N, and it may copy a different node in the
same state, xj = 1, with probability (m − 1 + N1 )/(N + N0 + N1 − 1). Also, if xi = 0,
which has probability (N − m)/N, it may copy another node xj = 0 with probability
(N − m − 1 + N0 )/(N + N0 + N1 − 1). The other terms are obtained similarly.
The probabilities Pt (m) define a Pt vector of N + 1 components. In terms of Pt the above
5

master equation can be written in matrix form as


(1 − p)
Pt+1 = UPt ≡ 1 −
A Pt
N(N + N0 + N1 − 1)
where the evolution matrix U, and also the auxiliary matrix A, is tri-diagonal. The non-zero
elements of A are independent of p and are given by
Am,m = 2m(N − m) + N1 (N − m) + N0 m
Am,m+1 = −(m + 1)(N + N0 − m − 1)
Am,m−1 = −(N − m + 1)(N1 + m − 1).
These transition elements are the analogue of the Wright-Fisher transition probabilities
described in the Introduction for the network dynamics.
Let ~ar and ~br be the right and left eigenvectors of U (and therefore of A) and λr the
corresponding eigenvalues, so that U~ar = λr~ar and U T ~br = λr~br . The transition probability
between two states σM and σL after the time t can be written as
P (L, t; M, 0) =

N
X

brM arL λtr .

(1)

r=0

where arL and brM are the components of the right and left r-th eigenvectors. The eigenvalues
of U are given by
λr = 1 −

(1 − p)
µr
N(N + N0 + N1 − 1)

where µr are the eigenvalues of A. Equation (1) indicates that the λr have to be smaller or
equal to 1, otherwise P (L, t; M, 0) would eventually become larger than 1. Moreover, the
eigenvectors corresponding to λ = 1 completely determine the asymptotic behavior of the
system, since the contributions of all the others to P (L, t; M, 0) die out at large times.
The eigenvalues of A are given by [9]
µr = r(r − 1 + N0 + N1 ) ,
which indeed implies that 0 ≤ p ≤ λr ≤ 1. Therefore, if and only if N0 = N1 = 0 there are
two asymptotic (absorbing) states, corresponding to r = 0 and r = 1, given by σ0 (all node
in state 0) and σN (all nodes in state 1). Otherwise there is only one possible asymptotic
state, corresponding to r = 0. All other eigenvectors, related to the transient dynamics,
can be calculated explicitly in terms of hypergeometric generating functions [9]. We do not
write them down here because we are only interested in equilibrium properties.
6

IV.

MAPPING THE MORAN MODEL ONTO NETWORK DYNAMICS

In order to map the evolution of a panmictic population of N hermaphroditic individuals
into the fully connected network problem described above we use the following notation: we
associate xi to the allele of the haploid individual i, which is either 0 for allele A0 or 1 for
allele A1 . At each time step a random individual i is chosen to reproduce, and a random
mate j is selected among the remaining N − 1 individuals. The focal individual i is then
replaced by the offspring.

Reproduction is carried out in two steps. The first step is the sexual reproduction itself:
with probability 1/2 the allele xi is passed to the offspring and with probability 1/2 it takes
the value xj . The second step takes mutation into account: after having taken the allele of
the focal individual or its mate, the allele might change, from 0 to 1 with probability µ− or
from 1 to 0 with probability µ+ . This corresponds to the Moran model with asymmetric
mutations and is very similar to the influence process previously described for networks. In
the framework of networks, the update of the node by keeping its own state or copying the
state of a free neighbor corresponds to sexual reproduction. Copying the state of a frozen
node represents mutation and depends on N0 and N1 .

However, the two processes are not quite the same: in the network dynamics the frozen
nodes play a role only if the node ‘decides’ to copy a neighbor (probability 1 − p). Here
mutation acts even if the allele is passed from the focal individual i to the offspring. The
master equation that includes mutation is therefore slightly different. Using p = 1/2, which
is appropriate for unbiased reproduction, we have:
7



  
1 N −m
1 m
(1 − µ+ ) +
(1 − µ− )+
Pt+1 (m) = Pt (m)
2 N
2
N
1 m
2 N
1
2







 
m−1
N −m
(1 − µ+ ) +
µ− +
N −1
N −1

N −m
N

 

N −m−1
N −1



N −m+1
Pt (m − 1)
N


m+1
Pt (m + 1)
N







(1 − µ− ) +

µ+ 1
+
2
2



m
N −1



µ+



+

m−1
N −1



1
(1 − µ+ ) +
2



N −m
N −1

N −m−1
N −1



1
(1 − µ− ) +
2



m
N −1

µ− 1
+
2
2











µ− +


µ+ .

The first terms can be understood as follows: if the population has m individuals with
allele A1 at time t, it can remain that way in the next time step in several ways. First, if
xi = 1 (probability m/N) the offspring can keep the allele A1 if it gets it from individual i
(probability 1/2) and it does not mutate after reproduction (probability 1 − µ+ ). Similarly,
if xi = 0 (probability (N − m)/N) the offspring can keep the allele A0 if it gets it from
individual i (probability 1/2) and does not mutate after reproduction (probability 1 − µ− ).
The other terms have similar interpretations.
This equation is greatly simplified when written in matrix form. We obtain


(1 + 2µ̄)
A Pt
Pt+1 = UPt ≡ 1 −
2N(N − 1)

(2)

where the non-zero elements of A are given by
Am,m = 2m(N − m) + N1 (N − m) + N0 m
Am,m+1 = −(m + 1)(N − m − 1 + N0 )
Am,m−1 = −(N − m + 1)(m − 1 + N1 )
with
N1 ≡

2µ− (N − 1)
1 − 2µ̄

N0 ≡

2µ+ (N − 1)
1 − 2µ̄
8

(3)

and
µ+ + µ−
.
(4)
2
This is identical to the original matrix A of the network dynamics! Therefore, all the
µ̄ =

known solutions of the network problem can be directly transferred to the genetic problem
via the above relation between the mutation rates µ− and µ+ and the frozen nodes N0 and
N1 . These solutions are described in the next section.

V.

EQUILIBRIUM DISTRIBUTION

The cases N0 = 0 or N1 = 0, corresponding to µ+ = 0 or µ− = 0, are trivial since
all individuals in the population will eventually become identical, with allele A0 or A1
respectively. If N0 and N1 are both zero the individuals will also eventually become identical,
but the probability of each outcome, all A0 or all A1 , depend on the initial distribution of
alleles in the population.
If N0 and N1 are both non-zero, the probability of finding m nodes in state 1, or m
individuals with allele A1 , in equilibrium is given by [1, 7, 9]
ρ(k) = A(N, N0 , N1 )
where

Γ(N1 + k) Γ(N + N0 − k)
.
Γ(N − k + 1) Γ(k + 1)

(5)

Γ(N + 1) Γ(N0 + N1 )
.
(6)
Γ(N + N0 + N1 ) Γ(N1 ) Γ(N0 )
is a normalization constant and Γ(x) is the Gamma function. This result is valid even if N0
A(N, N0 , N1 ) =

and N1 are not integers. In a real network system, when N0 and N1 are integer numbers,
the Gamma functions can be replaced by factorials.
Notice that, because of the mutation rates (or frozen nodes), a particular realization of
the dynamics will never stabilize in any state: the number of individuals with allele A1 will
always change. The probability of finding the population with m alleles A1 , however, is
independent of the time, and given by the expression above. One interesting feature of this
solution is that for N0 = N1 = 1 we obtain ρ(m) = 1/(N + 1) for all values of m, meaning
that all states are equally likely, no matter how large is the population.
P
P
The mean value m0 = m mρ(m) and the variance σ2 = m m2 ρ(m) − m̄2 can also be

calculated explicitly. We obtain

m0 = N
9

N1
.
N0 + N1

(7)

0.018

0.06
N0=N1=0.5

0.05

0.016
0.014
N0=0.9 N1=1.1

N0=1.1 N1=0.9

0.012

N0=N1=10

0.03

N0=N1=1.1

P(m)

P(m)

0.04

N0=N1=5

0.02

N0=N1=0.9

0.008

N0=N1=2

N0=N1=1

0.010

N0=N1=1

0.01

0.006

0.00

0.004
0

20

40

60

80

100

0

20

40

60

80

100

m

m

FIG. 1. Asymptotic probability distribution for a network with N = 100 nodes and several values
of N0 and N1 .

and
NN1 N0 (N1 + N0 + N)
(8)
(N1 + N0 )2 (1 + N1 + N0 )
Higher order correlations can also be calculated explicitly, but the results become progresσ2 =

sively more complicated.
Figures 1 and 2 show a few examples of the distribution ρ(m) for a network with N = 100
and various values of N0 and N1 .
If N is very large ρ(m) peaks around m0 and can be approximated by a Gaussian:


(m − m0 )2
.
ρ(m) = ρ0 exp −
2∆2
with


NN0 N1 (N + N0 + N1 )
∆=
(N0 + N1 )3
and

1/2

1
.
2π∆
In terms of the continuous variables x = m/N, n0 = N0 /N and n1 = N1 /N we can also
ρ0 = √

write

with


(x − x0 )2
.
ρ(x) = ρ0 exp −
2δ 2




n0 n1 (1 + n0 + n1 )
δ=
N(n0 + n1 )3

1/2

√
x0 = m0 /N and ρ0 = 1/ 2πδ, showing that the width of the distribution goes to zero as N
goes to infinity, in agreement with the Hardy-Weinberg law.
10

0.08

0.08

Random

0.06
ρ(m)

ρ(m)

0.06
0.04
0.02

0.00
0

20

40

m

60

80

100

0

0.08

Regular 2-D Lattice

0.06

20

40

m

60

80

100

Small World Network

0.06
ρ(m)

ρ(m)

0.04
0.02

0.00

0.08

Scale Free

0.04
0.02

0.04
0.02
0.00

0.00
0

20

40

m

60

80

100

0

20

40

m

60

80

100

FIG. 2. Equilibrium probability distribution for networks with different topologies. In all cases
N = 100, N0 = N1 = 5, t = 10, 000, and the number of simulations is 50, 000. The theoretical
(red) curve is drawn with effective numbers of frozen nodes N0ef = f N0 and N1ef = f N1 : (a)
random network N0ef = N1ef = 17; (b) scale-free N0ef = N1ef = 82; (c) regular 2-D lattice
N0ef = N1ef = 140; (d) small world network N0ef = N1ef = 140.
VI.

STRUCTURED NETWORKS

For networks that are not fully connected the effect of the frozen nodes is amplified.
To see this we note that the probability that a free node copies a frozen node is Pi =
(N0 + N1 )/(N0 + N1 + ki ) where ki is the degree of the node. For fully connected networks
ki = N − 1 and Pi ≡ PF C . For general networks an average value Pav can be calculated
by replacing ki by the average degree kav . We can then define effective numbers of frozen
nodes, N0ef and N1ef , as being the values of N0 and N1 in PF C for which Pav ≡ PF C . This
leads to
N0ef = f N0 ,

N1ef = f N1

(9)

where f = (N −1)/kav . Corrections involving higher moments can be obtained by integrating
Pi with the degree distribution and expanding around kav .
Figure 2 shows examples of the equilibrium distribution for four different networks with
N = 100 and N0 = N1 = 5. Panel (a) shows the result for a random network constructed
by connecting any pair of nodes with probability 0.3. In this case kav = 29.7 and f = 3.3.
11

The theoretical result was obtained with Eq. (5) with N0ef = N1ef = 17. For a scale-free
network (panel (b)) grown from an initial cluster of 6 nodes adding nodes with 3 connections
each following the preferential attachment rule [13], f = 99/6 and the effective values of N0
and N1 are approximately 82. Panel (c) shows the probability distribution for a 2-D regular
lattice with 10×10 nodes connected to nearest neighbors for which ka v = 3.6 (the nodes near
the border have less than 4 links) f = 99/3.6 ≈ 28. Finally, panel (d) shows a small world
version of the regular lattice [13], where 30 connections were randomly re-allocated, creating
shortcuts between otherwise distant nodes. These results show that the approximate rescaling of frozen nodes (or, equivalently, the mutation rates) is accurate for many network
topologies. Still, extreme cases such as a star network do present different distributions and
this is confirmed by simulations.

VII.

SPECIATION AND BIODIVERSITY

In the last sections we derived two important theoretical results: (a) the connection between the process of influence dynamics on networks and the Moran model; (b) the approximate equilibrium distribution for structured networks, obtained by re-scaling the number of
frozen nodes. We will show now that these two results allow us to infer important properties
about the genetic evolution of spatially extended populations.
It has been recently shown [11, 14] that when mating is constrained by both spatial
and genetic proximity between individuals, neutral evolution by drift alone might lead to
speciation, i.e., to the spontaneous break up of the population into reproductively isolated
clusters. Moreover, the patterns of abundance distributions generated by this mechanism
are compatible with those observed in nature [11].
Neutral theories of biodiversity have become rather sophisticated [15], heating the
neutralist-selectionist debate [16–20]. In what follows we discuss the process of neutral
speciation promoted by spatial and genetic constraints, termed topopatric speciation, in the
light of the theory developed above.
To make the analysis simpler we will restrict ourselves to the case of symmetric mutation
rates, µ− = µ+ ≡ µ or, equivalently, equal number of frozen nodes N0 = N1 ≡ Nz . In this
12

case the connection between mutations and frozen nodes simplifies to
Nz =

2µ(N − 1)
.
1 − 2µ

(10)

Let Pid be the probability that two individuals picked at random in the population have
identical genes at equilibrium. This is given by the sum of the probabilities that their alleles
are are both A1 or both A0 :
Pid =

PN

m=0

=1+

ρ(m)

2
N (N −1)

 m m−1

N N −1

+

N −m N −m−1
N
N −1



[σ 2 + hmi2 − Nhmi] .

Using equations (7), (8) and (10) we obtain
Pid =

1 + Nz
1 + 2µ(N − 2)
=
.
1 + 2Nz
1 + 2µ(2N − 3)

(11)

The probability that the two individuals are different, which is the heterozigosity, is
Pht = 1 − Pid =

2µN
2µ(N − 1)
≈
1 + 2µ(2N − 3)
1 + 4µN

(12)

where the approximation holds for N >> 1.
Consider now a population in equilibrium where the N individuals have B independent
genes [11, 14, 21, 23–25]. The average genetic distance between two individuals is


B
4µN
hd i = BPht ≈
.
2 1 + 4µN

(13)

This expression provides a connection between the size of the population and the average
genetic distance between individuals, which is a measure of diversity within the population.
Two interesting relations can be derived from this equation: first, for given B and µ we can
calculate the size NG that corresponds to a particular average genetic distance hd i = G:
NG =

G
.
2µ(B − 2G)

(14)

Second, for given N and B we calculate the mutation rate µG that corresponds to hd i = G:
µG =

G
.
2N(B − 2G)

Notice that NG µ = NµG .
13

(15)

When mating in panmictic populations is constrained by genetic proximity between individuals, so that pairs whose genetic distance is larger than G are incompatible, the distribution of genetic distances stays very close to hd i = G, as if the genome had an effective
size Bef = 2G. On the other hand, if mating is constrained by spatial proximity, the effective mutation rate tends to increase. Indeed, spatial restriction in mating corresponds to
influence processes on networks constructed over regular lattices, which amplifies the effect
of frozen nodes and, therefore, of mutations.
Consider a square lattice with L2 nodes and periodic boundary conditions where each
node is connected only to neighbors which are within a distance S from itself (measured
in units of lattice spacing). Let N be the number of individuals in the population, so that
the density is ρ = N/L2 . The area where an individual can look for a mate, its ‘mating
neighborhood’, is approximately πS 2 , which is also the average degree kav of the network.
According to our discussion in section VI, this can be modeled as fully connected network
with effective number of frozen nodes
Nef = f Nz =

N −1
N
Nz ≈
Nz .
kav
πS 2

(16)

The corresponding effective mutation rate is obtained from (10)
Nef =

2µef (N − 1)
1 − 2µef

which gives
µef =

f
µf
µ≈
.
1 + 2µ(f − 1)
1 + 2µf

(17)

Note that µef → 1/2 if µf >> 1.
When mating between individuals is constrained by their spatial distance, as measured by
the parameter S, the effective mutation rate (17) can be dramatically enhanced with respect
to a panmictic population. This, in turn, increases the average genetic distance between
individuals, which approaches B/2 for large populations and fixed kav (corresponding to
large values of Nz ). The distribution of genetic distances approaches a broad symmetric
distribution.
On the other hand, if mating is constrained only by the genetic distance between individuals, the distribution of genetic distances shrinks to about G. This corresponds to an
effective shrink in genome size from B to 2G.
14

When both spatial and genetic restrictions are present, as in [11], the population feels a
large effective mutation rate, tending to spread out the genome distribution. On the other
hand, the individuals are compelled by the mating condition to stay genetically close to each
other. The only stable outcome of these opposing forces is the formation of local groups
where hd i ≤ G within the group but hd i > G among groups. This characterizes the groups
as reproductively isolated from each other and, therefore, as separate species.
The average number of individuals in each group is given approximately by NG (14),
which is usually much smaller than N. This also implies that the individuals within groups
are highly connected to each other, so that f ≈ 1 and µef ≈ µ, restoring the equilibrium of
the system.
The conditions for speciation can be estimated as follows. When S is very large, the
effect of the genetic mating restriction is to reduce the effective size of the genome, Bef ,
from B to 2G, so that, from equation (13), hd i is at most G. As S is reduced, the effective
mutation rate increases and new genes are incorporated into the effective genome, increasing
the average genetic distance between individuals. When hd i becomes larger than about 2G
the population can no longer hold itself together and splits. This has been confirmed by
numerical simulations. We write
Bef = 2G + (B − 2G)P

(18)

where P is the probability that a new gene is fixed into the effective genome.
P goes to zero for large values of S and reaches one for small S. It must depend only
on the mutation rate µ, genome length B and the size of the local mating population
NS ≡ πS 2 ρ = πS 2 N/L2 . This local mating population has to be at least 2, otherwise
mating is not possible. More generally, if the minimum number of potential mates for
2
reproduction is P we can define the minimum S by πSmin
ρ = P , or

p
Smin = L P/πN.

(19)

P must be small if the local mating population is large. On the other hand, it must
increase with the mutation rate and size of the genome. We may therefore write the ansatz
( 
2 )
π(S − Smin )2 N/L2 )
P = exp −c
Bµ
15

35
30
25

G

single species

20
15

multiple species

10
5
0

5

6

7

S

8

9

10

11

FIG. 3. Parameter region where speciation is possible according with equation (22). In this example
N = 2000, µ = 0.001, B = 125, L = 128 and P = 8 (Smin = 4.6) and γ = 6.6 (see [11]).

or


 2
π (S − Smin )4 N 2
.
(20)
P = exp −
γ 4 L4 B 2 µ2
where the constant of proportionality c is rewritten by as γ −4 for convenience. The exponential dependence of P on the square of NS /Bµ is suggested by numerical simulations.
The condition for speciation is
Bef
hd i =
2



4µef N
1 + 4µef N



>
∼ 2G.

Since the µN is usually of order 1 in most simulations, and µef >> µ, the factor 4µef N/(1 +
4µef N) can be safely approximated by 1. Using equations (18) and (20) we obtain


π 2 (S − Smin )4 N 2 <
B − 2G
∼ log
γ 4 L4 µ2 B 2
2G
or

r

< Smin + γL
S∼
Inverting this equation we obtain
<
G∼

 
1/4
Bµ
B − 2G
log
≡ Sc (G).
Nπ
2G
B/2

1 + exp



π 2 N 2 (S−Smin )4
γ 4 µ2 B 2 L4

16

 ≡ Gc (S)

(21)

(22)

which gives the minimum value of G for a given S.
Equation (21) gives the maximum size of the mating neighborhood for which speciation
is possible. This analytical result describes the dependence of speciation on 6 model parameters: B, G, µ, P , L and N. It provides a very good quantitative estimate for the parameter
region where speciation is possible, as illustrated in figure 3. The result also incorporates
cutoffs at G = B/4 and at Smin , which are in agreement with numerical simulations [11].
Furthermore it also gives the scaling dependence of Sc on these various parameters. In particular, it predicts speciation at large values of S if B is sufficiently large. This corroborates
the results in [21, 22] but shows that such space-independent speciation occurs only for very
large values of B, since S increases with B 1/2 .
Our analytical result constitute an important addition to the simulations presented in
[11] and contribute to the understanding of the significant role of drift in speciation [11, 14–
17, 21, 26]. Equation (21) identifies the combination of parameters that makes this possible.
For example, low mutation rates, that hinder speciation, can be compensated by a large
number of participating genes or by low population density.

VIII.

CONCLUSIONS

The process of speciation underlies the creation of the tree of life. Fossil records and
molecular analysis allow the construction of detailed phylogenetic trees linking species to
their ancestors, identifying the branching points of speciation. The way speciation occurred
in each case, however, is rarely known with certainty and several mechanisms have been
considered. A recently proposed mechanism of speciation [11] demonstrated that a spatially
extended population can break up spontaneously into species when subjected to mutations
and to spatial and genetic mating restrictions, even in the absence of natural selection.
Numerical simulations have shown that this mechanism, termed topopatry, occurs for a
restricted range of parameters, that include population size N, mutation rate µ and the
parameters S and G controlling the spatial and genetic mating restrictions.
In this paper we have introduced a mapping of genetic dynamics in an evolving population
onto the dynamics of influence on a network, and used this mapping to analytically study the
process of topopatric speciation. This mapping gives, to our knowledge, the first complete
solution of the Moran model, providing an elegant representation of the complete set of
17

eigenvectors of the problem.
We have shown that, while fully connected networks correspond to panmictic populations,
certain structured networks can be mapped into dynamic spatially extended populations.
Moreover, the mapping shows that limiting mating to a fraction of the total population
by network connections increases the effective mutation rate as compared to the panmictic
case, and increases the genetic diversity of the population. By extending the model from one
to multiple independent biallelic genes, we have shown that a genetic restriction on mating
decreases the effective size of the genome, decreasing diversity. These opposing forces are
resolved not by compromise but by pattern formation, breaking up the population into
multiple species. This process, and its dependence on the most relevant characteristics of
the population, is accurately described by equation (22). This equation provides a new
and important tool to understand neutral speciation, revealing explicitly the relationships
among the parameters involved in the process, and the interplay of genetic processes whose
opposition leads to spontaneous speciation.

ACKNOWLEDGMENTS
It is a pleasure to thank Elizabeth M. Baptestini for helpful comments. MAMA acknowledges
financial support from CNPq and FAPESP.

[1] W.J. Ewens Mathematical Population Genetics I. Theoretical Introduction Series: Biomathematics, Vol. 9 (New York: Springer Verlag, 1979).
[2] C. Cannings, Adv. Appl. Prob. 6 260 (1974).
[3] P.A.P. Moran, Proc. Cam. Phil. Soc. 54 60 (1958).
[4] J. Wakeley Coalescent theory (Roberts & Company Publishers, 2009).
[5] G.A. Watterson, The Annals of Mathematical Statistics 32, 716 (1961).
[6] K. Gladstien, Siam J. Appl. Math 34 630 (1978).
[7] J.H. Gillespie. Population Genetics: A concise guide (The Johns Hopkins University Press,
2004).
[8] M.A.M. de Aguiar, I.R. Epstein and Y. Bar-Yam, Phys. Rev. E 72 067102 (2005).

18

[9] D.D. Chinellato,

M.A.M. de Aguiar,

I.R. Epstein,

D. Braha and Y. Bar-Yam,

arXiv:0705.4607v2 [nlin.SI]
[10] S. Wright, Genetics 28 114 (1943).
[11] M.A.M. de Aguiar, M. Baranger, E.M. Baptestini, L. Kaufman, and Y. Bar-Yam, Nature 460
384 (2009).
[12] M.L. Rosenzweig, Species diversity in space and time, (Cambridge University Press, 1995)
[13] R. Albert and A.-L. Barabási, Rev. Mod. Phys. 74, 47 (2002).
[14] G.A. Hoelzer, R. Drewes, J. Meier and R. Doursat, PLoS Comput. Biol. 4 e1000126 (2008).
[15] S.P. Hubbell, The Unified Neutral Theory of Biodiversity and Biogeography, (Princeton University Press, New Jersey, 2001).
[16] M. Kopp, BioEssays 32 564 (2010).
[17] H. Ter Steege, Biotropica 42 631 (2010)
[18] S. Gavrilets, Li Hai and M.D. Vose, Evolution 54 1126 (2000).
[19] R.S. Etienne and B. Haegeman, Theor. Ecol. 4 87 (2011).
[20] J.R. Banavar and A. Maritan, Nature 460 334 (2009).
[21] P.G. Higgs and B.Derrida, J. Phys. A. 24, L985 (1991).
[22] P.G. Higgs and B.Derrida, J. Mol. Evol., 35, 454 (1992).
[23] Yi-Cheng Zhang, Phys. Rev. E 55, R3817 (1997).
[24] M. Hall, K. Christensen, S. A. di Collobiano, and H. J. Jensen, Phys. Rev. E 66, 011904
(2002).
[25] K. Jain, Phys. Rev. E 76, 031922 (2007).
[26] J.A. Coyne and H.A. Orr Speciation, (Sinauer Associates, MA, 2004).

19

