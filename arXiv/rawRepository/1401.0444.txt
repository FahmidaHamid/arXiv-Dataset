Investigating complex networks with inverse models:
Analytical aspects of spatial leakage and connectivity estimation
Vincent Wens∗

arXiv:1401.0444v4 [physics.data-an] 29 Jan 2015

Laboratoire de Cartographie fonctionnelle du Cerveau, UNI – ULB Neurosciences Institute,
Université libre de Bruxelles (ULB), Brussels, Belgium
Network theory and inverse modeling are two standard tools of applied physics, whose combination
is needed when studying the dynamical organization of spatially distributed systems from indirect
measurements. However, the associated connectivity estimation may be affected by spatial leakage,
an artifact of inverse modeling that limits the interpretability of network analysis. This paper
investigates general analytical aspects pertaining to this issue. First, the existence of spatial leakage
is derived from the topological structure of inverse operators. Then, the geometry of spatial leakage
is modeled and used to define a geometric correction scheme, which limits spatial leakage effects in
connectivity estimation. Finally, this new approach for network analysis is compared analytically
to existing methods based on linear regressions, which are shown to yield biased coupling estimates.

I.

INTRODUCTION

Investigating the dynamical organization of spatially
extended systems represents a challenging problem arising in many scientific disciplines from physics to biology
and medicine. Such systems can often be understood as
networks of local units whose connectivity structure generates a range of complex collective behaviors that can
not be achieved by isolated units, and which in turn determines to a large extent the functions of these systems
[1]. However, the network architecture underlying collective dynamics may not be directly observable and must
rather be inferred or modeled from experimental data.
In this context, network theory has emerged as an important phenomenological tool based on representations
of complex systems as graphs [2–4]. Graph construction typically requires two modeling steps: (i) node selection, which consists in choosing the system variables
playing the role of graph nodes, and (ii) connectivity estimation, which amounts to defining a coupling measure
determining the links between these nodes [5]. Both steps
are known to affect the ensuing graph topology [6, 7]
and this can lead to misinterpreting properties such as
“small-world-ness,” a potentially fundamental organizational principle in various complex networks [8]. Node selection is especially difficult for spatially distributed systems, in particular when they are experimentally accessible through indirect or incomplete observations only. In a
situation where a system is probed via sensors, one choice
would be to directly use sensors as nodes. However, this
approach may be of limited value insofar as measurements miss or mix the functionally relevant system units,
leading to graphs that strongly depend on the experimental setup [7]. A more natural method would be to first
reconstruct the relevant units from experimental observations and then use them as nodes in a “second-level”
network analysis. This reconstruction problem may not

∗

vwens@ulb.ac.be

have a unique solution and thus require the introduction of an inverse model [9, 10], which typically combines (i) a least-squares fit of an observational model of
measurements (direct model) to the actual experimental data, with (ii) constraints enforcing extra a priori,
data-independent hypotheses about the system (priors)
and leading to a unique solution. Priors often include assumptions about the spatial distribution of the system,
which yields reconstructions with spatial properties characteristic of the inverse model rather than of the underlying configuration. This spatial deformation effect induces artifacts in the subsequent connectivity estimation
and thus fundamentally limits the integration of inverse
modeling and network analysis. We shall refer to this
effect as spatial leakage [11], which is the main subject of
this paper.
Example and motivation

To illustrate the notion of spatial leakage more concretely, let us consider the simulation shown in Fig. 1.
Figure 1(a) depicts the surface charge density Ψ0 (r, t) of
an electrically charged two-dimensional sheet, as well as
a sensors array (gray dots) sampling the resulting electric
field away from the sheet. It is assumed that the charge
distribution varies slowly enough in time so Coulomb’s
inverse-square law applies. This defines the direct model
of this setup, which allows prediction of electric field measurements E(Ri , t) at sensors location Ri from given surface charge density Ψ0 (r, t) via
Z
1
Ri − r
E(Ri , t) =
d2 r
Ψ0 (r, t) . (1)
4πε0 sheet
kRi − rk3
The simulated configuration consists of two pointlike
charges placed at sheet locations r 0 and r 1 in a slightly
noisy background; the two charges being temporally covarying. This system therefore represents a network of
two charges which features in particular no local clustering [8] (e.g., the charge density fluctuations at r 0 are temporally independent of those in its neighborhood, where
only background noise contributes).

Physical Review E 91, 012823 (2015)

Vincent Wens

(a)

(d)

(b)

(e)

(c)

(f)

coupling estimates between a chosen “seed” location to
elsewhere (thus describing only parts of the full graph).
Figure 1(c) shows the resulting temporal correlation map
from the seed r 0 (which is singled out from Fig. 1(b) as
the global maximum). Its main feature is the significant
spread of correlation from the trivially maximal (unit)
self-correlation at r 0 . This spread is actually due to the
spatial smoothness of the reconstruction and represents
spatial leakage emanating from r 0 . Crucially, the location r 1 is not singled out in Fig. 1(c), indicating that
the true connectivity between r 0 and r 1 is hidden by
the dominating spatial leakage effect. In terms of graph
topology, the reconstructed network exhibits high local
clustering (contrary to the underlying network) because
of this strong, widespread spurious connectivity.
This example motivates the necessity of eliminating, or
at least dampening, spatial leakage effects when combining inverse modeling with network analysis. A new correction method for seed-based connectivity mapping will
be presented in this paper. A natural step for defining
a principled approach is to first understand the mechanisms underlying spatial leakage, which originates (as
hinted above) from topological-like properties of inverse
models such as their spatial continuity. In the first part of
this work, we shall therefore analyze in some details the
topological structure of spatial leakage. We shall then
present a new geometric correction scheme (GCS) derived from an explicit model of spatial leakage geometry.
In the interest of illustration, let us precede our results and apply this method to the example shown in
Fig. 1. Figure 1(d) depicts the model Λ(r, t) of spatial
leakage emanating from r 0 and Fig. 1(e) presents the
corrected reconstruction Φgcs (r, t) in which this spatial
leakage contribution has been eliminated. The resulting
seed-based connectivity map between the reconstructed
charge density Ψ(r 0 , t) at r 0 and the corrected charge
density Φgcs (r, t) is shown in Fig. 1(f) and now exhibits
a correlation maximum at the location r 1 . The corrected
connectivity map is clearly not perfect, since the peak at
r 1 appears much smoother than expected. This is because the method corrects for spatial leakage effects from
r 0 only but does not modify other spatial properties such
as smoothness around r 1 (which explains the remaining
blur), nor does it increase spatial resolution of the original inverse model. Despite this limitation, important
features of the simulated network are recovered (i.e., low
local clustering and coupling between r 0 and r 1 ), which
considerably improves the interpretation of connectivity
estimation compared to Fig. 1(c).

FIG. 1. Spatial leakage. (a) Snapshot of a real scalar field
Ψ0 (r, t) representing two correlated sources at r 0 and r 1 . The
dots indicate sensors. (b) Its reconstruction Ψ(r, t) based on
least-L2 -norm estimation. (c) Temporal correlation map with
node r 0 as seed and directly estimated from the reconstruction. (d) Model Λ(r, t) of spatial leakage from r 0 , and (e)
resulting corrected field Φgcs (r, t) used in the geometric correction scheme. (f) Temporal correlation map with seed r 0
obtained after correction.

We now consider the inverse question of inferring this
network structure on the basis of the sensors data, assuming that they were generated via Eq. (1) but without
further knowledge of the surface charge density. This is
an example of network analysis requiring inverse modeling before connectivity estimation. Indeed, the problem
of estimating the surface charge density from the known
data is undetermined (since sensors only probe the electric field on a finite array of locations Ri ) and an inverse
model thus should be used. Without any further information, a quite natural prior would be to assume that
the surface charge density is a spatially uniform (i.e., no
sheet location a priori singled out), temporally uncorrelated (i.e., no a priori connectivity) Gaussian noise.
An inverse model embodying this prior is the least-L2 norm estimate [10] (see Sec. II) and the resulting surface charge density reconstruction Ψ(r, t) is depicted in
Fig. 1(b). It appears to be a spatially smoothed version of the true configuration; the rough reason being
that the inverse model tries to enforce spatial uniformity while keeping good consistency between the known
data and the electric field predicted by the reconstruction (i.e., Eq. (1) with Ψ(r, t) in place of Ψ0 (r, t)). This
spatial deformation has an important effect on the subsequent connectivity estimation, to which we now turn.
To investigate the network structure, a coupling measure must first be chosen (e.g., temporal correlation) and
then estimated between the reconstructed charge density
fluctuations of each pair of sheet locations, from which
a graph can be derived. A visually clearer approach is
to use seed-based connectivity maps, i.e., spatial maps of

Application to brain network mapping

One field of application (which actually motivated the
present work) where the type of analysis exemplified
above arises is systems neuroscience and more specifically
the mapping of brain networks from noninvasive electrophysiological measurements of cerebral activity. The
brain is a large network of neurons linked together via
axonal connections, whose complex circuitry is to a large
2

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

of spatial leakage by means of analytical methods, rather
than focusing on specific simulations or applications [29].
The idea is that the theory is quite general and could be
applied to various scientific problems where the network
structure of complex systems must be inferred from inverse modeling. We shall therefore consider some aspects
that can be subjected to analytical reasoning.
First, we shall relate the existence of spatial leakage to
topological features of inverse models, focusing for definiteness on least-Lp -norm estimation (Sec. II). Then
we shall characterize the geometry of spatial leakage by
introducing an explicit model and define the associated
geometric correction scheme (Sec. III). Finally, we shall
compare the geometric correction scheme to the orthogonalization approach based on a linear regression [23] and
examine the biases that the latter induces in connectivity
estimation (Sec. IV). Taken together, these three analyses lay the foundations of a systematic theory of spatial
leakage; yet each is somewhat independent of the others.
The key findings shall be summarized and discussed in
the closing section (Sec. V). Five appendices gather the
technical details.

extent responsible for the emergence of various functional
behaviors from basic stimulus detection to higher-level
cognitive processes [12]. One interesting principle of cerebral organization explored by neuroscientists is that the
brain is structured into functional (i.e., dynamically generated) assemblies of neurons effectively bound together
via, e.g., oscillatory collective neural firing patterns [13].
When this effect takes place on a macroscopic scale (compared to neurons scale), these assemblies form so-called
brain functional networks, whose potentially fundamental importance for physiological and pathological cerebral
activity has been suggested by experimental and simulation studies [14]. In this context, a developing theme of
research is the investigation of spatiotemporal properties
of brain functional networks via noninvasive electrophysiological measurements such as electro- and magnetoencephalography [15]. These experimental modalities use
sensors placed on subjects scalp to sample the electric potential or magnetic field generated by local postsynaptic
current flows at a neural population level [15, 16]. Brain
functional networks have been investigated both using
sensors [17, 18] (notwithstanding the limitations of this
approach [7]) and reconstructed brain sources [19–25]. In
the latter case, the analysis methods combined inverse
modeling and connectivity estimation in a way similar
to the simulation example described above (see Fig. 1),
with the flat sheet replaced by the circumvolved cortical
sheet and electric charge density replaced by electric current density. In particular, spatial leakage effects dominate over the physiological interactions and may hide
brain functional networks (albeit somewhat less drastically than in Fig. 1(c)), which is an important methodological limitation in this field.
To overcome this difficulty, researchers introduced various coupling measures insensitive to spatial leakage such
as imaginary coherence [26], phase lag index [27, 28], or
orthogonalized amplitude correlation [22, 23]. However,
these methods are limited, as they are based on some
form of linear regression and thus rely on quite generic
assumptions about spatial leakage effects (e.g., their linearity). This can lead to biased pictures of network connectivity, as can be illustrated by considering once again
the simulation shown in Fig. 1. Linear regression consists
in eliminating the linear correlation structure between
the reconstructed activity Ψ(r, t) and the seed activity
Ψ(r 0 , t) (illustrated in Fig. 1(c)) before connectivity estimation. By construction, the resulting “corrected” correlation map must therefore be flat and cannot recover
the simulated network, contrary to the geometric correction scheme (which derives from a direct description
of spatial leakage effects rather than the elimination of
all linear correlations). In the last part of this paper,
we shall analyze more generally the biases introduced by
approaches based on linear regression compared to the
geometric correction scheme.

II.

TOPOLOGICAL STRUCTURE OF SPATIAL
LEAKAGE
A.

Setup and general considerations

The formal setup in which the various analyses of this
paper will take place is the following.
Direct modeling

Let us consider a continuous dynamical system living in a
domain D of a d-dimensional Euclidean space. Its state is
described by a field Ψ0 (r, t), which will be assumed real
and scalar for notational convenience (r ∈ D and t denoting time). The system is accessible to the experimenter
via m simultaneous measurement time series µ(t), and
the physics of the problem determines the direct model,
which formally consists in the knowledge of a mapping L
(direct operator) predicting the time series µ(t) from a
given system state Ψ0 (r, t) via
µ(t) = (LΨ0 )(t) .

(2)

For simplicity, the contribution of measurement noise will
be neglected altogether.
In this section, we shall limit ourselves to the case
where L is a linear, time-independent functional of the
form
Z
(LΨ0 )(t) =
dd r `(r) Ψ0 (r, t) ,
(3)
D

where `(r) ∈ Rm is the impulse-response function, i.e.,
`(r 0 ) represents the data obtained when the system state
is concentrated at the point r 0 , Ψ0 (r, t) = δ(r − r 0 ).

Aim and organization of the paper

The purpose of this paper is to investigate the problem
3

Physical Review E 91, 012823 (2015)

Vincent Wens

models: the least-Lp -norm estimates. Let us review their
definition [10, 31].
Least-Lp -norm estimation is based on the optimization of two competing constraints: least-squares data fitting and Lp -norm minimization. First, the reconstructed
field Ψ(r, t) should be consistent with the observations
in the sense that experimental data µ(t) and theoretical data (LΨ)(t) predicted by the direct model should be
close. Mathematically, this amounts to minimizing the
model error (or misfit)
Z

2
1
Vmisfit =
dt µ(t) − (LΨ)(t)
(5)
2

We shall also assume `(r) to be a smooth function of
r on D. For example, the direct model (1) used in the
simulation shown in Fig. 1 is of this form; D denoting
the two-dimensional charged sheet and `(r) gathering the
components of the electric field E(Ri , t) (at all sensors
locations Ri ) generated by a single unit charge placed at
r. Since sensors are located outside the sheet, r 6= Ri
and `(r) depends smoothly on the charge position.
Inverse modeling

In an experimental situation, the observer has access to
the data µ(t) but does not know the underlying system state Ψ0 (r, t). The direct operator being typically
noninvertible (e.g., the functional (3) has an infinitedimensional kernel, meaning that infinitely many field
configurations determine the same observations), the system state (and its connectivity structure) must rather
be inferred by inverse modeling [10]. Very generally, an
inverse model consists in the definition of a family of
mappings Wr (inverse operator) determining an estimate
Ψ(r, t) of the system state from experimental time series
µ(t) via
Ψ(r, t) = (Wr µ)(t) .

over the field Ψ(r, t) (where k · k denotes the Euclidean
norm on Rm ). As said above, this minimization has infinitely many solutions since L is not invertible. It can
be regularized by adding a penalty term
Z
λ
Vprior =
dt dd r |Ψ(r, t)|p
(6)
p
enforcing the Lp -norm minimization constraint for configurations Ψ(r, t), with p > 1 and λ > 0 being parameters to be chosen. In terms of priors, this embodies
the assumption that the system state represents a spatially homogeneous white noise distributed according to
a p-generalized Gaussian [10]. The Gaussian case p = 2
corresponds to the priors used to obtain Fig. 1(b).
To summarize, least-Lp -norm estimation amounts to
minimizing the sum V = Vmisfit + Vprior . An important property is that V has a unique minimizer Ψ(r, t)
[10, 31], which defines the reconstruction and also determines, once expressed as a functional of data, the inverse
operator Wr (see Eq. (4)). This minimizer must extremize V and thus satisfies the condition

(4)

An inverse operator thus plays the role of a “regularized
inverse” of L. Many inversion schemes can be defined for
a given direct model, depending on the priors used.
Spatial leakage

By definition, spatial leakage refers to biases in connectivity estimation due to spatial properties intrinsic to inverse operators, which reflect the direct model and priors rather than dynamical information about the system
state [30]. By a “spatial property” of a function Ψ(r) is
meant an attribute such as its vanishing outside a given
domain, or its continuity in variable r. An issue in analyzing spatial leakage effects is that, in general, inverse
operators can not be computed explicitly, as will be exemplified below. Our strategy to bypass this difficulty
will be based on the equivalence between (i) spatial properties of inverse operators and (ii) state-independent spatial properties of reconstructions Ψ(r, t). Indeed, Eq. (4)
shows that attributes in the r dependence of Wr induce
(and are induced by) spatial properties of Ψ(r, t) independent of data µ(t) and thus also independent of the
state Ψ0 (r, t) (since the state only appears through the
direct model (2)). For example, coming back to Fig. 1(b),
the presence of a maximum at r 0 in the reconstruction is
an attribute induced by the state configuration shown in
Fig. 1(a), whereas its spatial smoothness is not. In this
section, we shall investigate spatial leakage by exhibiting
some state-independent spatial properties.
B.

δVmisfit
δVprior
+
= 0.
δΨ(r, t) δΨ(r, t)

(7)

In general (for p 6= 2), the solution of this equation cannot be derived explicitly but rather is estimated numerically using iterative algorithms [10, 31]. However, this
approach does not allow systematic investigation of stateindependent spatial properties. We now introduce an analytical method based on a topological analysis.
C.

Topological analysis

This section presents and discusses the main technical
results that will be used next to derive the existence of
spatial leakage effects in least-Lp -norm estimates.
A basic implication of the spatial uniformity prior is
that the only possible spatial inhomogeneities in reconstructions must be induced by the direct model (2, 3) fitting. In other words, spatial properties are strongly controlled by the impulse-response function `(r). Of course,
the data µ(t) modulate the precise way `(r) affects the
r dependence of the reconstruction Ψ(r, t). This means

Least-Lp -norm estimation

To make these very general considerations more concrete, we specialize here to specific but prototypal inverse
4

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

that, in general, its geometric features are state dependent and reflect to some extent true properties of the
system state (e.g., the presence of a maximum at r 0 in
Fig. 1(b)). Our goal is rather to find state-independent
features. This amounts to focus on spatial properties of
`(r) that are sufficiently generic to hold true whatever
the observed data. An example of such generic properties are those that are topological, i.e., that are preserved
under any homeomorphism (continuous transformation
with continuous inverse). It we assume that reconstructions depend continuously on data µ(t) (i.e., that Wr in
Eq. (4) is a continuous operator, for each r), then varying µ(t) does not affect topological properties, which thus
determine a class of state-independent spatial properties.
The method introduced here represents a generalization
of this observation.

FIG. 2. Topological conjugacy function Fp . The graph of
the homeomorphism Fp is depicted for various values of the
parameter p.

Topological conjugacy

the relationship is topological rather than geometric. In
principle, this suggests the following strategy to systematically explore the geometry of reconstructions: Start
with a spatial property of `(r), deduce what it implies
for the linear combination (8) that appears in the topological conjugacy (9), and use the transformation (9, 10)
to obtain the associated spatial property for Ψ(r, t). An
issue for the practical applicability of this method is that
the corresponding coefficients v(t) cannot be computed
explicitly in general (Appendix A). Furthermore, these
coefficients must depend on data µ(t) and thus the second step makes the resulting spatial property for Ψ(r, t)
state dependent. To bypass these two limitations, we
now focus on features of `(r) that are generic enough
to hold for all linear combinations `(r)T v, i.e., for any
coefficients v. This results into the following principle,
which is proven in Appendix A: A spatial property valid
for linear combinations `(r)T v with arbitrary v ∈ Rm
determines (via Fp ) a state-independent spatial property
for Ψ(r, t).

Instead of directly tackling the analysis of spatial properties for least-Lp -norm estimates Ψ(r, t), our strategy
will rather be to focus on fields of the form
ψ(r, t) = `(r)T v(t) =

m
X

`k (r) vk (t) .

(8)

k=1

These fields are linear superpositions of m basic modes
`k (r) vk (t), whose spatial profile is given by the k th component `k (r) of `(r), whereas its contribution to the full
combination ψ(r, t) is temporally modulated by some
coefficient vk (t). Crucially, the considered coefficients
v(t) = (v1 (t), . . . , vm (t)) ∈ Rm do not depend on position r, but otherwise they will not be known explicitly in
our subsequent analyses. Despite this, investigating the
spatial properties of ψ(r, t) in terms of the given impulseresponse function `(r) is a considerably simpler task.
The justification of this strategy is based on the existence of a topological conjugacy between least-Lp -norm
estimates Ψ(r, t) and linear combinations ψ(r, t): For a
suitable set of coefficients v(t) (depending on the system state), their graph can be obtained from one another via a continuous transformation. Mathematically,
this means that there exists v(t) ∈ Rm and a homeomorphism Fp : R → R such that
Ψ(r, t) = Fp (ψ(r, t)) .

Two state-independent spatial properties

We shall restrict ourselves to the demonstration of examples relevant for spatial leakage:
(i) Least-Lp -norm estimates Ψ(r, t) are spatially continuous wherever `(r) is continuous.
(ii) Ψ(r 0 , t) and Ψ(r 1 , t) are temporally correlated
whenever the vectors `(r 0 ) and `(r 1 ) are collinear.

(9)

Importantly, the required homeomorphism is state independent and actually only depends on the parameter p.
Explicitly, we have (see Fig. 2)
1/(p−1)

Fp (x) = sign[x] |x|

,

These statements are direct applications of the above
principle. For (i), we note that continuity is a spatial
property valid for any linear combination `(r)T v (since
each of the m components of `(r) are assumed continuous) and thus induces a state-independent property for
Ψ(r, t) by the above principle. This induced property is
simply the continuity of Ψ(r, t) in r, as it follows from the
continuity of ψ(r, t) = `(r)T v(t) in r. (Indeed, Ψ(r, t) is
the composition (Fp ◦ ψ)(r, t) of ψ(r, t) with the continuous map Fp (x)). For (ii), we start from the collinearity

(10)

where sign[x] denotes the sign of x.
The above statement is the core technical result of this
section and derives from the variational equation (7), as
proven in Appendix A. It implies that properties of the
reconstruction Ψ(r, t) can indeed be studied via a linear
combination ψ(r, t); the price to pay being to work modulo the homeomorphism (10), which is the reason why
5

Physical Review E 91, 012823 (2015)

Vincent Wens

condition `(r 1 ) = k `(r 0 ) for some k ∈ R. This implies
`(r 1 )T v = k `(r 0 )T v for arbitrary v, and thus produces
a state-independent property for Ψ(r, t), which is determined by plugging

a true long-distance interaction but may also reflect a
spatial leakage effect. We now exhibit a spatial property
generating such long-range spatial leakage on the basis
of the correlation structure of `(r) characterized by the
normalized scalar products

ψ(r 1 , t) = `(r 1 )T v(t) = k `(r 0 )T v(t) = k ψ(r 0 , t)

C(r 1 , r 0 ) =

into the relation (9) and using the identity
Fp (kx) = Fp (k) Fp (x) .

(11)

The essence of this effect can be captured by considering the idealized possibility of perfect correlation
|C(r 1 , r 0 )| = 1 for well-separated locations r 1 and r 0 .
This condition implies the collinearity of the impulseresponse vectors `(r 0 ) and `(r 1 ), i.e., `(r 1 ) = k `(r 0 ) for
some multiplicative factor k. Example (ii) of Sec. II C
showed that this ensures perfect temporal covariation of
Ψ(r 0 , t) and Ψ(r 1 , t) (whatever the model parameters
and data), which represents the sought long-range spatial
leakage. This effect can be understood more intuitively
by considering the case k = 1. Physically, the condition
`(r 0 ) = `(r 1 ) means that the two pointlike configurations
Ψ0 (r, t) = δ(r − r 0 ) and Ψ0 (r, t) = δ(r − r 1 ) generate
exactly the same measurement patterns via direct modeling (2, 3). In this scenario, the direct model cannot
discriminate the locations r 0 and r 1 (as measurements
are the same) and neither does the prior (based on spatial uniformity). In other words, the inverse model is
symmetric under exchanges r 0 ←→ r 1 and must therefore lead to identical reconstructions, Ψ(r 1 , t) = Ψ(r 0 , t),
and spuriously maximal connectivity between r 0 and r 1 .
It should be emphasized that the above idealization
scarcely happens in practice and long-range spatial leakage effects are typically milder than the local ones (because of lower correlation values |C(r 1 , r 0 )| at long distances). Still, long-range spatial leakage has been observed [22] and the above analysis presents a basic mechanism for its existence. In graph-theoretic terms, this
effect can lead to an underestimation of the path length,
which—combined with the overestimation of clustering
by local spatial leakage—might imply a spuriously smallworld property of the network [8].

This yields Ψ(r 1 , t) = Fp (k) Ψ(r 0 , t), hence proving their
temporal correlation.
D.

`(r 1 )T `(r 0 ) .
k`(r 1 )k k`(r 0 )k

Existence of spatial leakage effects

The above state-independent spatial properties establish the qualitative existence of spatial leakage effects in
least-Lp -norm estimation, as we now discuss.
Continuity

We motivated in Sec. II A the assumption that `(r) is a
continuous function (see the discussion below Eq. (3)).
Example (i) of Sec. II C established the fundamental
analytical fact that continuity always holds for leastLp -norm estimates. As was hinted at in the Introduction (when comparing Figs. 1(b) and 1(c)), this stateindependent property explains the existence of the strong
spatial leakage effect exemplified in Fig. 1(c). Indeed,
continuity at r 0 forces the reconstructed time series
Ψ(r 0 , t) and Ψ(r, t) at two sufficiently close locations r 0
and r to be almost identical, Ψ(r, t) ≈ Ψ(r 0 , t). Consequently, connectivity estimation between Ψ(r 0 , t) and
Ψ(r, t) is bound to yield (almost) maximal coupling in
a neighborhood of r 0 . This holds whatever the coupling
measure, model parameters p, λ, and, crucially, whatever
the data and system state. Furthermore, continuity in r
implies that this spuriously high connectivity smoothly
decreases as r gets away from r 0 , which explains the
spreading effect observed in Fig. 1(c). In graph-theoretic
terms, this induces falsely high clustering at node r 0 .
This spatial leakage effect emanating from r 0 can be
characterized as local, since it happens in a connected region surrounding the seed r 0 . However, it is noteworthy
that its geometric aspects such as the shape and size of
this region (which typically depend on location r 0 and
parameters p, λ) have not been estimated. This is a limitation of the topological analysis, which works up to the
homeomorphism (10). In Sec. III, we shall remedy to this
situation and derive an explicit model for the geometry
of this spatial leakage effect.

E.

Beyond least-Lp -norm estimation

The topological analysis introduced in this section was
specifically derived in the context of least-Lp -norm estimation with p > 1, but it is noteworthy that these ideas
may generalize to other classes of inverse models (presumably with functions F different from Fp ). To back
up this claim, we note for example that a conjugacy also
holds (with the trivial homeomorphism F (x) = x) for any
inverse model based on unitary invariant constraints, as
described in some detail in Appendix B. More generally,
it would be interesting in future research to extend this
analysis to other existing inverse models such as, e.g.,
least-mixed-norm estimates [32, 33], spatial filtering [34]
or Bayesian inference [35].

Spatial correlations

In seed-based connectivity maps, the above spread of spurious coupling from the seed r 0 decreases as r moves away
from r 0 , but the coupling estimate may rise again once
far enough. This rebound in connectivity may indicate
6

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

III.

B.

GEOMETRY OF SPATIAL LEAKAGE
A.

Aim and preliminary definition

The conceptual importance of the definition (13) lies
in the fact that the resolving operator Rr,r0 encapsulates
the geometry of spatial leakage effects from the seed r 0 .
Indeed, Rr,r0 describes the way state activity localized at
r 0 contributes to the reconstruction at r. This transfer
being purely structural (the resolving operator is state
independent), it induces spurious temporal codependencies between reconstructed time series at r 0 and r (spatial leakage effect). Equation (13) is therefore a natural
starting point to geometrically characterize spatial leakage. The main modeling step is to suitably choose the (a
priori unknown) function f (t) so (Rr,r0 f )(t) reproduces
spatial leakage from r 0 to r.

We argued in the previous section that the qualitative existence of spatial leakage can be associated with
some state-independent spatial properties of reconstructions but we did not characterize quantitative aspects,
which are more difficult to assess explicitly as they depend on the details of the inverse model. In practice,
however, geometric information about spatial leakage effects (such as their extent) is at least as relevant as the
knowledge of their qualitative existence.
We now turn to such a geometric characterization using an analytical model of spatial leakage effects. Specifically, we shall focus on those effects emanating from a
given seed r 0 and describe how true state dynamics there
affects the reconstructed activity elsewhere (hence leading to spurious coupling). An important by-product will
be to introduce a new spatial leakage correction method
for connectivity estimation. The building block of our
analysis rests on the so-called resolving operator, whose
definition we now describe in the very general setup of
Sec. II A (Eqs. (2) and (4)).

Pointlike state

To derive an estimate for f (t), let us first come back
to the case of pointlike state configurations (12). We
consider the location r 0 known but want to infer f (t)
on the basis of the reconstruction, which can be written Ψ(r, t) = (Rr,r0 f )(t) by definition of the resolving operator (13). Now, it happens that Rr,r0 is often invertible when r = r 0 and we shall assume so.
Then f (t) can be obtained by inverting the relation
Ψ(r 0 , t) = (Rr0 ,r0 f )(t), and this leads to the exact expression

f (t) = R−1
(14)
r 0 ,r 0 Ψ(r 0 , ·) (t) .

Resolving operator

A basic method to characterize the geometry of an inverse
operator Wr (and its spatial leakage) consists in considering the reconstruction of state configurations concentrated at some location r 0 ,
Ψ0 (r, t) = δ(r − r 0 ) f (t) ,

The reason why state activity at r 0 could be inferred is
that the reconstructed time series there was not mixed
up with other dynamical processes taking place elsewhere
and thus only appeared as a version of f (t) filtered by
direct and inverse modeling. This function was obtained
by “defiltering” Ψ(r 0 , t) (using R−1
r 0 ,r 0 ).

(12)

the function f (t) describing their temporal activity. Inverse modeling generally yields a deformed representation of this pointlike pattern, reflecting the structure
of the inverse operator only. (An example is given by
Fig. 1(d), which is the least-L2 -norm estimate of a configuration with a single peak at r 0 , i.e., Fig. 1(a) without
the second peak at r 1 .) Exploring reconstructions of (12)
with varying seed r 0 and activity f (t) thus allows quantitative assessment of the inverse model geometry. Most
applications of this idea disregard dynamics and focus on
f (t) = 1 (which defines the point-spread function of r 0
[36]) but we shall consider the general case.
Mathematically, the reconstruction Ψ(r, t) of the state
(12) is obtained by first computing the data predicted by
direct modeling (2) and then applying the inverse operator (4), which leads to Ψ(r, t) = (Wr LΨ0 )(t). As said
above, it is useful to think of it as being parameterized by
r 0 and f (t), letting them be arbitrary. In particular, as a
functional of f (t), it defines the Backus-Gilbert resolving
operator Rr,r0 [37]. Explicitly,
(Rr,r0 f )(t) = (Wr LΨ0 )(t) ,

Model of spatial leakage

The model

The above reasoning leading to Eq. (14) has no reason to
hold in general since no assumption of the form (12) can
usually be made about the unknown state configuration
Ψ0 (r, t). Nevertheless, we propose to use Eq. (14) as
a rough model for the required function f (t). We shall
therefore describe the geometric distribution of spatial
leakage effects from r 0 in terms of the field configuration

Λ(r, t) = Rr,r0 R−1
(15)
r 0 ,r 0 Ψ(r 0 , ·) (t) ,
which is nothing but (Rr,r0 f )(t) together with Eq. (14).
More precisely, the central claim of this section is that
the reconstruction can be approximately decomposed as
Ψ(r, t) ≈ Φ(r, t) + Λ(r, t) ,

(13)

(16)

where Φ(r, t) represents the reconstruction free from the
spatial leakage effects emanating from r 0 .
The justification of this model (beyond the case of
pointlike states, for which Φ(r, t) = 0) rests on two approximations:

where Ψ0 (r, t) is given by Eq. (12). This operator has
been used in previous publications to assess spatial leakage numerically [38] but will serve here as the basic tool
to build an analytical model.
7

Physical Review E 91, 012823 (2015)

Vincent Wens

(i) Spatial leakage effects to r 0 are neglected and
(ii) spatial leakage effects from r 0 are linearized.

C.

Geometric correction scheme

The above model suggests a spatial leakage correction
method for connectivity estimation between the reconstructed time series Ψ(r 0 , t) and Ψ(r, t). Indeed, according to Eq. (16), spatial leakage from r 0 can be eliminated
from the reconstruction Ψ(r, t) by subtraction of its distribution (15). The geometric correction scheme (GCS)
thus consists in estimating connectivity between Ψ(r 0 , t)
and the corrected reconstruction defined by

The first ensures that Eq. (15) correctly estimates the
geometric distribution of spatial leakage emanating from
r 0 , whereas the second explains its additive contribution
to the reconstruction in Eq. (16). We now discuss these
two conditions in more detail. A formal derivation of this
model is given in Appendix C.
Approximation (i)

Φgcs (r, t) = Ψ(r, t) − Λ(r, t) .

This condition originates from the comment made below Eq. (14) that the “defiltering” step rightly estimates
the underlying activity f (t) at r 0 only if no other true
dynamical process significantly contributes to the reconstruction at r 0 . Indeed, an additional process located at some r 6= r 0 will generally influence the reconstructed activity Ψ(r 0 , t) via a spatial leakage effect
from r to r 0 , which would then invalidate the relation
Ψ(r 0 , t) = (Rr0 ,r0 f )(t) and the ensuing estimates (14,
15). Their approximate validity therefore requires that
spatial leakage effects from other activated regions to r 0
be negligible.
For least-Lp -norm estimation, this condition can be
reinterpreted somewhat more intuitively as the spatial
isolation of the node r 0 , i.e., the system state should be
of the form (12) in some neighborhood of r 0 . This is
because its spatial leakage is dominated by local effects
decreasing with distance (Sec. II D), so the reconstruction at r 0 is mainly affected by state activity located not
too far away. However, this interpretation breaks down
when significant long-range spatial leakage exists. In any
case, this condition is less severe than the pointlike state
assumption (12).

(17)

The justification of this method is clearly conditional
to the validity of the model and its two approximations. In the limit where the model (16) is exact, the
field configuration Φgcs (r, t) = Φ(r, t) is free from spatial leakage effects emanating from r 0 and the associated
spurious couplings are thus absent between Ψ(r 0 , t) and
Φgcs (r, t). An important aspect is that spatial leakage effects, and only those effects, are removed from the reconstructed field. This implies that the ensuing connectivity
estimation does not contain extra biases introduced by
the method itself and only reflects true underlying connectivity (see the two properties discussed below). It
is noteworthy that this aspect is not shared by existing approaches [22, 23, 26–28], as will be discussed in
Sec. IV. On the other hand, when the model approximations are violated, the application of the geometric
correction scheme is not theoretically justified.
Two key properties

For future reference, we state here two properties of the
geometric correction scheme:
(i) No correction is effectively applied at the location r 1
in the absence of spatial leakage effects from r 0 to
r1 .
(ii) When the spatial leakage model is valid and in
the absence of interactions in the system state,
no connectivity is disclosed between Ψ(r 0 , t) and
Φgcs (r, t) = Φ(r, t).

Approximation (ii)

The second approximation concerns the way spatial leakage from r 0 affects the reconstruction elsewhere. Indeed,
although the definition (15) estimates how true activity
f (t) at r 0 transfers to locations r 6= r 0 , its contribution
to Ψ(r, t) is generally nonlinear. On the other hand, the
model (16) assumes an additive effect and thus entails a
linearization of spatial leakage.
This approximation may be expected to hold relatively well for local spatial leakage effects arising from the
(state-independent) spatial continuity of reconstructions,
as is the case for least-Lp -norm estimates (Sec. II D). Indeed, continuity implies that

These two statements represent reasonable expectations
for a spatial leakage correction method (but they are
not satisfied in other approaches, see Sec. IV). The
first means that the reconstruction is unaffected by the
method wherever no correction is necessary, as it should.
This is because the absence of spatial leakage from r 0
to r 1 implies the relation Rr0 ,r1 = 0, so the model (15)
indeed vanishes at r 1 , Λ(r 1 , t) = 0, and thus the corrected and uncorrected reconstructions coincide there,
Φgcs (r 1 , t) = Ψ(r 1 , t) by definition (17). The second
statement means that no artifactual coupling is introduced after correction and only genuine interactions contribute to the ensuing connectivity estimation. This is
because spatial leakage effects from r 0 are precisely eliminated without further modification of the reconstruction.
The formal derivation is relegated to Appendix C.

Ψ(r, t) ≈ Ψ(r 0 , t) = Λ(r 0 , t) ≈ Λ(r, t)
up to terms vanishing as r → r 0 . (The middle equality
follows by setting r = r 0 in Eq. (15).) The spatial leakage distribution (15) therefore contributes linearly to the
reconstruction in a neighborhood of r 0 (and is actually
the dominant part). It is also noteworthy that spatial
leakage effects are linear for p = 2, in which case the
linearization condition is automatically satisfied.
8

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

D.

Linear regression model

Model limitations

The idea of the method is to eliminate all linear instantaneous connectivity between the reconstructed (Fourier or
wavelet) time series Ψ(r 0 , t) and Ψ(r, t) via a linear regression. This amounts to decompose the reconstruction
as

In a given experimental situation, it may be difficult to
a priori evaluate whether the model approximations are
accurate. In any case, the geometric correction scheme
could be used as a first approach to roughly eliminate (or
at least dampen) spatial leakage effects in connectivity
estimation. Of course, the resulting network properties
should then be considered cautiously. A topic for future
work is to test the practical relevance of this method for
specific applications [29].
There are also two further limitations of the geometric
correction scheme that should be noted. The first is that
it only corrects spatial leakage effects emanating from
a single seed r 0 . This means that maps of connectivity
estimates are still affected by other spatial leakage effects.
(For example, coming back to the simulation shown in
Fig. 1, the spread of connectivity around the node r 1
in Fig. 1(f) is due to spatial leakage effects from r 1 .)
The second is that we completely neglected measurement
noise, which may invalidate the method in cases of poor
signal-to-noise ratio. It would be interesting in future
work to bypass these two limitations.

IV.

Ψ(r, t) = Λ⊥ (r, t) + Φ⊥ (r, t) ,

using notations analogous to those in Sec. III B. Here
Λ⊥ (r, t) denotes the optimal model of Ψ(r, t) predicted
by seed activity Ψ(r 0 , t) on the basis of a linear and instantaneous (no phase lag or time delay) coupling. Explicitly,
Λ⊥ (r, t) = k⊥ (r, r 0 , t) Ψ(r 0 , t) ,

(19)

where k⊥ (r, r 0 , t) is the real-valued regression coefficient,


k⊥ (r, r 0 , t) = Re Ψ(r, t)/Ψ(r 0 , t) .
(20)
The rest Φ⊥ (r, t) represents the prediction error and is
then obtained via Eq. (18). The explicit formula (20) follows by minimization of the amplitude squared prediction
error |Φ⊥ (r, t)|2 over k⊥ (r, r 0 , t) ∈ R, and equivalently
enforces the relation


Re Φ⊥ (r, t)/Ψ(r 0 , t) = 0 ,
(21)

STATISTICAL ESTIMATION OF SPATIAL
LEAKAGE
A.

(18)

see Ref. [23] for details. This equation shows that the
phase difference between the complex numbers Ψ(r 0 , t)
and Φ⊥ (r, t) is fixed to ±π/2 at all times. This orthogonality property embodies the fact that no linear instantaneous coupling remains between them.

The orthogonalization method

In the previous section, we introduced the geometric
correction scheme, a model-based method to dampen
spatial leakage effects in connectivity estimation. Another possible approach is to derive correction methods
using considerations of statistical nature. A priori, statistical arguments are limited because they do not rely on
a structural description of spatial leakage and must thus
bias connectivity estimation. The goal of this section is
to investigate this question analytically.
Statistically based correction methods have been designed for the connectivity indices commonly applied to
oscillatory systems, such as orthogonalization [22, 23] for
amplitude correlation and the phase lag index [27, 28]
for phase coupling. Among these two examples, orthogonalization is the most far-reaching because it can also be
applied to phase connectivity and actually encompasses
the phase lag index (see Sec. IV C). We shall therefore
focus here on the orthogonalization method and contrast
it with the geometric correction scheme.
We begin by reviewing the instantaneous orthogonalization defined in Ref. [23]. Technically, we shall need
to consider complex-valued fields because this method
was developed for time-frequency representations (timedependent Fourier or wavelet coefficients) to investigate
nonstationary oscillatory behavior. The theory developed in Sec. III applies without change to this case.

Instantaneous orthogonalization

The orthogonalization method interprets the regression
model Λ⊥ (r, t) as a statistical estimate of spatial leakage
effects from r 0 and uses the prediction error Φ⊥ (r, t) as
corrected reconstruction. Orthogonalized connectivity is
then obtained by connectivity estimation between seed
activity Ψ(r 0 , t) and the orthogonalized field Φ⊥ (r, t).
The strict validity of this approach entails some assumptions that should be emphasized:
(i) Spatial leakage from r 0 is linear,
(ii) spatial leakage from r 0 is instantaneous, and
(iii) spatial leakage from r 0 is the only source of linear
instantaneous coupling between Ψ(r 0 , t) and Ψ(r, t).
The first two reflect the hypotheses of the associated linear regression and constrain the structure of spatial leakage. Their validity depends on the direct and inverse
models at hand (see Secs. II and III). The third is a dynamical hypothesis about the system state, which should
not give rise to genuine linear instantaneous connectivity.
This is because the linear regression can not discriminate
between such true couplings and spatial leakage effects.
Orthogonalization thus eliminates them altogether and
this can lead to an overcorrection bias.
9

Physical Review E 91, 012823 (2015)

Vincent Wens

B.

An explicit example is given in Appendix D. The coupling constant k(r, r 0 , t) ∈ R encodes the spatial leakage
effect. It is state independent and determined by the
direct and inverse models only, contrary to the regression coefficient (20). Actually, this is the sole remaining
difference between the two correction approaches.

Geometric correction scheme versus
orthogonalization

In the remaining sections, we shall compare the geometric correction scheme (Sec. III C) and the orthogonalization method. We start with a qualitative general
discussion and then turn to more quantitative aspects.

Quantitative comparison

Qualitative comparison

We now compare the coupling estimates k(r, r 0 , t) and
k⊥ (r, r 0 , t) that are eliminated by the geometric correction scheme and orthogonalization, respectively. As
shown in Appendix D, they are related via


k⊥ (r, r 0 , t) = k(r, r 0 , t) + Re Φgcs (r, t)/Ψ(r 0 , t) . (23)

Some features are common to both techniques, e.g., the
linearity hypothesis (Secs. III B and IV A) or the nonelimination of spatial leakage effects other than those emanating from r 0 (Sec. III D). But other hypotheses induce
differences.
The main conceptual advantage of the geometric correction scheme is that it relies on a structural description of spatial leakage adapted to the inverse operator,
whereas orthogonalization uses statistical features of reconstructed signals without explicit reference to the inverse model. This implies that the second and third hypotheses used by orthogonalization (Sec. IV A) are not
necessary for the geometric correction scheme. Indeed,
the latter automatically conforms to the temporal characteristics of spatial leakage (and more precisely of the
resolving operator, see Secs. III A and III B), which may
or may not have instantaneous effects depending on the
inverse model. Furthermore, it does not confound true
connectivity with spatial leakage effects and so does not
exhibit the overcorrection bias of orthogonalization. For
example, this bias implies that the reconstruction may
be nontrivially affected by orthogonalization even in the
absence of spatial leakage, whereas this does not happen
with the geometric correction scheme (see property (i) of
Sec. III C).
On the other hand, some hypotheses of the geometric
correction are not required for orthogonalization. First,
measurement noise was neglected in our derivation of the
spatial leakage model (Sec. III D), whereas the regression
automatically takes care of noise contributions. This represents an advantage of orthogonalization. Second, the
condition that spatial leakage effects to r 0 are negligible
(Sec. III B) was not explicitly assumed in orthogonalization. It is noteworthy, however, that this hypothesis was
instrumental to characterize spatial leakage exactly and
avoid any overcorrection bias in the geometric correction
scheme.

This embodies the general observation that the linear
regression includes both spatial leakage effects and true
connectivity. More precisely, the regression coefficient
(20) appears to be the sum of the spatial leakage model
coupling and of the linear instantaneous connectivity estimate after geometric correction. In the limit where the
model is exact, this second term represents a true state
interaction (see property (ii) of Sec. III C) that is eliminated by orthogonalization (overcorrection bias).
It will be useful for our subsequent analyses to promote
this relation at the level of the corrected fields. Plugging
Eq. (23) into the linear regression (18–20) yields


Φ⊥ (r, t) = i Im Φgcs (r, t)/Ψ(r 0 , t) Ψ(r 0 , t) ,
(24)
see Appendix D for details. Geometrically, this means
that the orthogonalized field Φ⊥ (r, t) equals to the projection of the corrected field Φgcs (r, t) onto the direction
perpendicular to Ψ(r 0 , t). A similar formula was derived
in Ref. [23] with the uncorrected reconstruction Ψ(r, t)
in place of the corrected one Φgcs (r, t). This interchangeability is indicative that the linear instantaneous spatial
leakage effect has been completely eliminated by orthogonalization (notwithstanding its overcorrection effect).
Polar coordinates

In the next two sections, we shall focus on two specific
connectivity indices classically applied to oscillatory or
narrow-band time series: phase coherence and amplitude
correlation. Their definition and analysis will be simplified by using field coordinates emphasizing phase and
amplitude fluctuations,
Ψ(r 0 , t) = A0 (t) exp iθ0 (t) ,
Φgcs (r, t) = Agcs (t) exp iθgcs (t) ,
Φ⊥ (r, t) = A⊥ (t) exp iθ⊥ (t) .

Framework for quantitative analysis

We now turn to some quantitative considerations, our
goal being to illustrate the overcorrection effect of orthogonalization (compared to the geometric approach).
To single out this overcorrection bias, we shall work from
now on in a restricted framework where spatial leakage
effects are both linear and instantaneous, so our model
(15) assumes the form
Λ(r, t) = k(r, r 0 , t) Ψ(r 0 , t) .

(25)

In these notations, the relation (24) becomes
A⊥ (t) eiθ⊥ (t) = i Agcs (t) sin(θgcs (t) − θ0 (t)) eiθ0 (t) ,
which directly implies
π
θ⊥ (t) − θ0 (t) = sign[sin(θgcs (t) − θ0 (t))] ,
2
A⊥ (t) = Agcs (t) | sin(θgcs (t) − θ0 (t))| .

(22)
10

(26)
(27)

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

of the phase lag index with orthogonalized phase coherence ζ⊥ proves that this is correct whenever spatial leakage effects are assumed linear and instantaneous, since
then orthogonalization indeed completely eliminates spatial leakage (Sec. IV B). On the other hand, this conjecture has no reason to hold when spatial leakage is not
linear or instantaneous, since orthogonalization then relies on wrong hypotheses (Sec. IV A).

These two formulas should make the above-mentioned
geometric interpretation of orthogonalization quite clear.
They form the basis of our analysis of phase and amplitude connectivity, to which we now turn.

C.

Phase coherence

Phase coherence is a basic communication mechanism
in various oscillatory networks from mechanical and electrical oscillators to neurons [13, 39, 40]. It measures the
tendency of a pair of oscillators (characterized by their
phase signal) to be phase locked, i.e., to have a phase difference ∆θ(t) fluctuating around a definite mean value.
This information is quantified by the temporal average
of exp i∆θ(t). The spatial leakage coupling (22) induces
a spurious tendency towards synchronization or antisynchronization (i.e., phase lag 0 or π) that we propose to
correct using the geometric correction scheme rather than
orthogonalization. The reason is found in the overcorrection bias that affects the orthogonalized phase coupling.
This can be analyzed using Eq. (26).
The phase coherence between the corrected field
ΦI (r, t) (where I = gcs or ⊥) and the seed reconstruction Ψ(r 0 , t) will be denoted by



ζI = exp i(θI − θ0 ) ,
(28)

D.

Amplitude correlation

Real-world oscillatory systems are scarcely perfectly
periodic and typically display narrow-band dynamics parameterized by both phase and amplitude fluctuations. It
is thus also interesting to consider amplitude connectivity. Orthogonalization was originally designed for amplitude correlation [22, 23] but the effect of the overcorrection bias is actually more intricate in this case than
for phase connectivity. This question was investigated in
some detail in Ref. [23] using numerical simulations of a
model of coherent Gaussian signals. We review and solve
this model analytically in Appendix E. Here we focus
on a general discussion of the overcorrection bias on the
basis of Eq. (27).
This equation shows that the orthogonalized field amplitude A⊥ (t) is a nonlinear mixture of the corrected field
amplitude Agcs (t) and phase lag θgcs (t) − θ0 (t). After orthogonalization, the amplitude correlation

the brackets indicating temporal averaging. Plugging
Eq. (26) into this definition for I = ⊥ directly yields



ζ⊥ = i sign[sin(θgcs − θ0 )] = i (f+ − f− ) ,
(29)

ρ⊥ = corr[A⊥ , A0 ] = corr[Agcs × | sin(θgcs − θ0 )|, A0 ]
therefore entangles both the amplitude and phase couplings obtained after geometric correction, indicating
that the estimate ρgcs = corr[Agcs , A0 ] has higher specificity to true amplitude connectivity than ρ⊥ . Indeed, the
only difference is the presence of the multiplicative factor
| sin(θgcs −θ0 )| contributing by an amplitude-phase interaction between seed amplitude A0 (t) and corrected phase
lag θgcs (t) − θ0 (t). Depending on its strength, this coupling can lead to either underestimation (ρ⊥ < ρgcs ) or
overestimation (ρ⊥ > ρgcs ), which illustrates the nontrivial effect of the overcorrection bias in this case. When it
is small enough, this multiplicative factor is randomly related to A0 (t) and effectively acts as noise decreasing the
amplitude correlation ρ⊥ (ρgcs being unaltered). When
it is large enough, this factor has the opposite impact
and can make ρ⊥ increase above ρgcs .
The underestimation of amplitude correlation should
be intuitively expected, since by design orthogonalization eliminates more connectivity that it ought. The
overestimation is a more surprising artifact of orthogonalization emerging when this elimination of connectivity is counterbalanced by the mixing of amplitude and
phase couplings. It can lead to the observation of significant orthogonalized amplitude correlation even in the
absence of genuine amplitude correlation. This can be
demonstrated using the (drastic) example where phase

where f+ and f− denote the fraction of time during which
sin(θgcs (t) − θ0 (t)) is positive and negative, respectively.
This means that orthogonalized phase coherence ζ⊥ reduces to an asymmetry measure of the corrected phase
dynamics θgcs (t) − θ0 (t) and thus only depends quite
coarsely on the corresponding corrected phase coupling
ζgcs . That orthogonalization has such a strong effect on
phase coherence should be expected. Indeed, it eliminates the spurious spatial leakage (anti)synchronization
effect via an orthogonal projection, which fixes the phase
difference between Φ⊥ (r, t) and Ψ(r 0 , t) to ±π/2 at all
times (see Eqs. (21) and (26)) and thus discards any
(anti)synchronization (overcorrection effect). On the
other hand, the geometric correction scheme only removes the model coupling (22) and can still retain some
(anti)synchronization. This indicates that ζgcs is a phase
connectivity measure more sensitive than ζ⊥ .
The phase lag index conjecture

It is noteworthy that the right-hand side of Eq. (29) coincides with the so-called phase lag index [41]. Interestingly, this connectivity estimate was originally introduced on quite heuristic grounds and conjectured to be
insensitive to spatial leakage [27, 28]. Our identification
11

Physical Review E 91, 012823 (2015)

Vincent Wens

adaptive inverse models [34, 35], for which spatial leakage becomes somewhat data dependent. In particular,
the generalization to the unified Bayesian framework of
Ref. [35] is an interesting problem. Another obvious improvement would be to refine the spatial leakage model
and go beyond the present limitations. For example, it is
possible that a more detailed investigation of the various
expansions used to derive the model (see Appendix C)
leads to better nonlinear models for spatial leakage.
In conclusion, this paper lays out the premise of a systematic theory of spatial leakage. Eventually, this theory
and the associated methods should find a wide array of
applications since the problem of spatial leakage arises in
any investigation of the network architecture of complex
systems based on indirect or incomplete measurements.

dynamics is related to amplitude dynamics via
θgcs (t) − θ0 (t) = arcsin(kA0 (t)/Agcs (t)) ,

(30)

for some coefficient k. Equation (27) then implies
A⊥ (t) = |k|A0 (t), so we have maximal correlation ρ⊥ = 1
after orthogonalization, independently of Agcs (t) and
ρgcs . Appendix E describes another (albeit less dramatic) example of this artifact. The extent to which this
arises in realistic situations remains to be evaluated [29].

V.

SUMMARY AND CONCLUSION

Spatial leakage is a general methodological limitation
for the network analysis of spatially distributed dynamical systems based on imperfect inverse models. In this
paper, we investigated this problem by means of analytical methods. Results gave some novel insights about
the structure of spatial leakage and how to correct it in
connectivity estimation.
First, we explored the state-independent nature of spatial leakage by investigating some topological features of
inverse models (Sec. II). This analysis highlighted the
fundamental fact that spatial leakage effects reflect the
structure of the direct and inverse models and not dynamical properties of the underlying system state. A
practical implication is that existing spatial leakage correction methods based on statistical estimations (and
thus dependent of the state) cannot eliminate spatial
leakage effects specifically and are bound to lead to overcorrection biases in connectivity analysis. Second, we
introduced such a structural characterization of spatial
leakage by deriving an explicit analytical model of its
geometry on the basis of which we defined the geometric correction scheme for connectivity analysis (Sec. III).
Contrary to the statistical approach, this method satisfies some properties expected for a reasonable spatial
leakage correction (elimination of state-independent coupling only and ability of disclosing genuine system interactions). Critically, the strict validity of the model and
geometric correction is based on a couple of hypotheses, which were clearly identified but may not necessarily
hold in realistic situations. Third and finally, we compared this method to orthogonalization, a quite general
example of statistically derived correction (Sec. IV). This
allowed emphasis of the inherent overcorrection biases, in
particular for phase and amplitude connectivity indices.
This analysis suggested that, even when the assumptions
of our spatial leakage model are not met, the geometric correction scheme is less biased and more sensitive to
true connectivity. It can therefore be considered as an
improvement over statistical methods.
These analyses open perspectives for generalizations
and refinements. For example, the topological analysis
of spatial leakage (derived in the context of a specific
class of inverse models, namely least-Lp -norm estimation) may become more complicated in the context of

ACKNOWLEDGMENTS

I thank X. De Tiège, N. Goldman, and S. Goldman for
encouraging discussions. This work was supported by a
research grant from the Belgian Fonds de la Recherche
Scientifique (Convention No. 3.4811.08, FRS–F.N.R.S.)
and an Action de Recherche Concertée (ARC: “Pathophysiology of brain plasticity processes in memory consolidation”, Université libre de Bruxelles).

Appendix A: Topological conjugacy for
least-Lp -norm estimates

In this appendix, we derive the topological conjugacy
(9, 10) as well as the principle stated in Sec. II C.
The variational equation

We begin by extracting the topological conjugacy (9)
from the extremization condition (7). First, the variation of Vmisfit (Eq. (5)) with respect to Ψ(r, t) yields

δVmisfit
= −`(r)T µ(t) − (LΨ)(t) ,
δΨ(r, t)

(A1)

as shown by using the definition (3) together with the
identity δ(LΨ)(t)/δΨ(r, t0 ) = `(r)δ(t − t0 ). Likewise, the
variation of Vprior (Eq. (6)) gives
δVprior
= λ |Ψ(r, t)|p−2 Ψ(r, t) .
δΨ(r, t)

(A2)

Since the extremization condition (7) amounts to setting
the sum of these two variations to zero, we obtain

λ |Ψ(r, t)|p−2 Ψ(r, t) = `(r)T µ(t) − (LΨ)(t) . (A3)
Now taking the absolute value yields


λ |Ψ(r, t)|p−1 = `(r)T µ(t) − (LΨ)(t) 
12

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

homeomorphism (10) with p = 2 is trivial (F2 (x) = x).
At first sight, this simplification seems to follow from
the linearity of the associated variational equation (A3).
However, the deeper reason is the unitary invariance of
the L2 norm, as will be discussed in this appendix in
greater generality. Unitarity is a concept of symmetry
that is central in physics. Here we define unitary inverse
models and derive their geometric properties on the basis of symmetry arguments. We will show that associated
reconstructions are always equal (rather than homeomorphic) to linear combinations

and thus
|Ψ(r, t)|p−2


αp
= λ−αp `(r)T µ(t) − (LΨ)(t)  ,

where we set αp = (p − 2)/(p − 1). Plugging this back
into Eq. (A3), we finally find

`(r)T µ(t) − (LΨ)(t)
αp −1

 .
Ψ(r, t) = λ
(A4)
`(r)T µ(t) − (LΨ)(t) αp
This expression is equivalent to the sought Eq. (9) if
we define ψ(r, t) = `(r)T v(t) with

v(t) = λ1 µ(t) − (LΨ)(t)
(A5)

Ψ(r, t) = `(r)T v(t) ,

for some coefficients v(t) that depend on the unitary inverse model and on the system state. This implies that
the topological structure of spatial leakage for least-L2 norm estimates and general unitary models are the same.

and Fp : R → R by
Fp (x) = x/|x|αp = sign[x] |x|1/(p−1) ,

(B1)

(A6)

where we used the identity 1−αp = 1/(p−1) in the second
equality. The graph of Fp shown in Fig. 2 indicates that
it is continuous and strictly increasing. Actually, Fp is a
homeomorphism since it has a continuous inverse

Unitary symmetry

Let us begin by explaining what is meant by a unitary
invariant inverse model. It is convenient to introduce the
standard inner product
Z
hΨ1 |Ψ2 i = dd r Ψ1 (r) Ψ2 (r) ,
(B2)

Fp−1 (x) = |x|p−2 x .
We have therefore proven that Eq. (9) establishes a topological conjugacy between Ψ(r, t) and ψ(r, t). (This relation actually falls short of being a diffeomorphism because Fp and Fp−1 are also differentiable everywhere except at x = 0, where dFp /dx = ∞ for p > 2 and
dFp−1 /dx = ∞ for p < 2.) It is noteworthy that the
coefficients (A5) are themselves expressed in terms of
Ψ(r, t) and generally cannot be computed without explicit knowledge of the reconstruction.

which allows writing the compact expression LΨ = h`|Ψi
for the direct operator (3). It is then quite natural to consider unitary transformations Ψ → UΨ acting on fields
Ψ(r) in the fundamental representation
Z
(UΨ)(r) = dd r 0 U (r, r 0 ) Ψ(r 0 )
(B3)

State-independent properties

and leaving the inner product invariant, i.e., hUΨ1 |UΨ2 i
is equal to hΨ1 |Ψ2 i. Since we consider here real-valued
fields, this imposes the orthogonality constraint
Z
dd r U (r, r 0 ) U (r, r 00 ) = δ(r 0 − r 00 ) .
(B4)

We now demonstrate the principle that a spatial property valid for any linear combination `(r)T v determines a
state-independent spatial property for Ψ(r, t) (Sec. II C).
First, a spatial property valid for linear combinations
`(r)T v, ∀v ∈ Rm , must hold for the particular linear
combination ψ(r, t) = `(r)T v(t). The important point
is that this property for ψ(r, t) does not depend on data
(and thus on the system state). Indeed, to any two data
sets µ(t), µ0 (t) correspond coefficients v(t), v 0 (t) and
thus fields ψ(r, t) = `(r)T v(t) and ψ 0 (r, t) = `(r)T v 0 (t).
Both of them must satisfy the spatial property in question, which is therefore preserved by arbitrary changes in
data. Finally, the resulting state-independent property of
ψ(r, t) gets transferred to the reconstruction Ψ(r, t) via
the topological conjugacy (9, 10). This yields a homeomorphic (i.e., generally deformed) state-independent spatial property for Ψ(r, t), as claimed.

The presence of the kernel `(r) explicitly forbids unitary
transformations to be symmetries of the direct and inverse problems. A standard trick is to promote `(r) to a
background field transforming in the same representation.
This restores symmetry in the direct model since then
hU`|UΨi = h`|Ψi. Unitary inverse models are inverse
models that are invariant under simultaneous transformations Ψ → UΨ, ` → U`.
Symmetry argument

This symmetry principle strongly constraints the functional dependence of reconstructions in the impulseresponse function `(r). Very generally, the reconstruction is a functional

Appendix B: Unitary inverse models

The topological conjugacy (9) becomes particularly
simple in the case of least-L2 -norm estimation, since the

Ψ = F[`1 , . . . , `m ]
13

(B5)

Physical Review E 91, 012823 (2015)

Vincent Wens

of the m components `k (r) of `(r). (We discard explicit
reference to other dependencies such as data µ(t) and
inverse model parameters, which will not play any role
since they are assumed unitary invariant.) Unitary symmetry imposes that if Ψ is the reconstruction for given
functions `k , then the reconstruction for the transformed
functions U`k must be UΨ. Mathematically, this translates into the property that F is unitary equivariant, i.e.,
for any transformation U (B3, B4), we have
F[U`1 , . . . , U`m ] = UF[`1 , . . . , `m ] .

This argument is slightly less general than the previous
one in that it assumes the inverse model to be defined
by a variational principle and requires the existence of
the inverse kernel K(t, t0 ). The result (B11) is also less
explicit; in particular it was not deduced from it that
v(t) depends on `(r) through the invariants h`|`T i.

Appendix C: Expansions and approximations for the
spatial leakage model

(B6)
In this appendix, we derive the model (16) and its associated approximations (Sec. III B) using formal expansions in the state configuration Ψ0 (r, t). We also demonstrate the second key property of the geometric correction
scheme stated in Sec. III C.

This assumption imposes that the functional F must be
of the form
F[`1 , . . . , `m ] =

m
X


`k vk h`|`T i ,

(B7)

k=1

Formal expansions

as expected from classical invariant theory. Indeed, functions vk of the m × m matrix h`|`T i of inner products
h`j |`k i are the most general unitary invariant functionals of the `k s, whereas the factors `k in Eq. (B7) are
necessary for this sum to transform in the fundamental
representation. All unitary invariant model parameters,
including time t and data µ(t), enter Eq. (B7) through
the vk s. Combining Eqs. (B5) and (B7) yields the sought
Eq. (B1), with the k th component of v(t) given by vk .
These coefficients are independent of r, since `(r) only
appears via the inner products h`|`T i. (Strictly speaking, we also assumed that none of the unitary invariant
model parameters depend on r.)

We begin by introducing the notation
Ψ0 (r, t) = δ(r − r 0 ) f (t) + g(r, t) .

Here f (t) represents state activity at location r 0 (as in
Sec. III) whereas g(r, t) describes state activity at r 6= r 0 .
The reconstruction Ψ(r, t) = (Wr LΨ0 )(t) of this state
(see Eqs. (2, 4)) can thus be viewed as a functional of
f (t) and g(r, t) that we shall expand in both variables.
To describe the result, it is useful to recall the identity
F (x + y) = F (x) + F (y) + O(xy)

Extremizing invariant functionals

s(t, t0 ) = hΨ(·, t)|Ψ(·, t0 )i .

(C2)

holding for functions with F (0) = 0 as follows by formally
expanding F (x+y) in both x and y around zero. We shall
apply this identity in the following setup, where F is an
operator and x and y are field configurations:

Another derivation that is closer to the analysis performed in Appendix A is the following. As for leastLp -norm estimation, we suppose that the reconstruction
Ψ(r, t) is defined by extremization of some functional V
but here with the sole assumption of unitary symmetry. This means that it only depends on Ψ(r, t) and `(r)
through the invariants
m(t) = h`|Ψ(·, t)i ,

(C1)

F = Wr L ,

x = g(r, t) ,

y = δ(r − r 0 ) f (t) .

(C3)

In general, the condition F (0) = 0 represents an assumption about the direct and inverse models, albeit a very
reasonable one: It means that the reconstruction Ψ(r, t)
of the trivial state configuration Ψ0 (r, t) = 0 is itself
trivial, Ψ(r, t) = 0. This will be assumed throughout
and Eq. (C2) can thus be applied.
In this setup, the left-hand side F (x + y) coincides
with the reconstruction Ψ(r, t) of the state (C1) since
x + y = Ψ0 and Ψ = F (Ψ0 ). The right-hand side of
(C2) has three contributions. The first is F (x) = Wr Lg
and does not depend of state activity f (t) at r 0 . This
contribution is therefore free from spatial leakage effects
emanating from r 0 and corresponds to the field Φ(r, t)
appearing in Eq. (16),

(B8)

The extremization equation δV/δΨ(r, t) = 0 for such
functional V = V[m, s] reads
Z
δV
T δV
`(r)
+ dt0
Ψ(r, t0 ) = 0 .
(B9)
δm(t)
δs(t, t0 )
Denoting by K(t, t0 ) the inverse of the kernel δV/δs(t, t0 )
(we assume that it exists),
Z
δV
dt0 K(t, t0 )
= δ(t − t00 ) ,
(B10)
δs(t0 , t00 )

Φ(r, t) = (Wr Lg)(t) .

and applying it to the variational equation (B9) then
yields once again the sought Eq. (B1) with coefficients
Z
δV .
v(t) = − dt0 K(t, t0 )
(B11)
δm(t0 )

(C4)

The second is the reconstruction F (y) of the pointlike state y and the definition of the resolving operator
(Sec. III A) shows that F (y) = Rr,r0 f , see Eqs. (12, 13).
14

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

This term represents the linear contribution (independent of g(r, t)) of spatial leakage from r 0 and corresponds
to the field Λ(r, t) appearing in Eq. (16),
Λ(r, t) = (Rr,r0 f )(t) .

Appendix D: Linear instantaneous spatial leakage
model and relation to the regression model

This appendix fills in details for the quantitative analysis of Sec. IV B. We first describe an example of Eq. (22)
and then derive the relations (23) and (24).

(C5)

The third and last contribution gathers all cross-terms
O(f g) describing the nonlinear part of spatial leakage
effects from r 0 .
Combining these remarks and definitions together, we
finally obtain
Ψ(r, t) = Φ(r, t) + Λ(r, t) + O(f g) .

An example

We begin by exhibiting a framework in which spatial leakage effects are shown to be linear and instantaneous, see
Eq. (22). Quite naturally, we consider direct and inverse
models that are both linear and instantaneous. Specifically, let us use the direct operator (3) and an inverse
operator of the form

(C6)

This looks similar to the model (16) except that, in general, (i) Eqs. (14, 15) do not hold and (ii) the cross-terms
are not absent (except when F is linear). To make contact with the model, we use two independent approximations.

(Wr µ)(t) = w(r, t)T µ(t) .

This can be viewed as a spatial filter characterized by
weights w(r, t) ∈ Rm . The evaluation of the spatial leakage model (15) requires us to know the resolving operator
(13). It is obtained by starting from the field configuration (12), computing the data predicted by the direct
model (2, 3), i.e., µ(t) = `(r 0 )f (t), and reconstructing it
with the inverse operator (D1). This leads to

Approximation (i)

As said in the main text (Sec. III B), the condition necessary for the validity of the estimate (14) for f (t) is
that g(r, t) does not contribute significantly to the reconstruction at r 0 . This means that the second term
in the right-hand side of Eq. (C6) must dominate when
r = r 0 , i.e.,
Ψ(r 0 , t) ≈ Λ(r 0 , t) = (Rr0 ,r0 f )(t) .

(D1)

(Rr,r0 f )(t) = w(r, t)T `(r 0 ) f (t)

(C7)

(D2)

T
and thus (R−1
r 0 ,r 0 f )(t) = f (t)/w(r 0 , t) `(r 0 ). Plugging
these results into Eq. (15) shows that the spatial leakage model is indeed restricted to the form (22) with the
specific coefficient

The approximate validity of Eq. (14) directly follows from
the invertibility of Rr0 ,r0 . Plugging the estimate (14) into
the definition (C5) yields Eq. (15).
Approximation (ii)

k(r, r 0 , t) = w(r, t)T `(r 0 ) / w(r 0 , t)T `(r 0 ) .

We now consider Eq. (C6) for r 6= r 0 and make the assumption that the cross-terms O(f g) are negligible in
front of the two other contributions. This holds, for instance, in the limit of small field configurations where
Ψ0 (r, t) = O() with  → 0 (i.e., both f (t) and g(r, t)
are O()). Indeed, in this case Φ(r, t) and Λ(r, t) equal
O(), too (as F = Wr L satisfies F (0) = 0), whereas the
cross-terms equal O(2 ). More generally, this approximation means that we only keep the linear part of spatial
leakage effects from r 0 and neglect their nonlinear contribution.

(D3)

This quantifies the state-independent coupling representing the spatial leakage effect from r 0 to r at time t.
Relating the coupling constants

We now derive the relation (23).
Eq. (17) as

Trivially rewriting

Ψ(r, t) = Λ(r, t) + Φgcs (r, t)
and plugging this into Eq. (20), we find that the regression coefficient k⊥ (r, r 0 , t) equals to




Re Λ(r, t)/Ψ(r 0 , t) + Re Φgcs (r, t)/Ψ(r 0 , t) .

Property (ii) of Section III C

A key property for the geometric correction scheme is
that, in the limit where the two above approximations
hold exactly and in the absence of dynamical interaction
between state activity f (t) at r 0 and g(r, t), no connectivity estimation can disclose a coupling between Ψ(r 0 , t)
and Φ(r, t). This statement can be proven directly in the
setup developed in this appendix. First, Eq. (C4) shows
that Φ(r, t) depends on the field g(r, t) but not on the
variable f (t), and is thus temporally uncoupled to f (t)
by assumption. On the other hand, Eqs. (C7) and (14)
show that f (t) is merely a transformed version of Ψ(r 0 , t).
We conclude that Φ(r, t) is temporally independent of
Ψ(r 0 , t), as claimed.

The first term estimates the spurious linear instantaneous
interaction between seed activity Ψ(r 0 , t) and the spatial
leakage model Λ(r, t) and reduces to the coupling coefficient k(r, r 0 , t) because of Eq. (22). We thus recover the
sought Eq. (23).
Relating the corrected fields

We finally demonstrate Eq. (24) from Eq. (23). Plugging
the latter into Eq. (19) shows that


Φgcs (r, t)
Λ⊥ (r, t) = Λ(r, t) + Re
Ψ(r 0 , t) .
(D4)
Ψ(r 0 , t)
15

Physical Review E 91, 012823 (2015)

Vincent Wens

Subtracting this from the uncorrected reconstruction
Ψ(r, t) and using the definitions (18) and (17) for the
corrected ones then yields


Φgcs (r, t)
Φ⊥ (r, t) = Φgcs (r, t) − Re
Ψ(r 0 , t) . (D5)
Ψ(r 0 , t)
This is equivalent to the sought Eq. (24).

Appendix E: Amplitude correlation for a model of
coherent Gaussian signals

FIG. 3. Linear approximation of squared amplitude. The
Rayleigh distribution of A(t) with maximum reached at value
α = 1 is shown together with the function A2 . The Taylor
expansion A2 ≈ 2αA − α2 around A = α is seen to be a good
approximation in the α ± σA interval (green shaded region),
which contains about 80% of samples. Over a larger interval,
linear regression still yields a reasonable approximation.

In this appendix, we consider the model of coherent
Gaussian signals introduced in Ref. [23] and derive analytically an expression for the true and orthogonalized
amplitude correlations.
Model definition

Approximation scheme

The model assumes that the spatial-leakage-free reconstruction Φgcs (r, t) is linearly related to the seed signal
Ψ(r 0 , t). Explicitly,
Ψ(r 0 , t) = A0 (t) exp iθ0 (t) ,

Our basic observation is that all amplitudes in the prob2
= (2 − π/2)α2 for
lem have finite variance, e.g., σA
the Reyleigh distribution. Therefore, they are effectively
supported on a region where the amplitude squared can
be reasonably approximated by a linear function, as illustrated in Fig. 3. Now an elementary property of the
correlation coefficient (E3) is to be invariant under affine
transformations, i.e.,

(E1)

c exp iψ
Φgcs (r, t) = A1 (t) exp iθ1 (t) + √
Ψ(r 0 , t) . (E2)
1 − c2
The linear coupling is controlled by two parameters: the
coherence parameter 0 ≤ c ≤ 1 quantifies the strength of
this coupling, whereas ψ denotes the mean phase lag between Ψ(r 0 , t) and Φgcs (r, t). In the absence of coupling
(c = 0), the two fields are assumed to be uncorrelated
white noises with identical (complex-valued) Gaussian
distribution. This means that A0 (t) and A1 (t) are distributed according to a Rayleigh distribution (i.e., their
fraction of time spent between values A and A + dA is
−d exp(−A2 /2α2 ) for some α > 0, see Fig. 3) and that
θ0 (t) and θ1 (t) are uniformly distributed on the circle, all
four signals being independent of each other.
Our goal is to evaluate the amplitude correlations
ρI = corr[AI , A0 ] =

hAI A0 i − hAI ihA0 i
σAI σA0

corr[AI , A0 ] = corr[aAI + b, a0 A0 + b0 ]
whatever the coefficients a, b, a0 , b0 . Using the choice of
these coefficients for optimal linearizations A2I ≈ aAI + b
and A20 ≈ a0 A0 + b0 , we obtain the approximate formula
ρI ≈ corr[A2I , A20 ] .

(E5)

Solution

The right-hand side of Eq. (E5) can be computed analytically in terms of c and ψ, as we detail below. The
resulting expressions for I = gcs and I = ⊥ are

(E3)

ρgcs ≈ c2 ,

between ΦI (r, t) (I = gcs or ⊥) and Ψ(r 0 , t). In this
definition, σA denotes the standard deviation
p
σA = hA2 i − hAi2 .
(E4)

(E6)
2

c̃
,
ρ⊥ ≈ p
4
c̃ + 2c̃2 + 1/2
where we defined the effective coupling constant
p
c̃ = c sin ψ/ 1 − c2 .

Computing these nonlinear correlations exactly as functions of the model parameters c and ψ is difficult but
illustrates the nontrivial effect of orthogonalization on
amplitude correlation. This computation was performed
numerically in Ref. [23]. However, analytical derivations
are possible using an appropriate approximation.

(E7)

(E8)

Figure 4 shows that these equations based on an approximation agree with numerical simulations.
Eliminating c for ρgcs and plugging into Eq. (E7) illustrates the nontrivial phase-dependent relation between
orthogonalized and true amplitude correlations. Depending on the values of c and ψ, we observe the underestimation and overestimation effects described in Sec. IV D.
16

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

(a)

equation in Eq. (E10) is obtained similarly by expanding
Agcs (t)2 = |Φgcs (r, t)|2 . Of the four terms, two vanish
for the same reason as above whereas the two others yield

(b)

hA2gcs i = hA21 i + c2 hA20 i/(1 − c2 ) = hA20 i/(1 − c2 )
since again hA21 i = hA20 i.
The computation of corr[A2gcs , A20 ] is now a straightforward algebraic exercise. Details involve similar factorizations and equalities of various expectation values
and will not be repeated here. For the numerator of the
correlation coefficient (see the explicit definition (E3) for
squared amplitudes), we obtain

FIG. 4. Analytical results versus simulations. The comparison of Eqs. (E6) (a) and (E7) (b) to simulations in which
the parameters 0 ≤ c ≤ 1 and 0 ≤ ψ ≤ π/2 were varied
shows very good consistency. For example, fitting a power
law ρgcs = ck on the simulation curve (a) by a log-log linear
regression yields k ≈ 2.1, quite close to the exponent predicted by Eq. (E6).

2
2
hA2gcs A20 i − hA2gcs ihA20 i = c2 σA
2 /(1 − c ) ,
0

and for the denominator
2
2
σA2gcs σA20 = σA
2 /(1 − c ) .

(E12)

0

For example, the case where ψ = 0 (no phase lag) underestimates amplitude correlation, ρ⊥ = 0 independently
of the coupling strength c or ρgcs . (This is because then
Ψ(r 0 , t) and Φgcs (r, t) are synchronized and their linear
instantaneous interaction is completely eliminated by orthogonalization.) An example of overestimation is given
by ψ = π/2, for then ρgcs < c < ρ⊥ (see Fig. 4), although
it is less drastic than the example (30).

Taking their ratio finally yields the sought Eq. (E6).
It is noteworthy that the independence of ρgcs in the
phase lag ψ does not only hold within the approximation
(E5) but is actually exact, meaning that true amplitude
correlation only depends on the coupling strength c. This
can be understood by writing the absolute value of (E2)
as


c ei(θ0 (t)−θ1 (t)+ψ)


√
A0 (t) ,
Agcs (t) = A1 (t) +
1 − c2

Derivation of Eq. (E6)

To begin our computation of the right-hand side of
Eq. (E5) with I = gcs, we demonstrate that the moments of Agcs (t) = |Φgcs (r, t)| are given by
hAngcs i =

hAn0 i
,
(1 − c2 )n/2

hΦgcs (r, ·)2 i = 0 ,

(E13)

which shows that phases only appear in amplitudes
through the combination θ0 (t) − θ1 (t) + ψ. The basic
property
I
I
dθ0 dθ1 f (θ0 − θ1 + ψ) = dθ0 dθ1 f (θ0 − θ1 ) , (E14)

(E9)

where n ∈ N. We will actually show the stronger result
that Φgcs (r, t) has the same distribution
as the Gaussian
√
white signal A0 (t) exp iθ0 (t)/ 1 − c2 . We note first that
Φgcs (r, t) must be a gaussian white noise since it is a linear combination of two independent Gaussian white signals Ak (t) exp iθk (t), see Eqs. (E1, E2). It only remains
to compute its covariance structure and show that
hA20 i ,
hA2gcs i =
1 − c2

(E11)

for functions f on the circle shows that any expectation
value, e.g., of the form hAngcs Am
0 i, must be independent
of ψ.
Derivation of Eq. (E7)

We now turn to the right-hand side of Eq. (E5) with
I = ⊥. Plugging Eqs. (E1, E2) into Eq. (24) shows that
the orthogonalized field Φ⊥ (r, t) equals to

(E10)


i eiθ0 (t) A1 (t) sin(θ1 (t) − θ0 (t)) + c̃ A0 (t) .

from which the result would follow. The first equation is obtained by explicit expansion of the square of
Eq. (E2) and using the statistical assumptions about
Ak (t) and θk (t). Each of the three resulting terms
vanish. For example, let us consider the cross-term,
which is proportional to hA0 A1 exp i(θ0 + θ1 )i. The
independence assumption implies its factorization into
hA0 ihA1 ihexp iθ0 ihexp iθ1 i, which further simplifies to
hA0 i2 hexp iθ0 i2 because distributions are the same for
A0 (t) and A1 (t) and likewise for θ0 (t) and θ1 (t). This
term finally vanishes since hexp iθ0 i = 0. The second

This equation indicates that the model parameters c and
ψ only appear via the combination (E8) after orthogonalization. It also suggests that Φ⊥ (r, t) is no longer Gaussian, and the moments of A⊥ (t) = |Φ⊥ (r, t)| must be
computed explicitly. Computations are therefore slightly
more cumbersome but still straightforward. For the numerator of the correlation corr[A2⊥ , A20 ], we find
2
hA2⊥ A20 i − hA2⊥ i hA20 i = c̃2 σA
2 .
0

17

(E15)

Physical Review E 91, 012823 (2015)

Vincent Wens

implies

For the denominator σA2⊥ σA20 , we also find that
4
2
2
2 2
2
σA
2 = (c̃ + 3/8) σA2 + (2c̃ + 1/8) hA0 i .
⊥

0

2
4
2
2
σA
2 = (c̃ + 2c̃ + 1/2) σA2 .

(E16)

⊥

0

(E17)

This can be further simplified thanks to the identity
hA20 i = σA20 valid for the Reyleigh distribution, which

The sought Eq. (E7) follows by taking the ratio of
Eq. (E15) and σA2⊥ σA20 with Eq. (E17).

[1] S. H. Strogatz, Nature, 410, 268 (2001).
[2] R. Albert and A.-L. Barabási, Rev. Mod. Phys., 74, 47
(2002).
[3] M. E. J. Newman, SIAM Rev., 45, 167 (2003).
[4] S. Boccaletti, V. Latora, Y. Moreno, M. Chavez, and
D.-U. Hwang, Phys. Rep., 424, 175 (2006).
[5] When connectivity estimation is based on some correlation between pairs of time series representing nodes
activity, the resulting graph is sometimes called a functional network to distinguish it from the actual anatomy
of physical connections. This paper focuses on functional
networks.
[6] C. T. Butts, Science, 325, 414 (2009).
[7] S. Bialonski, M.-T. Horstmann, and K. Lehnertz, Chaos,
20, 013134 (2010).
[8] D. J. Watts and S. H. Strogatz, Nature, 393, 440 (1998).
[9] A. Tarantola, Nat. Phys., 2, 492 (2006); G. Jobert, Europhysics News, 44, 21 (2013).
[10] A. Tarantola, Inverse Problem Theory and Methods for
Model Parameter Estimation (SIAM, 2004).
[11] There are other sources of biases in connectivity estimation unrelated to spatial leakage, but we shall not consider them here. For example, for biases induced by the
finiteness of data, see S. Bialonski, M. Wendler, and
K. Lehnertz, PLoS ONE, 6, e22826 (2011); A. Zalesky,
A. Fornito, and E. Bullmore, NeuroImage, 60, 2096
(2012).
[12] G. Buzsáki, Rhythms of the Brain, 1st ed. (Oxford University Press, New York, 2006).
[13] G. Buzsáki and A. Draguhn, Science, 304, 1926 (2004).
[14] For reviews, see G. Deco and M. Corbetta, The Neuroscientist, 17, 107 (2011); G. Deco, V. K. Jirsa, and A. R.
McIntosh, Nat. Rev. Neurosci., 12, 43 (2011).
[15] M. Hämäläinen, R. Hari, R. J. Ilmoniemi, J. Knuutila,
and O. V. Lounasmaa, Rev. Mod. Phys., 65, 413 (1993).
[16] G. Buzsáki, C. A. Anastassiou, and C. Koch, Nat. Rev.
Neurosci., 13, 407 (2012).
[17] C. Stam and J. Reijneveld, Nonlinear Biomed. Phys., 1,
3 (2007).
[18] E. Bullmore and O. Sporns, Nat. Rev. Neurosci., 10, 186
(2009).
[19] J.-M. Schoffelen and J. Gross, Hum. Brain Mapp., 30,
1857 (2009).
[20] F. de Pasquale, S. Della Penna, A. Z. Snyder, C. Lewis,
D. Mantini, L. Marzetti, P. Belardinelli, L. Ciancetta,
V. Pizzella, G. L. Romani, and M. Corbetta, Proc.
Natl. Acad. Sci. USA, 107, 6040 (2010); F. De Pasquale,
S. Della Penna, A. Z. Snyder, L. Marzetti, V. Pizzella,
G. L. Romani, and M. Corbetta, Neuron, 74, 753 (2012).
[21] M. J. Brookes, M. Woolrich, H. Luckhoo, D. Price, J. R.
Hale, M. C. Stephenson, G. R. Barnes, S. M. Smith, and
P. G. Morris, Proc. Natl. Acad. Sci. USA, 108, 16783
(2011).

[22] M. J. Brookes, M. Woolrich, and G. R. Barnes, NeuroImage, 63, 910 (2012).
[23] J. F. Hipp, D. J. Hawellek, M. Corbetta, M. Siegel, and
A. K. Engel, Nat. Neurosci., 15, 884 (2012).
[24] V. Wens, A. Mary, M. Bourguignon, S. Goldman,
B. Marty, M. Op de beeck, P. Van Bogaert, P. Peigneux,
and X. De Tiège, Clin. Neurophysiol., 125, 1711 (2014).
[25] V. Wens, M. Bourguignon, S. Goldman, B. Marty,
M. Op de beeck, C. Clumeck, A. Mary, P. Peigneux,
P. Van Bogaert, M. J. Brookes, and X. De Tiège, Brain
Topogr., 27, 620 (2014).
[26] G. Nolte, O. Bai, L. Wheaton, Z. Mari, S. Vorbach, and
M. Hallett, Clin. Neurophysiol., 115, 2292 (2004).
[27] C. J. Stam, G. Nolte, and A. Daffertshofer, Hum. Brain
Mapp., 28, 1178 (2007).
[28] A. Hillebrand, G. R. Barnes, J. L. Bosboom, H. W.
Berendse, and C. J. Stam, NeuroImage, 59, 3909 (2012).
[29] For a proof of concept on simulated and experimental neuromagnetic data, see V. Wens, B. Marty,
A. Mary, M. Bourguignon, M. Op de beeck, S. Goldman, P. Van Bogaert, P. Peigneux, and X. De Tiège,
submitted.
[30] Spatial leakage differs from the notion of spectral leakage, which originates from finite-dimensional truncations
of the space of fields Ψ(r, t); see J. Trampert and
R. Snieder, Science, 271, 1257 (1996).
[31] I. Daubechies, M. Defrise, and C. De Mol, Comm. Pure
Appl. Math., 57, 1413 (2004).
[32] D. Malioutov, M. Cetin, and A. S. Willsky, IEEE Trans.
Sig. Proc., 53, 3010 (2005).
[33] W. Ou, M. S. Hämäläinen, and P. Golland, NeuroImage,
44, 932 (2009); A. Gramfort, D. Strohmeier, J. Haueisen,
M. Hämäläinen, and M. Kowalski, ibid., 70, 410 (2013).
[34] B. D. Van Veen and K. M. Buckley, IEEE ASSP Mag.,
5, 4 (1988).
[35] D. Wipf and S. Nagarajan, NeuroImage, 44, 947 (2009);
D. P. Wipf, J. P. Owen, H. T. Attias, K. Sekihara, and
S. S. Nagarajan, ibid., 49, 641 (2010).
[36] Point-spread functions are often used to assess the localization biases and spatial resolution of inverse models.
For example, see K. Sekihara, M. Sahani, and S. S. Nagarajan, NeuroImage, 25, 1056 (2005).
[37] G. Backus and F. Gilbert, Phil. Trans. R. Soc. Lond. A,
266, 123 (1970).
[38] A. K. Liu, A. M. Dale, and J. W. Belliveau, Hum. Brain
Mapp., 16, 47 (2002).
[39] S. H. Strogatz, Nonlinear Dynamics and Chaos with Applications to Physics, Biology, Chemistry, and Engineering (Perseus Books Group, New York, 1994).
[40] A. Pikovsky, M. Rosenblum, and J. Kurths, Synchronization: A Universal Concept in Nonlinear Sciences (Cambridge University Press, Cambridge, UK, 2003).

18

Physical Review E 91, 012823 (2015)

Investigating complex networks with inverse models

[41] More precisely, the original definition of the phase lag
index requires replacing θgcs (t) by the phase θ(t) of the
uncorrected reconstruction Ψ(r, t) in the right-hand side

of Eq. (29). This replacement can indeed be applied, as
was noted below the basic relation (24).

19

