arXiv:1410.2508v3 [q-bio.PE] 7 Mar 2015

The diversity of evolutionary dynamics on epistatic
versus non-epistatic fitness landscapes
David M. McCandlish∗1 , Jakub Otwinowski1 , and Joshua B. Plotkin1
1

Department of Biology, University of Pennsylvania, Philadelphia, PA

Abstract

The class of epistatic fitness landscapes is much more diverse than the class of nonepistatic landscapes, and so it stands to reason that there exist dynamical phenomena that can only be realized in the presence of epistasis. Here, we compare evolutionary dynamics on all finite epistatic landscapes versus all finite non-epistatic
landscapes, under weak mutation. We first analyze the mean fitness trajectory —
that is, the time course of the expected fitness of a population. We show that for any
epistatic fitness landscape and starting genotype, there always exists a non-epistatic
fitness landscape and starting genotype that produces the exact same mean fitness
trajectory. Thus, surprisingly, the space of mean fitness trajectories that can be realized by epistatic landscapes is no more diverse than the space of mean fitness
trajectories that can be realized by non-epistatic landscapes. On the other hand, we
show that epistatic fitness landscapes can produce dynamics in the time-evolution
of the variance in fitness across replicate populations and in the time-evolution of
the expected number of substitutions that cannot be produced by any non-epistatic
landscape. These results on identifiability have implications for efforts to infer
epistasis from the types of data often measured in experimental populations.

∗

To whom correspondence should be addressed. E-mail: davidmc@sas.upenn.edu

1

1

Introduction

A basic problem in evolutionary biology is to understand how the structure of a fitness
landscape affects the dynamics of adaptation (Wright, 1932; Maynard Smith, 1970; Kauffman,
1993; Whitlock et al., 1995; Fontana and Schuster, 1998; Weinreich et al., 2005; Jain and Krug,
2007; Kryazhimskiy et al., 2009; de Visser and Krug, 2014; Hartl, 2014). One simple classification distinguishes non-epistatic fitness landscapes, where the fitness effects of mutations
are independent of genetic background, from epistatic landscapes, where some mutations have
background-dependent effects (Fisher, 1918; Weinberger, 1990; Phillips, 2008; de Visser et al.,
2011; Szendro et al., 2013; Weinreich et al., 2013; de Visser and Krug, 2014). Because the
class of epistatic fitness landscapes is far more diverse than the class of non-epistatic fitness
landscapes, it seems intuitive that the dynamics of adaptation possible on epistatic fitness landscapes should be more diverse than the dynamics possible on non-epistatic landscapes.
Here, we rigorously test this intuition for several aspects of the dynamics of adaptation,
such as the time-evolution of the expected degree of adaptation, the expected number of substitutions, and the variance in fitness across replicate populations. Assuming that mutation is
weak, i.e. that each new mutation is lost or goes to fixation before the next new mutation enters
the population (see McCandlish and Stoltzfus, 2014, for a review), we characterize the possible
dynamics of these descriptors of adaptation, across the entire class of finite non-epistatic fitness
landscapes. We then ask whether there exist epistatic landscapes for which these descriptors behave in ways that are impossible in the absence of epistasis. Such an analysis provides insight
into the role of epistasis in adaptation by identifying dynamical phenomena that are possible
only when epistasis is present.
Our most important result concerns how the expected fitness of a population changes over
time. In particular, we consider an ensemble of replicate populations that begin fixed for some
genotype on a fitness landscape. We then ask, for any given time in the future, what the mean
fitness across the ensemble of populations will be. The time evolution of this expected fitness
is known as the “mean fitness trajectory” (Kryazhimskiy et al., 2009). Surprisingly, we prove
that, for any finite epistatic fitness landscape and choice of starting genotype, one can always
construct a non-epistatic fitness landscape that produces the exact same mean fitness trajectory
as the epistatic landscape produces. Thus, at least for the expected degree of adaptation, the
dynamics possible on epistatic landscapes are no more diverse than those possible on nonepistatic landscapes.
To illustrate this general result in a specific case, Figure 1A shows an epistatic and a nonepistatic fitness landscape that produce the same mean fitness trajectory (Figure 1B) for a population that starts at the left-most genotype (ab or abc). Note that the first fitness landscape in
Figure 1A is not merely epistatic, but in fact exhibits reciprocal sign epistasis (Weinreich et al.,
2005), and the resulting mean fitness trajectory decreases initially (due to deleterious fixations
2

A
Fitness
(Ns)

AB

2
1
0
1
2
3

ab

abC

aB

abc

aBc
Abc

aBC
AbC

ABC

ABc

Ab

0

1

2

0

1

2

3

Hamming distance from initial genotype

B

1.5

Mean
Fitness
(Ns)

1.0
0.5
0.0
0

2

4

6

Time

8

10

Figure 1: (A) A fitness landscape with reciprocal sign epistasis and a non-epistatic fitness
landscape that both produce the exact same mean fitness trajectory (B) when the population
begins at the left-most genotype (ab or abc). Edges are mutations and points are genotypes.
The height of a genotype indicates its scaled selection coefficient (N s) relative to the initial
(left-most) genotype. Edge thickness is proportional to mutation rate. The bottom panel shows
expected fitness as a function of time (the mean fitness trajectory), where time is measured in
terms of expected substitutions at a neutral locus with a unit mutation rate. Notice that the
trajectory is quite complex; in particular, it decreases slightly at short times before increasing
to its asymptotic value at long times.

3

into the fitness valley) before increasing towards its asymptotic value, as populations become
more likely to have crossed the fitness valley. It may seem surprising that one can construct a
non-epistatic landscape that produces the same, complex dynamics. And, yet, our main result
says that constructing such a landscape is always possible.
Our main result shows that the set of realizable mean fitness trajectories for epistatic landscapes is no more diverse than the set of mean fitness trajectories for non-epistatic landscapes,
despite the fact that, e.g. epistatic fitness landscapes can have multiple fitness peaks while nonepistatic landscapes are always single-peaked. However, the presence of epistasis does increase
the diversity of possible dynamics for several more subtle descriptors of the adaptive process.
For instance, if we again consider an ensemble of replicate populations evolving from the same
starting genotype, we can study the variance in fitness across these populations as a function
of time. It turns out that there exist epistatic fitness landscapes whose “variance trajectories”
have features that cannot be achieved on any non-epistatic landscape. In particular, a variance
trajectory that is accelerating at short times can occur only on an epistatic fitness landscape. A
similar result holds for the expected number of substitutions that accrue over time, i.e. the mean
substitution trajectory (Kryazhimskiy et al., 2009): for any non-epistatic fitness landscape the
expected substitution rate can never be less than half the equilibrium substitution rate, whereas
some epistatic fitness lanscapes violate this condition and are expected to produce a broader
range of substitution rates.
Our emphasis here is on the theoretical question of the diversity of evolutionary dynamics
with or without epistasis, rather than on developing practical tests for epistasis. Nevertheless,
our results show that epistasis is in principle identifiable from some statistics, but not from others. Our results therefore have implications for attempts to infer the presence and form of epistasis from empirical observations of evolution in replicate laboratory populations (e.g., Lenski
et al., 1991; Lenski and Travisano, 1994; Kryazhimskiy et al., 2009; Wiser et al., 2013), an
approach that has recently been the subject of some controversy (Frank, 2014; Good and Desai,
2014). We return to this problem of inferring epistasis from observed evolutionary dynamics in
the Discussion.

2
2.1

Results
Population-genetic model

We consider the space of all possible fitness landscapes with a finite number of bi-allelic
sites. A genotype is defined by the state at all of its sites, and the fitness of the i-th genotype is
denoted F(i). We will work in scaled Malthusian fitness (i.e. the fitness of a genotype is equal

4

to the logarithm of the standard, Wrightean fitness times the population size) so that the scaled
selection coefficient of genotype j relative to genotype i is given by F(j) − F(i).
Our main population-genetic assumption is that mutation is weak, i.e. that each new mutation is either fixed or lost before the next mutation enters the population. Because the time
during which a mutation segregates in such a population is much shorter than the waiting time
between new mutations, we neglect the time that a mutation segregates and simply model the
population as monomorphic, jumping from genotype to genotype at the birth of each new mutation destined for fixation (Iwasa, 1988; Berg et al., 2004; Sella and Hirsh, 2005; McCandlish
and Stoltzfus, 2014).
We use the standard model for a population evolving under weak mutation in continuous
time. More formally, we model evolution as a continuous time Markov chain with rate matrix
Q, where
(
F(j)−F(i)
for i 6= j
−(F(j)−F(i)) QM (i, j)
1−e
(1)
Q(i, j) =
P
for i = j
− k6=i Q(i, k)
and QM is the mutational rate matrix. We assume that forward mutations arise at site l as a
Poisson process with rate µl and back mutations arise as at site l as a Poisson process with rate
νl . Thus, QM (i, j) for i 6= j is equal to µl > 0 if genotype j can arise from genotype i by a
forward mutation at site l, νl > 0 if genotype j can arise from genotype i by a back mutation
at site l, and 0 otherwise; the QM (i, i) are chosen so that the row sums are zero. While for
convenience the above expression is based on the classical approximation to the probability of
fixation of a new mutation in the diffusion limit (Fisher, 1930; Wright, 1931), our results can
easily be extended to hold exactly in the limit of weak mutation for a population of finite size
N evolving under a Moran process by using the appropriate exact expression for the probability
of fixation (Moran, 1959).
We define a non-epistatic fitness landscape (Phillips, 2008; de Visser et al., 2011; Szendro
et al., 2013; Weinreich et al., 2013; de Visser and Krug, 2014) as one in which each site makes
an additive contribution to fitness (recall that we are working in Malthusian fitness, so that
this corresponds to a multiplicative landscape in Wrightean fitness). More formally, for a nonepistatic fitness landscape each site l is associated with a value Sl such that, for any ordered
pair of genotypes i and j differing by a forward mutation at site l, we have F(j) − F(i) = Sl .
Under this definition, the non-epistatic fitness landscapes are precisely those landscapes for
which sites evolve independently of each other. This is because the forward substitution rate at
site l is always
Sl
µl
(2)
αl =
1 − e−Sl
and the corresponding backwards substitution rate is
βl =

−Sl
νl .
1 − e−(−Sl )
5

(3)

Fitness minus
expected fitness at equilibrium

0.5
0.0
-0.5
-1.0
-1.5
-2.0
0

2

4

6

8

10

Time

Figure 2: The mean fitness trajectory shared by the two fitness landscapes in Figure 1 (black)
together with each of the corresponding exponentially decaying deviations from the equilibrium
expected fitness (gray) that can be combined together to compose the trajectory. There are two
positive deviations from the equilibrium expected fitness that decay very rapidly, producing the
small dip in fitness at short times, and a much more slowly decaying negative deviation from the
equilibrium distribution that corresponds to crossing the fitness valley in the epistatic landscape
or to having a substitution at the third site in the non-epistatic landscape.
Thus, for a non-epistatic fitness landscape the evolutionary dynamics at site l depend only the
state of site l and not on the states of the other sites.

2.2
2.2.1

Mean fitness trajectories
Formal results

Suppose a population is initially fixed for some genotype i, with fitness F (i), at time 0. At
any time t in the future, the population has some probability of being fixed for each other genotype j, with fitness F (j). We can therefore ask: What is the expected fitness of the population at
time t? The course of the expected fitness over time is called the mean fitness trajectory, which
we write as f (t). In the Supporting Information, we show that the mean fitness trajectory can
always be written in the form:
f (t) = f (∞) +

n
X

ck e−λk t

(4)

k=2

for some constants c2 , . . . , cn , with λ2 , . . . , λn > 0 and n denoting the number of genotypes in
the fitness landscape. In other words, for an arbitrary fitness landscape, including all epistatic
6

landscapes, the mean fitness trajectory can always be expressed as a sum of exponentially decaying deviations from the equilibrium mean fitness, f (∞). Figure 2 illustrates this decomposition
for the fitness trajectory shared by the two fitness landscapes in Figure 1A.
Now, let us restrict our attention to non-epistatic landscapes, and consider what types of
fitness trajectories can arise. Because fitness is additive over sites in such a landscape, we can
write the fitness trajectory as a sum over sites. In particular, using the standard solution for a
two-state Markov chain, the fitness trajectory for a non-epistatic landscape is given by:
X

αl
1 − e−(αl +βl )t
(5)
f (t) = f (0) +
Sl
α
l + βl
l
where f (0) is the initial fitness and we assume (without loss of generality) that the population
begins fixed for the first of the two states for each site at t = 0. Rewriting Equation 5 in the
same form as Equation 4, we have:
!
X
X
αl
αl
Sl
f (t) = f (0) +
−Sl
+
e−(αl +βl )t .
(6)
α
α
l + βl
l + βl
l
l
We now arrive at our main result. Comparing Equations 4 and 6, we see that given an
arbitrary epistatic fitness landscape we can always construct a non-epistatic fitness landscape
that will produce a fitness trajectory of the same shape, provided we can choose values Sl , µl
and νl for each k such that
αl
(7)
ck = −Sl
αl + βl
and
λk = αl + βl .

(8)

Indeed, such choices can always be made. For instance, one solution is αl = βl = λk /2,
−1
−1
Sl = −2ck and µl = αl Sl /(1 − e−Sl ) , νl = βl −Sl /(1 − e−(−Sl ) ) , but there are an
infinite number of such solutions.
Thus far we have shown that given a fitness trajectory from an epistatic fitness landscape,
we can construct a non-epistatic fitness landscape whose fitness trajectory has the same shape,
i.e. one that differs from the target fitness trajectory by an additive constant. In order to match
the fitness trajectory exactly, we need to be able to choose the term in parentheses in Equation 6
to be equal to f (∞). But this, too, is always possible to do, because we can freely choose the
initial fitness f (0) and the sum over sites has some definite value fixed by our previous choice
of Sl , µl and νl , i.e. we can always use the solution
X
αl
.
(9)
f (0) = f (∞) −
Sl
αl + βl
l
7

To summarize, we have shown that given an arbitrary epistatic fitness landscape and choice
of initial genotype, we can always construct a non-epistatic fitness landscape that will produce
the exact same mean fitness trajectory. In other words, the presence of epistasis does not expand
the range of possible dynamics of expected fitness gains over time. As a result, one cannot infer
whether epistasis is present or absent from the mean fitness trajectory alone.

2.2.2

Practical analysis

The preceding formal analysis suggests a number of natural questions concerning the features of non-epistatic fitness landscapes that produce the same fitness trajectory as a focal
epistatic landscape.
First, it is worth noting that that the non-epistatic landscapes constructed above will typically be much larger than the focal epistatic landscape. For instance, if the focal landscape
has L sites and 2L genotypes, the corresponding non-epistatic fitness landscape with the same
fitness trajectory produced by the method described above will generically have 2L − 1 sites and
L
therefore 22 −1 genotypes. It is thus natural to ask how closely a non-epistatic landscape of the
same size as the original landscape can match the mean fitness trajectory.
To address this question we considered the class of LK landscapes (Kauffman and Weinberger, 1989; Kauffman, 1993) with L = 10. For such landscapes, L controls the number of
sites and K controls the ruggedness of the landscape, so that K = 0 produces a non-epistatic
landscape and K = L − 1 produces an uncorrelated (i.e. house of cards) landscape. We constructed these landscapes as described in the original publications (Kauffman and Weinberger,
1989; Kauffman, 1993), but multiplied all fitnesses by a constant chosen so that for the nonepistatic case (K = 0) the expected value of |Sl | equals 5; and we set the forward- and backmutation rates at each site equal to unity. For each landscape we constructed, we picked an
initial genotype and then calculated the resulting values for the mean fitness trajectory at intervals of 0.01 time units, until reaching the final time of 10 units. So as to focus on cases of
adaptive evolution, we retained only those landscapes for which the increase in expected fitness
over this time period was at least 10 in units of scaled fitness, and we continued to generate
landscapes until we had 100 such landscapes for each value of K = 1, 2 and 9. These mean
fitness trajectories were then fit to a model of the form given in Equation 6 using non-linear
least squares.
Our mathematical results above guarantee that we can exactly match the mean fitness trajectory of any such LK landscape using a non-epistatic landscape on 1, 023 sites. But how well
can we match the mean fitness trajectory using only 10 sites? Table 1 shows that we can often match the mean fitness trajectory quite well, even constrained to additive landscapes on the
same number (L = 10) of sites. For instance, for uncorrelated fitness landscapes (K = 9), the
average R2 for our hundred fits was .999943, and the average for the maximum absolute error
8

K
1
2
9

Mean R2
.999995
.999993
.999943

Mean max error
.027
.029
.098

Mean max % error
.10 %
.08 %
.38 %

Mean fitness range
33.0
35.5
30.5

Table 1: Fitting the mean fitness trajectories from LK landscapes using non-epistatic landscapes of the same size. The maximal error is the maximum absolute value of the error at any
time point. The fitness range is the maximum value of the mean fitness trajectory at any time
point minus the minimum value of the mean fitness trajectory at any time point. The percent
error is the maximal error divided by the fitness range.
at any time point was .098 in units of scaled fitness. To put this latter number in perspective, the
mean of the total range of scaled fitnesses displayed during these mean trajectories was 30.5, so
that the error is only a very small fraction of the total change in fitness.
In addition to these simulation results, we prove in the Supporting Information that given m
sites, one can always construct a non-epistatic landscape such that the maximum absolute error
in the mean fitness trajectory compared to an arbitrary epistatic landscape is bounded from
above by
s
Varπ F
1
,
(10)
m+1
π(i)
where Varπ F is the variance in fitness at equilibrium and π(i) is the equilibrium frequency
of the initial genotype for the epistatic landscape. Furthermore, it is worth noting that many
theoretical fitness landscapes have symmetries that reduce the number of sites needed to exactly match the mean fitness trajectory using a non-epistatic landscape, e.g. models where the
fitnesses and mutation rates depend only on the Hamming distance from some focal genotype (Kimura and Maruyama, 1966; Kondrashov, 1988), whose mean fitness trajectories can
always be matched by a non-epistatic landscape of the same size.
Second, one might be concerned that although the method presented above of constructing a
non-epistatic landscape with a specified mean fitness trajectory is formally valid, the necessary
mutation rates and selection coefficients would not be biologically realistic. To show that one
can closely approximate many fitness trajectories with a small number of site, each of which
has a realistic selection coefficient and mutation rate, we fit the same set of LK landscapes
with the constraint that for each site the forward and backward mutation rates were equal. For
negative terms in the sum of exponentials fit, this constraint uniquely specifies the corresponding
selection coefficient and mutation rate. For positive terms, this constraint imposes an upper
bound on the size of the terms and otherwise allows two solutions for the pair µl , Sl ; the pair
was chosen so as to minimize µl .
Table 2 shows that these constrained fits still typically match the fitness trajectory very
9

closely, if not quite as well as the unconstrained fits in Table 2, e.g. for K = 9, the mean R2 was
.999883 instead of .999943. Furthermore, the selection coefficients of these fitted landscapes
are reasonable, with mean |Sl | approximately 4 for the non-epistatic models. The total mutation
rates necessary to achieve these fits were on average approximately 3 times the total mutation
rate of the corresponding epistatic landscapes.
Third, there is a question about the role of mutation in the above theory. While allowing the
site-specific mutation rates to be asymmetric is not necessary to ensure the existence of a nonepistatic landscape that can “spoof” the mean fitness trajectory, it is necessary that the mutation
rates are allowed to differ from site to site. At a mathematical level, this is necessary to allow the
initial deviation from the equilibrium fitness contribution of a site and the rate at which that site
approaches equilibrium to be varied independently. At an intuitive level, small mutation rates
are being used to mimic the effects on expected fitness of complex aspects epistatic evolutionary
dynamics, such as the waiting time to cross fitness valleys.
It should be noted that requiring symmetric mutation rates limits the size of the ck that can
be accounted for by a single non-epistatic site (in particular, the greatest value ck that can be
accounted for by a single site is .278, which occurs when Sl = −1.28; negative values of ck
can be matched regardless of their magnitude). However, one can still construct a non-epistatic
landscape to match the mean fitness trajectory of an arbitrary epistatic landscape by having
multiple sites corresponding to a single term in Equation 4. In particular, one can generalize
Equation 7 to
X
αl
(11)
ck = −
Sl
α l + βl
l∈L
k

where Lk is the set of sites in the non-epistatic fitness landscape corresponding to the term
ck e−λk t in Equation 4, and αl + βl = λk for all l ∈ Lk . Note that this flexibility of using additional sites means that one can alter the higher moments of the time-dependent fitness distribution of a non-epistatic fitness landscape while keeping the mean (i.e. mean fitness trajectory)
unchanged.

2.3

Variance trajectories

We have seen that any mean fitness trajectory produced by an epistatic fitness landscape
can also be produced by a non-epistatic fitness landscape. However, the mean fitness trajectory
captures only the central tendency of population fitness through time. If we initiate many replicate populations fixed for the same genotype, then it is likely that some populations will adapt
more quickly than others, so that there will typically be variation in fitness across populations
at any given time t > 0. Aside from the mean, discussed above, it is natural to ask whether
the presence of epistasis increases the diversity of the possible dynamics of the inter-population
variation in fitness.
10

11

Mean R2
.999950
.999942
.999883

Mean max error
.101
.085
.155

Mean max % error
.32 %
.26 %
.69 %

Mean fitness range
33.0
35.5
30.5

Mean |Sl |
4.1
4.3
4.5

Mean total mutation rate ratio
3.1
3.4
3.0

Mean[(Max µl , Min µl )]
(10.8, 0.14)
(13.9, 0.06)
(11.6, 0.02)

Table 2: Fitting the mean fitness trajectories from LK landscapes using non-epistatic landscapes of the same size with
symmetric mutation rates (µl = νl for all l). Maximal error, fitness range and percent error are defined
P the same way as in
Table 1. The total mutation rate ratio is the total mutation rate in the inferred non-epistatic landscape ( l µl ) divided by the
total mutation rate in the original epistatic landscape.

K
1
2
9

To make this idea more precise, let us consider the fitness of a population at time t as a
random variable. The variance of this random variable viewed as a function of time is called the
“variance trajectory”, v(t). In other words, the variance trajectory is the time evolution of the
second central moment of the fitness distribution, across an ensemble of replicate populations.
We would like to know whether the set of variance trajectories that can be achieved by
epistatic fitness landscapes is more diverse than the set that can be achieved by non-epistatic
fitness landscapes. To answer this question, we will first use the standard solution for a twostate Markov chain to write down the variance trajectory for a single site:

2 



β
α
−(α+β)t
−2(α+β)t
−(α+β)t
,
(12)
+ e
−e
1−e
v(t) = S
α+β
α
assuming without loss of generality that the population starts in the first state. It is easy to show
that the first derivative of v(t) with respect to time is maximized at t = 0, since the derivatives
of both 1 − e−t and e−t − e−2t are maximized at t = 0. Thus, the rate that variance in fitness
increases takes its maximum at t = 0, which makes sense, because at t = 0 the fitness of the
alternative state is maximally different from the current mean fitness, and the increase in the
frequency of the alternative state is also maximized (because back-substitutions cannot occur at
time t = 0).
The variance trajectory of a non-epistatic fitness landscape is simply the sum of the variance trajectories across all sites (because variances can be summed when random variable are
independent). Now, because the slope of the variance trajectory is maximized for each site at
t = 0, it follows that the slope of the variance trajectory is maximized at t = 0 for any finite, non-epistatic fitness landscape. Furthermore, because the slope is maximized at t = 0,
it follows that the second derivative of the fitness trajectory must be negative at t = 0. In
other words, all non-epistatic fitness landscapes share a fundamental qualitative feature: their
variance trajectories are concave at short times.
Are variance trajectories for all epistatic fitness landscapes also concave at short times? The
answer is no. For instance, consider a two-site fitness landscape with genotypes ab, Ab, aB, and
AB, and µl = νl = 1 for both sites, with a population initially fixed for genotype ab. Suppose
the fitnesses of ab, Ab and aB are all equal but genotype AB has fitness advantage S over the
other three genotypes. The first derivative of the resulting variance trajectory
 at t = 0 (i.e.,
v 0 (0)) is zero, and the second derivative at t = 0 (i.e. v 00 (0)) is S 3 / 1 − e−S , which is positive
for S 6= 0. Thus, for any such landscape with S 6= 0, the variance trajectory is convex at short
times—a feature that cannot be achieved by any non-epistatic landscape.
As illustrated by the example above, the range of possible dynamics for the variance trajectory is larger for epistatic landscapes than for non-epistatic landscapes. And so it may be
possible to infer epistasis from the pattern of variance in fitness across populations, even though
it is impossible to do so from the pattern of mean fitness alone.
12

A

B

10

Fitness

AB

5

C2

C2
ab

Ab & aB

0

5

C1

 10
 10

5

0

C1

5

10

Figure 3: Epistatic fitness landscapes can produce dynamics that differ from all non-epistatic
landscapes. (A) We consider two-site landscapes with genotypes ab, Ab, aB, and AB, with the
population initially fixed for ab. Assigning Ab and aB equal fitnesses, we let C1 be the selection
coefficient of Ab and aB relative to ab and let C2 be the selection coefficient of AB relative
to Ab and aB. We set the mutation rates to be µl = νl = 1 for both sites. (B) Properties of
two-site fitness landscapes using the parameterization described in the previous panel. The dark
gray region shows the set of landscapes whose variance trajectories are convex at t = 0. The
light gray region shows the set of landscapes whose equilibrium substitution rates are greater
than twice their initial substitution rates. The diagonal dashed line with positive slope shows
the set of non-epistatic fitness landscapes, whereas the diagonal dashed line with negative slope
shows the set of epistatic landscapes whose fitness dynamics cannot be distinguished from the
non-epistatic case.
To explore the range of epistasic landscapes that produce variance trajectories that are convex at short times, we considered the two-site landscapes described above, but allowed Ab and
aB to have some selection coefficient relative ab, and also allowed AB to have some other selection coefficient relative to Ab and aB (i.e. genotypes with equal hamming distances from ab
are assigned equal fitnesses). The dark gray region in Figure 3 shows the subset of landscapes
whose the variance trajectories are convex at short times. Although this region is primarily
composed of landscapes with positive epistasis (above the line y=x), it is also possible to have
convex variance trajectories for landscapes with negative epistasis (below the line y=x) when
the selection coefficient of the first mutation is small.
We have seen that some epistatic fitness landscapes produce variance trajectories that cannot be achieved by any non-epistatic fitness landscapes. Thus, we have shown that one can
sometimes tell that a fitness landscape is epistatic by observing its time-dependent fitness distri-

13

bution. However, one might wonder whether given the time-dependent fitness distribution it is
always possible to distinguish epistatic from non-epistatic fitness landscapes. The answer is no.
As a counter-example, consider again the two-site case in which Ab and aB have equal fitness.
If the selection coefficient of ab relative to Ab and aB is equal to the selection coefficient of AB
relative to Ab and aB, then the entire fitness distribution can be matched by a single-site fitness
landscape. These landscapes are illustrated by the dashed line with negative slope in Figure 3.
Thus, there is no characteristic of the time-dependent fitness distribution that can be used to
distinguish all epistatic landscapes from all non-epistatic fitness landscapes.
Another natural question, in light of our earlier results on fitness trajectories, concerns the
relationship between the mean fitness trajectory and the variance trajectory, for a given landscape. Within the class of non-epistatic landscapes, it is easy to show that the variance and
mean fitness trajectories can be modified essentially independently of each other. This is because the variance in fitness can be made arbitrarily small while preserving the fitness trajectory
by replacing single sites of large fitness effect with many sites of small effects; on the other
hand, the variance in fitness can be made arbitrarily large without altering the fitness trajectory
by constructing pairs of sites whose site-specific fitness trajectories cancel each other out, but
which still contribute to the time-evolution of the variance. As a result, considering the fitness
and variance trajectories jointly is likely to provide little more information about the presence
of epistasis than considering the variance trajectory alone.

2.4

Substitution trajectories

Changes in fitness during adaptation are the result of substitutions – that is, mutations at
individual sites that eventually reach fixation in the population. Therefore, aside from studying
the expected fitness of a population, it is also interesting to consider the the number of substitutions that accumulate in a population over time. For instance, consider the time-evolution of the
expected number of substitutions that have accumulated in the population by time t, what we
call the “substitution trajectory”, s(t) (Kryazhimskiy et al., 2009). Just as we did for mean fitness trajectories, we want to ask whether the set of possible substitution trajectories for epistatic
fitness landscapes is more diverse than the set of possible substitution trajectories in the absence
of epistasis.
To study the substitution trajectory, it is helpful to note that the derivative of the substitution
trajectory is equal to the expected substitution rate at time t, which we will write as q(t). That is,
s0 (t) = q(t). Because no substitutions have accumulated at time 0, this relation means that the
substitution trajectory is fully specified by the time-dependent expected rates of substitution.
Consider the time-dependent rate of substitution at a single site. Assuming without loss
of generality that the population begins in the first state, and using the standard solution for a
14

two-state Markov chain, the expected substitution rate is given by:
q(t) =

2αβ
α
−
(β − α)e−(α+β)t ,
α+β α+β

(13)

where the first term on the right-hand side is the equlibrium rate of substitution, q(∞). The
initial substitution rate is α, and so the ratio between the equilibrium substitution rate and the
initial substitution rate is q(∞)/q(0) = 2β/(α + β) – a ratio than can never exceed 2, which
is the value achieved in the limit as β/α → ∞. Indeed, because the expected substitution rate
approaches its equilibrium value monotonically, we also have a stronger result: the expected
substitution rate can never be less than half of its equilibrium rate, i.e. q(∞)/q(t) ≤ 2.
For a non-epistatic landscape, the expected substitution rate is simply a sum of rates at each
of its constituent sites. Using the inequality developed above, we thus have:
P
ql (∞)
q(∞)
(14)
= Pl
ql (t)
q(t)
l
P
2 ql (t)
≤ Pl
(15)
l ql (t)
= 2,
(16)
where ql (t) is the expected substitution rate at the l-th site at time t. In words, for any finite-state
non-epistatic fitness landscape, the ratio between the equilibrium rate and the expected rate at
any time can never exceed two.
For epistatic landscapes, by contrast, it is easy to see that this condition on the substitution
rate can be violated. For instance, consider a fitness landscape with three or more sites in which
all genotypes have the same fitness. Then, pick an initial genotype, and alter the fitnesses of
its mutational neighbors such that these neighbors now have selection coefficient S relative to
the initial genotypes, where we choose S to be negative. That is, consider a neutral plateau
and modify it by constructing a fitness valley around the initial genotype. As the depth of this
valley increases (i.e. as S approaches −∞), the initial substitution rate converges to 0, while the
equilibrium substitution rate approaches some non-zero constant. This means that by choosing
S to be sufficiently large and negative the ratio between the equilibrium substitution rate and the
initial substitution rate can be made arbitrarily large and, in particular, larger than two. (While
no adaptation occurs in this example – the mean equilibrium fitness is lower than the initial
fitness – this defect is easy to correct by giving a fitness advantage to genotypes of distance
two or more from the initial genotype). Thus, we conclude that the set of possible substitution
trajectories is indeed enlarged by the presence of epistasis.
The light gray region in Figure 3 illustrates this fact, by indicating the set of two-site fitness
landscapes whose ratios of equilibrium to initial expected substitution rates exceeds 2. Roughly
speaking, this region corresponds to landscapes with a fitness valley, with population initialized
15

on the fitter of the two peaks. Note that the light gray region does not extend all the way to the
landscapes in which the two peaks have equal heights: these landscapes (dashed diagonal line
with negative slope) have substitution trajectories of precisely the same form as a single site,
and therefore the ratio of rates must be less than or equal to 2 along this line. More generally,
the adaptive situation most likely to produce initial substitution rates that are less than half
the equilibrium substitution rate is a population that is currently at an isolated local fitness
maximum, but which, after crossing a fitness valley, will spend most of its time on a broad, high
fitness plateau.
Why is the range of dynamics of mean fitness identical for epistatic and non-epistatic landscape, but not the range of dynamics of the mean number of substitutions? One way to understand these results is to notice that, because mutation can oppose or augment selection, two
non-epistatic landscapes with different fitness functions and different mutation rates might still
have the same evolutionary dynamics in genotype space (i.e. the same rate matrix, Q). As a
consequence, for each non-epistatic matrix Q and choice of starting genotype, there is a large
class of possible fitness trajectories, determined by the choices of the site-specific selection coefficients Sl . In contrast, having specified the matrix Q and the initial genotype completely
determines the substitution trajectory. The extra flexibility produced by choosing Q and the
Sl independently allows non-epistatic fitness landscapes to produce fitness trajectories whose
dynamics are as general as the time-evolution of the expectation of an arbitrary function defined
on an arbitrary finite-state reversible Markov chain.
For completeness, we can also consider the ensemble variance in substitution rate as a function of time. The derivative of this trajectory is maximized at t = 0, just as the derivative of the
variance in fitness is as well. While this criterion can be used to identify some fitness landscapes
as epistatic, the time evolution of the variance in substitution rate is much more difficult to observe than the time evolution of the mean substitution rate or the time evolution of the fitness
distribution, and so we will not discuss the matter further here.

2.5

Equilibrial dynamics

Although our main focus has been adaptation, it is also interesting to consider whether
epistatic and non-epistatic landscapes differ in the range of dynamics they can produce at equilibrium, i.e. in the limit of long times when all influence of the choice of initial genotype has
been lost. We study the equilibrial dynamics by again considering an ensemble of replicate
populations. However, instead of assuming that all of these populations are initially fixed at
a single genotype, we assume that the initial genotype for each population is drawn from the
equilibrium distribution, that is, the distribution that gives the probability of a population being
fixed for any given genotype in the limit of long times.

16

An ensemble of populations that is initially distributed according to the equilibrium distribution will continue to be described by the equilibrium distribution at all future times. Hence
the expected fitness, the variance for fitness, and indeed all moments of the fitness distribution
are constant in time. Indeed, the equilibrium fitness distribution is determined solely by the fitnesses of the individual genotypes together with their equilibrium frequencies, and it is therefore
independent of the structure of the fitness landscape in the sense that the structure of mutational
adjacency is irrelevant (see McCandlish, 2011, pg. 1547). Because the equilibrium distribution
remains constant in time and each genotype has its own substitution rate, substitutions likewise
accumulate at a constant rate across the ensemble as a whole.
However, while the fitness distribution across the ensemble remains constant in time, individual populations in the ensemble will still experience changes in fitness. We can study the
structure of these changes by studying the correlations between the fitness of a population at one
time and its fitness at another. In particular, we consider the covariance in fitness between time
t0 and some later time t0 + t, where again the genotype at time 0 is drawn from the equilibrium
distribution. Viewed as a function of the difference, t between these two times, this covariance
is known as the equilibrium autocovariance for fitness, denoted a(t). In the Supporting Information, we show that the equilibrium autocovariance for an arbitrary epistatic fitness landscape
has the form:
n
X
dk e−λk t ,
(17)
a(t) =
k=2

where d2 , d3 , · · · ≥ 0 and λ2 , λ3 , . . . > 0.
For comparison, let us know consider the autocovariance for non-epistatic landscapes, considering first a landscape with a single site with selection coefficient S. In this case the equilibrium autocovariance for fitness is given by
a(t) = S 2

αβ
e−(α+β)t .
(α + β)2

(18)

The autocovariance of a sum of independent processes is the sum of the corresponding autocovariances, and the term S 2 αβ/(α + β)2 can assume any non-negative value even with a fixed
value of λk = α + β. This implies that, given the equilibrium autocovariance function for an
epistatic fitness landscape, one can always construct a non-epistatic landscape with an identical
equilibrium autocovariance function by assigning one site to correspond to each term in Equation 17. Thus, while the presence of epistasis increases the possible dynamics for the second
moment of fitness for an adapting population, epistatic and non-epistatic fitness landscapes have
the same range of possible dynamics for the equilibrium autocovariance in fitness.

17

3

Discussion

How does the structure of the fitness landscape influence the dynamics of adaptation? Here
we have studied this question by identifying dynamical phenomena that can occur when epistasis is present but that cannot occur when epistasis is absent. We have considered the evolution
of populations under weak mutation on arbitrary fitness landscapes defined on a finite number
of bi-allelic sites. For each of several basic descriptors of adaptation—e.g. the expected fitness
or number of substitutions accrued over time—we have asked whether the dynamics that are
possible on epistatic fitness landscapes are more diverse than those possible on non-epistatic
landscapes. The results are surprisingly heterogeneous.
The most basic and essential descriptor of adaptation is the mean fitness trajectory—that
is, the expected pattern of fitness gains over time. In contrast to the received wisdom that
the presence or specific form of epistasis can alter the mean pattern of adaptation over time
(e.g. epistasis “accelerating” or “de-accelerating” adaptation, Chou et al., 2011; Khan et al.,
2011; Kryazhimskiy et al., 2011), we have shown that the set of possible mean fitness trajectories for epistatic fitness landscapes is no more diverse than for non-epistatic fitness landscapes.
In particular, any mean fitness trajectory that can be achieved on an epistatic fitness landscape
can also be acheived by an infinite number of non-epistatic fitness landscapes. Furthermore,
while our analytical results show that the number of sites needed to exactly match the mean fitness trajectory with a non-epistatic fitness landscape is typically much larger than the number of
sites in the original fitness landscape, our numerical results on LK landscapes (Kauffman and
Levin, 1987; Kauffman and Weinberger, 1989; Kauffman, 1993) suggest that the mean fitness
trajectories of even highly rugged fitness landscapes may often be closely approximated by the
mean fitness trajectories of non-epistatic landscapes with the same number of sites.
In contrast to the mean fitness trajectory, we have shown that the time-evolution of the
variance in fitness across populations can display qualitatively different behavior on epistatic
landscapes than can be achieved in the absence of epistasis. Likewise, the pattern of the expected number of substitutions accrued over time can also be qualitatively different on epistatic
fitness landscapes than possible on non-epistatic landscapes.
These results have implications for efforts to infer the prevailing form of epistasis by experimentally observing the evolutionary dynamics in an ensemble of replicate populations (Lenski
et al., 1991; Lenski and Travisano, 1994; Kryazhimskiy et al., 2009; Wiser et al., 2013; Good
and Desai, 2014). Such an approach is appealing because while epistasis is easy to detect by
considering combinations of mutations directly (e.g. Chou et al., 2011; Khan et al., 2011), inferences about the prevailing form of epistasis based on small samples of mutations can be strongly
misleading (Blanquart et al., 2014), particularly when the mutations chosen are those that fixed
during adaptation (Draghi and Plotkin, 2013). Efforts to infer the global form of epistasis using
random mutagenesis (e.g. Olson et al., 2014; Bank et al., 2015) suffer from other difficulties,
18

such as only giving information about epistasis in a local region of sequence space or between
mutations that are too deleterious to ever fix. Inferring the form of epistasis from the trajectories observed during experimental evolution overcomes these difficulties because the mutations
sampled by evolving populations are precisely the mutations most relevant to the evolutionary
process.
Existing approaches to infer the form of epistasis from experimental trajectories typically
consist of fitting a handful of simple epistatic and non-epistatic models to the observed data (e.g.
Kryazhimskiy et al., 2009; Wiser et al., 2013; Good and Desai, 2014). However, as emphasized
by Frank (2014), all we can really infer from such an approach is the set of models consistent
with the observed dynamics. Our results show that, for populations under weak mutation, the
shape of the mean fitness trajectory alone can never be used to infer the presence or form of
epistasis, even with an unlimited number of replicate experimental populations. Epistasis is
not identifiable by these type of data because any mean fitness trajectory that can occur on an
epistatic landscape is consistent with some non-epistatic landscape as well. On the other hand,
the variance and substitution trajectories can in principle sometimes allow us to conclude that
epistasis must be present. Indeed, our results on the variance trajectory confirm the conjecture
by Lenski et al. (1991) that the time-evolution of the variance in fitness across replicate populations can be used to detect epistasis. The simple intuition underlying our analysis is that positive
epistasis can cause the slope of the variance trajectory to increase as time elapses, whereas when
epistasis is absent the slope of the variance trajectory is always maximized at t = 0.
While our results on variance and substitution trajectories suggest possibilities for empirical
tests of epistasis, there still remain several obstacles to developing rigorous and practical tests
for the presence and form of epistasis from these types of data. First, the results presented here
are based on the assumption that we have access to an infinite ensemble of individual populations, whereas in practice we only have a finite sample of populations. Such a finite sample
produces a number of technical complications, such as the fact that errors in the estimation of
the expected trajectories will be correlated across time points (Good and Desai, 2014). Another
complication is that, strictly speaking, under our model the sample means will be piecewise constant, and therefore the derivatives that we have studied here cannot be calculated directly from
the sample means. Second, there is the issue of measurement error, which we have neglected
in our treatment. Third, there are questions of power. While Figure 3 shows that many simple fitness landscapes would produce substitution and variance trajectories incompatible with a
non-epistatic model, we suspect our compatibility criterion for the substitution trajectory may
be less informative in more realistic landscapes, both because of neutral substitutions (which
will make the initial and equilibrium substitution rates more similar) and because of the general
intuition that substitution rates should be decreasing during adaptation as the supply of beneficial mutations is exhausted. Tests of epistasis based on the variance trajectory or a combination
of the substitution and fitness trajectories (c.f. Good and Desai, 2014) may provide better avenues for future research. Indeed, the variance trajectory may be particularly well-suited for
detecting situations where neutral potentiating mutations are required before substantial adap19

tation is possible (Wagner, 2008, 2011; Draghi et al., 2010; Bloom et al., 2010). Finally, while
our results here assume that mutation is weak, most experimental evolution involves large microbial populations in the regime of clonal interference (Gerrish and Lenski, 1998). Thus, it is
possible that existing experimental mean fitness trajectories (e.g. Wiser et al., 2013) may contain information about the presence of epistasis. However, without a comparable demonstration
that epistasis is indeed identifiable from the mean fitness trajectory for such populations, our
negative results under weak mutation suggest extreme caution in using empirical mean fitness
trajectories to argue for or against the hypothesis that epistasis is present or to estimate the
prevailing form of epistasis.
Two recent theoretical studies have also analyzed the relationship between the presence or
absence of epistasis and the dynamics of adaptation under weak mutation. Kryazhimskiy et al.
(2009) considered the space of fitness landscapes in which the distribution of mutational effects
on fitness (DFE) is solely a function of the current fitness of the population, and they concluded
that it is possible to identify epistasis from the mean fitness trajectory. On the whole, the class
of models studied by Kryazhimskiy et al. (2009) is much broader than the one considered here
(since any finite-state fitness landscape can be arbitrarily well approximated in their framework
so long as each genotype has a unique fitness), and it includes many models that are inconsistent
with finite-site landscapes. In particular, Kryazhimskiy et al. (2009) considered a fitness landscape to be non-epistatic if its DFE is independent of the population’s fitness. Such a situation
can never arise on a non-trivial finite-site landscape, because the DFE must be entirely negative
at the fittest genotype and entirely positive at the least-fit genotype. Our results are thus complementary to those of Kryazhimskiy et al. (2009), and we conclude that while the shape of the
fitness trajectory may be informative in distinguishing between various models in their broader
class, it is not informative for the narrower set of models corresponding to finite-site fitness
landscapes. It is also worth noting that the analytical results presented by Kryazhimskiy et al.
(2009) are approximations that hold only for a relatively limited subset of models within this
broader class (see van Kampen, 2007, pp. 124–127), whereas the analytical results presented
here are exact and apply to arbitrary fitness landscapes with a finite number of biallelic sites.
Good and Desai (2014) also present results on the diversity of mean fitness and substitution trajectories that can be produced by non-epistatic fitness landscapes, but they assume that
selection is strong so that deleterious mutations cannot fix. Under strong selection and weak
mutation Good and Desai (2014) found that non-epistatic landscapes can produce only a subset
of possible mean fitness trajectories (these trajectories correspond to the case with all ck ≤ 0
in our Equation 4). In contrast, here we have allowed for the possibility of deleterious substitutions and we have shown that any mean fitness trajectory that can be produced by an epistatic
landscape can also be produced by a non-epistatic landscape.
This difference arises from the assumption of strong selection, which changes the basic character of the evolutionary dynamics (see also McCandlish et al., 2014). Under our model, each
site in a non-epistatic fitness landscape independently approaches a mutation-selection-drift
20

equilibrium (Bulmer, 1991). At this equilibrium, the expected fitness and substitution rate can
be either lower or higher than the initial fitness and substitution rate. In contrast, under strongselection weak-mutation, each site in a non-epistatic fitness landscape results in exactly one
beneficial substitution, and all evolution comes to a halt when the population reaches the fittest
genotype. Thus, the rate of adaptation must be decreasing in time as the finite supply of beneficial mutations becomes exhausted; the same is true of the substitution rate. This greatly constrains the set of mean fitness and substitution trajectories that can be produced by non-epistatic
fitness landscapes under strong-selection weak-mutation. Good and Desai (2014) also derive a
necessary relation between the substitution and mean fitness trajectories for non-epistatic landscapes when mutation rates are uniform across sites, but show in their supplementary material
that this relationship breaks down if different sites are permitted to have different mutation rates.
While most of our results have focused on adaptive evolution, we also studied the nearlyneutral dynamics of a population evolving at equilibrium on a time-invariant fitness landscape.
In particular, we showed that the autocovariance function for fitness of such a population cannot
be used to determine whether a fitness landscape is epistatic or not. This result is in contrast
to the autocovariance function of a completely random walk on the space of genotypes, whose
characteristics have long been used to quantify the “ruggedness” of fitness landscapes (Weinberger, 1990, 1991; Stadler, 2003).
One potential limitation of our analysis is that we have considered fitness landscapes composed of only bi-allelic sites. This assumption does not, in fact, influence our results on the
space of dynamics possible under epistatic landscapes. This is because, as shown in the Supporting Information, our results for epistatic fitness landscapes hold for any time-independent,
finite-state fitness landscape whose neutral mutational dynamics take the form of a reversible
Markov chain (see, e.g. Sella and Hirsh, 2005; McCandlish, 2011). Thus, our results on epistatic
dynamics apply also to models with more than two alleles per site (so long as the mutational
dynamics within a site form a reversible Markov chain); and, indeed, they even apply when the
genotypic space cannot be decomposed into individual sites. But our assumption of bi-allelic
sites does influence our analysis of non-epistatic models, because our strategy for determining
the behavior of such models has been to sum over the dynamics of independently evolving sites.
The dynamics at a single site can be more complex when there are more than two alleles, and
so the dynamics that are possible under multi-allelic finite-site non-epistatic fitness landscapes
are more diverse than those described here for non-epistatic models with bi-allelic sites. Thus,
all our negative results concerning whether epistatic models have more diverse dynamics than
non-epistatic models (such as our main result on the mean fitness trajectory) continue to hold
for multi-allelic models, but our positive results (such as our results on the variance trajectory)
may no longer apply.
Another important limitation of our analysis is that we have considered the evolutionary dynamics only under weak mutation. This is because under weak mutation sites that do not interact epistatically evolve independently. However, for finite polymorphic populations with linked
21

sites, even sites that do not interact epistatically have dynamics that are non-independent due to
hitch-hiking and background selection. This non-independence makes it extremely difficult to
provide a full treatment of even non-epistatic dynamics for finite, polymorphic populations. In
the absence of analytical results, it is tempting to try to address the role of epistasis for finite
polymorphic populations through simulation. However, the enormity of the space of possible
fitness landscapes means that any such approach will be restricted to a tiny subset of fitness
landscapes, and so it cannot definitively answer the types questions that we have addressed
here.

4

Acknowledgements

We thank Richard Lenski, Noah Ribeck, Bjørn Østman, Benjamin Good and Michael Desai
for helpful discussion, and Thomas Lenormand, Sylvain Glémin and two anonymous reviewers
for their comments on the manuscript. We acknowledge funding from the Burroughs Wellcome Fund, the David and Lucile Packard Foundation, the James S. McDonnell Foundation,
the Alfred P. Sloan Foundation, the U.S. Department of the Interior (D12AP00025), and the
U.S. Army Research Office (W911NF-12-1-0552).

22

References
Bank, C., R. T. Hietpas, J. D. Jensen, and D. N. Bolon, 2015. A systematic survey of an
intragenic epistatic landscape. Molecular biology and evolution 32:229–238.
Berg, J., S. Willmann, and M. Lassig, 2004. Adaptive evolution of transcription factor binding sites. BMC Evol. Biol. 4:42. URL http://www.ncbi.nlm.nih.gov/pubmed/
15511291.
Blanquart, F., G. Achaz, T. Bataillon, and O. Tenaillon, 2014. Properties of selected mutations
and genotypic landscapes under fisher’s geometric model. Evolution 68:3537–3554.
Bloom, J. D., L. I. Gong, and D. Baltimore, 2010. Permissive secondary mutations enable the
evolution of influenza oseltamivir resistance. Science 328:1272–1275.
Bulmer, M., 1991. The selection-mutation-drift theory of synonymous codon usage. Genetics
129:897–907.
Chou, H.-H., H.-C. Chiu, N. F. Delaney, D. Segrè, and C. J. Marx, 2011. Diminishing returns
epistasis among beneficial mutations decelerates adaptation. Science 332:1190–1192.
Draghi, J. A., T. L. Parsons, G. P. Wagner, and J. B. Plotkin, 2010. Mutational robustness can
facilitate adaptation. Nature 463:353 – 355.
Draghi, J. A. and J. B. Plotkin, 2013. Selection biases the prevalence and type of epistasis along
adaptive trajectories. Evolution 67:3120–3131. URL http://dx.doi.org/10.1111/
evo.12192.
Fisher, R. A., 1918. The correlation between relatives on the supposition of mendelian inheritance. Transactions of the royal society of Edinburgh 52:399–433.
———, 1930. The Genetical Theory of Natural Selection. Clarendon Press, London.
Fontana, W. and P. Schuster, 1998. Continuity in evolution: on the nature of transitions. Science
280:1451 – 1455.
Frank, S. A., 2014. Generative models versus underlying symmetries to explain biological
pattern. Journal of evolutionary biology 27:1172–1178.
Gerrish, P. and R. Lenski, 1998. The fate of competing beneficial mutations in an asexual
population. Genetica 102-103:127 – 144. URL http://dx.doi.org/10.1023/A:
1017067816551. 10.1023/A:1017067816551.
Good, B. H. and M. M. Desai, 2014. The impact of macroscopic epistasis on long-term evolutionary dynamics. Genetics URL http://www.genetics.org/content/early/
2014/11/12/genetics.114.172460.abstract.
23

Hartl, D. L., 2014. What can we learn from fitness landscapes? Current opinion in microbiology
21:51–57.
Iwasa, Y., 1988.
Free fitness that always increases in evolution.
J. Theor. Biol.
135:265 – 281. URL http://www.sciencedirect.com/science/article/
pii/S0022519388802431.
Jain, K. and J. Krug, 2007. Deterministic and stochastic regimes of asexual evolution on rugged
fitness landscapes. Genetics 175:1275 – 1288.
Kammler, D. W., 1976. Chebyshev approximation of completely monotonic functions by sums
of exponentials. SIAM Journal on Numerical Analysis 13:761–774.
van Kampen, N. G., 2007. Stochastic Processes in Physics and Chemistry. Third edition ed.
Elsevier, Amsterdam.
Kauffman, S. and S. Levin, 1987. Towards a general theory of adaptive walks on rugged landscapes. J. Theor. Biol. 128:11 – 45.
Kauffman, S. A., 1993. The Origins of Order: Self Organization and Selection in Evolution.
Oxford Univ. Press, New York.
Kauffman, S. A. and E. D. Weinberger, 1989. The NK model of rugged fitness landscapes
and its application to maturation of the immune response. Journal of theoretical biology
141:211–245.
Khan, A. I., D. M. Dinh, D. Schneider, R. E. Lenski, and T. F. Cooper, 2011. Negative epistasis
between beneficial mutations in an evolving bacterial population. Science 332:1193–1196.
Kimura, M. and T. Maruyama, 1966. The mutational load with epistatic gene interactions in
fitness. Genetics 54:1337.
Kondrashov, A. S., 1988. Deleterious mutations and the evolution of sexual reproduction. Nature 336:435–440.
Kryazhimskiy, S., J. A. Draghi, and J. B. Plotkin, 2011. In evolution, the sum is less than its
parts. science 332:1160–1161.
Kryazhimskiy, S., G. Tkaçik, and J. B. Plotkin, 2009. The dynamics of adaptation on correlated
fitness landscapes. Proc. Natl. Acad. Sci. U. S. A. 106:18638 – 18643. URL http://www.
pnas.org/content/106/44/18638.abstract.
Lenski, R. E., M. R. Rose, S. C. Simpson, and S. C. Tadler, 1991. Long-term experimental
evolution in Escherichia coli. I. adaptation and divergence during 2,000 generations. The
American Naturalist 138:pp. 1315–1341. URL http://www.jstor.org/stable/
2462549.
24

Lenski, R. E. and M. Travisano, 1994. Dynamics of adaptation and diversification: a 10,000generation experiment with bacterial populations. Proceedings of the National Academy of
Sciences 91:6808–6814.
Maynard Smith, J., 1970. Natural selection and the concept of a protein space. Nature 225:563
– 564.
McCandlish, D. M., 2011. Visualizing fitness landscapes. Evolution 65:1544 – 1558. URL
http://dx.doi.org/10.1111/j.1558-5646.2011.01236.x.
McCandlish, D. M., C. L. Epstein, and J. B. Plotkin, 2014. The inevitability of unconditionally
deleterious substitutions during adaptation. Evolution 68:1351 – 1364. URL http://
arxiv.org/abs/1309.1152.
McCandlish, D. M. and A. Stoltzfus, 2014. Modeling evolution using the probability of fixation:
History and implications. The Quarterly Review of Biology 89:pp. 225–252. URL http:
//www.jstor.org/stable/10.1086/677571.
Moran, P. A. P., 1959. The survival of a mutant gene under selection. Journal of the Australian
Mathematical Society 1:121 – 126.
Olson, C. A., N. C. Wu, and R. Sun, 2014. A comprehensive biophysical description of pairwise
epistasis throughout an entire protein domain. Current Biology 24:2643–2651.
Phillips, P. C., 2008. Epistasis—the essential role of gene interactions in the structure and
evolution of genetic systems. Nat. Rev. Genet. 9:855 – 867.
Sella, G. and A. E. Hirsh, 2005. The application of statistical physics to evolutionary biology. Proc. Natl. Acad. Sci. U. S. A. 102:9541 – 9546. URL http://www.pnas.org/
content/102/27/9541.abstract.
Stadler, P. F., 2003. Spectral landscape theory. Pp. 231 – 271, in J. Crutchfield and P. Schuster,
eds. Evolutionary Dynamics: Exploring the Interplay of Selection, Accident, Neutrality and
Function. Oxford Univ. Press, Oxford.
Szendro, I. G., M. F. Schenk, J. Franke, J. Krug, and J. A. G. de Visser, 2013. Quantitative
analyses of empirical fitness landscapes. Journal of Statistical Mechanics: Theory and Experiment 2013:P01005.
de Visser, J. A. G., T. F. Cooper, and S. F. Elena, 2011. The causes of epistasis. Proceedings of
the Royal Society B: Biological Sciences 278:3617–3624.
de Visser, J. A. G. and J. Krug, 2014. Empirical fitness landscapes and the predictability of
evolution. Nature Reviews Genetics .

25

Wagner, A., 2008. Neutralism and selectionism: a network-based reconciliation. Nat. Rev.
Genet. 9:965–974. URL http://dx.doi.org/10.1038/nrg2473.
———, 2011. The Origins of Evolutionary Innovations: A Theory of Transformative Change
in Living Systems. Oxford Univ Pr.
Weinberger, E., 1990. Correlated and uncorrelated fitness landscapes and how to tell the
difference. Biol. Cybern. 63:325 – 336. URL http://dx.doi.org/10.1007/
BF00202749. 10.1007/BF00202749.
———, 1991. Fourier and Taylor series on fitness landscapes. Biol. Cybern. 65:321 – 330.
URL http://dx.doi.org/10.1007/BF00216965. 10.1007/BF00216965.
Weinreich, D. M., Y. Lan, C. S. Wylie, and R. B. Heckendorn, 2013. Should evolutionary
geneticists worry about higher-order epistasis? Current opinion in genetics & development
23:700–707.
Weinreich, D. M., R. A. Watson, and L. Chao, 2005. Perspective: sign epistasis and genetic
costraint on evolutionary trajectories. Evolution 59:1165 – 1174.
Whitlock, M. C., P. C. Phillips, F. B.-G. Moore, and S. J. Tonsor, 1995. Multiple fitness peaks
and epistasis. Annual Review of Ecology and Systematics Pp. 601–629.
Wiser, M. J., N. Ribeck, and R. E. Lenski, 2013. Long-term dynamics of adaptation in asexual
populations. Science 342:1364–1367.
Wright, S., 1931. Evolution in Mendelian populations. Genetics 16:97 – 159.
———, 1932. The roles of mutation, inbreeding, crossbreeding and selection in evolution. in
Proceedings of the Sixth International Congress of Genetics, Pp. 356 – 366.

26

Supporting Information
We proceed in somewhat more generality than in the main text. Suppose that evolution
under mutation alone proceeds as a reversible, continuous-time Markov chain on a finite state
space with rate matrix (infinitesimal generator) QM and equilibrium distribution πM . If the
scaled Malthusian fitness of genotype i is given by F(i), then evolution under weak mutation is
a Markov chain with rate matrix Q whose i, j-th entry is:
(
F(j)−F(i)
for i 6= j
−(F(j)−F(i)) QM (i, j)
1−e
Q(i, j) =
(S1)
P
− k6=i Q(i, k)
for i = j.
It is easy to verify that the equilibrium distribution of this chain is given by the vector π,
where π(i) ∝ πM (i) eF(i) , and that this equilibrium satisfies detailed balance, so that the chain
defined by Q is also reversible. Note that the more limited definition of QM in the main text
based on some finite number of bi-allelic sites with non-zero forward and reverse mutation rates
necessarily results in a reversible Markov chain, since it is simply the rate matrix for a collection
of independent two-state chains with non-zero transition rates, and any two-state continuoustime chain with non-zero transition rates is reversible.
Because the Markov chain defined by Q is reversible, the definition of detailed balance
1/2
−1/2
implies that the matrix Dπ QDπ
is symmetric, where Dx is the diagonal matrix whose
1/2
−1/2
diagonal entries are given by the vector x. We can thus expand Dπ QDπ
in terms of its
eigenvalues and eigenvectors as
−1/2
−D1/2
π QDπ

=

n
X

λk uk ukT ,

(S2)

k=1
1/2

−1/2

where 0 = λ1 < λ2 ≤ λ3 ≤ . . . ≤ λn are the eigenvalues of −Dπ QDπ and the eigenvec−1/2
tors uk form an orthonormal basis of Rn . Multiplying the above equation by Dπ from the
1/2
left and Dπ from the right, then gives us:
−Q =

n
X

λk rk lkT ,

(S3)

k=1
1/2

−1/2

where lk = Dπ uk and rk = Dπ uk are the left and right eigenvectors of −Q associated with
T
λk . Note that lkT D−1
π lm = rk Dπ rm = 1 for k = m and 0 otherwise, and lk (i) = π(i)rk (i).
The transition probabilities for the Markov chain can then be written in terms of this expansion of Q. In particular, let Pt be the matrix whose i, j-th element is the probability that a

1

population that begins at time 0 fixed for genotype i is fixed for genotype j at time t. Then we
can write:
n
X
Pt (i, j) =
e−λk t rk (i)lk (j).
(S4)
k=1

As a result, for any function on the state space of the Markov chain, the expected value of that
function at time t for a population that begins fixed for genotype i at time 0 is given by
n
X

e−λk t rk (i) lkT g.

(S5)

k=1

where g(i) is the value of the function at genotype i. Equation 4 follows by choosing g(i) =
F(i) and noting that because the rows of Q sum to zero, we must have r1 = 1, where 1 is the
vector of all 1s, for all i and thus l1 = π.
Next, we turn to deriving the bound on the error of the approximation of a mean fitness
trajectory from an arbitrary epistatic fitness landscape using a fitness landscape with m sites. In
particular, we will show that for any mean fitness trajectory f (t) produced by an arbitrary, finite
fitness landscape whose mutational dynamics take the form of a reversible Markov chain, one
can always construct an m-site non-epistatic fitness landscape and choice of starting genotype
such that the resulting mean fitness trajectory f ∗ (t) satisfies
s
Varπ F
1
.
(S6)
sup |f ∗ (t) − f (t)| ≤
m+1
π(i)
t≥0
While we make no claims as to the tightness of this bound, it is worth noting that the true error
is often much lower than the bound would suggest, particularly if we only look at a finite range
of times such as for the landscapes investigated in Table 1.
The derivation
P has two parts. First we show that we can construct a landscape such that the
error is at most nk=2 |ck |/(m+1), where the ck are defined in Equation 4. The proof is based on
a closely related argument from Kammler (1976, pg. 768), which the interested reader should
also consult concerning the relation to completely monotone functions and the Laplace-Stieltjes
transform. The second
Pn part of the proof then uses Hölder’s inequality together with some linear
algebra to bound k=2 |ck | in terms of the equilibrium frequency of the initial genotype and the
variance in fitness at equilibrium for the original epistatic fitness landscape.
It is sufficient to construct approximations to mean fitness trajectories of the form
f (t) =

n
X

ck e−λk t

with λk > 0,

(S7)

k=2

where we have assumed without loss of generality that c1 = 0 (we could match any value by
appropriately choosing the initial fitness on the non-epistatic fitness landscape) and ck 6= 0 for
2

k ≥ 2. Now, by our main result, we can construct an m-site non-epistatic fitness landscape that
produces any mean fitness trajectory of the form
0

∗

f (t) =

m
X

∗

c∗i e−λi t

with λ∗i > 0,

(S8)

i=1

where we choose 1 ≤ m0 ≤ m. Furthermore, we can pick the λ∗i and c∗i such that, for any
λ ≥ 0, we have


!

X
X


1 X
∗


c
−
|ck | .
(S9)
c
≤
k 
i

m
+
1
 i:λ∗i ≤λ

k
k:λk ≤λ
For instance, we can choose
X

λ∗i = sup{λ > λ∗i−1 :

|ck | ≤

k:λ∗i−1 <λk ≤λ

X

c∗i =

1 X
|ck |}
m+1 k

ck ,

(S10)

(S11)

k:λ∗i−1 <λk ≤λ∗i

where we interpret λ∗0 as 0 and define the λ∗i iteratively for i = 1, 2, . . . until we either reach m
or the sup no longer exists in which case we set m0 equal to the last value of i for which the sup
exists. To see why this solution works, note that for λ ∈ {λ∗1 , . . . , λ∗m0 }


!
 X
X


∗

=0
c
(S12)
−
c
k
i


 i:λ∗i ≤λ

k:λk ≤λ
P
P
and that the sum k:λk ≤λ ck viewed as a function of λ can change its value by at most k |ck |/(m+
1) in each of the intervals [0, λ∗1 ), [λ∗1 , λ∗2 ), . . . , [λ∗m0 , ∞).
Having specified our approximating mean fitness trajectory f ∗ (t),
can now Rbound its
R ∞we−λt
∞
−xt
error relative to f (t). Note that for any x, t > 0, we can write e
= t x e dλ = t 0 χ(λ−
x) e−λt dλ, where χ(y) = 1 for y ≥ 0 and 0 otherwise. Thus we have, for t > 0:
 m0
!
!
m
 X

X

∗
∗ −λ∗i t
−λk t 
|f (t) − f (t)| = 
ci e
−
ck e
(S13)



i=1
k=1

!
!
Z ∞
Z ∞
m
m0
 X

X


=
c∗i t
χ(λ − λ∗i ) e−λt dλ −
ck t
χ(λ − λk ) e−λt dλ 


0
0
i=1

k=1

(S14)
 Z

∞

= t
 0

m0
X

!
c∗i χ(λ − λ∗i )

−

i=1

m
X
k=1

3

!!
ck χ(λ − λk )




e−λt dλ


(S15)





!
 Z ∞

X
X


∗
−λt




= t
ci −
ck
e dλ 
 0

i:λ∗i ≤λ
k:λk ≤λ



!

Z ∞ X
X

 −λt
∗

 e dλ
−
c
≤t
c
k
i


0
 i:λ∗i ≤λ

k:λk ≤λ



! Z

∞
X
 X ∗

e−λt dλ
≤ sup 
ci  −
ck  t
λ 
0

i:λ∗i ≤λ
k:λk ≤λ



!

X

 X ∗
ci  −
ck 
= sup 
λ 

i:λ∗i ≤λ
k:λk ≤λ
1 X
|ck | .
≤
m+1 k

(S16)

(S17)

(S18)

(S19)
(S20)

This establishes the required inequality for t > 0; the inequality must then also hold at t = 0 by
the continuity of f (t) and f ∗ (t).
P
P
It remains to derive an upper bound on k |ck | = nk=2 rk (i) lkT F. By Hölder’s inequality
we have
v
v
u n
u n
n
X
X
uX T 2
u
2t
T
t
rk (i) lk F ≤
(rk (i))
lk F .
(S21)
k=2

k=2

k=2

P
P
Now, nk=2 (rk (i))2 ≤ nk=1 (rk (i))2 and the latter sum is the squared Euclidean norm of the
−1/2
i-th row of the matrix Dπ U, where U is the matrix with uk as its k-th column. Since U is
an orthogonal matrix, its rows are orthonormal and hence
equal
p have a squared Euclidean norm
−1/2
to 1. Because the i-th row of U is multiplied by 1/ π(i) in the matrix product Dπ U, we
P
have nk=1 (rk (i))2 = 1/π(i). Indeed, since r1 (i) = 1 for all i, we have
n
X

(rk (i))2 =

k=2

1 − π(i)
1
≤
.
π(i)
π(i)

(S22)

As for the other sum, since l1 = π, we have
n
X

2
lkT F =

k=2

=

n
X

!
2
lkT F

k=1
n 
X

2
− πT F

T 2
Dπ1/2 uk F

k=1

4

(S23)

!
2
− πT F

(S24)

n
X

=

ukT D1/2
π F

k=1
n 
X

=

2

!

2
p
π(k)F(k)

2

(S25)

2
− πT F

(S26)

− πT F
!

k=1

2
= π F2 − πT F
= Varπ F,
T

(S27)
(S28)

where F2 (i) = F(i)2 and we have used the fact that U is orthonormal and hence preserves the
squared Euclidean norm of a vector. This completes the derivation of the bound.
To study evolution at equilibrium, we again consider an ensemble of populations, but instead
of assuming that all populations in the ensemble begin at some specified genotype, we let the
initial genotype of each population be drawn from π, the equilibrium distribution of the Markov
chain defined by Q. Using the definition of covariance, the covariance between the fitness of a
population at time t0 ≥ 0 whose genotype is drawn from π at time 0 and its fitness at time t0 + t
is given by
n X
n
X


a(t) =
π(i) Pt (i, j) F(i) − πT F F(j) − πT F .
(S29)
i=1 j=1

Defining the centered fitness vector F0 = F − (πT F)1, we can rewrite this in matrix notation
as
T
a(t) = (F0 ) Dπ Pt F0 .
(S30)
Using Equation S4, we can then expand Pt in terms of its eigenvalues and eigenvectors and
simplify to get
n


X

T
a(t) =
e−λk t (F0 ) Dπ rk lkT F0
(S31)
=
=

k=1
n
X
k=1
n
X

2

(S32)

2

(S33)

e−λk t lkT F0
e−λk t lkT F

k=2

where the last line follows because by construction l1T F0 = πT F0 = 0 and, for k ≥ 2, lkT 1 =
lkT r1 = 0, so that for k ≥ 2


lkT F0 = lkT F − πT F lkT 1
(S34)
= lkT F.

(S35)

2
Equation 17 in the main text then follows from Equation S33 by noting that lkT F is nonnegative.
5

