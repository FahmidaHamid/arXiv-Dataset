arXiv:1312.1673v4 [q-bio.PE] 10 Apr 2014

Formal properties of the probability of fixation:
identities, inequalities and approximations
David M. McCandlish∗1 , Charles L. Epstein2 , and Joshua B. Plotkin1
1

2

Department of Biology, University of Pennsylvania, Philadelphia, PA
Department of Mathematics, University of Pennsylvania, Philadelphia, PA

Keywords: weak mutation, reversibility, log-concavity, molecular clock

Abstract

The formula for the probability of fixation of a new mutation is widely used in theoretical population genetics and molecular evolution. Here we derive a series of
identities, inequalities and approximations for the exact probability of fixation of
a new mutation under the Moran process (equivalent results hold for the approximate probability of fixation under the Wright-Fisher process, after an appropriate
change of variables). We show that the logarithm of the fixation probability has a
particularly simple behavior when the selection coefficient is measured as a difference of Malthusian fitnesses, and we exploit this simplicity to derive inequalities
and approximations. We also present a comprehensive comparison of both existing
and new approximations for the fixation probability, highlighting those approximations that induce a reversible Markov chain when used to describe the dynamics of
evolution under weak mutation.

∗

To whom correspondence should be addressed. E-mail: davidmc@sas.upenn.edu

1

1

Introduction

A basic goal of evolutionary biology is to understand the process by which a new mutant
allele, present in only a single copy within a population, can eventually come to be carried by all
members of a population. This process is somewhat difficult to understand in general, both because of its dependence on the vicissitudes of the lives and deaths of particular individual organisms and because of the vast diversity of ways that this process could unfold (i.e. the enormous
set of possible paths through the space of gene frequencies). It is therefore useful to consider
certain simple summary statistics capable of providing broad insights into this complex process (e.g. Ewens, 2004). One productive approach is to abstract away from the time-dependent
aspects of this process and to consider only the final outcome, i.e. to consider the probability
that a new mutant allele is destined to fix in the population or, conversely, that the new allele is
destined to be lost (Fisher, 1922; Haldane, 1927; Fisher, 1930b,a; Wright, 1931; Malécot, 1952;
Kimura, 1957, 1962). Formulae for this probability are typically expressed as functions of both
the magnitude of natural selection (differences in expected number of offspring, etc.) and the
form of genetic drift (population size, distributions of offspring number, etc.). Such formulae
therefore provide a quantitative understanding of the relationship between these key factors in
the evolutionary process.
Besides providing a framework for considering the relative influence of natural selection
and genetic drift in evolution, formulae for the probability of fixation play a widespread role as
constituent elements in more complex models of evolution (reviewed in McCandlish and Stoltzfus, in press). The most common way of constructing such models is to assume that mutation
is sufficiently weak that each new mutation is either lost or fixed before the next new mutation
enters the population; under this assumption one can construct a model of evolution in which
the fate of each new mutation is based solely on its probability of fixation, either by assuming that new mutations enter the population with some distribution of selection coefficients and
are fixed or lost independently from each other (Ohta, 1977; Kimura, 1979; Sawyer and Hartl,
1992), or by considering a sequence of fixation events at a single locus (Gillespie, 1983; Iwasa,
1988; Bulmer, 1991; Hartl and Taubes, 1998; Orr, 2002; Sella and Hirsh, 2005).
In light of the importance of the probability of fixation for understanding the relationship
between selection and drift and for contemporary models of evolution under weak mutation, it is
unfortunate that the standard formulae for the fixation probability are, mathematically, difficult
to understand and manipulate. As a result of these difficulties, various approximations to the
probability of fixation have been proposed and are in common use. However, these approximations suffer from a number of defects, such as being uncontrolled (no bounds on the direction
and magnitude of the error) and altering fundamental aspects of the evolutionary dynamics (e.g.,
making deleterious substitutions impossible, McCandlish et al., in press). It is therefore useful
to study the probability of fixation in more detail, with the dual goals of better understanding
the relationship between selection and drift and constructing better approximations.
2

Here, we develop a series of identities, inequalities and approximations for the exact probability of fixation of a new mutation under a Moran process (Moran, 1959). This probability is
given by
1 − e−s
uN (s) =
.
(1)
1 − e−N s
where N is the population size and s is the difference between the log fitness of the invading
type and the log fitness of the resident type (i.e. the difference in Malthusian fitness). Defining
the selection coefficient as the difference in log fitnesses is useful because it puts the probability
of fixation into a form very similar to that of the approximate probability of fixation under a
Wright-Fisher process (Kimura, 1957, 1962). This means that the results described here can
easily be translated into approximate results for the Wright-Fisher process under an appropriate
rescaling of the variables. In fact, many of our inequalities can be extended to provide exact
bounds on the Wright-Fisher fixation probability (see Discussion).
Our approach to studying the behavior of the probability of fixation stems from the following remarkable (albeit well-known) identity, which relates the fixation probability of mutations
whose selection coefficients have equal magnitude but opposite signs:
uN (s)
= e(N −1)s .
uN (−s)

(2)

This identity plays a particularly important role in multi-allelic models of evolution where it
is assumed that each new mutation is lost or fixed before the next new mutation enters the
population. In such “sequential fixations” models, evolution is formalized as a Markov chain
on the set of alleles (rather than the set of allele frequencies), and the transition rate between
allele i and allele j is given by
Q(i, j) = N µi,j uN (si,j )

for i 6= j

(3)

where µi,j is the mutation rate from i to j and si,j is the difference between the log fitness of
allele j and the log fitness of allele i. Under mild additional assumptions, Equation 2 determines
the equilibrium distribution of this sequential fixations Markov chain and ensures that it is
reversible (Iwasa, 1988; Sella and Hirsh, 2005; Berg et al., 2004; Manhart et al., 2012). Here, we
use this identity as the basis for providing a simpler and more intuitive analysis of the effects of
the selection coefficient on the probability of fixation and for constructing new approximations
that maintain the reversibility and equilibrium distribution of these sequential fixations Markov
chains.
One immediate consequence of the above identity is that the logarithm of the probability of
fixation must obey certain symmetries and so it may be easier to understand than the probability
of fixation itself. Indeed, we show that the log probability of fixation is concave, and we use
this log-concavity to establish a number of useful inequalities. In addition, our results on the
log probability of fixation provide deeper insights into the relationship between selection and
3

drift than studying the probability of fixation itself. This is because taking logs allows us to ask
how a small change in selection coefficient increases or decreases the probability of fixation in
a proportional, rather than absolute, sense.
Another consequence of this identity is that given an approximation for the probability of
fixation for advantageous mutations one can construct a natural extension of that approximation
for deleterious mutations by stipulating that the approximation should also satisfy the identity.
Any approximation constructed in this fashion automatically preserves the structure of the equilibrium distribution of the corresponding sequential fixations Markov chain and the reversibility
of the resulting dynamics. We provide a comprehensive comparison between existing approximations and a set of new approximations derived by this method, paying close attention to
approximations that also serve as upper or lower bounds on the probability of fixation. Notably,
we find that the approximation
(
S + e−S/2
for S > 0
N uN (s) ≈
(4)
S
3S/2
−Se +e
for S ≤ 0.
performs quite well compared to the standard approximation (Fisher, 1930b; Wright, 1931)
N uN (s) ≈

S
,
1 − e−S

(5)

where S = N s, and it should provide a useful substitute in many circumstances (the main
advantage of the new approximation is that it is not expressed as a fraction, making it easier
to treat as an integrand). We demonstrate the utility of this new approximation by showing
how it simplifies the calculation of the rate of evolution under several common choices for the
distribution of mutational effects on fitness (Ohta, 1977; Kimura, 1979; Piganeau and EyreWalker, 2003).
In the processes of developing these ideas, we highlight many other results that give additional insight into the probability of fixation of a new mutation. For instance, we show that
the common approximation in Equation 5 has the surprising feature that the probability of fixation can be additively partitioned into one term, corresponding to the probability of fixation
in an infinite population and another term, capturing the effects of finite population-size, which
depends only on the magnitude of the selection coefficient and not its sign. We explore the
implications of this decomposition in the Discussion.
It is worth noting that while we conduct a thorough analysis of the exact probability of fixation of a new mutation for the Moran model under frequency-independent selection, there are
many other aspects of the probability of fixation that we make no attempt to cover (see Patwa
and Wahl, 2008, for a comprehensive review). For an analysis of the monotonicity of the probability of fixation starting from an arbitrary frequency and under arbitrary diploid selection,
see (Chen et al., 2008); for frequency-dependent selection, see (Taylor et al., 2004; Wu et al.,
4

2013); for the accuracy of the approximate probability of fixation under the diffusion approximation, see (Moran, 1960; Bürger and Ewens, 1995); for the probability of fixation in structured
populations see (Whitlock, 2003) and for the more general case of evolution in graph-structured
populations, see (Nowak, 2006; Shakarian et al., 2012); recent results for time-varying selection
and population size can be found in (Uecker and Hermisson, 2011; Waxman, 2011; Peischl and
Kirkpatrick, 2012).

2

Basic properties of the probability of fixation

The probability of fixation for a new mutation under the Moran process, uN (s), was given
in Equation 1. In what follows, we will assume N > 1, since if N = 1 then uN (s) = 1 for all s.
Furthermore, for notational convenience, we will generally leave the index N in uN (s) implicit
and simply write u(s) in places where doing so introduces no ambiguity.
Some of the behavior of u(s) is easy to determine based on its functional form, and thus
some of its behavior is readily apparent. It is easy to see that 0 < u(s) < 1 and one can use
L’Hôpital’s rule twice to show that u(0) = 1/N . Further simplifications are possible if we
assume that certain terms are large or small. In particular, for large, positive N s the probability
of fixation behaves like 1 − e−s , which for small s behaves like s; for large, negative s the probability of fixation behaves like e(N −1)s ; and for large, negative N s but small s, the probability
of fixation behaves like −s eN s .
Other features of the probability of fixation require a little more work to derive. For convenience, we have included a list of useful, general identities in Table 1. In what follows, we will
also require a basic understanding about the derivatives of u(s).
Although intuitively it is obvious that the probability of fixation should be increasing in
s, the fact that u0 (s) is always positive is not immediately apparent from the functional form
of u(s) or from direct evaluation of u0 (s) (for a broader study of when the probability of fixation behaves monotonically as a function of either selection coefficients or initial frequency,
see Chen et al., 2008). However, differentiating both sides of Equation I2 from Table 1 and
rearranging gives us:
N
−1
X
0
2
u (s) = u(s)
k e−ks
(6)
k=1

which is clearly positive for all s. Furthermore, using the fact that u0 (s) > 0 for all s, Equation I7 from Table 1 gives us u0 (s) < 1, so that indeed both 0 < u(s) < 1 and 0 < u0 (s) < 1.
The fact that u0 (s) < 1 is biologically interesting because it is common to approximate u(s) ≈ s
for large N s and small s; this approximation thus always overestimates the sensitivity of u(s)
to changes in s.
5

u(s)
= e(N −1)s
u(−s)
N
−1
X
1
=
e−ks
u(s)
k=0
uN −1 (s)
e−s + uN −1 (s)
u(s) − (1 − e−s ) = e−s u(−s)


sinh(s/2)
(N −1)s/2
u(s) = e
sinh(N s/2)

2
sinh(s/2)
u(s)u(−s) =
sinh(N s/2)
0
u (s) = 1 − u(s) − e−s u0 (−s)
uN (s) =

Reversibility

(I1)

Finite geometric sum

(I2)

Recursive formula

(I3)

Comparison with N s  1 limit

(I4)

Hyperbolic identity

(I5)

Hyperbolic identity II

(I6)

Derivative with respect to s

(I7)

Table 1: Basic identities for the probability of fixation. The above identities are all easy to
verify. Equation I1 is well-known; equation I2 can be found in (Traulsen et al., 2007).

6

Unlike u0 (s), little can be said about the behavior of u00 (s), at least analytically. Intuitively,
u (s) must be negative for large, positive s (where u(s) ≈ 1 − e−s ) and positive for large,
negative s (where u(s) ≈ e(N −1)s ). Numerical exploration suggests that the corresponding
point of inflection in u(s) occurs at s ≈ (log N )/N .
00

As we have seen, it is possible to make some limited progress determining the features of
the probability of fixation by working directly with u(s). One of the main messages in what
follows is that the situation simplifies considerably if we consider the log probability of fixation
instead.

3

Identities: the logarithmic approach

There are two reasons for consider the log probability of fixation. The first reason, which is
d
log u(s) provides, in some sense, a more
more important biologically, is that the derivative ds
informative measure of how changing s changes the probability of fixation, than u0 (s) itself
d
log u(s) = u0 (s)/u(s), i.e. the derivative of the log probability of
does. This is because ds
fixation describes how changes in s affect the probability of fixation in a relative, rather than
absolute sense. For instance, making a deleterious fixation slightly more fit may hardly increase
its probability of fixation when measured in terms of a difference of probabilities, but may
nonetheless cause a substantial proportional increase in the probability of fixation. If most
mutations are strongly deleterious, making such mutations slightly less deleterious might have
a large impact on the rate of evolution, an effect that would be completely hidden if we only
considered u0 (s).
The second reason to study the log probability of fixation is one we have already mentioned:
the behavior of the log probability of fixation is much simpler than the behavior of the probability of fixation. This simplicity arises in large part due to Equation I1 in Table 1, and can be seen
by taking the natural logarithm of both sides of that equation. It is not immediately obvious, but
this simple behavior is also closely related to the fact that the sequential fixations Markov chain
is often reversible.
To see the relationship between the simple behavior of the log probability of fixation and
the reversibility of the sequential fixations Markov chain, let us step back and consider the
probability of fixation as being just some function qN with 0 < qN (s) < 1. Suppressing the
subscript N in our notation as for u(s), the corresponding sequential fixations Markov chain
has the rate matrix
Q(i, j) = N µi,j q(log fj − log fi ) for i 6= j
(7)
where fi is the fitness of allele i, µi,j is the mutation rate from i to j, and the diagonal entries of
Q are specified by the requirement that the row sums be zero. Now, let us assume that there are
7

at least three alleles and that the µi,j are chosen such that the sequential fixations Markov chain
is reversible for the neutral case, i.e. q(s) = 1/N . One might wonder what form the probability
of fixation must take such that adding arbitrary frequency-independent natural selection to this
model preserves its reversibility. It turns out that a necessary and sufficient condition is that q
must satisfy the identity:
q(s)
q(s̃)
q(s + s̃)
×
=
(8)
q(−s) q(−s̃)
q(−(s + s̃))
for all s and s̃, which in turn implies that for all s
q(s)
= eν(N ) s
q(−s)

(9)

for some function ν that does not depend on s (Manhart et al., 2012). Taking logs and then
differentiating, we have:
log q(s) = ν(N ) s + log q(−s)
d
d
log q(s) = ν(N ) +
log q(−s)
ds
ds
d2
d2
log
q(s)
=
log q(−s)
dss
ds2

(10)
(11)
(12)

assuming, of course, that the relevant derivatives are defined. Thus, we see immediately that,
for any probability of fixation that results in the reversibility of the sequential fixations Markov
chain, the second derivative of the log probability of fixation with respect to fitness is an even
function, while the first derivative is equal to ν(N )/2 plus some odd function of s (recall that f
is known as an even function if f (x) = f (−x) for all x; f is odd if f (x) = −f (−x) for all x).
Returning to the actual probability of fixation for a Moran process, u(s), by Equation I1 in
Table 1 we have ν(N ) = N − 1. Figure 1 compares u(s) and its derivatives with respect to s to
log u(s) and its corresponding derivatives. The figure suggests that the derivatives of log u(s)
have several useful features even beyond those guaranteed by the above considerations. For
instance, unlike the first derivative of u(s) with respect to s, the first derivative of log u(s) with
respect to s changes monotonically in s. It is this simplicity that will allow us to develop many
of the inequalities and approximations that follow.
Let us now study log u(s) in more detail. Of course, because log is a monotonic function
d
log u(s) =
and u(s) is strictly increasing, log u(s) must also be strictly increasing, and so ds
0
u (s)/u(s) > 0. To better understand the behavior of log u(s) we can differentiate it directly
and simplify to obtain
d
N
1
log u(s) =
−
.
(13)
N
s
ds
1−e
1 − es
From this we immediately see that lims→−∞

d
ds

log u(s) = N − 1 and lims→∞
8

d
ds

log u(s) = 0.

0.20

0

0.15

5

0.10

10
15

0.05
0.00

0.2

0.1

0.0

0.1

0.2

20

0.2

1.0

100

0.8

80

0.6

60

0.4

40

0.2

20

0.0
0.2

0.1

0.0

0.1

0.2

0
0.2

20

0

15

200

10

0.0

0.1

0.2

0.1

0.0

0.1

0.2

0.1

0.0

0.1

400

5

600

0
5
0.2

0.1

800
0.1

0.0

0.1

0.2

0.2

0.2

Figure 1: A comparison between (left column) the probability of fixation and its derivatives
with respect to s and (right column) the log probability of fixation and its derivates with respect
to s. N = 101.

9

So far we have seen that the limiting values of the derivative of log u(s) are N − 1 for
large, negative s and 0 for large, positive s. In fact, the derivative of log u(s) is monotonically
decreasing from N − 1 to 0, as can be seen by examining the second derivative of log u(s). In
particular, we have
d2
N 2 u(s) u(−s) − 1
(14)
log
u(s)
=
ds2
es + e−s − 2
which is clearly an even function of s, as it must be by Equation 12. Furthermore, for s 6= 0,
es + e−s − 2 = (1 − es )2 /es > 0 so that the sign of the second derivative depends on the sign of

2
sinh(s/2)
N 2 u(s) u(−s) − 1. Now, by Equation I6 in Table 1 we have u(s)u(−s) = sinh(N
. It is
s/2)
sinh(s/2)
is a non-negative, even function of s that is decreasing for positive
easy to show that sinh(N
s/2)
s, and has a global maximum at 1/N for s = 0. Thus N 2 u(s) u(−s) − 1 is always negative for
d2
d2
1
2
s 6= 0 and so is ds
2 log u(s). Furthermore, for s = 0 we have ds2 log u(s) = − 12 (N − 1) < 0.
2

d
In other words, we have shown that ds
2 log u(s) < 0 for all s; we will refer to this condition as the probability of fixation being “log-concave” in s and it will serve as the key fact
for deriving inequalities in the next section. Although our conclusion that u(s) is log-concave
was established using elementary methods, it is worth noting that from a more sophisticated
perspective one can see this almost immediately from Identities I1 and I2. In particular, Equation I2 shows that 1/u(s) for s ≥ 0 is a completely monotone function and hence log-convex
for s ≥ 0; it then follows that u(s) is log-concave for s ≥ 0. Furthermore, Equation I1 shows
that log u(s) for s < 0 only differs from log u(s) for s > 0 by the addition of a linear function,
so that u(s) must be log-concave for s < 0 as well.

To summarize our results so far, log u(s) is a monotonically increasing function of s whose
derivative decreases monotonically from N − 1 to 0 as s goes from −∞ to ∞. Furthermore,
because the second derivative of log u(s) is an even function of s, this decrease occurs symmetrically around the point s = 0. This simple behavior allows many immediate insights into the
behavior of log u(s). For instance, we know immediately that the derivative at s = 0 must be
(N − 1)/2, i.e. half-way between these limiting values.

4

Inequalities

Our results on the log-concavity of u(s) now allow us to develop a series of inequalities
for u(s). The main idea is that the simple geometry of log u(s) makes it easy to construct
inequalities for log u(s). Because log is a monotonically increasing function, these inequalities
for log u(s) also imply inequalities for u(s).
Our first set of inequalities come from the observation that because log u(s) is concave, any
line tangent to the graph of log u(s) provides an upper bound (see Figure 2A). In particular, if
10

0
5

A

10
15
20
0.2
0
5

0.1

0.0

0.1

0.2

0.1

0.0

0.1

0.2

0.1

0.0

0.1

0.2

0.1

0.0

0.1

0.2

B

10
15
20
0.2
0
5

C

10
15
20
0.2
0
5

D

10
15
20
0.2

Figure 2: A geometric method for developing inequalities for the probability of fixation. For
all panels, N = 101, the gray line is the log probability of fixation and the black line is another
function used to develop an inequality. A) Any tangent of log u(s) is always greater than or
equal to log u(s). B) (N − 1)s is always greater than the probability of fixation. C) Any line of
the form (N − 1)s + b intersects log u(s) at most once and therefore can be used to construct
an inequality. D) Any function of the form u(s + c, N ) + b intersects log u(s) at most once and
therefore can be used to construct an inequality.

11

we choose the tangent of log u(s) at (s̃, log u(s̃)), we have
log u(s) ≤ log u(s̃) +

u0 (s̃)
(s − s̃),
u(s̃)

(15)

where the inequality is strict for s 6= s̃. Exponentiating then rearranging gives us
u0 (s̃)

u(s) ≤ u(s̃) e u(s̃) (s−s̃) .

(16)

In the special case s̃ = 0, this inequality simplifies to
u(s) ≤

e(N −1)s/2
,
N

(17)

while letting s̃ → −∞ gives us
u(s) ≤ e(N −1)s

(18)

(see Figure 2B).
In fact, this last inequality is strict for all s, as can be seen by using Equation I1 from
Table 1 on e(N −1)s − u(s) and putting all the terms over a common denominator. Equation 18 is
particularly useful for understanding the sequential fixations Markov chain because when this
Markov chain is reversible its equilibrium distribution is proportional to πM (i)e(N −1) log f (i) ,
where πM (i) is the equilibrium frequency of allele i under neutrality and f (i) is the fitness
of allele i. Since s is a difference between log fitnesses, we see that Equation 18 actually
describes a relationship between the probability of fixation and the equilibrium distribution of
the resulting weak-mutation Markov chain. Elsewhere, we use this inequality and several of the
other inequalities below to understand the relationship between the short-term and long-term
behavior of the sequential fixations Markov chain under the house of cards model (McCandlish
et al., in press).
Our second set of inequalities relies on the observation that, because log u(s) is concave and
has a derivative that approaches N − 1 as s → −∞, the derivative of log u(s) is always less
than N − 1 and thus a line with slope N − 1 intersects with log u(s) at most once (Figure 2C).
In particular, if a line of the form (N − 1)s + c intersects log u(s) at some point (s̃, log u(s̃)),
then log u(s) is above (N − 1)s + c for s < s̃ and below (N − 1)s + c for s > s̃, since the
derivative of (N − 1)s + c is N − 1 and hence always greater than the derivative of log u(s).
Solving for c in terms of s̃ gives us c = log(u(s̃)) − (N − 1)s̃. Thus, for s > s̃, we have
log u(s) < (N − 1)(s − s̃) + log u(s̃)

(19)

and the inequality is reversed for s̃ > s. Exponentiating this inequality and rearranging yields
u(s)
< e(N −1)(s−s̃)
u(s̃)
12

(20)

for s > s̃ and the inequality is reversed for s < s̃. For the special case of s̃ = 0, this also
simplifies to
e(N −1)s
u(s) <
(21)
N
for s > 0 and the inequality is reversed for s < 0.
Equation 20 is interesting because given two possible mutations with selection coefficients
s and s̃ that enter the population at the same rate, under weak mutation the odds of the mutation
with selection coefficient s next becoming fixed in the population rather than the mutation with
selection coefficient s̃ are given by u(s)/u(s̃) (Gillespie, 1983). Thus, this ratio summarizes
the ability of natural selection to discriminate between these two mutations. Equation 20 then
describes a limitation on this ability to discriminate in terms of the population size and the
difference between the selection coefficients of the two mutations.
Given our result on the ratio u(s)/u(s̃), it might also be interesting to understand how this
ratio changes if both selection coefficients are increased by some amount c, i.e. u(s+c)/u(s̃+c).
Intuitively, we are asking about how the ability of natural selection to discriminate against
two mutations changes if we fix the fitness difference between these mutations but allow their
fitnesses to vary relative to the wild-type.
To construct a relevant inequality, we use the same approach as before, but consider the
geometry of log u(s) and log(u(s + c)) + d, that is, we consider the relationship between the
curve log u(s) and a translated version of itself. Because the derivative of both the original
curve and its translation are decreasing, the derivative of one of these curves is greater than the
other at all s and so the two curves intersect at most once (Figure 2D).
In particular, suppose we stipulate that these curves should cross at (s̃, log u(s̃)). Solving
d
log(u(s +
for d yields d = log u(s̃) − log u(s̃ + c). Using this value for d, for c > 0 we have ds
d
d
c)) + d < ds log u(s), since ds log u(s) is decreasing in s and d is negative because log u(s) is
increasing in s. Thus, the two curves cross only once and for c > 0, log(u(s+c))+d > log u(s)
for s < s̃ and log(u(s + c)) + d < log u(s) for s > s̃. Exponentiating and rearranging terms,
we have:
u(s)
u(s + c)
>
(22)
u(s̃)
u(s̃ + c)
for c > 0 and s > s̃; for s < s̃ the inequality in Equation 22 is reversed. Of course, one could
construct an analogous equation for c < 0 (which, incidentally, could also be used to derive
Equation 20 by taking the limit as c → −∞).
What Equation 22 tells us is that increasing the selection coefficients of two mutations by
equal amounts always decreases the ability of natural selection to discriminate between them.
To put this another way, in the regime where new mutations are entering the population one at a

13

time, natural selection’s power to discriminate between these mutations based on their fitnesses
is maximized for strongly deleterious mutations.
All of our results so far have been presented for the probability of fixation of a new mutation
because the primary intended application of these results has been studying evolution under
weak mutation. However, for some applications, it is interesting to also consider the probability
of fixation of an allele that begins at a frequency greater than 1/N . The results for this more
general case are almost completely analogous with those given above; see Appendix 1.

5

Approximations

Our strategy for developing inequalities was based in the observation that the log probability
of fixation has many useful properties that stem from the basic identity u(s)/u(−s) = e(N −1)s .
Besides conferring certain formal properties on the logarithm of the probability of fixation, this
identity also suggests a natural strategy for developing approximations to the probability of fixation. In particular, by rearranging this identity to read u(−s) = u(s)e−(N −1)s , we can take an
approximation defined for positive selection coefficients and use it to derive a corresponding approximation for negative selection coefficients. Furthermore, an approximation constructed in
this manner automatically preserves the reversibility and equilibrium distribution of any weakmutation Markov chain based on such an approximation. The same idea can be applied if one
has a good approximation for negative selection coefficients. Our main goal in this section is to
use this strategy to develop a number of useful approximations for u(s), while comparing the
performance of these approximations to other, previously proposed, approximations.
Historically, most work on approximate formulas for the probability of fixation has concerned the probability of fixation under the Wright-Fisher process or its diffusion limit. Because there is no known exact formula for the probability of fixation for a finite population
evolving under a Wright-Fisher process, analytically assessing the accuracy of such approximations is quite difficult (although see Moran, 1960; Bürger and Ewens, 1995, see also Gale
1990 for a more accessible treatment). Having an exact formula against which to measure the
accuracy of approximations thus provides one of our major motivations for working in a Moran
process framework. Fortunately, because the exact formula for the probability of fixation of a
Moran process coincides up to a rescaling of variables with the formula for the diffusion limit
of a Wright-Fisher process (Kimura, 1957, 1962), it is easy to adapt previously proposed approximations to the current context. In what follows we will therefore present these adapted
expressions while providing citations for the original formulae.
The most commonly used approximation for the probability of fixation of a new mutation

14

was given by Fisher (1930b) and Wright (1931) as:
wN (s) =

s
.
1 − e−N s

(23)

Let us begin by considering the behavior of this expression in light of our previous analysis of
u(s). Suppressing the N in our notation as for u(s), we see that w(s) can be derived from the
expression for u(s) using the approximation 1 − e−s ≈ s, valid for small |s|, so that we expect
w(s) to be a good approximation for small |s|, but not necessarily for large |s|. Indeed, for large,
positive s, w(s) can be greater than 1 and therefore not a valid probability. More precisely:
s
wN (s)
=
uN (s)
1 − e−s

(24)

so that the error in using w(s) is solely a function of s (and not N ) and w(s) overestimates the
probability of fixation for beneficial mutations and underestimates the probability of fixation
for deleterious mutations. Since w(s) becomes more accurate as |s| becomes small, if we fix
N s = S and let N → ∞, we have the well-known result:
lim N uN (s) = lim N wN (s) =

N →∞

N →∞

S
.
1 − e−S

(25)

Because it is often useful to have an approximation for uN such that the corresponding approximation for N uN (s) can be expressed solely in terms of the compound parameter S = N s as
N → ∞, we will highlight this characteristic when it occurs in the approximations that follow.
Table 2 gives several useful identities for w(s).
While w(s) shares many of the properties of u(s) with regard to its logarithm, it is also
useful because it is significantly easier to analyze directly. Turning first to log w(s), all of the
relations in Equations 10, 11 and 12 continue to hold, but with ν(N ) = N instead of N − 1.
Furthermore, we have
N
1
d
log w(s) =
+ ,
N
s
ds
1−e
s
2
d
N w(s) w(−s) − 1
log w(s) =
2
ds
s2

(26)
(27)

from which one can show (using Equation I14 from Table 2) that w(s) is log-concave, that the
derivative of log w(s) decreases monotonically from N − 1 to 1 as s increases from −∞ to
∞, and that this decrease in the derivative occurs symmetrically around the point s = 0. The
log concavity of w(s) also makes it easy to construct inequalities for w(s), as in the previous
section.
The direct analysis of w(s) is much simpler than the direct analysis of u(s) as a formal
consequence of the remarkable identity given by Equation I10 in Table 2. But before we explore the formal implications of Equation I10, it is important to understand what this identity
15

w(s)
= eN s
w(−s)
 ∞
X



s
e−k N s for s > 0


k=0
w(s) =
∞
X




ek N s for s < 0
 −s

Reversibility

(I8)

Geometric Series

(I9)

k=1

w(s) − s = w(−s)
w0 (s) = 1 − w0 (−s)
w00 (s) = w00 (−s)


s/2
N s/2
w(s) = e
sinh(N s/2)

2
s/2
w(s)w(−s) =
sinh(N s/2)
w(s) + w(−s) = s coth(N s/2)
s
w(s) = (1 + coth(N s/2))
2

Comparison with N s  1 limit
First derivative
Second derivative

(I10)
(I11)
(I12)

Hyperbolic identity

(I13)

Hyperbolic identity II

(I14)

Hyperbolic identity III

(I15)

Hyperbolic identity IV

(I16)

Table 2: Basic identities for Fisher (1930b) and Wright (1931)’s approximation to the probability of fixation

0.05

w(s)

probability

0.04
0.03
0.02

difference=s

0.01
0.00

0.04

0.00
s

0.02

0.02

w(-s)
0.04

Figure 3: Graphical representation of the identity given by Equation I10 for N = 101. The
difference in the probability of fixation between a mutation with selection coefficient s and
selection coefficient −s is equal to s, which for s > 0 is also equal to the probability of fixation
given by w for an infinite population (i.e. the large N s limit).

16

means biologically. In particular, Equation I10 expresses the probability of fixation given by
wN (s) for positive s as the sum of the probability of fixation for that selection coefficient in an
infinite population (limN →∞ wN (s) = s) plus some extra probability due to the effects of finite
population size. The reason this identity is remarkable is not because such a decomposition is
possible, but because the amount of extra probability is symmetrical around s = 0: the extra
probability due to finite population size for s > 0 is precisely equal to the probability of fixation
of a deleterious allele whose selection coefficient has the same absolute value (Figure 3). Note
that this relationship holds approximately for u(s) as well (Equation I4 from Table 1).
Formally, Equation I10 means that the derivatives of w(s) must respect certain symmetries
(Equations I11 and I12). The first and second derivatives are given by
w(s)
(1 − N w(−s)) ,
w0 (s) =
s
 2
N
00
w (s) =
(w(s) w(−s)) (w(s) + w(−s) − 2/N )
s

(28)
(29)

from which it is easy to show that w(s) is convex and increasing in s (to show convexity, note
that w(s) + w(−s) = s coth(N s/2), which clearly has a minimum at s = 0; the value at this
minimum is 2/N , as can be shown by expressing coth in terms of exponentials and then using
L’Hôpital’s rule). In particular, w0 (s) increases from 0 to 1 as s increases from −∞ to ∞, and,
by Equation I12, this change occurs in a manner that is symmetric around s = 0. The convexity
of w(s) likewise enables the construction of inequalities for w(s) as in the previous section, but
where the inequalities are constructed by considering the behavior of w(s) directly rather than
its log.
As we have seen, w(s) has many useful properties. However, further approximations are
often necessary because of the 1 − e−N s term in the denominator, which frequently results in
expressions that are difficult to work with. One common simplification of w(s) is to assume
that N s is large so that 1 − e−N s ≈ 1 and therefore u(s) ≈ s for s > 0 and 0 otherwise.
While s is certainly easy to integrate against and shares the appealing property of w(s) that
it can often be used to write the evolutionary dynamics in terms of S = N s, the fact that
deleterious fixations are treated as impossible under this approximation sometimes produces
pathological consequences (for instance, the prediction that fitness should increase indefinitely
over time instead of reaching mutation-selection-drift balance; see McCandlish et al., in press,
for a discussion of other related issues). Thus, it may be useful to extend this approximation to
include the possibility of deleterious fixations.
The most natural way to conduct such an extension is to stipulate that the property u(s)/u(−s) =
e
should be maintained, which also leaves the equilibrium distribution of the sequential fixations Markov chain unchanged. Thus, if u(s) ≈ s for s > 0, then we must have
(N −1)s

17

u(−s) ≈ se−(N −1)s for s > 0 or equivalently:
(
s
for s > 0
u(s) ≈
(N −1)s
− se
for s ≤ 0.

(30)

This approximation is particularly useful because the term e(N −1)s in the probability of fixation
for a deleterious mutant means that the integrals produced using this approximation can be
expressed in terms of the equilibrium distribution of the sequential fixations Markov chain (see,
e.g., the supplemental material to McCandlish et al., in press). For fixed S = N s and large N ,
we also have:
(
S
for S > 0
N uN (s) ≈
(31)
S
− S e for S ≤ 0.
One defect of Equation 30 is that for large s, the resulting expression can be greater than
1. This can be rectified by considering the true large N limit of uN (s), which is is 1 − e−s for
s > 0 and 0 otherwise. Extending this approximation to negative s gives us:
(
1 − e−s
for s > 0
u(s) ≈
(32)
(N −1)s
Ns
e
−e
for s ≤ 0.
A defect shared by these approximations based on the large N limit of uN (s) is that they
grossly underestimate the probability of fixation of nearly neutral mutations (e.g. they approximate the probability of fixation for a strictly neutral mutation as 0 instead of 1/N ). Poon and
Otto (2000) proposed a solution to this problem based on the strategy of including an additive
correction term that (1) is some multiple of an exponential function (and therefore easy to integrate against), (2) results in the approximation having the correct value for s = 0 and, (3)
results in the approximation having the correct derivative with respect to s when evaluated at
s = 0. For the approximation u(s) ≈ s for s > 0 and 0 otherwise, this strategy results in the
approximation (Poon and Otto, 2000):

1

 s + e−(N +1)s/2 for s > 0
N
(33)
u(s) ≈
1

 e(N −1)s/2
for s ≤ 0,
N
or for fixed S and large N :
(
N uN (s) ≈

S + e−S/2 for S > 0
eS/2

for S ≤ 0.

(34)

While the Poon and Otto (2000) approximation provides a very nice approximation for advantageous mutations of small effect, the approximation for deleterious mutations is rather poor
18

and the use of this approximation does not maintain the equilibrium distribution of the weakmutation dynamics achieved under the exact expression. We can fix both defects using our
strategy for developing approximations based on the relationship u(s)/u(−s) = e(N −1)s . Using
the Poon and Otto (2000) approximation for positive s to derive the corresponding approximation for negative s gives us:

1

 s + e−(N +1)s/2
for s > 0
N
u(s) ≈
(35)

 − s e(N −1)s + 1 e(3N −1)s/2 for s ≤ 0.
N
For fixed S = N s and large N , this simplifies to
(
S + e−S/2
for S > 0
N uN (s) ≈
S
3S/2
−Se +e
for S ≤ 0.

(36)

We can also modify this approximation to give better results for large s in the manner of Equation 32:

1

 1 − e−s + e−(N +1)s/2
for s > 0
N
u(s) ≈
(37)

 e(N −1)s − eN s + 1 e(3N −1)s/2 for s ≤ 0.
N
An additional strength of several of the above approximations is that the approximations
provide bounds on the true probability of fixation. In particular, Equation 32 provides a lower
bound on u(s) while Equations 33, 35, and 37 provide upper bounds. To see why this is true,
we first note that for s > 0, we have:
1 − e−s < s < w(s)
1 − e−s < u(s) < w(s)
e−(N +1)s/2
e−(N +1)s/2
<s+
N
N
e−(N +1)s/2
<s<s+
.
N

1 − e−s < u(s) < 1 − e−s +
1 − e−s

(38)
(39)
(40)
(41)

These inequalities are mostly obvious, but two require additional comment. First, u(s) < w(s)
for s > 0 follows from Equation 24. Second, it is not immediately clear that u(s) < 1 − e−s +
e−(N +1)s/2
for s > 0. To see that this is true, first note that using Equation I6:
N




e−(N +1)s/2
sinh(N s/2) − N sinh(s/2)
−s
−N s
1−e +
/u(s) = 1 + e
.
(42)
N
N sinh(s/2)
Clearly whether this ratio is greater or less than one only depends on the sign of the numerator
of the fraction in parentheses on the right hand side, since the denominator is always positive
19

d
for s > 0. Noting that sinh(0) = 0 and dx
sinh(x) = cosh(x), where cosh(x) is non-negative
and increasing for x > 0, we conclude that sinh(cx) > c sinh(x) for all c, x > 0, so that the
numerator is positive as required.

Now, it still remains to show that Equation 32 provides a lower bound on u(s) while Equations 33, 35, and 37 provide upper bounds. The fact that Equation 33 is an upper bound follows
from the inequality in Equation 40 for the case s > 0 and by Equation 21 for the case s ≤ 0.
For Equations 32, 35, and 37 the direction of the bound for s > 0 follows by the inequalities
in Equations 38 and 40 for s > 0 and can easily be checked for s = 0. For the case s < 0
we simply note that because the values of these approximations for s < 0 were determined
from the values for s > 0 and the relation u(s)/u(−s) = eN −1(s) , the proportional error in
the approximation is symmetric around s = 0, so that the error for s < 0 must be in the same
direction as the error for s > 0. These bounds are all strict except that Equations 33, 35, and 37
are equal to u(s) at s = 0.
Finally, while the above inequalities cannot be used to establish a relationship between the
approximation in Equation 35 and w(s), Equation 36 does provide an upper bound for N wN (s)
in the large N , fixed N s limit (Equation 25), in the sense that
(
S + e−S/2
for S > 0
S
≤
(43)
1 − e−S
− S eS + e3S/2 for S ≤ 0.
To see that the first inequality is true for S > 0, note that

S + e−S/2 /

S
e−3S/2 e−S/2
−S
=
1
−
e
−
+
1 − e−S
S
S
−3S/2

e
=1+
−1 + eS − SeS/2
S

(44)
(45)

Thus, it suffices to show that −1 + eS − SeS/2 ≥ 0 for S > 0. Now, using the series expansion
for the exponential function, we have:
!
!
∞
∞
X
X
−1 + eS − SeS/2 =
S k /k! − S
(S/2)k /k!
(46)
k=1

=

∞
X

k=0

S

k

S

k



k=1

=

∞
X
k=1



k−1

(1/2)
1
−
k!
(k − 1)!



1 − k(1/2)k−1
k!



>0

(47)
(48)
(49)

20

where the last line follows because the terms in the sum are zero for k = 1, 2 and positive for
k ≥ 3 since 2k−1 > k for k ≥ 3. The inequality for S < 0 then follows because






S
(−S)
−S/2
(−S)
3(−S)/2
/
S+e
/
= −(−S) e
+e
for S > 0, (50)
1 − e−S
1 − e−(−S)
so that the proportional error is symmetric around S = 0. Finally, using L’Hôpital’s rule, one
can show that the left hand side of Equation 43 is equal to 1 for S = 0 (as is the right hand
side), so that not only does the inequality in Equation 43 hold for all S, but it is strict for S 6= 0.
A different, but still commonly used, strategy for constructing approximations to the probability of fixation is based on using the tangent of u(s) at s = 0 as an approximation of u(s) for
small s:


1
N −1 s
u(s) ≈
+
,
(51)
N
N
2
or for fixed N s and large N :
s
(52)
N uN (s) ≈ 1 + ,
2
based on the more general expression given by Robertson (1960). Hill (1982) later modified
this approximation to provide more accurate results for advantageous mutations:

1

s
for s ≥ 2



N +1


N −1s
1
1
1
u(s) ≈
(53)
+
for − 2
<s<2

N
N 2
N −1
N +1



1

0
for s ≤ −2
,
N −1
or for large N and fixed S = N s

S
for S ≥ 2



S
(54)
N uN (s) ≈ 1 +
for − 2 < S < 2

2


0
for S ≤ −2.
The approach towards constructing inequalities in the previous section suggests an obvious
parallel to this strategy: by using piecewise linear approximations to log u(s), one can construct
a piecewise exponential approximation to u(s). For instance, the following approximation both
preserves the relation u(s)/u(−s) = e(N −1)s and serves as an upper bound on the probability
of fixation:

log N


1
for
s
≥
2


N −1


 (N −1)s/2
e
log N
log N
u(s) ≈
(55)
for − 2
<s<2

N
N
−
1
N
−
1




log N

 e(N −1)s
for s ≤ −2
.
N −1
21

For large N and fixed N s = S, this approximation simplified to
N uN (s) ≈ eS/2 ,

(56)

which is also an upper bound for Equation 25. Equation 56 has been used previously in the literature (e.g., the supplemental material to Chevin et al., 2014); see also Knudsen and Miyamoto
(2005) who relate Equation 56 to “generalized weighted frequencies (+gwF)” models in molecular evolution (Goldman and Whelan, 2002).
Finally, our analysis of the derivatives of w(s) suggests a completely different approach towards constructing approximations: because the slope of w(s) changes monotonically from 0
to 1 as s goes from −∞ to ∞, and this change is symmetric around s = 0, we can approximate w00 (s) as the cumulative distribution function of a probability distribution, and then inte00
(s) by matching
grate to produce an approximation for u(s). For instance, approximating wN
the
first
two
moments
suggest
using
a
normal
distribution
with
mean
0
and
standard
deviation
p
√
2/3 π/N or a logistic distribution with mean 0 and scale equal to 2/N . For the normal
distribution, this yields the approximations:
2
u(s) ≈ π 2 φ(N s)/N + s Φ(N s)
3

(57)

and for fixed N s = S

2
N uN (s) ≈ π 2 φ(S) + S Φ(S)
(58)
3
where
pφ is the PDF and Φ is the CDF of a normal distribution with mean 0 and standard deviation 2/3π. For the logistic distribution, the corresponding approximations are:
√


N
2
√s
(59)
u(s) ≈
log 1 + e 2
N
and for fixed N s = S
N uN (s) ≈



√
S
√
2 log 1 + e 2 .

(60)

Figures 4 and 5 provide a summary of the various approximations discussed in this section.
While many of these approximations are likely to be useful in some circumstances, the approximation given by Equation 35 has an accuracy comparable to that of w(s) as well as many useful
formal features. In particular, Equation 35 has a convenient functional form, preserves the structure of the equilibrium distribution of the sequential fixations Markov chain, provides an upper
bound on the probability of fixation and can be recast in terms of S = N s when S is large. It
therefore seems appropriate to consider the accuracy of this approximation in somewhat more
detail.
Figure 6 compares the accuracy of w(s) and Equation 35 as a function of N in terms of
the maximum absolute value of the percent error for any s in the range |N s| ≤ 10. While the
22

Fixation Prob.

Log Fixation Prob.

 Error

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

Y

N

N

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

Y

Y

N

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

Y

Y

Y

N

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

N

N

Y

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

Y

Y

Y

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

Y

Y

Y

N

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

Eqn. Fixation Prob.

23

1.0
0.8
0.6
0.4
0.2
0.0

30

1.0
0.8
0.6
0.4
0.2
0.0

32

1.0
0.8
0.6
0.4
0.2
0.0

33

1.0
0.8
0.6
0.4
0.2
0.0

35

1.0
0.8
0.6
0.4
0.2
0.0

37

1.0
0.8
0.6
0.4
0.2
0.0

Reversible Same Eq. Bound SNs

Figure 4: Approximations and their characteristics. For each equation, the first three graphs
show the approximation (black curve) and the true probability of fixation (gray curve) as a
function of s (x-axis) for N = 101; the first graph shows the behavior for large s, the second
graph shows the behavior for small |s|, and the third graph shows the log probability of fixation.
The fourth graph shows the percent error of the approximation as a function of s. The columns
at the right describe whether the approximation has various formal properties (“Y” for yes;
“N” for no). The first of these columns asks if the probability of fixation produces a reversible
Markov chain when used to construct a sequential fixation Markov chain (i.e. does it satisfy
Equation 9 for some choice of ν(N )?). The second column asks if the equilibrium distribution
of the sequential fixations Markov chain is the same as under the exact expression (i.e. does
ν(N ) = N − 1 in Equation 9?). The third column asks if the approximation provides either
an upper or lower bound for the probability of fixation. The last column asks if there is a form
of the approximation such that the corresponding approximation of N uN (s) can be expressed
solely in terms of the compound parameter S = N s when N is large.

23

Fixation Prob.

Log Fixation Prob.

 Error

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

N

N

N

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

N

N

N

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

Y

Y

Y

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

N

N

N

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

0
5
10
15
20
0.2 0.1 0.0 0.1 0.2

20
10
0
10
20
0.2 0.1 0.0 0.1 0.2

N

N

N

Y

0 1 2 3 4

0.10
0.08
0.06
0.04
0.02
0.00
0.10 0.05 0.00 0.05 0.10

Eqn. Fixation Prob.

51

1.0
0.8
0.6
0.4
0.2
0.0

53

1.0
0.8
0.6
0.4
0.2
0.0

55

1.0
0.8
0.6
0.4
0.2
0.0

57

1.0
0.8
0.6
0.4
0.2
0.0

59

1.0
0.8
0.6
0.4
0.2
0.0

Reversible Same Eq. Bound SNs

Figure 5: Approximations and their characteristics. The interpretation is the same as for Figure 4. Note that the approximations in the first two rows both become negative for sufficiently
negative s; thus, the log of the probability of fixation under the approximation reaches −∞ at a
finite value of s, which explains the vertical lines in the third graph.

24

Maximum AbsH% ErrorL

100

10

1

0.1
1

10

100

1000

104

N

Figure 6: Maximum of the absolute percent error for |N s| ≤ 10 of w(s) (gray) and Equation 35
(black) as a function of N . The accuracies of the two approximations are very similar for small
N but diverge for large N . The dashed line shows the large N asymptotic value of the error for
Equation 35.

2.5

% Error

2.0
1.5
1.0
0.5
0.0
-20

-10

0
S

10

20

Figure 7: Percent error of Equation 36 (black) as a function of S = N s. The maximal error of
≈ 2.38% occurs at |N s| ≈ 2.1.

25

accuracy of w(s) gets better and better for large N (as it must by Equation 25), the accuracy
of Equation 35 decreases initially, but then asymptotes at ≈ 2.38%. To understand the source
of this error, it is helpful to look at the large N , fixed N s limit, and compare Equation 36
(i.e. the large N , fixed N s version of Equation 35) with the exact value given by Equation 25.
Figure 7 shows the error in using this approximation as a function of N s. The figure shows
that Equation 36 is extremely accurate for mutations that are strongly beneficial or deleterious,
as well mutations that are very close to neutral, but overestimates the probability of fixation of
slightly advantageous and slightly disadvantageous mutations, with a peak error of ≈ 2.38% at
|N s| ≈ 2.1. Because this magnitude of error is acceptable in most circumstances, Equation 35
provides a very reasonable alternative to w(s) when approximating the probability of fixation.

6

Applications

In order to demonstrate the utility of the results presented so far, we will apply them towards a common goal in molecular evolution: determining the rate of evolution. In the theoretical literature, this rate is typically calculated based on the assumptions that mutations are
entering the population with selection coefficients drawn from some distribution and that each
such new mutation is lost or fixed independently from the others. Using the approximation
N uw (s) ≈ N wN (s) for large N and S = N s fixed, we will write W (S) = N wN (s). Under
this approximation, the rate of evolution is given by
Z ∞
K(X) =
W (Y − X)ψ(Y ) dY
(61)
−∞

(Ohta, 1977; Kimura, 1979) where ψ(Y ) dY is the probability of a mutation occurring with
scaled Malthusian fitness in the interval [Y, Y + dY ], X is the current scaled fitness of the
population and time is measured in units of the inverse of the mutation rate. In other words,
K(X) is the instantaneous substitution rate for a population with fitness X when the distribution
of fitnesses introduced by mutation has a probability density function given by ψ and time is
measured in the expected number of substitutions that would have occurred if all mutations
were neutral.
Our results on the shape of the probability of fixation can provide some immediate insights
into this formula. For instance, one natural question is how the substitution rate changes as
the current fitness, X, changes. It is easy to show that K(X) is decreasing in X (see, e.g.
McCandlish et al., in press), but can we say more than that? Now, suppose that ψ is itself logconcave, as is true for many commonly used distributions (e.g. normal, exponential, uniform
on the interval [a, b]). Then K(X) is also log-concave, since it is the convolution of two logconcave functions, ψ and W , and the convolution of two log-concave functions is log-concave.
Biologically this is quite informative: if the distribution of fitnesses introduced by mutation is
26

log concave, then the substitution rate is not only decreasing as fitness (X) increases, but it is
decreasing at least exponentially.
Another natural question is how K(X) relates to W (Y ∗ ), where Y ∗ is the mean of the
fitnesses introduced by mutation. The fact that w(s) is convex tells us immediately that K(X) ≥
W (Y ∗ ), since the expectation of a convex function of a random variable is greater than the
function evaluated at the expectation (i.e. Jensen’s inequality). This tells us that the common
technique of approximating the distribution of fitnesses introduced by mutation with the mean
fitness effect of those mutations will generally result in an underestimate of the substitution rate,
at least in the large N , fixed N s regime.
While our identities for the probability of fixation can provide qualitative insight into the rate
of evolution, our approximations can produce quantitative advances by allowing direct evaluation of the necessary integrals. For instance, K(X) has often been evaluated for particular
choices of ψ. One frequent choice is to set X = 0 and let ψ be a reflected gamma distribution (e.g. Kimura, 1979). Exact evaluation of the resulting integral is possible in terms of zeta
functions (or the equivalent infinite series) which then require further approximation. Can we
use our approximations for the probability of fixation to get a more useful result? For a gamma
distribution with mean µ and shape k, we have
Z 0
(−S)k−1 e(k/µ)S
W (S) dS
(62)
K(0) =
Γ(k)(µ/k)k
−∞
Z 0

(−S)k−1 e(k/µ)S
S
3S/2
≈
−Se
+
e
dS
(63)
Γ(k)(µ/k)k
−∞

k+1 
k
k
k
=µ
+
(64)
k+µ
k + 3µ/2
where we have used the approximation given by Equation 36. Now, we have seen that Equation 36 provides an upper bound on the probability of fixation, so that the above expression is an
upper bound on the rate of evolution. Furthermore, we have seen that the error in Equation 36 as
compared to W (S) is no more than 2.4% and, so our estimate of the substitution rate is no more
than 2.4% higher than the value we would have obtained using W (S). Under the additional
assumption that µ  k (a common assumption in the literature, since k is typically chosen to
be ≤ 1), we have
 k

k
K(0) ≈
k + (2/3)k .
(65)
µ
This expression is again an upper bound on the substitution rate and turns out to be equivalent to
the result in Equation 10 of (Kimura, 1979), which was derived using an approximation to the
Hurwitz zeta function under the assumption µ  k (see also the discussion around Equation 23
in Welch et al. 2008). For a reflected exponential distribution (k = 1, as in Ohta, 1977),

27

Equation 65 reduces further to
5
K(0) ≈
3

 
1
,
µ

(66)

which agrees with Ohta’s claim, based on numerical results, that the rate of evolution is inversely
proportional to the population size under this model (−µ is the mean scaled selection coefficient
and is therefore proportional to N ).
One obvious defect of a model that assumes that all mutations are deleterious is that it
predicts that the fitness of a population should, over time, decrease indefinitely. One possible
solution to this problem is to assume that the genome is made up of an infinite collection of
independently evolving biallelic loci such that each fixation of an allele with selection coefficient S results in the creation of a potential mutant with selection coefficient −S (Piganeau and
Eyre-Walker, 2003, cf. Bulmer 1991). If we suppose that the probability density function of
the distribution of mutational effects when all such alleles are fixed at their preferred state is
given by ψ(S), then at equilibrium the probability density function of the distribution of mutational effects is given by ψ(−|S|)/(1 + eS ). The most commonly used version of this model
chooses ψ(−|S|) to be the pdf of a gamma distribution, in which case the distribution of mutational effects at equilibrium is known as the partially reflected gamma distribution (Piganeau
and Eyre-Walker, 2003; Welch et al., 2008). What is surprising is that having analyzed a model
of deleterious mutations using the approximation in Equation 36, one can very easily construct
an approximation for the rate of evolution under the corresponding “partially reflected” model,
i.e. the partially reflected model with the same probability density function ψ.
The key to constructing this new approximation is the formula given in Equation I10, which
tells us that W (S) = S +W (−S). If we think about this as a partitioning of the rate of evolution
into one component due to finite population size and another component corresponding to the
substitutions that would still occur in an infinite population, we see that the rate of evolution due
to finite population size depends only on the distribution of |S| and not on the distribution of S
itself. This means that the rate of evolution due to finite population size for a partially reflected
model is always the same as the total substitution rate for a model of deleterious mutations with
the same distribution of absolute values of selection coefficients. Thus, for the case of a partially
reflected gamma distribution, Equation 64 provides an approximation for the rate of evolution
due to finite population size effects (and indeed, an upper bound).
Now, to find the total rate of evolution, one must of course also find the rate of evolution
that would occur in an infinite population. This is given by
Z ∞
Z ∞
ψ(−|S|)
dS ≈
Se−S ψ(−|S|) dS
(67)
S
S
1+e
0
0
Z 0
=
−SeS ψ(−|S|) dS,
(68)
−∞

28

where the approximation is in fact an upper bound. Importantly, the expression in the last line
is just the contribution of the term −SeS to the rate of evolution under the corresponding model
of deleterious fixations when analyzed using the approximation for the probability of fixation
given by Equation 36. Thus, to find the rate of evolution under a partially reflected model of
evolution, one can simply take an approximation for the corresponding model of deleterious
fixations derived using Equation 36 and double the term corresponding to −SeS (e.g. for the
case of a partially reflected gamma distribution, one just doubles the first term in Equation 64).
Such an approximation is always an upper bound compared to using W (S), and the error is
guaranteed to be no more than 14.4% (as can be seen by comparing the contribution to the rate of
evolution of a locus with selection coefficient |S| under the approximation, 2|S|e−|S| + e−3|S|/2 ,
to the true value, |S|/ sinh(|S|)).
Besides ease of computation, such an approximation clarifies the relationship between a
model of deleterious mutations and the corresponding partially reflected model. For instance,
while it is perhaps obvious that the rate of evolution under a partially reflected distribution is
always greater than under the corresponding model of deleterious mutations, the above approximation makes it clear that the increase in the rate of evolution is no more than approximately
two-fold (more precisely, the increase can be no more than 2.024-fold). Furthermore, the approximation makes it clear that this limit is achieved when most selection coefficients are of
relatively large magnitude (e.g. |S| > 3, so that |S|e−|S|  e−3|S|/2 ).
Thus, in summary, the advantage of using the methods described here is not only the ability
to derive novel results such as Equation 64 or our treatment of partially reflected models, but
to do so using elementary techniques and with additional guarantees on the accuracy of the
approximation.

7

Discussion

The probability of fixation for a new mutation plays a central role in evolutionary genetics.
It quantifies the balance between natural selection and genetic drift in simple models, and it
forms a key component in more complex models of evolution. Here, we have presented a
comprehensive analysis of the fixation probability of a new mutation, under the Moran process.
We have seen that the logarithm of the fixation probability behaves in a simple manner and have
leveraged this simplicity to develop a series of identities and inequalities (we have also shown
how these results can be extended to the situation when an allele is initially present in more than
a single copy, see Appendix 1). Finally, we have introduced a number of new approximations
for the fixation probability of a new mutation and summarized their behavior relative to existing
approximations.
Our analysis is based on the remarkable and well-known relation uN (s)/uN (−s) = e(N −1)s .
29

This relation suggests a natural and unified approach towards studying the fixation probability.
First, it immediately implies that the logarithm of the fixation probability behaves in a simple
way, which led to our results on log-concavity and related inequalities. Second, it provides a
method for deriving approximations for the fixation probabilty that preserve the characteristics
of the long-term dynamics when used in sequential fixations models of mutation-limited evolution (e.g. reversibility). The development of such approximations is important because many
standard approximations, such as max(s, 0), produce models that can be grossly inaccurate for
long-term prediction (e.g. strong-selection weak-mutation models, Gillespie, 1983; Orr, 2005).
For instance, whereas the true sequential fixations Markov chain is typically reversible and ergodic, the standard strong-selection approximation either has absorbing states corresponding to
local fitness maxima or else it predicts that fitness increases indefinitely.
Throughout our presentation we have placed emphasis on deriving controlled approximations, that is, approximations where one can bound the magnitude or direction of the error. Such
approximations are important for two reasons. First, they provide peace of mind. One typically
uses an approximation when a certain degree of inaccuracy is acceptable; a controlled approximation guarantees that the inaccuracy is not too great. Second, and perhaps more importantly,
a controlled approximation provides an inequality, and it can therefore be used to prove exact
results.
While our analysis here has been focused on the probability of fixation for a Moran process,
many of our results can be extended to address the probability of fixation under the WrightFisher process. There are two ways to conduct such an extension, depending on whether one
prefers to define s as the difference in the log fitnesses of the invading and resident types, as
we have here, or whether one prefers to use the more traditional definition of s as the ratio
of the invading and resident fitnesses minus 1. Keeping with our convention here, one can
simply substitute 2s for s in any of the expressions that we have derived for a haploid WrightFisher model, and, in addition, substitute 2N for N in the case of a diploid Wright-Fisher
model where fitness is multiplicative within loci. Sella and Hirsh (2005, supporting text) have
shown numerically that the resulting approximation for the probability of fixation has accuracy
comparable to the Kimura (1957, 1962) expression based on the traditional definition of the
selection coefficient; they also provide several conceptual arguments for the superiority of this
choice of selection coefficient. However, if one is interested in controlled approximations then
the traditional choice of selection coefficient may be superior for the Wright-Fisher process.
This is because the Kimura (1957, 1962) expression with the traditional definition of the selection coefficient provides an upper bound on the true probability of fixation for (1) the haploid
Wright-Fisher process (Moran, 1960) and (2) the diploid Wright-Fisher process where fitness
is additive within loci (Bürger and Ewens, 1995). In particular, any of our upper bounds for
the probability of fixation under the Moran process can be converted into upper bounds for the
Wright-Fisher process by formally substituting 2s for s and then treating s as the traditional
selection coefficient (while perhaps also substituting 2N for N if a diploid model is required).

30

One result worth discussing in more detail is the simple identity w(s) = w(−s) + s. What
this identity tells us is that the probability of fixation of a mutation with selection coefficient s
can be partitioned into two components. The first of these components is max(s, 0), which is the
probability of fixation for a new mutation with selection coefficient s in an infinite population
(the strong-selection limit). The second of these components is w(−|s|), which is symmetric
around s = 0 and which captures the effects of finite population size on the probability of fixation. This decomposition of w(s) provides insight into many topics that have previously been
discussed in the literature. For instance, the symmetry of finite population size effects around
N s = 0 provides an additional rationale for why near-neutrality should be defined in terms
of the absolute value of N s, such as (translating to the current context) |N s|  2 (Kimura,
1968) or |N s| < 4 (Li, 1978, cf. Nei 2005 and Razeto-Barry unpublished manuscript). At
the same time, the smooth decay of w(−|s|) makes clear that any specific cutoff is arbitrary.
The symmetry of the finite population-size effects around s = 0 also complements the classical result that the expected waiting time between the introduction of a new mutation destined
to fix and the time that it reaches fixation depends only on the magnitude of N s and not on
its sign (Maruyama and Kimura, 1974; Maruyama, 1974; Taylor et al., 2006, see also, Ewens
2004, pp. 170, 188–191).
A natural application of this decomposition for w(s) is to ask what proportion of the total
substitution rate is due to finite population-size effects and what proportion would still occur in
an infinite population (or, more precisely, what proportion would occur in an infinite population
that found itself fixed for the same set of states as the finite population). Indeed, in unpublished
work Razeto-Barry (unpublished manuscript) has recently suggested this partition of the substitution rate to help resolve the neutralist-selectionist debates, where the neutralist position is
identified with the claim that most substitutions are due to the effects of finite population size
and the selectionist position with the claim that most substitutions would still occur in an infinite
population; our identity on the symmetry of the finite population effects makes this resolution
appear even more natural. Notably, our results in Section 6 show that at equilibrium under any
model of independently evolving biallelic loci with an arbitrary distribution of selection coefficients and no mutational bias, at most 50.6% of substitutions can be due to selection. Thus,
any model producing support for the selectionist position must rely on complications such as
non-equilibrial dynamics, mutational biases, epistasis, etc.
This identity for w(s) also provides additional insight into the relationship between the
strong-selection weak-mutation approximation and the actual dynamics of evolution under weak
mutation. In particular, suppose we have a sequential fixations model with rate matrix Q, where
Q(i, j) describes the rate at which a population currently fixed for allele i would become fixed
for some other allele j and the diagonal entries are chosen so that the rows sum to zero. Then
our result shows that we can write Q = QSel + QNeut where QSel is the rate matrix for the
corresponding strong-selection weak-mutation Markov chain and QNeut summarizes the effects
of finite population size on the evolutionary dynamics. Indeed, while QSel tends to push populations to higher and higher fitnesses, QNeut describes the orthogonal tendency of populations
31

to move laterally across networks of genotypes with similar fitnesses (Conrad, 1990; Huynen
et al., 1996; Gavrilets, 1997; Wagner, 2011).
On the other hand, it is important to note that this decomposition of the rate matrix Q
applies only to the infinitesimal rates and not to the long-term dynamics. For instance, QSel
will generally define an absorbing, rather than ergodic, Markov chain, and QNeut will typically
define a Markov chain whose equilibrium distribution is the same as the distribution of evolution
under mutation alone. However, the equilibrium distribution of the chain defined by Q will not
be a simple function of these two distributions. Moreover, the transition matrix for the process
under Q, Pt = eQt , will generally not equal eQSel t eQNeut t or eQNeut t eQSel t . Thus, even if we
can decompose the instantaneous rate of evolution into the rate due to selection and the rate
due to drift, the long-term effects of selection and drift in finite populations are inextricably
intertwined.

Acknowledgements
We thank Pablo Razeto-Barry for sharing his unpublished manuscript and Warren Ewens
for comments. J.B.P. acknowledges funding from the Burroughs Wellcome Fund, the David
and Lucile Packard Foundation, the James S. McDonnell Foundation, the Alfred P. Sloan Foundation, the U.S. Department of the Interior (D12AP00025), and the Foundation Question in
Evolutionary Biology Fund (RFP-12-16). D.M.M., J.B.P. and C.L.E. acknowledge funding
from the U.S. Army Research Office (W911NF-12-1-0552).

32

References
Berg, J., S. Willmann, and M. Lassig, 2004. Adaptive evolution of transcription factor binding sites. BMC Evol. Biol. 4:42. URL http://www.ncbi.nlm.nih.gov/pubmed/
15511291.
Bulmer, M., 1991. The selection-mutation-drift theory of synonymous codon usage. Genetics
129:897–907.
Bürger, R. and W. J. Ewens, 1995. Fixation probabilities of additive alleles in diploid populations. Journal of Mathematical Biology 33:557–575.
Chen, C. T., Q.-S. Chi, and S. A. Sawyer, 2008. Effects of dominance on the probability of
fixation of a mutant allele. J. Math. Biol. 56:413–434.
Chevin, L.-M., G. Decorzent, and T. Lenormand, 2014. Niche dimensionality and the genetics
of ecological speciation. Evolution Pp. n/a–n/a. URL http://dx.doi.org/10.1111/
evo.12346.
Conrad, M., 1990. The geometry of evolution. Biosystems 24:61 – 81. URL http://www.
sciencedirect.com/science/article/pii/0303264790900305.
Ewens, W. J., 2004. Mathematical population genetics: theoretical introduction, vol. 1. Springer
Verlag.
Fisher, R. A., 1922. Darwinian evolution of mutations. The Eugenics review 14:31.
———, 1930a. The distribution of gene ratios for rare mutations. Proceedings of the Royal
Society of Edinburgh 50:205–220.
———, 1930b. The Genetical Theory of Natural Selection. Clarendon Press, London.
Gale, J. S., 1990. Theoretical population genetics. Springer.
Gavrilets, S., 1997. Evolution and speciation on holey adaptive landscapes. Trends. Ecol. Evol.
12:307 – 312.
Gillespie, J. H., 1983. A simple stochastic gene substitution model. Theor. Popul. Biol.
23:202 – 215. URL http://www.sciencedirect.com/science/article/
pii/004058098390014X.
Goldman, N. and S. Whelan, 2002. A novel use of equilibrium frequencies in models
of sequence evolution. Molecular Biology and Evolution 19:1821–1831. URL http:
//mbe.oxfordjournals.org/content/19/11/1821.abstract.

33

Haldane, J. B. S., 1927. A mathematical theory of natural and artificial selection, part V:
Selection and mutation. Mathematical Proceedings of the Cambridge Philosophical Society
23:838 – 844. URL http://dx.doi.org/10.1017/S0305004100015644.
Hartl, D. L. and C. H. Taubes, 1998. Towards a theory of evolutionary adaptation. Genetica 102-103:525 – 533. URL http://dx.doi.org/10.1023/A:1017071901530.
10.1023/A:1017071901530.
Hill, W. G., 1982. Rates of change in quantitative traits from fixation of new mutations. Proc.
Natl. Acad. Sci. U. S. A. 79:142–145. URL http://www.pnas.org/content/79/
1/142.abstract.
Huynen, M. A., P. F. Stadler, and W. Fontana, 1996. Smoothness within ruggedness: The role
of neutrality in adaptation. Proc. Natl. Acad. Sci. U. S. A. 93:397 – 401. URL http:
//www.pnas.org/content/93/1/397.abstract.
Iwasa, Y., 1988.
Free fitness that always increases in evolution.
J. Theor. Biol.
135:265 – 281. URL http://www.sciencedirect.com/science/article/
pii/S0022519388802431.
Kimura, M., 1957. Some problems of stochastic processes in genetics. The Annals of Mathematical Statistics Pp. 882–901.
———, 1962. On the probability of fixation of mutant genes in a population. Genetics 47:713
– 719. URL http://www.genetics.org/content/47/6/713.short.
———, 1968. Genetic variability maintained in a finite population due to mutational production
of neutral and nearly neutral isoalleles. Genetics Research 11:247–270. URL http://
journals.cambridge.org/article_S0016672300011459.
———, 1979. Model of effectively neutral mutations in which selective constraint is incorporated. Proc. Natl. Acad. Sci. U. S. A. 76:3440–3444. URL http://www.pnas.org/
content/76/7/3440.abstract.
Knudsen, B. and M. M. Miyamoto, 2005. Using equilibrium frequencies in models of sequence
evolution. BMC evolutionary biology 5:21.
Li, W.-H., 1978. Maintenance of genetic variability under the joint effect of mutation, selection
and random drift. Genetics 90:349–382.
Malécot, G., 1952. Les processus stochastique et la méthode des fonctions génératrices ou
caractéristiques. Publ. Inst. Stat. Univer. Paris. 1 3:1–16.
Manhart, M., A. Haldane, and A. V. Morozov, 2012. A universal scaling law determines time
reversibility and steady state of substitutions under selection. Theor. Popul. Biol. 82:66–76.
34

Maruyama, T., 1974. The age of an allele in a finite population. Genet Res 23:137–143.
Maruyama, T. and M. Kimura, 1974. A note on the speed of gene frequency changes in reverse
directions in a finite population. Evolution 28:pp. 161–163. URL http://www.jstor.
org/stable/2407248.
McCandlish, D. M., C. L. Epstein, and J. B. Plotkin, in press. The inevitability of unconditionally deleterious substitutions during adaptation. Evolution URL http://arxiv.org/
abs/1309.1152.
McCandlish, D. M. and A. Stoltzfus, in press. Modeling evolution using the probability of
fixation: history and implications. Quarterly Review of Biology .
Moran, P. A. P., 1959. The survival of a mutant gene under selection. Journal of the Australian
Mathematical Society 1:121 – 126.
———, 1960. The survival of a mutant gene under selection. ii. Journal of the Australian Mathematical Society 1:485–491. URL http://journals.cambridge.org/article_
S1446788700026276.
Nei, M., 2005. Selectionism and neutralism in molecular evolution. Molecular biology and
evolution 22:2318–2342.
Nowak, M. A., 2006. Evolutionary dynamics: exploring the equations of life. Harvard University Press.
Ohta, T., 1977. Extension to the neutral mutation random drift hypothesis. Pp. 148 – 167, in
M. Kimura, ed. Evolution and Polymorphism. National Institute of Genetics, Mishima.
Orr, H. A., 2002. The population genetics of adaptation: The adaptation of DNA sequences.
Evolution 56:1317 – 1330.
———, 2005. The genetic theory of adaptation: A brief history. Nat. Rev. Genet. 6:119 – 127.
Patwa, Z. and L. Wahl, 2008.
The fixation probability of beneficial mutations.
Journal of The Royal Society Interface 5:1279–1289.
URL http://rsif.
royalsocietypublishing.org/content/5/28/1279.abstract.
Peischl, S. and M. Kirkpatrick, 2012. Establishment of new mutations in changing environments. Genetics 191:895–906.
Piganeau, G. and A. Eyre-Walker, 2003. Estimating the distribution of fitness effects from dna
sequence data: implications for the molecular clock. Proceedings of the National Academy
of Sciences 100:10335–10340.

35

Poon, A. and S. P. Otto, 2000. Compensating for our load of mutations: Freezing the meltdown of small populations. Evolution 54:1467 – 1479. URL http://dx.doi.org/10.
1111/j.0014-3820.2000.tb00693.x.
Razeto-Barry, P., unpublished manuscript. Unpublished manuscript .
Robertson, A., 1960. A theory of limits in artificial selection. Proc. R. Soc. Lond. B Biol. Sci.
153:234–249.
Sawyer, S. A. and D. L. Hartl, 1992. Population genetics of polymorphism and divergence.
Genetics 132:1161–1176.
Sella, G. and A. E. Hirsh, 2005. The application of statistical physics to evolutionary biology. Proc. Natl. Acad. Sci. U. S. A. 102:9541 – 9546. URL http://www.pnas.org/
content/102/27/9541.abstract.
Shakarian, P., P. Roos, and A. Johnson, 2012. A review of evolutionary graph theory with applications to game theory. Biosystems 107:66 – 80. URL http://www.sciencedirect.
com/science/article/pii/S0303264711001675.
Taylor, C., D. Fudenberg, A. Sasaki, and M. A. Nowak, 2004. Evolutionary game dynamics in
finite populations. Bulletin of mathematical biology 66:1621–1644.
Taylor, C., Y. Iwasa, and M. A. Nowak, 2006. A symmetry of fixation times in evoultionary
dynamics. J. Theor. Biol. 243:245 – 251. URL http://www.sciencedirect.com/
science/article/pii/S0022519306002529.
Traulsen, A., Y. Iwasa, and M. A. Nowak, 2007. The fastest evolutionary trajectory. J.
Theor. Biol. 249:617 – 623. URL http://www.sciencedirect.com/science/
article/pii/S0022519307003955.
Uecker, H. and J. Hermisson, 2011. On the fixation process of a beneficial mutation in a variable
environment. Genetics 188:915–930.
Wagner, A., 2011. The Origins of Evolutionary Innovations: A Theory of Transformative
Change in Living Systems. Oxford Univ Pr.
Waxman, D., 2011. A unified treatment of the probability of fixation when population size and
the strength of selection change over time. Genetics 188:907–913.
Welch, J., A. Eyre-Walker, and D. Waxman, 2008. Divergence and polymorphism under the
nearly neutral theory of molecular evolution. J. Mol. Evol. 67:418–426. URL http://dx.
doi.org/10.1007/s00239-008-9146-9.
Whitlock, M. C., 2003. Fixation probability and time in subdivided populations. Genetics
164:767–779.
36

Wright, S., 1931. Evolution in Mendelian populations. Genetics 16:97 – 159.
Wu, B., A. Traulsen, and C. S. Gokhale, 2013. Dynamic properties of evolutionary multi-player
games in finite populations. Games 4:182–199.

37

Appendix 1

Results for the probability of fixation of an allele
segregating at intermediate frequency

Almost all of the identities and inequalities presented in the main text carry over to the case
of an allele that is initially at frequency greater than 1/N . To see why, consider the probability
of fixation of an allele that begins with i copies in a population of size N under a Moran process:
1 − e−i s
.
1 − e−N s

(A1)

uN,i (s)
= e(N −i)s ,
uN,i (−s)

(A2)

uN,i (s) =
Now, uN,i (s) satisfies the identity

which is exactly analogous to Equation 2. Because Equation 2 underlies many aspects of our
analysis, it is not altogether surprising that our results extend to this more general setting.
First, let us consider the generalizations of the identities in Table 1. These are given in
Table 3. Second, let us consider the behavior of log uN,i (s). We have:

and

N
i
d
log uN,i (s) =
−
.
N
s
ds
1−e
1 − eis

(A3)

N 2 uN,i (s) uN,i (−s) − i2
d2
log
u
(s)
=
.
N,i
ds2
ei s + e−i s − 2

(A4)

Note that uN,i (s) uN,i (−s) ≤ (i/N )2 (this is easiest to show by analyzing Equation I23) so that
uN,i (s) is again log-concave and the slope of log uN,i (s) decreases monotonically from N − i
to 0 as s goes from −∞ to ∞ in a manner that is symmetric around s = 0.
One can use this log-concavity, together with geometric arguments analogous to those in
Figure 2, to extend the inequalities presented in Section 4 to the situation where an allele begins
at intermediate frequency. In particular we have
uN,i (s) ≤ uN,i (s̃) e

u0N,i (s̃)
(s−s̃)
uN,i (s̃)

.

(A5)

for all s, s̃, and
uN,i (s + c)
uN,i (s)
<
< e(N −i)(s−s̃)
uN,i (s̃ + c)
uN,i (s̃)

(A6)

for s > s̃, c > 0, and the direction of the inequalities in Equations A6 are reversed for s < s̃.

38

uN,i (s) = 1 − uN,N −i (s)
uN,i (s)
= e(N −i)s
uN,i (−s)
N/i−1
X
1
e−k i s
=
uN,i (s)
k=0

Self-consistency

(I17)

Reversibility

(I18)

Finite geometric sum (valid if i divides N )
(I19)

uN −1,i (s)
(1 − uN −1,i−1 (s)) + uN −1,i (s)
uN,i (s) − (1 − e−i s ) = e−i s uN,i (−s)


sinh(is/2)
(N −i)s/2
uN,i (s) = e
sinh(N s/2)
2

sinh(is/2)
uN,i (s) uN,i (−s) =
sinh(N s/2)
0
uN,i (s) = i (1 − uN,i (s)) − e−is u0N,i (−s)
uN,i (s) =

e−s

Recursive formula

(I20)

Comparison with N s  1 limit

(I21)

Hyperbolic identity

(I22)

Hyperbolic identity II

(I23)

Derivative with respect to s

(I24)

Table 3: Extension of identities in Table 1 to initial frequencies greater than 1/N .

39

