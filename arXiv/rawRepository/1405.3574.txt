1

Fast T2 Mapping with Improved Accuracy Using
Undersampled Spin-echo MRI and Model-based
Reconstructions with a Generating Function

Abstract—A model-based reconstruction technique for accelerated T2 mapping with improved accuracy is proposed using
undersampled Cartesian spin-echo MRI data. The technique
employs an advanced signal model for T2 relaxation that accounts
for contributions from indirect echoes in a train of multiple spin
echoes. An iterative solution of the nonlinear inverse reconstruction problem directly estimates spin-density and T2 maps from
undersampled raw data. The algorithm is validated for simulated
data as well as phantom and human brain MRI at 3 T. The
performance of the advanced model is compared to conventional
pixel-based fitting of echo-time images from fully sampled data.
The proposed method yields more accurate T2 values than the
mono-exponential model and allows for undersampling factors
of at least 6. Although limitations are observed for very long
T2 relaxation times, respective reconstruction problems may be
overcome by a gradient dampening approach. The analytical
gradient of the utilized cost function is included as Appendix.

Data
GF
Exp

1
Signal / a.u.

arXiv:1405.3574v1 [physics.med-ph] 13 May 2014

Tilman J. Sumpf*, Andreas Petrovic, Martin Uecker, Florian Knoll, and Jens Frahm

0

0

50

100 150
TE / ms

200

250

Fig. 1. Generating function (GF) and single exponential (Exp) fitted to the
magnitude signal (circles) of a multi-echo spin-echo MRI acquisition of the
human brain (25 echoes, single pixel = arrow). Because the GF is only valid
at exact echo times, the solid curve is an interpolation for display purposes.

Index Terms—FSE, indirect echoes, model-based reconstruction, relaxometry, T2 mapping.

I. I NTRODUCTION
UANTITATIVE evaluations of T2 relaxation times are
of importance for an increasing number of clinical MRI
studies [1]. Conventional T2 mapping relies on the timedemanding acquisition of fully sampled multi-echo spin-echo
(MSE) MRI datasets. Recent advances exploit a model-based
reconstruction strategy which allows for accelerated T2 mapping from undersampled data [2]–[5]. So far, however, these
approaches have been limited to a mono-exponential signal
model, whereas experimental spin-echo trains are well known
to deviate from the idealized behavior, for example, because
of B1 inhomogeneities and non-rectangular slice profiles [6]–
[8]. Under these circumstances, model-based reconstructions
lead to T2 errors even for fully sampled conditions and
additional deviations for different degrees of undersampling.
As a consequence, it is common practice to discard the most

Q

Manuscript submitted May 13, 2014. Asterisk indicates corresponding
author.
*T.J. Sumpf (e-mail: tsumpf@gwdg.de) and J. Frahm are with the Biomedizinische NMR Forschungs GmbH, Max-Planck-Institute for Biophysical
Chemistry, Am Fassberg 11, 37077 Göttingen, Germany.
A. Petrovic and F. Knoll are with the Institute for Medical Engineering,
Graz University of Technology, Austria. A. Petrovic is also with the Ludwig
Boltzmann Institute for Clinical Forensic Imaging, Graz, Austria. F. Knoll is
also with the Center for Biomedical Imaging, New York University School
of Medicine, New York.
M. Uecker is with the Department of Electrical Engineering and Computer
Sciences, University of California, Berkeley, California.

prominently affected first echo of a MSE acquisition [4], [9],
[10].
To overcome the aforementioned problem, an analytical
formula has been proposed which models the MSE signal more
accurately [11], [12]. This work demonstrates the application
of this advanced model [12] for a model-based reconstruction.
The new approach allows for highly accelerated as well
as accurate T2 mapping from undersampled Cartesian MSE
MRI data. Part of this work has been presented in [13]. A
related approach was recently proposed in [14], where the
extended phase graph (EPG) model is used in a dictionarybased linear reconstruction algorithm. First promising results
for a nonlinear inversion of the computationally demanding
EPG algorithm have been reported in [15] for small matrices
(64 × 64 samples).
II. T HEORY
T2 mapping relies on a train of successively refocused
spin echoes. In practical MRI, however, the assumption that
these signals represent the true T2 relaxation decay is violated
due to the formation of indirect echoes [16], [17]. The most
notable consequence is a hypointense first spin echo which
clearly disrupts the expected mono-exponential signal decay.
A variety of attempts to better reproduce the echo amplitudes
employ the EPG algorithm [18]–[21] which considers different
magnetization pathways in a recursive description. In 2007
Lukzen et al. [11] obtained an explicit analytical expression
for the problem by exploiting the generating function (GF)

2

formalism [22], [23]. In contrast to the EPG algorithm, the
model formula can be implemented very efficiently using
the fast Fourier transform. An example of the improved
performance for an extended GF model [12] which includes
non-ideal slice profiles is shown in Fig. 1 for human brain
MRI data.
A. Generating function
The GF for the MSE signal amplitudes is given in the ztransform domain [11]
ρ
Gρ,α,k1 ,k2 (z) =
2
s
(1)
ρ
(1 + zk2 ) [1 − z(k1 + k2 ) cos α + z 2 k1 k2 ]
,
+
2 (−1 + zk2 ) [−1 + z(k1 − k2 ) cos α + z 2 k1 k2 ]
where ρ is the spin density, k1 = exp(−τ /T1) and k2 =
exp(−τ /T2) are the T1 and T2 relaxation terms, α is the
refocusing flip angle and τ the echo spacing. z denotes a
complex variable in the z-domain. Evaluation of (1) on the unit
circle, i.e. for z = exp(iω), ω = 0 . . . 2π, yields a frequencydomain representation of the echo amplitudes at echo times
TE.
The non-uniform flip-angle distribution of a non-ideal slice
profile can be accounted for by superimposing evaluations of
(1) for different values of α [12]. The final formulation in
frequency domain is given by
Q

Sρ,k2 (ω) =

1 X
Gρ,αq ,k1 ,k2 (eiω ),
Q q=1

(2)

with αq a finite number of Q supporting points characterizing
the profile of the refocusing pulse in slice direction. The
values for k1 and the absolute magnitudes of the angles αq
have to be taken from experimentally determined T1 and B1
maps. The echo amplitudes in time domain can be recovered
by application of a discrete Fourier transform (DFT) on the
resulting frequency-domain samples.
Given a series of magnitude images from a MSE train, the
GF approach can be used to determine quantitative T2 values
at different spatial positions by pixel-wise fitting. The method
has been demonstrated to yield more accurate T2 estimations
than a mono-exponential fit [12]. As a potential limitation, (2)
requires a valid T1 and B1 map prior to T2 reconstruction as
well as an estimation of the pulse profile in slice direction.
The influence of errors in these estimates on the reconstructed
T2 maps has previously been elaborated for fully sampled data
[12].
B. Reconstruction from undersampled data
In addition to the DFT Fω along the samples in frequency
domain, (2) can be extended by a two-dimensional DFT Fxy
to synthesize k-spacesamples from estimated parameter maps.
Similar to the approaches described in [2], [4] the conformity
of these (synthetic) data with the experimentally available
samples sc from a MSE acquisition can be quantified with

a cost function
Φ(x) =

1X
kM (x) − sc k22
2 c

M (x) = P Fxy Cc Fω W (x)


ρ
x=
k2

ρ = ρ1 , . . . , ρNp
T
k2 = k2,1 , . . . , k2,Np

(3)
(4)
(5)
(6)
(7)

where the diagonal matrices P and Cc contain the binary
sampling pattern and the complex coil sensitivities of the coil
elements c, respectively. W (x) represents the combined results
from evaluating (2) at all Np pixel positions and Nω frequencies. Minimization of (3) with respect to the components of x
allows for the direct reconstruction of T2 = −τ / ln (k2 ) and
ρ parameter maps from undersampled data.
C. Column-wise reconstruction
When using Cartesian sampling schemes where undersampling is only performed in the phase-direction (y), the Fourier
transform Fx in read-direction can be excluded from the cost
function (3) and replaced by a respective inverse DFT of
the data samples sc prior the iterative reconstruction. This
approach not only reduces the computational costs for the
evaluation of each cost function, but also allows for an
independent and parallel reconstruction of image columns.
This strategy splits the overall image-reconstruction into much
smaller problems, which usually converge significantly faster
than the respective global optimization approach. Another
advantage is the possibility to remove noise columns from
the reconstruction, e.g. by masking columns with an overall
energy below a given threshold.
D. Oversampling on the z-plane
As stated before, evaluation of the GF on the unit circle
in z-domain allows for the calculation of MSE amplitudes by
application of a DFT in z-direction. The range of echo times is
inversely proportional to the frequency resolution, so that for
Nω frequency samples the longest modeled echo time yields
TEmax = Nω τ .

(8)

As a rule of thumb, TEmax should be at least 6 times the
longest T2 within the measured object to ensure a proper
coverage of the T2 signal decay. If this requirement is violated,
the modeled echo amplitudes (i.e., the DFT of the GF) become
distorted due to aliasing in time direction. In practice, typical
T2 mapping protocols use 16 echoes with an echo spacing
of 10 ms. To avoid reconstruction errors for T2 values longer
than about 30 ms, it is therefore reasonable to evaluate (1) for
a considerably higher number of frequency samples than the
number NE of actually measured echoes. Unfortunately, this
oversampling on the z-plane yields a substantial increase of
the computational costs. The current implementation therefore
applied only a moderate oversampling (Nω = 128) to define
T2 values of up to 213 ms (τ = 10 ms) which cover most
tissues in brain [24] and other organ systems except for

3

fluid compartments. In fact, the precise determination of these
very long T2 values has only limited clinical relevance. For
conventional pixel-wise fitting it is therefore reasonable to
accept quantitative errors in regions with T2 values above this
limit. For model-based reconstructions, however, pixels with
an implausible signal behavior or long T2 cannot simply be
excluded from the vector of unknowns. Respective artifacts, in
particular for reconstructions from undersampled data, need to
be treated by additional means (see below).
III. M ATERIALS AND M ETHODS
A. Optimization and gradient scaling
In accordance to [2], [4] we used the CG-DESCENT
algorithm [25] to minimize the nonlinear cost function (3).
This method offers a guaranteed descent and an efficient line
search but requires the gradient of the objective function to
be balanced with respect to its partial derivatives. Therefore,
the vectors k2 and ρ in (5) have been substituted by scaled
variants
ρ̃ = L−1
ρ ρ
k̃2 =

L−1
k k2

(9)
(10)

with Lρ and Lk being diagonal scaling matrices. The dimensioning of the scaling involves several challenges. For
example, we found large T2 values (T2 > TEmax /6) to
provoke very high entries in the cost function gradient, so that
even few discrete regions may lead to a global failure of the
reconstruction process when using scalar values for the scaling. To counterbalance these effects, a dynamic validity mask
has been implemented to detect potentially destructive pixels
during reconstruction and to reduce the gradient scaling in
respective regions. Because such regions are initially unknown
for undersampled data, the reconstruction was performed in
three steps with a fixed number of 3 × 20 CG-iterations
for each image column. After each of the three optimization
blocks, the validity mask was updated and the gradient scaling
was dampened by a factor of 10−5 in regions with a T2 of
either more than TEmax /6 or less than 0 ms. With all data
initially standardized by their overall L2 norm, the scaling was
initialized with heuristically chosen scalar values of Lρ = 1
and Lk = 40.
Pixel-wise fitting of echo-time images involved the Matlab
nlinfit program (MathWorks, Natick, MA), i.e. the Levenberg Marquard algorithm. In contrast to the CG-DESCENT
optimization approach, the gradient was approximated using
the internal finite-difference method of nlinfit rather than the
explicit analytical expression given in the Appendix.
B. Regularization
Especially in the first optimization block, the model insufficiencies for large T2 values can lead to strong outliers in the
reconstructed maps. The effect can be reduced by penalizing
the L2 norm of the difference between estimates ρ and k2
and their initial guesses ρ0 and k2,0 . The technique, known

as Tikhonov regularization, introduces the regularization parameters λρ and λk to the cost function:
1X
kM (x) − sc k22
Φ(x) =
2 c
(11)
2
2
+ λρ kρ − ρ0 k2 + λk kk2 − k2,0 k2
The parameters balance the data fitting term and the penalty
terms and need to be tuned accordingly. Here, we chose an
iteratively regularized approach with starting values of λρ =
1·10−3 and λk = 3·10−3 . After each of the three optimization
blocks, both scaling factors are reduced by a factor of 10−3 .
This yields a moderate regularization at the beginning (far
from the solution) and only minimal regularization at the end.
C. Numerical simulations
To test the algorithm against different conditions, we used
simulated data for a numerical phantom with multiple objects exhibiting equal spin density but different T2 relaxation times ranging from 50 to 800 ms. Simulated noiseless
k-spacesamples for a 160 × 160 data matrix were derived
from superimposed circles using the analytical Fourier space
representation of an ellipse [26], [27]. The signal amplitudes
in time domain were derived using (2) with subsequent DFT
as a forward model. To avoid aliasing in time direction, the
simulated data were derived from 4096 frequency-domain
samples for every phantom compartment. Only the first 17
points were further used in time domain, corresponding to
echo times of 10 to 170 ms. The simulated profile for the
refocusing pulse was derived from a Gaussian using 16 support
points. The T1 map was simulated to yield a constant value
of T1 = 1000 ms throughout the FOV. The B1 field was
simulated to be homogeneous and to correspond to an ideal
flip angle of 180° at the center of the slice profile.
D. MRI measurements
To experimentally validate the accuracy of the approach
using multi-channel data, we used MRI data of a commercially
available relaxation phantom (DiagnosticSonar, Eurospin II,
gel nos 3, 4, 7, 10, 14 and 16). The phantom contains 6
compartments with T2 values ranging from 46 to 166 ms and
T1 values ranging from 311 to 1408 ms (at 21°C). For human
brain MRI, a young healthy volunteer with no known abnormalities participated in this study and gave written informed
consent before the examination.
All MRI experiments were conducted at 3 T (Tim Trio,
Siemens Healthcare, Erlangen, Germany). While radiofrequency excitation was accomplished with the use of a body
coil, signal reception was performed by a 12-channel head
coil in CP mode (circular polarized), thus yielding data from 4
virtual elements. The field map was acquired using the method
by Bloch-Siegert [28] (Gaussian pulse, B1peak = 0.11 G,
KBS = 21.3 rad G−2 ms−1 , 8 s duration, fOR = 8 kHz ,
FOV = 250 × 250 mm2 , matrix = 64 × 32, slice thickness
= 8 mm, α = 60°/120°, scan time = 13 s). T1 values were
obtained using a Turbo Inversion Recovery (TIR) sequence
(TR = 7 s, TE = 7.8 ms, TI = 100−3100 ms, turbo factor = 5,

4

Phase-encoded Lines

Reference maps from fully sampled data were created by
applying the nlinfit tool to magnitude images from the RSS of
all receiver channels. For a constant number of echoes in time
domain, GF-MARTINI was performed for different numbers
of frequency-domain samples with and without the proposed
validity mask. For mono-exponential fits the first echo was
discarded.
IV. R ESULTS
A. Oversampling and adaptive masking

Echo Number
Fig. 2. Cartesian encoding scheme with a blocked undersampling pattern for
acceleration factors of 3 (left) and 4 (right). The examples refer to a k-spaceof
24 phase-encoded lines and 9 echoes. Solid symbols represent acquired lines,
while open symbols refer to lines not measured.

FOV = 250 × 250 mm2 , matrix = 192 × 192, slice thickness
= 4 mm, scan time = 17:5 min) and a traditional magnitude
fitting procedure. The data samples sc were acquired using
a MSE sequence (TR = 4 s, echo spacing = 10 ms, 25
echoes, FOV = 250 × 250 mm2 , matrix = 192 × 192, slice
thickness = 4 mm, scan time = 12:54 min). For the relaxation
phantom, 16 additional (single) spin-echo (SE) experiments
were conducted with the same parameters and equally spaced
echo times TE from 10 to 160 ms (scan time = 206:24 min).
E. Reconstruction and undersampling
Apart from conventional mono-exponential fitting of echotime images, simulated and measured SE and MSE data were
analyzed using the proposed model-based reconstruction with
the GF model (GF-MARTINI = Model-based Accelerated
Relaxometry by Iterative Nonlinear Inversion). Undersampling
for acceleration factors R of up to 12 was simulated using a
”block” pattern as depicted in Fig. 2. In contrast to the scheme
used for mono-exponential MARTINI [4], the pattern was
designed such that the first two echo times are sampled around
the k-spacecenter. In combination with the GF model, this
strategy was found to minimize deviations in the T2 estimation
at different undersampling factors.
The initial spin-density map for GF-MARTINI was set
to zero. The map for k2 was initialized with a value that
corresponds to TEmax /6 for all pixels. The maps for T1 and
B1 were limited to 100 ms < T1 < 5000 ms. B1 values
were limited to correspond to refocussing flip angles of at
least 90° in the center of the assumed Gaussian slice profile.
Coil sensitivities were estimated in a pre-processing step
according to [29] using a fully sampled composite dataset
derived from the mean samples of all echoes. The algorithm
was constrained to shift all phase information into the complex
coil sensitivities, while all parameter maps were assumed to be
real. Finally, the sensitivity map of each receiver channel was
standardized by the root sum square (RSS) of all channels.

Figure 3 shows spin-density and T2 maps of a noiseless
numerical phantom reconstructed by pixel-wise GF fitting
and the proposed GF-MARTINI method without and with
the adaptive validity mask. The 17 time-domain data points
(echoes) per pixel were derived from either 128 or 512
samples in the frequency-domain that define the degree of
oversampling on the z-plane. As expected, even for the pixelbased reconstruction (Fig. 3, left), both the spin-density and
T2 map yield errors for the compartment with the longest
T2 of 800 ms when using only 128 samples (128, arrow).
However, T2 values of the remaining compartments were
accurately reconstructed with less than 2 ms deviation from the
true value. The problem may largely be reduced by extensive
oversampling with 512 frequency-domain samples (512) as
revealed by a mean T2 value of 810 ms in the rightmost
compartment, which is less than 2 % deviation from the true
value.
Figure 3 (center) shows the corresponding maps for GFMARTINI when using 60 iterations per column and an optimized but constant gradient scaling for every pixel (no masking of invalid regions). The results in (128) not only demonstrate the expected deviations for the long-T2 compartment,
but also artifacts (arrows) in the remote part of the columns
that comprise the compartment. While the effect is again
reduced for the higher number of frequency-domain samples
(512), residual artifacts originating from model violations at
the compartment borders persist.
Finally, Fig. 3 (right) demonstrates that all artifacts can be
avoided by the proposed adaptive mask, even for moderate
oversampling of Nω = 128 samples. In this case the numerical
results are in good agreement with the corresponding pixelbased GF fit (128) except for the masked-out right compartment. Here, the values for GF-MARTINI are mainly influenced
by the applied L2 regularization, which is not included in the
pixel-based fit.
B. Accuracy of the GF model
Figure 4 compares spin-density and T2 reconstructions
obtained for a fully sampled SE and fully sampled MSE
dataset. The results for a pixel-wise mono-exponential fitting
of the SE magnitude (measurement time = 206 min) serve as a
reference (ground truth). On the other hand, the corresponding
fitting of the MSE images (first echo removed) yields the
expected T2 overestimation in all compartments (arrows). In
contrast, the GF fitting of the same data results in T2 values
which are remarkably similar to the reference. Deviations in
the surrounding water compartment, which are most notable

5

GF Fit
128
64

GF-MARTINI w.o. mask
128
512

512

GF-MARTINI
128

T2 / ms
0

20

40

60

80

100

120

140

Fig. 3. Spin-density and color-coded T2 maps of a fully sampled numerical phantom with T2 compartments of 50, 100, and 800 ms (surrounding: 80 ms).
The maps were obtained by (left) pixel-based GF fitting (128 and 512 frequency-domain samples) as well as GF-MARTINI reconstruction (middle) without
and (right) with adaptive validity mask. All artifacts due to model violations can be avoided by the proposed method. For details see text.

0
T2 / ms

SE data
Exp
Exp fit
fit

MSE data
Exp fit
4

40

GF fit

GF fit, const T1

5

2
6

80

1

3

120

160

200
Fig. 4. Spin-density and color-coded T2 maps from fully sampled spin-echo (SE) and multi-echo spin-echo (MSE) data. In comparison to the SE reference,
exponential fitting of the MSE data leads to an overestimation of T2 values (arrows), while GF fitting recovers the true values with high accuracy even when
assuming a constant T1 = 1000 ms for all pixels.

in the spin-density map, are again an effect of the limited
frequency domain oversampling (Nω = 128). The quantitative
results from a ROI analysis in Table I confirm the visual
impression. The relative error of the GF fit to the reference is
1 % or less in all compartments. The mono-exponential fit, on
the other hand, yields errors between 16 and 28 %.
A practical limitation of the accurate GF fit is the necessity
for additional B1 and T1 measurements. However, as has
already been pointed out in [12], [21], the influence of T1 on
the GF result is relatively small. This finding is confirmed in
Fig. 4 (right), where additional reconstructions were performed
under the assumption of a constant T1 value of 1000 ms for all
pixels. Although the relative error in T2 increases the stronger

the chosen T1 deviates from the true value, the results are
surprisingly accurate and even for worst cases, the largest error
in the T2 map is still lower than the smallest error of the
mono-exponential fit.
C. Undersampling
For the relaxation phantom, Fig. 5 demonstrates the results
of the proposed GF-MARTINI method (128 frequency samples, validity mask, 3 × 20 CG iterations) for different degrees
of undersampling. Again, effects of the limited oversampling
in the frequency domain are most notable only in the spindensity map for the surrounding water compartment. However,

6

TABLE I
T2 RELAXATION TIMES OF A PHANTOM FOR DIFFERENT FITTING METHODS
Compartment

1

2

3

4

5

6

SE Reference

46 ± 2

81 ± 3

101 ± 2

132 ± 5

138 ± 4

166 ± 5

Mono-Exp

59 ± 4
28.3%

101 ± 5
24.7%

117 ± 4
15.8%

161 ± 5
22.0%

170 ± 4
23.2%

205 ± 7
23.5%

GF

46 ± 3
0.0%

81 ± 4
0.0%

100 ± 3
-1.0%

131 ± 4
-0.8%

137 ± 3
-0.7%

165 ± 5
-0.6%

GF, const T1

44 ± 3
-4.3%

79 ± 4
-2.5%

93 ± 3
-7.9%

130 ± 4
-1.5%

138 ± 3
0.0%

168 ± 6
1.2%

Absolute values represent a ROI analysis and are given in ms (mean ± SD).
Relative values for T2 estimates represent the deviation to the reference.

0

T2
/ms
40

GF-MARTINI
1

2

12

8

6

80

120

160

200
Fig. 5. Spin-density and color-coded T2 maps obtained by GF-MARTINI reconstructions (with validity mask) for undersampling factors of 1, 2, 6, 8 and
12. The corresponding measurement times were 12:54, 6:27, 2:09, 1:37, and 1:05 min. Highly undersampled results reveal minor blurring (red arrow) as well
as occasional ghosts (blue arrows). Mean T2 values are accurate for all undersampling factors.
TABLE II
T2 RELAXATION TIMES OF A PHANTOM USING GF-MARTINI WITH DIFFERENT UNDERSAMPLING FACTORS R
Compartment
R
R
R
R
R
R

=
=
=
=
=
=

1
2
4
6
8
12

1
45
46
46
46
46
46

±
±
±
±
±
±

2
3
4
4
5
4
4

81
82
82
82
82
82

±
±
±
±
±
±

3
4
4
4
5
4
6

97
97
98
98
98
98

4

±
±
±
±
±
±

3
4
4
4
4
7

132
132
133
132
132
133

±
±
±
±
±
±

5
4
4
5
5
6
8

138
138
139
139
139
139

±
±
±
±
±
±

6
3
3
3
4
4
5

166
166
168
167
167
168

±
±
±
±
±
±

5
5
6
6
6
7

Values represent a ROI analysis and are given in ms (mean ± SD).

this region was successfully identified as invalid after the
first optimization block. Apart from that, all other regions are
reconstructed with very high accuracy for all undersampling
factors. Artifacts are barely notable except for some minor
blurring around the compartment with the smallest T2 (red
arrow). For undersampling factor greater than 6, some small
vertical ghosts appear, as most notable in compartments 3 and
6 (blue arrows). For all cases a corresponding ROI analysis
of T2 values is given in Table II. The resulting values are
remarkably stable with deviations of less than ± 2 ms from

the fully sampled SE reference for all compartments and
undersampling factors.
Corresponding results for a transverse section of the human
brain are shown in Fig. 6. Whereas a pixel-wise exponential fit
of the fully sampled MSE data (first echo removed) again leads
to a systematic T2 overestimation, the GF-MARTINI method
presents with good accuracy for all undersampling factors.
The most notable distortions are small vertical ghosts near the
hemispheric fissure, which increase for higher undersampling
factors. For the highest acceleration factor of 12, also the spin-

7

Exp Fit

GF-MARTINI
1

2

12

6

IEEE apparent double width

Map
0

50

100

150

200

250

Difference
-10

-5

0

10

5

T2 / ms
Fig. 6. (Top) Spin-density and (center) color-coded T2 maps of the human brain obtained by (left) exponential fitting of fully sampled data and (right)
GF-MARTINI reconstructions with validity mask for undersampling factors of 1, 2, 6 and 12. The corresponding measurement times were 12:54, 6:27, 2:09,
and 1:05 min. Reconstruction was performed with the use of a previously measured T1 map, requiring an additional measurement time of 17:05 min. (Bottom)
T2 difference maps with respect to the fully sampled reference.
TABLE III
T2 RELAXATION TIMES OF THE HUMAN BRAIN USING PIXEL - BASED METHODS AND GF-MARTINI FOR DIFFERENT UNDERSAMPLING FACTORS R.
Anterior
Cingulate

Insular
Cortex

Thalamus

Putamen

Internal
Capsule

Mono-Exp

101 ± 8

100 ± 10

84 ± 3

76 ± 5

96 ± 6

Frontal
White
Matter
81 ± 3

GF

73 ± 6

76 ± 8

60 ± 2

56 ± 4

70 ± 4

60 ± 2

GF-MARTINI
R=1
R=2
R=6
R = 12

73
71
71
71

GF-MARTINI,
R=1
R=2
R=6
R = 12

const T1
73 ± 6
72 ± 6
72 ± 6
72 ± 7

±
±
±
±

6
6
6
7

76
76
76
76

±
±
±
±

8
8
8
8

59
59
60
60

±
±
±
±

2
2
3
3

55
55
56
56

±
±
±
±

4
4
4
5

69
69
69
70

±
±
±
±

4
4
4
5

59
58
59
59

±
±
±
±

2
3
3
3

77
76
77
77

±
±
±
±

8
8
9
8

59
59
60
60

±
±
±
±

2
2
3
3

55
56
56
56

±
±
±
±

4
5
5
5

69
68
69
69

±
±
±
±

4
4
4
5

58
58
59
59

±
±
±
±

2
2
3
3

Values represent a ROI analysis and are given in ms (mean ± SD).

8

GF-MARTINI, const T1
1

0

2

6

12

T2 / ms

50

100

IEEE apparent double width

150

200

250
Fig. 7. Spin-density and color-coded T2 maps of the human brain obtained by GF-MARTINI reconstructions with validity mask and constant T1 = 1000 ms
for undersampling factors of 1, 2, 6 and 12. The corresponding measurement times were 12:54, 6:27, 2:09, and 1:05 min.

density map suffers from edge enhancement and blurring. A
quantitative ROI analysis of T2 values in various brain tissues
is summarized in Table III. The mean T2 values obtained
by GF-MARTINI are in remarkably good agreement with the
fully sampled reference and very stable for all undersampling
factors. Moreover, Fig. 7 depicts reconstructions of the same
data with the assumption of a constant T1 = 1000 ms for
all pixels. It turns out that the GF-MARTINI reconstructions
with constant T1 are almost indistinguishable from the results
obtained with a full T1 map. The ROI analysis in Table III
confirms this observation as all measurable deviations between
the two GF-MARTINI versions remain within ± 1 ms.
D. Reconstruction time
The computation time of the algorithm mainly depends
on the matrix size, number of receive coils and number of
frequency samples in the z-domain. In addition, the number
of badly conditioned regions in the image can affect the
reconstruction speed. Running on an Intel X5650 Xeon PC
with 12 virtual CPUs @ 2.67 GHz, phantom and human brain
MRI reconstructions in this study took between 2 and 3:45 min
when using 128 frequency samples. Phantom calculations with
Nω = 512 took up to 16 min. However, a major speedup
is expected when performing the calculations on graphic
processing units due to the highly parallelizable structure of
the algorithm.
V. D ISCUSSION
This work demonstrates the adaptation of the GF approach,
which properly describes the signal decay of a multiple spinecho MRI acquisition, for a model-based reconstruction from
highly undersampled MSE data in order to achieve both

fast and accurate T2 mapping. For human brain MRI and
in contrast to a mono-exponential model, the proposed GFMARTINI method yields accurate T2 values for undersampling factors of at least 6, while reasonable T2 maps may
even be obtained for undersampling factors of 12. Limitations
for long T2 relaxation times of fluids are caused by echo-time
aliasing due to the finite sampling of the spin-echo train in
the frequency domain. However, for T2 values within a defined
range of interest, the related errors can be avoided by moderate
frequency-domain oversampling. The numerical instabilities
caused by regions that strongly violate the GF model have
further been shown to be controllable by adaptive masking
and local dampening. Another strategy for a more tolerant
performance for long T2 relaxation times might result from
apodization techniques as proposed in [11]. So far, however,
preliminary trials let to a notable loss of T2 accuracy.
In principle, the estimation of accurate T2 values by GFMARTINI requires prior knowledge of T1 and B1 field
distributions. While deviations in B1 indeed affect the T2
decay of MSE experiments, the T1 influence has been shown
to be relatively small [12], [21]. Depending on the application
and actual range of expected T1 values, the present findings
support the practical feasibility of reliable reconstructions with
the use of a single reasonable T1 estimate. B1 maps may be
acquired at low resolution due to their smooth shape. It is
also conceivable to treat the B1 map as an additional unknown
parameter of the cost function. By jointly estimating B1 along
with T2 and spin-density, additional measurements may be
avoided. However, while preliminary trials yielded promising
results for pixel-based fits, we encountered stability issues
when reconstructing from undersampled data.
A potential limitation of the proposed method is its depen-

9

dency on properly chosen scaling and regularization variables
that balance the gradient components of the nonlinear cost
function. In the current implementation, these variables are
kept at a fixed starting value, while a relatively large number
of 3 × 20 CG iterations per column is used to counter small
deviations from an optimal choice. For a more efficient and
general application of the method, an automatic mechanism
for adjusting the scaling would be highly desirable. Such
development, however, is outside the scope of this work.
A PPENDIX
D ERIVATION OF THE COST FUNCTION GRADIENT
Optimization of the cost function Φ by means of the
CG-DESCENT algorithm requires the implementation of the
gradient of Φ with respect to the components in the scaled
vector of real-valued unknowns x̃. By combining all linear
operations in (3) into a single system matrix Ac for every coil
element c, the cost function can be written as
1X
kAc W (x̃) − sc k22
(12)
Φ(x̃) =
2 c
The gradient of this term is given by
X
∇Φ =
<{DW H (x̃)AH
c [Ac W (x̃) − sc ]}

(13)

c

with DW the Jacobian matrix of W and (·)H referring to the
adjoint. With (·) denoting complex conjugation, the adjoint
system matrix AH
c yields
H
H
AH
c = Fω C c Fxy P

(14)

H
where Fxy
and FωH correspond to the inverse DFT in x−y and
frequency direction, respectively. Calculation of the Jacobian
matrix DW requires the partial derivatives of the scaled model
function
!
r
Lρ ρ̃
λ1 λ2
Gρ̃,α,k1 ,k̃2 (z) =
1+
(15)
2
λ3 λ4

λ1 = 1 + zLk k̃2

(16)
2

λ2 = 1 − z(k1 + Lk k̃2 ) cos α + z k1 Lk k̃2

(17)

λ3 = −1 + zLk k̃2

(18)
2

λ4 = −1 + z(k1 − Lk k̃2 ) cos α + z k1 Lk k̃2

(19)

which are given by
r

∂
Lρ
G
(z) =
∂ ρ̃ ρ̃,α,k1 ,k̃2
2

1+

λ1 λ2
λ3 λ4

!
(20)

and
∂
Lρ ρ̃
Gρ̃,α,k1 ,k̃2 (z) =
Lk
4
∂ k̃2



λ2 z + λ1 λ5
...
λ3 λ4

−1/2
λ1 λ2
λ1 λ2 λ5
λ1 λ2
−z 2 −
λ3 λ4
λ3 λ24
λ3 λ4
λ5 = z 2 k1 − z cos α

for every pixel in image space.

(21)

(22)

ACKNOWLEDGMENT
The authors thank Tom Hilbert from the EPFL Lausanne
for valuable ideas to improve the computational efficiency of
the reconstruction algorithm.
R EFERENCES
[1] H. M. Cheng, N. Stikov, N. R. Ghugre, and G. A. Wright, “Practical
medical applications of quantitative MR relaxometry,” J. Magn. Reson.
Imaging, vol. 36, pp. 805–824, 2012.
[2] K. T. Block, M. Uecker, and J. Frahm, “Model-based iterative reconstruction for radial fast spin-echo MRI,” IEEE Trans. Med. Imag.,
vol. 28, pp. 1759–1769, 2009.
[3] M. Doneva, P. Börnert, H. Eggers, C. Stehning, J. Sénégas, and
A. Mertins, “Compressed sensing reconstruction for magnetic resonance
parameter mapping,” Magn. Reson. Med., vol. 64, pp. 1114–1120, 2010.
[4] T. J. Sumpf, M. Uecker, S. Boretius, and J. Frahm, “Model-based nonlinear inverse reconstruction for T2 mapping using highly undersampled
spin-echo MRI,” J. Magn. Reson. Imaging, vol. 34, pp. 420–428, 2011.
[5] C. Huang, C. G. Graff, E. W. Clarkson, A. Bilgin, and M. I. Altbach, “T2
mapping from highly undersampled data by reconstruction of principal
component coefficient maps using compressed sensing,” Magn. Reson.
Med., vol. 67, pp. 1355–1366, 2012.
[6] S. Majumdar, S. C. Orphanoudakis, A. Gmitro, M. Odonnell, and J. C.
Gore, “Errors in the measurements of T2 using multiple-echo MRI
techniques. 1. effects of radiofrequency pulse imperfections,” Magn.
Reson. Med., vol. 3, pp. 397–417, 1986.
[7] ——, “Errors in the measurements of T2 using multiple-echo MRI
techniques. 2. effects of static-field inhomogeneity,” Magn. Reson. Med.,
vol. 3, pp. 562–574, 1986.
[8] A. P. Crawley and R. M. Henkelman, “Errors in T2 estimation using
multislice multiple-echo imaging,” Magn. Reson. Med., vol. 4, pp. 34–
47, 1987.
[9] H. E. Smith, T. J. Mosher, B. J. Dardzinski, B. G. Collins, C. M. Collins,
Q. X. Yang, V. J. Schmithorst, and M. B. Smith, “Spatial variation in
cartilage T2 of the knee,” J. Magn. Reson. Imaging, vol. 14, pp. 50–55,
2001.
[10] T. J. Mosher, Y. Liu, and C. M. Torok, “Functional cartilage MRI T2
mapping: evaluating the effect of age and training on knee cartilage
response to running,” Osteo. Cart., vol. 18, pp. 358–364, 2010.
[11] N. N. Lukzen and A. A. Savelov, “Analytical derivation of multiple spin
echo amplitudes with arbitrary refocusing angle,” J. Magn. Reson., vol.
185, pp. 71–76, 2007.
[12] A. Petrovic, E. Scheurer, and R. Stollberger, “Closed-form solution
for T2 mapping with nonideal refocusing of slice-selective CPMG
sequences,” Magn. Reson. Med., 2014.
[13] T. J. Sumpf, F. Knoll, J. Frahm, R. Stollberger, and A. Petrovic,
“Nonlinear inverse reconstruction for T2 mapping using the generating
function formalism on undersampled cartesian data,” in Proc. 20th Ann.
Meeting. ISMRM, Melbourne, 2012, p. 2398.
[14] C. Huang, A. Bilgin, T. Barr, and M. I. Altbach, “T2 relaxometry with
indirect echo compensation from highly undersampled data,” Magn.
Reson. Med., vol. 70, pp. 1026–1037, 2013.
[15] C. L. Lankford and M. D. Does, “Fast, artifact-free T2 mapping with
fast spin echo using the extended phase graph and joint parameter
reconstruction,” in Proc. 21th Ann. Meeting. ISMRM, Salt Lake City,
2013, p. 2461.
[16] J. Hennig, “Multiecho imaging sequences with low refocusing flip
angles,” J. Magn. Reson., vol. 78, pp. 397–407, 1988.
[17] ——, “Echoes - how to generate, recognize, use or avoid them in
MR-imaging sequences. part I: Fundamental and not so fundamental
properties of spin echoes,” Conc. Magn. Reson., vol. 3, pp. 125–143,
2005.
[18] D. E. Woessner, “Effects of diffusion in nuclear magnetic resonance
spin-echo experiments,” J. Chem. Phys., vol. 34, p. 2057, 1961.
[19] V. G. Kiselev, “Calculation of diffusion effect for arbitrary pulse
sequences,” J. Magn. Reson., vol. 164, pp. 205–211, 2003.
[20] Y. Zur, “An algorithm to calculate the NMR signal of a multi spin-echo
sequence with relaxation and spin-diffusion,” J. Magn. Reson., vol. 171,
pp. 97–106, 2004.
[21] R. M. Lebel and A. H. Wilman, “Transverse relaxometry with stimulated
echo compensation,” Magn. Reson. Med., vol. 64, pp. 1005–1014, 2010.
[22] L. Comtet, “Advanced combinatorics: The art of finite and infinite
expansions,” D, Reidel Publishing Company, 1974.
[23] H. S. Wilf, Generating functionology. A. K. Peters, 1990.

10

[24] C. S. Poon and R. M. Henkelman, “Practical T2 quantitation for clinical
applications,” JMRI, vol. 2, pp. 541–553, 1992.
[25] W. W. Hager and H. A. Zhang, “A new conjugate gradient method with
guaranteed descent and an efficient line search,” SIAM J. Optim., vol. 16,
pp. 170–192, 2006.
[26] M. Slaney and A. Kak, “Principles of computerized tomographic imaging,” SIAM Philadelphia, 1988.
[27] R. Van de Walle, H. H. Barrett, K. J. Myers, M. I. Altbach, B. Desplanques, A. F. Gmitro, J. Cornelis, and I. Lemahieu, “Reconstruction of MR
images from data acquired on a general nonregular grid by pseudoinverse
calculation,” IEEE Trans. Med. Imag., vol. 19, pp. 1160–1167, 2000.
[28] L. I. Sacolick, F. Wiesinger, I. Hancu, and M. W. Vogel, “B1 mapping by
bloch-siegert shift,” Magn. Reson. Med., vol. 63, pp. 1315–1322, 2010.
[29] M. Uecker, T. Hohage, K. T. Block, and J. Frahm, “Image reconstruction
by regularized nonlinear inversion - joint estimation of coil sensitivities
and image content,” Magn. Reson. Med., vol. 60, pp. 674–682, 2008.

