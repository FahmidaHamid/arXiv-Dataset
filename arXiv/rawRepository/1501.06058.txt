Flow Distances on Open Flow Networks
Liangzhu Guo,1 Xiaodan Lou,1 Peiteng Shi,2 Jun Wang,2 Xiaohan Huang,2 and Jiang Zhang1, ‚àó
1

arXiv:1501.06058v1 [physics.soc-ph] 24 Jan 2015

2

School of Systems Sciences, Beijing Normal University, Beijing, China
Science and Technology on Information Systems Engineering Laboratory,
National University of Defence Technology, Changsha, China
(Dated: January 27, 2015)

Open flow network is a weighted directed graph with a source and a sink, depicting flux distributions on networks in the steady state of an open flow system. Energetic food webs, economic
input-output networks, and international trade networks, are open flow network models of energy
flows between species, money or value flows between industrial sectors, and goods flows between
countries, respectively. Flow distances (first-passage or total) between any given two nodes i and j
are defined as the average number of transition steps of a random walker along the network from i
to j under some conditions. They apparently deviate from the conventional random walk distance
on a closed directed graph because they consider the openness of the flow network. Flow distances
are explicitly expressed by underlying Markov matrix of a flow system in this paper. With this novel
theoretical conception, we can visualize open flow networks, calculating centrality of each node, and
clustering nodes into groups. We apply flow distances to two kinds of empirical open flow networks,
including energetic food webs and economic input-output network. In energetic food webs example, we visualize the trophic level of each species and compare flow distances with other distance
metrics on graph. In input-output network, we rank sectors according to their average distances
away other sectors, and cluster sectors into different groups. Some other potential applications and
mathematical properties are also discussed. To summarize, flow distance is a useful and powerful
tool to study open flow systems.
PACS numbers: 89.90.+n

I.

INTRODUCTION

A large number of studies have proved that complex
network is a powerful and useful tool to model complex systems[1‚Äì4]. However, due to the limitation of the
traditional graphs for describing the complexity of the
various real systems, weighted networks[5, 6], directed
networks[7], bi-partite graphs[8], multiplex[9, 10], temporal networks[11] as novel extensions of the conventional
graphs emerge in the past decade. Among these, open
flow network is a particular kind of directed weighted
network to depict open flow system.
Most complex systems are open, they exchange energy
and material with their environment[12]. Energy and
material flows are delivered to each unit of a system by
the flow network[13, 14]. The distribution of these flows
in the entire body of a system is described by directed
weighted edges. Two special nodes ‚Äúsource‚Äù and ‚Äúsink‚Äù
are always added in the system to represent environment.
Because the flow system considered is supposed to be in a
steady state, the flow network is always balanced which
means that the total inflow of each node equals to its
total out flow except for the sink and the source.
Energetic food web is a typical open flow network
which has been studied for several years by system ecologists. The seminal work of H.T. Odum [15, 16] has
depicted complicated energy flow transactions between
two species as energy circuit. A bunch of indicators

‚àó

zhangjiang@bnu.edu.cn; http://www.swarma.org/jake

have been proposed to quantify the properties of this
open flow network[17‚Äì20], and numeric common properties have been discovered[21‚Äì25]. Patten et al. proposed
a systematic ‚ÄúEcological Flow Analysis‚Äù method to investigate energetic flow networks[26, 27].
Indeed, many basic ideas and approaches of flow analysis on energetic food webs inherit from the economic
input-output analysis method[28] which is first proposed
by the famous economist Leontief[29, 30]. To quantify the
complex economic production processes and the interaction between different economic sectors, an input-output
matrix is calculated for an economic system to represent
goods flows[31, 32]. Following Leontief‚Äôs seminal work,
Hanon introduced basic notions such as fundamental matrix to ecology for describing the energy flows between
species[33]. Therefore, an input-output matrix can also
be regarded as an open flow network. Money flow from
the final demands compartment, circulate in different sectors of an economic system, and eventually flow to the
value added compartment (or goods flow in an inverse
direction). Thus, value-added compartment can be regarded as the sink, and final demands can be regarded as
the source. The money flow from industry i to industry j
is always measured by the uniform currency unit, therefore the total out flow from the source equals the total
inflow to the sink, and is identical to the gross domestic
output of an economy[31, 32]. Other examples of open
flow networks include clickstream networks[34, 35] and
trade networks[36]. In summary, open flow network is a
very useful tool to depict various open flow systems.
Distance on graph is a very useful concept[37]. Both
the shortest path distance[38], resistance distance[39] and

2
the mean first-passage distance of a random walker[40‚Äì
43] can reflect the intrinsic properties of the graph. However, conventional first-passage distance on a graph is
based on the basic assumption that the whole network
is closed, which means the random walker cannot escape
from the network, thus the total number of walkers on the
graph is conservative. Nevertheless, the open flow network is an open system. Random walkers can flow into
the system from the source and flow out to the sink despite the total number of walkers staying in the network
can be also conservative if the flow system is in a steady
state. Therefore, the traditional method for closed system cannot be simply extended to open flow networks. It
is necessary to extend the distance notions for open flow
networks.
This paper is organized as follows. In section II, the
flow distance quantities from i to j are defined. The
explicit form of each flow distance is expressed in subsection II C. Sub-section II D shows how the distance
matrix is calculated on an example flow network. In
sub-section III A, we apply our method to energetic food
webs, visualize each species by its trophic level, and compare different distances on the food webs. The applications of flow distances on input-output network including
network visualization, sector clustering, and vertex centrality are introduced in sub-section III B. Finally, we
give a short summary for all the paper and the perspective of flow distances in section IV.
II.

FLOW DISTANCES

In this section, we will present the definitions and calculations of flow distances. Three flow distances, namely
first-passage flow distance, total flow distance, and symmetric flow distance, are defined. They all can be expressed by the Markov matrix of the open flow network. To obtain the final expressions, some intermediate
concepts including total flow and first-passage flow are
needed to be introduced.
A.

Suppose a large number of particles flow along links
in the network F , the directed flow fij from i to j is
the total number of particles that jump from i directly
to j along edge i ‚Üí j in each time. The particles may
jump from i to j along indirected paths, we define the
first-passage flow from i to j denoted by œÜij as the
number of particles that reach j in each time step for
the first time and have been visited i. And the average
step that these particles have jumped is defined as the
first-passage flow distance which is denoted by lij .
Similarly, the total flow from i to j denoted as œÅij is
defined as the total number of particles that have been
visited i and arrive at j in each time no matter if it is the
first time or not. And the average step that these particles have jumped is defined as the total flow distance
which is denoted by tij .
To understand these quantities better, let‚Äôs consider
the following imaginary experiment. Suppose all the particles passing by node i are dyed red and this color would
be washed out once the red particles arrive at node j for
the first time. Then the first-passage flow from node i to
j is the number of red particles passing by node j in each
time. The first-passage flow distance is the average step
that these particles have made. Similarly, if the particles
passing by i are dyed red but this color would never be
washed out, then the number of red particles that pass
by j in each time is the total flow, and the average step
that these particles have made is the total flow distance.
In this paper, all the matrices are denoted by capital
letters, and the their corresponding elements are denoted
by lower case of the name of matrices. For example, F
denote the flow matrix, and fij is the element of the ith
row and jth column

B.

Calculation of total flow and first-passage flow

Because the open flow system is in a steady state, and
the flow network is balanced, we can define a Markov
matrix M as follows,
fij
mij = PN +1

Definitions

j=1

Consider an open flow network with N common nodes
and two special nodes ‚Äúsource‚Äù denoted by 0 and ‚Äúsink‚Äù
denoted by N +1 are added. An (N +2)√ó(N +2) matrix
F can be used to represent flows, and each entry fij ,
where i, j ‚àà 0, 1, 2, ¬∑ ¬∑ ¬∑, N + 1, represents the flow from
node i to j. Note that the elements in the first column
and the last row are all equal 0 because there are no
inflow to the P
source and no out flow for the sink. We also
N +1
define fi¬∑ = j=0 fij as the total out flow from i, and
PN +1
f¬∑j = i=0 fij as the total inflow to j. In our research,
the flow network should be balanced, which means that
f¬∑i = fi¬∑ for every node i except ‚Äúsource‚Äù and ‚Äúsink‚Äù.
Particularly, we name fi,N +1 , the flow from i to the sink,
as dissipation.

fij

(1)

and mij represents the probability of particles jumping
PN +1
from state i to j. Note that j=1 mij = 1 for any i
except N + 1 because the elements in the last ((N + 1)th)
row are all zeros, this is a key difference between open
flow network and closed flow network.
According to reference [19], no matter if circulations
exist in network, the total flow from i to j can be calculated as:
œÅij = œÜ0i uij ,

(2)

U = I + M + M 2 + ¬∑ ¬∑ ¬∑ = (I ‚àí M )‚àí1

(3)

where

3
is called fundamental matrix, it is also the inverse of
M ‚Äôs laplacian. And œÜ0i is the first-passage flow from the
source to i which will be calculated in the following paragraphs. I is the identity matrix with size (N +1)¬∑(N +1).
We will provide an informal proof for Eq (2).
Equation (2) calculates the total flows along all possible paths from i to j. When i 6= j, the number of particles
that jump from i to j along all possible paths with k steps
is œÜ0i (M k )ij . Note that particles may flow back to i for
several times, œÜ0i instead of f¬∑i is adopted because f¬∑i
contains the flows back to i. If the particle passing by i
is dyed, then œÜ0i is the number of particles without color
marker and will be dyed in each time. Taking summation
of œÜ0i (M k )ij from k = 1 to ‚àû, we can obtain the total
flow from i to j along all possible ways. According to the
series expansion M U = M (I ‚àí M )‚àí1 = M + M 2 + ¬∑ ¬∑ ¬∑
and the identity (M U )ij = uij when i 6= j, Eq. (2) is
obtained.
When i = j, according to œÅ‚Äôs definition, œÅii should contain the first-passage flow from the source to i, therefore,
œÅii = œÜ0i ((M U )ii + 1) = œÜ0i ((M U )ii + Iii ) = œÜ0i uii , then
Eq. (2) holds.
Because the total flow from i to j can be divided
into two different categories, one is the first-passage flow
which contains the particles that arrive at j for the first
time, the other is the circulation flow which contains the
particles that arrive at j more than once. All the flows
are conditioned on starting from i. We know that the
circulation flow is the summation of flows from j to j
along all possible paths, it is calculated as
‚àû
X
œàij = œÜij (
M k )jj = œÜij (M U )jj ,

(4)

k=1

where œàij represents the circulation flow starting from i.
Therefore, the total flow from i to j can be expressed
as[19]
œÅij = œÜij + œàij = œÜij ujj .

œÅij
.
ujj

Calculation of flow distances

We can deduce the explicit expression of various flow
distances once the total flow and first-passage flow expressions are given. First, according to the definition of
the total flow from i to j along all possible paths, we have
tij =

‚àû
X

kpkij ,

(6)

(9)

k=1

where pkij denotes the probability that particles transfer from i to j after k steps. One may think pkij =
(M k )ij , however, it is not true because pkij is normalized for all paths with all possible lengths k, i.e.,
P
‚àû
k
k
k=1 pij = 1. However, (M )ij is normalized for all
PN +1
js, i.e., j=0 (M k )ij = 1. We know that the flow from
i to j after k steps is œÜ0i (M k )ij and the total flow along
all possible paths is œÅij , therefore,
pkij =

œÜ0i (M k )ij
.
œÅij

(10)

Thus bring this equation to Eq. (9), we have,
P‚àû
‚àû
X
œÜ0i ( k=1 kM k )ij
œÜ0i (M k )ij
tij =
k
=
œÅij
œÅij
k=1

=

œÜ0i (M U 2 )ij
œÜ0i (M U 2 )ij
=
œÅij
œÜ0i uij

=

(M U 2 )ij
.
uij

(11)

In which, we have used the following series expansion:
MU2 = M



1
I ‚àíM

2

=

(5)

Thus, we obtain the expression for the first-passage flow
from i to j:
œÜij =

C.

‚àû
X

kM k .

(12)

k=1

Similarly, we can obtain the expression for first-passage
flow distance. First, according to the definition of the
first-passage distance from i to j, we have
lij =

‚àû
X

k
kqij
,

(13)

k=1

Based on the equations of Eq. (2) and Eq. (6), and
note that œÜ00 = f0¬∑ according to the definition, where f0¬∑
denotes the total flow from ‚Äúsource‚Äù to the whole system,
we have
œÅij = œÜ0i uij =

u0i
œÅ0i
uij = f0¬∑
uij .
uii
uii

(7)

And the explicit expression for the first-passage flow is
œÜij =

œÅij
1
u0i uij
= œÜ0i uij
= f0¬∑
.
ujj
ujj
uii ujj

(8)

k
where qij
denotes the probability that particles started
from i to j after k steps in the first time. One cannot
use pij (Eq. (10)) because it contains the circulation flow
from j to j. Let us assume that all the particles arriving
at j will be removed from the system, that is to say, we
assume that j is another sink, then all the calculations
for the total flow distance is correct. To make this point
clear, we define a new matrix M‚àíj as:

mrs , r 6= j
(M‚àíj )rs =
(14)
0,
r = j.

4
k
And the correct expression for the probability qij
is
k
qij
=

k
œÜ0i (M‚àíj
)ij
.
œÜij

(15)

Insert it into Eq. (13), we have

lij =

2
ujj (M‚àíj U‚àíj
)ij
.
uij

(16)

According to the Theorem 1 proved in the Supplementary Material, when uij 6= 0 (i connects to j), this formula can be reduced to
lij =

(M U 2 )ij
(M U 2 )jj
‚àí
= tij ‚àí tjj .
uij
ujj

(17)

Therefore, the difference between tij and lij is just the
total flow distance from j to j. The matrix (tjj )N +1,N +1
have identical rows. Therefore, we can use a vector tj to
abbreviate the matrix tjj , it quantifies the ability of self
circulation of each node in the system.
All the flow distances introduced above are asymmetric, however, some real tasks such as nodes clustering,
computation of node centrality require symmetric metrics. Commute distance[42, 43] is a classical and famous
symmetric distance measure defined by random walk,
which is calculated by lij + lji . However, this definition
cannot work when one of lij or lji is infinity meaning that
i cannot access j or vice versa. Therefore, we define a
new symmetric flow distance to avoid this problem:
cij = 2

1
lij

1
+

1
lji

=

2lij lji
.
lij + lji

(18)

We call cij symmetric flow distance, it is a mixing of lij
and lji . Suppose lij = ‚àû, then cij = 2lji which is welldefined. When lij = lji , cij = lij = lji . Therefore, cij is
a reasonable symmetric distance.
D.

Calculation on an example network

Before applying our method to real open flow networks,
we would like to present the computations of flow distances on a small example network and compare with
other distances on graph. The example network is shown
in Figure 1. There are 7 nodes including the source and
the sink. All the flows are denoted on the edges. We
present the first-passage flow distances matrix L in the
following equation
Ô£Æ
Ô£Ø
Ô£Ø
Ô£Ø
Ô£Ø
Ô£Ø
Ô£Ø
Ô£Ø
Ô£∞

0
‚àû
‚àû
‚àû
‚àû
‚àû
‚àû

Ô£π
1 2.15 2.27 3.20 3.40 3.94
0 1.15 1.27 2.20 2.40 2.94 Ô£∫
Ô£∫
‚àû 0 2.25 1.05 1.25 2.13 Ô£∫
Ô£∫
‚àû 1
0 2.05 2.25 1.61 Ô£∫
‚àû 3
2
0
1 1.60 Ô£∫
Ô£∫
‚àû 2
1 3.05 0 1.20 Ô£ª
‚àû ‚àû ‚àû ‚àû ‚àû
0

(19)

FIG. 1. An example open flow network

and the total flow distances matrix T
0
Ô£Ø‚àû
Ô£Ø
Ô£Ø‚àû
Ô£Ø
Ô£Ø‚àû
Ô£Ø‚àû
Ô£Ø
Ô£∞‚àû
‚àû
Ô£Æ

1
0
‚àû
‚àû
‚àû
‚àû
‚àû

2.23
1.23
0.08
1.08
3.08
2.08
‚àû

2.35
1.35
2.33
0.08
2.08
1.08
‚àû

3.23
2.23
1.08
2.08
0.03
3.08
‚àû

3.48
2.48
1.33
2.33
1.08
0.08
‚àû

Ô£π
3.94
2.94 Ô£∫
Ô£∫
2.13 Ô£∫
Ô£∫
1.61 Ô£∫
1.60 Ô£∫
Ô£∫
1.20 Ô£ª
0

(20)

Note that there are many ‚àû entries in both L and T
because the corresponding node pairs have no connected
path. Another interesting phenomenon is all the elements
in T are larger than the corresponding entries in L. And
the difference (T ‚àí L) is:
Ô£π
Ô£Æ
0 0 0.08 0.08 0.03 0.08 0
Ô£Ø 0 0.08 0.08 0.03 0.08 0 Ô£∫
Ô£∫
Ô£Ø
0.08 0.08 0.03 0.08 0 Ô£∫
Ô£Ø
Ô£∫
Ô£Ø
0.08 0.08 0.03 0.08 0 Ô£∫
(21)
Ô£Ø
Ô£Ø
0.08 0.08 0.03 0.08 0 Ô£∫
Ô£∫
Ô£Ø
Ô£∞
0.08 0.08 0.03 0.08 0 Ô£ª
0
The empty entries have no numeric value because ‚àû ‚àí
‚àû is indefinite. All the elements in the same column are
identical which are the average flow distances from i to
i for i = 2, 3, 4, 5. And because 2, 3, 5 are in the same
cycle 2 ‚Üí 5 ‚Üí 3 and 2 ‚Üí 4 ‚Üí 5 ‚Üí 3, they have the
same values of tjj .
Next, we compare our first-passage flow distance lij
with shortest path distance and first-passage distance
based on random walks[41] on the closed version of the
same network. In the latter comparison, ‚Äúsource‚Äù and
‚Äúsink‚Äù are excluded so that the network is closed. For
the random walkers in the closed network, the transition probability between i and j is the fraction between
fij and (fi¬∑ ‚àí fi,N +1 ), the total out flows from i excluding the dissipation from i . For example, the transition
probability from 2 to 4 is 20/(20 + 30) = 0.4 but not
20/(20 + 30 + 10) = 0.33. The results are shown in Table
I.

5
TABLE I. Comparisons among three kinds of distances on
selected node pairs
1‚Üí3 2‚Üí3 1‚Üí4 2‚Üí4
Shortest path 1
2
2
1
Closed FPD
2.5 2.4 6.875 5.5
Open FPD
1.274 2.25 2.2 1.055

As we expected, shortest path lengths are much shorter
than the other two distances because they only consider the shortest paths, as a result, this distance always under-estimates the distances of random particles
in flows. Comparing two first-passage distances is more
interesting. Closed First Passage Distance (Closed FPD)
is always larger than Open First Passage Distance (Open
FPD) because dissipations are not considered in Closed
FPD. For example, the Closed FPD from 1 to 4 is larger
than the Open FPD in almost 3 times because the longer
circulated path 2 ‚Üí 5 ‚Üí 3 ‚Üí 2 has much higher probability when the dissipation from node 2 is neglected (0.6
rather than 0.5).

III.

EMPIRICAL STUDIES

In this section, we will apply our flow distances on two
kinds of networks: 18 energetic food webs (energy flow
information between species is included) and the inputoutput network of U.S. The raw data of food webs is from
the following open data source[44]. And the input-output
network data is from[45].

A.

Food web

Trophic level is an important concept in food webs, it
characterizes one species‚Äô distance from the source (sun
light) along the food chain. However, when the food web
is an entangled network, calculating the shortest path
from the source always under-estimates the trophic level
of a given species because non-shortest paths may have
much longer distances from the source. Therefore, we
quantify trophic levels of different species by the concept
of first-passage distance from the source[20], that is l0i
for any species i. This distance is reasonable because
it contains the information of weights and all possible
energetic path ways from the source. Figure 2.a visualizes the trophic levels of 125 biological species in Baydry
food web. Producer species locate at the area close to
the source, and higher level consumers locate in the peripheries.
Next, we calculate several distances in the level of the
entire network. The first distance is the first-passage
distance from the source to the sink (l0,N +1 ). This distance quantifies the average number of steps of a random
particle in its all life span. The second distance is the
mean value of the elements in matrix L except for the

infinite elements. We calculate these distances for all the
collected energetic food webs, and to observe how the
distances change with network size.
Figure 3 shows various distances change with number
of edges of networks. We find that the average value of
lij has similar trend with the average path length l0,N +1
from the source to the sink. Shortest path length is always shorter than the average l and l0,N +1 because it
does not consider the average behaviour of random walkers. There is a slightly trend that the network lengths
increase with network size.

B.

Input-output network

Input-output network is another kind of flow network.
Each industrial sector corresponds to a vertex, and an
input from one sector to another can be considered as a
flow. However, there are two kinds of views to represent
an input-output network as a flow network. If we consider
material flow, then the input from sector i to j should be
understood as a flow from i to j. However the flow may
be from j to i if money flow is considered. We adopt the
viewpoint of money flow in this paper because the flow
of money in different sectors resembles random walkers
in open flow networks. In this way, the final demand
sector is the source of money flows, and the value added
sector is the sink. We choose the input-output data from
United States in 2000 as an example to calculate various
flow distances.
First, it is curious to calculate the economic ‚Äútrophic
levels‚Äù (l0,i ) of different sectors (see Figure 2.b). The
sectors with shorter distances from the center are closer
to the source, therefore they are more easily to be affected
by the final demand. Any fluctuations of demands or
price can be transferred to the sectors with lower ‚Äútrophic
levels‚Äù.
Second, we can use flow distances to calculate similarity between different sectors. Because it is much easier to
deal with symmetric similarity, we use the distances cij
instead of lij here. With this symmetric measure, we can
cluster sectors by using the standard hierarchical clustering techniques[46]. The result is visualized by Figure 4.
In this figure, similar or related sectors are gathered
closely, like P ublic admin and Health & socialwork,
M ing and F uel. We also find that Real estate sector
is close to F inance sector, which means real estate has
tight relation with finance in U.S. The clustering results
have good agreement with our common sense of industrial sectors.
Furthermore, the symmetric measure cij can be used
to measure the centrality of each node because if i‚Äôs average cij for different j is shorter then i must have tight
connections with all other nodes. Formally, we define the
centrality of node i as
c¬Øi =

PN

j=1 cij

N

(22)

6

FIG. 2. Trophic levels of species in Baydry community (a) and industrial sectors of U.S. input-output network in 2000 (b). The
polar radii, i.e., the distances between every node and the center are proportional to nodes‚Äô trophic levels, the polar angles are
randomly assigned, and the sizes of nodes are proportional to the logarithmic volumes of the total throughflow for each node
(fi¬∑ ). The colors are assigned randomly.

5.5
Shortest path
Average L
Source to sink

5
4.5

Distance

4
3.5
3

the average.
Finally, we calculate the vector ti for all i. It is defined
as the average steps of a random walker who starts from
i and finally returns to i again. This measure indicates
the re-cycle capability of a sector in the sense of money
flow. Therefore, less ti implies larger capability of selfmaintenance of this sector. In Table II, we show the top
5 and bottom 5 sectors in the decreasing order of ti in
the United States.

2.5

TABLE II. List of sectors sorted by ti
2
1.5
1
10

2

10

3

Number of Links

FIG. 3. Three kinds of distances for all collected energetic
food webs. All food webs are sorted according to their number
of edges in an increasing order

Thus, the shorter is i‚Äôs c¬Øij , the more central position
it has in the whole economic system. We color different nodes in Fig. 4 by c¬Øi . The color depth increases as
ci decreases. We find that T rade and P ublic admin.
sectors are more central than other sectors in U.S., and
Agriculture and M ing sectors are less important than

Rank
1
2
3
4
5
..
.
32
33
34
35
36

Sectors in USA
Motor vehicles, trailers and semi-trailers
Finance and insurance
Basic metals
Chemicals and chemical products
Agriculture, hunting, forestry and fishing
Electricity, gas and water supply
Hotels and restaurants
Construction
Education
Health and social work

The top five sectors are more likely connected to other
sectors in the economy. Through analysing the flux matrix F , we find that they have less fractions of flows from
the source or to the sink. On the contrary, the last five

7

In this paper, we introduce flow distances in various
open flow networks. These distances characterize interactions between different nodes, and all the distances can
be expressed explicitly by the Markov matrix. We give
several examples on potential applications of flow distances on energetic food webs and input-output network.
Trophic level as an important conception introduced in
food web ecology should be applied to other open flow
networks. Usually, the nodes with lower trophic levels
are more probable to be influenced by the source easily.
Second, we can use flow distances to cluster nodes because the symmetric distance cij can be regarded as a
kind of similarity measure. We also use cij to compare
node centrality between different nodes. Vector ti can
be used as an indicator to compare the in-dependency

of different node. Because all the flow distances reflect
the nature of random walk in an open flow network, they
combine the topology and flow dynamics on the network
together. Therefore, these distances must have very wide
application background.
Certainly, the applications of flow distances should not
be limited by the examples listed in this paper. First,
open flow networks are combinations of network structure and random walk dynamics, thus visualizing these
networks needs particular method. Besides placing different nodes on a space by their ‚Äútrophical levels‚Äù directly, we can embed the flow network into a Euclidean
space according to distance cij such that the Euclidean
distance of any given pair i and j is as close as their
cij . This embedding problem can be solved by optimizing the places of each node in the Euclidean space. And
the patterns of the nodes distributed in the space may
help us to understand the flow network structure in an
intuitive way. However, how to visualize the open flow
networks to reflect the characteristics of the directionality and weights of edges is another important issue deserving for further studies. Second, open flow networks
always resemble tree structures that are hierarchical and
possessing multi-level structures. How to partition a flow
network into several smaller sub-structures, and how to
coarse-grain these structures is also an interesting problem. It is reasonable to develop a novel method based
on flow distances discussed in this paper to partition and
coarse-grain. Third, the flow distances metrics and network embedding can help us to understand some underlying dynamical processes on the network in a geometric
way[37].
Flow distances can obviously applied to other open
flow networks, and may facilitate us to compare them.
Trade flow network, traffic flow network, attention flow
networks are all very important examples. Application
of flow distances on these networks may reveal important
common patterns.
The current flow distances metrics also have shortcomings. The computational complexity will increase fast as
the size of the network because the matrices U and L are
non-sparse when the network is large. Therefore, the approximate algorithm of flow distances is very necessary
and urgent. Additionally, all the flow distances metrics
are average values of various paths of particles, the variances of these paths cannot be reflected on these metrics.
New indicators are needed to represent the fluctuations
of different paths. All these problems deserve further
studies.

[1] M. Newman, A. L. BarabaÃÅsi, and D. J. Watts, The Structure and Dynamics of Networks (Princeton University
Press, Princeton, 2006).
[2] A. L. BarabaÃÅsi and E. Bonabeau, Sci. Am., 50 (2003).
[3] S. H. Strogatz, Nature, 410, 268 (2001), PMID:
11258382.

[4] R. Albert and A. L. BarabaÃÅsi, Rev. Mod. Phys., 74, 47
(2002).
[5] A. Barrat, M. Barthelemy, R. Pastor-Satorras, and
A. Vespignani, Proc. Natl. Acad. Sci. U. S. A., 101,
3747C (2004).
[6] S. Horvath, Weighted Network Analysis. Applications in

FIG. 4. Hierarchical clustering of different industrial sections
in U.S. Colors represent node centrality. All the sector names
are abbreviated, and full names can be referred to the Supplementary Material.

sectors are all major in providing services or products for
final demand.
IV.

DISCUSSION

8
Genomics and Systems Biology (Springer, 2011).
[7] J. Bang-Jensen and G. Gutin, Digraphs: Theory, Algorithms and Applications (Springer, 2000) ISBN 1-85233268-9.
[8] A. S. Asratian, T. M. J. Denley, and R. Haggkvist, Bipartite Graphs and their Applications (Cambridge University Press, 1998) cambridge Tracts in Mathematics
131.
[9] S. V. Buldyrev, R. Parshani, G. Paul, H. E. Stanley, and
S. Havlin, Nature, 464, 1025 (2010).
[10] K.-M. Lee, J. Y. Kim, W.-K. Cho, K.-I. Goh, and I.M. Kim, New. J. Phys., 14 (2012), doi:10.1088/13672630/14/3/033027.
[11] P. Holme and J. SaramaÃàki, Phys. Rep., 519, 97 (2012).
[12] G. Nicolis and I. Prigogine, Self-organization in nonequilibrium systems (Wiley, New York, 1977).
[13] G. West and J. Brown, J. Exp. Biol., 208, 1575 (2005).
[14] J. Banavar, A. Maritan, and A. Rinaldo, Nature, 399,
130 (1999).
[15] H. Odum, System Ecology; an introduction (John Wiley
& Sons Inc, 1983).
[16] H. Odum, Science, 242, 1132 (1988).
[17] B. D. Fath and B. C. Patten, Ecosystems, 2, 167 (1999).
[18] J. T. Finn, J. Theor. Biol., 56, 363 (1976).
[19] M. Higashi, B. C. Patten, and T. P. Burns, Ecol. Model.,
66, 1 (1993).
[20] S. Levine, J. Theor. Biol., 83, 195 (1980), ISSN 00225193.
[21] R. E. Ulanowicz, Ecology, the Ascendent Perspective
(Columbia University Press, New York, 1997).
[22] R. E. Ulanowicz, Comput. Biol. Chem., 28, 321 (2004).
[23] J. Zhang and L. Guo, J. Theor. Bio., 264, 760 (2010).
[24] J. Zhang and L. Wu, PLoS ONE, 8, e72525 (2013).
[25] J. Zhang and Y. Feng, Physica A, 405, 278 (2014).
[26] B. C. Patten, Am. Nat., 119, 179 (1982).
[27] B. C. Patten, Am. Zool., 21, 845 (1981).

[28] M. Higashi, Ecol. Model., 32, 137 (1986).
[29] W. W. Leontief, Structure of American economy,19191929:An Empirical Application of Equilibrium Analysis
(Harvard University Press, 1941).
[30] W. W. Leontief, Input-output economics (Oxford University Press, 1986).
[31] T. Ten Raa, The economics of input-output analysis
(Cambridge University Press, Cambridge, 2005) ISBN
0521841798 9780521841795 052160267X 9780521602679.
[32] R. E. Miller and P. D. Blair, Input-output analysis: foundations and extensions (Cambridge University
Press, Cambridge [England]; New York, 2009) ISBN
9780521517133 0521517133 0521739020 9780521739023.
[33] B. Hannon, J. Theor. Biol., 41, 535 (1973).
[34] L. Wu, J. Zhang, and M. Zhao, PLoS ONE, 9, e102646
(2013).
[35] L. Wu and J. Zhang, Eur. Phys. J. B, 86, 266 (2013).
[36] P. Shi, J. Zhang, and J. Luo, PLoS ONE, 9, e98247
(2014).
[37] D. Brockmann and D. Helbing, Science (2013).
[38] B. V. Cherkassky, A. V. Goldberg, and T. Radzik, Math.
Program., 73, 129 (1996).
[39] D. J. Klein and M. J. RandicÃÅ, J. Math. Chem., 12, 81
(1993).
[40] J. D. Noh and H. Rieger, Phys. Rev. Lett., 92, 118701
(2004).
[41] F. BloÃàchl, F. J. Theis, F. Vega-Redondo, and E. ON.
Fisher, Phys. Rev. E., 83, 046127 (2011).
[42] L. LovaÃÅsz, Bolyai. Soc. Math. Stud., 2, 1 (1993).
[43] P. Tetali, J. Theoret. Probab. (1991).
[44] http://vlado.fmf.uni-lj.si/pub/networks/data/bio/foodweb/fo
(2006).
[45] http://www.oecd-ilibrary.org/industry-and-services/data/sta
[46] S. Johnson, Psychometrika, 32, 241 (1967).

Supplementary Material for Flow Distances on Open Flow Networks
Liangzhu Guo,1 Xiaodan Lou,1 Peiteng Shi,2 Jun Wang,2 Xiaohan Huang,2 and Jiang Zhang1, ‚àó
1

arXiv:1501.06058v1 [physics.soc-ph] 24 Jan 2015

2

I.

School of Systems Sciences, Beijing Normal University, Beijing, China
Science and Technology on Information Systems Engineering Laboratory,
National University of Defence Technology, Changsha, China
(Dated: January 27, 2015)

‚áí U ‚àí U‚àíd = (M‚àíd + ‚àÜM )U ‚àí M‚àíd U‚àíd
= M‚àíd (U ‚àí U‚àíd ) + ‚àÜM U

PROOF OF A THEOREM

In this appendix, we will prove Eq. (17). But before that, several lemmas are needed to be proved at first.

‚áí (I ‚àí M‚àíd )(U ‚àí U‚àíd ) = ‚àÜM U

(10)

‚àµ U‚àíd (I ‚àí M‚àíd ) = I

(11)

‚à¥ U ‚àí U‚àíd = U‚àíd ¬∑ ‚àÜM ¬∑ U

(12)

Lemma 1: The following equation is true:
I = (I ‚àí M )U.

(1)

Proof : It is obvious according to the definition of
U = (I ‚àí M )‚àí1 .
Lemma 2: The following equation is true:
(I ‚àí M )U = (I ‚àí M‚àíd )U‚àíd = I.

(2)

Where, M‚àíd is the matrix when the dth row of matrix
M is set to zero. Thus,
M = M‚àíd + ‚àÜM,

According to the definition of ‚àÜM , and according to the
fact that
X
mik ukj = uij ‚àí Œ¥ij ,
(13)
k

we can expand U‚àíd ¬∑ ‚àÜM ¬∑ U as

(3)
U‚àíd ¬∑ (‚àÜM ¬∑ U )ij = (U‚àíd )id ¬∑

where

mdk ukj

k

(‚àÜM )ij =



mij , i = d
0,
i=
6 d

= (U‚àíd )id (udj ‚àí Œ¥dj ).
So, we get
uij ‚àí (U‚àíd )ij = (U‚àíd )id (udj ‚àí Œ¥dj )

2
U‚àíd = I + M‚àíd + M‚àíd
+ ¬∑ ¬∑ ¬∑ = (I ‚àí M‚àíd )‚àí1 .

(5)

uid ‚àí (U‚àíd )id = (U‚àíd )id (udd ‚àí 1)

Lemma 3: The following equation holds for any d, i, j
belongs to [1, N ]:

Where,

(U‚àíd )id =

Œ¥ij =

1, i = j
0, i =
6 j

(8)

Proof : According to Lemma 2, we have
U ‚àí M U = U ‚àí (M‚àíd + ‚àÜM )U = U‚àíd ‚àí M‚àíd U‚àíd (9)

zhangjiang@bnu.edu.cn; http://www.swarma.org/jake

uid
.
udd

(17)

Insert it into Equation (15), we have
uij ‚àí (U‚àíd )ij =



(16)

Thus,

(6)
(7)

(15)

In the above equation, if we let j = d, then

Proof : This is also obvious according to Lemma 1.

(U‚àíd )ij = uij ‚àí (U‚àíd )id udj
uid
uid
udj ‚àí
Œ¥dj .
= uij ‚àí
udd
udd

(14)

(4)

Correspondingly, U‚àíd is

‚àó

X

uid
(udj ‚àí Œ¥dj ).
udd

(18)

At last, rearrange this equation, we obtain
(U‚àíd )ij = uij ‚àí

uid
uid
udj ‚àí
Œ¥dj .
udd
udd

(19)

Lemma 4: Based on these lemmas, we can get such
equation:
2
(U‚àíj
)ij =

uij
uij
(U 2 )ij
‚àí 2 (U 2 )jj +
.
ujj
ujj
ujj

(20)

2
Proof : Expand U 2 into elements, and substitute Lemma
3 into it, then
2
(U‚àíj
)=

X

(U‚àíj )ik (U‚àíj )kj

X

(uik ‚àí

k

uij
ukj
uij
ujk +
Œ¥jk )
ujj
ujj
ujj
k
X uik ukj X uij
uij
=
‚àí
ujk ukj +
2
ujj
ujj
ujj
=

k

k

(U 2 )ij
uij
uij
=
‚àí 2 (U 2 )jj +
.
ujj
ujj
ujj

(21)

Theorem 1: Equation (17) in the main text or the
following equation
(M U 2 )jj
1
2
[(M U 2 )ij ‚àí ujj (M‚àíj U‚àíj
)ij ] =
uij
ujj

(22)

holds when uij 6= 0.
Proof :
Substitute M ¬∑ U 2 = U 2 ‚àí U and
2
2
M‚àíj ¬∑ U‚àíj = U‚àíj
‚àí U‚àíj into Lemma 1 and Lemma 3, it

can be proved.
1
2
[(M U 2 )ij ‚àí ujj (M‚àíj U‚àíj
)ij ]
uij

1  2
2
(U ‚àí U )ij ‚àí uij (U‚àíj
‚àí U‚àíj )ij
=
uij
 2


1
(U )ij
uij 2
2
=
(U )ij ‚àí uij ‚àí ujj
‚àí 2 (U )jj )
uij
ujj
ujj
uij 2 
1  2
(U )jj
(U )ij ‚àí uij ‚àí (U 2 )ij +
=
uij
ujj
(U 2 )jj ‚àí ujj
=
ujj
(M U 2 )jj
=
(23)
ujj
II.

NAME LIST FOR SECTORS OF
INPUT-OUTPUT NETWORK

Sector names in Figure 4 are abbreviated. The full
names corresponded are depict in Table I.

3

Abbreviations
Agriculture
Mining
Food
Textiles
Wood
Pulp
Fuel
Chemicals
Rubber
Other mineral
Basic metals
Fabricated metal
Machinery
Office machinery
E-machinety
Communication eq.
Med. instruments
Motor vehicles
Oth. trans eq.
Manu. n.e.c
Electricity
Construction
Trade
Hotels
Trans & storage
Communications
Finance
Real estate
Renting
Computer
R&D
Other Business
Public admin
Education
Health & social work
Other services
Private households

TABLE I. Sector full names
Full names
Agriculture, hunting, forestry and fishing
Mining and quarrying
Food products, beverages and tobacco
Textiles, textile products, leather and footwear
Wood and products of wood and cork
Pulp, paper, paper products, printing and publishing
Coke, refined petroleum products and nuclear fuel
Chemicals and chemical products
Rubber and plastics products
Other non-metallic mineral products
Basic metals
Fabricated metal products except machinery and equipment
Machinery and equipment n.e.c
Office, accounting and computing machinery
Electrical machinery and apparatus n.e.c
Radio, television and communication equipment
Medical, precision and optical instruments
Motor vehicles, trailers and semi-trailers
Other transport equipment
Manufacturing n.e.c; recycling
Electricity, gas and water supply
Construction
Wholesale and retail trade; repairs
Hotels and restaurants
Transport and storage
Post and telecommunications
Finance and insurance
Real estate activities
Renting of machinery and equipment
Computer and related activities
Research and development
Other Business Activities
Public admin. and defence; compulsory social security
Education
Health & social work
Other community, social and personal services
Private households with employed persons

