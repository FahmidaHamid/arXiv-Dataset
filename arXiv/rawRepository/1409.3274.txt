Version dated: January 21, 2015

Compatibility and saturated data

arXiv:1409.3274v2 [q-bio.PE] 20 Jan 2015

Circumstances in which parsimony but not
compatibility will be provably misleading
Robert W. Scotland1 , and Mike Steel2
1
2

Department of Plant Sciences, Oxford University, Oxford OX1 3RB, UK

Biomathematics Research Centre, University of Canterbury, Christchurch, New Zealand

Corresponding author: Mike Steel, Mathematics and Statistics, University of
Canterbury, Christchurch, New Zealand E-mail: mike.steel@canterbury.ac.nz
Fax: +64-3-3642587; Phone: +64-21329705

1

Abstract.—
Phylogenetic methods typically rely on an appropriate model of how data evolved in
order to infer an accurate phylogenetic tree. For molecular data, standard statistical
methods have provided an effective strategy for extracting phylogenetic information from
aligned sequence data when each site (character) is subject to a common process. However,
for other types of data (e.g. morphological data), characters can be too ambiguous,
homoplastic or saturated to develop models that are effective at capturing the underlying
process of change. To address this, we examine the properties of a classic but neglected
method for inferring splits in an underlying tree, namely, maximum compatibility. By
adopting a simple and extreme model in which each character either fits perfectly on some
tree, or is entirely random (but it is not known which class any character belongs to) we
are able to derive exact and explicit formulae regarding the performance of maximum
compatibility. We show that this method is able to identify a set of non-trivial
homoplasy-free characters, when the number n of taxa is large, even when the number of
random characters is large. By contrast, we show that a method that makes more uniform
use of all the data — maximum parsimony — can provably estimate trees in which none of
the original homoplasy-free characters support splits.

2

Introduction
Inferring phylogeny is a central goal for systematics because nested sets of
monophyletic taxa provide a pivotal anchor point for the construction of classifications
(Angiosperm Phylogeny Group 1998) as well as for understanding evolutionary history
(Felsenstein 2004). During the last 20 years, monophyletic taxa have been predominantly
estimated using model-based inference methods and molecular sequence data. The
continuing role of morphological data to estimate monophyletic taxa has not been without
discussion and controversy (e.g. Hillis (1987); Scotland et al. (2003); Jenner (2004); Wiens
(2004)) but the number of morphological analyses in comparison to analyses using DNA
sequence data continues to decline as judged by the number of morphological matrices
deposited in TreeBASE (Piel et al. 2010).
The exact role of morphological data for phylogenetic inference, and in particular
morphological data from fossil taxa, has been a particular source of debate (Patterson 1981;
Gauthier et al. 1988; Scotland et al. 2003; Grantham 2004; Wiens 2004; Springer et al.
2008; Wiens et al. 2010). These views occupy the complete spectrum from the opinion that
fossils are best interpreted in the light of monophyletic taxa based on extant organisms
(Patterson 1981) to the view that a combined total evidence approach utilizing all data is
to be preferred for inferring phylogeny (Huelsenbeck et al. 1996; Nixon and Carpenter 1996;
Wiens et al. 2010). Other solutions for integrating morphological data in phylogenetic
inference involve the analysis of both molecular and morphological data separately to seek
congruence among data sets on the basis that this provides the strongest evidence that
phylogenetic reconstruction is accurate (Penny and Hendy 1986; Salichos and Rokas 2013;
Swofford 1991). Still other approaches recommend using molecular scaffolds in which trees
derived from molecular sequences are used to constrain the analysis of the morphological
data on the basis that morphological characters may contain too much homoplasy or
saturated, non-independent signal (Springer et al. 2008; Davalos et al. 2014). Despite these
differences of opinion surrounding morphological data and phylogeny reconstruction, most
3

authors agree on the importance of morphological data from both extant and fossil taxa to
provide a full and comprehensive understanding of evolutionary history.
Despite misgivings and legitimate concerns about morphological data possibly being
saturated, too homoplastic and/or non-independent (Wagner 2000; Springer et al. 2007,
2008; Davalos et al. 2014), these same authors remain committed to finding solutions to
include at least some morphological data in estimates of phylogeny. This is relevant
because of the important role of taxon sampling in phylogeny reconstruction (Hillis 1996,
1998) combined with the fact that most taxa that ever lived are now extinct and therefore
only exist as fossils (Hillis 1987). Furthermore, how to best integrate and assign fossil taxa
for dating nodes of phylogenetic trees is also a topic of some interest (Ronquist et al. 2012).
In this context, we revisit compatibility as a method for estimating monophyletic taxa in
the context of morphological data. Our motivation stems from the claim that
morphological datasets often contain ambiguous, saturated phylogenetic signal that can
approximate to random data for extant (Kelly et al. 2014) as well as fossil taxa (Wagner
2000; Springer et al. 2007, 2008; Davalos et al. 2014). We focus on compatibility, a method
that seeks to discover unique compatible characters describing splits in the underlying
phylogenetic tree, rather than attempting to explain or model all congruent and
incongruent characters (Farris 1983; Lewis 2001).
Almost fifty years ago, Wilson (1965) and Camin and Sokal (1965) (and later
Le Quesne (1969); Estabrook (1972); Le Quesne (1972, 1975); Estabrook and McMorris
(1977); Farris (1977); Felsenstein (1978); Estabrook and Meacham (1979); Meacham
(1981); Felsenstein (1982); Meacham and Estabrook (1985)) explored compatibility –
termed ‘character consistency’ by Wilson (1965) and ‘character congruence’ by Patterson
(1982) – as a method for analyzing morphological data to infer phylogeny. Despite some
more recent discussion (e.g. de Pinna (1991); Wilkinson (1994); Dress et al. (1997);
Felsenstein (2004); Gupta and Sneath (2007)) compatibility has remained on the periphery
of methods for inferring phylogeny, as it has largely been set aside, initially in favour of
maximum parsimony, and, more recently, by model-based methods for inferring phylogeny
4

from DNA sequence data. For an overview of compatibility methods in phylogeny
reconstruction see Meacham and Estabrook (1985) or Felsenstein (2004).
Compatibility was described by Wilson (1965) as a method of character ‘weighting’
based on the phylogenetic significance of the character. Wilson (1965) aimed to capture
taxonomic procedure explicitly in a new, more rigorous way by using a method that
weighted unique unreversed character states that were consistent between each other and a
hierarchical hypothesis, to the exclusion of more ‘fickle’ character states. We here interpret
‘fickle characters’ sensu Wilson (1965) as referring to homoplasy but also other factors
(including analogy, inaccurate character concepts, inaccurate coding) that can lead to
effectively random patterns of character states shared between taxa.
Compatibility was therefore a form of character weighting, seeking to give maximum
weight to characters that evolve once and display no homoplasy. Le Quesne (1969) stated
that a character is compatible with a tree if it can evolve on that tree without homoplasy.
He stated that a character with N states that requires N − 1 changes on a tree, is
compatible with that tree. He further reasoned that the best tree was the tree that
maximized the total number of compatible characters (Le Quesne 1969). In a sense, the
method of character compatibility formalized a phylogenetic method that captured the
intuitive taxonomic practice of recognizing taxa based on conserved non-homoplastic
characters (Wilson 1965). The justification provided in the compatibility literature for
attempting to identify and utilize only characters that evolve once in estimates of
phylogeny were three-fold. First, a set of characters that exhibit a higher level of
compatibility than would be expected by chance alone may reflect a common process,
namely descent with modification (Wilson 1965). Second, this statistical property
(compatibility) does not apply to more noisy or homoplastic characters and therefore these
should be excluded from further consideration (Le Quesne 1969, 1972, 1975; Meacham
1981). Third, that the history of taxonomy and the recognition of natural groups has
hitherto utilized non-homoplastic characters and that inferences about convergent and
5

homoplastic characters were after the fact interpretations from classifications based on
compatible characters (Wilson 1965; Patterson 1982).
Compatibility methods have been most often compared and contrasted with cladistic
parsimony methods that were developed and refined during a similar time period (Hennig
1966; Farris 1977; Farris and Kluge 1979; Farris 1983). Compatibility and parsimony
methods were shown to share certain characteristics including statistical inconsistency
(Felsenstein 1978). In contrast, the two methods – parsimony and compatibility – differed
most fundamentally in their treatment of homoplasy and character conflict (Wilson 1965;
Farris and Kluge 1979; Meacham and Estabrook 1985; de Pinna 1991).
Compatibility methods seek to infer phylogeny from uniquely derived
non-homoplastic characters that are consistent and non-random in their distribution
(Wilson 1965) whereas parsimony methods seek to explain all characters by incorporating
and minimizing ad hoc assumptions of homoplasy (Farris 1983). To account for character
conflict, parsimony analysis adjusts the level of universality of some characters to fit the
general most parsimonious tree of all characters, such that all characters are treated as
informative, and the principle of parsimony determines the most economical (fewest
number of changes) explanation of the data (Farris 1983; de Pinna 1991). Comparing
parsimony and compatibility directly, de Pinna (1991) concluded that compatibility “has
little power in determining hypotheses of character evolution in the presence of
incongruence”. The view of de Pinna (1991) is that parsimony analysis seeks to explain all
data relative to a model of character evolution whereas, in contrast, compatibility seeks to
discover compatible characters only (Wilson 1965).
The role and utility of character weighting for inferring phylogeny was explicitly
explored in the phylogenetics literature during this period (Wilson 1965; Farris 1969; Neff
1986; Carpenter 1988; Sharkey 1989; Hillis 1991; Hillis et al. 1993). Adherents of
parsimony also explored weighting schemes to give reduced weight to characters based on
empirically determined levels of homoplasy (Farris 1969; Carpenter 1988; Goloboff et al.
2008). The relative importance and weight ascribed to various characters within a dataset
6

remains an active topic of discussion in contemporary phylogenetics (Eddy 2004;
Felsenstein 2004; Lemey et al. 2009; Cox et al. 2014), and several factors have been
investigated, including: strong signal to noise ratios (Salichos and Rokas 2013), random
data (Wenzel and Siddall 1999), saturation (Wagner 2000; Kelly et al. 2014), codon bias
(Cox et al. 2014), third position changes (Cox et al. 2014), reliability and homoplasy
(Goloboff et al. 2008), heterogeneity of substitution rates among different lineages (Ho
2009), differences between DNA and protein data (Kumar et al. 2008), the use of
BLOSUM62 matrix for aligning proteins (Eddy 2004), and the weighting of transitions
versus transversions (Posada and Crandall 2001). We therefore consider a re-examination
of compatibility methods as part of a much wider research agenda seeking to explore and
model the relative strength of phylogenetic signal within datasets (Goloboff et al. 2008;
Salichos and Rokas 2013; Cox et al. 2014).
More specifically, our motivation to re-examine compatibility stems in part from a
recent meta-analysis of morphological datasets in TreeBASE (Kelly et al. 2014)
demonstrating that many morphological datasets contain very little signal when compared
with random data. Similar results were observed in paleontology for 48 out of 56 fossil
datasets Wagner (2000) in a study that identified a deterioration of phylogenetic structure
through time due to character state exhaustion (saturation) in many clades. These
observations – very few uniquely derived morphological characters (synapomorphy) and
much morphological data that is very problematic – may explain a historical paradox in
systematics, i.e. that morphological data has been extraordinarily successful at estimating
monophyletic taxa by synapomorphy albeit for a limited number of nodes but at the same
time most morphological data are inherently problematic for inferring phylogeny (Wagner
2000; Scotland et al. 2003; Grantham 2004; Springer et al. 2007, 2008; Wagner 2012; Bapst
2013, 2014; Davalos et al. 2014).
Today, maximum likelihood and Bayesian techniques are the main tools for inferring
phylogenetic trees from most (genetic) character data (Felsenstein 2004). Although a great
variety of stochastic models have been developed and applied for aligned DNA sequence site
7

data, there has been comparatively much less work on modelling the evolution of discrete
morphological characters. One exception is Lewis (2001), who showed how a symmetric
Markovian model with a finite number of states could be applied to morphological data in
a maximum likelihood setting (see also Huelsenbeck et al. (2008) for a somewhat different
Bayesian analysis). An obstacle for many types of morphological (or fossil) data is that, in
contrast to DNA site substitutions, there is unlikely to be a common mechanism across the
characters (e.g. ratios of ‘branch lengths’ within a tree may vary across characters) and the
absolute rates of evolution may also vary in unknown ways across the characters. For
example, some characters may be highly conserved, with just a single ‘innovation’
occurring once in an evolutionary tree, while other characters may have flipped states
many times, resulting in an essentially random pattern of states at the tips of the tree.
In this paper, we analyse what happens when the data arise in precisely such a
manner: some characters evolve without homoplasy, while others are essentially random,
but we have no idea which class a given character belongs to. We adopt this scenario
because we can obtain exact results, and it shows what is possible in the extreme.
Nevertheless it also provides some guidance on what may be expected in less polarised
settings. Our approach complements the study by Susko et al. (2005) who showed how
biases affect standard tree reconstruction methods in the presence of varying degrees of
randomisation within sequences or sites.
One can model such extreme data using standard and simple Markov models on an
phylogenetic tree, such as the Mk model of (Lewis 2001), as follows: The characters that
evolve without homoplasy simply correspond to characters that are evolving at a very slow
rate (i.e. they are highly conserved) while those that are essentially random are evolving at
a very fast rate. This model can be viewed either as a two-fold mixture of the common
mechanism model (i.e. the ratio of the branch lengths within a tree is the same across all
characters, with these branch lengths merely being scaled up or down according to whether
the character is conserved or random) or as a model in which there is no such constraint on
the branch length ratios. To keep matters simple, we consider binary characters (which
8

corresponds to k = 2 in the Mk model), but similar results could be developed more
generally.
Although evolution at a low substitution rate will lead to (mostly) homoplasy-free
characters, many of these characters will be unvaried (i.e. all taxa would be in the same
state). However, as noted by Lewis (2001), such unvaried characters are generally not of
interest in comparative morphological studies, and it is generally more relevant to consider
data that excludes such unvaried characters. This ‘censoring’ of the data (effectively by the
investigator looking for characters that reveal differences between taxa) provides no
problem for our analysis, and we will accommodate this additional perspective explicitly in
Theorem 1.

Definitions: Character compatibility and random
binary characters
We begin with some definitions. A binary character χ on a set X of n taxa is an
assignment of a state (0 or 1) to each taxon x in X. We say that χ is non-trivial if at least
two taxa are in one state and at least two taxa are in a different state; otherwise, the
character is trivial. Thus, a trivial character is either unvaried (all taxa receive the same
state) or it is an ‘autapomorphy’ (one taxon receives one state, and all remaining taxa the
other state). Non-trivial characters are also sometimes referred to as ‘(parsimony)
informative’ characters. The partition of a character χ refers to the partition of X into (at
most) two parts that χ induces (i.e. for each partition, there are two characters of that
partition, obtained by interchanging the states 0 and 1).
A phylogenetic X-tree displays a binary character if the character fits on the tree
with one state change at most (i.e. no homoplasy). For example, in Fig. 1, the character
that assigns taxa a, b and e one state and the remaining taxa a different state is displayed
by the tree on the right, but not by the tree on the left. Two characters are compatible if
there is a phylogenetic X-tree that displays both characters. This is equivalent to requiring
9

that the two subsets of taxa (one for each character) that have a state that is different to
the state of some arbitrary reference taxon x0 ∈ X comprise a pair of sets that are either
disjoint (i.e. have empty intersection) or nested (i.e. one set contains the other). A
character is compatible with all other possible characters if and only if that character is
trivial.
More generally, a sequence of binary characters is compatible if there is a
phylogenetic X-tree that displays them all. It is a classic result that a set of characters is
compatible if and only if every pair is. Moreover, there is a unique minimally-resolved
phylogenetic tree that displays these characters, where the non-trivial splits of the tree
correspond to the bipartitions of X induced by the non-trivial characters (see, e.g. Semple
and Steel (2003)).
Given a character χ on X, and a phylogenetic X-tree, χ is compatible with T
precisely if T or some resolution of T displays χ. An example is shown in Fig. 1.
a

f

a
v

b

b

g

u

c

f
u0

v

e

h
d

h
c

e

g

u00
d

Figure 1. The tree on the right resolves the tree on the left by the addition
of an edge (u0 , u00 ) to resolve vertex u. The tree on the right displays any
character χ that assigns taxa a, b, e one state and c, d, f, g, h a second state, so
χ is compatible with this tree as well as the tree on the left (even though that
tree does not display χ).
A random binary character f on a set X of n taxa, is an assignment of a state (0 or
1) to each taxon x in X, performed independently across the taxa and with an equal
probability of 0 or 1 for each taxon. Thus a random binary characters simply picks one of
the possible 2n binary characters on X with equal probability.
Note that a two-state symmetric Markov process on a phylogenetic tree produces a
random binary character in the limit as the rate of substitution across all (or sufficiently
many) branches grows. Such processes were investigated in the context of morphological
10

evolution in Lewis (2001). Here, we work with the limiting value of completely random
data since it allows exact calculations. However, our results have a bearing when the data
contains characters that are ‘near random’ (i.e. near saturation), as we describe briefly in
the concluding comments.
We will henceforth regard phylogenetic trees as unrooted (but there is no real loss of
generality with this assumption).

Results
The main result in this paper is the following.
Theorem 1. Suppose a data-set D consists of a sequence of binary characters (with or
without any unvaried characters removed), that consists of a sequence S1 of compatible
characters and a sequence S2 of M independent random binary characters, all on the same
set X of n taxa (these sequences are intertwined and so we are not told which character
belongs to which class).
(i) With a probability of at least 1 −  where  = 2M 2


3 n
,
4

no two characters in S2 are

compatible. Consequently, with probability at least 1 −  the following hold:
(1) there exists a maximal compatible subset S of D that contains all of S1 ;
(2) any such S falls into one of the following two cases: (a) S = S1 ; or (b) S
consists of all (or all but one) characters from S1 and one character from S2 ;
(3) a maximal compatible sequence S of characters for D can be identified by an
efficient (polynomial time) algorithm from D (without knowing in advance
which characters are in S1 and S2 ).

n−3
K 
(ii) If, in addition, M · K 21
+ 12
≤ δ, where K is the number of distinct

partitions produced by non-trivial characters in S1 , then with a probability of at least
1 − δ, Case (b) in Part (2) of (i) will never arise.

(iii) Let m be the number of non-trivial characters in S1 and let L be the average value
(over those m characters) of the smaller number of taxa in the split determined by
11

the character. Let T1 be any binary tree that displays all of the compatible characters
in S1 . If M and n are both large (e.g. > 30) and 27(L − 1)2 m2 /2M n < 1, then the
expected number of phylogenetic trees that are more parsimonious for D than T1 and
yet display none of the m perfectly compatible non-trivial characters in S1 grows
exponentially with n (it is at least 10n for n ≥ 30).
The proof of this theorem is provided in the Appendix, with one small exception:
here we outline the simple algorithm referred to in the third claim of part (i). Such an
algorithm is relevant, because, although software is available to search for maximum
compatible subsets of characters (Felsenstein 1993), in general it is an intractable
(NP-hard) problem to find a largest subsequence of compatible characters in an arbitrary
collection of binary characters. This was established by (Day and Sankov 1986) who
reduced the maximum compatibility problem for binary characters to the well-known
problem of finding a maximum clique (a set of vertices all connected to each other) in an
arbitrary graph. This connection is the same as we use here – given a sequence D of binary
characters construct a graph that has a vertex for each character in D, with an edge
between two vertices if the corresponding characters are compatible. Now, for D
partitioned (as here) into two disjoint sets – S1 and S2 – if no two of the (random) binary
characters in S2 are compatible, and each pair of binary characters in S1 is compatible, the
resulting graph is easily seen to be a ‘chordal’ graph (i.e. every cycle of length four or more
has a chord). For such graphs, there exist fast (i.e. polynomial-time) algorithms for finding
maximum cliques, based on constructing a ‘perfect elimination ordering’ for the graph (for
details, see Gavril (1972)). Moreover, this also suggests a useful diagnostic for testing
whether the model described here is appropriate: simply check whether the associated
character compatibility graph is chordal (a process that can also be carried out quickly
(Rose et al. 1976)).
The reader should be clear that Theorem 1 describes a prediction of a model, and
for real data there will generally be greater ambiguity as to the identity of the set of
12

homoplasy-free characters than the sharp results described in parts (i) and (ii) of that
theorem provide. We now turn to some examples and graphs to illustrate the content of
Theorem 1.

Examples
(1) As a simple application, suppose we have 30 taxa, and 20 binary characters, of
which 8 are distinct, non-trivial and perfectly compatible, while the remaining 12
are random. Then applying Parts (i) and (ii) with n = 30, K = 8, M = 12 (noting



1 8
1 27
2
30
= .047) the probability the
+ 2
that 2(12) (3/4) = .051, and 12 · 8 2
eight perfectly compatible characters comprise the unique maximum compatible

subset of characters for this dataset is at least 90%. In this example, M is not large
enough to apply part (iii) usefully.
(2) Suppose that we have n = 100 taxa, and suppose our data D is made up of a
sequence S1 of perfectly compatible non-trivial binary characters interspersed (in
some unknown way) with a sequence S2 of M random binary characters. Provided
that M is no more than (say) 10,000, then the conditions for Theorem 1(i) applies
n
with  = 0.0001, since 2M 2 34 ≤ 0.000064. Therefore we can easily

distinguish/find the perfectly compatible characters from S1 in D, and any

maximum compatible tree for D will display all or all but one of these characters
and, at most, one other (random) character. Also, at least one maximum
compatible tree for D contains every character in S1 .
If, in addition, at least 20 of the 97 possible non-trivial character partitions are
present in S1 ( i.e. K ≥ 20), then the condition for Theorem 1(2) applies with
δ = 0.01. If we combine this with the previous result, it is ∼99% probable that a
maximal compatible subsequence of characters from D will consist of exactly just
the characters in S1 .
Finally, to illustrate part (iii) of Theorem 1, suppose that S1 contains at most 30
non-trivial characters in total, counting repetitions (i.e. m ≤ 30), with L = 7, and
13

that M = 5000, say. Then, n and M are sufficiently large, and

27(L−1)2 m2
2M n

≤ 0.88,

which is small enough to apply part (iii). Thus, the expected number of binary
trees that are simultaneously (a) more parsimonious (on the entire data set) than
T1 (any given binary tree that displays all of the perfectly-compatible characters in
S1 ), and (b) that fail to display any of the non-trivial characters in S1 , is at least
10100 . This suggests we should have no confidence that a maximum parsimony tree
for the entire data set would have any success in displaying any (let alone several)
of the perfectly compatible informative characters in S1 . Moreover, provided that
K ≥ 20, we saw in the previous paragraph that the maximal compatible sequence of
characters from S is almost certain to consist of just the characters in S1 .

Graphs
The above examples provide a ‘snapshot’ of how the results of Theorem 1 apply.
However, it is also helpful to visualise the interplay of the various parameters (n, K, M, m)
that result from the inequalities in Parts (i)–(iii). In Fig. 2, the graphs (A), (B) and (C)
illustrate aspects of Parts (i), (ii) and (iii) of Theorem 1, respectively.
n
Graph (A) shows the graph of 1 − 2M 2 34 verses M , which is a lower bound on
the probability that amongst M random binary characters, no pair of characters are

compatible. While this bound decays quadratically with M , the exponential dependence on
n ensures that when the number of taxa is large, this probability will be close to 1 even for
relatively large values of M .
Graph (B) shows a lower bound on another probability – namely that none of M
random binary characters are compatible with a sequence of binary characters that induce
K non-trivial splits. In this case the value of n plays a vanishing role once it becomes more
than about 15 or so; we have drawn the graph for n = 30 but it would look identical for
any larger value of n.
14

K = 15

n = 100
n = 80

m
upper limit

n = 1000

K = 12

n = 500

n = 100

n = 70

n = 50
1

✓ ◆n
3
2M 2
4

n

30

K=8

M

M

M

(A)

(B)

(C)

Figure 2. (A) The probability that no two characters from among M random binary characters are compatible lies above the curves shown. (B) The
probability that none of M random binary characters on 30 or more taxa are
compatible with a sequence of non-trivial binary characters that induce K distinct splits lies above the curve shown (for K = 8, 12, 15). (C) The maximal
value of m allowed in Theorem 1 so that when m nontrivial binary characters are sampled at random from a Yule pure-birth tree T , a large (> 10n )
number of trees are more parsimonious than T and yet display none of the m
characters.
Graph (C) shows the upper bound on the number m of compatible nontrivial binary
characters as a function of M for the number of nontrivial binary characters for which
maximum parsimony performs as described in Theorem 1(iii). In this graph we have
estimated L by considering the expected size of clades in Yule trees up to size n/2 (using
the (asymptotic) estimate 2 ln(n/2) which follows from Theorem 4.4 of Rosenberg (2006)).
Notice that the upper bound on m is quite modest as a function M (the number of random
binary characters), and grows relatively slowly with n. In other words, to achieve this
extreme performance of maximum parsimony, the characters in S1 will form a tree that is
only partially resolved (this may not be necessary, but the current proof of part (iii) allows
only sub-linear growth of m with n).

15

Discussion

Methods for inferring phylogenetic trees from character data are most often an
exercise in modelling all data. In these situations, all data are viewed as providing evidence
of phylogeny and the task is to infer character-state changes at the correct node(s) on a
tree. In these circumstances some character-state changes are unique whilst others contain
homoplasy. A confounding factor for phylogenetic inference are high rates of homoplasy
that approximate to random data, such that phylogenetic signal is masked. In addition,
mistakes in DNA sequence alignment, ambiguous coding regimes and disagreements about
the correct conceptualization of morphological structures can add a level of
non-evolutionary noise to a data matrix. In this sense, data matrices contain unique signal
(characters that contain no homoplasy), homoplastic signal (characters that change more
than once but provide evidence for phylogeny at various nodes on a tree) and noise
(characters that contain saturated levels of homoplasy with no phylogenetic signal and also
characters that do not accurately reflect or capture evolutionary history e.g. mistakes in
coding and conceptualization of morphological data). Therefore, here, ‘noise’ refers to
saturated levels of homoplasy and other factors (analogy, inaccurate character concepts,
inaccurate coding, character dependency, continuous rather than discrete data, alignment
error etc) that lead to essentially random patterns of character states shared between taxa
(Wenzel and Siddall 1999). When the data exhibit little homoplasy and noise, then
evolutionary trees can be reliably reconstructed from simple methods, such as maximum
parsimony and neighbour joining with dense taxon sampling (Graybeal 1998; Hillis 1996).
For data where the characters exhibit moderate but widely varying degrees of homoplasy
(across the tree), according to some common process across the characters, then simple
methods like maximum parsimony can be misleading, depending on the branch lengths of
the true tree (Felsenstein 1978), while maximum likelihood and Bayesian approaches have
more sound robust properties (e.g. consistency) for recovering the correct tree from
16

sufficient data. In both these cases, maximum compatibility tends to perform poorly
alongside the standard methods that use all of the available data more even-handedly.
However, when the data consist of a combination of some characters that exhibit
very little noise alongside other characters that are very noisy (and we do not know which
class a given character belongs to), a standard method that regards all characters as having
the same signal-to-ratio strength is problematic. In this case, our results suggest that a
more accurate strategy is to find a maximum compatible subset of characters, as this will
contain (nearly all) the characters that exhibit very little noise and, provided the number
of taxa is large, very few additional characters from the highly noisy class. Essentially, the
separation of ‘signal’ and ‘noise’ is achieved by the characters themselves; maximum
compatibility merely identifies which class each character belongs to. The accuracy of this
approach relies on a simple mathematical fact: the probability that two random binary
characters are compatible with each other converges to zero exponentially quickly as the
number of taxa grows. Consequently, in this setting, the mutually compatible characters
are likely to directly reflect and capture the common underlying process of descent with
modification, or, in some circumstances, concerted convergent evolution (Holland et al.
2010). A further advantage of compatibility is that it is not as sensitive to reduced taxon
sampling as other methods that seek to make more uniform use of data. In contrast, for
methods that seek to explain high rates of homoplasy at the correct nodes on a tree, dense
taxon sampling is crucial for accurate reconstruction (Graybeal 1998).
We should stress that we are not advocating a wholesale return to maximum
compatibility; as mentioned, there are settings where it is clearly inferior to parsimony
and/or likelihood and Bayesian approaches. Instead we argue that maximum compatibility
may have some advantages when data are such that each character either has very low or
very high associated noise. Note that maximum compatibility may lead to an unresolved
tree with polytomies (unlike most other tree reconstruction methods which tend to return
a fully-resolved tree). Moreover, just because a clique of compatible characters is
significantly larger than expected for random characters, these compatible characters may
17

fit a tree that is different from the species phylogeny if those characters have been subject
to convergent evolution (Holland et al. 2010).
Note that a highly noisy character (under our symmetric two-state model) will tend
to have about half the taxa in one state and half in the other. However, the observation of
such near-equality in the character state counts does not, in itself, mean that the character
is noisy; after all, completely homoplasy-free evolution can also produce such a character
when a change of state occurs near some central edge of a tree that has around half the
taxa on one side, and half on the other.
Our results show that a large number of ‘noisy’ characters will overwhelm the signal
for parsimony present in the ‘noise-free’ characters if they are all treated on a level footing
as samples from an identical process. By contrast, our results show that maximum
compatibility is accurate even when the number of random characters M grows
exponentially with the number n of taxa (provided M grows no faster than (4/3)n/2 ). Also,
although our analysis deals with an extreme model (characters with zero or infinite noise),
standard continuity arguments imply that our results will provide some indication of how
maximum compatibility will behave in less extreme settings.
Our analysis of maximum parsimony was chosen for simplicity, but it has
implications for other phylogenetic tree reconstruction methods such as maximum
likelihood (ML). To see this, suppose the data consists not just of compatible and random
binary characters, but also many unvaried characters. Data of this type would be
generated by a 2-rate model - very slow rates (leading to mostly unvaried but also some
homoplasy-free characters), and very fast rates (leading to random characters). Theorem 7
of Tuffley and Steel (1997) implies that the maximum likelihood tree for this data analysed
under a model that assumes a common mechanism and a constant rate across characters is
always a maximum parsimony tree for this data, when the proportion of unvaried
characters is sufficiently large. This means that Theorem 1 will apply in this setting (with
maximum parsimony replaced by ML) since the unvaried characters play no role in either
parsimony or compatibility analyses. Our use of maximum parsimony was also confined to
18

the simplest form of this method in which all character state changes are weighted equally,
and all characters are also given equal weight; relaxing the second of these constraints has
been explored by various authors, including for morphological data (Goloboff et al. 2008).
We restricted our analysis to binary characters, as these enjoy the property that a
collection of them is compatible if and only if every pair are. The results could, in principle,
be extended to multi-state characters; however, the mathematical analysis would be more
complex, since pairwise compatibility is only a necessary (but not sufficient) condition for
the compatibility of a collection of such characters. Within the two-state model one can
also consider moving from a symmetric to a non symmetric model of substitution. In this
case the probability that two random characters are compatible increases, though it still
decays exponentially with n (for any fixed probability that a given taxon is in state 1). A
further minor extension of our results is that the requirement that the random binary
characters be independent in Parts (i) and (ii) of Theorem 1 can be weakened to requiring
just pairwise independence, since the proof of both parts relies only on Boole’s inequality.
We mention a further caveat; Theorem 1(iii) refers to the expected number of trees
that are more parsimonious that T1 and yet fail to display any non-trivial character in S1 .
The proof (Appendix) relies on showing that a randomly selected binary tree has a positive
probability of being more parsimonious than T1 (and also a high chance of failing to display
any non-trivial characters in S1 ). This suggests that the chance of T1 being a (globally)
most-parsimonious tree for the data should be infinitesimal (given that there are > 10180
trees on 100 taxa, and each has a reasonable chance of ‘beating’ T1 ). However, some care is
needed here: if we consider the event that T 0 is more parsimonious for the data than T1 ,
then these events (one for each T 0 ) are not independent. This lack of independence does
not cause any problem in the statement of Theorem 1(iii), as it refers to expectation, and
the expectation of a sum of random variables is the sum of the expectations, regardless of
whether they are dependent or not. While it seems reasonable to expect that T1 would be
very unlikely to be a maximum parsimony tree for the data, further analysis would be
needed to formally prove this.
19

The motivation for exploring a method that seeks to identify monophyletic taxa
from a small subset of discrete character data will be obvious to most systematists who
have studied patterns of variation across a clade of any size. Put simply, clear-cut discrete
characters are few and far between. It is uncontroversial to state that morphological data
and evolutionary novel character concepts (e.g., carpels, nucleic acid, seeds, legumes,
vertebrae, amnion etc.) have been developed and refined hand in-hand, alongside the
context of monophyly and classification (e.g., carpels of angiosperms, nucleic acids of life,
seeds of spermatophytes, legumes of leguminosae, vertebrae of vertebrates, amnion of
amniotes). These character concepts were discovered by a combination of good
observational skills coupled with a subsequent hypothesis of monophyly that could be
examined in the context of other hypotheses of monophyly by a process of reciprocal
illumination throughout the history of systematics. In agreement with Wilson (1965), we
suggest that compatibility is a method that captures these aspects of systematic practice
and is therefore worthy of consideration for inferring monophyly from morphological data.
Compatibility offers a further way to analyse morphological data independent of
molecular data. For those who wish to analyse morphological data in combination with
molecular data then compatibility can be implemented as a distinct data partition within a
total evidence context. Compatibility could be used to screen out random signal and
identify compatible characters for subsequent analyses in combination with molecular data.
In a sense, compatibility is less ambitious and perhaps less attractive than methods that
seek to model all available data but at the same time it is, for some classes of data, more
realistic in accepting a lack of resolution (Bapst 2013) and a limited number of ‘good’
morphological characters. It is also possible that compatibility offers a new perspective for
the study of morphological character evolution that attempts to incorporate two basic
empirical findings of systematics. One, that there are very few unreversed conserved
characters and, two, that the majority of characters are problematic to model as discrete
data as their phylogenetic distribution approaches saturation.
20

Here we have shown that for a model in which each character either fits perfectly on
some tree, or is entirely random (but it is not known which class any character belongs to)
we are able to derive exact and explicit formulae regarding the performance of maximum
compatibility. The is significant because it is perhaps the first time that any tree
reconstruction method (on any number of taxa) can be analysed so exactly under a model
that involves randomness in the data. Furthermore, we show that compatibility is able to
identify a set of non-trivial homoplasy-free characters, when the number n of taxa is large,
even when the number of random characters is large. This is significant because one might
have expected that, by chance alone, compatibilities within a few of the random characters
would result in a number of incorrect splits being estimated by compatibility, and we
provide precise conditions under which this will not occur. By contrast, we show that a
method that makes more uniform use of all the data – maximum parsimony – can provably
estimate trees in which none of the original homoplasy-free characters appear as splits.
This is significant because ‘by chance alone’ the random data can overwhelm the
phylogenetic signal in the homoplasy-free characters through the eyes of some methods (eg.
parsimony) but not others (e.g. compatibility). While compatibility excludes much of the
data, and so may result in unresolved trees, this conservative feature of the method has an
advantage in the extreme model we study of being relatively immune to the influence of the
random characters when the number of taxa is large. On the other hand, maximum
parsimony – or indeed maximum likelihood when many additional constant characters are
present – is influenced by all of the characters, so a large number of random ones will tend
to lead to trees that display none of the homoplasy-free characters as splits.
Taken together our results are significant for contemporary systematics because,
although they deal with an extreme model, the mathematical results provide a caution that
in this setting ‘more can be less’ – methods that attempt to score a tree using all the
characters may miss most (or indeed all) of the unique non-trivial characters that have
evolved without homoplasy. Yet there exist other methods (such as compatibility) that can
be immune to this, at the price of being more conservative. In future work it would be
21

useful to explore the extent to which this holds under less extreme models, where any
mathematical analysis would be much less straightforward.

Funding
MS thanks the NZ Marsden Fund and the Allan Wilson Centre for helping fund this
research. RWS thanks the Leverhulme trust for funding this research.

Acknowledgments
We thank the reviewers, editor and associate editor for several helpful suggestions.

*
References
Angiosperm Phylogeny Group. An ordinal classification for the families of flowering plants.
Ann. Missouri Bot. Gard., 85:531–553, 1998.
D. Bapst. Preparing paleontological datasets for phylogenetic comparative methods. In
L.Z. Garamszegi, editor, In Modern Phylogenetic Comparative Methods and Their
Application in Evolutionary Biology, pages 515–544. Springer-Verlag, Heidelberg, 2014.
D.W. Bapst. When can clades be potentially resolved with morphology? PLoS One, 8(4):
e62312, 2013.
D. Bryant and M. Steel. Computing the distribution of a tree metric. IEEE/ACM Trans.
Comput. Biol. Bioinf., 16:420–426, 2009.
J. Camin and R. Sokal. A method for deducing branching sequences in phylogeny.
Evolution, 19:311–326, 1965.
J.M. Carpenter. Choosing among multiple equally parsimonious cladograms. Cladistics, 4:
291–296, 1988.
22

C.J. Cox, B. Li, P.G. Foster, T.M. Embley, and P. Civan. Conflicting phylogenies for early
land plants are caused by composition biases among synonymous substitutions. Syst.
Biol., 63:272–279, 2014.
L.M. Davalos, P.M. Velasco, O.M. Warsi, P. D. Smits, and N.B. Simmons. Integrating
incomplete fossils by isolating conflicting signal in saturated and non-independent
morphological characters. Syst. Biol., (Advance access):1–19, 2014.
W.H.E. Day and D. Sankov. Computational complexity of inferring phylogeny by
compatibility. Syst. Zool., 35:224–229, 1986.
M.C.C. de Pinna. Concepts and tests of homology in the cladistic paradigm. Cladistics, 7:
367–394, 1991.
A. Dress, V. Moulton, and M. A. Steel. Trees, taxonomy and strongly compatible
multi-state characters. Adv. Appl. Math., 19:1–30, 1997.
S.R. Eddy. Where did the BLOSUM62 alignment score matrix come from? Nat Biotech.,
22:1035–1036, 2004.
G.F. Estabrook. Cladistic methodology: a discussion of the theoretical basis for the
induction of evolutionary history. Annu. Rev. Ecol. Syst., 3:427–456, 1972.
G.F. Estabrook and F.R. McMorris. When are two qualitative taxonomic characters
compatible? J. Math. Biol., 4:195–200, 1977.
G.F. Estabrook and C.A. Meacham. How to determine the compatibility of undirected
character state trees. Math. Biosci., 46:251–256, 1979.
J.S. Farris. A succesive approximations approach to character weighting. Syst. Zool., 18:
374–385, 1969.
J.S. Farris. Some further thoughts on Le Quesne’s methods. Syst. Zool., 26:220–223, 1977.
J.S. Farris. The logical basis of phylogenetic analysis. Advances in Cladistics, 2:1–36, 1983.
J.S. Farris and A.G. Kluge. A botanical clique. Syst. Zool., 28:400–411, 1979.
J. Felsenstein. Cases in which parsimony or compatibility methods will be positively
misleading. Syst. Zool., 27:401–410, 1978.
23

J. Felsenstein. Numerical methods for inferring evolutionary trees. Q. Rev. Biol., 57:
379–404, 1982.
J. Felsenstein. PHYLIP (Phylogeny Inference Package) version 3.5c. Distributed by the
author. Department of Genetics, University of Washington, Seattle, 1993.
J. Felsenstein. Inferring Phylogenies. Sinauer Associates, Massachusetts, 2004.
J. Gauthier, A.G. Kluge, and T. Rowe. Amniote phylogeny and the importance of fossils.
Cladistics, 4:105–209, 1988.
F. Gavril. Algorithms for minimum colouring, maximum clique, minimum covering by
cliques and maximum independent set of a chordal graph. SIAM J. Comput, 1:180–187,
1972.
P. A. Goloboff, J. M. Carpenter, J. S. Arias, and D.R.M. Esquivel. Weighting against
homoplasy improves phylogenetic analysis of morphological data sets. Cladistics, 24:
758–773, 2008.
T. Grantham. The role of fossils in phylogeny reconstruction: Why is it so difficult to
integrate paleobiological and neontological evolutionary biology? Biol. Philos., 19:
687–720, 2004.
A. Graybeal. Is it better to add taxa or characters to a difficult phylogenetic problem?
Syst. Biol., 47:9–17, 1998.
R.S. Gupta and P. H. A. Sneath. Application of the character compatibility approach to
generalized molecular sequence data: Branching order of the proteobacterial
subdivisions. J. Mol. Evol., 64:90–100, 2007.
W. Hennig. Phylogenetic systematics. University of Illinois Press, Urbana, 1966.
D.M. Hillis. Molecular versus morphological approaches to systematics. Ann. Rev. Ecol.
Syst., 18:23–42, 1987.
D.M. Hillis. Discriminating between phylogenetic signal and random noise in DNA
sequences. In M. M. Miyamoto and J. Cracraft, editors, Phylogenetic analysis of DNA
sequences, pages 278–294. Oxford University Press, Oxford, UK, 1991.
D.M. Hillis. Inferring complex phylogenies. Nature, 383:130–131, 1996.
24

D.M. Hillis. Taxonomic sampling, phylogenetic accuracy and investigator bias. Syst. Biol.,
47(1):3–8, 1998.
D.M. Hillis, M.W. Allard, and M.M. Miyamoto. Analysis of DNA sequence data:
phylogenetic inference. In E. A. Zimmer, T. J. White, R. L. Cann, and A. C. Wilson,
editors, Molecular Evolution: producing the biochemical data. Methods in enzymology No.
224, pages 456–487. Academic Press, San Diego, 1993.
S.Y.W. Ho. An examination of phylogenetic models of substitution rate variation among
lineages. Biol. Lett., doi:10.1098/rsbl.2008.0729, 2009.
B.R. Holland, H.G. Spencer, T.H. Worthy, and M. Kennedy. Identifying cliques of
convergent characters: concerted evolution in the cormorants and shags. Syst. Biol., 59:
433–445, 2010.
J.P. Huelsenbeck, J. J. Bull, and C.W. Cunningham. Combining data in phylogenetic
analyses. Trends Ecol. Evol., 11:152–158, 1996.
J.P. Huelsenbeck, C. Ané, B. Larget, and F. Ronquist. A Bayesian perspective on a
non-parsimonious parsimony model. Syst. Biol., 57:406–419, 2008.
R.A. Jenner. Accepting partnership by submission? Morphological phylogenetics in a
molecular millenium. Syst. Biol., 53:333–342, 2004.
S. Kelly, R. Grenyer, and R.W. Scotland. Phylogenetic trees do not reliably predict feature
diversity. Diversity Distrib., 20:600–612, 2014.
S. Kumar, M. Nei, J. Dudley, and K. Tamura. MEGA: A biologist-centric software for
evolutionary analysis of dna and protein sequences. Briefings in Bioinformatics, 9:
299–306, 2008.
W. J. Le Quesne. The uniquely evolved character concept and its cladistic application.
Syst. Zool., 23:513–517, 1975.
W.J. Le Quesne. A method of selection of characters in numerical taxonomy. Syst. Zool.,
18:201–205, 1969.
W.J. Le Quesne. Further studies based on the uniquely derived character concept. Syst.
Zool., 21:281–288, 1972.
25

P. Lemey, M. Salemi, and A.-M. Vandamme. The Phylogenetic Handbook: A practical
approach to phylogenetic analysis and hypothesis testing. Cambridge University Press,
Cambridge, 2009.
P.O. Lewis. A likelihood approach for estimating phylogeny from discrete morphological
characters. Syst. Biol., 50(6):913–925, 2001.
C.A. Meacham. A probability measure for character compatibility. Math. Biosci., 57:1–18,
1981.
C.A. Meacham. Theoretical and computational considerations of the compatibility of
qualitative taxonomic characters. In J. Felsenstein, editor, In Numerical Taxonomy,
NATO ASI Series, Vol. G1, pages 304–314. Springer-Verlag, Berlin, 1983.
C.A. Meacham and G.F. Estabrook. Compatibility methods in systematics. Annu. Rev.
Ecol. Syst., 16:431–446, 1985.
J.W. Moon and M.A. Steel. A limiting theorem for parsimoniously bi-coloured trees. Appl.
Math. Lett., 6:5–8, 1993.
N. Neff. A rational basis for a priori character weighting. Syst. Zool., 35:110–123, 1986.
K.C. Nixon and J.M. Carpenter. On simultaneous analysis. Cladistics, 12:221–241, 1996.
C. Patterson. Significance of fossils in determining evolutionary relationships. Annu. Rev.
Ecol. Syst., 12:195–223, 1981.
C. Patterson. Morphological characters and homology. In K. A. Joysey and A. E. Friday,
editors, Problems of Phylogenetic Reconstruction, pages 21–74. Academic Press, London,
1982.
D. Penny and M.D. Hendy. Estimating the reliability of evolutionary trees. Mol. Biol. and
Evol., 3:403–417, 1986.
W.H. Piel, J. Auman, L. Chan, M.J. Dominus, V. Grapeyev, M. Gujral, Y. Guo, H. Lapp,
J. Ruan, H. Shyket, et al. A database of phylogenetic knowledge, 2010. URL
http://treebase.org.
D. Posada and K.A. Crandall. Selecting the best-fit model of nucleotide substitution. Syst.
Biol., 50:580–601, 2001.
26

F. Ronquist, S. Klopfstein, L. Vilhelmsen, S. Schulmeister, D.L. Murray, and A.P.
Rasnitsyn. A total-evidence approach to dating with fossils, applied to the early
radiation of the hymenoptera. Syst. Biol., 61:973–999, 2012.
D. Rose, G. Lueker, and R.E. Tarjan. Algorithmic aspects of vertex elimination on graphs.
SIAM J. Comput., 5:226–283, 1976.
N. Rosenberg. The mean and variance of the numbers of r-pronged nodes and r-caterpillars
in Yule-generated genealogical trees. Ann. Combin., 10:129–146, 2006.
L. Salichos and A. Rokas. Inferring ancient divergences requires genes with strong
phylogenetic signals. Nature, 497:327–331, 2013.
R.W. Scotland, R.G. Olmstead, and J.R. Bennett. Phylogeny reconstruction: the role of
morphology. Syst. Biol., 52(4):539–548, 2003.
C. Semple and M. Steel. Phylogenetics. Oxford University Press (Oxford Lecture Series in
Mathematics and its Applications) Oxford, UK, 2003.
M. Sharkey. A hypothesis-independent method of character weighting for cladistic analysis.
Cladistics, 5:63–86, 1989.
M.S. Springer, A. Burk-Herrick, R.W. Meredith, R. Eizirik, E. Teeling, S.J. O’Brien, and
W.J. Murphy. The adequacy of morphology for reconstructing the early history of
placental mammals. Syst. Biol., 56:673–684, 2007.
M.S. Springer, R.W. Meredith, E. Eazirik, E. Teeling, and W.J. Murphy. Morphology and
placental mammal phylogeny. Syst. Biol., 57:499–503, 2008.
M.A. Steel. Distributions on bicoloured binary trees arising from the principle of
parsimony. Discrete Appl. Math., 41(3):245–261, 1993.
E. Susko, M. Spencer, and A. Roger. Biases in phylogenetic estimation can be caused by
random sequence segments. J. Mol. Evol., 60(1):1–10, 2005.
D.L. Swofford. When are phylogeny estimates from molecular and morphological data
incongruent? In M. M. Miyamoto and J. Cracraft, editors, Phylogenetic analysis of DNA
sequences, pages 295–333. Oxford University Press, Oxford, 1991.
27

C. Tuffley and M. Steel. Links between maximum likelihood and maximum parsimony
under a simple model of site substitution. B. Math. Biol., 59(3):581–607, 1997.
P.J. Wagner. Exhaustion of morphologic character states among fossil taxa. Evolution, 54
(2):365–386, 2000.
P.J. Wagner. Modelling rate distributions using compatibility: implications for
morphological evolution using fossil invertebrates. Biol. Lett., 8:143–146, 2012.
J.W. Wenzel and M.E. Siddall. Noise. Cladistics, 15:51–64, 1999.
J.J. Wiens. The role of morphological data in phylogenetic reconstruction. Syst. Biol., 53:
653–661, 2004.
J.J. Wiens, C.A. Kuczynski, T. Townsend, T.W. Reeder, D.G. Mulcahy, and J.W.J. Sites.
Combining phylogenomics and fossils in higher-level squamate reptile phylogeny:
molecular data change the placement of fossil taxa. Syst. Biol., 59:674–688, 2010.
M. Wilkinson. The permutation method and character compatibility. Syst. Biol., 43:
343–368, 1994.
E.O. Wilson. A consistency test for phylogenies based on contemporaneous species. Syst.
Zool., 14(3):214–220, 1965.

28

Appendix: Proof of main result

Preliminaries
Suppose we have an unrooted phylogenetic X-tree T , which may or may not have
polytomies. Our first result provides a bound on the probability that a random binary
character is compatible with T , and an exact expression for the probability that two
random binary characters are compatible with each other. Part (b) of the following
proposition differs from an earlier result by Meacham (1981) (based on the even earlier
work of Wilson (1965)) who considered the probability that a pair of random binary
characters are compatible, conditional on the number of taxa in each state for the two
characters.

Proposition 1.
(a) The probability that a random binary character is compatible with a given binary
character that divides X into blocks of size r, and n − r is:
 r−1  n−r−1  n−2
1
1
1
+
−
,
2
2
2

whenever 1 ≤ r ≤ n − 1 (the probability equals 1 if r ∈ {0, 1, n − 1, n}).
(b) The probability pn that two random binary characters on a set of size n are
compatible is given by:
 n−1 !
 n  n−1
1
3
1
pn = 4
−
3−
.
4
2
2
n
Thus, pn is bounded above by 4 43 (and is asymptotically equivalent to it as n
grows).

29

(c) For an unrooted phylogenetic tree on a leaf set X of size n, the probability pT that a
random character on X is compatible with T satisfies:
X  1 n−deg(v)
,
pT ≤
2
v∈I(T )

where I(T ) is the set of interior (internal) vertices of T and deg(v) is the degree of
vertex v (i.e. the number of edges incident with v).
(d) Moreover, for any unrooted phylogenetic tree T that has at least k interior edges,
and n leaves, we have the upper bound:
 n−3  k
1
1
+
.
pT ≤ k
2
2
Before turning to the proof of this result (which is central to the proof of
Theorem 1) we illustrate its application.
Example: To illustrate Part (b) of Proposition 1, consider n = 3 and n = 4 (for
which p3 = 1 and p4 = 58/64). It is clear that any two binary characters on a set of size
three must be compatible, since they are (both) trivial, in agreement with p3 = 1. For a set
of size four, there are 24 × 24 ordered pairs of binary characters (c1 , c2 ) and precisely
6 × 22 = 24 pairs are incompatible, which gives the proportion of pairs that are compatible
as 1 − 24/162 = 58/64 = p4 .
Proof of Proposition 1
Parts (a) and (c) rely on the following observation: Recall that a binary character χ
is compatible with a phylogenetic X-tree if either T or some refinement of T displays χ.
Now, any refinement of T that displays χ is achieved by resolving a uniquely determined
single interior vertex of T (Semple and Steel (2003), Lemma 3.1.7), as illustrated in Fig. 1
(this fact is the basis of the ‘tree-popping’ algorithm of Meacham (1983)). Now, if an
interior vertex v has degree d then there are 2d ways to select a subset S(v) of the incident
branches. For each such selection we obtain a binary character that is compatible with T ,
defined by the condition that the state of each leaf is 1 if and only if the path from that
30

leaf to v contains an edge in S(v). Moreover each binary characters that is compatible with
T can be generated in this way (for some interior vertex v and some set S(v)). Thus, the
total number of binary characters on X that are compatible with T is at most
P
deg(v)
, and since there are 2n binary characters on X in total, then the probability
v∈I(T ) 2
that a random character is compatible with T is as bounded in Part (c).

To establish Part (a) we view a binary character χ that divides X into blocks of size
r and n − r as a phylogenetic X-tree T with two interior vertices v1 and v2 of degrees r + 1
and n − r + 1 (Fig. 1 provides an example with n = 8, r = 3). Let Ei be the leaf edges of T
adjacent to vi (for i = 1, 2) and let e be the edge {v1 , v2 }. Recalling the definition of S(v)
from the previous paragraph, the total number of binary characters on X that are
compatible with T is the 2r+1 choices for S(v1 ) plus the 2n−r+1 choices for S(v2 ) minus the
four choices that are counted twice as they produce the same character, namely:
(i) S(v1 ) = S(v2 ) = ∅;
(ii) S(v1 ) = E1 , S(v2 ) = {e};
(iii) S(v1 ) = {e}, S(v2 ) = E2 ; and
(iv) S(v1 ) = E1 ∪ {e}, S(v2 ) = E2 ∪ {e}.
Thus the number of characters compatible with χ is 2r+1 + 2n−r+1 − 4, and dividing by 2n
(the total number of binary characters on X) gives the expression in Part (a).
Part (b): Let pn (r) be the probability described by Part (a) for all values of r
 n
between 0 and n, and let πn (r) = nr 21 be the probability that a random binary

character divides X into blocks of size r and n − r. Then, by the law of total probability,
the value of pn defined in Part (b) can be written as
(1)

pn =

n
X

πn (r)pn (r).

r=0

n
Now, since πn (0)pn (0) = πn (n)pn (n) = 21 , and we can write the term on the right of
n−1 Pn−1
Eqn. (1) as: 21
+ r=1 πn (r)pn (r). Moreover, from Part (a), for 1 ≤ r ≤ n we can
r−1
n−r−1
n−2
replace pn (r) by αn (r) = 21
+ 21
− 12
to get:
31

pn =


1 n−1
2

+

Pn−1
r=1

πn (r)αn (r). By a slight rearrangement, this is equivalent to:

#
 n−1  n "
n  
X
1
n
1
pn =
−αn (0) − αn (n) +
αn (r) .
+
2
2
r
r=0

From here, use of the identity:

Pn

r=0

n
r

 r
x = (1 + x)r for x =

1
2

and straightforward, if

tedious algebra, leads to the given expression for pn .

Part (d): If T has k interior edges, then T has |I(T )| = k + 1 interior vertices (since
the total number of edges is n + k, and the total number of vertices is n + |I(T )| and since
T is a tree, the number of vertices exceeds the number of edges by exactly 1). Moreover, by
P
the degree-sum formula, v∈I(T ) deg(v) + n · 1 is twice the number of edges of T (i.e.
2(n + k)) and so:
(2)

X

v∈I(T )

deg(v) = n + 2k, with 3 ≤ deg(v) ≤ n − k for all v ∈ I(T ).

If we place the interior vertices in an arbitrary order v1 , . . . , vk+1 and let xi := n − deg(vi ),
then from Part (c) we have:
(3)

pT ≤

k+1  xi
X
1
i=1

2

.

Now, the constraints in (2) are equivalent to the following constraints on the xi :
k ≤ xi ≤ n − 3 and

k
X
i=1

xi = k(n − 2),

and the right-hand-side of (3) is maximised under these constraints when xi = n − 3 for k
values of i, and xi = 3 for the one remaining value of i. This leads to the expression in (d).
2

Proof Theorem 1
We first note that it suffices to prove the results under the assumption that no
unvaried characters are removed. For Parts (i) and (ii) this follows from the observation
32

that removing unvaried random characters from S2 cannot increase the probability of
either (i) a pair of characters in S2 being compatible, or (ii) a character from S2 being
compatible with every non-trivial character from S1 . For Part (iii) the probability that a
random binary character on n taxa is unvaried is

1
;
2n−1

this ensures that the same stated

results apply (asymptotically) for large n.

Part (i): By Boole’s inequality, the probability that at least one pair of the M

random binary characters in S2 are compatible is bounded above by M2 pn , and this is less
n
n

or equal to M2 · 34 ≤ 2M 2 43 by Part (a) of Proposition 1. Thus, if this last quantity
is at most  then with probability at least 1 −  no pair of the random binary characters in

S2 will be compatible. The remainder of the first two claims in part (i) now follows by
simple combinatorics, noting that the characters in S1 are all compatible with each other.
The proof of the third claim in part (i) was described immediately following the theorem.
Part (ii): A character χ in S2 is compatible with all of the characters in S1 ,
precisely if χ is compatible with the minimal phylogenetic X-tree T that displays the K
distinct partitions induced by the non-trivial characters in S1 . Since T has K interior
edges, we can apply Part (d) of Proposition 1 to conclude that the probability a random

n−3
K 
character is compatible with all of the characters in S1 is at most K 12
+ 21
.

Thus, if this quantity is at most δ/M , then, again by Boole’s inequality, the probability

that at least one of the M characters in S2 is compatible with all the characters in S1 is at
most δ. This completes the proof of part (ii).
Part (iii): For a binary character χ on X, and any phylogenetic X-tree T let
ps(χ, T ) denote the parsimony score of χ on T . For a random binary character f on X, we
let ST denote the (random variable) ps(f, T ). Moreover, if T 0 is a binary phylogenetic
X-tree selected uniformly at random we let ∆T be the (compound) random variable
defined by ∆T := ST − ST 0 . Notice that ∆T has two sources of randomness – firstly the
choice of T 0 , and once this is given, ST − ST 0 then has variation due to the random
character f . We first establish the following result (where, in Lemma 2, the ‘outer’
33

expectation in (i) and probability in (ii) is with respect to the random tree T 0 , while the
‘inner’ (conditional) variance in (i) and (ii) is with respect to the random character
(conditional on the choice of random tree T 0 ):

Lemma 2.

4
(i) E[Var[∆T |T 0 ]] = Var[∆T ] ≥ 27
− o(1) n,

2
n ≥ 13 − o(1),
(ii) P Var[∆T |T 0 ] ≥ 27

where o(1) refers here and throughout the rest of the paper to any term that decays to zero
as n grows.

Our proof of this lemma combines a number of ideas. One is the well-known variance
formula that applies when a random variable Y depends on another random variable W :
(4)

Var[Y ] = Var[E[Y |W ]] + E[Var[Y |W ]],

Also helpful is the fact that the distribution of the parsimony score of a random binary
character is the same across all binary trees (Steel 1993), which implies that
E[ps(f, Ta ) − ps(f, Tb )] = 0, for all pairs of binary phylogenetic X-trees Ta , Tb . So, by
taking Ta = T and Tb the random binary tree T 0 , we have E[∆T |T 0 ] = 0. This in turn
implies that E[∆T ] = E[E[∆T |T 0 ]] = 0, and that Var[E[∆T |T 0 ]] = 0, which further implies,
by Eqn. (4) (using Y = ∆T , W = T 0 ) that Var[∆T ] = 0 + E[Var[∆T |T 0 ]], establishing the
first part (the equality) in Lemma 2(i).
To establish the inequality in Lemma 2(i) we make a further crucial observation.
Let R be the random variable that records how many leaves in the generated random
binary character f are in state 1. By Eqn. (4) (applied with Y = ∆T , W = R) we have
(5)

Var[∆T ] ≥ E[Var[∆T |R]],

(since the second first term on the right-hand-side of Eqn. (4) is always non-negative).
34

Furthermore, although the random variables ST and ST 0 are dependent, once we
condition on R they become (conditionally) independent. Therefore,
Var[∆T |R] = Var[ST |R] + Var[ST 0 |R]

(6)

Moreover, both the expressions on the right of this last equation are continuous functions
of p = R/n of the form ϕT (p)n and ϕ(p)n, respectively; moreover, for any binary tree T ,
Corollary 7.2 of Steel (1993) gives:
lim1 ϕT (p) =

p→ 2

2
− o(1),
27

while Theorem 1 of Moon and Steel (1993) gives:
and lim1 ϕ(p) =
p→ 2

2
− o(1)
27

(recall o(1) denote any term that converge to 0 as n grows). By the law of large numbers
(or the Central Limit Theorem), p converges in probability to

1
2

as n grows, and so by

Eqn.(5):
Var[∆T ] ≥ E[Var[∆T |R]] =

(7)




4
− o(1) n.
27

which establishes the inequality in Lemma 2(i).
We now use Part (i) of Lemma 2 to derive Part (ii), by means of the following
general observations. Suppose that a, b > 0 and that Y is any random variable that always
lies between 0 and a(2 + δ) and that E[Y ] ≥ a(1 − ). This ensures the inequality:
a(1 − ) ≤ E[Y ] ≤ a(2 + δ)P(Y ≥ a/2) + (a/2)(1 − P(Y ≥ a/2)),
which simplifies to:
(8)

P(Y ≥ a/2) ≥

35

1 1 − 2
·
.
3 1 + 2δ/3

We apply Inequality (8) with Y = Var(∆T |T 0 ), so that E[Y ] = Var(∆T ), and taking
a=

4
n,
27

Lemma 2(i) ensures that E[Y ] ≥ a(1 − ), where and  is a term of order o(1). It

remains to show that Y is bounded above by a(2 + δ) where δ is also a term of order o(1).
By definition, Var(∆T |T 0 ) = Var(ST |T 0 ) + Var(ST 0 |T 0 ) − 2Cov(ST , ST 0 |T 0 ) and

2
Var(ST |T 0 ) = Var(ST ) and Var(ST 0 |T 0 ) are both equal to 27
+ o(1) n (Steel 1993).

Moreover, |Cov(ST , S|T 0 )| is at most the square root of the product of these two variances.
In summary, Var(∆T |T 0 ) ≤ a(2 + o(1)). Inequality (8) now gives Lemma 2(ii).
Returning to the proof of Part (iii) of the Theorem 1, Theorem 4 of (Bryant and
Steel 2009), shows that the proportion of binary trees that share a given number of
non-trivial splits with any given binary tree T on the same leaf set is asymptotically
Poisson with a mean λT equal to the number of ‘cherries’ of T divided by 2n. Since the
number of cherries in any binary tree with n leaves is at most n2 , we have λT ≤ 14 . Thus the
probability that T 0 shares no non-trivial splits with T1 is at least exp(−1/4) ≈ 0.78. Since
all the characters in S1 are displayed by T1 , the corresponding splits of the non-trivial
characters constitute a subset of the splits of T1 , and so the probability that T 0 displays
one or more non-trivial character in S1 is also at most exp(−1/4).
We combine this with Lemma 2(ii) which shows that for n large, with probability at
least ∼ 31 , a binary phylogenetic X-tree T 0 selected uniformly at random will have
Var(∆T |T 0 ) at least

2
n.
27

Thus, the probability that a binary phylogenetic X-tree T 0

selected uniformly at random satisfies both (a) Var(∆T |T 0 ) at least

2
n,
27

and (b) T 0 displays

none of the non-trivial characters in S1 is (asymptotically) at least
1 − (1 − exp(−1/4) + (1 − 1/3)) > 0.11, by the Bonferroni inequality.
For the rest of the proof T 0 will refer to any one of these (at least) 11% of all
unrooted binary phylogenetic X-trees that satisfy properties (a) and (b) in the last
sentence. Let ps(D, T1 ) and ps(D, T 0 ) be the parsimony score of the data D (consisting of
the characters in S1 and S2 intertwined arbitrarily) on T1 and on T 0 , respectively. Let
δP = ps(D, T1 ) − ps(D, T 0 ), the difference in the parsimony score of T1 and T 0 for the data
D.
36

Notice that we can write δP = δP1 + δP2 where δPi is the parsimony score
difference of the two trees (for T1 minus that for T 0 ) on the characters in Si . Now, P2 is a
sum of M independent and identically distributed random variables, each with expected
2
n. Thus, by the Central Limit Theorem,
value 0, and finite variance that is at least c = 27
√
δP2 / cnM (asymptotically with M ) follows a standard normal distribution with mean 0

and standard deviation at least 1. Moreover, if t is the number of characters in S1 that are
autapomorphic (i.e. trivial but not unvaried) then any binary tree (in particular T 0 )
satisfies ps(S1 , T 0 ) ≤ Lm + t, and (by the assumption that T is compatible with all the
characters in T1 ), ps(S1 , T1 ) = m + t. Thus δP1 = ps(S1 , T1 ) − ps(S1 , T 0 ) ≥ −m(L − 1).
Now T 0 has a lower parsimony score than T1 precisely if δP > 0 and the probability
of this event is given by:


m(L − 1)
,
P(δP2 > −δP1 ) ≥ P(δP2 > m(L − 1)) ≥ P Z > √
cnM
where Z is a standard normal random variable. So, if

m(L−1)
√
cnM

≤ 1, then

P(δP > 0) ≥ P(Z > 1) ≥ 0.15.
Consequently, the probability P that a binary phylogenetic X-tree T 0 selected
uniformly at random is both more parsimonious for D than T1 and displays none of the
non-trivial characters in S1 is at least P 0 Q, where P 0 is the probability that T 0 satisfies
both (a) Var(∆T |T 0 ) at least

2
n,
27

and (b) T 0 displays none of the non-trivial characters in

S1 , while Q is the conditional probability that such a tree T 0 (that satisfies (a) and (b)) is
more parsimonious for D than T . We have shown that P > 0.11 and Q > 0.15 so
P ≥ P 0 Q > 0.0165. Now, the expected number of binary phylogenetic X-trees that are
more parsimonious than T1 on D and displays none of the non-trivial characters in S1 is
P · b(n) where b(n) is the total number of unrooted binary phylogenetic trees with n leaves.
n−1 n−2
Since b(n) ∼ √12 2e
n
(Semple and Steel 2003), and P ≥ 0.0165, we have
P · b(n) ≥ 10n for n ≥ 30, as claimed.

2
37

