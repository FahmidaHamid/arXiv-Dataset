Clades, clans and reciprocal monophyly under neutral
evolutionary models

arXiv:1101.1311v1 [q-bio.PE] 6 Jan 2011

Sha Zhu, James H. Degnan, Mike Steel
Biomathematics Research Centre, University of Canterbury, Private Bag 4800,
Christchurch 8140, New Zealand

Abstract
The Yule model and the coalescent model are two neutral stochastic models
for generating trees in phylogenetics and population genetics, respectively. Although these models are quite different, they lead to identical distributions
concerning the probability that pre-specified groups of taxa form monophyletic
groups (clades) in the tree. We extend earlier work to derive exact formulae
for the probability of finding one or more groups of taxa as clades in a rooted
tree, or as ‘clans’ in an unrooted tree. Our findings are relevant for calculating
the statistical significance of observed monophyly and reciprocal monophyly in
phylogenetics.
Keywords: Yule tree, coalescent model, clade, clan.

Preprint submitted to Theoretical Population Biology

January 10, 2011

1. Introduction
When gene trees are estimated from multiple lineages taken from two or
more populations, there is an increased chance that lineages within each population form monophyletic groups compared to sampling multiple lineages from a
single population. This observation has led to the adoption of a null hypothesis
that a set of lineages belongs to a single population or taxonomic group, in asking whether a particular group of lineages came from a taxonomically distinct
population [14, 3]. Statistical tests for reciprocal monophyly between two sister
taxa can then be developed to test against this null hypothesis [8, 12].
Reciprocal monophyly is central to the genealogical species concept. According to this concept two groups come from different species if they form distinct
monophyletic groups [5, 8]. Gene trees from lineages sampled from one or more
populations are typically estimated, and monophyly (or lack of monophyly) of
these groups can be observed from the clades of the gene tree. Statistical tests
for whether observed levels of monophyly provide sufficient evidence to conclude
that a group is taxonomically distinct can be performed, given a probabilistic
model for the clades on a tree [14].
Two neutral models – involving different evolutionary scales – are useful
in this context. The Yule (pure birth, or birth-death) model describes the
speciation (and extinction) of lineages at the species level as one moves forward
in time, while Kingman’s coalescent process is a population genetic model that
the ancestry of individual lineages back in time as they coalesce (and thereby
form a tree). These are two quite different processes and lead to different branch
lengths on trees; remarkably, however, they generate identical distributions of
tree topologies [1]. Thus, while the coalescent process is a natural model for
trees in single populations, the equivalence of the Yule and coalescent models
for tree topologies means that results for the Yule model can be exploited in
studying probabilities of clades for coalescent trees in single populations.
Although there has been an emphasis on testing for the taxonomic distinctiveness of one group of lineages, joint probabilities of clades could be used to
examine whether the observed monophyly of several groups is statistically significant using a single test. Such an omnibus test of the null hypothesis that all
groups come from one population might be more powerful than testing several
groups one at time.
In this note, we derive exact formulae for the joint probabilities of k clades
for a random Yule/coalescent gene tree under the conditions that the k clades
are mutually exclusive (they have no leaves of the gene tree in common), and are
either exhaustive (all leaves of the gene tree occur in one of the k clades), or form
only a subset of the leaves of the gene tree. These results generalize results from
[12], which provided an explicit formula for the probability that two mutually
exclusive and exhaustive sets of leaves formed clades on a Yule/coalescent gene
tree.
In addition, we extend the results to unrooted trees by giving the probabilities of ‘clans’ (sets of leaves that are all on one side of a split [17]), as well as
the joint probability of k > 1 clans, on Yule/coalescent trees which have been
2

unrooted. This extension is relevant when only unrooted trees can be estimated,
which is particularly common in prokaryotic evolution [10].
2. Clades
Throughout this paper we will let Xn (or, more briefly, X) denote a set of
taxa of size n. Given a rooted phylogenetic X–tree TX (more briefly T ), with
leaf set X = Xn , a clade of T is a subset of X that corresponds to the set of
leaves that are descended from any internal vertex. For example, in Fig. 1(a),
the sets {3, 4} and {1, 2, 3, 4} are two clades. Any two clades A and B of T
satisfy the following compatibility condition:
A ∩ B ∈ {A, B, ∅}.

(1)

This is equivalent to requiring that A = B, one set is a strict subset of the other,
or the two sets are disjoint.
We will let c(T ) denote the set of clades of T , and say that a clade is proper
if it is a strict subset of X. Notice that a rooted phylogenetic tree X–tree has
at most 2n − 1 clades, and it has precisely this number if and only the tree is
binary, that is, if each non-leaf vertex has two descendant vertices.

1

2

3

4

5

6

7

1

5

2

6

7
3

4

ρ

(a)

(b)

Figure 1:
(a) This rooted tree has 13 ‘clades’, including the three sets circled
({1, 2}, {1, 2, 3, 4}, {6, 7}). In this tree {1, 2} and {3, 4} are sister clades, but {1, 2} and {6, 7}
are not. (b) The unrooted tree T −ρ obtained from the tree T in (a) by suppressing the root
vertex ρ. This tree has {3, 4, 5, 6, 7} as a ‘clan’, even though this set is not a clade of T .

3. The Yule-Harding-Kingman process
Consider the probability distribution on binary phylogenetic X–trees described by a model that grows a tree by selecting a leaf uniformly at random
and ‘splitting’ it into two new leaves, as illustrated in Fig. 2. Since we are ignoring branch lengths in this paper and concentrating just on tree topologies, the
3

resulting probability distribution on rooted binary tree topologies is the same
as that given by any (stationary or non-stationary) birth-death process on trees
in which birth (speciation) and death (extinction) events apply exchangeably
to all the species extant at any given moment (see [1] for further details). This
is useful, since the rates of speciation and extinction throughout time may be
both time-dependent and variable according to the number of taxa present [11].
The study of such pure-birth trees was initiated in Yule’s 1925 paper [18],
and the probability distribution on tree topologies (without reference to branch
lengths) was further studied by Harding [6]. Moreover, this probability distribution on trees is precisely the same as that given by a quite different process,
namely Kingman’s coalescent process [9] in population genetics, which starts
at the leaves and successively combines pairs of elements, provided that, once
again, we ignore branch lengths ([1]).
To emphasize this equivalence between a model in macro-evolution (speciation and extinction) and micro-evolution (population genetics) we will refer to
it as the Yule-Harding-Kingman (YHK) process for generating tree topologies.
We will also refer to a random binary phylogenetic X–tree produced by
any of these stochastically equivalent processes as TX (or often just T if X is
clear), and so P(TX = T ) is the probability that T is the actual phylogenetic
X–tree produced by the process. The process, viewed as a pure-birth model, is
illustrated in Fig. 2.
In this paper, we exploit two important properties of the process that generates T . First we recall some notation that will be used throughout: for any
phylogenetic X–tree and any non-empty subset Y of X, let TX|Y be the phylogenetic tree induced by restricting the leaf set to Y (as in [15]). The two
properties that the YHK process enjoys, and which we will exploit throughout
this paper, are the following:
(EP) If T ′ is obtained from T by permuting its leaves, then
P(T = T ′ ) = P(T = T ).
(GE) For any proper (and non-empty) subset A of X, and any rooted binary
phylogenetic tree T with leaf set X − A:
P(TX|(X−A) = T |A ∈ c(T )) = P(T(X−A) = T ).
Property (EP) is the Exchangeability property [1], which requires that the probability of a particular phylogenetic tree depends just on its shape and not on
how its leaves are labeled (it is called ‘label-invariance’ in [16]). Property (GE)
is the Group Elimination property from [1]; it states that, conditional on A
forming a clade in the tree, the tree structure on the remaining taxa is also
described by the YHK process. In turn (GE) implies the following Sampling
Consistency property ([1]): For any rooted binary tree T with leaf set A ⊆ X,
we have:
(SC) P(TX|A = T ) = P(TA = T ).
4

*

(a)

(b)

(c)
Figure 2: From a rooted binary tree on three leaves (a), splitting the right leaf (*) leads to a
‘balanced’ tree shape (b), while splitting either of the other two leaves produces an unbalanced
tree (c). Thus the balanced tree shape has probability 1/3 and as there are three distinct ways
to label the leaves, each of these rooted binary phylogenetic trees has probability 1/9 under
the YHK process. For a phylogenetic tree of shape (c), the probability is 1/18.

To see that (GE) implies (SC), one sequentially deletes leaves that are not in
A, noting that each leaf is, trivially, a clade in any tree.
4. Clade probabilities under the YHK process
The following result is stated and established in the appendix of [7]; it is also
stated and proved in [13] (Theorem 4.4), and in [2] (Proposition 2). A further
proof of this result is also possible based on induction on n and using the wellknown property of the YHK model that the number of leaves in one of the
(randomly selected) maximal subtrees of TX is uniformly distributed between 1
and n − 1.
Lemma 4.1. Let Xn (a) be the number of proper clades of size a in TX . Then
E[Xn (a)] =

2n
, 1 ≤ a ≤ n − 1.
a(a + 1)

5

For a subset A of X, let pn (A) be the probability that A is a proper clade
of TX . From (EP) it is clear that this probability depends only on a = |A| and
n, and so we can write pn (a) for this probability. From [12] we have:
Lemma 4.2.
pn (a) =

(


n −1
2n
,
a(a+1) a

0,

if 1 ≤ a ≤ n − 1;
otherwise.

The proof of this result from [12] relies on a combinatorial identity to sum a
series. Here we point out how Lemma 4.2 follows very directly from Lemma 4.1.
Proof of Lemma 4.2: For 1 ≤ a ≤ n − 1, the exchangeability property (EP)
implies that:
 −1
X
k
n
pn (A) =
P(T has k clades of size a) · n = E[Xn (a)]
,
a
a
k≥0

where Xn (a) is as defined in Lemma 4.1. This completes the proof.

2

4.1. Pairs of clades
For a pair A, B of disjoint subsets of X, let p̂n (A, B) be the probability that
A and B are sister clades of TX (i.e. A, B and A ∪ B are clades of TX ). By
exchangeability (EP), this probability depends on a = |A|, b = |B| and n only,
and so we will denote it p̂n (a, b).
Consider first the special case where n = a + b; that is, A and X − A are
sister clades, which is equivalent to saying that A is a maximal proper clade.
From [4] (Equation 6) (see also [12]), the probability of this event is given as
follows:
Lemma 4.3. For 1 ≤ a ≤ n, we have:
p̂n (a, n − a) =

 −1
2
n
.
n−1 a

We generalize this slightly as follows:
Lemma 4.4. Let k = a + b ≤ n. Then:
p̂n (a, b) =

4a!b!(n − k)!
.
(n − 1)!k(k 2 − 1)

Proof:

p̂n (A, B) = P(A ∪ B ∈ c(TX )) · P A ∈ c(TX|A∪B )|A ∪ B ∈ c(TX ) .

Applying Lemma 4.2 to the first term, and property (SC) and Lemma 4.3 to
the second term we have:


−1
−1
n
a+b
2
2n
·
,
p̂n (A, B) =
(a + b)(a + b + 1) a + b
a+b−1
a
6

from which the result follows.

2

Now, for any two arbitrary subsets A, B of Xn = {1, . . . , n}, let pn (A, B)
be the probability that a Yule tree T on Xn has A and B as proper clades. As
usual, let a = |A| and b = |B|.
Theorem 4.5.

where


pn (a)





Rn (a, b),



R (b, a),
n
pn (A, B) =

p̂n (a, n − a),





rn (a, b),



0,

if A = B [case 1] ;
if A ( B [case 2] ;
if B ( A [case 3] ;
if A ∩ B = ∅, A ∪ B = Xn [case 4] ;
if A ∩ B = ∅, A ∪ B ( Xn [case 5] ;
otherwise [case 6] ;

pn (a), and p̂n (a, n − a) are given by Lemmas 4.2 and 4.3,
 −1  −1
4n
n
b
Rn (a, b) :=
,
a(a + 1)(b + 1) b
a
rn (a, b) :=
Gn (a, b) :=

4a!b!(n − a − b)!
Gn (a, b), and where
(n − 1)!

n
a(a + 1) + b(b + 1) + ab
1
−
+
.
ab(a + 1)(b + 1) ab(a + 1)(b + 1)(a + b + 1) (a + b)((a + b)2 − 1)

Proof: Cases 1 and 4 are given by Lemmas 4.2 and 4.3, respectively. For the
second case (A ( B), we have:
pn (A, B) = P(A ∈ c(TX )|B ∈ c(TX )) · P(B ∈ c(TX )).
Since A ( B we can apply property (SC) and Lemma 4.2 to deduce that the


b −1
n −1
2n
2b
, while the second term is b(b+1)
,
first term in this product is a(a+1)
a
b
from which the result follows. Case 3 follows by an analogous argument. For
Case 5, consider the following two pairs of events:
• E1 : A, B ∈ c(TX ),
• E2 : A ∪ B, B ∈ c(TX ),
• F1 : A ∈ c(TX|(X−B) ),
• F2 : B ∈ c(TX ).
We are interested in computing P(E1 ) since this is pn (A, B) and by the principle
of inclusion and exclusion we have:
P(E1 ) = P(E1 ∪ E2 ) + P(E1 ∩ E2 ) − P(E2 ).
7

(2)

Now, E1 ∪ E2 occurs precisely if F1 ∩ F2 occurs (since E1 ∪ E2 is the event that
B ∈ c(TX ) and either A ∈ c(TX ) or A ∪ B ∈ c(TX )). Thus:
P(E1 ∪ E2 ) = P(F1 |F2 ) · P(F2 ).
Combining this equation with (2) and noting that P(E1 ∩ E2 ) = p̂n (A, B) and
pn (A, B) = P(E1 ), we obtain:
pn (A, B) = P(E1 ) = P(F1 |F2 ) · P(F2 ) − P(E2 ) + p̂n (A, B).

(3)

Now, by (GE),
P(F1 |F2 ) = P(A ∈ c(TX−B )) = pn−b (a),

(4)

and
P(E2 ) = P(A∪B ∈ c(TX ))·P(B ∈ c(TX )|A∪B ∈ c(TX )) = pn (a+b)·pa+b (b). (5)
Thus, substituting (4) and (5) and the equality P(F2 ) = pn (b) into (3), we
obtain:
pn (A, B) = pn−b (a) · pn (b) − pn (a + b) · pa+b (b) + p̂n (a, b).
Case 5 now follows from Lemmas 4.2, 4.4. Case 6 follows from the compatibility
condition (1) for clades.
2
We now ask whether the events ‘A is a clade’ and ‘B is a clade’ are positively
or negatively correlated under the YHK process. Let XA (respectively XB ) be
the Bernoulli (0,1) random variables that take the value 1 if A (respectively
B) is a clade of a YHK tree T on Xn and let ρn (A, B) denote the correlation
coefficient of these two random variables, which is given by:
pn (A, B) − pn (A)pn (B)
.
ρn (A, B) = p
pn (A)(1 − pn (A))pn (B)(1 − pn (B))

Corollary 4.6. For any two strict subsets A, B of X, the correlation ρn (A, B)
is:
• strictly negative, if A, B are not compatible, and undefined if |A| = 1 or
|B| = 1.
• strictly positive, otherwise.
Proof: If A and B are not compatible, then pn (A, B) = 0 but both pn (A) and
pn (B) are greater than zero, and so ρn (A, B) < 0. If |A| = 1 then pn (A) = 1
and pn (A, B) = pn (B) (regardless of whether A is a subset of B or is disjoint
from B). Thus the numerator and denominator of pn (A, B) are both zero. A
similar argument holds if |B| = 1.
In the remaining cases, we consider the ratio pn (A, B)/(pn (A)pn (B)). For
example, in Case 2, we have:
pn (A, B)
(n − 1) · · · (n − a + 1)
=
.
pn (A) · pn (B)
(b − 1) · · · (b − a + 1)
8

n−a+1
This is strictly > 1 since n−1
b−1 > 1, · · · , b−a+1 > 1. Similar arguments apply in
the other cases; however Case 5 requires some detailed algebraic manipulation.
2
Fig. 3 illustrates the correlation coefficient ρn (A, B) for n = 25 in the Cases
2, 4 and 5. Notice that, the correlation is typically much smaller in Cases 2 and
5 than for Case 4.
Case 5

Case 4

Case 2

0.1

0.3
0.04

b=5
0.25

0.035

b = 10

b = 20

0.08

b=5

0.07

0.03
Correlation

0.025
0.02

b = 10

0.015

Correlation

0.2
Correlation

b = 15

0.09

0.15

b = 15

b = 20

0.04

0.02
0.05

0.005

0.05

0.03

0.1
0.01

0.06

0.01

0

0
5

10

a

15

20

0

5

10

a

15

20

5

10

a

15

20

Figure 3: Graphs of ρn (A, B) for n = 25, in Cases 2,4 and 5, with a = |A| and b = |B|.

5. Extension to partitions of X.
Suppose that the collection of sets A1 , A2 , . . . , Ak forms
Pk a partition of X,
and let ai = |Ai |, for i = 1, . . . , k, so that n = |X| = i=1 ai . For a rooted
YHK tree T , let p(a1 , . . . , ak ) be the probability that A1 , A2 , . . . , Ak are clades
of T (this probability depends only on the cardinality of the sets by the exchangeability property). For example, p(2,2,2)=2/225, and from Lemma 4.3,
−1
2
. Our aim in this section is to generalize
we have: p(a1 , a2 ) = a1 +a2 2 −1 a1a+a
1
this to larger values of k. In order to do so, we describe a new result for the
Yule model, which requires a further definition.
For a rooted YHK tree T , and a rooted phylogenetic tree Tk with leaf set
{1, . . . , k}, let p(a1 , . . . , ak ; Tk ) be the probability that A1 , A2 , . . . , Ak are clades
of T and that Tk is the tree obtained from T by replacing each clade Ai by
a single leaf labelled i, for i = 1, . . . , k. Let I(Tk ) denote the set of interior
vertices of Tk .
Theorem 5.1. For k > 1, we have:
(i)
p(a1 , . . . , ak ; Tk ) =

2k−1

Qk

i=1

n!

ai !

Y

v∈I(Tk )

1
Pk

i=1

ai Iv (Ai ) − 1

!

,

where Iv (Ai ) is the indicator variable that takes the value of 1 if i lies
below v in Tk and 0 otherwise.

9

(ii)
p(a1 , . . . , ak ) =

X

p(a1 , . . . , ak ; Tk ),

Tk

where the summation is over all distinct rooted binary phylogenetic trees
on leaf set {1, . . . , k}.
Proof: We prove the result by induction on k. For k = 2, Lemma 4.3 gives

n −1
2
p(a1 , a2 ; T2 ) = p̂n (a1 , a2 ) = n−1
, where n = a1 + a2 , which agrees with
a
the expression given in part (i) with k = 2.
Now suppose that part (i) holds whenever k is less or equal to m ≥ 2;
we will show that it also holds when k = m + 1. Thus, suppose we have
a collection C = {A1 , . . . , Am+1 } that partitions X, and also have a rooted
binary phylogenetic tree Tm+1 on leaf set {1, . . . , m + 1}. Then Tm+1 has a
cherry (two leaves adjacent to the same vertex). Without loss of generality (by
re-ordering the sets if necessary), we may suppose that these two leaves are m
and m + 1. Consider the collection of m sets obtained from C by replacing
Am and Am+1 by their union, and let T ′ be the tree obtained from Tm+1 by
deleting the leaves m and m+1 along with their incident edges and labelling the
exposed vertex by m. Notice that T ′ rooted binary phylogenetic tree that has
leaf set {1, . . . , m}. By the exchangeability and group elimination (via sampling
consistency) properties we have, for a′m := am + am+1 , the following identity:
p(a1 , . . . , am+1 ; Tm+1 ) = p(a1 , . . . , a′m ; T ′ ) · p̂a′m (am , am+1 ),
where p̂a′m (am , am+1 ) is the probability that a Yule tree on leaf set Am ∪ Am+1
has Am and Am+1 as sister (and thus maximal) clades. Applying the induction
hypothesis for the first term on the right-hand side of this equation, namely
p(a1 , . . . , a′m ; T ′ ), and applying Lemma 4.3 for the second term, and collecting
terms, leads to the expression in Part (i) for k = m + 1 and thereby justifies the
induction step.
Part (ii) follows by observing that each tree T that has A1 , . . . , Ak as clades
has one (and only one) associated tree Tk , and so these trees provide a partition
of the event for which the probability is given by p(a1 , . . . , ak ).
2
As an illustration of Theorem 5.1, we have the following result for k = 3:
" 3
#
4a1 !a2 !a3 ! X
1
p(a1 , a2 , a3 ) =
,
n!(n − 1) i=1 n − ai − 1
where n = a1 + a2 + a3 .
We note that, as well as being a generalization of Lemma 4.3 to k > 2,
Theorem 5.1(i) also generalizes the classic result that the probability
that a

n−1 Q
1
YHK tree T has a given tree topology Tk is 2 k!
,
where
nv is
v∈I(Tk ) nv −1
the number of leaves of Tk below v (see [4] or [15]). This can be seen by setting
a1 = a2 = · · · = an = 1 in Theorem 5.1(i) .

10

6. Extension to unrooted trees
If we suppress the root ρ of a rooted binary phylogenetic X–tree T , we
obtain an unrooted binary phylogenetic X–tree, which we will denote as T −ρ
(as shown in Fig. 1(b)). Following [17], (see also [10]) we say that a subset A
of X is a clan of an unrooted phylogenetic X–tree T ′ if A|X − A is a split of
T ′ . Note that any clade of the rooted tree T becomes a clan of T −ρ . However,
this latter tree also has additional clans that do not correspond to a clade of T .
The precise relationship is given as follows:
Lemma 6.1. Given a rooted binary X–tree, T , a set A is a clan of T −ρ if and
only if either A is a clade of T or X − A is a clade of T .
Now suppose the rooted phylogenetic tree T is generated under the YHK
process. Then we obtain an induced probability for the unrooted tree T −ρ . Note
that the same unrooted tree can arise from different rootings. This probability
distribution on unrooted phylogenetic trees can also be described directly as a
Yule-type process on unrooted trees in which, at each stage, a leaf is selected
uniformly at random and a new leaf (with a random label) is attached to its
incident edge (see e.g. [16]). Fig. 4 illustrates how different leaf choices in this
process lead to different shapes of unrooted trees.
For a strict non-empty subset A of Xn , let qn (A) be the probability that A
is a clan of the unrooted YHK tree on leaf set Xn ; by (EP) this depends only
on a = |A| and n so we will also write it as qn (a).
Lemma 6.2.
qn (a) = 2n



1
1
1
+
−
a(a + 1) b(b + 1) (n − 1)n

  −1
n
,
a

where a = |A|, b = n − a.
Proof: By Lemma 6.1, we have:
qn (A) = pn (A) + pn (X − A) − pn (A, X − A).
Applying Lemmas 4.2 and 4.3, noting that pn (A, X − A) = p̂n (A, X − A), leads
to the claimed equation.
2
Now consider two disjoint subsets A and B of X, and let qn (A, B) be the
probability that A and B are both clans of the unrooted YHK tree on leaf set
Xn . By (EP), this probability depends only on a = |A|, b = |B| and n, and so
we will denote it as qn (a, b). As an example, we have:
q6 (2, 2) = 7/225.
To see this, observe that if we take (say) A = {1, 2}, B = {3, 4} then, referring
to Fig. 4, there is just one tree of shape (b) and two of shape (c) that has both
2
1
+2× 225
. We now give an exact analytical
clans A and B. Thus, q6 (2, 2) = 1× 75
formula for qn (a, b).
11

*

(a)

(b)

(c)
Figure 4: Only one unrooted binary tree shape is possible with five leaves (a), but two are
possible with six leaves (b, c). If the ‘central’ leaf (*) of tree a is split to form two leaves, then
we obtain tree shape (b), while splitting any one of the remaining four leaves produces tree
shape (c). Thus, tree shape (b) has probability 1/5. Since there are 6!/3!23 = 15 distinct ways
to label its leaves, each of the resulting phylogenetic trees has probability 1/75. By contrast,
any phylogenetic tree of shape (c) has probability 4/5 × 1/90 = 2/225.

Theorem 6.3.
(i) If a + b = n, then:


2a!b!
1
1
1
qn (a, b) = qa+b (A) =
.
+
−
(a + b − 1)! a(a + 1) b(b + 1) (a + b)(a + b − 1)
(ii) If a + b < n then:
qn (a, b) = rn (a, b)+Rn (a, n−b)+Rn (b, n−a)−p̂n (b, n−b)pn−b (a)−p̂n (a, n−a)pn−a (b),
where the first three quantities are as given in Theorem 4.5 (Cases 2, 3
and 5), while the last two terms are given by Lemmas 4.2 and 4.3.
Proof: Part (i) follows from Lemma 6.2, noting that n = a + b. For part (ii),
Lemma 6.1 implies that A and B are clans of T −ρ precisely if one of the following
three events occur:

12

(a) A and B are clades of T ;
(b) A and X − B are clades of T , but B is not a clade of T ;
(c) B and X − A are clades of T , but A is not a clade of T ;
(Note that X − A and X − B cannot both be clades of T , by the compatibility
condition (1) since (X − A) ∩ (X − B) 6= ∅ by the assumption that a + b < n,
and since X − A neither contains nor is contained in X − B). Moreover, the
three events (a), (b), (c) are mutually exclusive, by virtue of the the assumption
that A, B are disjoint and their union is a strict subset of X. The probability of
Event (a) is rn (a, b), while the probability of Event (b) is Rn (a, n− b)− p̂n(b, n−
b)pn−b (a) since the first term is the probability that A and X − B are clades of
T , and p̂n (b, n − b)pn−b (a) is the probability that A, X − B and B are clades
of T . Similarly, Rn (b, n − a) − p̂n (a, n − a)pn−a (b) is the probability of Event
(c). The result now follows by adding the probabilities of these three mutually
exclusive events.
2
6.1. Extensions of the clan condition (I)
For a pair A, B of disjoint subsets of X a weaker condition than requiring
that A and B are both clans of T −ρ is simply to require that at least one edge
of this tree separates A from B. Let Qn (A, B) be the probability of this event
for an unrooted YHK tree on the leaf set Xn . Then we have the following
result, which follows from the sampling consistency (SC) property applied in
the unrooted setting.
Qn (A, B) = qa+b (A),
(6)
where qa+b (A) is given by Theorem 6.3(i).
6.2. Extensions of the clan condition (II)
We now describe a second extension. Suppose A1 , A2 , . . . , Ak partition X,
and, as usual, let ai = |Ai |. For an unrooted YHK tree T let q(a1 , . . . , ak ) be
the probability that A1 , A2 , . . . , Ak are clans of T and let q ′ (a1 , . . . , ak ) be the
probability that A1 , A2 , . . . , Ak are convex on T (that is, the minimal subtree
connecting the leaves in Ai is vertex disjoint from the minimal subtree connecting the leaves in Aj for all pairs i, j; see [15] for further details and the biological
significance of convexity).
We have calculated q when k = 2 above (and q ′ = q in this case). We turn
now to the next case of of interest, k = 3, where, for example, we have:
q(2, 2, 2) = 1/75, and q ′ (2, 2, 2) = 1/15.
The following result provides an exact formulae for these two quantities for
arbitrary (a1 , a2 , a3 ).
Theorem 6.4. Let n = a1 + a2 + a3 . Then:
hP
i
3
1
1 !a2 !a3 !
(ii) q(a1 , a2 , a3 ) = 4a(n−1)!
i=1 (n−ai )((n−ai )2 −1) .
13

(ii) q ′ (a1 , a2 , a3 ) = qn (a1 , a2 ) + qn (a1 , a3 ) + qn (a2 , a3 ) − 2q(a1 , a2 , a3 ), where
qn (ai , aj ) is given in Theorem 6.3(ii), and q(a1 , a2 , a3 ) is from part (ii).
Proof: For part (i), the event that A1 , A2 and A3 (which partition X) are
clans of T −ρ is the union of three disjoint events Ejk over the three choices of
{j, k} ∈ {{1, 2}, {1, 3}, {2, 3}}, where Ejk is the event that the union of two of
the sets – say Aj and Ak – must be a clade of T , and that this clade has maximal
clades Aj and Ak . The exchangeability and group elimination conditions then
give:
q(a1 , a2 , a3 ) = P(E12 ) + P(E13 ) + P(E23 ) =

3
X

pn (n − ai ) · p̂aj +ak (aj , ak ),

i=1

where {ai , aj , ak } = {1, 2, 3} in the term on the right-hand side of this last
equation. By Lemmas 4.2 and 4.3, this gives:
q(a1 , a2 , a3 ) =

3
X
i=1

2n
(n − ai )!ai !
aj !ak !
2
·
(n − ai )(n − ai + 1)
n!
(n − ai − 1) (n − ai )!

which simplifies to the expression given in (ii).
For part (ii), the event that A1 , A2 and A3 are convex on T −ρ is the
′
union of three (non-disjoint!) events Ejk
over the three choices of {j, k} ∈
′
{{1, 2}, {1, 3}, {2, 3}}, where Ejk is the event that two of the sets – say Aj and
Ak – are clans of T −ρ . Note that the intersection of any two (or three) of these
three events is simply the event that all three sets are clans of T , which was
dealt with in part (i). Thus, by the principle of inclusion and exclusion, we
have:
′
′
′
q ′ (a1 , a2 , a3 ) = P(E12
) + P(E13
) + P(E23
) − 2q(a1 , a2 , a3 )
and the result in part (iii) now follows.
2
Deriving explicit formulae for q(a1 , . . . , ak ) and q ′ (a1 , . . . , ak ) for k > 3 is,
in principle, possible but the formulae quickly become increasingly complex.
6.3. Extensions of the clan condition (III)
A third extension is to consider the probability Qn (A1 , A2 ) that two sets
A1 , A2 are clans of a YHK tree on n leaves when these two sets are not disjoint.
For this setting we have the following result.
Proposition 6.5. Suppose A1 , A2 are non-disjoint subsets of X, and ai = |Ai |.
(i) If A1 ⊂ A2 , then:
Qn (A1 , A2 ) = qn (a1 , n − a2 ),
where qn (∗, ∗) is given by Theorem 6.3. Similarly, if A2 ⊂ A1 then
Qn (A1 , A2 ) = qn (n − a1 , a2 ).

14

(ii) Otherwise, if neither set A1 , A2 is a subset of the other, then:
(
qn (a1 − a12 , a2 − a12 ), if A1 ∪ A2 = X;
Qn (A1 , A2 ) =
0,
otherwise.
where a12 = |A1 ∩ A2 |, and qn (∗, ∗) is given by Theorem 6.3.
Proof: First observe that if A1 ⊂ A2 then A1 and A2 are clans of an unrooted
phylogenetic X–tree T if and only if A1 and X − A2 are clans of T . Noting that
these are disjoint sets, the first part of Proposition 6.5 follows from Theorem
6.3. For the second case, where neither set A1 , A2 is a subset of the other,
first observe that in order for A1 and A2 to be clans of the same unrooted
phylogenetic X–tree T a necessary condition is that A1 ∪ A2 = X. Moreover,
under this condition, A1 and A2 are clans of T if and only if A1 − A1 ∩ A2
and A2 − A1 ∩ A2 are clans of T ; as these are disjoint sets, the second part of
Proposition 6.5 follows from Theorem 6.3.
2
7. Discussion
The arguments we have used in our analysis have primarily relied on repeated
application of the properties of exchangeability (EP) and group elimination
(GE) (or its corollary, sampling consistency (SC)) for the YHK model, together
with Lemmas 4.2 and 4.3. However other natural models for trees can also
satisfy some of these properties. Indeed the distribution that assigns each rooted
binary phylogenetic tree on Xn the same probability (sometimes known as the
‘Proportional to Distinguishable Arrangements’, or PDA model) satisfies both
(EP) and (GE) [1]. This suggests that by finding and applying the corresponding
results to Lemma 4.2 and 4.3 for the PDA model, one could develop a parallel
line of results for the PDA model to most of the analysis we have provided in
this paper for the YHK model.
Unfortunately only one other model, apart from PDA and YHK, is known
to satisfy both (EP) and (GE) and this model is not of biological interest, as it
only generates pectinate (comb-like) tree shapes. Aldous [1] has conjectured that
these are the only three distributions on rooted binary phylogenetic trees that
that satisfy both (EP) and (GE). Nonetheless, it may be of interest to explore
models that satisfy weakened assumptions - for example, (EP) and (SC), or just
(EP).
Even with (EP) alone, one can devise meaningful statistical significance tests.
For example, suppose N taxa include one or more particular (disjoint) subsets
(different ‘types’ of taxa) A1 , A2 , . . . , Ak , where k ≥ 1. Consider any model for
generating a rooted binary tree that satisfies the exchangeability property (EP),
and let pn be the probability that a tree on this set of taxa as leaves, generated
under this model, has at least one clade of size at least n consisting of just one
type (i.e. all leaves in the clade are a subset of one of the sets A1 , . . . , Ak ). Then
we have the following result, the proof of which is given in the Appendix.

15

Proposition 7.1. For any probability distribution on rooted binary trees satisfying the exchangeability property (EP), we have:
pn ≤

ai
k X
X

i=1 m=n

where ai = |Ai |.

ai
m
,
N −1
m−1



As a simple example, suppose we have N = 40 taxa, including two disjoint
groups, each containing six taxa. For a tree generated under any model that
satisfies the exchangeability property, the probability that this tree would contain a clade of size four of larger consisting entirely of taxa from one of the two
groups is, at most:

!

2·

6
4

39
3

+

6
5

39
4

+

6
6

39
5

< 0.005.

8. Acknowledgements
We thank the Royal Society of NZ (Marsden Fund and James Cook Fellowship) and the Allan Wilson Centre for Molecular Ecology and Evolution for
funding this work. We also thank Arne Mooers for comments that motivated
the development of Proposition 7.1.
References
[1] D. Aldous, Probability Distributions on Cladograms, in: D. Aldous, R. Pemantle (Eds.), Random Discrete Structures, IMA Volumes in Mathematics
and its Applications 76, Springer, 1995, pp. 1–18.
[2] M.G.B. Blum, O. Francois, External branch length and minimal clade size
under the neutral coalescent, Adv. Appl. Probab. 37 (2005) 647–662.
[3] M.P. Cummings, M.C. Neel, K.L. Shaw, A genealogical approach to quantifying lineage divergence, Evol. 62 (2008) 2422–2422.
[4] J.K.M. Brown, Probabilities of evolutionary trees, Syst. Biol. 43 (1994) 8–91.
[5] K. DeQuieroz, Species concepts and species delimitation, Syst. Biol. 56
(2007) 879–886.
[6] Harding, E.F. (1971). The probabilities of rooted tree shapes generated by
random bifurcation. Adv. Appl. Probab. 3, 44-77.
[7] S.B. Heard, Patterns in tree balance among cladistic, phenetic, and randomly generated phylogenetic trees, Evol. 46 (1992) 1818–1826.

16

[8] R.R. Hudson, J.A. Coyne, Mathematical consequences of the genealogical
species concept, Evol. 56 (2002) 1557–1565.
[9] J.F.C. Kingman, On the genealogy of large populations, J. Appl. Probab.
19A (1982) 2743.
[10] F-J. Lapointe, P. Lopez, Y. Boucher, J. Koenig, E. Bapteste, Clanistics: a
multi-level perspective for harvesting unrooted gene trees, Trends Microbiol.
(in press).
[11] D. L. Rabosky, I.J. Lovette, Explosive evolutionary radiations: decreasing
speciation or increasing extinction through time? Evol. 62 (2008) 1866-1875.
[12] N.A. Rosenberg, The shapes of neutral gene genealogies in two species:
probabilities of monophyly, paraphyly, and polyphyly in a coalescent model,
Evol. 57 (2003) 1465–1477.
[13] N.A. Rosenberg, The mean and variance of the numbers of r-pronged nodes
and r-caterpillars in Yule-generated genealogical trees, Ann. Comb. 10 (2006)
129–146.
[14] N.A. Rosenberg, Statistical tests for taxonomic distinctiveness from observations of monophyly, Evol. 61 (2007) 317–323.
[15] C. Semple, M. Steel, Phylogenetics, Oxford University Press, 2003.
[16] M.A. Steel, D. Penny, Distributions of tree comparison metrics - some new
results. Syst. Biol. 42 (1993) 126–141.
[17] M. Wilkinson, J.O. McInerney, R.P. Hirt, P.G. Foster, T.M. Embley, Of
clades and clans: terms for phylogenetic relationships in unrooted trees,
Trends Ecol. Evol. 22 (2007) 114–115.
[18] G. U. Yule, A mathematical theory of evolution. Based on the Conclusion
sof Dr. J.C. Willis, F.R.S. Phil. Trans. Roy. Soc. 213 (1925), 21-87.

9. Appendix: Proof of Proposition 7.1
Let Xm,i be the number of clades of size m in the randomly-generated
tree
Pk that
Pai has the property that the taxa are all of type Ai , and let X :=
i=1
m=n Xm,i . Then pn = P(X > 0). Since X is a non-negative integer
random variable, we have:
P(X > 0) ≤ E[X].

(7)

By linearity of expectation we have:
E[X] =

ai
k X
X

i=1 m=n

17

E[Xm,i ].

(8)

Moreover:
E[Xm,i ] =

X

E[Xm,i |t]P(t),

(9)

t

where the summation is over all binary tree shapes on the given leaf set of
size N , E[Xm,i |t] is the conditional expectation of Xm,i given that t is the tree
shape generated by the random speciation process, and P(t) is the probability
of generating tree shape t. For any given the tree shape t:
X
E[Xm,i |t] =
E[Iv,i |t],
(10)
v:nv =m

where the summation is over all the interior vertices of t for which the number
of leaves below v (nv ) is m, and where Iv,i is the binary random variable that
takes the value 1 precisely if all the leaves below v are of type Ai , and Iv,i = 0
otherwise. Now, by exchangeability, we have the following identity for any
vertex v of t with nv = m:

ai
E[Iv,i |t] = P(Iv,i = 1|t) =

m
,
N
m

(11)

Now any tree shape on N leaves has, at most, N/m vertices v for which nv = m,
(ai )
(ai )
N
· m
= Nm−1 . Since this
and so we obtain, from (10) and (11), E[Xm,i |t] ≤ m
N
)
(m
(m−1)
inequality holds for all tree shapes t, Equation (9) implies that: E[Xm,i ] ≤
(ami )
N −1 . The expression for pn now follows from Equations (7) and (8).
(m−1
)
2

18

