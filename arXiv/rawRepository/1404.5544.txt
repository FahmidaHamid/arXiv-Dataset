Estimating binding properties of transcription factors from
genome-wide binding profiles
Nicolae Radu Zabet1,2,† and Boris Adryan1,2,∗
1 Cambridge

Systems Biology Centre, University of Cambridge, Tennis Court Road, Cambridge CB2 1QR, UK

2 Department

arXiv:1404.5544v3 [q-bio.QM] 29 Oct 2014

∗

of Genetics, University of Cambridge, Downing Street, Cambridge CB2 3EH, UK

Corresponding author: ba255@cam.ac.uk

†

Correspondence can also be addressed to: n.r.zabet@gen.cam.ac.uk

Abstract
The binding of transcription factors (TFs) is essential for gene expression. One important characteristic
is the actual occupancy of a putative binding site in the genome. In this study, we propose an analytical
model to predict genomic occupancy that incorporates the preferred target sequence of a TF in the form
of a position weight matrix (PWM), DNA accessibility data (in case of eukaryotes), the number of TF
molecules expected to be bound specifically to the DNA and a parameter that modulates the specificity of
the TF. Given actual occupancy data in form of ChIP-seq profiles, we backwards inferred copy number and
specificity for five Drosophila TFs during early embryonic development: Bicoid, Caudal, Giant, Hunchback
and Kruppel. Our results suggest that these TFs display thousands of molecules that are specifically bound
to the DNA and that, while Bicoid and Caudal display a higher specificity, the other three transcription
factors (Giant, Hunchback and Kruppel) display lower specificity in their binding (despite having PWMs
with higher information content). This study gives further weight to earlier investigations into TF copy
numbers that suggest a significant proportion of molecules are not bound specifically to the DNA.

1

Introduction

Site-specific transcription factors (TFs) bind to the DNA and control the transcription rate of genes. Identifying
the parameters influencing the interactions between TFs and DNA is essential in unveiling the gene regulatory
program and better understanding the gene regulatory process. Significant insight has been gained by deriving
the genome-wide binding profiles of TFs and, often, two complementary approaches have been combined to
determine and analyse these genomic binding events, namely: (i) experimental determination of regions of
genomic occupancy through chromatin immunoprecipitation experiments (ChIP-chip or ChIP-seq) [1] and (ii)
computational inference of the very binding sites using various bioinformatics and biophysics approaches. In
most cases, these computational approaches are based on scanning the DNA with a preferred DNA word, the
so-called motif (often represented in the form of position weight matrix - PWM) [2]. However, this approach
discards effects from steric hindrance and competition on the DNA [3–5] or saturation of the binding sites due
to high abundance of the TF [6–12].
An alternative to the bioinformatics approach is the statistical thermodynamics framework, which models
the binding of TF molecules to DNA segments using the principles of physical chemistry [4, 6–10, 13–17]. This
approach considers both steric hindrance and the number of molecules that are bound to the DNA. Briefly, this
framework computes the statistical weight for each possible configuration of the system, where a configuration
represents the specific combination of locations on the DNA segment that are occupied by TF molecules.
However, given the number of possible configurations, the computations of all statistical weights becomes
challenging with increasing DNA segment size. To address this problem, we used several approximations within
the statistical thermodynamics framework [10, 18–20], which lead us to develop an analytical solution. This
analytical model now allows us to compute binding profiles with the benefits of thermodynamics methods on
a genomic scale (e.g. we computed the ChIP-seq profile of five TFs over 92 M bp of DNA in less than one
day using one CPU), instead of being restricted to a few loci compared to the classical approach as it was the
case in some previous studies [4, 13–17]. This model takes as input four parameters: (i) a PWM, (ii) DNA
accessibility data, (iii) the predicted or measured number of molecules that are specifically bound to the DNA
and (iv) a factor that modulates the specificity of the TF [21]. While the first two parameters are often known
– the PWM from in vitro experiments such as DNAse I footprinting, EMSA, SELEX or PBM [22] and the DNA
accessibility data from genome-wide DNase I-seq experiments – the last two parameters are usually unknown
1

and difficult to measure. Here, we show that the number of specifically bound molecules and the specificity of
the TF can be computed by fitting the predictions of the model to experimentally determined binding profiles.
We applied our model on binding data of five TFs (Bicoid, Caudal, Giant, Hunchback and Kruppel) in
the D. melanogaster stage 5 embryo [23, 24]. Using the aforementioned rationale, we identified the number of
DNA bound molecules and the specificity for each of these TFs that fit the ChIP-seq signal with good accuracy.
In particular, we estimate that the abundance of each of the TFs in the system is in the range of thousands
of molecules that are specifically bound to the DNA per cell/nuclei. Finally, we also found that, while Bicoid
and Caudal display high specificity (being able to better discriminate better between “good” and “bad” DNA
words), Giant, Hunchback and Kruppel display lower specificity.

2

Materials and Methods

2.1

Analytical model

In our previous work [11], we investigated the genomic occupancy of TFs using a comprehensive model that
simulated the dynamics of TF molecules in the cell. We consider the facilitated diffusion mechanism, which
assumes that the molecules perform 3D diffusion in the cytoplasm/nucleoplasm and 1D random walk on the
DNA [25–35]. Our results showed that the genomic occupancy of TFs is mainly influenced by: (i) TF abundance
and (ii) PWM information content [11]. These results suggest that the statistical thermodynamics framework
could accurately predict the genomic occupancy of TFs, although at a high computation cost. We addressed
this issue, and in the Appendix we derive an analytical model based on statistical thermodynamics framework
to compute the probability that a binding site is occupied as (see section A1)
Pjbound (λ, w, N, a) =

1
N · aj · e( λ wj )
D
E
1
1
N · aj · e( λ wj ) + L · n · ai e( λ wi )

(1)

i

where N is the number of molecules bound to the DNA, aj represents the accessibility at site j, λ represents
a scaling factor of the PWM score [8, 21], wj represents the PWM score at site j, L the length of the DNA
and n is the ploidy level (the number of copies of the genome, e.g. for diploid genomes n = 2). When DNA
accessibility data is discarded, then aj = 1, ∀j.

2.2

Data sets

In Figure 1, we plot the sequence logos of the PWMs for the five TFs included in our analysis (Bicoid, Caudal,
Giant, Hunchback and Kruppel); Berkeley Drosophila Transcription Network Project (bdtnp.lbl.gov) [16].
To generate occupancy profiles we used a method originally introduced by [16], for which we selected a mean
segment length of 200 bp, a standard deviation of 200 bp and the profile was smoothed over 250 bp; see also [11].
First, we consider all the loci from [16], which are also listed in Table A3 in the Appendix.

1

2

3

4

5

Position

6

7

8

1
0.5
0
1

2

3

4
Position

5

6

7

HB

2

Information content

0

Information content

1
0.5

GT

2
1.5

1.5
1
0.5
0
1

2

3

4

5

Position

6

7

8

KR

2

Information content

CAD
Information content

Information content

BCD
2
1.5

1.5
1
0.5
0
1

2

3

4

5

6

Position

7

8

9

10

2
1.5
1
0.5
0
1

2

3

4

5

6

7

8

9

10

11

Position

Figure 1: PWMs for the five TFs. The graph show the sequence logos for the following TFs: (i) Bicoid, (ii)
Caudal, (iii) Giant, (iv) Hunchback and (v) Kruppel as also used in [16]. When computing the PWMs we used
a pseudo-count of 1. The information content for the five motifs is: (i) IBCD = 11.3, (ii) ICAD = 10.7, (iii)
IGT = 8.7, (iv) IHB = 15.6 and (v) IKR = 17.3.
In our analysis, we also consider DNA accessibility data derived from DNase-seq experiments in stage 5 D.
melanogaster embryos. The raw data are from [36] and was used to compute the probability of accessible DNA;
see [16] and equation (A9) in the Appendix. In addition, we also used in our analysis the set of DNA accessible
regions computed at a 5% false discovery rate (14.5 M bp) [24] and represented accessible sites by a = 1 and
inaccessible regions by a = 0; note that the dm3 release 5 coordinates of these regions were downloaded from ftp:
//hgdownload.cse.ucsc.edu/goldenPath/dm3/database/bdtnpDnaseAccS5.txt.gz. The D. melanogaster
genome consists of the euchromatin (chromosomes chr2L, chr2R, chr3L, chr3R, chr4, chrX), heterochromatin
(chr2LHet, chr2RHet, chr3LHet, chr3RHet, chrXHet, chrYHet), unmapped regions (ChrU and chrUextra) and
2

mitochondrial genome (ChrM) [37]. Only 5.6% of the DNase-seq reads from [36] map to heterochromatin or
unmapped regions and only 3.1% of the total accessible DNA is in heterochromatin or on ChrU. The contribution
of the heterochromatin and ChrU to our analysis is negligible and, thus, we considered in our analysis only the
euchromatic genome (≈ 120 M bp).

2.3

Quantifying the differences between the analytical model and experimental
data

To quantify the difference between our analytical model and the experimental data, we consider two measures,
namely: (i) the Pearson correlation coefficient (ρ) and (ii) the normalised mean squared error over 1 Kbp
(M SE).

3

Results

We applied our analytical model (derived in Materials and Methods and Appendix ) to investigate the ChIP-seq
data set published in [23], which lead to a direct comparison to the method proposed in [16]. This data set
consists of ChIP-seq profiles determined in stage 5 D. melanogaster embryos for five TFs: (i) Bicoid (BCD),
(ii) Caudal (CAD), (iii) Giant (GT), (iv) Hunchback (HB) and (v) Kruppel (KR).
Our analytical model requires four parameters: (i) the PWM for the factor under investigation, (ii) the
DNA accessibility data over the locus that is analysed, (iii) the number of bound molecules (as can be inferred
from genomic binding data) and (iv) the specificity of the TF for the DNA (through the λ factor); see equation
(1). We used the PWMs presented in Figure 1 and treated DNA either as ‘naked’ or used DNA accessibility
from previously published work [16, 24, 36].
The number of bound molecules and TF specificity λ are usually unknown. Here, we estimate these
parameters by identifying the values that produce the best fit with the experimentally measured profile [7, 8,
10, 17]. First, we converted the binding probability determined by equation (1) into an occupancy profile (an
artificial ChIP-seq signal; using equation (A8) in the Appendix ) and then we generate the ChIP-like in silico
profiles using a method described by [16], (selecting a mean segment length of 200 bp and a standard deviation
of 200 bp and then smoothing the profile over 250 bp); the R implementation of this method is described in [11].
Figure 2 plots the heatmap of the correlation and mean squared error for Bicoid and Caudal when the
number of bound molecules and λ factor are varied. We performed a grid search to identify the sets of parameters
(TF abundance and specificity) that maximises the correlation and that minimises the mean squared error. Our
results show that the set of parameters that minimises the mean squared error lead to only a negligible reduction
in the correlation compared to its maximum value. In contrast, the parameters that maximises the correlation
lead to a strong increase in the mean squared error compared to its minimum. This means that changes in the λ
factor and the TF abundance have a stronger effect on the mean squared error than on correlation. In a similar
way, we determined the set of parameters that minimise the mean squared error and maximise the correlation
for the rest of TFs (Giant, Hunchback and Kruppel) by analysing the data on the heatmaps in Figure A4 in
the Appendix. Table 1 lists the optimal set of parameters for all five TFs.

BCD
CAD
GT
HB
KR

N
10000
20000
1e+05
5000
20000

λ
1.25
0.25
5.00
2.00
4.00

5.29
8.82
0.96
2.93
6.70

M SE
(5.29)
(8.82)
(0.96)
(2.93)
(6.70)

0.62
0.29
0.12
0.33
0.39

ρ
(0.62)
(0.30)
(0.31)
(0.38)
(0.41)

Table 1: Set of parameters that minimises the difference between the ChIP-seq profile and the analytical model.
We also listed the values for the mean squared error (M SE) and correlation (ρ). The values in the parentheses
represent the minimum mean squared error and the maximum correlation. We considered only the sites that
have a PWM score higher than 70% of the distance between the lowest and the highest score.

3.1

DNA accessibility improves the model predictions

One of the main results of [10, 16, 17] is that DNA accessibility data improves the computational prediction
when estimating ChIP-seq profiles with PWMs. To investigate this result, we also consider DNA accessibility
3

correlation (BCD)

A

correlation (CAD)

B

5

0.178

0.178

0.178

0.178

0.178

0.178

0.179

0.181

0.184

0.193

0.207

0.233

0.292

0.352

0.409

0.454

0.459

5

−0.216

−0.216

−0.216

−0.216

−0.216

−0.216

−0.216

−0.215

−0.215

−0.215

−0.213

−0.211

−0.205

−0.196

−0.181

−0.154

−0.135

4.5

0.178

0.178

0.178

0.178

0.178

0.178

0.18

0.182

0.186

0.199

0.218

0.252

0.325

0.392

0.447

0.482

0.478

4.5

−0.216

−0.216

−0.216

−0.216

−0.216

−0.216

−0.216

−0.215

−0.215

−0.214

−0.213

−0.21

−0.201

−0.189

−0.17

−0.139

−0.12

4

0.178

0.178

0.178

0.178

0.178

0.179

0.181

0.184

0.19

0.208

0.235

0.281

0.369

0.438

0.487

0.508

0.496

4

−0.216

−0.216

−0.216

−0.216

−0.216

−0.216

−0.215

−0.215

−0.215

−0.214

−0.211

−0.207

−0.196

−0.18

−0.156

−0.119

−0.1

3.5

0.178

0.178

0.178

0.178

0.179

0.179

0.182

0.187

0.196

0.223

0.261

0.321

0.422

0.487

0.524

0.531

0.512

3.5

−0.216

−0.216

−0.216

−0.216

−0.216

−0.216

−0.215

−0.215

−0.214

−0.213

−0.21

−0.204

−0.188

−0.166

−0.136 −0.0939 −0.0767

0.178

0.178

0.178

0.179

0.181

0.185

0.192

0.206

0.245

0.298

0.373

0.478

0.532

0.556

0.552

0.529

3

−0.213

−0.213

−0.213

−0.213

−0.213

−0.213

−0.213

−0.213

−0.212

−0.209

−0.205

−0.197

−0.175

−0.146

−0.108 −0.0626 −0.0488

0.216

0.217

0.218

0.22

0.227

0.239

0.261

0.317

0.458

0.536

0.569

0.581

0.571

0.547

2.5

−0.194

−0.194

−0.194

−0.194

−0.194

−0.194

−0.193

−0.193

−0.192

−0.188

−0.18

−0.166

−0.13

−0.0904 −0.0491 −0.0145 −0.0119

0.499

0.554

0.593

0.606

0.609

0.596

0.574

2

−0.125

−0.125

−0.125

−0.125

−0.125

−0.124

−0.123

−0.121

−0.118

−0.108 −0.0909 −0.0606 −0.00589 0.0395

0.554

0.591

0.611

0.615

0.615

0.606

0.587

1.75

−0.111

−0.111

−0.111

−0.11

−0.11

−0.11

−0.108

−0.105

−0.101 −0.0863 −0.0665 −0.0333 0.0282

0.178

0.215

0.216

2

0.299

0.299

0.3

0.301

0.303

0.308

0.321

0.34

0.372

0.439

1.75

0.343

0.344

0.345

0.347

0.35

0.356

0.372

0.397

0.436

0.506

1.5

0.43

0.431

0.432

0.435

0.439

0.448

0.47

0.502

0.543

0.597

0.614

0.617

0.623

0.623

0.622

0.615

0.603

1.5

1.25

0.464

0.465

0.467

0.471

0.477

0.489

0.517

0.549

0.588

0.613

0.618

0.619

0.617

0.62

0.622

0.621

0.616

1.25

1

0.473

0.475

0.476

0.482

0.49

0.504

0.537

0.569

0.595

0.605

0.605

0.598

0.6
0.597

0.602

0.608

0.612

0.615

1

0.0118

0.0119

0.0121

0.0125

0.0123

0.0138

0.75

0.541

0.543

0.545

0.55

0.559

0.572

0.594

0.61

0.61

0.598

0.586

0.577

0.576

0.58

0.587

0.595

0.598

0.75

0.159

0.159

0.159

0.16

0.16

0.162

0.5

0.548

0.55

0.552

0.558

0.566

0.577

0.589

0.586

0.578

0.565

0.559

0.555

0.55

0.55
0.552
0.55

0.562

0.571

0.5

0.189

0.189

0.189

0.19

0.191

0.194

0.25

0.537

0.54

0.543

0.549

0.557

0.564

0.568

0.563

0.557

0.549

0.543

0.539

0.535

0.533

0.531

0.528

0.524

0.25

0.189

0.189

0.19

0.191

0.193

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

0.25

0.30.382

λ

0.2

0.35

0.45

0.4

0.55

0.5

0.0847

0.0689

0.107

0.118

0.107

−0.0791 −0.079 −0.0789 −0.0787 −0.0782 −0.0779 −0.0754 −0.0722 −0.0648 −0.0428 −0.0154 0.0276

0.0893

0.123

0.143

0.144

0.133

−0.0292 −0.0291 −0.029 −0.0286 −0.0279 −0.0265 −0.0225 −0.0159 −0.00356 0.0268

0.183

0.168

0

0.05

0.0662

0.114

0.165

0.184

0.19

0.0702

0.104

0.148

0.193

0.21

0.213

0.206

0.196

5
0.1
0.206

0.222

0.24

0.25

0.249

0.242

0.227

0.212

0.235

0.2

0.0182

0.0252

0.0384

0.10.167

0.174

0.181

0.2

0.209

0.222

0.244

0.26

0.27

0.275

0.274

0.267

0.25

0.197

0.207

0.221

0.24

0.267

0.281

0.29

0.295

0.296

0.295

0.287

0.276

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

0.25

number of bound molecules

mean squared error (BCD)

C

0.0739

0.0744

λ

3

2.5

mean squared error (CAD)

D
5

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 1.1e+01 1.5e+01

4.5

8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8e+00 7.9e+00 7.7e+00 7.4e+00 6.9e+00 7.2e+00 1e+01 2.6e+01 5.8e+01

4.5

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 1.2e+01 1.9e+01

4

8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8e+00 7.8e+00 7.5e+00 7.2e+00 6.9e+00 8.4e+00 1.4e+01 3.9e+01 7.9e+01

9

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

1e+01 1.4e+01 2.7e+01

3.

4

4.1

8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8e+00 7.8e+00 7.6e+00 7.1e+00 6.9e+00 8.1e+00 1.8e+01 4.1e+01

4.7

5

1e+01 1.3e+01 2.8e+01 5.8e+01

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 1.1e+01 1.6e+01 4.2e+01 8e+01

2

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01

1e+01 1.2e+01 1.9e+01 4.8e+01 8.6e+01

1.75

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8.1e+00 7.9e+00 7.6e+00 7.1e+00 6.3e+00 6.1e+00 7.1e+00 1.3e+01 2.4e+01 4e+01 6.6e+01 8.8e+01

1.75

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01

1e+01 1.3e+01 2.1e+01 5e+01 8.6e+01

1.5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8.1e+00 7.8e+00 7.5e+00 6.9e+00 6e+00 5.6e+00 6.6e+00 1.3e+01 2.2e+01 3.5e+01 5.5e+01 7.4e+01

1.5

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

1e+01 1.3e+01 2.3e+01 5.2e+01 8.6e+01

1.25

8.3e+00 8.3e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 7.8e+00 7.4e+00 6.8e+00 5.8e+00 5.3e+00 6.2e+00 1.2e+01 2.1e+01 3.1e+01 4.4e+01 5.7e+01

4.9

3.8

4.6

4.1

1

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.6e+00 9.4e+00 1.2e+01 2.3e+01 4.8e+01 7.2e+01

0.75

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.4e+00 9.2e+00 1.3e+01 2.3e+01 5e+01 7.1e+01

8.4e+00 8.4e+00 8.4e+00 8.4e+00 8.3e+00 8.2e+00 7.9e+00 7.5e+00 6.9e+00 6.2e+00 6.6e+00 9.1e+00 1.5e+01 2e+01 2.4e+01 2.9e+01 3.2e+01

0.5

0.25

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.2e+00 9.3e+00 1.4e+01 2.5e+01 5e+01 6.9e+01

8.5e+00 8.5e+00 8.5e+00 8.4e+00 8.3e+00 8.2e+00 7.9e+00 7.4e+00 6.8e+00 6.3e+00 7.4e+00 1e+01 1.6e+01 2.1e+01 2.5e+01 2.8e+01 3e+01

0.25

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.5e+00 8.8e+00 1.1e+01 1.8e+01 3e+01 4.9e+01 6.3e+01

4
1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

4.5

5e+05

1e+06

1

10

20

50

100

200

number of bound molecules

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

optimal parameters (BCD)

E

4.3

0.5

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 9.8e+00 9.4e+00 1.2e+01 2.1e+01 4.9e+01 7.9e+01

4

8.4e+00 8.3e+00 8.3e+00 8.3e+00 8.2e+00 8.1e+00 7.8e+00 7.4e+00 6.7e+00 5.8e+00 5.9e+00 7.8e+00 1.4e+01 2e+01 2.6e+01 3.4e+01 3.8e+01

1.25

4.8

8.3e+00 8.3e+00 8.3e+00 8.2e+00 8.2e+00 8.1e+00 7.7e+00 7.3e+00 6.7e+00 5.7e+00 5.4e+00 6.8e+00 1.3e+01 2e+01 2.8e+01 3.7e+01 4.3e+01

4.4

1

0.75

4.4

λ

λ

2

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8.1e+00 8.1e+00 7.9e+00 7.7e+00 7.3e+00 6.6e+00 6.4e+00 7.5e+00 1.4e+01 2.5e+01 4.3e+01 7.6e+01 1e+02

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

4.5

3

2.5

4.7

7e+00 9.6e+00 1.7e+01 3.3e+01 7.3e+01 1.1e+02

3.

8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8e+00 7.8e+00 7.6e+00 7.1e+00 6.9e+00 7.8e+00 1.4e+01 2.5e+01 4.6e+01 8.4e+01 1.2e+02

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 1.1e+01 1.9e+01 3.9e+01

4.2

9

3.5

4.8

8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8e+00 7.9e+00 7.8e+00 7.4e+00 7e+00

4.
3

3

2.5

8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8.1e+00 8e+00 7.9e+00 7.6e+00 7.3e+00 6.9e+00 7.6e+00 1.1e+01 2.2e+01 5.6e+01 1e+02

4.
2

3.5

optimal parameters (CAD)

F

5

5

4.5

4.5

4

4

3.5

3.5

3

3

2.5

2.5

λ

2

λ

2

1.75

1.75

1.5

1.5

1.25

1.25

1

1

0.75

0.75

0.5

0.5

0.25

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

number of bound molecules

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure 2: Quantifying the distances between Bicoid and Caudal ChIP-seq profiles and the profiles derived with
the analytical model. We plotted heatmaps for the correlation (A) and (B) and mean squared error (C) and
(D) between the analytical model and the ChIP-seq profile of Bicoid (A, C) and Caudal (B, D). We computed
these values for different sets of parameters: N ∈ [1, 106 ] and λ ∈ [0.25, 5]. We considered only the sites that
have a PWM score higher than 70% of the difference between the lowest and the highest score. (A, B) Orange
colour indicates high correlation between the analytical model and the ChIP-seq profile, while white colour
low correlation. (C, D) Blue colour indicates low mean squared error between the analytical model and the
ChIP-seq profile, while white colour high mean squared error. (E, F ) We plotted the regions where the mean
square error is in the lower 12% of the range of values (blue) and the correlation is the higher 12% of the range
of values (orange). With green rectangle we marked the optimal set of parameters in terms of mean squared
error and with a black rectangle the intersection of the parameters for which the two regions intersect.

4

regions from stage 5 D. melanogaster embryos computed with a 5% false discovery rate [24] and represented
accessible sites by a = 1 (14.5 M bp) and inaccessible sites by a = 0.
Using the same approach as in the case of all DNA being accessible, we plot the heatmaps for correlation
and mean squared error for Bicoid, Caudal, Giant, Hunchback and Kruppel and then we performed a grid search
to identify the combination of parameters that minimises the differences between the ChIP-seq profiles and the
profiles predicted by equations (1) and (A8) in the Appendix ; see Figure 3 and Figure A5 in the Appendix.
Table 2 lists the optimal set of parameters for the five TFs in the case of DNA accessibility. Again, one can
see that selecting the set of parameters that minimises the mean squared error leads to only negligible reduction
in the correlation. Our results confirm that DNA accessibility data improves the model prediction (increases
the correlation and reduces the mean squared error) and, thus, supports the finding that DNA accessibility is
a significant factor that drives the genomic occupancy of TFs; compare Table 1 to Table 2 and see Figure 4.
Overall the correlation between our model predictions and the ChIP-seq data sets is similar to the one found
in [16].

BCD
CAD
GT
HB
KR

N
2000
10000
1000
2000
20000

λ
1.25
1.25
1.00
3.00
5.00

4.40
5.03
0.85
2.38
4.77

M SE
(4.40)
(5.03)
(0.85)
(2.38)
(4.77)

0.77
0.73
0.55
0.66
0.68

ρ
(0.77)
(0.75)
(0.57)
(0.66)
(0.69)

Table 2: Set of parameters that minimises the difference between the ChIP-seq profile and the analytical model
which includes DNA accessibility. The accessibility of any site can be either 0 or 1 depending on whether the
site is accessible or not. We also listed the values for the mean squared error (M SE) and correlation (ρ).
The values in the parentheses represent the minimum mean squared error and the maximum correlation. We
considered only the sites that have a PWM score higher than 70% of the distance between the lowest and the
highest score.
Interestingly, Figure 3 (E) and (F ) show that there is a high correlation between our model and the
ChIP-seq data for a wide range of values for the number of DNA bound molecules (orange area). However,
the range of values of λ that result in high correlation is much smaller. In contrast, the mean squared error
is reduced only for a small interval of TF abundances, but it is optimal for a wide range of values for λ (blue
area). This result suggests that the correlation between the model and the ChIP-seq profile cannot be used to
estimate TF abundance (as previously done), but can accurately estimate the range of values for λ. In contrast,
the mean squared error can be used to estimate the number of bound molecules, but cannot be used to estimate
the λ factor. Thus, to get a better estimate for both the number of DNA bound molecules and λ one needs to
consider both correlation and mean squared error and identify the range of parameters where both measures
are optimal.
It is also worthwhile noting that, for all TFs, the number of bound molecules that best fit the data is in
the range of thousands of molecules bound to the genome (and is on average five times lower than the case of
naked DNA). In addition, we identified that, for Hunchback and Kruppel, the values of λ that optimises the
analytical model are significantly higher than 1, which means that although the motifs of these two TFs have
high information content (see Figure 1), the two TFs have low specificity and cannot distinguish well between
different DNA words [22]. In contrast, we found that Bicoid, Caudal and Giant display values of λ around 1,
which indicates that the specificities of these TFs are equal to their information content, as defined by Stormo
and Zhao [22].

3.2

Additional factors that influence the binding profiles

Despite the generally accurate predictions of the model, there are locations on the genome where the model
fails to predict the ChIP-seq profile. In the Appendix, we plotted the estimates of the binding profiles at all
twenty-one loci using the optimal set of parameters (from Table 2); see Figures A6, A7, A8, A9 and A10. Next,
we systematically investigated several assumptions in our model that could account for the differences between
the ChIP-seq data set and the model predicted profiles.
3.2.1

Range of PWM scores included in the model

For our analysis we only considered predicted binding sites that display a PWM score which is higher than 70%
of the difference between the strongest and the weakest site (∀j, where wj ≥ 0.7 × [maxi (wi ) − mini (wi )]). To
5

correlation (BCD)

A

correlation (CAD)

B

5

0.509

0.509

0.509

0.51

0.51

0.511

0.515

0.52

0.53

0.554

0.582

0.614

0.645

0.652

0.645

0.618

0.592

5

0.581

0.581

0.581

0.581

0.581

0.581

0.582

0.583

0.585

0.59

0.598

0.61

0.63

0.643

0.648

0.642

0.631

4.5

0.509

0.509

0.509

0.51

0.511

0.512

0.517

0.524

0.538

0.569

0.603

0.637

0.665

0.667

0.654

0.622

0.594

4.5

0.581

0.581

0.581

0.581

0.581

0.581

0.582

0.584

0.586

0.594

0.604

0.619

0.641

0.653

0.656

0.647

0.634

4

0.509

0.509

0.509

0.51

0.511

0.514

0.521

0.531

0.55

0.59

0.629

0.663

0.685

0.682

0.664

0.628

0.598

4

0.581

0.581

0.581

0.581

0.581

0.581

0.583

0.585

0.589

0.599

0.612

0.63

0.655

0.665

0.666

0.653

0.637

3.5

0.509

0.509

0.51

0.511

0.513

0.516

0.526

0.542

0.567

0.618

0.66

0.692

0.706

0.697

0.675

0.636

0.604

3.5

0.581

0.581

0.581

0.581

0.581

0.582

0.584

0.587

0.592

0.606

0.624

0.645

0.67

0.678

0.675

0.659

0.641

3

0.509

0.51

0.51

0.512

0.515

0.52

0.535

0.557

0.592

0.652

0.693

0.719

0.725

0.712

0.689

0.649

3

0.581

0.581

0.581

0.581

0.582

0.582

0.585

0.589

0.597

0.617

0.639

0.663

0.686

0.692

0.686

0.667

0.649

2.5

0.508

0.509

0.51

0.513

0.517

0.525

0.548

0.579

0.624

0.686

0.722

0.741

0.742

0.73

0.708

5
0.6

0.617

0.671

0.639

2.5

0.58

0.581

0.581

0.581

0.582

0.583

0.587

0.593

0.605

0.631

0.657

0.682

0.702

0.705

0.699

0.68

0.661

2

0.552

0.554
0.55

0.555

0.561

0.57

0.587

0.623

0.663

0.7

0.739

0.756

0.761

0.759

0.748

0.732

0.704

0.677

2

0.593

0.593

0.593

0.594

0.596

0.598

0.607

0.62

0.637

0.669

0.694

0.71

0.717

0.718

0.714

0.7

0.683

1.75

0.581

0.584

0.587

0.598

0.61

0.632

0.674

0.711

0.74

0.762

0.768

0.771

0.771

0.762

0.746

0.722

0.701

1.75

0.622

0.622

0.622

0.624

0.626

0.63

0.642

0.656

0.678

0.707

0.72

0.725

0.727

0.726

0.723

0.711

0.697

1.5

0.621

0.626

0.631

0.644

0.66

0.686

0.722

0.747

0.762

0.769

0.772

0.774

0.773

0.768

0.76

0.743

0.727

1.5

0.634

0.634

0.635

0.637

0.639

0.645

0.66

0.678

0.7

0.726

0.73

0.728

0.727

0.729

0.731

0.727

0.716

1.25

0.677

0.682

0.689

0.705

0.723

0.743

0.76

0.766

0.767

0.767

0.767

0.767

0.77

0.769

0.767

0.757

0.746

1.25

0.661

0.661

0.662

0.665

0.67

0.679

0.696

0.713

0.726

0.732

0.727

0.72

0.716

0.717

0.723

0.731

0.731

1

0.71

0.718

0.726

0.743

0.759

0.772

0.774

0.768

0.759

0.75

0.75
0.75

0.751

0.753

0.758

0.762

0.763

0.758

1

0.697

0.699

0.7

0.702

0.707

0.714

0.728

0.736

0.735

0.725

0.714

0.706

0.701

0.702

0.705

0.717

0.725

0.75

0.73

0.737

0.743

0.755

0.761

0.762

0.752

0.74

0.73

0.722

0.723

0.727

0.733

0.734

0.737

0.742

0.749

0.75

0.723

0.724

0.725

0.728

0.732

0.737

0.745

0.743

0.735

0.718

0.706

0.696

0.686

0.68

0.678

0.684

0.695

0.5

0.727

0.733

0.736

0.74

0.741

0.734

0.719

0.708

0.702

0.696

0.695

0.695

0.702

0.71

0.716

0.719

0.719

0.5

0.66

0.662

0.664

0.669

0.675

0.683

0.691

0.693

0.693

0.69

0.69

0.687

0.68

0.674

0.671

0.667

0.666

0.25

0.684

0.687

0.687

0.684

0.678

0.67

0.66

0.656

0.656

0.659

0.661

0.663

0.663

0.662

0.66

0.659

0.663

0.25

0.653

0.656

0.659

0.667

0.674

0.681

0.684

0.681

0.679

0.679

0.683

0.686

0.687

0.683

0.678

0.67

0.664

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

0.7

0.6

λ

0.7

λ

0.65

0.6

0.65

number of bound molecules

7

number of bound molecules

mean squared error (BCD)

C

0.7

0.

mean squared error (CAD)

D
5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.2e+00 7.2e+00 6.2e+00 8.7e+00 2.4e+01 4.5e+01

4.5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.9e+00 7.5e+00 6.7e+00 5.9e+00 5.3e+00 7.7e+00 1.6e+01 3.3e+01 6.6e+01 9.1e+01

4.5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.8e+00 8.5e+00 6.5e+00 6.5e+00 1.2e+01 3.2e+01 5.3e+01

4

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 7.9e+00 7.7e+00 7.2e+00 6.2e+00 5.4e+00 5.5e+00 1.1e+01 2.3e+01 4.2e+01 7.4e+01 9.7e+01

4

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.2e+00 7.7e+00 6e+00 7.9e+00 1.7e+01 4.1e+01 6.2e+01

3.5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.7e+00 8.3e+00 6.7e+00 6.3e+00 1.1e+01 2.4e+01 4.9e+01 6.9e+01

1.5

8.3e+00 8.2e+00 8.2e+00 8e+00 7.7e+00 7.2e+00 6.2e+00 5.3e+00 4.4e+00 5.1e+00 8e+00 1.3e+01 2.1e+01 2.8e+01 3.6e+01 4.4e+01 5e+01

1.25

8.3e+00 8.3e+00 8.2e+00 8e+00 7.7e+00 7.2e+00 6.2e+00 5.2e+00 4.4e+00 5.2e+00 7.8e+00 1.2e+01 1.7e+01 2.3e+01 2.9e+01 3.6e+01 4e+01

2

4.1

4.7

3.
8

8e+00 1.6e+01 3.2e+01 5.7e+01 7.4e+01

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.7e+00 7.9e+00 6.3e+00 5.9e+00 1.2e+01 2.3e+01 3.9e+01 6e+01 7.4e+01

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

9e+00 6.9e+00 5.5e+00 6.7e+00 1.6e+01 2.8e+01 4.2e+01 5.9e+01 6.9e+01

λ
8.2e+00 8.2e+00 8.2e+00 8e+00 7.8e+00 7.4e+00 6.4e+00 5.5e+00 4.7e+00 5.2e+00 8.2e+00 1.3e+01 2.4e+01 3.4e+01 4.3e+01 5.3e+01 6.2e+01

λ

8.2e+00 8.2e+00 8.2e+00 8e+00 7.8e+00 7.5e+00 6.7e+00 5.8e+00 5.1e+00 5.5e+00 8.3e+00 1.4e+01 2.7e+01 3.8e+01 4.7e+01 6.1e+01 7.3e+01

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.9e+00 7.3e+00 6e+00

4.8

2

1.75

2.5

4.2

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7.1e+00 6.4e+00 5.6e+00 5.4e+00 7.2e+00 1.2e+01 2.6e+01 4e+01 5.3e+01 7.3e+01 9e+01

3.9

4.6

4.1

3.

8

3.9

3

4.8

2.5

5e+01 7.9e+01 1e+02

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8.1e+00 7.9e+00 7.5e+00 7e+00 6.2e+00 5.3e+00 5.7e+00 9e+00 2.2e+01 3.7e+01 5.4e+01 8e+01 9.8e+01

3.
9

3

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.4e+00 6.8e+00 5.7e+00 5.2e+00 6.6e+00 1.6e+01 3e+01

3.8

3.5

4.4

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7.1e+00 6.4e+00 5.6e+00 6.1e+00 1.1e+01 2.5e+01 5.6e+01 8.4e+01

4.9

5

4.

4.7

1.5

5

4.
3

1.25

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.9e+00 8.6e+00 6.3e+00 5.2e+00 6.7e+00 1.6e+01 2.7e+01 4e+01 5.5e+01 6.6e+01

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.7e+00 8.3e+00 6e+00

4.

4.3

3.7

1.75

5e+00 6.7e+00 1.5e+01 2.4e+01 3.4e+01 4.7e+01 5.7e+01

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.4e+00 8e+00 5.8e+00 5e+00

6

7e+00 1.5e+01 2.2e+01 2.9e+01 3.8e+01 4.4e+01

1

8.3e+00 8.3e+00 8.2e+00 8e+00 7.6e+00 7.1e+00 6.1e+00 5.2e+00 4.6e+00 5.7e+00 8e+00 1.1e+01 1.6e+01 1.9e+01 2.2e+01 2.8e+01 3.2e+01

1

1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.5e+00 8e+00 5.8e+00 5.2e+00 7.5e+00 1.5e+01 2.2e+01 2.7e+01 3.3e+01 3.7e+01

0.75

8.4e+00 8.3e+00 8.2e+00 8e+00 7.7e+00 7.3e+00 6.3e+00 5.4e+00 5.1e+00 6.5e+00 8.6e+00 1.1e+01 1.4e+01 1.6e+01 1.8e+01 2.1e+01 2.3e+01

0.75

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.3e+00 7.8e+00 5.6e+00 5.4e+00 8.3e+00 1.6e+01 2.2e+01 2.6e+01 2.9e+01 3.1e+01

0.5

8.4e+00 8.4e+00 8.3e+00 8.1e+00 7.8e+00 7.3e+00 6.4e+00 5.8e+00 5.8e+00 7.6e+00 9.6e+00 1.2e+01 1.3e+01 1.4e+01 1.6e+01 1.7e+01 1.9e+01

0.5

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1e+01 9.3e+00 7.6e+00 5.6e+00 6.1e+00 9.5e+00 1.7e+01 2.2e+01 2.6e+01 2.9e+01 3e+01

0.25

8.5e+00 8.4e+00 8.3e+00 8.1e+00 7.8e+00 7.3e+00 6.4e+00 6.1e+00 6.6e+00 8.6e+00 1e+01 1.2e+01 1.4e+01 1.5e+01 1.5e+01 1.6e+01 1.6e+01

0.25

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 9.9e+00 8.6e+00 6.9e+00 5.7e+00 7e+00 1.1e+01 1.8e+01 2.2e+01 2.5e+01 2.8e+01 3e+01

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

4

4.2

1e+06

1

10

20

50

100

200

number of bound molecules

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

optimal parameters (BCD)

E

3.9

4

8

3.

4.5

4

4.4

optimal parameters (CAD)

F

5

5

4.5

4.5

4

4

3.5

3.5

3

3

2.5

2.5

λ

2

λ

2

1.75

1.75

1.5

1.5

1.25

1.25

1

1

0.75

0.75

0.5

0.5

0.25

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

number of bound molecules

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure 3: Quantifying the distances between Bicoid and Caudal ChIP-seq profiles and the profiles derived with
the analytical model which includes DNA accessibility data. This is the same as Figure 2, except that we included
binary DNA accessibility data in the analytical model.

6

BCD (10000 molecules) @ eve locus

BCD (2000 molecules) @ eve locus
chr2R

correlation = 0.82; mean squared error = 5.3

occupancy

correlation = 0.73; mean squared error = 6.23

occupancy

chr2R

eve

+

TER94

eve

+

−

TER94

−

5865000

5870000

5875000

5865000

5870000

DNA position

5875000

DNA position

CAD (20000 molecules) @ eve locus

CAD (10000 molecules) @ eve locus
chr2R

correlation = 0.69; mean squared error = 5.9

occupancy

correlation = 0.44; mean squared error = 9.69

occupancy

chr2R

eve

+

TER94

eve

+

−

TER94

−

5865000

5870000

5875000

5865000

5870000

DNA position

5875000

DNA position

GT (1e+05 molecules) @ eve locus

GT (1000 molecules) @ eve locus
chr2R

correlation = 0.49; mean squared error = 1.63

occupancy

correlation = 0.37; mean squared error = 2.04

occupancy

chr2R

eve

+

TER94

eve

+

−

TER94

−

5865000

5870000

5875000

5865000

5870000

DNA position

DNA position

HB (5000 molecules) @ eve locus

HB (2000 molecules) @ eve locus
chr2R

correlation = 0.8; mean squared error = 0.957

occupancy

correlation = 0.61; mean squared error = 0.731

occupancy

chr2R

5875000

eve

+

TER94

eve

+

−

TER94

−

5865000

5870000

5875000

5865000

5870000

DNA position

DNA position

KR (20000 molecules) @ eve locus

KR (20000 molecules) @ eve locus
chr2R

correlation = 0.47; mean squared error = 8.52

occupancy

correlation = 0.41; mean squared error = 8.89

occupancy

chr2R

5875000

eve

+

TER94

eve

+

−

TER94

−

5865000

5870000

5875000

5865000

DNA position

5870000

5875000

DNA position

Figure 4: Binding profiles at eve locus. The grey shading
1 represents a ChIP-seq profile, the red line represents
the prediction of the analytical model, the yellow shading represents the inaccessible DNA and the vertical blue
lines represent the percentage of occupancy of the site (we only displayed sites with an occupancy higher than
5%). We plotted the profiles for the five TFs: (i) Bicoid, (ii) Caudal, (iii) Giant, (iv) Hunchback and (v)
Kruppel. (Left) The analytical model assumed a naked DNA (the entire genome is accessible) and used the set
of parameters listed in Table 1. (Right) The analytical model included DNA accessibility data from [16, 24]
and used the set of parameters listed in Table 2.

7

understand why we discard non-specific sites, it is important to remember that conventional ChIP experiments
display a population average over millions of cells/nuclei. While specific sites will be occupied in the majority of
the cells (nuclei), a particular non-specific site will be occupied in a few cells, because there are many similar low
affinity sites in the genome [38]. This means that ChIP data reflects binding at the specific sites, and that low
affinity sites can be discarded. To test whether our threshold selection affected the results, we also considered
the case of a lower threshold of 30%.
We found that weaker binding sites do not affect our model estimate for the profile for TFs that have
low values of λ (Bicoid, Caudal and Giant); see Table A4 and Figure A11 in the Appendix. However, for
TFs with higher values of λ (Hunchback and Kruppel), weaker binding sites affect the binding profiles, but
leading only to a negligible reduction in the quality of the profile generated by our model; see Figure A12 in
the Appendix. Including lower affinity binding into our model also leads to a similar set of parameters (TF
abundance and λ) that optimises the fit for four TFs (Bicoid, Caudal, Giant and Hunchback), thus, indicating
that our estimates are robust. For Kruppel, when including lower affinity binding sites, our method estimates
a lower TF abundance and λ. However, λ remains significantly higher than 1 and the quality of the fit are
slightly worse that in the case of including only sites that have a PWM score higher than 70% of the difference
between the lowest and the highest score; see Table A4 in the Appendix.
3.2.2

DNA accessibility data

Some DNA loci are marked as being ‘inaccessible’ in the DNA accessibility data, but, at the same time, display
binding of TFs in ChIP experiments; see Figures A6-A10 in the Appendix. This suggests that regions with
an intermediary level of DNA accessibility could have been marked as inaccessible despite allowing binding of
TFs. To investigate this aspect, we also considered the case of different levels of DNA accessibility (the data is
represented by continuous values between 0 and 1) and we converted the read density in probability of a site
being accessible by using the approach described in [16]; see equation (A9) in the Appendix. We found that,
when using non-binary accessibility data, the difference between the predictions of our model and the ChIP-seq
data are similar to the case of using binary DNA accessibility data; see Table A5 and Figures A13 and A14 in
the Appendix.
3.2.3

PWMs

Finally, we investigated whether the choice of PWMs affected our results by performing the analysis using
alternative PWMs from the JASPAR database [39]; see Figure A15 in the Appendix. One should note that,
while the motifs of Bicoid and Caudal are similar in both BDTNP [16] and JASPAR [39], the motif for Giant
has a higher information content and the motifs for Hunchback and Kruppel have a lower information content in
JASPAR [39] compared to BDTNP [16]. Our results show that, by using a different set of PWMs, we obtained
slightly worse values for correlation and mean squared error compared to the case of using the PWMs from
BDTNP [16]; see Figures A16 and A17 and Table A6 in the Appendix. It remains to be investigated if this
could be a generalized approach to determine the quality of PWMs from different sources.
Interestingly, we found that the values of λ that optimise the model for Giant,Hunchback and Kruppel
differ significantly between the case of the PWMs from BDTNP [16] and the PWMs from JASPAR [39]. This
suggests that independent of the actual PWMs, the three TFs display similar specificity. Since three TFs have
different PWMs, we also investigated the binding profiles at the twenty one loci and we found that, in certain
cases, the use of the PWMs from the JASPAR database leads to differences in the predicted profile; see Figures
A18, A19 and A20 in the Appendix. For example, for Kruppel, we observed a slightly better estimation of the
binding profile at D, H, Kr, cad, ftz, gt, hkb, os and slp loci and a slightly worse estimate of the profile at cnc,
croc, kni, opa, prd, run and tll loci compared to the case when the PWMs from BDTNP [16] was used; compare
Figure A10 to Figure A20 in the Appendix.

3.3

Genome-wide analysis of TF binding

One advantage of our analytical model is that it can be used to predict the binding profiles genome-wide and,
thus, we extended the analysis from the original twenty one loci to the entire genome. We partitioned the
genome in 20 Kbp regions, from which we removed regions that did not have any accessible site. For each
ChIP-seq profile, we then selected the regions that display a ChIP-seq signal higher than the genome-wide
background. We found that the quality of our model’s predictions vary widely; see Figure 5 (A) and (B). In
particular, there are regions where the correlation between our model predictions and the ChIP-seq profile is
high, but at the same time regions where this correlation is low.
8

correlation (1)

mean squared error (1)

B
●
●

●
●

2.0

0.0

0.5

10.0

1.0

A

0.1

−1.0

−0.5

0.5

●

BCD

CAD

GT

HB

KR

BCD

correlation (0.5)
10.0

HB

KR

●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●

●

CAD

GT

●

●
●
●
●

0.0

2.0

0.5

GT

mean squared error (0.5)

D

1.0

C

CAD

0.5
0.1

−1.0

−0.5

●
●
●

BCD

CAD

GT

HB

KR

BCD

HB

KR

Figure 5: Genome-wide quality of the fit. The boxplots represent the (A, C) correlation and (B, D) mean squared
error between the ChIP-seq data sets and the analytically estimated profiles. We partitioned the genome in
20 Kbp regions and we kept only the regions that had at least one DNA accessible site (4599 regions). Next for
each ChIP-seq data set we selected the regions where the mean ChIP-seq signal is higher than a proportion of
the background (see Table A7 in the Appendix ). In (A, B), we selected the regions with a mean ChIP-seq signal
higher than the background (> B). In (C, D), we selected the regions with a mean ChIP-seq signal higher than
half the background (> 0.5 · B). The numbers of DNA regions that display a mean ChIP-seq signal higher than
the thresholds are listed in Table A8 in the Appendix. In all subgraphs we used the set of parameters from
Table 2.
Kaplan et al. [16] found that, at loci with low binding (low ChIP-seq signal), the correlation between the
statistical thermodynamics model and the ChIP-seq profile was low. To test whether this is valid genome-wide,
we also analysed regions where the mean signal is higher than half of the genome-wide background (leading in an
increase in the number of investigated loci). Our results confirm that there is a decrease in the mean correlation
when including regions with lower ChIP-seq signal; see Figure 5 (C). We also perform a Kolmogorov-Smirnov
test that showed that in the case of Bicoid and Caudal this difference is statistically significant; see Figure A21
in the Appendix. This also means that, at least for regions with strong binding, the model predictions are highly
correlated with the ChIP-seq profile as previously found [16]; see Figure 5. Nevertheless, for regions with low
binding, in addition to the reduction in the correlation we also observed a decrease in the mean squared error,
which is statistically significant in the case of Bicoid, Caudal and Kruppel; see Figure A21 in the Appendix.
Note that for Giant and Hunchback the difference is not statistically significant due to the small number of
loci included in the analysis; see Table A8 in the Appendix. This indicates that our model is able to correctly
capture the low signal in those regions, but there is little or no correlation to the actual ChIP-seq signal. One
explanation for this result is that, in those regions, there is little or no binding and what the ChIP-seq method
recovers might be considered technical noise.

3.4

Nucleus specific binding predictions

Using our model we can investigate the binding profiles at various locations for which ChIP-seq data is not
available. While the ChIP-seq profiles were generated for the entire embryo (and, thus, we are assuming average
TF abundance over the pool of cells in an embryo), there is still no indication how these profiles look at specific
locations along the anterior-posterior axis of the animal. This is important because, along the embryonic axis,
the TF abundance can vary significantly, see [16, 40–46]. First, we generated the Bicoid binding profile in nuclei
that are positioned at 40% of egg-length along the A-P axis from the anterior pole (stripe 2) by assuming that
there are 2000 molecules of Bicoid in this region. In particular, we approximated at 40% of egg-length along the
A-P axis the number of specifically bound molecules is similar to the one computed for the embryo-wide ChIPseq. Figure 6 shows how this binding profile looks and confirms that Bicoid binds to the eve stripe 2 enhancer
(chr2R:5865267-5865750), as opposed to the case of the posterior pole (with much lower concentration), where
Bicoid does not bind to this enhancer. Note that we approximated that, at the posterior pole, the amount of
Bicoid is ten times lower than at the eve stripe 2 enhancer [41].
9

BCD (10000 molecules) @ eve locus
correlation = 0.83; mean squared error = 4.7

occupancy

chr2R

eve

+
−

eve stripe 3 + 7

TER94

eve stripe 2

eve stripe 4 + 6

5865000

5870000

eve stripe 1 eve stripe 5

5875000

DNA position

BCD (2000 molecules) @ eve locus
correlation = 0.82; mean squared error = 5.3

occupancy

chr2R

eve

+
−

eve stripe 3 + 7

TER94

eve stripe 2

eve stripe 4 + 6

5865000

5870000

eve stripe 1 eve stripe 5

5875000

DNA position

BCD (200 molecules) @ eve locus
correlation = 0.82; mean squared error = 12.8

occupancy

chr2R

eve

+
−

eve stripe 3 + 7

TER94

eve stripe 2

eve stripe 4 + 6

5865000

5870000

eve stripe 1 eve stripe 5

5875000

DNA position

1

Figure 6: Bicoid binding profile at eve locus for various abundances. The grey shading represents the embryowide ChIP-seq profile of Bicoid, the red line represents the prediction of the analytical model, the yellow shading
represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we
only displayed sites with an occupancy higher than 5%). We consider three cases (i) NBCD = 10000 molecules
(anterior pole), (ii) NBCD = 2000 molecules (stripe 2 region) and (iii) NBCD = 200 molecules (posterior pole).
We also assume a factor λBCD = 1.25. The magenta rectangles mark the enhancers for the stripe formation;
from left to right these are: (i) eve stripe 3+7, (ii) eve stripe 2, (iii) eve stripe 4+6, (iv) eve stripe 1 and (v)
eve stripe 5.

Next, we generated the Bicoid binding profiles at the anterior region of the embryo assuming that, in this
region, the number of specifically bound Bicoid molecules is approximately five times higher than at the eve
stripe 2 enhancer ([41] approximated that at the anterior pole there are approximately four times more Bicoid
molecules than at the eve stripe 2 enhancer). Figure 6 shows that, at the anterior pole, there is significantly
more binding of Bicoid to the eve stripe 2 enhancer, which raises the question of why there is no eve expression
in that region. Initially, it was assumed that Bicoid acts only as an activator for the eve stripe 2 enhancer
[40, 47]. However, a recent study [12] proposed that Bicoid has a dual role as both activator and repressor and
this is controlled by its abundance, i.e., for low and medium abundances Bicoid activates eve, while for high
abundance it will repress it. Our results support (without providing a mechanistic explanation) that Bicoid
cannot be an activator for eve at high abundances, because this would mean that eve should be expressed at
the anterior regions of the embryo, which contradicts the experimental observations [40, 47] (assuming that
expression equals occupancy).

4

Discussion

Gene regulation plays a significant role in cellular response to developmental, physiological or environmental
signals. To better understand these processes, there is a need to move from genetic interaction models of
gene regulation to more fine-grained models that include the regulatory sequence [48]. In this manuscript, we
proposed an analytical model that is able to compute genome-wide binding profiles of TFs, as opposed to more
detailed computational models for the statistical thermodynamics framework that are limited to smaller DNA
loci. Our model recapitulates the main driving forces in determining the genome-wide occupancy of a TF,
namely: (i) the PWM, (ii) DNA accessibility, (iii) the number of TF molecules that are bound to the DNA
and (iv) the specificity of the TF (how well it discriminates between “good” and “bad” sequences) through the
λ factor [21]. Frequently, we have data for the first two and we aim to determine the last two by fitting the
profile predicted by the model to the profile generated experimentally (through ChIP-seq) [8, 10, 14, 16, 17].
10

4.1

Abundance of bound TF

Previous studies quantified the accuracy of predictions by determining the set of parameters (usually the number
of TF molecules that are bound to the genome) that maximises the correlation between the computationally
and the experimentally generated profiles [10, 17]. Here, we considered the ChIP-seq dataset for five TFs in the
D. melanogaster embryo during early development and computed the Pearson correlation coefficient between
the analytical and the experimental profiles. In addition, we also computed the mean squared error between the
computational and the ChIP-seq profiles. Our results confirm that DNA accessibility improves the predictions
of the model [10, 16, 17] and show that the set of parameters that maximise the correlation also leads to high
mean squared errors, while the set of parameters that minimises the mean squared errors leads to only a small
decrease in the correlation (compared to the maximum). Furthermore, it seems that the correlation is less
sensitive to changes in the TF abundance, but highly sensitive for changes in λ; e.g. the orange regions in
Figure 3(E, F ) are stretched horizontally. In contrast, the mean squared error is highly sensitive to changes
in the number of TF molecules, but less sensitive to changes in λ; e.g. the blue regions in Figure 3(E, F ) are
stretched vertically. Together, this suggests that correlation could be used to estimate the λ factor and mean
squared error to infer the amount of bound TF. Thus, our results indicate that when aiming to maximise the
correlation, previous studies [8, 10, 14, 16, 17] potentially overestimated the number of TF molecules that are
bound to the DNA.
For example, some work suggests the of the number of Bicoid molecules in the early fly embryo to be
around 1.5 × 108 molecules [44]. Bicoid displays a gradient along the anterior-posterior axis of the embryo
with most of the TF located in the anterior pole. Assuming that the ChIP-seq signal mainly comes from the
nuclei with high abundance, that ≈ 30% of the nuclei display high Bicoid abundance and that there are 6000
nuclei in the blastoderm embryo [43], one can compute the average number of Bicoid molecules per nucleus to be
≈ 80000. Some of the molecules will be localized to the nucleus while others will diffuse in the cytoplasm. Gregor
et al. [49] estimated that only 40% of Bicoid is nuclear, which means that the nuclear abundance of Bicoid is
≈ 30000 molecules. In a subsequent study, the same group as in [44] proposed a slightly lower abundance of
Bicoid in the D. melanogaster embryo, namely 4.5 × 107 molecules [46]. Following the same logic, we computed
that there are 10000 molecules of Bicoid per nucleus and this indicates that the Bicoid nuclear abundance can
be estimated to be between 10000 − 30000 molecules. In accordance with these estimates, Abu-Arish et al.
[42] estimated the Bicoid nuclear abundance as 140 nM , which is equivalent to 12000 molecules per nucleus
when using the estimate of nuclear volume from [41]. There is a significant difference between the number of
molecules that our model predicts (≈ 1000 − 5000 for all cases when DNA accessibility was included) and the
number o molecules estimated in these experimental studies (10000 − 30000). However, our model estimates
the number of molecules that are actually bound to the DNA, while other previous studies of [42, 44, 46] are
based on the entire nuclear abundance of Bicoid.
Furthermore, TFs can bind specifically to high affinity site, but also non-specifically anywhere on the
genome where they potentially perform one-dimensional sliding on the DNA [25, 26, 32, 33, 50, 51]. Nevertheless,
experimental studies have shown that ChIP only recovers specific binding of the TF to the DNA [52–55]. ChIP
is a population average measurement, which means that what it reports is the proportion of cells in which a
specific locus was bound. Due to their high affinity, specific sites will be occupied in the majority of the cells
(nuclei). In contrast, individual non-specific sites will be occupied in a few cells, because there are many more
similar low affinity sites in the genome [38]. Thus, ChIP data describes binding at the specific sites and this
means that, when we estimate the number of bound TF molecules, in fact we estimate the number of specifically
bound TF molecules.
In Table A9 and Figure A22 in the Appendix, we summarised the results of a series of studies (note that this
is not an exhaustive list) of the estimated percentage of specifically bound TFs [51, 56–62]. These studies were
performed in different mammalian cell lines (HeLa, 3134, H1299, MCF-7, U87, ES, NIH 3T3), using different
techniques (Fluorescence Recovery After Photobleaching -FRAP, Fluorescence Correlation Spectroscopy - FCS,
Single Molecule Tracking - SMT and Reflected Light-Sheet Microscope - RLSM) and in different conditions.
The results indicate that the percentage of specifically bound TF ranges between 2.5% and 99.7% with a median
of ≈ 20%.
In the case of Bicoid, if only 20% of the TF is specifically bound and there are between 10000 − 30000
molecules in the nucleus, then the amount of specifically bound TF is between 2000 − 6000 molecules. These
values are similar to the values that we calculate (≈ 1000 − 5000 molecules) assuming different models for
Bicoid (binary and continuous DNA accessibility data, including weak binding sites or using a different PWM).
Furthermore, in [63], the authors proposed a lower limit for the nuclear abundance of the five TFs by analysing
the FlyEx database [64]. Their values are much lower than what we estimate in the case of Bicoid. This can be
explained as the authors in [63] removed the highest 10% measurements when computing the averages. However,
the nuclear abundances proposed in [63] can be used to estimate the abundance in the nucleus for Caudal, Giant,
Hunchback and Kruppel relative to Bicoid. We used this strategy to estimate the nuclear abundance of these
11

four TFs (measured in number of molecules) and then we estimated the percentage of specifically bound TFs
(based on the estimations of our analytical model and the nuclear abundance of TFs); see Table A10 in the
Appendix. Our method supports an extensive body of literature that only a relatively small percentage (30%
or less) of the molecules of TFs are bound specifically to the genome.
Previous studies suggested that the TF abundance in eukaryotic systems can be high; e.g. [65] estimated
that there are between 104 and 3 × 105 molecules per TF, while the same author later estimated that the
median of TFs abundances in a mouse NIH 3T3 cell line is 7.1 × 104 molecules [66]. A different group estimated
that there are between 250 and 3 × 105 molecules for each TF in mouse 3T3-L1 cells. Assuming that less than
30% of these TF molecules are bound specifically to the genome, we estimate that the median number of TF
molecules that are specifically bound is less than 21, 000 molecules.
Since only specifically bound TFs seem to influence the transcription process [62], it is more important
to know the exact amount of specifically bound TF, rather than the entire concentration in the nucleus [7–
9, 67]. Thus, the range of parameters found by our study will have a higher impact for further studies that
model these biological systems, compared to other work that estimates the nuclear concentration of TFs. It
worthwhile mentioning that the estimate for proportion of non-specifically bound TF is in the same range with
the proportion of specifically bound TFs [38, 60], which suggests that the amount of TF bound to the genome
would be in similar ranges (2000 − 40000 molecules).
It is worthwhile noting that the accuracy of our method to estimate TF abundance is limited by the
ChIP methodology to fully recover the quantitative aspects of TF binding. For example, the in silico ChIP-seq
profiles of lacI in [11] seem to be similar for lacI abundances between 1 and 1000 molecules, which suggests that
our method will not be able to correctly estimate abundances lower than 1000 molecules. Thus, our method
will perform best for cases where differences in TF abundance leads to strong differences in the ChIP profiles.

4.2

The specificity of TFs

Our model also predicted that TFs can display higher or lower specificity beyond the information content of
the binding motif, through the coefficient that modulates the discrimination energy between strong and week
binding sites (λ). Our results show that the difference between the binding energy of strong and weak sites is high
for Bicoid and Caudal and low for Giant, Hunchback and Kruppel. It is worthwhile noting that considering only
the information content, a naı̈ve assumption would be that Hunchback and Kruppel have the highest specificity,
but, when including the λ scaling factor, these two TFs display the lowest specificity.
In this context, one might ask if TF with low λ cannot distinguish well between different DNA words,
where does the high information content of their motif come from? One hypothesis is that the methods used to
determine TF specificity can potentially display technical biases. In fact, two different in vitro methods, SELEX
[16] and bacterial one hybrid [39], lead to different PWM motifs for three of the TFs (Giant, Hunchback and
Kruppel). When the motifs display higher information content (Giant in JASPAR and Hunchback and Kruppel
in BDTNP), our method estimates a higher λ, which leads to lower specificities of the TFs. When the TFs
display lower information content (Giant in BDTNP and Hunchback and Kruppel in JASPAR), our method
estimates lower values for λ, which is consistent with the intuition that low information contents of the motifs
will lead to low specificities. For the TFs that display similar PWM motifs in both sources (Bicoid and Caudal),
we always estimate similar values for λ, which indicates that the specificity of the two TFs is given by the
information content of the motifs.
Nevertheless, Figures A9 and A10 in the Appendix show that the ChIP-seq profiles of Hunchback and
Kruppel display some sharp peaks, which suggest that these two TFs display higher specificity than predicted
by our approach. This contradicts our findings and one explanation for the few narrow ChIP-seq peaks is that
these two TFs bind cooperatively to the genome. In this scenario, in the few narrow peaks for Hunchback and
Kruppel, these TFs co-localise with co-factor(s) and previous studies identified that this is the case for both
TFs; e.g. [17]. This means that, by using our model, one could potentially underestimate the number of peaks
in the binding profile.
Finally, we obtained the highest correlation and lowest mean squared error between the ChIP-seq profile
and our estimate for the TFs that display the highest specificity (Bicoid and Caudal). Thus, our model
performs best in the case of TFs that can discriminate better between strong and weak binding sites. Note
that we observed the same result also when investigating the binding profiles genome-wide; see Figure 5. This
reduction in the accuracy of our model for regions with weak binding is not a direct consequence of our model
being an analytical approximation of the full statistical thermodynamics model, because even exact solutions to
the full model display reduced accuracy for regions where TFs do not bind strongly; e.g. [16]. It is worthwhile
noting that regions with weaker binding seem to also have a lower chance of driving expression [62, 68] and
might potentially be experimental artefacts; e.g. [69].
12

4.3

Additional factors that affect TF binding profiles

Our analytical model can recapitulate observed genome-wide binding profiles (e.g. for four of the TFs, the
correlation is higher than 0.65) especially at the loci with strong binding, but there are several loci, where our
model under/overestimates the ChIP-seq profile; see Figure 4 and Figures A6 - A10 in the Appendix. In this
contribution, we systematically investigated potential causes for these differences.
First, there is an inconsistency in the experimental data in the sense there are peaks in the ChIP-seq
profile that are located in DNA inaccessible areas, e.g. there are peaks in the Bicoid ChIP-seq profile at run,
slp, eve, tll, gt, oc loci that overlap with DNA that is marked as inaccessible; see Figure A6 in the Appendix.
This indicates that either or both the DNA accessibility or the ChIP-seq data display some technical biases,
e.g. [69, 70], and, in these cases, the analytical model assumes that the DNA accessibility data is accurate
and predicts that there is no binding in DNA inaccessible areas. One solution is to use continuous data for
DNA accessibility, where different areas display different levels of accessibility. When using continuous values
for DNA accessibility data, we did not observe any improvements of our model’s predictions. Nevertheless, we
still observed ChIP-seq peaks for all five TFs that were overlapping with regions with reduce or no accessibility,
thus, indicating the one or both data sets (ChIP-seq or DNase I) contain experimental biases; e.g. [69–71].
Alternatively, the underestimation of the peak height may be caused by PWM choice. Using motifs from
the JASPAR database [39], we observed lower values for the correlation and higher values for the mean squared
error compared to the case of using the PWMs from BDTNP [16]. In addition, when we used different PWMs
(from the JASPAR database) we found different estimates for the number of molecues that best explain the
ChIP-seq data, but these values were within the same range (2000 − 10000 molecules). This suggests that
our estimates for the amount of bound TFs are not the exact values, but rather an estimate of the order of
magnitude for the number of molecules that are bound specifically to the DNA.
In this manuscript, we aim to deconvolute the contributions of different factors to the binding profiles of
TFs. One of the most important factors that contribute to the binding profiles is the binding energy between
the TF and the DNA words. Previous work [21, 72, 73] showed that the binding energy between a TF and
the DNA is proportional to the PWM score and, thus, the binding energy can be approximated by a scaled
PWM score (Ei = wi /λ). In order to avoid introducing the effects of “other factors” in the binding energy
estimation, one should consider that the PWM is representing only the binding frequency between the TF
and the DNA words independent of other factors. Inferring the PWM motif from the ChIP-seq peaks would
assume that DNA accessibility, TF cooperativity, crowding of molecules on the DNA, histone marks and others
will affect the PWM. While by using a PWM derived from ChIP-seq data we might lead to better predictions
of the binding profiles, we would not be able to distinguish between the real sources that drive the genomic
occupancy and their relative contribution. This is the rationale for testing PWMs derived from BDTNP [16]
and JASPAR[39] and not investigating the case of the PWMs derived from ChIP-seq data.
Furthermore, we do not consider every aspect related to the binding of TFs to the genome, but binding
energy (PWM scores and λ), TF abundance and DNA accessibility are sufficient to explain most of the characteristics of the binding profiles for the TFs analysed in this study (Bicoid, Caudal, Giant, Hunchback and
Kruppel). One aspect that our model does not include is cooperative binding to the DNA. Previous studies
have shown that TF cooperativity can significantly impact the binding of TFs [13, 18–20, 74, 75] and that
cooperativity can explain TF genomic binding [17]. However, it was found that the five TFs considered in this
study display negligible or no cooperative interactions between them [16, 17], but these TFs seem to display
cooperative interactions with other TFs [17, 76, 77]. For example, the Bicoid binding profile seems to be significantly influenced by the maternally contributed factor Zelda, where the presence of Zelda increases the binding
of Bicoid at the majority of loci and decreases it at a small set of loci [76]. Modelling these binding profiles assuming cooperativity with other TFs could potentially improve our model predictions, but this requires further
systematic investigation and will be left to future research.
Our model does not implement competitive binding directly. Other models, e.g. [16], allow to model the
competition between TFs explicitly, but the fact that we obtained similar correlation between the predicted
profile and the ChIP-seq data indicates that there is negligible binding competition between the five TFs
analysed in this study as also shown in [67].
Finally, we would like to point out that while our model was applied to a ChIP-seq dataset, it could also
be used to investigate ChIP-chip and ChIP-exo [54] datasets as long as the appropriate length distribution of
DNA fragments is included in the model (see Materials and Methods).

5

Availability

The R scripts used to perform the analysis can be downloaded from https://github.com/nrzabet/ChIPseqProfile
13

6

Funding

This work was supported by the Medical Research Council [G1002110]. BA is a Royal Society University
Research Fellow.

7

Acknowledgements

We would like to thank Robert Foy, Xiaoyan Ma and Robert Stojnic for useful discussions and comments on
the manuscript.
APPENDIX

A1

Derivation of the analytical model

Here, we derive an analytical solution for the statistical thermodynamics model, which makes it feasible to
investigate genome-wide binding profiles of TFs, rather than being restricted to much shorter loci.

A1.1

Binding energy between the TF and the DNA

The amount of time a TF is bound to a specific site can be computed using the binding energy as [78]:

τj = τ0 exp (−Ej ) = τ0 exp

1
wj
λ


(A1)

where j is the genomic coordinate of the site, τ0 is a scaling factor associated with each TF species (which takes
into account an absolute strength between the TF and the DNA) and Ej is the binding energy of site j. Note
that the binding energy can be approximated by the PWM score Ej = λ1 wj , where 1/λ is a scaling factor which
quantifies the penalty for differences from the preferred site [8, 21] and wj the PWM score at position j.
We want to investigate the accuracy of our analytical model and, thus, we compare its results with the
results from a detailed statistical thermodynamics model, as computed with GRiP [34, 35, 79, 80]; see section
A2. As previously shown in [11], for highly abundant TFs, the estimation of the occupancy based on the PWM
alone is not sufficient to accurately predict the profile found in simulations (and also by a simple statistical
thermodynamics framework); see Figure A2. Note that in Figure A2 we do not simulate the 1D random walk
on the DNA, while in Figure 3 in [11] the 1D random walk on the DNA is considered.

A1.2

The number of bound molecules to the DNA

We used our analytical solution for the statistical thermodynamics framework to include TF abundance in the
model. Given that a TF has N molecules bound to the DNA, the statistical weight that a site is unoccupied
by a molecule can be written as [18–20, 75]
number of arrangements

z
Z (N ) =

}|
{
(L · n)!
N ! (L · n − N )!

× exp (−E ns )
|
{z
}

(A2)

Boltzmann weight

where Exns is the binding free energy when the TF is non-specifically bound to the DNA (i.e. not to the target
site), L represents the total number of available sites (which can be approximated by the length of the DNA
segment) and n is the ploidy level (the number of copies of the genome, e.g. for diploid genomes n = 2).
The total statistical weight is given by the sum of the statistical weight when the site is unoccupied and the
statistical weight when the site is occupied.
the site is empty

Ztotal (N ) =

z }| {
Z (N )

the site is occupied

z
}|
{
+ Z (N − 1) exp (−E s )
14

(A3)

where E s binding free energy at the target site (where the TF is bound specific). Altogether the probability
that the target site is occupied is given by the ratio between the statistical weight of the site being occupied
over the total statistical weight.
P bound =

Z (N − 1) exp (−E s )
=
Ztotal (N )
1+

1

(A4)

Z(N )
Z(N −1) exp (−E s )

This can be reduced to [19] :
P bound (Ej , N ) =

1+

L·n−N +1
N

1
=
exp [(E s − E ns )]
1+

1
(L·n−N +1) exp(−E ns )
N

exp (E s )

(A5)

Given the size of the genome and the range of TF abundances reported in the literature, we can assume
that the number of available sites is much larger than the number of bound molecules (L · n  N ) and, thus,
(L · n − N + 1) ≈ L·n [19]. In our model, we do not want to be constrained to only two binding energy levels (the
binding energy for non-specific sites and for specific sites), but rather consider the full binding energy spectrum.
If E ns represents the binding energy at other sites (not the current one), then L · n · exp (−E
ns ) represents
 the
average waiting time on the genome and can be approximated by L · n · hexp (−Ei )ii = L · n · exp λ1 wi i [10].
This leads to the following probability of site j being occupied by a TF molecule:

N exp λ1 wj
1








Pjbound (λ, w, N ) =
=
(A6)
1 + N1 L · n · exp λ1 wi i exp − λ1 wj
N exp λ1 wj + L · n · exp λ1 wi i
Figure A3 shows that, by including the TF abundance in our model, the estimate of the occupancy
obtained in the simulations improves significantly; compare Figure A2 to Figure A3.
One approximation of our model is that we assume the mean value instead of the full distribution of PWM
scores [5]. However, we found that, by using this approximation (the mean value of the PWM scores) [10], the
difference between the analytical and numerical results are negligible; see Figure A3. This approximation also
holds in the case of TFs with lower specificity as we show in the Results section of the main manuscript.

A1.3

Including DNA accessibility data

To apply our model to eukaryotic systems we need to include DNA accessibility as a parameter. The probability
that a site j is bound, in the case of N bound molecules to the DNA and in presence of DNA accessibility data,
can be rewritten as

N · aj · exp λ1 wj
bound




Pj
(λ, w, N, a) =
(A7)
N · aj · exp λ1 wj + L · n · ai exp λ1 wi i
where aj the probability that site j on the genome is in accessible chromatin.

A1.4

Analysing ChIP-seq data with the analytical model

To test the accuracy of our analytical model, we compare its estimated profile to ChIP-seq data and, thus, we
need to convert the prediction of the analytical model to a profile of genomic occupancy. Given, Cj as the
experimentally determined ChIP-seq signal at position j on the genome, the equivalent occupancy based on the
analytical estimate is [10]
A (j, λ, w, N ) = B + (M − B) × Pjbound
(A8)
where B = hCi is the background and M = max(C) is the maximum of the ChIP-seq signal.

A1.5

Modelling DNA accessibility data

Following the approach in [16], we modelled the probability of a site being accessible as
aj =

1
1 + exp (−β · DDj + α)

(A9)

where DDj is the DNase I read density and α and β are scaling parameters, which were estimated to be
α = 6.008 and β = 0.207 in [16].
15

parameter
copy number
motif sequence
energetic penalty for mismatch
nucleotides covered on left
nucleotides covered on right
association rate to the DNA
unbinding probability
probability to slide left
probability to slide right
probability to dissociate completely when unbinding
time bound at the target site
the size of a step to left
the size of a step to right
variance of repositioning distance after a hop
the distance over which a hop becomes a jump

lacI
see Table A2
see Figure A1
1KB T
0 bp
0 bp
see Table A2
1.0
0
0
1.0
1.18E − 6 s
1 bp
1 bp
1 bp
100 bp

notation
nx
ε∗x
δxleft
δxright
kxa
Pxunbind
Pxleft
Pxright
Pxjump
τx0
2
σhop
djump

Table A1: TF species default parameters
lacI copy number
100
1000
10000
100000

association rate to the DNA
2700
3100
4000
20000

simulation time
150 s
15 s
1.2 s
0.075 s

bound molecules
92
930
8852
91784

Table A2: The parameters for the six cases of lacI abundance. The association rate was selected so that on
average 90% of the time the TF molecules are bound to the DNA.

A2

Computing the equilibrium binding profile with GRiP

To obtain the profile generated with a statistical thermodynamics approach, we performed stochastic simulations
with our previously published computational tool GRiP [34, 79, 80] that simulates the facilitated diffusion of
TFs [33]. In GRiP, all the molecules in the system are represented explicitly, along with steric hindrance effects.
Three-dimensional diffusion is simulated using the Master Equation, an approximation which was previously
proven to provide accurate results [81]. The simulations were restricted to binding and unbinding to/from the
DNA (we removed the one-dimensional random walk on the DNA from the simulations), which means that
the results are equivalent to the ones predicted by the classical statistical thermodynamics framework. To
compare the profiles generated by simulations (S) and the ones generated by the analytical approximation (A),
we normalise all profiles to the highest values.
When comparing the analytical model to the results computed by GRiP, we considered the case of lac
repressor (lacI), a well studied bacterial TF and 20 Kbp of E.coli DNA ( 355000..375000 locus in the E.coli
K-12 genome). For lacI, we considered a motif constructed based on the three high-affinity sites of lacI in [80];
see Figure A1. The default parameters for the simulations with GRiP are listed in Table A1. Furthermore, we
considered four cases with respect to lacI abundance and the set of parameters selected for each case ensured
that each site is visited on average approximately 2000 times; see Table A2. We performed 50 independent
simulations for each set of parameters and computed the occupancy as time average in each simulation. Overall,
this resulted in each site being visited on average 105 times.
Finally, to generate the ChIP profiles we used the method described by [16], where a mean segment length
of 150 bp, a standard deviation of 150 bp and no smoothing was used; the R implementation of this method is
described in [11]. The difference between the simulations and our analytical formula was quantified by: (i) the
Pearson coefficient of correlation and (ii) the mean squared error.

16

Information content

lacI
2
1.5
1
0.5
0
1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

Position

Figure A1: Sequence logo for lacI. [80]

17

18

19

20

21

1.2

correlation = 0.998 ; mean squared error = 0.594

0.4

0.8

92 DNA bound molecules

0.0

occupancy

A

360000

362000

364000

366000

368000

370000

B

correlation = 0.986 ; mean squared error = 0.421

0.4

0.8

930 DNA bound molecules

0.0

occupancy

1.2

DNA position

360000

362000

364000

366000

368000

370000

C

correlation = 0.678 ; mean squared error = 28.6

0.4

0.8

8852 DNA bound molecules

0.0

occupancy

1.2

DNA position

360000

362000

364000

366000

368000

370000

D

correlation = 0.161 ; mean squared error = 137

0.4

0.8

91784 DNA bound molecules

0.0

occupancy

1.2

DNA position

360000

362000

364000

366000

368000

370000

DNA position

Figure A2: Estimating the occupancy in the simulations (or statistical thermodynamic model) based on the
PWM score alone. We considered the case of the lac repressor and 20 Kbp of DNA, which contain the O1 site.
In each chart, the filled region is the occupancy predicted base on the simulations (S), and the solid line is
the occupancy estimated by the analytical solution; see equation A1. We considered various lacI abundances:
(A) 100 lacI molecules (leading to 92 lacI molecules being bound to the DNA), (B) 1000 lacI molecules (i.e.
930 lacI molecules), (C) 10000 lacI molecules (i.e. 8852 lacI molecules) and (D) 100000 lacI molecules (i.e.
91784 lacI molecules). For each set of parameters, we consider X = 50 independent simulations. We considered
only the sites that have the binding energy of at least 70% of the highest value (the strongest 81 sites). We
converted the single nucleotide resolution into expected occupancy profiles as proposed in [16], with a mean of
150 bp and a standard deviation of 150 bp; see also [11]. The inset in each panel indicates the Pearson coefficient
of correlation and the mean squared error between the occupancy computed by the analytical model and the
occupancy computed from the simulations, which is equivalent to the occupancy generated by the full statistical
thermodynamics model. The x-axis represents the genomic location.

18

1.2

correlation = 1 ; mean squared error = 0.000178

0.4

0.8

92 DNA bound molecules

0.0

occupancy

A

360000

362000

364000

366000

368000

370000

B

correlation = 0.999 ; mean squared error = 0.0443

0.4

0.8

930 DNA bound molecules

0.0

occupancy

1.2

DNA position

360000

362000

364000

366000

368000

370000

C

correlation = 0.961 ; mean squared error = 7.86

0.4

0.8

8852 DNA bound molecules

0.0

occupancy

1.2

DNA position

360000

362000

364000

366000

368000

370000

D

correlation = 0.945 ; mean squared error = 11.5

0.4

0.8

91784 DNA bound molecules

0.0

occupancy

1.2

DNA position

360000

362000

364000

366000

368000

370000

DNA position

Figure A3: Estimating the occupancy in the simulations (or statistical thermodynamic model) based on the
PWM and TF abundance. This is the same as Figure A2, except that equation (A6) was used to compute the
occupancy, solid line.

19

A3

Data sets
Symbol
croc
cnc
slp
kni
hkb
D
prd
H
eve
cad
oc
opa
ftz
gt
hb
Kr
odd
run
fkh
tll
os

Gene name
crocodile
cap-n-collar
sloppy paired
knirps
huckebein
Dichaete
paired
hairy
even skipped
caudal
ocelliless
odd paired
fushi tarazu
giant
hunchback
Kruppel
odd skipped
runt
forkhead
tailless
outstretched

Locus coordinates
chr3L:21,461,001-21,477,000
chr3R:19,011,001-19,024,000
chr2L:3,820,001-3,840,000
chr3L:20,683,260-20,695,259
chr3R:169,001-181,000
chr3L:14,165,001-14,179,000
chr2L:120,77,501-12,095,500
chr3L:8,656,154-8,682,153
chr2R:5,860,693-5,876,692
chr2L:20,767,501-20,786,500
chrX:8,518,001-8,550,000
chr3R:670,001-696,000
chr3R:2,682,501-2,696,500
chrX:2,317,878-2,330,877
chr3R:4,513,501-4,531,500
chr2R:21,103,924-21,118,923
chr2L:3,603,001-3,613,000
chrX:20,548,001-20,570,000
chr3R:24,396,001-24,420,000
chr3R:26,672,001-26,684,000
chrX:18,193,001-18,208,000

Length
16 Kb
13 Kb
20 Kb
12 Kb
12 Kb
24 Kb
18 Kb
26 Kb
16 Kb
19 Kb
32 Kb
26 Kb
14 Kb
13 Kb
18 Kb
15 Kb
10 Kb
22 Kb
24 Kb
12 Kb
15 Kb

Table A3: Genes and coordinates for analysed sets loci. These are the same loci as considered in [16].

20

A4
A4.1

Analysis of the ChIP-seq profiles
Heatmaps for GT, HB and KR

21

correlation (GT)

A

correlation (HB)

B

correlation (KR)

C

5

0.0737

0.0737

0.0737

0.0737

0.0738

0.0738

0.074

0.0743

0.075

0.0768

0.0798

0.0854

0.1

0.12

0.146

0.18

0.197

5

0.173

0.173

0.173

0.173

0.174

0.175

0.179

0.186

0.197

0.224

0.251

0.278

0.304

0.313

0.314

0.304

0.288

5

0.279

0.279

0.279

0.28

0.282

0.285

0.293

0.305

0.325

0.358

0.378

0.389

0.389

0.385

0.377

0.362

0.348

4.5

0.0737

0.0737

0.0737

0.0738

0.0738

0.0739

0.0741

0.0745

0.0753

0.0777

0.0815

0.0888

0.108

0.132

0.162

0.197

0.211

4.5

0.173

0.173

0.173

0.174

0.175

0.177

0.182

0.191

0.206

0.239

0.269

0.297

0.319

0.326

0.325

0.313

0.295

4.5

0.279

0.279

0.28

0.281

0.284

0.289

0.302

0.32

0.346

0.378

0.391

0.394

0.389

0.382

0.373

0.358

0.344

4

0.0737

0.0737

0.0737

0.0738

0.0738

0.0739

0.0743

0.0748

0.0759

0.079

0.0841

0.0937

0.118

0.147

0.181

0.216

0.227

4

0.173

0.173

0.173

0.174

0.175

0.178

0.186

0.198

0.218

0.258

0.29

0.315

0.334

0.338

0.337

0.323

0.304

4

0.279

0.28

0.281

0.283

0.288

0.296

0.318

0.343

0.37

0.393

0.398

0.394

0.386

0.378

0.368

0.354

0.341

3.5

0.0737

0.0737

0.0737

0.0738

0.0739

0.074

0.0745

0.0752

0.0767

0.0811

0.0881

0.101

0.133

0.168

0.205

0.236

0.244

3.5

0.173

0.173

0.174

0.175

0.177

0.181

0.192

0.209

0.235

0.28

0.31

0.331

0.344

0.348

0.347

0.334

0.315

3.5

0.279

0.28

0.282

0.287

0.295

0.31

0.341

0.369

0.391

0.4

0.397

0.39

0.38

0.372

0.363

0.35

0.339

3

0.0737

0.0737

0.0738

0.0738

0.0739

0.0742

0.0748

0.0759

0.078

0.0843

0.0943

0.113

0.155

0.196

0.232

0.256

0.259

3

0.18

0.181

0.181

0.183

0.187

0.194

0.212

0.235

0.267

0.308

0.328

0.341

0.351

0.355

0.35

0.355

0.346

0.329

3

0.279

0.282

0.285

0.295

0.308

0.331

0.368

0.391

0.401

0.399

0.391

0.382

0.372

0.364

0.356

0.347

0.339

2.5

0.0737

0.0737

0.0738

0.0739

0.074

0.0744

0.0754

0.077

0.0803

0.0897

0.104

0.13

0.184

0.228

0.257

0.272

0.272

2.5

0.202

0.20.204

0.205

0.209

0.215

0.226

0.252

0.279

0.306

0.329

0.338

0.344

0.351

0.357

0.361

0.358

0.347

2.5

0.28

0.287

0.293

0.312

0.336

0.365

0.393

0.403

0.403

0.393

0.382

0.372

0.361

0.355

0.35

0.343

0.338

0.4

0.387

0.376

0.363

0.35

0.343

0.339

0.336

0.334

0.379

0.367

0.355

0.344

0.335

0.332

0.329

0.329

0.1
0.159

0.137

0.137

0.14

0.143

0.149

0.165

0.188

0.221

0.264

0.281

0.288

0.287

0.284

2

0.234

0.236

0.239

0.246

0.258

0.275

0.305

0.321

0.327

0.33

0.331

0.333

0.339

0.347

0.355

0.364

0.363

2

0.326

0.338

0.348

0.368

0.384

0.398

0.406

0.406

0.15
0.159

0.16

0.162

0.166

0.174

0.191

0.22

0.256

0.286

0.292

0.29

0.288

0.288

1.75

0.266

0.27

0.273

0.283

0.296

0.312

0.326

0.329

0.329

0.326

0.324

0.325

0.33

0.337

0.347

0.36

0.366

1.75

0.323

0.339

0.353

0.375

0.39

0.4

0.402

0.399

1.5

0.132

0.132

0.132

0.133

0.134

0.135

0.138

0.146

0.161

0.196

0.23

0.258

0.277

0.277

0.277

0.279

0.283

1.5

0.305

0.30.31

0.316

0.328

0.34

0.349

0.349

0.341

0.33

0.317

0.313

0.314

0.319

0.325

0.334

0.348

0.359

1.5

0.327

0.347

0.361

0.382

0.393

0.398

0.399

0.396

0.392

0.382

0.369

0.355

0.338

0.327

0.32

0.317

1.25

0.181

0.181

1

0.215

0.215

0.319

0.182

0.182

0.183

0.185

0.191

0.201

0.218

0.254

0.274

0.284

0.281

0.273

0.27

0.271

0.275

1.25

0.333

0.338

0.342

0.349

0.352

0.349

0.336

0.322

0.311

0.302

0.3

0.302

0.308

0.313

0.319

0.328

0.339

1.25

0.328

0.35

0.363

0.378

0.383

0.384

0.382

0.379

0.377

0.372

0.364

0.353

0.333

0.317

0.307

0.301

0.302

0.216

0.217

0.20.218

0.221

0.231

0.244

0.264

0.286

0.288

0.286

0.269

0.261

0.254

0.254

0.259

1

0.379

0.382

0.383

0.38

0.37

0.356

0.334

0.316

0.302

0.291

0.289

0.291

0.296

0.3

0.305

0.31

0.315

1

0.351

0.37

0.377

0.383

0.385

0.385

0.383

0.38

0.376

0.371

0.368

0.362

0.349

0.334

0.318

0.305

0.75

0.257

0.25

0.298

0.257

0.258

0.26

0.263

0.269

0.281

0.3

0.308

0.305
0.3

0.293

0.28

0.259

0.245

0.236

0.23

0.231

0.75

0.312

0.322

0.326

0.323

0.313

0.302

0.286

0.274

0.267

0.264

0.268

0.273

0.28

0.285

0.289

0.295

0.3

0.75

0.366

0.373

0.375

0.377

0.377

0.375

0.371

0.368

0.364

0.359

0.356

0.354

0.351

0.347

0.341

0.327

0.5

0.223

0.315

0.225

0.227

0.231

0.238

0.249

0.264

0.27

0.27

0.269

0.264

0.256

0.247

0.237

0.224

0.209

0.202

0.5

0.293

0.296

0.293

0.279

0.266

0.256

0.247

0.241

0.237

0.2
0.238 50.244

0.253

0.262

0.267

0.271

0.274

0.276

0.5

0.354

0.358

0.35

0.359

0.358

0.357

0.355

0.353

0.351

0.348

0.345

0.342

0.338

0.337

0.335

0.334

0.25

0.332

0.15

0.2

0.25

0.19

0.192

0.194

0.199

0.205

0.211

0.214

0.213

0.212

0.212

0.211

0.209

0.209

0.211

0.216

0.223

0.225

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

0.25

0.35

0.3

0.275

0.264

0.25

0.227

0.213

0.206

0.202

0.201

0.201

0.202

0.205

0.21

0.22

0.23

0.24

0.251

0.256

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

0.275

0.274

0.27

0.255

0.255

0.247

1

10

20

50

100

200

500

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 3.4e+00 5.3e+00 1.2e+01 3.9e+01 7.6e+01

4.5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 3.2e+00 3.9e+00 7.3e+00 1.8e+01 5.1e+01 9.1e+01

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1.1e+00 9.6e−01 1.1e+00 2.5e+00 1.2e+01 3.7e+01

3.6

4.4

1e+00 1.6e+00 4.8e+00 2.3e+01 6.2e+01

3.5

4.5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 3.2e+00 4.9e+00 1.1e+01 2.5e+01 6.2e+01 1e+02

4

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.6e−01 1.3e+00 3.4e+00 1.1e+01 4.3e+01 1e+02

0.247

0.249

0.25

0.25

0.251

0.251

0.254

0.255

0.256

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.3e+00 3.1e+00 3.5e+00 6.8e+00 1.5e+01 3.3e+01 7.2e+01 1.1e+02

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00 8.8e+00 8.5e+00 8e+00 7.4e+00 6.8e+00 7.9e+00 1.4e+01 3.5e+01 6e+01

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.7e+00 8.2e+00 7.6e+00 7e+00

7e+00 9.8e+00 1.9e+01 4.6e+01 7.1e+01

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 8.9e+00 8.7e+00 8.4e+00 7.8e+00 7.2e+00 6.7e+00 8e+00 1.3e+01 2.5e+01 5.5e+01 8e+01

3.5

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00 8.8e+00 8.5e+00 8.1e+00 7.3e+00 6.8e+00 6.9e+00 9.9e+00 1.7e+01 3.1e+01 6.1e+01 8.5e+01

3

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.6e+00 8.2e+00 7.6e+00 6.9e+00 6.8e+00 7.7e+00 1.2e+01 2e+01 3.4e+01 6e+01 8.2e+01

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.6e−01 1.2e+00 2.7e+00 9.7e+00 2.4e+01 5.2e+01 1.2e+02 1.9e+02

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 3.1e+00 2.9e+00 3.7e+00 6.3e+00 1.4e+01 2.4e+01 3.7e+01 6e+01 7.8e+01

2

9.1e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.6e+00 8.1e+00 7.6e+00 7.2e+00 7.3e+00 8e+00 9.2e+00 1.2e+01 1.7e+01 2.4e+01 3.8e+01 5e+01

λ

9.1e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.7e+00 8.3e+00 7.8e+00 7.3e+00 6.9e+00 7.3e+00 8.7e+00 1.3e+01 2e+01 3.1e+01 5.2e+01 7e+01

2

1.75

9.2e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.6e+00 8.1e+00 7.7e+00 7.4e+00 7.6e+00 8.3e+00 9.3e+00 1.1e+01 1.5e+01 2e+01 3.1e+01 4e+01

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 3e+00 3.1e+00 4.5e+00 8e+00 1.5e+01 2.3e+01 3.1e+01 4.3e+01 5.5e+01

1.5

9.2e+00 9.1e+00 9.1e+00 9e+00 8.8e+00 8.6e+00 8.1e+00 7.7e+00 7.6e+00 8e+00 8.6e+00 9.5e+00 1.1e+01 1.3e+01 1.6e+01 2.3e+01 3e+01

1.25

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 3e+00 3.3e+00 4.9e+00 8.5e+00 1.5e+01 2.1e+01 2.8e+01 3.7e+01 4.4e+01

1.25

9.2e+00 9.2e+00 9.1e+00 9e+00 8.8e+00 8.6e+00 8.1e+00 7.8e+00 7.8e+00 8.3e+00 8.9e+00 9.7e+00 1.1e+01 1.2e+01 1.3e+01 1.6e+01 2e+01

1

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 3e+00 3.5e+00 5.1e+00 8.5e+00 1.5e+01 2e+01 2.5e+01 3.1e+01 3.7e+01

1

9.2e+00 9.2e+00 9.1e+00 9e+00 8.8e+00 8.5e+00 8.1e+00 7.8e+00 7.9e+00 8.5e+00 9e+00 9.7e+00 1.1e+01 1.1e+01 1.2e+01 1.4e+01 1.5e+01

0.75

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.3e+00 3.2e+00 3.7e+00 5.1e+00 7.9e+00 1.3e+01 1.8e+01 2.2e+01 2.6e+01 2.9e+01

0.75

9.2e+00 9.2e+00 9.1e+00 9e+00 8.8e+00 8.5e+00 8.1e+00 7.9e+00 8.1e+00 8.6e+00 9.1e+00 9.5e+00 1e+01 1.1e+01 1.1e+01 1.2e+01 1.3e+01

3

1.5

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1e+00

1e+00 1.6e+00 3.6e+00 1.2e+01 2.7e+01 5.7e+01 1.2e+02 1.8e+02

5

1.25

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1.1e+00 9.7e−01 1.1e+00 1.8e+00 3.9e+00 1.2e+01 2.8e+01 5.7e+01 1.1e+02 1.6e+02

4.
6

4
1.3e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.6e−01 1.1e+00 1.7e+00 3.7e+00 1.2e+01 2.6e+01 5.1e+01 9.4e+01 1.2e+02

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.6e−01 1.1e+00 1.7e+00 3.7e+00 1.1e+01 2.1e+01 3.9e+01 7e+01 9.4e+01

0.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1.1e+00 1.4e+00 2.3e+00 4.2e+00 8.9e+00 1.5e+01 2.5e+01 4.3e+01 5.6e+01

0.25

1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.9e+00 3.2e+00 5.2e+00 7.9e+00 9.4e+00 1.1e+01 1.3e+01 1.8e+01

3.8

3

4.8

1

0.75

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

0.5

4.2

1e+05

2e+05

5e+05

0.25

1e+06

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.4e+00 3.4e+00 4e+00

4.4

4.2

5e+00 6.5e+00 9.8e+00 1.3e+01 1.6e+01 2.1e+01 2.4e+01

0.5

4

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.5e+00 3.7e+00 4.6e+00 5.5e+00 6.3e+00 7e+00 7.4e+00 8.3e+00 1.1e+01 1.2e+01

1

10

20

50

100

200

number of bound molecules

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

0.25

4.5

4.5

4.5

4

4

4

3.5

3.5

3.5

3

3

2.5

2.5

2

2

1.5

1.5

1.5

1.25

1.25

1

1

1

0.75

0.75

0.75

0.5

0.5

0.5

0.25

0.25

200

500

1000

2000

5000

10000

number of bound molecules

200

20000

50000

1e+05

2e+05

5e+05

1e+06

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

optimal parameters (KR)

1.75

1.25

100

100

λ
1.75

50

50

2

λ

λ

3

2.5

20

20

I
5

10

10

number of bound molecules

5

1

4

1

5

1.75

1

1e+01 1.1e+01 1.1e+01

9.3e+00 9.2e+00 9.2e+00 9e+00 8.7e+00 8.4e+00 8.1e+00 8e+00 8.3e+00 8.7e+00 9.2e+00 9.5e+00 9.8e+00 9.9e+00 9.8e+00 9.8e+00 9.8e+00

1e+06

optimal parameters (HB)

H

4.

9

3.

9.3e+00 9.2e+00 9.1e+00 9e+00 8.8e+00 8.4e+00 8.1e+00 8e+00 8.2e+00 8.8e+00 9.1e+00 9.4e+00 9.7e+00 1e+01

number of bound molecules

optimal parameters (GT)

G

4.
4
4.
2

3e+00 4.1e+00 7.2e+00 1.5e+01 2.3e+01 3.4e+01 5.2e+01 6.8e+01

1.5

1.75

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.3e+00 3e+00

8
4.

λ

3.
4

1.75

2.5

6

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1.1e+00 9.7e−01 1e+00 1.8e+00 6.8e+00 1.8e+01 4.4e+01 1.1e+02 1.9e+02

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 3e+00 3.3e+00 4.9e+00 1.2e+01 2.4e+01 4.2e+01 7.1e+01 9.6e+01

4.

2

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.4e+00 3.1e+00 3.2e+00 4.1e+00 9.6e+00 2.1e+01 4e+01 7.6e+01 1e+02

2.5

8

4.6

3

4.

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.7e−01 1.1e+00 2.8e+00 8.5e+00 2.4e+01 7.7e+01 1.5e+02

4.3

2.5

3.6

3

0.246

5

3.
2

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1.1e+00 1e+00

5

3.8

5

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1.1e+00 9.8e−01 9.8e−01 1.5e+00 6.5e+00 2.2e+01

3

1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.6e−01 1.1e+00 3.8e+00 1.3e+01

4

4

0.25

mean squared error (KR)

F

5

3

0.269

0.3

number of bound molecules

mean squared error (HB)

E

4.5

3.5

0.25

0.359

number of bound molecules

mean squared error (GT)

D

0.40.391

4.5

0.137

0.158

0.35

λ

0.136

0.158

0.3

λ

0.136

0.158

λ

0.136

λ

2

1.75

0.25

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

number of bound molecules

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A4: Quantifying the distances between Giant, Hunchback and Kruppel ChIP-seq profiles and the profiles
derived with the analytical model. We plotted heatmaps for the correlation (A − C) and mean squared error
(D − F ) between the analytical model and the ChIP-seq profile of Giant (A, D), Hunchback (B, E) and Kruppel
(C, F ). We computed these values for different sets of parameters: N ∈ [1, 106 ] and λ ∈ [0.25, 5]. We considered
only the sites that have a PWM score higher than 70% of the difference between the lowest and the highest
score. (A − C) Orange colour indicates high correlation between the analytical model and the ChIP-seq profile,
while white colour low correlation. (D − F ) Blue colour indicates low mean squared error between the analytical
model and the ChIP-seq profile, while white colour high mean squared error. (G − I) We plotted the regions
where the mean squared error is in the lower 12% of the range of values (blue) and the correlation is the higher
12% of the range of values (orange). With green rectangle we marked the optimal set of parameters in terms
of mean squared error and with a black rectangle the intersection of the parameters for which the two regions
intersect.

22

correlation (GT)

correlation (HB)

B

0.421

0.421

0.421

0.422

0.423

0.424

0.427

0.432

0.439

0.452

0.459

0.464

0.463

0.458

5

0.555

0.556

0.557

0.56

0.565

0.573

4.5

0.421

0.421

0.421

0.421

0.421

0.422

0.422

0.423

0.425

0.429

0.435

0.444

0.458

4

0.421

0.421

0.421

0.421

0.421

0.422

0.422

0.423

0.426

0.431

0.439

0.45

0.466

0.466

0.47

0.468

0.462

4.5

0.555

0.557

0.558

0.563

0.569

0.474

0.478

0.474

0.466

4

0.555

0.557

0.56

0.566

0.574

3.5

0.421

0.421

0.421

0.421

0.422

0.422

0.423

0.424

0.427

0.435

0.445

0.458

3

0.421

0.421

0.421

0.421

0.422

0.422

0.423

0.426

0.43

0.44

0.453

0.47

0.476

0.485

0.487

0.48

0.471

3.5

0.556

0.558

0.562

0.57

0.49

0.498

0.498

0.489

0.477

3

0.557

0.561

0.565

0.577

2.5

0.421

0.421

0.421

0.422

0.422

0.423

0.424

0.428

0.433

0.448

0.465

0.486

0.507

0.514

0.513

0.5

0.487

2.5

0.565

0.571

0.577

2

0.421

0.421

0.421

0.421

0.422

0.423

0.426

0.431

0.439

0.46

0.481

0.504

0.526

0.532

0.53

0.517

0.503

2

0.577

0.587

0.5

λ

0.421

λ

0.421

correlation (KR)

C

0.591

0.607

0.623

0.636

0.64

0.64

0.634

0.626

0.614

0.598

0.586

5

0.61

0.612

0.614

0.621

0.63

0.579

0.6

0.618

0.633

0.644

0.647

0.646

0.638

0.628

0.616

0.599

0.587

4.5

0.61

0.614

0.618

0.628

0.588

0.611

0.63

0.643

0.652

0.653

0.651

0.642

0.632

0.619

0.602

0.59

4

0.61

0.617

0.624

0.641

0.581

0.597

0.623

0.64

0.651

0.657

0.657

0.654

0.646

0.636

0.624

0.606

0.594

3.5

0.611

0.624

0.636

0.591

0.609

0.633

0.647

0.655

0.658

0.657

0.656

0.65

0.641

0.63

0.614

0.601

3

0.613

0.636

0.653

0.591

0.604

0.619

0.638

0.649

0.654

0.654

0.654

0.654

0.652

0.647

0.638

0.625

0.613

2.5

0.617

0.655

0.596

0.611

0.622

0.631

0.641

0.644

0.645

0.644

0.643

0.644

0.646

0.647

0.645

0.637

0.63

2

0.643

0.65

0.6

0.421

0.645

0.668

0.682

0.688

0.687

0.683

0.68

0.673

0.664

0.652

0.637

0.628

0.642

0.66

0.681

0.689

0.689

0.683

0.679

0.675

0.669

0.66

0.649

0.635

0.627

0.659

0.676

0.689

0.69

0.685

0.676

0.672

0.67

0.664

0.656

0.646

0.634

0.626

0.659

0.676

0.687

0.691

0.686

0.676

0.665

0.663

0.662

0.659

0.652

0.643

0.633

0.626

65

0.676

0.686

0.691

0.688

0.677

0.664

0.652

0.65

0.652

0.652

0.648

0.642

0.634

0.628

0.671

0.685

0.689

0.69

0.682

0.668

0.651

0.636

0.633

0.636

0.642

0.642

0.64

0.635

0.631

0.676

0.681

0.684

0.687

0.688

0.681

0.667

0.647

0.624

0.615

0.612

0.618

0.625

0.63

0.63

0.63

0.624

0.

λ

A
5

1.75

0.44

0.44

0.442

0.442

0.444

0.449

0.455

0.466

0.491

0.512

0.527

0.54

0.543

0.528

0.515

1.75

0.596

.6
00.607

0.614

0.623

0.629

0.636

0.642

0.642

0.642

0.638

0.635

0.634

0.637

0.641

0.643

0.641

0.637

1.75

0.659

0.679

0.681

0.683

0.684

0.684

0.679

0.67

0.653

0.627

0.611

0.603

0.602

0.607

0.615

0.622

1.5

0.456

0.456

0.457

0.457

0.458

0.461

0.468

0.478

0.493

0.518

0.536

0.546

0.555

0.55
0.558

0.555

0.544

0.531

1.5

0.618

0.629

0.635

0.641

0.644

0.646

0.645

0.642

0.637

0.631

0.625

0.621

0.623

0.628

0.633

0.637

0.637

1.5

0.674

0.674

0.674

0.675

0.675

0.674

0.668

0.662

0.653

0.633

0.615

0.601

0.591

0.59

0.593

0.602

0.61

1.25

0.479

0.48

0.48

0.482

0.485

0.49

0.502

0.517

0.534

0.549

0.554

0.555

0.56

0.564

0.566

0.56

0.551

1.25

0.616

0.627

0.631

0.634

0.633

0.633

0.631

0.628

0.627

0.622

0.617

0.61

0.605

0.607

0.613

0.622

0.627

1.25

0.668

0.669

0.67

0.672

0.673

0.672

0.669

0.666

0.659

0.642

0.625

0.606

0.587

0.578

0.575

0.576

0.581

0.65

0.648

0.44

0.45

1

0.507

0.509

0.51

0.514

0.75

0.549

0.551

0.552

0.556

0.56

0.5

0.549

0.551

0.554

0.551

0.519

0.544

0.25

0.444

0.45
0.44

0.435

0.425

1

10

20

50

0.54

0.527

0.54

0.547

0.552

0.544

0.536

0.537

0.543

0.554

0.562

0.567

0.566

1

0.635

0.637

0.639

0.638

0.636

0.635

0.634

0.631

0.627

0.62

0.615

0.609

0.599

0.591

0.588

0.591

0.598

1

0.643

0.643

0.643

0.645

0.647

0.649

0.647

0.644

0.64

0.633

0.623

0.607

0.591

0.575

0.566

0.56

0.55
0.562

0.561

0.555

0.538

0.505

0.488

0.484

0.493

0.508

0.524

0.544

0.555

0.75

0.617

0.625

0.626

0.625

0.624

0.623

0.625

0.628

0.628

0.622

0.615

0.608

0.601

0.595

0.587

0.575

0.567

0.75

0.605

0.604

0.604

0.605

0.606

0.607

0.607

0.605

0.603

0.602

0.604

0.606

0.605

0.602

0.598

0.59

0.578

0.532

0.521

0.508

0.483

0.449

0.428

0.414

0.407

0.413

0.424

0.443

0.461

0.5

0.567

0.57

0.573

0.578

0.58

0.581

0.581

0.583

0.588

0.596

0.602

0.604

0.603

0.601

0.6

0.598

0.597

0.5

0.549

0.542

0.543

0.545

0.546

0.558

0.56

0.565

0.569

0.576

0.58

0.578

0.578

0.579

0.58

0.58

0.419

0.415

0.412

0.408

0.401

0.388

0.377

0.369

0.363

0.359

0.358

0.356

0.351

0.25

0.537

0.526

0.524

0.526

0.532

0.55

0.55

0.578

0.25

0.591

0.538

0.502

0.502

0.507

0.509

0.538

0.537

0.495

0.483

0.483

0.48

0.481

0.481

0.482

0.495

0.496

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

0.5

0.4

0.535

0.537

0.541

0.546

0.551

0.573

0.578

0.581

0.583

0.586

0.586

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

number of bound molecules

mean squared error (GT)

D

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1e+00

number of bound molecules

mean squared error (HB)

E

9e−01 9.9e−01 2.4e+00 8.1e+00 3.2e+01 6.8e+01

0.5

mean squared error (KR)

F

5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.4e+00 3.1e+00 2.6e+00 2.5e+00 4e+00 1.1e+01 2.2e+01 3.5e+01 5.2e+01 6.2e+01

5

9.2e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00 8.7e+00 8.3e+00 7.7e+00 6.4e+00 5.3e+00 4.8e+00 7.1e+00 1.3e+01 2.3e+01 3.6e+01 4.3e+01

4.5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 2.9e+00 2.5e+00 2.9e+00 5.6e+00 1.6e+01 2.7e+01 4e+01 5.6e+01 6.4e+01

4.5

9.2e+00 9.1e+00 9.1e+00 9.1e+00 9e+00 8.8e+00 8.4e+00 7.9e+00 7.1e+00 5.7e+00 4.9e+00 5.1e+00 9.6e+00 1.8e+01 2.7e+01 3.9e+01 4.6e+01

4

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.8e−01 8.6e−01 1.3e+00 4e+00 1.3e+01 4.5e+01 8.5e+01

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.1e−01 8.7e−01 2.2e+00 7.1e+00 2.1e+01 6.1e+01 1e+02

3.4

4.
2

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.7e−01 8.6e−01 1.1e+00 4.2e+00 1.3e+01 3.3e+01 8.1e+01 1.2e+02

4

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.1e+00 2.7e+00 2.5e+00 3.8e+00 8.1e+00 2e+01 3.2e+01 4.4e+01 5.7e+01 6.5e+01

3.5

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.8e+00 2.4e+00 2.9e+00 5.3e+00 1.1e+01 2.4e+01 3.5e+01 4.5e+01 5.8e+01 6.4e+01

4.8

3.5

3.7

4.5

4.4

3

5

0.6

0.534

0.6

4

9.2e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.6e+00 8e+00 7.3e+00 6.4e+00 5.2e+00 4.9e+00 6.2e+00 1.3e+01 2.2e+01 3.1e+01 4.1e+01 4.7e+01

3.5

9.2e+00 9.1e+00 9e+00 8.9e+00 8.7e+00 8.3e+00 7.5e+00 6.7e+00 5.9e+00 5e+00 5.4e+00 7.6e+00 1.5e+01 2.5e+01 3.3e+01 4.2e+01 4.8e+01

3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 2.9e+00 2.5e+00 2.4e+00 3.8e+00 7.3e+00 1.4e+01 2.6e+01 3.6e+01 4.5e+01 5.6e+01 6.2e+01

3

9.1e+00 9e+00 8.9e+00 8.7e+00 8.4e+00 7.8e+00 6.9e+00 6.2e+00 5.6e+00 5.2e+00 6e+00 8.8e+00 1.6e+01 2.6e+01 3.3e+01 4.1e+01 4.7e+01

2.5

3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 2.7e+00 2.4e+00 2.7e+00 5.1e+00 9.1e+00 1.5e+01 2.6e+01 3.4e+01 4.2e+01 5.1e+01 5.7e+01

2.5

9.1e+00 9e+00 8.8e+00 8.4e+00 8e+00 7.4e+00 6.7e+00 6.3e+00 5.8e+00 5.5e+00 6.4e+00 9e+00 1.4e+01 2.1e+01 3e+01 3.7e+01 4.2e+01

2

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.7e−01 8.9e−01 1.6e+00 4.3e+00 1.1e+01 3.3e+01 5.8e+01 8.7e+01 1.3e+02 1.5e+02

2

3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 3e+00 2.6e+00 2.5e+00 3.3e+00 6.4e+00 9.9e+00 1.4e+01 2.2e+01 2.8e+01 3.6e+01 4.4e+01 4.9e+01

2

9.1e+00 8.9e+00 8.7e+00 8.2e+00 7.7e+00 7.3e+00 6.9e+00 6.7e+00 6.3e+00 6e+00 6.3e+00 7.6e+00 1.2e+01 1.5e+01 2e+01 2.9e+01 3.4e+01

1.75

3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 3e+00 2.6e+00 2.7e+00 3.7e+00 6.9e+00 1e+01 1.4e+01 2e+01 2.5e+01 3e+01 3.9e+01 4.4e+01

1.75

9.1e+00 8.9e+00 8.7e+00 8.2e+00 7.7e+00 7.4e+00 7.2e+00 7e+00 6.8e+00 6.3e+00 6.3e+00 6.9e+00 9.4e+00 1.3e+01 1.5e+01 2.1e+01 2.7e+01

1.5

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.6e−01 8.7e−01 1.2e+00 3.4e+00 8e+00 1.8e+01 4.1e+01 6.4e+01 8.8e+01 1.1e+02 1.4e+02

1.5

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.6e+00 2.9e+00 4e+00 7.2e+00 1e+01 1.3e+01 1.7e+01 2.1e+01 2.5e+01 3.1e+01 3.8e+01

1.5

9.2e+00 8.9e+00 8.6e+00 8.1e+00 7.8e+00 7.5e+00 7.5e+00 7.5e+00 7.3e+00 6.9e+00 6.6e+00 6.6e+00 7.7e+00 9.6e+00 1.2e+01 1.5e+01 1.8e+01

1.25

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9e−01 8.9e−01 1.3e+00 3.6e+00 8.3e+00 1.8e+01 3.8e+01 5.9e+01 7.7e+01 1e+02 1.2e+02

1.25

1.25

9.2e+00 8.8e+00 8.6e+00 8.1e+00 7.8e+00 7.7e+00 7.7e+00 7.8e+00 7.8e+00 7.7e+00 7.4e+00 7.1e+00 7e+00 7.5e+00 8.9e+00 1.2e+01 1.4e+01

1

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 1e+00 8.5e−01 8.5e−01 1.3e+00 3.4e+00 7.6e+00 1.5e+01 3.3e+01 4.7e+01 6.4e+01 8e+01 9.4e+01

1

0.75

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 1e+00 9.3e−01 9.9e−01 1.5e+00 3.5e+00 6.6e+00 1.2e+01 2.2e+01 3.3e+01 4.5e+01 6e+01 6.9e+01

0.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.2e+00 1.4e+00 2.1e+00 3.8e+00 5.6e+00 8.4e+00 1.4e+01 1.9e+01 2.4e+01 3.2e+01 4e+01

0.25

1.4e+00 1.4e+00 1.4e+00 1.3e+00 1.3e+00 1.3e+00 1.5e+00 2e+00 2.8e+00 4.1e+00 4.9e+00 5.5e+00 6.4e+00 7.6e+00 9.5e+00 1.3e+01 1.6e+01

2

λ

λ

3.

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1e+00

9e−01 9.5e−01 2.5e+00 6.5e+00 1.6e+01 3.9e+01 6.4e+01 9e+01 1.2e+02 1.5e+02

5

4.4

3.6

1.75

1

10

20

50

100

200

500

1000

2000

5000

3.8

10000

20000

50000

0.75

4.6

0.5

4

1e+05

2e+05

5e+05

0.25

1e+06

4.6

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.7e+00 3.1e+00 4.2e+00 7.1e+00 9.7e+00 1.2e+01 1.5e+01 1.8e+01

4.2

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.8e+00 3.2e+00 4.3e+00 6.7e+00 9.1e+00 1.1e+01 1.4e+01 1.6e+01 1.7e+01 2e+01 2.2e+01

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 3e+00

6e+00 7.2e+00 9.1e+00 1.1e+01 1.2e+01 1.3e+01 1.4e+01

3.6

4

3.8

3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.4e+00 3.4e+00 3.7e+00 4.1e+00 4.5e+00 4.7e+00 4.8e+00 5e+00 5.8e+00 6.4e+00 6.9e+00 7.4e+00 7.8e+00

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

0.5

9.2e+00 8.8e+00 8.5e+00 8.1e+00 8e+00 8.1e+00 8.2e+00 8.3e+00 8.3e+00 8.4e+00 8.5e+00 8.5e+00 8.6e+00 8.6e+00 8.5e+00 8.5e+00 8.6e+00

9.2e+00 8.8e+00 8.5e+00 8.2e+00 8.1e+00 8.2e+00 8.4e+00 8.5e+00 8.6e+00 8.7e+00 8.7e+00 8.6e+00 8.5e+00 8.5e+00 8.5e+00 8.6e+00 8.6e+00

1e+06

1

4.5

4.5

4

4

4

3.5

3.5

3.5

3

3

2.5

2.5

2

2

1.5

1.5

1.5

1.25

1.25

1

1

1

0.75

0.75

0.75

0.5

0.5

0.5

0.25

0.25

0.25

500

1000

2000

5000

10000

number of bound molecules

200

20000

50000

1e+05

2e+05

5e+05

1e+06

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

optimal parameters (KR)

1.75

1.25

200

100

λ
1.75

100

50

2

λ

λ

3

2.5

50

20

I

4.5

20

10

number of bound molecules

5

10

9
3.

0.25

5

1

4

9.2e+00 8.8e+00 8.5e+00 8.1e+00 7.9e+00 7.8e+00 7.9e+00 8.1e+00 8.1e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7.4e+00 7.3e+00 7.8e+00 9e+00

9.2e+00 8.8e+00 8.5e+00 8.1e+00 7.9e+00 7.9e+00 8.1e+00 8.2e+00 8.3e+00 8.4e+00 8.4e+00 8.4e+00 8.5e+00 8.5e+00 8.5e+00 8.2e+00 7.9e+00

5

1.75

3

0.75

optimal parameters (HB)

H

4.

4.1

number of bound molecules

optimal parameters (GT)

2

8

1

3e+00 3.4e+00 4.2e+00 6e+00 7.8e+00 9.8e+00 1.2e+01 1.4e+01 1.5e+01 1.7e+01 1.7e+01

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.3e+00 3.2e+00 3.3e+00 3.6e+00 4.1e+00 5e+00

number of bound molecules

G

4.
4
2e+01 2.5e+01 2.9e+01

4.

3.

λ

4.8

3

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.5e−01 9e−01 1.6e+00 4.7e+00 1.8e+01 3.9e+01 7.1e+01 1.2e+02 1.5e+02

4.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 8.8e−01 9.4e−01 2e+00 8.7e+00 2.3e+01 5.1e+01 1e+02 1.4e+02

3.4

3

2.5

1

10

20

50

100

200

500

1000

2000

5000

10000

number of bound molecules

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A5: Quantifying the distances between Giant, Hunchback and Kruppel ChIP-seq profiles and the profiles
derived with the analytical model which includes DNA accessibility data. This is the same as Figure A4, except
that we included binary DNA accessibility data in the analytical model.

23

A4.2

Profiles for all 21 loci

24

BCD (2000 molecules) @ D locus

BCD (2000 molecules) @ H locus

BCD (2000 molecules) @ Kr locus
correlation = 0.76; mean squared error = 3.35

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

BCD (2000 molecules) @ cnc locus

BCD (2000 molecules) @ croc locus
correlation = 0.96; mean squared error = 0.337

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

BCD (2000 molecules) @ eve locus

TER94

24400000

−

24405000

24410000

24415000

24420000

2682000

BCD (2000 molecules) @ gt locus

2326000

2328000

2330000

−

4520000

25

BCD (2000 molecules) @ kni locus

4525000

4530000

hkb

170000

172000

174000

chr2L

correlation = 0.32; mean squared error = 5.69

occupancy

occupancy

occupancy

20692000

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

DNA position

BCD (2000 molecules) @ opa locus

BCD (2000 molecules) @ os locus

BCD (2000 molecules) @ prd locus
correlation = 0.8; mean squared error = 1.81

opa

+

−

680000

685000

690000

695000

18195000

18200000

18205000

12085000

BCD (2000 molecules) @ tll locus
correlation = 0.85; mean squared error = 3.45

slp1

+

−

slp2

20570000

chr3R

correlation = 0.8; mean squared error = 13.5

3820000

tll

+

−

20565000

12095000

occupancy

chr2L

12090000
DNA position

occupancy

occupancy

run

+

DNA position

CG6712

12080000

BCD (2000 molecules) @ slp locus
correlation = 0.66; mean squared error = 2.43

20560000

prd

DNA position

BCD (2000 molecules) @ run locus

20555000

CG5325

−

os

DNA position

chrX

correlation = 0.84; mean squared error = 3.28

CG14947
+

+

−

675000

chr2L

3612000

occupancy

chrX
occupancy

correlation = 0.73; mean squared error = 1.12

occupancy

chr3R

180000

+

−

20690000

178000

BCD (2000 molecules) @ odd locus
correlation = 0.93; mean squared error = 0.32

+
kni

176000
DNA position

BCD (2000 molecules) @ oc locus
chrX

+

20550000

correlation = 0.68; mean squared error = 1.1

DNA position

correlation = 0.83; mean squared error = 10

2696000

+

hb

4515000

DNA position

chr3L

2694000

occupancy

occupancy

occupancy

2324000

2692000

chr3R

CG8112

−

gt

2690000

BCD (2000 molecules) @ hkb locus
correlation = 0.95; mean squared error = 16

+

670000

2688000

DNA position

chr3R

+

20688000

2686000

BCD (2000 molecules) @ hb locus
correlation = 0.67; mean squared error = 1.82

20686000

2684000

DNA position

chrX

20684000

ftz

+
fkh

5875000

DNA position

−

correlation = 0.75; mean squared error = 2.58

occupancy

chr3R

+
−

5870000

21475000

BCD (2000 molecules) @ ftz locus
correlation = 0.59; mean squared error = 0.378

occupancy

occupancy

eve

2322000

21470000
DNA position

chr3R

−

2320000

21465000

BCD (2000 molecules) @ fkh locus
correlation = 0.82; mean squared error = 5.3

CG32797

croc

19024000

DNA position

chr2R

5865000

correlation = 0.75; mean squared error = 1.11

+
cnc

19012000

DNA position

+

chr3L

+
−

20770000

−

21115000

DNA position

correlation = 0.77; mean squared error = 1.46

2318000

21110000

BCD (2000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.7; mean squared error = 13.7

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.97; mean squared error = 3.75

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A6: Binding profiles for Bicoid at all 21 loci. The grey shading represents a1ChIP-seq profile, the red line represents the prediction of the analytical model, the
yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we only displayed sites with an occupancy
higher than 5%). We considered the optimal set of parameters for Bicoid (2000 molecules and λ = 1.25).

CAD (10000 molecules) @ D locus

CAD (10000 molecules) @ H locus

CAD (10000 molecules) @ Kr locus
correlation = 0.61; mean squared error = 7.19

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

CAD (10000 molecules) @ cnc locus

CAD (10000 molecules) @ croc locus
correlation = 0.62; mean squared error = 1.62

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

CAD (10000 molecules) @ eve locus

TER94

24400000

−

24405000

24410000

24415000

24420000

2682000

CAD (10000 molecules) @ gt locus

2326000

2328000

2330000

−

4520000

26

CAD (10000 molecules) @ kni locus

4525000

4530000

hkb

170000

172000

174000

chr2L

correlation = 0.52; mean squared error = 10.7

occupancy

occupancy

occupancy

20692000

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

DNA position

CAD (10000 molecules) @ opa locus

CAD (10000 molecules) @ os locus

CAD (10000 molecules) @ prd locus
correlation = 0.89; mean squared error = 3.79

opa

+

−

680000

685000

690000

695000

18195000

18200000

18205000

12085000

CAD (10000 molecules) @ tll locus
correlation = 0.64; mean squared error = 2.45

slp1

+

−

slp2

20570000

chr3R

correlation = 0.89; mean squared error = 5.65

3820000

tll

+

−

20565000

12095000

occupancy

chr2L

12090000
DNA position

occupancy

occupancy

run

+

DNA position

CG6712

12080000

CAD (10000 molecules) @ slp locus
correlation = 0.75; mean squared error = 2.02

20560000

prd

DNA position

CAD (10000 molecules) @ run locus

20555000

CG5325

−

os

DNA position

chrX

correlation = 0.78; mean squared error = 4.2

CG14947
+

+

−

675000

chr2L

3612000

occupancy

chrX
occupancy

correlation = 0.64; mean squared error = 9.04

occupancy

chr3R

180000

+

−

20690000

178000

CAD (10000 molecules) @ odd locus
correlation = 0.81; mean squared error = 0.621

+
kni

176000
DNA position

CAD (10000 molecules) @ oc locus
chrX

+

20550000

correlation = 0.57; mean squared error = 21.6

DNA position

correlation = 0.9; mean squared error = 1.75

2696000

+

hb

4515000

DNA position

chr3L

2694000

occupancy

occupancy

occupancy

2324000

2692000

chr3R

CG8112

−

gt

2690000

CAD (10000 molecules) @ hkb locus
correlation = 0.89; mean squared error = 1.74

+

670000

2688000

DNA position

chr3R

+

20688000

2686000

CAD (10000 molecules) @ hb locus
correlation = 0.86; mean squared error = 1.45

20686000

2684000

DNA position

chrX

20684000

ftz

+
fkh

5875000

DNA position

−

correlation = 0.73; mean squared error = 7.91

occupancy

chr3R

+
−

5870000

21475000

CAD (10000 molecules) @ ftz locus
correlation = 0.88; mean squared error = 1.16

occupancy

occupancy

eve

2322000

21470000
DNA position

chr3R

−

2320000

21465000

CAD (10000 molecules) @ fkh locus
correlation = 0.69; mean squared error = 5.9

CG32797

croc

19024000

DNA position

chr2R

5865000

correlation = 0.64; mean squared error = 2.53

+
cnc

19012000

DNA position

+

chr3L

+
−

20770000

−

21115000

DNA position

correlation = 0.51; mean squared error = 8.75

2318000

21110000

CAD (10000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.58; mean squared error = 4.2

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.88; mean squared error = 1.42

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A7: Binding profiles for Caudal at all 21 loci. The grey shading represents a1 ChIP-seq profile, the red line represents the prediction of the analytical model, the
yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we only displayed sites with an occupancy
higher than 5%). We considered the optimal set of parameters for Caudal (10000 molecules and λ = 1.25).

GT (1000 molecules) @ D locus

GT (1000 molecules) @ H locus

GT (1000 molecules) @ Kr locus
correlation = 0.58; mean squared error = 1.28

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

GT (1000 molecules) @ cnc locus

GT (1000 molecules) @ croc locus
correlation = 0.85; mean squared error = 0.284

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

GT (1000 molecules) @ eve locus

TER94

occupancy
24400000

GT (1000 molecules) @ gt locus

24410000

24415000

24420000

2682000

2328000

2330000

−

4520000

27

GT (1000 molecules) @ kni locus

4525000

4530000

20692000

178000

chr2L

correlation = 0.42; mean squared error = 0.838

+

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

GT (1000 molecules) @ opa locus

GT (1000 molecules) @ os locus

GT (1000 molecules) @ prd locus

−

685000

690000

695000

18195000

18200000

18205000

CG6712

12080000

12085000

run

+

slp2

20570000

correlation = 0.34; mean squared error = 0.805

3820000

tll

+

−

20565000

chr3R
occupancy

slp1

+

−

12095000

GT (1000 molecules) @ tll locus
correlation = 0.57; mean squared error = 0.251

occupancy

occupancy

chr2L

12090000
DNA position

GT (1000 molecules) @ slp locus
correlation = 0.22; mean squared error = 1.2

DNA position

prd

DNA position

GT (1000 molecules) @ run locus

20560000

CG5325

−

os

DNA position

chrX

correlation = 0.44; mean squared error = 0.438

CG14947
+

+

−

680000

chr2L

3612000

occupancy

correlation = 0.82; mean squared error = 0.146

occupancy

occupancy

chrX

opa

+

180000

occupancy

occupancy

occupancy

20690000

176000

DNA position

correlation = 0.35; mean squared error = 0.724

20555000

174000

GT (1000 molecules) @ odd locus
correlation = 0.75; mean squared error = 0.234

−

chr3R

20550000

172000

DNA position

+
kni

675000

hkb

170000

GT (1000 molecules) @ oc locus
chrX

+

2696000

+

hb

4515000

correlation = 0.77; mean squared error = 1.02

2694000

correlation = 0.27; mean squared error = 2.85

DNA position

chr3L

2692000

occupancy

occupancy

occupancy

2326000

2690000

chr3R

CG8112

−

2324000
DNA position

670000

2688000

GT (1000 molecules) @ hkb locus
correlation = 0.49; mean squared error = 1.88

+
gt

20688000

2686000

DNA position

chr3R

+

20686000

2684000

GT (1000 molecules) @ hb locus
correlation = 0.73; mean squared error = 0.464

20684000

ftz

−

24405000
DNA position

chrX

−

correlation = 0.59; mean squared error = 1.48

+
fkh

5875000

DNA position

2322000

chr3R

+
−

5870000

21475000

GT (1000 molecules) @ ftz locus
correlation = 0.43; mean squared error = 0.198

occupancy

occupancy

eve

2320000

21470000
DNA position

chr3R

−

CG32797

21465000

GT (1000 molecules) @ fkh locus
correlation = 0.49; mean squared error = 1.63

−

croc

19024000

DNA position

chr2R

5865000

correlation = 0.58; mean squared error = 0.357

+
cnc

19012000

DNA position

+

chr3L

+
−

2318000

21115000

DNA position

correlation = 0.7; mean squared error = 0.238

20770000

21110000

GT (1000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.6; mean squared error = 1.1

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.48; mean squared error = 0.46

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A8: Binding profiles for Giant at all 21 loci. The grey shading represents a1ChIP-seq profile, the red line represents the prediction of the analytical model, the
yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we only displayed sites with an occupancy
higher than 5%). We considered the optimal set of parameters for Giant (1000 molecules and λ = 1.00).

HB (2000 molecules) @ D locus

HB (2000 molecules) @ H locus

HB (2000 molecules) @ Kr locus
correlation = 0.83; mean squared error = 1.62

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

HB (2000 molecules) @ cnc locus

HB (2000 molecules) @ croc locus
correlation = 0.84; mean squared error = 0.153

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

HB (2000 molecules) @ eve locus

TER94

occupancy
24400000

HB (2000 molecules) @ gt locus

24410000

24415000

24420000

2682000

2328000

2330000

−

4520000

28

HB (2000 molecules) @ kni locus

4525000

4530000

20692000

178000

chr2L

correlation = 0.72; mean squared error = 2.91

+

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

HB (2000 molecules) @ opa locus

HB (2000 molecules) @ os locus

HB (2000 molecules) @ prd locus

−

685000

690000

695000

18195000

18200000

18205000

CG6712

12080000

12085000

run

+

slp2

20570000

correlation = 0.79; mean squared error = 0.85

3820000

tll

+

−

20565000

chr3R
occupancy

slp1

+

−

12095000

HB (2000 molecules) @ tll locus
correlation = 0.64; mean squared error = 0.996

occupancy

occupancy

chr2L

12090000
DNA position

HB (2000 molecules) @ slp locus
correlation = 0.13; mean squared error = 2.42

DNA position

prd

DNA position

HB (2000 molecules) @ run locus

20560000

CG5325

−

os

DNA position

chrX

correlation = 0.57; mean squared error = 0.288

CG14947
+

+

−

680000

chr2L

3612000

occupancy

correlation = 0.82; mean squared error = 0.629

occupancy

occupancy

chrX

opa

+

180000

occupancy

occupancy

occupancy

20690000

176000

DNA position

correlation = 0.25; mean squared error = 1.8

20555000

174000

HB (2000 molecules) @ odd locus
correlation = 0.71; mean squared error = 0.056

−

chr3R

20550000

172000

DNA position

+
kni

675000

hkb

170000

HB (2000 molecules) @ oc locus
chrX

+

2696000

+

hb

4515000

correlation = 0.83; mean squared error = 5.77

2694000

correlation = 0.2; mean squared error = 0.161

DNA position

chr3L

2692000

occupancy

occupancy

occupancy

2326000

2690000

chr3R

CG8112

−

2324000
DNA position

670000

2688000

HB (2000 molecules) @ hkb locus
correlation = 0.95; mean squared error = 5.48

+
gt

20688000

2686000

DNA position

chr3R

+

20686000

2684000

HB (2000 molecules) @ hb locus
correlation = 0.89; mean squared error = 0.543

20684000

ftz

−

24405000
DNA position

chrX

−

correlation = 0.88; mean squared error = 0.564

+
fkh

5875000

DNA position

2322000

chr3R

+
−

5870000

21475000

HB (2000 molecules) @ ftz locus
correlation = 0.85; mean squared error = 0.0136

occupancy

occupancy

eve

2320000

21470000
DNA position

chr3R

−

CG32797

21465000

HB (2000 molecules) @ fkh locus
correlation = 0.8; mean squared error = 0.957

−

croc

19024000

DNA position

chr2R

5865000

correlation = 0.62; mean squared error = 0.0248

+
cnc

19012000

DNA position

+

chr3L

+
−

2318000

21115000

DNA position

correlation = 0.35; mean squared error = 2.34

20770000

21110000

HB (2000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.3; mean squared error = 19.5

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.79; mean squared error = 2.81

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A9: Binding profiles for Hunchback at all 21 loci. The grey shading represents1 a ChIP-seq profile, the red line represents the prediction of the analytical model, the
yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we only displayed sites with an occupancy
higher than 5%). We considered the optimal set of parameters for Hunchback (2000 molecules and λ = 3.00).

KR (20000 molecules) @ D locus

KR (20000 molecules) @ H locus

KR (20000 molecules) @ Kr locus
correlation = 0.77; mean squared error = 10.5

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

KR (20000 molecules) @ cnc locus

KR (20000 molecules) @ croc locus
correlation = 0.89; mean squared error = 0.326

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

KR (20000 molecules) @ eve locus

TER94

occupancy
24400000

KR (20000 molecules) @ gt locus

24410000

24415000

24420000

2682000

2328000

2330000

−

4520000

29

KR (20000 molecules) @ kni locus

4525000

4530000

20692000

178000

chr2L

correlation = 0.94; mean squared error = 19.9

+

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

KR (20000 molecules) @ opa locus

KR (20000 molecules) @ os locus

KR (20000 molecules) @ prd locus

−

685000

690000

695000

18195000

18200000

18205000

CG6712

12080000

12085000

run

+

slp2

20570000

correlation = 0.92; mean squared error = 5

3820000

tll

+

−

20565000

chr3R
occupancy

slp1

+

−

12095000

KR (20000 molecules) @ tll locus
correlation = 0.92; mean squared error = 4.43

occupancy

occupancy

chr2L

12090000
DNA position

KR (20000 molecules) @ slp locus
correlation = 0.79; mean squared error = 3.66

DNA position

prd

DNA position

KR (20000 molecules) @ run locus

20560000

CG5325

−

os

DNA position

chrX

correlation = 0.79; mean squared error = 13.1

CG14947
+

+

−

680000

chr2L

3612000

occupancy

correlation = 0.64; mean squared error = 2.22

occupancy

occupancy

chrX

opa

+

180000

occupancy

occupancy

occupancy

20690000

176000

DNA position

correlation = 0.31; mean squared error = 6.12

20555000

174000

KR (20000 molecules) @ odd locus
correlation = 0.8; mean squared error = 0.813

−

chr3R

20550000

172000

DNA position

+
kni

675000

hkb

170000

KR (20000 molecules) @ oc locus
chrX

+

2696000

+

hb

4515000

correlation = 0.54; mean squared error = 4.99

2694000

correlation = 0.28; mean squared error = 0.978

DNA position

chr3L

2692000

occupancy

occupancy

occupancy

2326000

2690000

chr3R

CG8112

−

2324000
DNA position

670000

2688000

KR (20000 molecules) @ hkb locus
correlation = 0.91; mean squared error = 1.85

+
gt

20688000

2686000

DNA position

chr3R

+

20686000

2684000

KR (20000 molecules) @ hb locus
correlation = 0.74; mean squared error = 3.37

20684000

ftz

−

24405000
DNA position

chrX

−

correlation = 0.79; mean squared error = 4.35

+
fkh

5875000

DNA position

2322000

chr3R

+
−

5870000

21475000

KR (20000 molecules) @ ftz locus
correlation = 0.85; mean squared error = 2.52

occupancy

occupancy

eve

2320000

21470000
DNA position

chr3R

−

CG32797

21465000

KR (20000 molecules) @ fkh locus
correlation = 0.47; mean squared error = 8.52

−

croc

19024000

DNA position

chr2R

5865000

correlation = 0.28; mean squared error = 1.99

+
cnc

19012000

DNA position

+

chr3L

+
−

2318000

21115000

DNA position

correlation = 0.57; mean squared error = 2.3

20770000

21110000

KR (20000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.57; mean squared error = 0.602

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.51; mean squared error = 2.54

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A10: Binding profiles for Kruppel at all 21 loci. The grey shading represents 1a ChIP-seq profile, the red line represents the prediction of the analytical model, the
yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we only displayed sites with an occupancy
higher than 5%). We considered the optimal set of parameters for Kruppel (20000 molecules and λ = 5.00).

A4.3

Including weak binding into the model

BCD
CAD
GT
HB
KR

N
2000
10000
1000
1000
2000

λ
1.25
1.25
1.00
2.50
3.00

4.40
5.03
0.85
2.40
5.46

M SE
(4.40)
(5.03)
(0.85)
(2.40)
(5.46)

0.77
0.73
0.55
0.64
0.66

ρ
(0.77)
(0.75)
(0.57)
(0.66)
(0.69)

Table A4: Set of parameters that minimises the difference between the ChIP-seq profile when including weak
binding. The analytical model includes binary DNA accessibility data (the accessibility of any site can be either
0 or 1 depending on whether the site is accessible or not). We also listed the values for the mean squared error
(M SE) and correlation (ρ). The values in the parentheses represent the minimum mean squared error and the
maximum correlation. We considered only the sites that have a PWM score higher than 30% of the distance
between the lowest and the highest score.

30

correlation (BCD)

A

correlation (CAD)

B

correlation (GT)

C

5

0.423

0.423

0.423

0.423

0.423

0.423

0.424

0.425

0.427

0.434

0.443

0.459

0.489

0.511

0.523

0.518

0.502

5

0.57

0.57

0.57

0.57

0.57

0.57

0.57

0.57

0.571

0.572

0.575

0.579

0.588

0.598

0.608

0.61

0.606

5

0.388

0.388

0.388

0.388

0.388

0.388

0.388

0.389

0.389

0.39

0.392

0.395

0.403

0.41

0.417

0.421

0.42

4.5

0.426

0.426

0.426

0.427

0.427

0.427

0.428

0.43

0.434

0.444

0.459

0.48

0.516

0.538

0.547

0.535

0.514

4.5

0.57

0.57

0.571

0.571

0.571

0.571

0.571

0.571

0.572

0.574

0.578

0.584

0.596

0.607

0.616

0.617

0.611

4.5

0.388

0.388

0.388

0.388

0.388

0.388

0.388

0.389

0.389

0.391

0.393

0.398

0.408

0.417

0.425

0.428

0.426

0.442

0.575

0.575

0.554

0.53

4

0.568

0.568

0.568

0.568

0.568

0.569

0.569

0.57

0.571

0.575

0.581

0.59

0.607

0.621

0.63

0.627

0.617

4

0.39

0.39

0.39

0.39

0.39

0.39

0.39

0.391

0.392

0.394

0.397

0.404

0.415

0.427

0.435

0.437

0.432

0.45

0.615

0.608

0.579

0.55

3.5

0.573

0.573

0.573

0.573

0.573

0.573

0.574

0.575

0.578

0.584

0.593

0.607

0.628

0.641

0.646

0.637

0.625

3.5

0.393

0.393

0.393

0.393

0.393

0.393

0.393

0.394

0.395

0.399

0.404

0.413

0.429

0.442

0.45

0.449

0.442

0.6
0.6625 0.645

0.609

0.578

3

0.578

0.579

0.579

0.579

0.579

0.579

0.581

0.582

0.586

0.598

0.613

0.634

0.659

0.67

0.668

0.652

0.636

3

0.394

0.394

0.394

0.394

0.394

0.394

0.395

0.396

0.398

0.405

0.413

0.426

0.447

0.461

0.468

0.464

0.455

4

0.442

0.442

0.442

0.442

0.443

0.445

0.448

0.454

0.47

0.49

0.518

0.558

3.5

0.452

0.452

0.452

0.452

0.453

0.454

0.458

0.464

0.476

0.503

0.535

0.57

0.607

3

0.476

0.476

0.476

0.477

0.479

0.482

0.49

0.503

0.524

0.568

0.609

0.643

0.664

2.5

0.481

0.482

0.483

0.485

0.488

0.496

0.514

0.541

0.581

0.642

0.682

0.707

0.717

0.707

0.686

0.649

0.616

2.5

0.578

0.578

0.578

0.579

0.579

0.58

0.584

0.589

0.599

0.621

0.645

0.669

0.692

0.695

0.689

0.671

0.655

2.5

0.397

0.397

0.397

0.397

0.398

0.398

0.399

0.402

0.406

0.416

0.43

0.449

0.475

0.487

0.491

0.483

0.471

2

0.551

0.553

0.555

0.56

5
0.569
0.5

0.586

0.622

0.662

0.7

0.737

0.754

0.759

0.755

0.744

0.726

0.696

0.669

2

0.593

0.594

0.594

0.595

0.596

0.599

0.607

0.62

0.639

0.672

0.695

0.713

0.72

0.721

0.717

0.699

0.68

2

0.413

0.413

0.414

0.414

0.414

0.415

0.418

0.423

0.431

0.451

0.471

0.494

0.517

0.524

0.521

0.508

0.494

1.75

0.581

0.584

0.587

0.597

0.632

0.675

0.711

0.761

0.768

0.771

0.77

0.762

0.746

0.72

0.698

1.75

0.622

0.622

0.622

0.624

0.626

0.63

0.642

0.656

0.678

0.706

0.72

0.725

0.728

0.727

0.724

0.713

1.75

0.438

0.438

0.439

0.439

0.44

0.441

0.446

0.452

0.463

0.487

0.509

0.526

0.538

0.542

0.539

0.525

0.511

0.45

0.461

0.468

0.478

0.493

0.518

0.536

0.546

0.555

0.55
0.558

0.555

0.61

7

0.4

λ

0.

λ

0.70.74

λ

0.5

6
0.

0.699

0.6
1.5

0.621

0.626

0.631

0.644

0.66

0.686

0.723

0.747

0.762

0.769

0.772

0.774

0.773

0.76

0.743

0.727

1.5

0.634

0.634

0.65

0.635

0.637

0.64

0.645

0.66

0.678

0.7

0.726

0.73

0.728

0.727

0.729

0.731

0.727

0.716

1.5

0.457

0.457

0.457

0.458

0.459

0.48

0.48

0.482

0.485

0.49

0.501

0.518

0.534

0.549

0.554

0.555

0.56

0.564

0.50.509

0.51

0.514

0.519

0.527

0.54

0.547

0.552

0.544

0.536

0.537

0.543

0.554

0.55

0.544

0.53

0.566

0.56

0.551

0.562

0.567

0.566

1.25

0.677

0.682

0.689

0.705

0.723

0.743

0.76

0.766

0.767

0.767

0.767

0.77

0.769

0.767

0.757

0.746

1.25

0.661

0.661

0.662

0.665

0.67

0.679

0.696

0.713

0.726

0.732

0.727

0.72

0.716

0.717

0.723

0.731

0.731

1.25

0.479

1

0.71

0.718

0.726

0.743

0.759

0.772

0.774

0.768

0.759

0.75

0.75

0.751

0.75

0.753

0.758

0.762

0.763

0.758

1

0.697

0.699

0.7

0.702

0.707

0.714

0.728

0.736

0.735

0.725

0.714

0.706

0.701

0.702

0.705

0.717

0.725

1

0.507

0.75

0.73

0.737

0.743

0.755

0.761

0.762

0.752

0.74

0.73

0.722

0.723

0.727

0.733

0.734

0.737

0.742

0.749

0.75

0.723

0.724

0.725

0.728

0.732

0.737

0.745

0.743

0.735

0.718

0.706

0.696

0.686

0.68

0.678

0.684

0.695

0.75

0.549

0.551

0.552

0.556

0.56

0.562

0.561

0.555

0.538

0.505

0.488

0.484

0.493

0.508

0.524

0.544

0.555

0.5

0.727

0.733

0.736

0.74

0.741

0.734

0.719

0.708

0.702

0.696

0.695

0.695

0.702

0.71

0.716

0.719

0.719

0.5

0.66

0.662

0.664

0.669

0.675

0.683

0.691

0.693

0.693

0.69

0.69

0.687

0.68

0.674

0.671

0.667

0.666

0.5

0.549

0.551

0.554

0.551

0.544

0.532

0.521

0.508

0.483

0.449

0.428

0.414

0.407

0.413

0.424

0.443

0.461

0.25

0.684

0.687

0.687

0.684

0.678

0.67

0.66

0.656

0.656

0.659

0.661

0.663

0.663

0.662

0.66

0.659

0.663

0.25

0.653

0.656

0.659

0.667

0.674

0.681

0.684

0.681

0.679

0.679

0.683

0.686

0.687

0.683

0.678

0.67

0.664

0.25

0.444

0.44

0.45

0.435

0.425

0.419

0.415

0.412

0.408

0.401

0.388

0.377

0.369

0.363

0.359

0.358

0.356

0.351

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

0.7

D

0.767

0.768

0.7

0.4

0.5

number of bound molecules

number of bound molecules

number of bound molecules

mean squared error (BCD)

mean squared error (CAD)

mean squared error (GT)

E

F

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8.1e+00 7.9e+00 7.7e+00 7.1e+00 6.5e+00 6.3e+00 1e+01 2.2e+01 4.5e+01 9.2e+01 1.3e+02

5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.9e+00 7.1e+00 7.1e+00 1.3e+01 3.5e+01 6.2e+01

5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.5e+00 6.8e+00 6.3e+00 6.9e+00 1.4e+01 3e+01 5.7e+01 1e+02 1.3e+02

4.5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.6e+00 8.3e+00 6.7e+00 8.5e+00 1.8e+01 4.5e+01 7.2e+01

4.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.1e−01 1.1e+00 3e+00

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.8e−01 8.9e−01 1.6e+00 5e+00 1.6e+01 5.3e+01 9.9e+01

1e+01 3.9e+01 8e+01

4

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8.1e+00 7.9e+00 7.7e+00 7.2e+00 6.4e+00 6.2e+00 8.4e+00 2e+01 3.9e+01 6.6e+01 1.1e+02 1.4e+02

4

4

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.2e+00 1e+00 9.2e−01 9.4e−01 2.7e+00 9e+00 2.6e+01 7.2e+01 1.2e+02

3.5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.4e+00 6.8e+00 6.1e+00 6.8e+00 1.1e+01 2.7e+01 4.7e+01 7.1e+01 1.1e+02 1.3e+02

3.5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.6e+00 8.2e+00 6.8e+00 8.2e+00 1.6e+01 3.3e+01 6.4e+01 8.6e+01

3.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.8e−01 8.9e−01 1.3e+00 5.3e+00 1.6e+01 4e+01 9.3e+01 1.4e+02

3

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.8e+00 7.3e+00 6.4e+00 1.1e+01 2.2e+01 4.1e+01 6.9e+01 8.7e+01

2.5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.7e+00 7.9e+00 6.4e+00 6.5e+00 1.4e+01 2.7e+01 4.6e+01 6.9e+01 8.4e+01

3.8

1.25

3.6

4.8

3.

2

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.7e−01 8.9e−01 1.6e+00 4.5e+00 1.2e+01 3.4e+01 6.1e+01 9.1e+01 1.3e+02 1.6e+02

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1e+00

9e−01 9.5e−01 2.4e+00 6.5e+00 1.6e+01 3.9e+01 6.4e+01 9.1e+01 1.3e+02 1.5e+02

1.5

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.6e−01 8.7e−01 1.2e+00 3.4e+00 8e+00 1.8e+01 4.1e+01 6.4e+01 8.8e+01 1.1e+02 1.4e+02

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9e−01 8.9e−01 1.3e+00 3.6e+00 8.3e+00 1.8e+01 3.8e+01 5.9e+01 7.7e+01 1e+02 1.2e+02

8.3e+00 8.3e+00 8.2e+00 8e+00 7.6e+00 7.1e+00 6.1e+00 5.2e+00 4.6e+00 5.7e+00 8e+00 1.1e+01 1.6e+01 1.9e+01 2.2e+01 2.8e+01 3.2e+01

1

1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.5e+00 8e+00 5.8e+00 5.2e+00 7.5e+00 1.5e+01 2.2e+01 2.7e+01 3.3e+01 3.7e+01

1

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 1e+00 8.5e−01 8.5e−01 1.3e+00 3.4e+00 7.6e+00 1.5e+01 3.3e+01 4.7e+01 6.4e+01 8e+01 9.4e+01

8.4e+00 8.3e+00 8.2e+00 8e+00 7.7e+00 7.3e+00 6.3e+00 5.4e+00 5.1e+00 6.5e+00 8.6e+00 1.1e+01 1.4e+01 1.6e+01 1.8e+01 2.1e+01 2.3e+01

0.75

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.3e+00 7.8e+00 5.6e+00 5.4e+00 8.3e+00 1.6e+01 2.2e+01 2.6e+01 2.9e+01 3.1e+01

0.75

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 1e+00 9.3e−01 9.9e−01 1.5e+00 3.5e+00 6.6e+00 1.2e+01 2.2e+01 3.3e+01 4.5e+01 6e+01 6.9e+01

0.5

8.4e+00 8.4e+00 8.3e+00 8.1e+00 7.8e+00 7.3e+00 6.4e+00 5.8e+00 5.8e+00 7.6e+00 9.6e+00 1.2e+01 1.3e+01 1.4e+01 1.6e+01 1.7e+01 1.9e+01

0.5

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1e+01 9.3e+00 7.6e+00 5.6e+00 6.1e+00 9.5e+00 1.7e+01 2.2e+01 2.6e+01 2.9e+01 3e+01

0.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.2e+00 1.4e+00 2.1e+00 3.8e+00 5.6e+00 8.4e+00 1.4e+01 1.9e+01 2.4e+01 3.2e+01 4e+01

0.25

8.5e+00 8.4e+00 8.3e+00 8.1e+00 7.8e+00 7.3e+00 6.4e+00 6.1e+00 6.6e+00 8.6e+00 1e+01 1.2e+01 1.4e+01 1.5e+01 1.5e+01 1.6e+01 1.6e+01

0.25

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 9.9e+00 8.6e+00 6.9e+00 5.7e+00 7e+00 1.1e+01 1.8e+01 2.2e+01 2.5e+01 2.8e+01 3e+01

0.25

1.4e+00 1.4e+00 1.4e+00 1.3e+00 1.3e+00 1.3e+00 1.5e+00 2e+00 2.8e+00 4.1e+00 4.9e+00 5.5e+00 6.4e+00 7.6e+00 9.5e+00 1.3e+01 1.6e+01

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1

10

20

50

100

200

500

2

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1

optimal parameters (CAD)

H

4.5

4.5

4.5

4

4

4

3.5

3.5

3.5

3

3

3

2.5

2.5

2.5

1.75

1.5

1.5

1.25

1.25

1.25

1

1

1

0.75

0.75

0.75

0.5

0.5

0.5

0.25

0.25

200

500

1000

2000

5000

10000

number of bound molecules

200

20000

50000

1e+05

2e+05

5e+05

1e+06

500

1000

2000

5000

10000

20000

4

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

optimal parameters (GT)

λ
1.75

1.5

100

100

2

λ

2

λ

2

1.75

50

50

I
5

20

20

4.6

number of bound molecules

5

10

10

number of bound molecules

optimal parameters (BCD)

3.8

3.

1e+06

5

1

5

4.4

4

1e+06

number of bound molecules

G

4.5

4

4

4.2

1

7e+00 1.5e+01 2.2e+01 2.9e+01 3.8e+01 4.4e+01

4.2

1.25

1

0.75

4.4

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.4e+00 8e+00 5.8e+00 5e+00

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.6e−01 9.7e−01 1.9e+00 5.8e+00 2.1e+01 4.5e+01 7.9e+01 1.3e+02 1.7e+02

1.75

5e+00 6.7e+00 1.5e+01 2.4e+01 3.4e+01 4.7e+01 5.7e+01

6

8.3e+00 8.3e+00 8.2e+00 8e+00 7.7e+00 7.2e+00 6.2e+00 5.2e+00 4.4e+00 5.2e+00 7.8e+00 1.2e+01 1.7e+01 2.3e+01 2.9e+01 3.6e+01 4e+01

2.5

4.

1.25

4.6

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.7e+00 8.3e+00 6e+00

1e+00 2.5e+00 1.1e+01 2.9e+01 5.9e+01 1.1e+02 1.6e+02

4

9e+00 6.8e+00 5.5e+00 6.8e+00 1.6e+01 2.8e+01 4.3e+01 6.2e+01 7.3e+01

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.9e+00 8.6e+00 6.3e+00 5.2e+00 6.7e+00 1.6e+01 2.7e+01 4e+01 5.6e+01 6.6e+01

8

1.5

4.

1.75

8.3e+00 8.2e+00 8.2e+00 8e+00 7.7e+00 7.2e+00 6.2e+00 5.3e+00 4.4e+00 5.1e+00 8e+00 1.3e+01 2.1e+01 2.8e+01 3.6e+01 4.4e+01 5.1e+01

4.4

8.2e+00 8.2e+00 8.2e+00 8e+00 7.8e+00 7.4e+00 6.4e+00 5.5e+00 4.7e+00 5.2e+00 8.2e+00 1.4e+01 2.4e+01 3.4e+01 4.3e+01 5.4e+01 6.4e+01

1.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9e−01

4.2

3.9

4.1

3.9

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

λ

2

1.75

3

λ

5e+01 6.5e+01 7.8e+01

λ

8.2e+00 8.2e+00 8.2e+00 8e+00 7.8e+00 7.5e+00 6.7e+00 5.8e+00 5.1e+00 5.5e+00 8.4e+00 1.5e+01 2.8e+01 4e+01

8

9e+00 7.6e+00 6.9e+00 1.1e+01 2.5e+01 5.5e+01 8e+01

4.9

4.

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7.1e+00 6.4e+00 5.8e+00 6.2e+00 9.2e+00 1.6e+01 3.2e+01 4.8e+01 6.3e+01 8.4e+01 1e+02

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

4.7

2

8e+00 1.4e+01 3.2e+01 5.1e+01 7e+01 9.8e+01 1.2e+02

5

2.5

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8.1e+00 7.9e+00 7.5e+00 7e+00 6.2e+00 6e+00

3.
8

3

4.3

3

5

4.5

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

number of bound molecules

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A11: The influence of weak binding on Bicoid, Caudal and Giant ChIP-seq profiles. We plotted heatmaps
for the correlation (A−C) and mean squared error (D−F ) between the analytical model and the ChIP-seq profile
of Bicoid (A, D), Caudal (B, E) and Giant (C, F ). The analytical model includes binary DNA accessibility data
(the accessibility of any site can be either 0 or 1 depending on whether the site is accessible or not). We
computed these values for different sets of parameters N ∈ [1, 106 ] and λ ∈ [0.25, 5]. Colour code as above.
Here, only considering sites that have a PWM score higher than 30% of the difference between the lowest and
the highest score. (G − I) We plotted the regions where the mean squared error is in the lower 12% of the range
of values (blue) and the correlation is the higher 12% of the range of values (orange). With green rectangle we
marked the optimal set of parameters in terms of mean squared error and with a black rectangle the intersection
of the parameters for which the two regions intersect.

31

correlation (HB)

A
5

0.486

4.5

0.501

4

0.486

correlation (KR)

B

0.488

0.49

0.494

0.504

0.518

0.537

0.569

0.59

0.605

0.611

0.606

0.596

0.577

0.562

5

0.454

0.454

0.454

0.454

0.456

0.458

0.463

0.47

0.484

0.512

0.538

0.564

0.585

0.587

0.577

0.555

0.533

0.501

0.502

0.503

0.506

0.512

0.526

0.543

0.565

0.595

0.613

0.623

0.624

0.617

0.605

0.586

0.571

4.5

0.471

0.471

0.472

0.473

0.475

0.479

0.489

0.503

0.523

0.556

0.58

0.6

0.613

0.608

0.595

0.569

0.546

0.516

0.517

0.518

0.521

0.526

0.534

0.553

0.573

0.595

0.622

0.634

0.64

0.636

0.626

0.613

0.594

0.58

4

0.487

0.488

0.489

0.493

0.498

0.507

0.529

0.55

0.574

0.605

0.626

0.637

0.64

0.632

0.615

0.586

0.562

3.5

0.539

0.54

0.542

0.547

0.555

0.567

0.59

0.609

0.627

0.645

0.652

0.653

0.645

0.634

0.621

0.603

0.59

3.5

0.505

0.5
0.509

0.512

0.522

0.536

0.557

0.583

0.602

0.622

0.645

0.659

0.664

0.65

0.662

0.652

0.636

0.609

0.585

3

0.561

0.568

0.577

0.588

0.603

0.60.622

0.636

0.649

0.659

0.661

0.66

0.652

0.642

0.631

0.613

0.6

3

0.529

0.542

0.554

0.576

0.594

0.608

0.626

0.643

0.66

0.676

0.682

0.684

0.677

0.668

0.654

0.633

0.614

2.5

0.56

0.566

0.572

0.584

0.597

0.611

0.628

0.639

0.648

0.654

0.656

0.656

0.654

0.648

0.64

0.626

0.614

2.5

0.561

0.596

0.6

0.611

0.628

0.634

0.642

0.653

0.66

0.665

0.672

0.674

0.678

0.676

0.672

0.665

0.654

0.643

2

0.576

0.586

0.595

0.61

0.621

0.631

0.64

0.643

0.644

0.644

0.643

0.644

0.647

0.647

0.645

0.638

0.63

2

0.642

0.675

0.68

0.684

0.686

0.69

0.689

0.687

0.681

0.67

0.662

0.655

0.654

0.658

0.66

0.655

0.651

1.75

0.596

0.607

0.613

0.622

0.629

0.636

0.641

0.642

0.642

0.638

0.635

0.634

0.637

0.641

0.643

0.641

0.637

1.75

0.656

0.676

0.678

0.679

0.681

0.681

0.678

0.674

0.665

0.654

0.643

0.634

0.628

0.632

0.639

0.645

0.644

1.5

0.618

0.629

0.635

0.641

0.644

0.646

0.645

0.642

0.637

0.631

0.625

0.621

0.623

0.628

0.633

0.637

0.637

1.5

0.687

0.687

0.686

0.688

0.688

0.687

0.682

0.676

0.668

0.651

0.636

0.624

0.61

0.608

0.612

0.621

0.63

1.25

0.616

0.627

0.631

0.634

0.633

0.633

0.631

0.628

0.627

0.622

0.617

0.61

0.605

0.607

0.613

0.622

0.627

1.25

0.667

0.668

0.669

0.671

0.672

0.671

0.667

0.665

0.657

0.64

0.623

0.605

0.585

0.576

0.573

0.576

0.582

0.65

0.65

0.5

5
0.5
0.564

6
0.

0.487

λ

λ

0.65

0.55

1

0.635

0.637

0.639

0.638

0.636

0.635

0.634

0.631

0.627

0.62

0.615

0.609

0.599

0.591

0.588

0.591

0.598

1

0.646

0.646

0.646

0.648

0.65

0.651

0.649

0.647

0.643

0.635

0.625

0.609

0.593

0.578

0.568

0.563

0.75

0.617

0.625

0.626

0.625

0.624

0.623

0.625

0.628

0.628

0.622

0.615

0.608

0.601

0.595

0.587

0.575

0.567

0.75

0.606

0.604

0.605

0.605

0.606

0.607

0.607

0.605

0.603

0.603

0.604

0.606

0.605

0.602

0.598

0.591

0.579

0.5

0.567

0.57

0.573

0.578

0.58

0.581

0.581

0.583

0.588

0.596

0.602

0.604

0.603

0.601

0.6

0.598

0.597

0.5

0.549

0.542

0.543

0.545

0.546

0.558

0.56

0.565

0.569

0.576

0.58

0.578

0.578

0.579

0.58

0.58

0.25

0.537

0.526

0.524

0.526

0.532

0.55

0.55

0.578

0.25

0.591

0.538

0.502

0.502

0.507

0.509

0.538

0.537

0.495

0.483

0.483

0.48

0.481

0.481

0.482

0.495

0.496

1

10

20

50

100

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

0.6

0.534

0.535

0.537

0.541

0.546

0.551

0.573

0.578

0.581

0.583

0.586

0.586

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

0.6

number of bound molecules

number of bound molecules

mean squared error (HB)

C

0.5

mean squared error (KR)

D

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.1e+00 2.8e+00 3.1e+00 5.5e+00 1.5e+01 2.9e+01 4.7e+01 7.1e+01 8.8e+01

5

4.5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.2e+00 2.9e+00 2.7e+00 3.7e+00 7.3e+00 1.9e+01 3.4e+01 5e+01 7.1e+01 8.5e+01

4.5

9.1e+00 9e+00

9e+00 8.9e+00 8.8e+00 8.6e+00 8.1e+00 7.5e+00 6.9e+00 6.7e+00 8.3e+00 1.3e+01 2.8e+01 4.6e+01 7.1e+01 1.1e+02 1.3e+02

4

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.3e+00 3e+00 2.7e+00 2.8e+00 4.7e+00 9.8e+00 2.3e+01 3.7e+01 5.1e+01 6.9e+01 8.1e+01

4

9.1e+00 9e+00

9e+00 8.9e+00 8.7e+00 8.4e+00 7.7e+00 7e+00 6.3e+00 6.5e+00 8.9e+00 1.5e+01 3e+01 4.7e+01 6.9e+01 1e+02 1.3e+02

3.5

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.1e+00 2.8e+00 2.5e+00 3.2e+00 6.2e+00 1.3e+01 2.6e+01 3.8e+01 5.1e+01 6.5e+01 7.5e+01

3.5

9.1e+00 9e+00 8.9e+00 8.7e+00 8.4e+00 8e+00 7.1e+00 6.3e+00 5.8e+00 6.7e+00 9.6e+00 1.6e+01 3e+01 4.5e+01 6.3e+01 9e+01 1.1e+02

3

3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 2.9e+00 2.5e+00 2.4e+00 4e+00 7.8e+00 1.5e+01 2.8e+01 3.8e+01 4.8e+01 6e+01 6.8e+01

3

9.1e+00 9e+00 8.8e+00 8.6e+00 8.2e+00 7.6e+00 6.6e+00 5.9e+00 5.5e+00 6.3e+00 9e+00 1.5e+01 2.7e+01 3.8e+01 5.2e+01 7.4e+01 9.2e+01

2.5

3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 2.7e+00 2.4e+00 2.7e+00 5.2e+00 9.2e+00 1.5e+01 2.6e+01 3.5e+01 4.3e+01 5.3e+01 5.9e+01

2.5

9.1e+00 8.9e+00 8.7e+00 8.3e+00 7.9e+00 7.2e+00 6.4e+00 5.9e+00 5.5e+00 5.7e+00 7.4e+00 1.1e+01 1.9e+01 2.8e+01 3.8e+01 5.1e+01 6.4e+01

2

9.1e+00 8.9e+00 8.7e+00 8.2e+00 7.7e+00 7.2e+00 6.8e+00 6.5e+00 6.1e+00 5.8e+00 6.2e+00 7.7e+00 1.2e+01 1.6e+01 2.2e+01 3.3e+01 3.9e+01

3.

9e+00 8.9e+00 8.8e+00 8.4e+00 8e+00 7.4e+00 6.9e+00 7.7e+00 1.1e+01 2.4e+01 4.2e+01 6.8e+01 1.1e+02 1.4e+02

8
3.

5

4.8

4.4

λ

3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 3e+00 2.6e+00 2.5e+00 3.3e+00 6.4e+00 9.9e+00 1.4e+01 2.2e+01 2.8e+01 3.6e+01 4.4e+01 5e+01

λ

2

4.
8

9.1e+00 9.1e+00 9e+00

4.6

4

5

4.6

1.75

3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 3e+00 2.6e+00 2.7e+00 3.7e+00 6.9e+00 1e+01 1.4e+01 2e+01 2.5e+01 3e+01 3.9e+01 4.4e+01

1.75

9.1e+00 8.9e+00 8.6e+00 8.1e+00 7.7e+00 7.4e+00 7.1e+00 7e+00 6.7e+00 6.2e+00 6.2e+00 6.8e+00 9.5e+00 1.3e+01 1.6e+01 2.2e+01 2.8e+01

1.5

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.6e+00 2.9e+00 4e+00 7.2e+00 1e+01 1.3e+01 1.7e+01 2.1e+01 2.5e+01 3.1e+01 3.8e+01

1.5

9.1e+00 8.9e+00 8.6e+00 8.1e+00 7.8e+00 7.5e+00 7.5e+00 7.5e+00 7.3e+00 6.9e+00 6.6e+00 6.6e+00 7.7e+00 9.5e+00 1.2e+01 1.6e+01 1.8e+01

1.25

4
2e+01 2.5e+01 2.9e+01

1.25

9.2e+00 8.8e+00 8.6e+00 8.1e+00 7.8e+00 7.7e+00 7.7e+00 7.8e+00 7.8e+00 7.7e+00 7.4e+00 7.1e+00 7e+00 7.5e+00 8.9e+00 1.2e+01 1.4e+01

1

0.75

0.5

0.25

4.

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.7e+00 3.1e+00 4.2e+00 7.1e+00 9.7e+00 1.2e+01 1.5e+01 1.8e+01

4.2

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.8e+00 3.2e+00 4.3e+00 6.7e+00 9.1e+00 1.1e+01 1.4e+01 1.6e+01 1.7e+01 2e+01 2.2e+01

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 3e+00

1

3e+00 3.4e+00 4.2e+00 6e+00 7.8e+00 9.8e+00 1.2e+01 1.4e+01 1.5e+01 1.7e+01 1.7e+01

3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.3e+00 3.2e+00 3.3e+00 3.6e+00 4.1e+00 5e+00

6e+00 7.2e+00 9.1e+00 1.1e+01 1.2e+01 1.3e+01 1.4e+01

3.6

4

3.8

3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.4e+00 3.4e+00 3.7e+00 4.1e+00 4.5e+00 4.7e+00 4.8e+00 5e+00 5.8e+00 6.4e+00 6.9e+00 7.4e+00 7.8e+00

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

4.

2

4

9.2e+00 8.8e+00 8.5e+00 8.1e+00 7.9e+00 7.8e+00 7.9e+00 8.1e+00 8.1e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7.4e+00 7.3e+00 7.8e+00 9e+00

0.75

9.2e+00 8.8e+00 8.5e+00 8.1e+00 7.9e+00 7.9e+00 8.1e+00 8.2e+00 8.3e+00 8.4e+00 8.4e+00 8.4e+00 8.5e+00 8.5e+00 8.5e+00 8.2e+00 7.9e+00

0.5

9.2e+00 8.8e+00 8.5e+00 8.1e+00 8e+00 8.1e+00 8.2e+00 8.3e+00 8.3e+00 8.4e+00 8.5e+00 8.5e+00 8.6e+00 8.6e+00 8.5e+00 8.5e+00 8.6e+00

0.25

9.2e+00 8.8e+00 8.5e+00 8.2e+00 8.1e+00 8.2e+00 8.4e+00 8.5e+00 8.6e+00 8.7e+00 8.7e+00 8.6e+00 8.5e+00 8.5e+00 8.5e+00 8.6e+00 8.6e+00

1e+06

1

10

20

50

100

200

number of bound molecules

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

optimal parameters (HB)

E

500

optimal parameters (KR)

F

5

5

4.5

4.5

4

4

3.5

3.5

3

3

2.5

2.5

λ

2

λ

2

1.75

1.75

1.5

1.5

1.25

1.25

1

1

0.75

0.75

0.5

0.5

0.25

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

number of bound molecules

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A12: The influence of weak binding on Hunchback and Kruppel ChIP-seq profiles. We plotted heatmaps
for the correlation (A) and (B) and mean squared error (C) and (D) between the analytical model and the ChIPseq profile of Hunchback (A, C) and Kruppel (B, D). The analytical model includes binary DNA accessibility
data (the accessibility of any site can be either 0 or 1 depending on whether the site is accessible or not). We
computed these values for different sets of parameters: N ∈ [1, 106 ] and λ ∈ [0.25, 5]. Colour code as above.
PWM filtering as in Figure A11. (E, F ) We plotted the regions where the mean squared error is in the lower
12% of the range of values (blue) and the correlation is the higher 12% of the range of values (orange). With
green rectangle we marked the optimal set of parameters in terms of mean squared error and with a black
rectangle the intersection of the parameters for which the two regions intersect.

32

A4.4

Continuous DNA accessibility data

BCD
CAD
GT
HB
KR

N
500
2000
200
1000
5000

λ
1.25
0.75
1.00
3.50
5.00

4.47
5.35
0.83
2.38
4.81

M SE
(4.47)
(5.35)
(0.83)
(2.38)
(4.81)

0.77
0.72
0.54
0.65
0.68

ρ
(0.78)
(0.75)
(0.57)
(0.66)
(0.69)

Table A5: Set of parameters that minimises the difference between the ChIP-seq profile in the case of continous
accessibility data. The analytical model includes continous DNA accessibility data by using equation (A9) to
compute the probability that a site is accessible. We also listed the values for the mean squared error (M SE)
and correlation (ρ). The values in the parentheses represent the minimum mean squared error and the maximum
correlation. We considered only the sites that have a PWM score higher than 70% of the distance between the
lowest and the highest score.

33

correlation (BCD)

A

correlation (CAD)

B

5

0.509

0.509

0.51

0.511

0.513

0.517

0.527

0.542

0.566

0.607

0.635

0.65

0.647

0.63

0.606

0.572

0.55

5

0.581

0.581

0.581

0.581

0.581

0.582

0.584

0.587

0.592

0.605

0.62

0.635

0.647

0.647

0.639

0.622

0.61

4.5

0.509

0.51

0.51

0.512

0.514

0.52

0.534

0.554

0.584

0.63

0.657

0.668

0.658

0.637

0.609

0.573

0.551

4.5

0.581

0.581

0.581

0.581

0.582

0.582

0.585

0.589

0.596

0.613

0.63

0.646

0.656

0.654

0.644

0.624

0.611

4

0.509

0.51

0.511

0.513

0.517

0.525

0.545

0.572

0.608

0.657

0.68

0.686

0.669

0.643

0.614

0.576

0.553

4

0.581

0.581

0.581

0.581

0.582

0.583

0.587

0.592

0.602

0.623

0.642

0.659

0.667

0.661

0.648

0.627

0.612

3.5

0.509

0.51

0.511

0.515

0.521

0.532

0.561

0.596

0.639

0.687

0.704

0.703

0.68

0.652

0.62

0.581

0.557

3.5

0.581

0.581

0.581

0.582

0.583

0.584

0.589

0.597

0.61

0.636

0.658

0.673

0.678

0.669

0.654

0.631

0.615

3

0.509

0.511

0.513

0.519

0.528

0.545

0.585

0.628

0.674

0.715

0.726

0.72

0.694

0.665

0.633

0.592

0.566

3

0.581

0.581

0.581

0.582

0.583

0.586

0.594

0.605

0.622

0.654

0.676

0.689

0.69

0.679

0.663

0.637

0.621

2.5

0.509

0.512

0.515

0.524

0.538

0.562

0.615

0.664

0.707

0.739

0.745

0.737

0.712

0.685

0.655

2.5

0.58

0.581

0.581

0.583

0.585

0.589

0.599

0.615

0.638

0.672

0.693

0.703

0.703

0.692

0.676

0.649

0.631

2

0.552

0.559
0.55

0.565

0.584

0.608

0.643

0.695

0.726

0.749

0.761

0.761

0.754

0.735

0.715

0. 0.6140.60.585
65

0.69

0.653

0.624

2

0.593

0.594

0.595

0.597

0.601

0.61

0.629

0.65

0.676

0.704

0.715

0.717

0.716

0.709

0.696

0.671

0.652

1.75

0.582

0.593

0.603

0.628

0.658

0.695

0.736

0.756

0.765

0.771

0.772

0.766

0.749

0.731

0.712

0.681

0.655

1.75

0.622

0.623

0.624

0.628

0.634

0.644

0.667

0.692

0.71

0.724

0.726

0.728

0.726

0.719

0.708

0.687

0.669

1.5

0.623

0.638

0.651

0.681

0.708

0.736

0.759

0.768

0.771

0.774

0.774

0.772

0.761

0.75

0.735

0.711

0.69

1.5

0.634

0.635

0.637

0.642

0.65

0.663

0.69

0.713

0.728

0.729

0.727

0.728

0.73

0.73

0.724

0.707

0.69

0.666

0.675

0.685

0.7

0.722

0.731

0.73

0.724

0.717

0.716

0.721

0.727

0.731

0.727

0.717

0.70.703

0.6

λ

λ

0.6

0.65

1.25

0.678

0.698

0.713

0.7

0.74

0.756

0.765

0.768

0.768

0.767

0.767

0.768

0.77

0.768

0.761

0.752

0.737

0.724

0.75

0.65

1.25

0.661

0.663

1

0.712

0.736

0.751

0.77

0.776

0.772

0.76

0.753

0.751

0.751

0.752

0.757

0.761

0.763

0.761

0.753

0.744

1

0.698

0.701

0.75

0.732

0.75

0.759

0.763

0.757

0.746

0.731

0.724

0.722

0.726

0.731

0.733

0.736

0.74

0.747

0.753

0.754

0.75

0.724

0.726

0.5

0.729

0.739

0.74

0.736

0.725

0.713

0.703

0.698

0.696

0.695

0.699

0.706

0.715

0.718

0.719

0.72

0.721

0.5

0.661

0.25

0.685

0.685

0.681

0.672

0.664

0.658

0.656

0.658

0.66

0.663

0.663

0.663

0.66

0.659

0.66

0.669

0.678

0.25

0.654

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

C

0.7

0.711

0.72

0.73

0.737

0.731

0.723

0.709

0.705

0.701

0.703

0.709

0.719

0.728

0.73

0.729

0.735

0.743

0.745

0.739

0.728

0.715

0.701

0.691

0.684

0.678

0.68

0.687

0.703

0.715

0.666

0.67

0.679

0.687

0.692

0.693

0.692

0.69

0.689

0.684

0.679

0.673

0.669

0.667

0.667

0.669

0.662

0.668

0.678

0.683

0.684

0.68

0.678

0.68

0.685

0.687

0.686

0.681

0.675

0.669

0.662

0.658

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

0.7

number of bound molecules

number of bound molecules

mean squared error (BCD)

mean squared error (CAD)

D

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.6e+00 8.3e+00 6.7e+00 7.1e+00 1.4e+01 3e+01 5.8e+01 7.7e+01

4.5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.6e+00 7.1e+00 6.4e+00 5.4e+00 5.9e+00 1.1e+01 2.9e+01 5.2e+01 7.8e+01 1.1e+02 1.3e+02

4.5

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.1e+00 7.5e+00 6.2e+00 8.8e+00 1.9e+01 3.8e+01 6.6e+01 8.2e+01

4

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.3e+00 6.7e+00 5.8e+00 5.3e+00 7.5e+00 1.5e+01 3.8e+01 6.1e+01 8.5e+01 1.1e+02 1.3e+02

4

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.3e+00 6.7e+00 6.1e+00 1.2e+01 2.6e+01 4.7e+01 7.3e+01 8.6e+01

3.5

8.2e+00 8.2e+00 8.2e+00 8.1e+00 7.9e+00 7.6e+00 6.9e+00 6.1e+00 5.3e+00 6.1e+00 1.1e+01 2.2e+01 4.6e+01 6.8e+01 9e+01 1.1e+02 1.3e+02

3.5

3

8.2e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7.3e+00 6.3e+00 5.5e+00 5.3e+00 8.1e+00 1.5e+01 2.9e+01 5.1e+01 7e+01 8.9e+01 1.1e+02 1.2e+02

3

2.5

8.2e+00 8.1e+00 8e+00 7.8e+00 7.4e+00 6.8e+00 5.7e+00 5.3e+00 6e+00 1.1e+01 2e+01 3.3e+01 5.1e+01 6.6e+01 8.2e+01 1e+02 1.2e+02

2.5

2

8.2e+00 8.1e+00 8e+00 7.6e+00 7e+00 6.2e+00 5.1e+00 5e+00 6.6e+00 1.3e+01 2.2e+01 3.3e+01 4.6e+01 5.5e+01 6.7e+01 8.4e+01 9.7e+01

1.75

1.5

1.25

4.1

3.9

7e+00 1.8e+01 3.5e+01 5.5e+01 7.8e+01 8.9e+01

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.8e+00 8.5e+00 6.4e+00 6e+00 9.6e+00 2.5e+01 4.3e+01 6.1e+01 8.2e+01 9.1e+01

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

3.9

5

3.
8

3.

1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.4e+00 7.4e+00 6e+00

4.9

5

4.7

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.4e+00 6.8e+00 5.7e+00 5.4e+00 7.6e+00 2.1e+01 4.2e+01 6.9e+01 1e+02 1.2e+02

8

5

9e+00 7.4e+00 5.8e+00 7.3e+00 1.4e+01 3.2e+01 4.8e+01 6.4e+01 8.1e+01 9e+01

8.2e+00 8.1e+00 7.9e+00 7.4e+00 6.8e+00 5.9e+00 4.8e+00 4.7e+00 6.4e+00 1.3e+01 2e+01 2.9e+01 4.1e+01 4.9e+01 5.8e+01 7.2e+01 8.3e+01

1.75

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.2e+00 7.7e+00 6e+00 5.5e+00 9.6e+00 1.8e+01 3.4e+01 4.7e+01 5.8e+01 7e+01 7.7e+01

8.3e+00 8.1e+00 7.9e+00 7.3e+00 6.6e+00 5.7e+00 4.5e+00 4.5e+00 6.4e+00 1.2e+01 1.7e+01 2.5e+01 3.5e+01 4.1e+01 4.7e+01 5.8e+01 6.7e+01

1.5

8.3e+00 8.1e+00 7.8e+00 7.3e+00 6.6e+00 5.6e+00 4.5e+00 4.6e+00 6.3e+00 1.1e+01 1.5e+01 2e+01 2.8e+01 3.4e+01 3.8e+01 4.4e+01 5e+01

1.25

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.7e+00 7.1e+00 5.5e+00 5.7e+00 9.7e+00 1.7e+01 2.6e+01 3.3e+01 4e+01 4.9e+01 5.7e+01

λ

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.5e+00 8.1e+00 6.4e+00 5.7e+00 9.4e+00 1.9e+01 3.6e+01 5e+01 6.2e+01 7.5e+01 8.3e+01

λ

2

4.6

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

4.3

4.8

4.

8

4.

9e+00 7.3e+00 5.6e+00 5.5e+00 9.2e+00 1.7e+01 3e+01 3.9e+01 5e+01 6.2e+01 7.1e+01

6

8.3e+00 8.1e+00 7.8e+00 7.2e+00 6.5e+00 5.6e+00 4.6e+00 5e+00 6.8e+00 1.1e+01 1.4e+01 1.7e+01 2.2e+01 2.6e+01 3.1e+01 3.5e+01 3.8e+01

1

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.7e+00 7.1e+00 5.5e+00 6.1e+00 1e+01 1.6e+01 2.5e+01 2.9e+01 3.4e+01 3.9e+01 4.3e+01

8.4e+00 8.1e+00 7.9e+00 7.3e+00 6.7e+00 5.8e+00 5.1e+00 5.8e+00 7.6e+00 1.1e+01 1.3e+01 1.5e+01 1.8e+01 2e+01 2.2e+01 2.6e+01 2.9e+01

0.75

1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 8.6e+00 6.8e+00 5.3e+00 6.5e+00 1.1e+01 1.7e+01 2.4e+01 2.8e+01 3e+01 3.2e+01 3.4e+01

0.5

8.4e+00 8.2e+00 8e+00 7.4e+00 6.8e+00 6e+00 5.8e+00 6.8e+00 8.6e+00 1.1e+01 1.3e+01 1.4e+01 1.5e+01 1.7e+01 1.8e+01 2e+01 2.1e+01

0.5

1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 8.4e+00 6.7e+00 5.5e+00 7.6e+00 1.2e+01 1.8e+01 2.5e+01 2.8e+01 3e+01 3.1e+01 3.1e+01

0.25

8.4e+00 8.2e+00 7.9e+00 7.4e+00 6.7e+00 6.2e+00 6.5e+00 7.7e+00 9.5e+00 1.2e+01 1.3e+01 1.4e+01 1.5e+01 1.6e+01 1.6e+01 1.6e+01 1.6e+01

0.25

1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 9.6e+00 7.7e+00 6.1e+00 5.8e+00 8.8e+00 1.4e+01 1.9e+01 2.4e+01 2.7e+01 2.9e+01 3e+01 3.1e+01

1

10

20

50

100

200

500

2000

4

4

1000

4.2

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

number of bound molecules

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

optimal parameters (BCD)

E

500

4.5

4.4

8

3.

4

4.4

4.2

1

0.75

optimal parameters (CAD)

F

5

5

4.5

4.5

4

4

3.5

3.5

3

3

2.5

2.5

λ

2

λ

2

1.75

1.75

1.5

1.5

1.25

1.25

1

1

0.75

0.75

0.5

0.5

0.25

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

number of bound molecules

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A13: Estimating the Bicoid and Caudal ChIP-seq profiles when assuming non-binary accessibility data.
We plotted heatmaps for the correlation (A) and (B) and mean squared error (C) and (D) between the analytical
model and the ChIP-seq profile of Bicoid (A, C) and Caudal (B, D). The analytical model includes non-binary
DNA accessibility data, by using equation (A9) to compute the probability that a site is accessible. We computed
these values for different sets of parameters: N ∈ [1, 106 ] and λ ∈ [0.25, 5]. Colour code as above. We considered
only the sites that have a PWM score higher than 70% of the difference between the lowest and the highest
score. (E, F ) We plotted the regions where the mean squared error is in the lower 12% of the range of values
(blue) and the correlation is the higher 12% of the range of values (orange). With green rectangle we marked
the optimal set of parameters in terms of mean squared error and with a black rectangle the intersection of the
parameters for which the two regions intersect.

34

correlation (GT)

A
0.421

0.422

0.422

0.423

0.425

0.429

0.437

0.446

0.455

0.463

4.5

0.421

0.421

0.421

0.421

0.422

0.422

0.424

0.426

0.431

0.441

0.451

0.461

4

0.421

0.421

0.421

0.422

0.422

0.423

0.425

0.428

0.434

0.446

0.458

0.47

3.5

0.421

0.421

0.421

0.422

0.422

0.423

0.426

0.43

0.438

0.454

0.468

3

0.421

0.421

0.421

0.422

0.423

0.424

0.428

0.434

0.444

0.464

0.481

2.5

0.421

0.421

0.422

0.422

0.423

0.425

0.431

0.44

0.454

0.479

0.498

2

0.421

0.421

0.421

0.422

0.424

0.427

0.436

0.448

0.467

0.497

0.462

0.453

0.445

5

0.556

0.558

0.561

0.569

0.579

0.593

0.615

0.629

0.637

0.641

0.639

0.633

0.62

0.469

0.47

0.466

0.456

0.447

4.5

0.556

0.559

0.563

0.573

0.586

0.603

0.626

0.638

0.645

0.647

0.644

0.637

0.477

0.477

0.471

0.459

0.449

4

0.556

0.561

0.566

0.579

0.595

0.614

0.636

0.647

0.652

0.652

0.649

0.641

0.48

0.487

0.485

0.477

0.463

0.452

3.5

0.556

0.564

0.571

0.588

0.605

0.625

0.645

0.654

0.657

0.656

0.653

0.494

0.499

0.495

0.485

0.468

0.456

3

0.557

0.568

0.578

0.598

0.616

0.634

0.651

0.657

0.658

0.657

0.655

0.511

0.514

0.507

0.496

0.477

0.463

2.5

0.567

0.581

0.592

0.61

0.625

0.638

0.651

0.654

0.654

0.653

0.517

0.529

0.531

0.524

0.512

0.493

0.477

2

0.579

0.6

0.612

0.626

0.635

0.641

0.645

0.645

0.644

1.75

0.44

0.441

0.442

0.443

0.446

0.451

0.462

0.478

0.498

1.5

0.456

0.45
0.457

0.458

0.46

0.465

0.47

0.487

0.505

0.525

0.524

0.534

0.542

0.542

0.535

0.524

0.505

0.489

1.75

0.599

0.616

0.623

0.631

0.638

0.642

0.642

0.641

0.543

0.551

0.556

0.557

0.551

0.54

0.521

0.505

1.5

0.621

0.637

0.641

0.645

0.646

0.645

0.64

0.636

1.25

0.479

0.481

0.483

0.488

0.495

0.506

0.528

0.543

0.551

0.555

0.557

0.561

0.565

0.564

0.557

0.543

0.529

1.25

0.62

0.632

0.634

0.633

0.633

0.631

0.627

0.524

0.534

0.543

0.551

5
0.5
0.561

0.563

0.56

0.543

0.527

0.515

0.45
0.413

1

0.508

0.512

0.515

0.549

0.554

0.558

0.548

0.541

0.537

0.538

0.546

0.56

0.566

0.568

0.563

0.555

1

0.635

0.639

0.637

0.635

0.635

0.634

0.521

0.496

0.483

0.486

0.498

0.519

0.535

0.549

0.56

0.564

0.55

0.75

0.62

0.626

0.625

0.623

0.623

0.626

0.5

0.551

0.554

0.547

0.535

0.49

0.462

0.439

0.417

0.408

0.408

0.42

0.434

0.45

0.476

0.496

0.5

0.567

0.575

0.578

0.581

0.581

0.581

0.25

0.443

0.429

0.422

0.415

1

10

20

50

0.5

100

0.41

0.403

0.393

0.383

0.371

0.363

0.361

0.358

0.358

0.354

0.348

0.347

0.25

0.532

0.526

0.526

0.533

0.55

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

0.5

0.4

6
0.

0.608

0.596

0.581

0.572

5

0.61

0.617

0.624

0.623

0.61

0.597

0.582

0.573

4.5

0.611

0.622

0.633

0.626

0.613

0.6

0.585

0.575

4

0.612

0.632

0.648

0.

0.645

0.631

0.618

0.605

0.589

0.579

3.5

0.615

0.648

0.649

0.637

0.625

0.612

0.596

0.586

3

0.62

0.667

0.653

0.651

0.644

0.635

0.624

0.609

0.598

2.5

0.632

0.642

0.644

0.647

0.647

0.643

0.637

0.626

0.617

2

0.638

0.634

0.635

0.638

0.642

0.643

0.64

0.635

0.628

0.63

0.623

0.621

0.623

0.63

0.634

0.637

0.637

0.635

0.626

0.622

0.615

0.608

0.605

0.609

0.615

0.622

0.628

0.631

0.63

0.625

0.619

0.613

0.606

0.598

0.588

0.588

0.591

0.601

0.629

0.627

0.622

0.612

0.606

0.601

0.593

0.584

0.574

0.566

0.584

0.59

0.597

0.603

0.604

0.603

0.6

0.599

0.598

0.595

0.65

0.64

0.657

0.674

0.655

0.673

0.672

0.685

0.666

0.685

0.681

0.691

0.681

0.688

0.665

0.684

1.75

0.675

1.5

0.675

1.25

0.609

0.565

0.592

0.6

0.687

0.688

0.685

0.681

0.677

0.67

0.656

0.644

0.634

0.623

0.617

0.685

0.69

0.686

0.681

0.676

0.673

0.666

0.652

0.641

0.632

0.622

0.616

0.691

0.687

0.68

0.674

0.67

0.668

0.661

0.648

0.639

0.63

0.621

0.616

0.691

0.69

0.679

0.669

0.664

0.662

0.661

0.656

0.646

0.638

0.63

0.621

0.616

0.691

0.684

0.667

0.655

0.65

0.651

0.653

0.651

0.643

0.637

0.631

0.623

0.618

0.691

0.687

0.675

0.653

0.64

0.633

0.635

0.64

0.643

0.64

0.637

0.633

0.627

0.622

0.686

0.688

0.684

0.673

0.648

0.629

0.617

0.612

0.616

0.622

0.629

0.631

0.63

0.629

0.628

0.683

0.684

0.684

0.681

0.674

0.653

0.633

0.615

0.603

0.601

0.674

0.675

0.674

0.67

0.664

0.652

0.636

0.619

0.601

0.669

0.672

0.673

0.672

0.669

0.667

0.658

0.645

0.628

1

0.643

0.645

0.647

0.65
0.649

0.648

0.647

0.644

0.641

0.75

0.604

0.605

0.606

0.607

0.607

0.605

0.603

0.602

0.5

0.541

0.545

0.546

0.559

0.56

0.565

0.57

0.25

0.539

0.502

0.507

0.509

0.538

0.537

1

10

20

50

100

200

65

0.605

0.615

0.621

0.623

0.624

0.625

0.592

0.589

0.593

0.6

0.608

0.615

0.616

0.604

0.589

0.579

0.575

0.576

0.58

0.59

0.599

0.634

0.62

0.609

0.593

0.573

0.567

0.561

0.559

0.56

0.604

0.606

0.605

0.602

0.596

0.591

0.579

0.561

0.551

0.577

0.573

0.578

0.578

0.578

0.579

0.58

0.58

0.579

0.575

0.495

0.483

0.483

0.48

0.481

0.481

0.482

0.495

0.496

0.495

0.495

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

2e+01

3e+01 3.9e+01 4.8e+01 5.2e+01

6

0.
6

0.534

0.536

0.539

0.542

0.547

0.57

0.575

0.578

0.582

0.584

0.586

0.585

0.583

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

number of bound molecules

mean squared error (GT)

D

correlation (KR)

C

0.464

λ

0.421

λ

0.421

λ

0.421

0.75

correlation (HB)

B

5

0.55

0.5

number of bound molecules

mean squared error (HB)

E

0.

mean squared error (KR)

F

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.4e−01 8.6e−01 1.3e+00 5.8e+00 1.8e+01 4.5e+01 1e+02 1.4e+02

5

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.3e+00 2.9e+00 2.6e+00 2.9e+00 5.8e+00 1.3e+01 2.8e+01 4.2e+01 5.4e+01 6.6e+01 7.3e+01

5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 8.9e−01 9.2e−01 1.9e+00 9.4e+00 2.7e+01 5.9e+01 1.2e+02 1.6e+02

4.5

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.1e+00 2.7e+00 2.4e+00 3.7e+00 8.2e+00 1.7e+01 3.3e+01 4.6e+01 5.7e+01 6.7e+01 7.3e+01

4.5

9.2e+00 9.1e+00 9e+00 8.9e+00 8.7e+00 8.3e+00 7.4e+00 6.4e+00 5.4e+00 4.9e+00 6.7e+00 1.2e+01 2.4e+01 3.4e+01 4.2e+01 5e+01 5.3e+01

4

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 8.5e−01 1.2e+00 3.4e+00 1.6e+01 3.9e+01 7.7e+01 1.3e+02 1.7e+02

4

3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 2.9e+00 2.5e+00 2.5e+00 5.3e+00 1.1e+01 2.1e+01 3.7e+01 4.9e+01 5.9e+01 6.8e+01 7.3e+01

4

9.2e+00 9.1e+00 9.1e+00 9e+00 8.8e+00 8.6e+00 7.9e+00 7.1e+00 6e+00 4.8e+00 5.4e+00 9e+00

9.1e+00 9.1e+00 9e+00 8.7e+00 8.4e+00 7.8e+00 6.7e+00 5.7e+00 5e+00 5.6e+00 8.8e+00 1.6e+01 2.8e+01 3.7e+01 4.4e+01 5.1e+01 5.4e+01

3.5

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.2e−01 9.4e−01 2e+00 6.5e+00 2.6e+01 5.6e+01 9.7e+01 1.5e+02 1.8e+02

3.5

3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.4e+00 3.1e+00 2.6e+00 2.4e+00 3e+00 7.4e+00 1.5e+01 2.5e+01 3.9e+01 5e+01 5.8e+01 6.7e+01 7.2e+01

3.5

9.1e+00 9e+00 8.8e+00 8.4e+00 7.9e+00 7.2e+00 6.1e+00 5.3e+00 5e+00 6.8e+00 1.1e+01 1.9e+01 3.1e+01 3.8e+01 4.5e+01 5.1e+01 5.4e+01

1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.8e−01 8.8e−01 1.4e+00 3.4e+00 1.2e+01 2.6e+01 4.7e+01 8.2e+01 1.1e+02 1.3e+02 1.6e+02 1.8e+02

4.8

3.8e+00 3.7e+00 3.6e+00 3.3e+00 3e+00 2.7e+00 2.4e+00 3.1e+00 5.4e+00 1.1e+01 1.8e+01 2.6e+01 3.7e+01 4.5e+01 5.1e+01 5.9e+01 6.4e+01

2

3.8e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.6e+00 2.7e+00 4e+00 6.6e+00 1.2e+01 1.6e+01 2.2e+01 3.1e+01 3.9e+01 4.4e+01 5.1e+01 5.5e+01

4.8

4.

6

1.5

1.25

3.8e+00 3.6e+00 3.5e+00 3.1e+00 2.8e+00 2.6e+00 3.2e+00 4.7e+00 7.3e+00 1.1e+01 1.4e+01 1.7e+01 2.2e+01 2.7e+01 3.2e+01 4e+01 4.4e+01

1.5

9e+00 8.2e+00 7.8e+00 7.5e+00 7.5e+00 7.5e+00 7.3e+00 7e+00 6.7e+00 6.6e+00 7.4e+00 9e+00 1.3e+01 1.5e+01 1.7e+01 2.2e+01 2.8e+01

3.8e+00 3.6e+00 3.5e+00 3.1e+00 2.8e+00 2.7e+00 3.4e+00 4.9e+00 7.3e+00 1.1e+01 1.3e+01 1.6e+01 1.9e+01 2.2e+01 2.5e+01 3e+01 3.6e+01

1.25

9e+00 8.2e+00 7.9e+00 7.7e+00 7.7e+00 7.8e+00 7.8e+00 7.7e+00 7.4e+00 7.1e+00 6.9e+00 7.3e+00 9.1e+00 1.1e+01 1.4e+01 1.6e+01 1.7e+01

4.
2.3e+0142.6e+01

1

9e+00 8.1e+00 7.9e+00 7.8e+00 7.9e+00 8e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.5e+00 7.3e+00 7.7e+00 8.8e+00 1.1e+01 1.3e+01

3e+00 3.6e+00 4.6e+00 6.1e+00 8.6e+00 1.1e+01 1.2e+01 1.4e+01 1.6e+01 1.7e+01 1.8e+01 1.9e+01

0.75

9e+00 8.1e+00 7.9e+00 8e+00 8.1e+00 8.2e+00 8.3e+00 8.4e+00 8.4e+00 8.4e+00 8.4e+00 8.5e+00 8.4e+00 8.2e+00 7.9e+00 7.7e+00 7.9e+00

0.5

9e+00 8.1e+00 8e+00 8.1e+00 8.2e+00 8.3e+00 8.3e+00 8.4e+00 8.5e+00 8.6e+00 8.6e+00 8.6e+00 8.5e+00 8.5e+00 8.6e+00 8.8e+00 9e+00

0.25

9e+00 8.2e+00 8.1e+00 8.2e+00 8.4e+00 8.5e+00 8.7e+00 8.7e+00 8.7e+00 8.6e+00 8.5e+00 8.5e+00 8.5e+00 8.6e+00 8.6e+00 8.6e+00 8.6e+00

1e+02 1.2e+02 1.5e+02 1.6e+02

1.5

1.25

1

1

1.3e+00 1.2e+00 1.2e+00 1e+00 9.2e−01 8.3e−01 1.1e+00 2e+00 4.6e+00 1.2e+01 2.4e+01 3.8e+01 5.9e+01 7.2e+01 8.5e+01 1e+02 1.1e+02

0.75

1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.8e−01 9.2e−01 1.3e+00 2.3e+00 4.5e+00 1e+01 1.7e+01 2.6e+01 4.2e+01 5.4e+01 6.4e+01 7.3e+01 8.3e+01

0.5

1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1.2e+00 1.9e+00 3e+00 4.5e+00 7.6e+00 1.1e+01 1.6e+01 2.3e+01 2.8e+01 3.5e+01 4.7e+01 5.3e+01

0.25

1.4e+00 1.3e+00 1.3e+00 1.3e+00 1.4e+00 1.6e+00 2.6e+00 3.6e+00 4.5e+00 5.3e+00 5.9e+00 6.9e+00 9e+00 1.1e+01 1.4e+01 1.8e+01 2.1e+01

5

4.6

3.
2

4.2

1

10

20

50

100

200

3.8

500

1000

2000

5000

10000

20000

50000

0.75

4.4

4

1e+05

2e+05

5e+05

3.8e+00 3.6e+00 3.4e+00 3.1e+00 2.9e+00 2.8e+00 3.5e+00 4.9e+00 6.9e+00 1e+01 1.2e+01 1.4e+01 1.6e+01 1.8e+01 2e+01

3.8e+00 3.6e+00 3.4e+00 3.1e+00 3e+00

4.2

0.5

3.8e+00 3.6e+00 3.5e+00 3.2e+00 3.2e+00 3.3e+00 3.8e+00 4.3e+00 5.1e+00 6.4e+00 7.7e+00 9.2e+00 1.1e+01 1.2e+01 1.3e+01 1.5e+01 1.6e+01

0.25

3.8e+00 3.6e+00 3.5e+00 3.4e+00 3.4e+00 3.7e+00 4.3e+00 4.6e+00 4.7e+00 4.9e+00 5.2e+00 5.8e+00 6.6e+00 7e+00 7.4e+00 8.1e+00 8.9e+00

1e+06

6
3.

1

10

20

50

100

200

number of bound molecules

500

3.8

1000

2000

5000

10000

20000

4

50000

1e+05

2e+05

5e+05

4.5

4.5

4.5

4

4

3.5

3.5

3

3

3

2.5

2.5

2.5

2

2

1.5

1.5

1.5

1.25

1.25

1

1

1

0.75

0.75

0.75

0.5

0.5

0.5

0.25

0.25

0.25

200

500

1000

2000

5000

10000

number of bound molecules

100

200

20000

50000

1e+05

2e+05

5e+05

1e+06

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

optimal parameters (KR)

1.75

1.25

100

50

λ
1.75

50

20

2

λ

λ

4

3.5

20

10

I
5

10

3.9

number of bound molecules

5

1.75

4.3

4

1

5

1

4.1

1e+06

optimal parameters (HB)

H

4.4

3.8

number of bound molecules

optimal parameters (GT)

G

4.6

9e+00 8.3e+00 7.9e+00 7.4e+00 7.2e+00 7.1e+00 6.7e+00 6.4e+00 6.2e+00 6.9e+00 8.7e+00 1.2e+01 1.5e+01 1.9e+01 2.5e+01 3.3e+01 3.5e+01

1.3e+00 1.3e+00 1.2e+00 1.1e+00 9.8e−01 8.7e−01 1.1e+00 2.1e+00 4.8e+00 1.4e+01 2.7e+01 4.5e+01 7.1e+01 9e+01 1.1e+02 1.3e+02 1.4e+02

2

9.1e+00 8.6e+00 8.2e+00 7.5e+00 6.9e+00 6.4e+00 5.9e+00 5.5e+00 5.8e+00 8.5e+00 1.2e+01 1.8e+01 2.9e+01 3.5e+01 4e+01 4.7e+01 5.1e+01

9.1e+00 8.4e+00 7.9e+00 7.3e+00 7e+00 6.8e+00 6.4e+00 6e+00 6.1e+00 7.5e+00 1e+01 1.4e+01 1.9e+01 2.6e+01 3.3e+01 3.7e+01 4.2e+01

3.8e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.6e+00 2.9e+00 4.4e+00 7e+00 1.1e+01 1.5e+01 2e+01 2.7e+01 3.3e+01 4e+01 4.6e+01 5e+01

5.

9.1e+00 8.8e+00 8.6e+00 8e+00 7.3e+00 6.6e+00 5.8e+00 5.3e+00 5.4e+00 8.1e+00 1.2e+01 2e+01 3.2e+01 3.8e+01 4.4e+01 5e+01 5.4e+01

2

1.75

1.3e+00 1.3e+00 1.2e+00 1.1e+00 1e+00 9.1e−01 9.8e−01 1.9e+00 4.6e+00 1.4e+01 2.8e+01 4.9e+01 8e+01

9
3.

3

2.5

1.75

λ

3.6

λ

3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.2e+00 2.9e+00 2.4e+00 2.5e+00 4e+00 9.6e+00 1.7e+01 2.7e+01 3.9e+01 4.8e+01 5.6e+01 6.5e+01 6.9e+01

λ

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 8.9e−01 1e+00 2.2e+00 8.5e+00 2e+01 4.1e+01 7.7e+01 1.1e+02 1.4e+02 1.7e+02 1.9e+02

3

2.5

3.
4

2

1.75

3.

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 8.8e−01 1e+00 3.3e+00 9.6e+00 2.4e+01 6e+01 9.6e+01 1.3e+02 1.7e+02 1.9e+02

5
4.

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 9.7e−01 8.6e−01 1.5e+00 4.3e+00 1.3e+01 4.1e+01 7.6e+01 1.2e+02 1.6e+02 1.9e+02

4.2

3

2.5

4.7

4

3

5

4.5

1

10

20

50

100

200

500

1000

2000

5000

10000

number of bound molecules

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A14: Estimating the Giant, Hunchback and Kruppel caudal ChIP-seq profiles when assuming non-binary
accessibility data. We plotted heatmaps for the correlation (A − C) and mean squared error (D − F ) between
the analytical model and the ChIP-seq profile of Giant (A, D), Hunchback (B, E) and Kruppel (C, F ). The
analytical model includes non-binary DNA accessibility data, by using equation (A9) to compute the probability
that a site is accessible. We computed these values for different sets of parameters: N ∈ [1, 106 ] and λ ∈ [0.25, 5].
Colour code as above. PWM filtering as before. (G − I) We plotted the regions where the mean squared error
is in the lower 12% of the range of values (blue) and the correlation is the higher 12% of the range of values
(orange). With green rectangle we marked the optimal set of parameters in terms of mean squared error and
with a black rectangle the intersection of the parameters for which the two regions intersect.

35

Using the JASPAR PWMs

0
1

2

3

4

Position

5

6

Information content

1
0.5

GT

2
1.5
1
0.5
0
1

2

3

4

5

6

7

HB

2
1.5
1
0.5
0
1

2

Position

3

4

5

6

7

8

9

10

KR

2

Information content

CAD
Information content

Information content

BCD
2
1.5

Information content

A4.5

1.5
1
0.5
0
1

Position

2

3

4

5

6

Position

7

8

9

10

2
1.5
1
0.5
0
1

2

3

4

5

6

7

8

9

10

11

Position

Figure A15: PWMs for the five TFs from the JASPAR database. The graph plots the sequence logos for the
following TFs: (i) Bicoid, (ii) Caudal, (iii) Giant, (iv) Hunchback and (v) Kruppel [39]. When computing
the PWMs we used a pseudo count of 1. The information content for the five motifs is: (i) IBCD = 11.0, (ii)
ICAD = 8.9, (iii) IGT = 14.0, (iv) IHB = 10.4 and (v) IKR = 11.7.

BCD
CAD
GT
HB
KR

N
5000
10000
10000
2000
5000

λ
1.00
1.25
4.50
1.00
2.00

4.06
6.23
0.86
2.56
4.73

M SE
(4.06)
(6.23)
(0.86)
(2.56)
(4.73)

0.74
0.64
0.54
0.68
0.67

ρ
(0.75)
(0.67)
(0.56)
(0.68)
(0.69)

Table A6: Set of parameters that minimises the difference between the ChIP-seq profiles when using the binding
motif from JASPAR database [39]; see Figure A15. Our model assumes binary DNA accessibility data (the
accessibility of any site can be either 0 or 1 depending on whether the site is accessible or not). We also listed
the values for the mean squared error (M SE) and correlation (ρ). The values in the parentheses represent the
minimum mean squared error and the maximum correlation. We considered only the sites that have a PWM
score higher than 70% of the distance between the lowest and the highest score.

36

correlation (BCD)

A

correlation (CAD)

B

0.551

0.551

0.551

0.551

0.551

0.552

0.553

0.555

0.558

0.568

0.581

0.598

0.622

0.635

0.639

0.631

0.617

5

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.569

0.571

0.573

0.579

0.584

0.589

0.591

0.589

4.5

0.551

0.551

0.551

0.551

0.551

0.552

0.554

0.556

0.561

0.574

0.591

0.611

0.637

0.647

0.648

0.635

0.618

4.5

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.569

0.57

0.572

0.575

0.582

0.588

0.592

0.594

0.591

4

0.551

0.551

0.551

0.551

0.552

0.553

0.555

0.559

0.566

0.584

0.605

0.629

0.654

0.661

0.658

0.639

0.619

4

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.569

0.571

0.573

0.578

0.586

0.593

0.597

0.597

0.593

3.5

0.551

0.551

0.551

0.551

0.552

0.553

0.557

0.563

0.574

0.599

0.626

0.652

0.673

0.676

0.667

0.643

0.62

3.5

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.569

0.569

0.572

0.575

0.581

0.592

0.599

0.603

0.601

0.595

3

0.551

0.551

0.551

0.552

0.553

0.555

0.562

0.572

0.588

0.623

0.654

0.679

0.694

0.69

0.676

0.646

0.621

3

0.568

0.568

0.568

0.568

0.568

0.568

0.568

0.569

0.57

0.574

0.579

0.587

0.6

0.607

0.61

0.605

0.598

2.5

0.551

0.551

0.552

0.553

0.555

0.559

0.57

0.586

0.612

0.657

0.688

0.708

0.713

0.704

0.685

0.651

0.625

2.5

0.568

0.568

0.568

0.568

0.568

0.568

0.569

0.57

0.572

0.577

0.585

0.595

0.611

0.618

0.618

0.61

0.601

2

0.551

0.552

0.552

0.555

0.558

0.566

0.585

0.611

0.646

0.695

0.719

0.731

0.73

0.718

0.698

0.664

0.638

2

0.568

0.568

0.568

0.568

0.568

0.568

0.569

0.571

0.574

0.583

0.594

0.608

0.625

0.631

0.629

0.617

0.607

1.75

0.551

0.552

0.553

0.556

0.561

0.57

0.595

0.626

0.665

0.711

0.731

0.739

0.737

0.727

0.708

0.675

0.65

1.75

0.565

0.566

0.566

0.566

0.566

0.566

0.568

0.571

0.576

0.587

0.601

0.618

0.634

0.638

0.635

0.622

0.611

1.5

0.555

0.556

0.557

0.561

0.568

0.579

0.607

0.643

0.682

0.723

0.737

0.743

0.743

0.736

0.721

0.692

0.669

1.5

0.575

0.575

0.575

0.576

0.576

0.577

0.58

0.583

0.589

0.607

0.621

0.632

0.646

0.648

0.643

0.629

0.617

1.25

0.593

0.593

0.595

0.602

0.613

0.63

0.665

0.695

0.721

0.739

0.744

0.746

0.746

0.743

0.734

0.714

0.694

1.25

0.582

0.582

0.582

0.582

0.583

0.584

0.588

0.595

0.605

0.626

0.639

0.65

0.66

0.662

0.657

0.64

0.626

1

0.632

0.635

0.638

0.647

0.719

0.736

0.744

0.741

0.737

0.737

0.745

0.747

0.743

0.732

0.72

1

0.591

0.591

0.591

0.592

0.593

0.596

0.602

0.61

0.622

0.635

0.643

0.651

0.663

0.668

0.665

0.654

0.64

0.75

0.676

0.679

0.683

0.691

0.711

0.724

0.731

0.728

0.729

0.724

0.722

0.725

0.731

0.737

0.738

0.733

0.75

0.603

0.603

0.603

0.604

0.606

0.608

0.613

0.615

0.619

0.62

0.62

0.627

0.646

0.658

0.664

0.664

0.657

0.5

0.683

0.688

0.692

0.702

0.723

0.727

0.721

0.711

0.702

0.699

0.697

0.697

0.699

0.703

0.712

0.723

0.5

0.589

0.589

0.59

0.591

0.592

0.594

0.592

0.582

0.567

0.551

0.553

0.567

0.596

0.64

0.655

0.659

0.25

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.689

0.69

0.69

0.692

0.25

0.636

0.635

0.633

0.629

0.622

0.607

0.57

0.533

0.5

0.466

0.449

0.442

0.451

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

6
0.

λ

λ

5

5 0.682
0.66
0.6
0.7

0.70.713

C

0.6

0.6

0.5

number of bound molecules

number of bound molecules

mean squared error (BCD)

mean squared error (CAD)

D

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 7.9e+00 7.6e+00 7.1e+00 6e+00 5.2e+00 6.2e+00 1.7e+01 3.6e+01

5

4.5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.4e+00 6.7e+00 5.5e+00 5.2e+00 7.9e+00 2.3e+01 4.6e+01

4.5

4

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.6e+00 7e+00 6.2e+00 5.1e+00 5.8e+00 1.1e+01 3.3e+01 5.7e+01

3.

3.8

8

4.2

5

0.473

0.505

0.552

0.587

1e+05

2e+05

5e+05

1e+06

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.5e+00 8.2e+00 6.9e+00 9e+00 1.9e+01

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01

9e+00 7.6e+00 6.7e+00 1.2e+01 2.5e+01

4

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.4e+00 7e+00 7.2e+00 1.6e+01 3.3e+01

3.5

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.4e+00 7.6e+00 6.6e+00 9.1e+00 2.4e+01 4.3e+01

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8e+00 7.9e+00 7.5e+00 6.7e+00 5.8e+00 4.9e+00 6.3e+00 1.3e+01 2.8e+01 5.6e+01 7.9e+01

3

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 9.8e+00 8.6e+00 6.8e+00 7.4e+00 1.4e+01 3.5e+01 5.5e+01

2.5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 7.9e+00 7.6e+00 7.1e+00 5.9e+00 5e+00 4.9e+00 1e+01 2.1e+01 3.8e+01 6.6e+01 8.5e+01

2.5

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.9e+00 7.5e+00 6.8e+00 1.1e+01 2.3e+01 4.8e+01 6.6e+01

2

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.6e+00 7.1e+00 6.3e+00 5e+00 4.6e+00 6.5e+00 1.6e+01 2.9e+01 4.5e+01 6.7e+01 8.4e+01

2

1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.1e+00 7.7e+00 6.6e+00 9.6e+00 1.9e+01 3.5e+01 6e+01 7.4e+01

1.75

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.9e+00 7.4e+00 6.8e+00 5.9e+00 4.7e+00 4.8e+00 7.9e+00 1.9e+01 3.1e+01 4.4e+01 6.4e+01 7.9e+01

1.75

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 8.5e+00 7e+00 6.7e+00 1.3e+01 2.5e+01 4.2e+01 6.4e+01 7.5e+01

1.5

1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.6e+00 7.7e+00 6.5e+00 7.3e+00 1.6e+01 2.9e+01 4.7e+01 6.7e+01 7.6e+01

1.25

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 1e+01 9.1e+00 7.2e+00 6.2e+00 7.9e+00 1.7e+01 3e+01 4.6e+01 6.5e+01 7.5e+01

1

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 9.9e+00 8.6e+00 6.8e+00 6.4e+00 8.6e+00 1.8e+01 2.8e+01 4e+01 5.6e+01 6.8e+01

0.75

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.7e+00 8.5e+00 7e+00 7.1e+00 9.7e+00 1.7e+01 2.5e+01 3.2e+01 4.4e+01 5.2e+01

0.5

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1.1e+01 9.8e+00 8.9e+00 8e+00 8.6e+00 1.1e+01 1.8e+01 2.3e+01 2.7e+01 3.2e+01 3.6e+01

0.25

1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.2e+01 1.1e+01 1.1e+01 1e+01 9.8e+00 9.7e+00 1.1e+01 1.4e+01 1.9e+01 2.2e+01 2.5e+01 2.9e+01 2.9e+01

8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.2e+00 6.4e+00 5.5e+00 4.5e+00 5.3e+00 9.2e+00 2e+01

4.1

4.

4.7

1.25

8.3e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7e+00 6.2e+00 5.2e+00 4.3e+00 5.6e+00 9.9e+00 1.9e+01 2.7e+01 3.5e+01 4.7e+01 5.7e+01

1

8.3e+00 8.3e+00 8.2e+00 8.1e+00 8e+00 7.7e+00 7e+00 6.1e+00 4.9e+00 4.1e+00 5.4e+00 9.1e+00 1.6e+01 2.3e+01 2.9e+01 3.6e+01 4.2e+01

5

8.4e+00 8.4e+00 8.4e+00 8.3e+00 8.2e+00 7.9e+00 7.2e+00 6.4e+00 5.3e+00 4.4e+00 5.7e+00 9.2e+00 1.5e+01 1.8e+01 2e+01 2.2e+01 2.3e+01

8.5e+00 8.4e+00 8.4e+00 8.3e+00 8.2e+00 8e+00 7.4e+00 6.5e+00 5.4e+00 4.5e+00 5.8e+00 9.3e+00 1.5e+01 1.8e+01 2e+01 2.2e+01 2.2e+01

4.2

8

3.9

4

4
1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

number of bound molecules

500

1000

2000

5000

10000

20000

4.5

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

optimal parameters (BCD)

E

4.4

0.5

0.25

4.4

4.

6
4.

8.4e+00 8.4e+00 8.3e+00 8.3e+00 8.1e+00 7.8e+00 7.2e+00 6.3e+00 5.1e+00 4.2e+00 5.5e+00 9.2e+00 1.6e+01 1.9e+01 2.2e+01 2.6e+01 3e+01

3
4.

0.75

4.

1

3e+01 4.1e+01 5.7e+01 7e+01

4

1.5

λ

3.9

λ

3

4.9

.7

4.6

9
3.

4.
7

8e+00 1.8e+01 4.4e+01 6.9e+01

3

3.5

8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.2e+00 8.1e+00 8e+00 7.8e+00 7.3e+00 6.5e+00 5.6e+00 5e+00

0.62

0.55

4.3

0.6

0.65

optimal parameters (CAD)

F

5

5

4.5

4.5

4

4

3.5

3.5

3

3

2.5

2.5

λ

2

λ

2

1.75

1.75

1.5

1.5

1.25

1.25

1

1

0.75

0.75

0.5

0.5

0.25

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

number of bound molecules

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A16: Estimating the Bicoid and Caudal ChIP-seq profiles when using the binding motif from JASPAR
database; see Figure A15. We plotted heatmaps for the correlation (A) and (B) and mean squared error (C) and
(D) between the analytical model and the ChIP-seq profile of Bicoid (A, C) and Caudal (B, D). The analytical
model includes binary DNA accessibility data (the accessibility of any site can be either 0 or 1 depending on
whether the site is accessible or not). We computed these values for different sets of parameters: N ∈ [1, 106 ]
and λ ∈ [0.25, 5]. Colour code as above. We considered only the sites that have a PWM score higher than
70% of the difference between the lowest and the highest score. (E, F ) We plotted the regions where the mean
squared error is in the lower 12% of the range of values (blue) and the correlation is the higher 12% of the range
of values (orange). With green rectangle we marked the optimal set of parameters in terms of mean squared
error and with a black rectangle the intersection of the parameters for which the two regions intersect.

37

correlation (GT)

A

correlation (HB)

B

correlation (KR)

C

5

0.502

0.502

0.502

0.502

0.503

0.504

0.506

0.511

0.517

0.528

0.535

0.539

0.542

0.543

0.542

0.536

0.528

5

0.57

0.57

0.57

0.57

0.57

0.571

0.572

0.575

0.578

0.585

0.591

0.596

0.6

0.601

0.6

0.597

0.594

5

0.541

0.541

0.541

0.541

0.542

0.543

0.545

0.549

0.556

0.573

0.59

0.608

0.623

0.627

0.623

0.61

0.596

4.5

0.502

0.502

0.502

0.502

0.503

0.505

0.508

0.514

0.521

0.532

0.538

0.541

0.543

0.544

0.544

0.537

0.528

4.5

0.57

0.57

0.57

0.57

0.57

0.571

0.573

0.576

0.581

0.589

0.595

0.6

0.604

0.604

0.603

0.599

0.595

4.5

0.541

0.541

0.541

0.541

0.542

0.543

0.547

0.553

0.563

0.584

0.604

0.622

0.635

0.636

0.629

0.613

0.596

0.6

0.502

0.502

0.503

0.504

0.506

0.511

0.518

0.526

0.536

0.539

0.54

0.543

0.546

0.545

0.537

0.528

4

0.57

0.57

0.57

0.57

0.571

0.572

0.575

0.578

0.584

0.594

0.601

0.605

0.608

0.608

0.606

0.601

0.596

4

0.541

0.541

0.541

0.542

0.543

0.545

0.55

0.559

0.573

0.6

0.622

0.638

0.647

0.644

0.635

0.615

0.597

0.502

0.502

0.502

0.503

0.505

0.508

0.515

0.523

0.531

0.535

0.535

0.536

0.542

0.547

0.547

0.539

0.529

3.5

0.57

0.57

0.57

0.57

0.571

0.573

0.577

0.582

0.59

0.601

0.608

0.612

0.613

0.612

0.609

0.603

0.596

3.5

0.541

0.541

0.541

0.542

0.544

0.547

0.556

0.569

0.589

0.621

0.643

0.655

0.658

0.652

0.64

0.617

0.597

3

0.502

0.502

0.503

0.504

0.507

0.511

0.52

0.527

0.531

0.528

0.525

0.528

0.538

0.547

0.549

0.542

0.531

3

0.57

0.57

0.57

0.571

0.572

0.574

0.58

0.588

0.597

0.61

0.616

0.62

0.62

0.617

0.612

0.604

0.597

3

0.541

0.541

0.542

0.544

0.547

0.552

0.567

0.587

0.613

0.647

0.663

0.669

0.666

0.658

0.644

0.619

2.5

0.502

0.502

0.503

0.505

0.509

0.514

0.523

0.527

0.523

0.512

0.507

0.512

0.529

0.543

0.55

0.547

0.538

2.5

0.57

0.57

0.571

0.572

0.574

0.578

0.587

0.597

0.609

0.622

0.627

0.629

0.626

0.621

0.615

0.605

0.598

2.5

0.541

0.542

0.543

0.547

0.552

0.563

0.588

0.615

0.644

0.668

0.674

0.675

0.671

0.663

0.649

0.624

0.603

2

0.502

0.503

0.504

0.507

0.511

0.517

0.523

0.518

0.506

0.487

0.48

0.484

0.503

0.524

0.542

0.552

0.549

2

0.57

0.57

0.571

0.574

0.577

0.584

0.598

0.612

0.626

0.638

0.64

0.638

0.632

0.625

0.617

0.607

0.601

2

0.541

0.543

0.546

0.553

0.565

0.584

0.62

0.647

0.665

0.672

0.672

0.671

0.671

0.667

0.657

0.636

0.616

1.75

0.502

0.503

0.504

0.507

0.511

0.517

0.52

0.513

0.496

0.475

0.465

0.465

0.48

0.501

0.524

0.547

0.553

1.75

0.57

0.571

0.572

0.575

0.58

0.589

0.607

0.623

0.637

0.646

0.646

0.643

0.634

0.626

0.617

0.608

0.602

1.75

0.542

0.546

0.549

0.56

0.576

0.599

0.636

0.656

0.666

0.667

0.665

0.665

0.668

0.668

0.662

0.646

0.628

1.5

0.5

0.501

0.503

0.506

0.512

0.518

0.519

0.509

0.49

0.465

0.453

0.447

0.452

0.467

0.489

0.521

0.54

1.5

0.57

0.572

0.573

0.578

0.585

0.596

0.618

0.636

0.649

0.655

0.652

0.646

0.636

0.626

0.618

0.609

0.604

1.5

0.562

0.571

0.58

0.599

0.618

0.637

0.654

0.659

0.66

0.656

0.653

0.654

0.66

0.665

0.665

0.657

0.645

1.25

0.509

0.51

0.512

0.514

0.518

0.517

0.511

0.497

0.476

0.446

0.434

0.429

0.428

0.432

0.443

0.468

0.492

1.25

0.579

0.581

0.584

0.59

0.599

0.613

0.637

0.653

0.663

0.663

0.657

0.649

0.637

0.627

0.618

0.609

0.605

1.25

0.609

0.629

0.641

0.656

0.665

0.667

0.662

0.656

0.65

0.64

0.637

0.637

0.645

0.653

0.66

0.662

0.659

1

0.553

0.555

0.557

0.561

0.55
0.564

0.564

0.555

0.536

0.503

0.458

0.437

0.424

0.415

0.409

0.406

0.409

0.419

1

0.599

0.604

0.608

0.619

0.632

0.648

0.667

0.675

0.676

0.669

0.661

0.652

0.639

0.629

0.619

0.61

0.605

1

0.655

0.686

0.695

0.694

0.688

0.677

0.66

0.644

0.63

0.613

0.606

0.605

0.612

0.624

0.635

0.649

0.656

0.5

0.501

0.502

0.505

0.507

0.507

0.503

0.495

0.481

0.45

0.422

0.4

0.384

0.38

0.377

0.372

0.371

0.75

0.595

0.606

0.616

0.637

0.655

0.667

0.673

0.671

0.666

0.662

0.656

0.65

0.641

0.633

0.624

0.613

0.606

0.75

0.679

0.685

0.683

0.675

0.664

0.65

0.628

0.612

0.598

0.586

0.577

0.572

0.573

0.578

0.587

0.601

0.611

0.532

0.75

0.45

4

0.55

0.65

0.6

0.425

0.422

0.418

0.413

0.402

0.388

0.37

0.345

0.332

0.5

0.598

0.626

0.639

0.649

0.651

0.649

0.646

0.64

0.639

0.637

0.636

0.634

0.631

0.625

0.62

0.5

0.618

0.617

0.618

0.617

0.308

0.309

0.334

0.333

0.333

0.333

0.339

0.339

0.339

0.339

0.339

0.25

0.623

0.625

0.623

0.618

0.612

0.608

0.608

0.61

0.611

0.61

0.611

0.612

0.614

0.613

0.612

0.61

0.611

0.25

0.541

0.548

0.544

0.55

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

0.5

0.427

0.427

0.427

0.427

0.427

0.427

0.427

0.307

0.324

0.324

0.316

0.316

0.309

0.35

0.427

1

10

20

50

100

200

0.6

0.65

0.55

0.613

0.606

0.593

0.582

0.571

0.558

0.55

0.543

0.534

0.526

0.522

0.524

0.549

0.55

0.549

0.547

0.546

0.548

0.55

0.55

0.546

0.535

0.527

0.52

0.516

0.513

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

number of bound molecules

number of bound molecules

number of bound molecules

mean squared error (GT)

mean squared error (HB)

mean squared error (KR)

E

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 9.9e−01 8.6e−01 9.7e−01 3.1e+00 9.3e+00 2.2e+01 4.8e+01 6.8e+01

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 9.2e−01 8.6e−01 1.3e+00 5.3e+00 1.5e+01 3.1e+01 5.7e+01 7.5e+01

5

F

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.1e+00 2.9e+00 3.4e+00 8.7e+00 2e+01

5

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00

9e+00 8.9e+00 8.5e+00 8e+00 7.2e+00 5.8e+00 5.5e+00 8.8e+00 2.5e+01 4.6e+01

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 1e+00 8.6e−01 1e+00 2.2e+00 9e+00 2.2e+01 4.1e+01 6.6e+01 8.1e+01

4

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 3.3e+00 6e+00 1.8e+01 3.4e+01

4

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 9.4e−01 9e−01 1.5e+00 3.9e+00 1.4e+01 3.1e+01 5e+01 7.3e+01 8.6e+01

3.5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.5e+00 3.3e+00 3e+00 2.9e+00 4.3e+00 9.5e+00 2.6e+01 4.3e+01

3.5

3

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 9.9e−01 8.9e−01 1.1e+00 2.4e+00 6.5e+00 2e+01 3.8e+01 5.8e+01 7.7e+01 8.8e+01

3

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.1e+00 2.8e+00 3.6e+00 7.2e+00 1.6e+01 3.6e+01 5.3e+01

3

2.5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.9e+00 6e+00 1.3e+01 2.6e+01 4.7e+01 6.2e+01

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00

9.1e+00 9.1e+00 9.1e+00 9e+00

9e+00 8.8e+00 8.6e+00 7.9e+00 7e+00 5.9e+00 5.3e+00 8.3e+00 1.8e+01 4.3e+01 6.7e+01

9e+00 8.9e+00 8.6e+00 8.2e+00 7.3e+00 6.2e+00 5.2e+00 6.4e+00 1.3e+01 2.7e+01 5.4e+01 7.6e+01

9e+00 8.9e+00 8.6e+00 8.3e+00 7.6e+00 6.3e+00 5.2e+00 5e+00 9.7e+00 2e+01 3.7e+01 6.3e+01 8.4e+01

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1e+00 9.3e−01 9.2e−01 1.7e+00 3.9e+00 9.3e+00 2.4e+01 4e+01

6e+01 7.7e+01 8.7e+01

2.5

9.1e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.7e+00 8.2e+00 7.6e+00 6.6e+00 5.2e+00 4.8e+00 6.5e+00 1.5e+01 2.8e+01 4.5e+01 6.9e+01 8.6e+01

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.1e+00 2.8e+00 3.3e+00 6e+00 1.6e+01 2.8e+01 4.2e+01 5.9e+01 6.8e+01

1.75

9.1e+00 9e+00 8.9e+00 8.7e+00 8.4e+00 7.9e+00 6.8e+00 5.8e+00 5e+00 5.1e+00 7.2e+00 1.1e+01 2.1e+01 3.2e+01 4.5e+01 6.3e+01 7.6e+01

1e+00 1.3e+00 2.6e+00 4.9e+00 8.7e+00 1.6e+01 2.4e+01 3.2e+01 4.5e+01 5.8e+01

1.5

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.2e+00 2.9e+00 2.9e+00 4.3e+00 8.7e+00 2.1e+01 3.3e+01 4.5e+01 6e+01 6.7e+01

1.5

9.1e+00 9e+00 8.9e+00 8.6e+00 8.2e+00 7.5e+00 6.4e+00 5.5e+00 4.9e+00 5.9e+00 8.5e+00 1.2e+01 2e+01 2.9e+01 3.9e+01 5.4e+01 6.6e+01

1.25

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1.1e+00 1.3e+00 2.1e+00 3.7e+00 6.4e+00 1.2e+01 1.7e+01 2.3e+01 3.2e+01 3.9e+01

1.25

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.3e+00 3e+00 2.7e+00 3.3e+00 6e+00 1.2e+01 2.4e+01 3.5e+01 4.5e+01 5.8e+01 6.6e+01

1

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.2e+00 1.7e+00 2.4e+00 3.8e+00 6.9e+00 1e+01 1.4e+01 1.9e+01 2.4e+01

0.75

1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.3e+00 1.3e+00 1.3e+00 1.4e+00 1.6e+00 2.1e+00 3e+00 4.2e+00 6e+00 9.5e+00 1.2e+01

0.5

1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.5e+00 1.7e+00 2.1e+00 2.7e+00 3.2e+00

0.25

1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00 1.4e+00

10

20

50

100

200

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

λ

λ

1

9.1e+00 9e+00 8.8e+00 8.4e+00 7.9e+00 7.2e+00 6.1e+00 5.4e+00 5.3e+00 6.7e+00 9.2e+00 1.2e+01 1.8e+01 2.4e+01 3.2e+01 4.3e+01 5.2e+01

3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.1e+00 2.8e+00 2.6e+00 3.9e+00 7.8e+00 1.5e+01 2.6e+01 3.6e+01 4.3e+01 5.1e+01 5.8e+01

1

9.1e+00 8.9e+00 8.7e+00 8.3e+00 7.8e+00 7.2e+00 6.3e+00 5.8e+00 5.9e+00 7.4e+00 9.5e+00 1.2e+01 1.6e+01 1.9e+01 2.3e+01 3e+01 3.6e+01

3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.3e+00 2.9e+00 2.6e+00 2.8e+00 5.1e+00 9.6e+00 1.6e+01 2.5e+01 3.3e+01 3.9e+01 4.4e+01 4.8e+01

0.75

9.1e+00 8.9e+00 8.6e+00 8.2e+00 7.8e+00 7.4e+00 6.7e+00 6.3e+00 6.4e+00 7.5e+00 9.2e+00 1.1e+01 1.4e+01 1.5e+01 1.7e+01 2e+01 2.2e+01

0.5

3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3.2e+00 2.9e+00 3e+00 3.6e+00 6.1e+00 9.5e+00 1.4e+01 2.1e+01 2.6e+01 3e+01 3.6e+01 4e+01

0.5

9.2e+00 8.9e+00 8.7e+00 8.5e+00 8.4e+00 8.1e+00 7.7e+00 7.3e+00 7.1e+00 7.1e+00 7.6e+00 8.5e+00 1e+01 1.2e+01 1.4e+01 1.6e+01 1.7e+01

0.25

3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.6e+00 3.6e+00 3.9e+00 4.2e+00 4.4e+00 5.2e+00 6.5e+00 8.3e+00 1.1e+01 1.3e+01 1.5e+01 1.9e+01 2.2e+01

1e+06

4.6

1

10

20

50

100

200

number of bound molecules

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

0.25

1

optimal parameters (HB)

H

5

4.5

4.5

4.5

4

4

4

3.5

3.5

3.5

3

3

3

2.5

2.5

2.5

1.75

1.5

1.5

1.25

1.25

1.25

1

1

1

0.75

0.75

0.75

0.5

0.5

0.5

0.25

0.25

50

100

200

500

1000

2000

5000

10000

number of bound molecules

50

100

9e+00

200

20000

50000

1e+05

2e+05

5e+05

1e+06

3.9

4

3.9

9e+00 8.9e+00 8.8e+00 8.6e+00 8.4e+00 8.2e+00 7.9e+00 7.8e+00 7.8e+00 8e+00 8.1e+00

500

1000

2000

5000

10000

20000

50000

1e+05

2e+05

5e+05

1e+06

50000

1e+05

2e+05

5e+05

1e+06

optimal parameters (KR)

λ
1.75

1.5

20

20

2

λ

λ

2

1.75

10

10

I

5

2

4.3

number of bound molecules

5

1

9.2e+00 8.9e+00 8.8e+00 8.9e+00 9e+00

1e+06

number of bound molecules

optimal parameters (GT)

G

500

4.2

4

3.6

4.6

3.8

1

3.2

1.25

1

0.75

4.

4

3.4

4.8

4.6

4.2

3.6

9e+00 8.9e+00 8.6e+00 8.2e+00 7.4e+00 6.5e+00 5.4e+00 4.7e+00 6e+00 9.8e+00 2.1e+01 3.2e+01 4.8e+01 6.8e+01 8.2e+01

4.7

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 1e+00

2

4.5

1.5

1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.2e+00 1.1e+00 1e+00 9.8e−01 1.2e+00 2.6e+00 5.3e+00 1e+01

λ

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.6e+00 3.5e+00 3.3e+00 2.8e+00 2.9e+00 4.3e+00 1.2e+01 2.3e+01 3.8e+01 5.6e+01 6.7e+01

1.75

1.75

9.1e+00 9e+00

4.9

4.8

2

2e+01 2.9e+01 4.1e+01 6.1e+01 7.3e+01

2

1.3e+00 1.3e+00 1.3e+00 1.3e+00 1.2e+00 1.1e+00 9.9e−01 9.4e−01 1.1e+00 2.4e+00 5.2e+00 1e+01 2.3e+01 3.5e+01 5.1e+01 7.1e+01 8e+01

4.
4

2.5

3.

8

3.8

4

3.5

9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9.1e+00 9e+00 8.9e+00 8.7e+00 8.3e+00 7.6e+00 6.7e+00 5.4e+00 6.2e+00 1.2e+01 3.3e+01 5.6e+01

4.4

4.5

4.8

3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.8e+00 3.7e+00 3.7e+00 3.6e+00 3.4e+00 3e+00 2.9e+00 4.2e+00 1.2e+01 2.6e+01

2

4.5

4.

4.4

3

5

4.5

0.598

λ

5

5
0.6420.6
0.641

0.25

D

0.

0.
5

λ

λ

0.5

0.6

0.502

0.6

4

3.5

0.25

1

10

20

50

100

200

500

1000

2000

5000

10000

number of bound molecules

20000

50000

1e+05

2e+05

5e+05

1e+06

1

10

20

50

100

200

500

1000

2000

5000

10000

20000

number of bound molecules

Figure A17: Estimating the Giant, Hunchback, Kruppel and Caudal ChIP-seq profiles when using the binding
motif from JASPAR database; see Figure A15. We plotted heatmaps for the correlation (A − C) and mean
squared error (D −F ) between the analytical model and the ChIP-seq profile of Giant (A, D), Hunchback (B, E)
and Kruppel (C, F ). The analytical model includes binary DNA accessibility data (the accessibility of any site
can be either 0 or 1 depending on whether the site is accessible or not). We computed these values for different
sets of parameters: N ∈ [1, 106 ] and λ ∈ [0.25, 5]. Colour code as above. PWM filtering as above. (G − I)
We plotted the regions where the mean squared error is in the lower 12% of the range of values (blue) and the
correlation is the higher 12% of the range of values (orange). With green rectangle we marked the optimal set
of parameters in terms of mean squared error and with a black rectangle the intersection of the parameters for
which the two regions intersect.

38

GT (10000 molecules) @ D locus

GT (10000 molecules) @ H locus

GT (10000 molecules) @ Kr locus
correlation = 0.49; mean squared error = 1.47

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

GT (10000 molecules) @ cnc locus

GT (10000 molecules) @ croc locus
correlation = 0.87; mean squared error = 0.163

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

GT (10000 molecules) @ eve locus

TER94

occupancy
24400000

GT (10000 molecules) @ gt locus

24410000

24415000

24420000

2682000

2328000

2330000

−

4520000

39

GT (10000 molecules) @ kni locus

4525000

4530000

20692000

178000

chr2L

correlation = 0.23; mean squared error = 0.94

+

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

GT (10000 molecules) @ opa locus

GT (10000 molecules) @ os locus

GT (10000 molecules) @ prd locus

−

685000

690000

695000

18195000

18200000

18205000

CG6712

12080000

12085000

run

+

slp2

20570000

correlation = 0.51; mean squared error = 0.718

3820000

tll

+

−

20565000

chr3R
occupancy

slp1

+

−

12095000

GT (10000 molecules) @ tll locus
correlation = 0.45; mean squared error = 0.221

occupancy

occupancy

chr2L

12090000
DNA position

GT (10000 molecules) @ slp locus
correlation = 0.11; mean squared error = 0.856

DNA position

prd

DNA position

GT (10000 molecules) @ run locus

20560000

CG5325

−

os

DNA position

chrX

correlation = 0.23; mean squared error = 0.947

CG14947
+

+

−

680000

chr2L

3612000

occupancy

correlation = 0.9; mean squared error = 0.182

occupancy

occupancy

chrX

opa

+

180000

occupancy

occupancy

occupancy

20690000

176000

DNA position

correlation = 0.28; mean squared error = 1.34

20555000

174000

GT (10000 molecules) @ odd locus
correlation = 0.68; mean squared error = 0.426

−

chr3R

20550000

172000

DNA position

+
kni

675000

hkb

170000

GT (10000 molecules) @ oc locus
chrX

+

2696000

+

hb

4515000

correlation = 0.81; mean squared error = 1.4

2694000

correlation = 0.29; mean squared error = 2.39

DNA position

chr3L

2692000

occupancy

occupancy

occupancy

2326000

2690000

chr3R

CG8112

−

2324000
DNA position

670000

2688000

GT (10000 molecules) @ hkb locus
correlation = 0.79; mean squared error = 1.21

+
gt

20688000

2686000

DNA position

chr3R

+

20686000

2684000

GT (10000 molecules) @ hb locus
correlation = 0.77; mean squared error = 0.374

20684000

ftz

−

24405000
DNA position

chrX

−

correlation = 0.61; mean squared error = 1.46

+
fkh

5875000

DNA position

2322000

chr3R

+
−

5870000

21475000

GT (10000 molecules) @ ftz locus
correlation = 0.56; mean squared error = 0.172

occupancy

occupancy

eve

2320000

21470000
DNA position

chr3R

−

CG32797

21465000

GT (10000 molecules) @ fkh locus
correlation = 0.36; mean squared error = 1.96

−

croc

19024000

DNA position

chr2R

5865000

correlation = 0.48; mean squared error = 0.234

+
cnc

19012000

DNA position

+

chr3L

+
−

2318000

21115000

DNA position

correlation = 0.82; mean squared error = 0.17

20770000

21110000

GT (10000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.55; mean squared error = 0.9

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.5; mean squared error = 0.497

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A18: Binding profiles for Giant at all 21 loci using the JASPAR database 1PWM. The grey shading represents a ChIP-seq profile, the red line represents the
prediction of the analytical model, the yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we
only displayed sites with an occupancy higher than 5%). We considered the optimal set of parameters for hunchback (10000 molecules and λ = 4.50).

HB (2000 molecules) @ D locus

HB (2000 molecules) @ H locus

HB (2000 molecules) @ Kr locus
correlation = 0.81; mean squared error = 1.63

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

HB (2000 molecules) @ cnc locus

HB (2000 molecules) @ croc locus
correlation = 0.81; mean squared error = 0.102

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

HB (2000 molecules) @ eve locus

TER94

occupancy
24400000

HB (2000 molecules) @ gt locus

24410000

24415000

24420000

2682000

2328000

2330000

−

4520000

40

HB (2000 molecules) @ kni locus

4525000

4530000

20692000

178000

chr2L

correlation = 0.75; mean squared error = 0.896

+

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

HB (2000 molecules) @ opa locus

HB (2000 molecules) @ os locus

HB (2000 molecules) @ prd locus

−

685000

690000

695000

18195000

18200000

18205000

CG6712

12080000

12085000

run

+

slp2

20570000

correlation = 0.47; mean squared error = 4.44

3820000

tll

+

−

20565000

chr3R
occupancy

slp1

+

−

12095000

HB (2000 molecules) @ tll locus
correlation = 0.69; mean squared error = 2.5

occupancy

occupancy

chr2L

12090000
DNA position

HB (2000 molecules) @ slp locus
correlation = 0.47; mean squared error = 1.75

DNA position

prd

DNA position

HB (2000 molecules) @ run locus

20560000

CG5325

−

os

DNA position

chrX

correlation = 0.39; mean squared error = 0.335

CG14947
+

+

−

680000

chr2L

3612000

occupancy

correlation = 0.74; mean squared error = 0.342

occupancy

occupancy

chrX

opa

+

180000

occupancy

occupancy

occupancy

20690000

176000

DNA position

correlation = 0.4; mean squared error = 1.48

20555000

174000

HB (2000 molecules) @ odd locus
correlation = 0.67; mean squared error = 0.136

−

chr3R

20550000

172000

DNA position

+
kni

675000

hkb

170000

HB (2000 molecules) @ oc locus
chrX

+

2696000

+

hb

4515000

correlation = 0.86; mean squared error = 8.55

2694000

correlation = 0.13; mean squared error = 0.0381

DNA position

chr3L

2692000

occupancy

occupancy

occupancy

2326000

2690000

chr3R

CG8112

−

2324000
DNA position

670000

2688000

HB (2000 molecules) @ hkb locus
correlation = 0.79; mean squared error = 8.12

+
gt

20688000

2686000

DNA position

chr3R

+

20686000

2684000

HB (2000 molecules) @ hb locus
correlation = 0.94; mean squared error = 0.444

20684000

ftz

−

24405000
DNA position

chrX

−

correlation = 0.85; mean squared error = 0.269

+
fkh

5875000

DNA position

2322000

chr3R

+
−

5870000

21475000

HB (2000 molecules) @ ftz locus
correlation = 0.8; mean squared error = 0.00845

occupancy

occupancy

eve

2320000

21470000
DNA position

chr3R

−

CG32797

21465000

HB (2000 molecules) @ fkh locus
correlation = 0.79; mean squared error = 1.44

−

croc

19024000

DNA position

chr2R

5865000

correlation = 0.57; mean squared error = 0.262

+
cnc

19012000

DNA position

+

chr3L

+
−

2318000

21115000

DNA position

correlation = 0.67; mean squared error = 1.06

20770000

21110000

HB (2000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.61; mean squared error = 18.7

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.97; mean squared error = 1.19

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A19: Binding profiles for Hunchback at all 21 loci using the JASPAR database
1 PWM. The grey shading represents a ChIP-seq profile, the red line represents the
prediction of the analytical model, the yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we
only displayed sites with an occupancy higher than 5%). We considered the optimal set of parameters for hunchback (2000 molecules and λ = 1.00).

KR (5000 molecules) @ D locus

KR (5000 molecules) @ H locus

KR (5000 molecules) @ Kr locus
correlation = 0.79; mean squared error = 7.71

+

h

+

−

14170000

14172000

14174000

14176000

8660000

8665000

8670000

8675000

8680000

21105000

DNA position

DNA position

KR (5000 molecules) @ cnc locus

KR (5000 molecules) @ croc locus
correlation = 0.82; mean squared error = 0.2

occupancy

occupancy

chr3R

cad

+

Ir

−

20775000

20780000

20785000

−

19014000

19016000

19018000

19020000

19022000

KR (5000 molecules) @ eve locus

TER94

occupancy
24400000

KR (5000 molecules) @ gt locus

24410000

24415000

24420000

2682000

2328000

2330000

−

4520000

41

KR (5000 molecules) @ kni locus

4525000

4530000

20692000

178000

chr2L

correlation = 0.87; mean squared error = 17.8

+

20694000

−

oc

8520000

8525000

8530000

8535000

8540000

8545000

8550000

odd

3604000

3606000

3608000

3610000

DNA position

DNA position

KR (5000 molecules) @ opa locus

KR (5000 molecules) @ os locus

KR (5000 molecules) @ prd locus

−

685000

690000

695000

18195000

18200000

18205000

CG6712

12080000

12085000

run

+

slp2

20570000

correlation = 0.84; mean squared error = 9.8

3820000

tll

+

−

20565000

chr3R
occupancy

slp1

+

−

12095000

KR (5000 molecules) @ tll locus
correlation = 0.92; mean squared error = 2.46

occupancy

occupancy

chr2L

12090000
DNA position

KR (5000 molecules) @ slp locus
correlation = 0.57; mean squared error = 2.75

DNA position

prd

DNA position

KR (5000 molecules) @ run locus

20560000

CG5325

−

os

DNA position

chrX

correlation = 0.79; mean squared error = 14.1

CG14947
+

+

−

680000

chr2L

3612000

occupancy

correlation = 0.84; mean squared error = 0.453

occupancy

occupancy

chrX

opa

+

180000

occupancy

occupancy

occupancy

20690000

176000

DNA position

correlation = 0.18; mean squared error = 6.03

20555000

174000

KR (5000 molecules) @ odd locus
correlation = 0.74; mean squared error = 0.882

−

chr3R

20550000

172000

DNA position

+
kni

675000

hkb

170000

KR (5000 molecules) @ oc locus
chrX

+

2696000

+

hb

4515000

correlation = 0.3; mean squared error = 9.69

2694000

correlation = 0.45; mean squared error = 0.921

DNA position

chr3L

2692000

occupancy

occupancy

occupancy

2326000

2690000

chr3R

CG8112

−

2324000
DNA position

670000

2688000

KR (5000 molecules) @ hkb locus
correlation = 0.84; mean squared error = 3.23

+
gt

20688000

2686000

DNA position

chr3R

+

20686000

2684000

KR (5000 molecules) @ hb locus
correlation = 0.86; mean squared error = 2.47

20684000

ftz

−

24405000
DNA position

chrX

−

correlation = 0.83; mean squared error = 2.03

+
fkh

5875000

DNA position

2322000

chr3R

+
−

5870000

21475000

KR (5000 molecules) @ ftz locus
correlation = 0.88; mean squared error = 2.76

occupancy

occupancy

eve

2320000

21470000
DNA position

chr3R

−

CG32797

21465000

KR (5000 molecules) @ fkh locus
correlation = 0.43; mean squared error = 8.23

−

croc

19024000

DNA position

chr2R

5865000

correlation = 0.3; mean squared error = 3.16

+
cnc

19012000

DNA position

+

chr3L

+
−

2318000

21115000

DNA position

correlation = 0.6; mean squared error = 2.11

20770000

21110000

KR (5000 molecules) @ cad locus
chr2L

dia

Kr

−

14178000

occupancy

14168000

correlation = 0.66; mean squared error = 0.379

+

−

D

14166000

chr2R
occupancy

chr3L
occupancy

correlation = 0.6; mean squared error = 2.14

occupancy

chr3L

−

3825000

3830000
DNA position

3835000

3840000

26672000

26674000

26676000

26678000

26680000

26682000

26684000

DNA position

Figure A20: Binding profiles for Kruppel at all 21 loci using the JASPAR database1 PWM. The grey shading represents a ChIP-seq profile, the red line represents the
prediction of the analytical model, the yellow shading represents the inaccessible DNA and the vertical blue lines represent the percentage of occupancy of the site (we
only displayed sites with an occupancy higher than 5%). We considered the optimal set of parameters for Kruppel (5000 molecules and λ = 2.00).

Kolmogorov−Smirnov test p−value

mean squared error

6.7e−05

3.9e−05

4.9e−01

1e+00

2.3e−02

correlation

3.6e−07

4.3e−14

6.5e−01

1e+00

2.9e−01

BCD

CAD

GT

HB

KR

Figure A21: The p-value of the KolmogorovSmirnov test between the two subsets of thresholds. We performed
a Kolmogorov-Smirnov test between the case when we selected the regions with a mean ChIP-seq signal higher
than the background (> B) and the case when we selected the regions with a mean ChIP-seq signal higher than
half the background (> 0.5 · B). We considered both the mean squared error and correlation coefficient for each
of the five TFs.

A4.6

Genome-wide analysis

B
M

BCD
0.03
1.85

CAD
0.03
1.63

GT
0.04
4.97

HB
0.04
16.23

KR
0.04
5.23

Table A7: Mean and maximum of the ChIP-seq signal for the five TFs.

1.0
0.5

BCD
35
812

CAD
167
1984

GT
1
32

HB
2
6

KR
8
83

Table A8: The number of DNA segments with a ChIP-seq signal higher than the threshold. We considered two
thresholds K = 1.0 and K = 0.5. The mean ChIP-seq signal of the 20 Kbp segment needs to be higher than
K × B.

42

TF
C/EBP
NF1
Jun
Fos
Myc
Max
Max
Mad
FBP
XBP
BRD4
p53
p53
GR
GR*
GR
STAT1*
HSF1
HSF1*
Sox2
Sox2 (with Oct4*)
Sox2 (with Oct4)
Oct4
Oct4 (with Sox2*)
Oct4 (with Sox2)

cell type
HeLa
HeLa
HeLa
HeLa
HeLa
HeLa
3134
HeLa
HeLa
HeLa
HeLa
H1299
H1299
MCF-7
MCF-7
3134
HeLa
U87
U87
ES
NIH 3T3
NIH 3T3
ES
NIH 3T3
NIH 3T3

% of bound TF
35.5%
58.1%
75.2%
54.2%
54.1%
34.5%
16.0%
21.2%
99.7%
18.6%
62.4%
7.0%
2.5%
12.0%
37.0%
3.5%
34.0%
30.0%
45.0%
15.1%
16.3%
16.9%
14.4%
18.4%
10.7%

experiment type
FRAP
FRAP
FRAP
FRAP
FRAP
FRAP
FRAP
FRAP
FRAP
FRAP
FRAP
FRAP/FCS/SMT
SMT
RLSM
RLSM
SMT
SMT
FCS
FCS
2D SMT
2D SMT
2D SMT
2D SMT
2D SMT
2D SMT

type of binding
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific
specific

reference
[56]
[56]
[56]
[56]
[56]
[56]
[57]
[56]
[56]
[56]
[56]
[60]
[62]
[61]
[61]
[62]
[58]
[59]
[59]
[51]
[51]
[51]
[51]
[51]
[51]

10

12

Table A9: The fraction of bound molecules. This is a (non exhaustive) list of the percentage of bound molecules
of several TFs to the DNA as determined experimentally in previous works. The following methods were used:
Fluorescence Recovery After Photobleaching (FRAP), Fluorescence Correlation Spectroscopy (FCS), Single
Molecule Tracking (SMT) and Reflected Light-Sheet Microscope (RLSM). The ∗ superscript indicates the TF
in induced state. Note that if the same group published different measurements for the same TF, we only
selected the latest value. In addition, if the data was fitted to a model assuming two modes of binding, we
report only the faction of bound molecules in the slower moving component, which estimates the fraction of
specifically bound TF. The distribution of the percentage of bound TFs is plotted in Figure A22.

6
0

2

4

count

8

mean=31.7
median=21.2

0

20

40

60

80

100

% of specifically bound TFs

Figure A22: The distribution of the percentage of specifically bound molecules for different TFs. We plotted the
data from Table A9.

43

BCD
CAD
GT
HB
KR

min abundance
10000
12000
23000
11000
37000

max abundance
30000
37000
70000
34000
110000

min specifically bound
7%
27%
1%
6%
18%

max specifically bound
20%
81%
4%
18%
54%

Table A10: The TF abundance in the nucleus and the percentage of specifically bound TF. In the first two
columns, we list the number of molecules that are in the nucleus for the five TFs. For our estimates for Bicoid
nuclear abundance, see the Discussion section in the main text. In [63], the authors reanalysed the FlyEx
data [64] and proposed a lower limit for the nuclear abundance of the five TFs, but the proposed values are
underestimates of the real values. For the last four TFs (Caudal, Giant, Hunchback and Kruppel), we considered
the nuclear abundances of the four TFs relative to Bicoid nuclear abundance, as estimated in [63] using the
Poisson method, and then we multiplied these relative abundances with our estimates for the Bicoid nuclear
abundance. In the last two columns we list the percentage of specifically bound TFs, based on the estimations
of our method (Table 2 in the main text) and the values in the first two columns.

44

References
[1] Peter J. Park. Chip-seq: advantages and challenges of a maturing technology. Nature Reviews Genetics,
10(10):669–680, 2009. doi: 10.1038/nrg2641.
[2] Wyeth W. Wasserman and Albin Sandelin. Applied bioinformatics for the identification of regulatory
elements. Nature Reviews Genetics, 5:276–287, 2004. doi: 10.1038/nrg1315.
[3] Rutger Hermsen, Sander Tans, and Pieter Rein ten Wolde. Transcriptional regulation by competing transcription factor modules. PLoS Comput Biol, 2(12):1552–1560, 2006. doi: 10.1371/journal.pcbi.0020164.
[4] Michael M. Hoffman and Ewan Birney. An effective model for natural selection in promoters. Genome
Resarch, 20(5):685–692, 2010. doi: 10.1101/gr.096719.109.
[5] M Sheinman and Y Kafri. How does the DNA sequence affect the Hill curve of transcriptional response?
Physical Biology, 9(5):056006, 2012. doi: 10.1088/1478-3975/9/5/056006.
[6] Marko Djordjevic, Anirvan M. Sengupta, and Boris I. Shraiman. A biophysical approach to transcription
factor binding site discovery. Genome Resarch, 13(11):2381–2390, 2003. doi: 10.1101/gr.1271603.
[7] Barrett C. Foat, Alexandre V. Morozov, and Harmen J. Bussemaker. Statistical mechanical modeling of
genome-wide transcription factor occupancy data by MatrixREDUCE. Bioinformatics, 22(14):e141–e149,
2006. doi: 10.1093/bioinformatics/btl223.
[8] Helge G. Roider, Aditi Kanhere, Thomas Manke, and Martin Vingron. Predicting transcription factor affinities to DNA from a biophysical model. Bioinformatics, 23(2):134–141, 2007. doi: 10.1093/bioinformatics/
btl565.
[9] Yue Zhao, David Granas, and Gary D. Stormo. Inferring binding energies from selected binding sites. PLoS
Computational Biology, 5(12):e1000590, 2009. doi: 10.1371/journal.pcbi.1000590.
[10] Jovan Simicevic, Adrien W Schmid, Paola A Gilardoni, Benjamin Zoller, Sunil K Raghav, Irina Krier,
Carine Gubelmann, Frederique Lisacek, Felix Naef, Marc Moniatte, and Bart Deplancke. Absolute quantification of transcription factors during cellular differentiation using multiplexed targeted proteomics.
Nature Methods, 10(6):570–576, 2013. doi: 10.1038/nmeth.2441.
[11] Nicolae Radu Zabet, Robert Foy, and Boris Adryan. The influence of transcription factor competition on
the relationship between occupancy and affinity. PLoS ONE, 8(9):e73714, 2013. doi: 10.1371/journal.pone.
0073714.
[12] Garth R Ilsley, Jasmin Fisher, Rolf Apweiler, Angela H DePace, and Nicholas M Luscombe. Cellular
resolution models for even skipped regulation in the entire Drosophila embryo. eLife, 2, 2013. doi: 10.
7554/eLife.00522.
[13] Tali Raveh-Sadka, Michal Levo, and Eran Segal. Incorporating nucleosomes into thermodynamic models
of transcription regulation. Genome Research, 19(8):1480–1496, 2009. doi: 10.1101/gr.088260.108.
[14] Xin He, Chieh-Chun Chen, Feng Hong, Fang Fang, Saurabh Sinha, Huck-Hui Ng, and Sheng Zhong.
A biophysical model for analysis of transcription factor interaction and binding site arrangement from
genome-wide binding data. PLoS ONE, 4(12):e8155, 2009. doi: 10.1371/journal.pone.0008155.
[15] Todd Wasson and Alexander J. Hartemink. An ensemble model of competitive multi-factor binding of the
genome. Genome Research, 19:2101–2112, 2009. doi: 10.1101/gr.093450.109.
[16] Tommy Kaplan, Xiao-Yong Li, Peter J. Sabo, Sean Thomas, John A. Stamatoyannopoulos, Mark D.
Biggin, and Michael B. Eisen. Quantitative models of the mechanisms that control genome-wide patterns
of transcription factor binding during early Drosophila development. PLoS Genetics, 7(2):e1001290, 2011.
doi: 10.1371/journal.pgen.1001290.
[17] Qiong Cheng, Majid Kazemian, Hannah Pham, Charles Blatti, Susan E. Celniker, Scot A. Wolfe, Michael H.
Brodsky, and Saurabh Sinha. Computational identification of diverse mechanisms underlying transcription
factor-DNA occupancy. PLoS Genetics, 9(8):e1003571, 2013. doi: 10.1371%2Fjournal.pgen.1003571.
[18] Gary K. Ackers, Alexander D. Johnson, and Madeline A. Shea. Quantitative model for gene regulation by
lambda phage repressor. PNAS, 79:1129–1133, 1982.
45

[19] Lacramioara Bintu, Nicolas E. Buchler, Hernan G. Garcia, Ulrich Gerland, Terence Hwa, Jane Kondev,
and Rob Phillips. Transcriptional regulation by the numbers: models. Current Opinion in Genetics &
Development, 15(2):116–124, 2005. doi: 10.1016/j.gde.2005.02.007.
[20] Dominique Chu, Nicolae Radu Zabet, and Boris Mitavskiy. Models of transcription factor binding: Sensitivity of activation functions to model assumptions. Journal of Theoretical Biology, 257(3):419–429, 2009.
doi: 10.1016/j.jtbi.2008.11.026.
[21] Otto G. Berg and Peter H. von Hippel. Selection of DNA binding sites by regulatory proteins statisticalmechanical theory and application to operators and promoters. Journal of Molecular Biology, 193(4):
723–750, 1987. doi: 10.1016/0022-2836(87)90354-8.
[22] Gary D. Stormo and Yue Zhao. Determining the specificity of protein-DNA interactions. Nature Reviews
Genetics, 11(11):751–760, 2010. doi: 10.1038/nrg2845.
[23] Robert K. Bradley, Xiao-Yong Li, Cole Trapnell, Stuart Davidson, Lior Pachter, Hou Cheng Chu, Leath A.
Tonkin, Mark D. Biggin, and Michael B. Eisen. Binding site turnover produces pervasive quantitative
changes in transcription factor binding between closely related Drosophila species. PLoS Biology, 8:
e1000343, 2010. doi: 10.1371/journal.pbio.1000343.
[24] Xiao-Yong Li, Sean Thomas, Peter Sabo, Michael Eisen, John Stamatoyannopoulos, and Mark Biggin. The
role of chromatin accessibility in directing the widespread, overlapping patterns of drosophila transcription
factor binding. Genome Biology, 12(4):R34, 2011. doi: 10.1186/gb-2011-12-4-r34.
[25] Arthur D. Riggs, Suzanne Bourgeois, and Melvin Cohn. The lac represser-operator interaction: III. kinetic
studies. Journal of Molecular Biology, 53(3):401–417, 1970. doi: 10.1016/0022-2836(70)90074-4.
[26] Otto G. Berg, Robert B. Winter, and Peter H. von Hippel. Diffusion-driven mechanisms of protein translocation on nucleic acids. 1. models and theory. Biochemistry, 20(24):6929–6948, 1981. doi:
10.1021/bi00527a028.
[27] H Kabata, O Kurosawa, M Washizu I Arai, SA Margarson, RE Glass, and N Shimamoto. Visualization of
single molecules of rna polymerase sliding along dna. Science, 262(5139):1561–1563, 1993. doi: 10.1126/
science.8248804.
[28] Paul C. Blainey, Antoine M. van Oijen, Anirban Banerjee, Gregory L. Verdine, and X. Sunney Xie. A
base-excision dna-repair protein finds intrahelical lesion bases by fast sliding in contact with dna. PNAS,
103(15):5752–5757, 2006. doi: 10.1073/pnas.0509723103.
[29] Johan Elf, Gene-Wei Li, and X. Sunney Xie. Probing transcription factor dynamics at the single-molecule
level in a living cell. Science, 316(5828):1191–1194, 2007. doi: 10.1126/science.114196.
[30] Leonid Mirny, Michael Slutsky, Zeba Wunderlich, Anahita Tafvizi, Jason Leith, and Andrej Kosmrlj. How
a protein searches for its site on DNA: the mechanism of facilitated diffusion. Journal of Physics A:
Mathematical and Theoretical, 42(43):434013, 2009. doi: 10.1088/1751-8113/42/43/434013.
[31] Gordon L. Hager, James G. McNally, and Tom Misteli. Transcription dynamics. Molecular Cell, 35(6):
741–753, 2009. doi: 10.1016/j.molcel.2009.09.005.
[32] Vladana Vukojevic, Dimitrios K. Papadopoulos, Lars Terenius, Walter J. Gehring, and Rudolf Rigler.
Quantitative study of synthetic hox transcription factor-dna interactions in live cells. PNAS, 107(9):4093–
4098, 2010. doi: 10.1073/pnas.0914612107.
[33] Petter Hammar, Prune Leroy, Anel Mahmutovic, Erik G. Marklund, Otto G. Berg, and Johan Elf. The
lac repressor displays facilitated diffusion in living cells. Science, 336(6088):1595–1598, 2012. doi: 10.1126/
science.1221648.
[34] Nicolae Radu Zabet and Boris Adryan. A comprehensive computational model of facilitated diffusion in
prokaryotes. Bioinformatics, 28(11):1517–1524, 2012. doi: 10.1093/bioinformatics/bts178.
[35] Nicolae Radu Zabet and Boris Adryan. Computational models for large-scale simulations of facilitated
diffusion. Molecular BioSystems, 8(11):2815–2827, 2012. doi: 10.1039/C2MB25201E.
[36] Sean Thomas, Xiao-Yong Li, Peter J Sabo, Richard Sandstrom, Robert E Thurman, Theresa K Canfield,
Erika Giste, William Fisher, Ann Hammonds, Susan E Celniker, Mark D Biggin, and John A Stamatoyannopoulos. Dynamic reprogramming of chromatin accessibility during Drosophila embryo development.
Genome Biology, 12(5):R43, 2011. doi: 10.1186/gb-2011-12-5-r43.
46

[37] Mark D. Adams, Susan E. Celniker, Robert A. Holt, Cheryl A. Evans, Jeannine D. Gocayne, Peter G.
Amanatides, Steven E. Scherer, Peter W. Li, Roger A. Hoskins, Richard F. Galle, Reed A. George,
Suzanna E. Lewis, Stephen Richards, Michael Ashburner, Scott N. Henderson, Granger G. Sutton, Jennifer R. Wortman, Mark D. Yandell, Qing Zhang, Lin X. Chen, Rhonda C. Brandon, Yu-Hui C. Rogers,
Robert G. Blazej, Mark Champe, Barret D. Pfeiffer, Kenneth H. Wan, Clare Doyle, Evan G. Baxter,
Gregg Helt, Catherine R. Nelson, George L. Gabor, Miklos, Josep F. Abril, Anna Agbayani, Hui-Jin
An, Cynthia Andrews-Pfannkoch, Danita Baldwin, Richard M. Ballew, Anand Basu, James Baxendale,
Leyla Bayraktaroglu, Ellen M. Beasley, Karen Y. Beeson, P. V. Benos, Benjamin P. Berman, Deepali
Bhandari, Slava Bolshakov, Dana Borkova, Michael R. Botchan, John Bouck, Peter Brokstein, Phillipe
Brottier, Kenneth C. Burtis, Dana A. Busam, Heather Butler, Edouard Cadieu, Angela Center, Ishwar
Chandra, J. Michael Cherry, Simon Cawley, Carl Dahlke, Lionel B. Davenport, Peter Davies, Beatriz de
Pablos, Arthur Delcher, Zuoming Deng, Anne Deslattes Mays, Ian Dew, Suzanne M. Dietz, Kristina Dodson, Lisa E. Doup, Michael Downes, Shannon Dugan-Rocha, Boris C. Dunkov, Patrick Dunn, Kenneth J.
Durbin, Carlos C. Evangelista, Concepcion Ferraz, Steven Ferriera, Wolfgang Fleischmann, Carl Fosler,
Andrei E. Gabrielian, Neha S. Garg, William M. Gelbart, Ken Glasser, Anna Glodek, Fangcheng Gong,
J. Harley Gorrell, Zhiping Gu, Ping Guan, Michael Harris, Nomi L. Harris, Damon Harvey, Thomas J.
Heiman, Judith R. Hernandez, Jarrett Houck, Damon Hostin, Kathryn A. Houston, Timothy J. Howland,
Ming-Hui Wei, Chinyere Ibegwam, Mena Jalali, Francis Kalush, Gary H. Karpen, Zhaoxi Ke, James A.
Kennison, Karen A. Ketchum, Bruce E. Kimmel, Chinnappa D. Kodira, Cheryl Kraft, Saul Kravitz, David
Kulp, Zhongwu Lai, Paul Lasko, Yiding Lei, Alexander A. Levitsky, Jiayin Li, Zhenya Li, Yong Liang,
Xiaoying Lin, Xiangjun Liu, Bettina Mattei, Tina C. McIntosh, Michael P. McLeod, Duncan McPherson,
Gennady Merkulov, Natalia V. Milshina, Clark Mobarry, Joe Morris, Ali Moshrefi, Stephen M. Mount,
Mee Moy, Brian Murphy, Lee Murphy, Donna M. Muzny, David L. Nelson, David R. Nelson, Keith A.
Nelson, Katherine Nixon, Deborah R. Nusskern, Joanne M. Pacleb, Michael Palazzolo, Gjange S. Pittman,
Sue Pan, John Pollard, Vinita Puri, Martin G. Reese, Knut Reinert, Karin Remington, Robert D. C.
Saunders, Frederick Scheeler, Hua Shen, Bixiang Christopher Shue, Inga Sidn-Kiamos, Michael Simpson,
Marian P. Skupski, Tom Smith, Eugene Spier, Allan C. Spradling, Mark Stapleton, Renee Strong, Eric Sun,
Robert Svirskas, Cyndee Tector, Russell Turner, Eli Venter, Aihui H. Wang, Xin Wang, Zhen-Yuan Wang,
David A. Wassarman, George M. Weinstock, Jean Weissenbach, Sherita M. Williams, Trevor Woodage,
Kim C. Worley, David Wu, Song Yang, Q. Alison Yao, Jane Ye, Ru-Fang Yeh, Jayshree S. Zaveri, Ming
Zhan, Guangren Zhang, Qi Zhao, Liansheng Zheng, Xiangqun H. Zheng, Fei N. Zhong, Wenyan Zhong,
Xiaojun Zhou, Shiaoping Zhu, Xiaohong Zhu, Hamilton O. Smith, Richard A. Gibbs, Eugene W. Myers,
Gerald M. Rubin, and J. Craig Venter. The genome sequence of drosophila melanogaster. Science, 287
(5461):2185–2195, 2000. doi: 10.1126/science.287.5461.2185.
[38] Florian Mueller, Timothy J. Stasevich, Davide Mazza, and James G. McNally. Quantifying transcription
factor kinetics: At work or at play? Crit Rev Biochem Mol Biol., 48(5):492–514, 2013. doi: 10.3109/
10409238.2013.833891.
[39] Elodie Portales-Casamar, Supat Thongjuea, Andrew T. Kwon, David Arenillas, Xiaobei Zhao, Eivind
Valen, Dimas Yusuf, Boris Lenhard, Wyeth W. Wasserman, and Albin Sandelin. JASPAR 2010: the
greatly expanded open-access database of transcription factor binding profiles. Nucleic Acids Research, 38
(suppl 1):D105–D110, 2010. doi: 10.1093/nar/gkp950.
[40] D Stanojevic, S Small, and M Levine. Regulation of a segmentation stripe by overlapping activators and
repressors in the Drosophila embryo. Science, 254(5036):1385–1387, 1991. doi: 10.1126/science.1683715.
[41] Thomas Gregor, David W. Tank, Eric F. Wieschaus, and William Bialek. Probing the limits to positional
information. Cell, 130(1):153–164, 2007. doi: 10.1016/j.cell.2007.05.025.
[42] Asmahan Abu-Arish, Aude Porcher, Anna Czerwonka, Nathalie Dostatni, and Cecile Fradin. High mobility
of bicoid captured by fluorescence correlation spectroscopy: Implication for the rapid establishment of its
gradient. Biophysical Journal, 99(4):L33 – L35, 2010. doi: 10.1016/j.bpj.2010.05.031.
[43] Oliver Grimm and Eric Wieschaus. The bicoid gradient is shaped independently of nuclei. Development,
137(17):2857–2862, 2010. doi: 10.1242/dev.052589.
[44] Jeffrey A. Drocco, Oliver Grimm, David W. Tank, and Eric Wieschaus. Measurement and perturbation
of morphogen lifetime: Effects on gradient shape. Biophysical Journal, 101(8):1807–1815, 2011. doi:
10.1016/j.bpj.2011.07.025.
[45] Shawn C. Little, Gašper Tkačik, Thomas B. Kneeland, Eric F. Wieschaus, and Thomas Gregor. The
formation of the bicoid morphogen gradient requires protein movement from anteriorly localized mRNA.
PLoS Biology, 9(3):e1000596, 2011. doi: 10.1371/journal.pbio.1000596.
47

[46] Jeffrey A. Drocco, Eric Wieschaus, and David W. Tank. The synthesis-diffusion-degradation model explains
bicoid gradient formation in unfertilized eggs. Physical Biology, 9(5):055004, 2012. doi: 10.1088/1478-3975/
9/5/055004.
[47] Stephen Small, Rachel Kraut, Timothy Hoey, Rahul Warrior, and Michael Levine. Transcriptional regulation of a pair-rule stripe in Drosophila. Genes & Development, 5(5):827–839, 1991. doi: 10.1101/gad.5.5.827.
[48] Johannes Jaeger, Manu, and John Reinitz. Drosophila blastoderm patterning. Current Opinion in Genetics
& Development, 22(6):533–541, 2012. doi: 10.1016/j.gde.2012.10.005.
[49] Thomas Gregor, Eric F. Wieschaus, Alistair P. McGregor, William Bialek, and David W. Tank. Stability
and nuclear dynamics of the bicoid morphogen gradient. Cell, 130(1):141–152, 2007. doi: 10.1016/j.cell.
2007.05.026.
[50] Jason S. Leith, Anahita Tafvizi, Fang Huang, William E. Uspal, Patrick S. Doyle, Alan R. Fersht, Leonid A.
Mirny, and Antoine M. van Oijen. Sequence-dependent sliding kinetics of p53. PNAS, 109(41):16552–16557,
2012. doi: 10.1073/pnas.1120452109.
[51] Jiji Chen, Zhengjian Zhang, Li Li, Bi-Chang Chen, Andrey Revyakin, Bassam Hajj, Wesley Legant, Maxime
Dahan, Timothée Lionnet, Eric Betzig, Robert Tjian, and Zhe Liu. Single-molecule dynamics of enhanceosome assembly in embryonic stem cells. Cell, 156(6):1274–1285, 2014. doi: 10.1016/j.cell.2014.01.062.
[52] Alan Carr and Mark D. Biggin. A comparison of in vivo and in vitro DNA-binding specificities suggests a
new model for homeoprotein DNA binding in Drosophila embryos. The EMBO Journal, 18(6):1598–1608,
1999. doi: 10.1093/emboj/18.6.1598.
[53] Joseph Toth and Mark D. Biggin. The specificity of proteinDNA crosslinking by formaldehyde: in vitro
and in Drosophila embryos. Nucleic Acids Research, 28(2):e4, 2000. doi: 10.1093/nar/28.2.e4.
[54] Ho Sung Rhee and B. Franklin Pugh. Comprehensive genome-wide protein-dna interactions detected at
single-nucleotide resolution. Cell, 147(6):1408–1419, 2011. doi: 10.1016/j.cell.2011.11.013.
[55] Kunal Poorey, Ramya Viswanathan, Melissa N. Carver, Tatiana S. Karpova, Shana M. Cirimotich, James G.
McNally, Stefan Bekiranov, and David T. Auble. Measuring chromatin interaction dynamics on the second
time scale at single-copy genes. Science, 342(6156):369–372, 2013. doi: 10.1126/science.1242369.
[56] Robert D. Phair, Paola Scaffidi, Cem Elbi, Jaromra Vecerov, Anup Dey, Keiko Ozato, David T. Brown,
Gordon Hager, Michael Bustin, and Tom Misteli. Global nature of dynamic protein-chromatin interactions
in vivo: Three-dimensional genome scanning and dynamic interaction networks of chromatin proteins.
Molecular and Cellular Biology, 24(14):6393–6402, 2004. doi: 10.1128/MCB.24.14.6393-6402.2004.
[57] Florian Mueller, Paul Wach, and James G. McNally. Evidence for a common mode of transcription factor
interaction with chromatin as revealed by improved quantitative fluorescence recovery after photobleaching.
Biophysical Journal, 94(8):3323–3339, 2008. doi: 10.1529/biophysj.107.123182.
[58] Jasmin Speil, Eugen Baumgart, Jan-Peter Siebrasse, Roman Veith, Uwe Vinkemeier, and Ulrich Kubitscheck. Activated STAT1 transcription factors conduct distinct saltatory movements in the cell nucleus.
Biophysical Journal, 101(11):2592–2600, 2011. doi: 10.1016/j.bpj.2011.10.006.
[59] Meike Kloster-Landsberg, Gaetan Herbomel, Irne Wang, Jacques Derouard, Claire Vourch, Yves Usson,
Catherine Souchier, and Antoine Delon. Cellular response to heat shock studied by multiconfocal fluorescence correlation spectroscopy. Biophysical Journal, 103(6):1110–1119, 2011. doi: 10.1016/j.bpj.2012.07.
041.
[60] Davide Mazza, Alice Abernathy, Nicole Golob, Tatsuya Morisaki, and James G. McNally. A benchmark
for chromatin binding measurements in live cells. Nucleic Acids Research, 40(15):e119, 2012. doi: 10.1093/
nar/gks701.
[61] J Christof M Gebhardt, David M Suter, Rahul Roy, Ziqing W Zhao, Alec R Chapman, Srinjan Basu,
Tom Maniatis, and X Sunney Xie. Single-molecule imaging of transcription factor binding to DNA in live
mammalian cells. Nature Methods, 10(5):421–426, 2013. doi: 10.1038/nmeth.2411.
[62] Tatsuya Morisaki, Waltraud G. Muller, Nicole Golob, Davide Mazza, and James G. McNally. Singlemolecule analysis of transcription factor binding at transcription sites in live cells. Nature Communications,
5:4456, 2014. doi: 10.1038/ncomms5456.
48

[63] Lee Zamparo and Theodore J. Perkins. Statistical lower bounds on protein copy number from fluorescence
expression images. Bioinformatics, 25(20):2670–2676, 2009. doi: 10.1093/bioinformatics/btp415.
[64] Andrei Pisarev, Ekaterina Poustelnikova, Maria Samsonova, and John Reinitz. FlyEx, the quantitative atlas
on segmentation gene expression at cellular resolution. Nucleic Acids Research, 37(suppl 1):D560–D566,
2009. doi: 10.1093/nar/gkn717.
[65] Mark D. Biggin. Animal transcription networks as highly connected, quantitative continua. Developmental
Cell, 21(4):611–626, 2011. doi: 10.1016/j.devcel.2011.09.008.
[66] Jingyi Jessica Li, Peter J Bickel, and Mark D Biggin. System wide analyses have underestimated protein
abundances and the importance of transcription in mammals. PeerJ, 2:e270, 2014. doi: 10.7717/peerj.270.
[67] Eran Segal, Tali Raveh-Sadka, Mark Schroeder, Ulrich Unnerstall, and Ulrike Gaul. Predicting expression
patterns from regulatory sequence in Drosophila segmentation. Nature, 451(7178):535 – 540, 2008. doi:
10.1038/nature06496.
[68] William W. Fisher, Jingyi Jessica Li, Ann S. Hammonds, James B. Brown, Barret D. Pfeiffer, Richard
Weiszmann, Stewart MacArthur, Sean Thomas, John A. Stamatoyannopoulos, Michael B. Eisen, Peter J.
Bickel, Mark D. Biggin, and Susan E. Celniker. DNA regions bound at low occupancy by transcription
factors do not drive patterned reporter gene expression in Drosophila. Proceedings of the National Academy
of Sciences, 109(52):21330–21335, 2012. doi: 10.1073/pnas.1209589110.
[69] Leonid Teytelman, Deborah M. Thurtle, Jasper Rine, and Alexander van Oudenaarden. Highly expressed
loci are vulnerable to misleading ChIP localization of multiple unrelated proteins. PNAS, 110(46):18602–
18607, 2013. doi: 10.1073/pnas.1316064110.
[70] Clifford A. Meyer and X. Shirley Liu. Identifying and mitigating bias in next-generation sequencing methods
for chromatin biology. Nat Rev Genet, 2014. doi: 10.1038/nrg3788.
[71] Myong-Hee Sung, MichaelJ. Guertin, Songjoon Baek, and GordonL. Hager. DNase footprint signatures are
dictated by factor dynamics and DNA sequence. Molecular Cell, 2014. doi: 10.1016/j.molcel.2014.08.016.
[72] Gary D Stormo. DNA binding sites: representation and discovery. Bioinformatics, 16(1):16–23, 2000. doi:
10.1093/bioinformatics/16.1.16.
[73] Panayiotis V. Benos, Alan S. Lapedes, and Gary D. Stormo. Is there a code for protein?DNA recognition?
Probab(ilistical)ly? BioEssays, 24(5):466–475, 2002. doi: 10.1002/bies.10073.
[74] Nicolas E. Buchler, Ulrich Gerland, and Terence Hwa. On schemes of combinatorial transcription logic.
PNAS, 100(9):5136–5141, 2003. doi: 10.1073/pnas.0930314100.
[75] Lacramioara Bintu, Nicolas E. Buchler, Hernan G. Garcia, Ulrich Gerland, Terence Hwa, Jane Kondev,
and Rob Phillips. Transcriptional regulation by the numbers: applications. Current Opinion in Genetics
& Development, 15(2):125–135, 2005. doi: 10.1016/j.gde.2005.02.006.
[76] Zhe Xu, Hongtao Chen, Jia Ling, Danyang Yu, Paolo Struffi, and Stephen Small. Impacts of the ubiquitous
factor Zelda on Bicoid-dependent DNA binding and transcription in Drosophila. Genes & Development,
28:608–621, 2014. doi: 10.1101/gad.234534.113.
[77] DavidY. Rhee, Dong-Yeon Cho, Bo Zhai, Matthew Slattery, Lijia Ma, Julian Mintseris, ChristinaY.
Wong, KevinP. White, SusanE. Celniker, TeresaM. Przytycka, StevenP. Gygi, RobertA. Obar, and Spyros
Artavanis-Tsakonas. Transcription factor networks in drosophila melanogaster. Cell Reports, 2014. doi:
10.1016/j.celrep.2014.08.038.
[78] Ulrich Gerland, J. David Moroz, and Terence Hwa. Physical constraints and functional characteristics of
transcription factor-DNA interactions. PNAS, 99(19):12015–12020, 2002. doi: 10.1073/pnas.192693599.
[79] Nicolae Radu Zabet and Boris Adryan. GRiP: a computational tool to simulate transcription factor binding
in prokaryotes. Bioinformatics, 28(9):1287–1289, 2012. doi: 10.1093/bioinformatics/bts132.
[80] Nicolae Radu Zabet. System size reduction in stochastic simulations of the facilitated diffusion mechanism.
BMC Systems Biology, 6(1):121, 2012. doi: 10.1186/1752-0509-6-121.
[81] Jeroen S. van Zon, Marco J. Morelli, Sorin Tanase-Nicola, and Pieter Rein ten Wolde. Diffusion of transcription factors can drastically enhance the noise in gene expression. Biophysical Journal, 91(12):4350–4367,
2006. doi: 10.1529/biophysj.106.086157.
49

