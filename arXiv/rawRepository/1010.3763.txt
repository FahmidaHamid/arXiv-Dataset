A CIRCULAR ORDER ON EDGE-COLOURED TREES AND RNA
m-DIAGRAMS

arXiv:1010.3763v5 [math.CO] 22 Sep 2013

ROBERT J. MARSH AND SIBYLLE SCHROLL
Abstract. We study a circular order on labelled, m-edge-coloured trees with k
vertices, and show that the set of such trees with a fixed circular order is in bijection
with the set of RNA m-diagrams of degree k, combinatorial objects which can be
regarded as RNA secondary structures of a certain kind. We enumerate these sets
and show that the set of trees with a fixed circular order can be characterized as an
equivalence class for the transitive closure of an operation which, in the case m = 3,
arises as an induction in the context of interval exchange transformations.

1. Introduction
Interval exchange transformations are, roughly speaking, a generalization of a rotation
of a circle. More precisely, given a partition of the unit interval into smaller segments,
an interval exchange transformation is a map from the unit interval to itself where
the segments are rearranged according to a choice of permutation. Recently there has
been particular interest in the class of interval exchange transformations induced by
the permutation (k k − 1 · · · 1). In [2] a combinatorial interpretation in terms of an
induction proccess on labelled trees with edges coloured with 3 possible colours, called
trees of relations, has proven a fruitful tool leading to new results in the understanding
of the associated languages. In this paper we extend this combinatorics by defining a
generalization of the induction process to the case of labelled trees with edges coloured
with m possible colours and study its properties.
Given positive integers k and m, an m-edge-coloured tree with k vertices is a tree
whose edges are labelled with m possible colours in such a way that no vertex is incident
with two edges of the same colour. It is said to be labelled if its vertices are labelled with
{1, 2, . . . , k}. Such trees were shown to possess a circular order in the case m = 3 in [2]
corresponding to the permuation of the interval exchange transformation. By giving a
new proof of this fact, we show that the circular order can be generalized to arbitrary
m and we study its relation to the generalized induction proccess we define.
Firstly, we show that the set T k,m of labelled m-edge-coloured trees with k vertices
and a fixed circular order is in bijection with a collection of combinatorial objects consisting of collections of noncrossing arcs in a disk with coloured marked points on its
boundary, satisfying a certain matching rule. Such diagrams can be regarded as generalized RNA secondary structures of a certain kind, in the sense of [13], drawn in the
Nussinov circle representation [10], so we refer to them as RNA m-diagrams of degree k.
Such a bijection was given for the case m = 3 in [2].
Date: 22 September 2013.
Key words and phrases. tree, edge-coloured, labelled triangulation, Fuss-Catalan number, enumeration, tree of relations, RNA secondary structure, polygon, m-angulation, induction, interval exchange
transformation, RNA m-diagram.
2010 Mathematics Subject Classification: Primary: 05C05, 05A15; Secondary: 37B10.
This work was supported by the Engineering and Physical Sciences Research Council [grant number
EP/G007497/1], the Mathematical Sciences Research Institute (MSRI) in Berkeley, California, and by
the Leverhulme Trust in the form of an Early Career Fellowship for Sibylle Schroll.
1

2

MARSH AND SCHROLL

We compute the cardinality of T k,m (and thus also the number of RNA m-diagrams
of degree k) using the well-known correspondence between trees and m-angulations
of a polygon which induces a bijection with a collection of appropriately labelled mangulations
We prove the existence of a transformation of labelled m-edge-coloured trees preserving the circular order. We call this transformation generalized induction as it generalizes
the induction in the case m = 3, studied combinatorially in [2]. In [4] it was shown
that this induction (for m = 3) gives rise to languages naturally generalizing Sturmian
languages and arising from interval exchange transformations. We also give an example
showing that the most straightforward generalization of this induction to the case m > 3
does not in general preserve the circular order.
We go on to show that the equivalence classes of the transitive closure of the generalized induction are characterized by the circular order. Thus the set of equivalence
classes is in bijection with the set of k-cycles in the symmetric group of degree k.
Finally, motivated by snake-triangulations and m-snakes in cluster theory, we give an
interpretation of the generalized induction process in terms of labelled m-angulations of
polygons.
This article is structured as follows. In Section 2, we introduce the combinatorial
objects considered in the paper. In Section 3 we give the bijections mentioned above
and compute the cardinality of the set of labelled m-edge-coloured trees with a fixed
circular order. In Section 4 we show that the circular order characterizes the equivalence
classes of the transitive closure of the generalized induction and in section 5 we show
that induction can be given by a composition of flips of diagonals in an m-angulation.
2. Some combinatorial objects
We first introduce the main combinatorial objects we will be considering: edgecoloured trees, RNA m-diagrams, and m-angulations.
Given positive integers k, m, we consider m-edge-coloured trees on k vertices, i.e.
trees whose edges are coloured with one of the m symbols S1 , S2 , . . . , Sm in such a
way that no two edges incident with the same vertex have the same colour. We say
that such a tree is labelled if its vertices are labelled with {1, 2, . . . , k}. As usual, if
the connectedness assumption is not satisfied, we refer to the corresponding objects as
forests. See Figure 3(b) for an example of a (rooted) m-edge-coloured tree and (c) for
an example of a labelled m-edge-coloured tree.
Given an m-edge coloured tree S with k vertices, each symbol Sr determines a map
(with the same name) from the set of vertices of S to itself. A vertex is fixed by Sr
unless it is incident with an edge coloured Sr , in which case it is sent to the vertex at the
other end of that edge. Let σS be the composition Sm Sm−1 · · · S1 : this is a permutation
of the vertices of S. We use the same definition for a labelled m-edge coloured tree,
G, obtaining a permutation σG in the symmetric group of degree k. We refer to σS
(respectively, σG ) as the circular order of S (respectively, G). In the 3-symbol case
these maps were considered in [2]. The circular order is always a k-cycle:
Lemma 2.1. Let G be a labelled m-edge-coloured tree with k vertices. Then the circular
order σG of G is a k-cycle.
Proof. This is clearly true if k = 1 or 2. Suppose it holds for smaller values of k. Let v
be a vertex of G which is not a leaf. Suppose that v is incident with edges e1 , e2 , . . . , ed
in G, coloured with Sr1 , Sr2 , . . . , Srd respectively, where r1 < r2 < · · · < rd . Let the
end-points of these edges (other than v) be v1 , v2 , . . . , vd . Removing v from G leaves d
subtrees G′1 , G′2 , . . . , G′d incident with v1 , v2 , . . . , vd respectively. Let Gi be the subtree
G′i with v and ei reattached to vi .

A CIRCULAR ORDER ON EDGE-COLOURED TREES

3

By the inductive hypothesis the σGi are all cycles. Hence, repeatedly applying σG1
to v cycles through the vertices of G1 . Since σG = σG1 on all vertices of G1 except
−1
(v), repeatedly applying σG also cycles through all the vertices of G1 . Since r2
w = σG
1
is minimal such that Sr2 is a symbol colouring an edge incident with v with r2 > r1 ,
σG (w) will lie in G′2 . In fact σG (w) = σG2 (v), since in G2 , v is not incident with any edge
with symbol other than Sr2 . Repeatedly applying σG then cycles through the vertices
−1
of G′2 before coming back to σG
′ (v). Repeating this argument, we see that repeatedly
2
applying σG to v first cycles through G′1 , then through G′2 , G′3 , . . . , G′d in order before
eventually returning to v.

Next, we define an RNA m-diagram of degree k as follows. We take k vertices
1, 2, . . . , k, numbered clockwise around a circle. Each vertex contains the symbols
S1 , S2 , . . . , Sm written in clockwise order. A collection of arcs connect equal symbols
at different vertices. A symbol at a vertex can be incident to at most one arc. Such
a diagram is noncrossing if it can be drawn in such a way that there are no crossings
between the arcs. We say that it is connected provided there is a path between any two
vertices (where moving between symbols at a vertex is allowed). See Figure 3(a) for an
example of a connected noncrossing RNA 4-diagram of degree 10.
Diagrams of this kind (but with different rules) have been considered in [1] in the
context of Fuss-Catalan algebras. Such diagrams can be regarded as a certain kind of
abstract RNA secondary structures in the sense of [13] (see also [8, §5]), drawn in the
Nussinov circle representation [10].
Finally, let P be an (m − 2)k + 2-sided regular polygon. An m-angulation of P is
a collection of diagonals dividing P into k m-gons. We say that an m-angulation of
P is diagonal-coloured if each diagonal in P is coloured with a symbol from the set
{S1 , S2 , . . . , Sm } in such a way that the colours on the sides of each m-sided polygon in
the m-angulation are S1 , S2 , . . . , Sm in clockwise order. We say that it is rooted if there
is a distinguished m-sided polygon in the m-angulation. We say that it is m-gon-labelled
if the m-gons are labelled 1, 2, . . . , k.
3. Bijections
Our main aim in this section is to compute the number of connected noncrossing RNA
m-diagrams of degree k and to give a bijective proof that this is the same as the number
of labelled m-edge-coloured trees with k vertices and circular order (k k − 1 · · · 1).
Theorem 3.1. There is a bijection between the following sets:
(I) The set of degree k noncrossing RNA m-diagrams.
(II) The set of labelled m-edge-coloured forests G with k vertices such that, on writing
G = ⊔i Gi as a union of connected components, we have the following:
(a) If i 6= j and a1 , a2 ∈ Gi , b1 , b2 ∈ Gj , we cannot have that a1 > b1 > a2 > b2 .
(b) If a ∈ Gi for some i, then σG (a) is the maximal vertex of G less than a
lying in Gi (or, if no such vertex exists, it is the largest vertex of G lying
in Gi ).
Proof. Let Σ be a noncrossing RNA m-diagram of degree k on m symbols as in (I).
Let G be the labelled m-edge-coloured graph with k vertices whose edges given by
the arcs of Σ. That is, there is an edge between vertices i and j of G coloured with Sk
if and only if there is an arc in Σ between the instances of the symbol Sk in vertices i
and j in Σ.
Claim: G is a forest.
We prove the claim. Suppose, for a contradiction, there is a cycle
a1

Si1

a2

Si2

···

ap−1

Sip−1

ap

Sip

a1

4

MARSH AND SCHROLL

S1 a1
Si1
Sip
Sm

Sm

ap Sip
Sip−1
S1

S1
Si1
Si2 a2
Sm
S
Si2 1
S
i
3
Sm a
3
Figure 1. A cycle in G leads to a crossing

in G, and thus a corresponding cycle in Σ. Without loss of generality, we may assume
that i1 < i2 . For vertices a, b, we denote by (a, b) the set of vertices c of Σ lying strictly
clockwise of a and strictly anticlockwise of b.
Then a3 ∈ (a2 , a1 ), since the arc in Σ corresponding to the edge in G between a2 and
a3 cannot cross the arc in Σ corresponding to the edge in G between a1 and a2 .
By assumption on Σ, i2 6= i3 . If i2 > i3 , there can be no path in Σ from the symbol
Si3 in vertex a3 of Σ back to vertex a1 of Σ without crossings, a contradiction, hence
i2 < i3 .
Repeating this argument, we see that, moving clockwise on Σ from a1 we meet vertices
a2 , a3 , . . . , ap in order before returning to a1 , and that i1 < i2 < · · · < ip . But then the
arc between ap and a1 (on symbol Sip crosses the arc between a1 and a2 (on symbol
Si1 ), since i1 < ip ; see Figure 1. Hence G has no cycles, and must be a tree. The claim
is shown.
We next prove that (a) holds. Suppose that i 6= j, a1 , a2 ∈ Gi , b1 , b2 ∈ Gj , and
a1 > b1 > a2 > b2 . Then a1 , b1 , a2 , b2 follow each other anticlockwise around the circle.
Then, since a1 , a2 are in the same connected component of G, there is a path in Σ from
a1 to a2 , and similarly from b1 to b2 . The arrangement of a1 , a2 , b1 and b2 implies that
these two paths cross, a contradiction. Hence no such arrangement can occur, and (a)
is shown.
We next prove that (b) holds. It is enough to prove the following claim:
Claim: Let a ∈ Gi . Then σG (a) is the next vertex of Gi (considered as a vertex of
Σ) anticlockwise on the circle from a.
To prove the claim, we note that, by the definition of σG , σG (a) is connected to a by
a path in G:
a = a1

Si1

a2

Si2

···

···

Sip−1

ap = σG (a) ,

where i1 < i2 < · · · < ip−1 . Furthermore, a1 is not incident with any arc with symbol
Sr for r < i1 , ap is not incident with any arc with symbol Sr for r > ip−1 , and, for
2 ≤ j ≤ p − 1, aj is not incident with any symbol Sr for ij−1 < r < ij .
The existence of the above path implies that σG (a) lies in Gi . Since i1 < i2 <
· · · < ip and there are no crossings, the path must go clockwise around the circle; see
Figure 2. The conditions above and the fact there are no crossings imply that no vertex
in (σG (a), a) has an arc with a vertex in (a, σG (a)) or with a or σG (a), so these vertices
are connected only amongst themselves. It follows that they do not lie in Gi and we see
that (II)(b) holds. Thus G is a labelled m-edge-coloured forest satisfying (II).

A CIRCULAR ORDER ON EDGE-COLOURED TREES

Sm

σ(a) = ap S
ip
Sip−1
S1

5

S1 a = a1
Si1
Sip
Sm
S1
Si1
Si2 a2
Sm
S
Si2 1
S
i
Sm 3 a
3

Figure 2. The part of Σ between a and σG (a).
Conversely, suppose that we have a labelled m-edge-coloured forest with k vertices
satisfying (II). Let Σ be the RNA m-diagram of degree k with an arc joining Sr in vertex
i with Sr in vertex j if and only if there is an edge in G between vertices i and j coloured
with symbol Sr . We must check that Σ can be drawn with no crossing arcs, i.e. that it
is noncrossing.
We do this by induction on the number of vertices. Suppose first that G has more than
one connected component, i.e. that G is not connected. By induction, each component
Gi corresponds to a noncrossing RNA m-diagram (on the vertices of Gi ).
Suppose that we had a1 > a2 ∈ Gi and b1 > b2 ∈ Gj for two distinct components
Gi and Gj , with arcs between a1 and a2 and b1 and b2 which cross in Σ. Then, going
around the circle anticlockwise, starting at vertex k, we must encounter a1 , b1 , a2 , b2 in
order, or b1 , a1 , b2 , a2 in order. Swapping Gi and Gj if necessary, we can assume we
are in the first case. But then a1 > b1 > a2 > b2 , contradicting (II)(a). Hence Σ is
noncrossing.
So we are reduced to the case in which G has exactly one connected component, i.e. G
is connected. Suppose that vertex k is incident with edges e1 , e2 , . . . , ed in G, coloured
with symbols Sr1 , Sr2 , . . . , Srd where r1 < r2 < . . . < rd . Let the endpoints of these
edges (other than k) be v1 , v2 , . . . , vd . Removing vertex k from G leaves precisely d
trees T1 , T2 , . . . , Td containing vertices v1 , v2 , . . . , vd respectively. By (b), we know that
σG = Sm Sm−1 · · · S1 induces the permutation (k k − 1 · · · 1) on the vertices of G.
We apply σG to vertex k, and then repeatedly apply σG . By its definition, each
application of σG corresponds to following a certain path through G, i.e. passing along
the edges corresponding to the symbols in the sequence S1 , S2 , . . . , Sm in that order,
when such incident edges exist. Since the edge e1 has symbol Sr1 , and no edge incident
with k has smaller symbol, it follows that, after the first application of σG , we obtain
vertex k1 := k − 1 in T1 .
Since σG is a k-cycle, after repeated application of σG , we must leave T1 . Suppose
that k2 is the number of the first vertex reached outside T1 . Since r2 is the minimum
number of a symbol adjacent to k greater than r1 , k2 will lie in T2 . Repeating this
argument, we will obtain k > k1 > k2 > · · · > kd ≥ 1 such that vertices ki+1 + 1, . . . , ki
lie in tree Ti for i = 1, 2, . . . , d − 1. At the final step, the first vertex reached on leaving
Td must be k. Since σG is a k-cycle, all vertices must have been visited.
Let kd+1 = 0. It follows from the above that tree Ti contains precisely vertices
ki+1 + 1, . . . , ki for each i. Thus, the numbering of the vertices of G is first the vertices
of Td in some order, then the vertices of Td−1 in some order, then the vertices of Td−2 ,
and so on, ending with the vertices of T1 and then finally k. Each Ti will correspond
(by the inductive hypothesis) to a noncrossing RNA m-diagram on its vertices. Thus
the vertices v1 , v2 , . . . , vd in G will be numbered in decreasing order. The arcs in Σ

6

MARSH AND SCHROLL

from k to these vertices are numbered by symbols Sr1 , Sr2 , . . . , Srd , respectively, with
r1 < r2 < · · · < rd . It follows these arcs do not cross each other or any of the other arcs
in Σ. See Figure 3(a) for an example, where v1 = 9, r1 = 1, and v2 = 8, r2 = 4. Hence,
Σ is noncrossing and thus an object in (I) as required.
It is clear that the two maps we have constructed are inverse to each other, so the
theorem is proved.

The following lemma follows easily from the definitions.
Lemma 3.2. A noncrossing RNA m-diagram is connected if and only if the corresponding labelled m-edge-coloured forest is connected, i.e. is a tree.
Remark 3.3.
(1) Since a forest on k vertices is connected if and only if it has
exactly k − 1 edges, a noncrossing RNA m-diagram with k vertices is connected
if and only if it has k − 1 arcs.
(2) In the connected case, the circular order of G is just the permutation (k k −
1 · · · 1) and we have a bijection between the following sets:
The set of connected noncrossing RNA m-diagrams of degree k.
l
The set of labelled m-edge-coloured trees with k vertices and circular order
(k k − 1 · · · 1).
(3) The labelling on the vertices for a tree in the latter set in (2) is determined by
a distinguished vertex, that labelled k, say, since σG then determines the labels
on all the other vertices.
By Remark 3.3 and Lemma 2.1 we have:
Corollary 3.4. The bijection in Theorem 3.1 induces a bijection between the following
sets:
(a) The set of connected noncrossing RNA m-diagrams of degree k.
(b) The set of rooted m-edge-coloured trees with k vertices.
(c) The set of labelled m-edge-coloured trees with k vertices and circular order (k k −
1 · · · 1).
See Figure 3(a)-(c) for an illustration of this bijection. The following is well-known;
see, for example, [12, Sect. 6.2] (adding the labelling is straightforward).
Theorem 3.5. There is a bijection between the following sets:
(a) The set of m-edge-coloured trees with k vertices.
(b) The set of diagonal-coloured m-angulations of an (m − 2)k + 2-sided regular
polygon up to rotation.
Corollary 3.6. There is a bijection between the following sets:
(a) The set of labelled m-edge-coloured trees with k vertices and circular order (k k −
1 · · · 1).
(b) The set of rooted diagonal-coloured m-angulations of an (m−2)k+2-sided regular
polygon up to rotation.
Proof. This follows from Theorem 3.5 and Corollary 3.4.



Corollary 3.7. The cardinality of each of the following sets:
(a) The set of labelled m-edge-coloured trees with k vertices and circular order (k k −
1 · · · 1);
(b) The set of connected noncrossing RNA m-diagrams of degree k;
is given by


(m − 1)k
m
.
Tk,m =
(m − 2)k + 2
k−1

A CIRCULAR ORDER ON EDGE-COLOURED TREES

7

1
10

S1S2S3S4

S4
S3

S
S1 2
9

S4
S3
S2
S1

S1 2
S2
S3
S4
S1
S2 3
S3
S4
S1
S2
S3 4
S4

S4
S3
8 S2
S1
S4
S3
S2
S1
7

S1
S2
S3

S4 S3 S2 S1 S4

5

6
(a) A connected noncrossing RNA 4-diagram of
degree 10.
6

S1
S2
S4

7

S4
S3

S1

S3

S2

S4

S2

S1

S1

S1

10

8

S4
S3

5

S1

1

S3

3

4

S2
2

9

(b) A rooted 4-edge-coloured tree with 10
vertices.

(c) A labelled 4-edge-coloured tree with 10
vertices and circular order (10 9 · · · 1).

Figure 3. Objects corresponding to each other under the bijections in Corollary 3.4.
Proof. Both sets have the same cardinality by Corollary 3.4 and, by Corollary 3.6,
they have the same cardinality as the set of rooted diagonal-coloured m-angulations
of an (m − 2)k + 2-sided regular polygon up to rotation. The number Sk,m of such
m-angulations without a root, with no labelling of diagonals and ignoring rotational
equivalence is well-known (see e.g. [7]). Let Ckm be the kth Fuss-Catalan number of
degree m:

 

1 mk
1
mk
Ckm =
=
.
k k−1
(m − 1)k + 1 k
Then


1
(m − 1)k
Sk,m = Ckm−1 =
.
(m − 2)k + 1
k
Since there are k m-sided polygons in an m-angulation, there are k possibilities for
the root. There are m possibilities for a labelling since once one diagonal is coloured, all
other diagonals in the m-angulation have determined colours using the rule that each
m-gon must have its edges coloured S1 , S2 , . . . , Sm clockwise around the boundary. Each
orbit of diagonal-coloured rooted m-angulations under the action of the rotation group
of the polygon contains (m − 2)k + 2 elements (the number of sides of P ). Hence, we
have:
kmSk,m
Tk,m =
(m − 2)k + 2
and the result follows.


8

MARSH AND SCHROLL

It is interesting to note that by [9, §3], the sequence T1,m , T2,m , . . . is the m-fold
convolution of the sequence S0,m , S1,m , . . ..
Example 3.8. For m = 3, 4, 5, 6, the first few values of Tk,m are given in the following
table:
k
0 1 2 3
4
5
6
Tk,3 1 1 3 9 28
90
297
Tk,4 1 1 4 18 88 455 2448
Tk,5 1 1 5 30 200 1425 10626
Tk,6 1 1 6 45 380 3450 32886
The cases m = 3, 4 are sequences A071724 and A006229, respectively, in [11]; the cases
m = 5, 6 do not appear. The case m = 3 appears in [2, Prop. 7.5].
Corollary 3.9. The total number of labelled m-edge-coloured trees with k vertices is:
Uk,m =

m((m − 1)k)!
((m − 2)k + 2)!

Proof. By Lemma 2.1, the circular order of any labelled m-edge-coloured tree with k
vertices is a k-cycle. By Corollary 3.7 the number of such trees with a given circular order
1
is Tk,m . Since any k-cycle can arise, we have Uk,m = (k−1)!
Tk,m , giving the result. 
Note that this result is already known [3], [12, 5.28, p124].
4. generalized Induction
In this section we give the definition of a generalized induction on labelled m-edgecoloured trees with k vertices. Generalized induction generates new labelled m-edgecoloured trees with the same number of vertices starting with a given such tree, and
the transitive closure is an equivalence relation. We show that the circular order is
an invariant, giving rise to a classification of the equivalence classes by k-cycles in the
symmetric group of degree k.
Given a labelled m-edge-coloured tree G and integers i, j ∈ {1, . . . , m} we define a
maximal Si - Sj chain B in G to be a (linear) subtree of G whose edges are only coloured
Si and Sj such that no other edges incident to B are coloured by Si or Sj .
Definition 4.1. Let G be a labelled m-edge-coloured tree with k vertices. Fix i, j ∈
B
{1, . . . , m} with i < j. Let B be a maximal Si − Sj chain in G. Define Ri,j
(G) to be
the labelled m-edge-coloured tree with k vertices obtained from G by
• first removing all subtrees in the complement of the maximal chain B
• interchanging the vertices of each edge of B coloured by Sj
• interchanging the symbols Si and Sj on the whole maximal chain B
• reattaching the previously removed subtrees to B at the vertices with the same
label they were removed from.
Similarly, define LB
i,j (G), where in the second bullet point in the above definition we
interchange the vertices of each edge coloured by Si rather than those coloured by Sj .
B
B
and LB
We also set RiB := Ri,i+1
i := Li,i+1 and we will write Ri and Li if B is clear
from the context.
Remark 4.2.
(1) Induction can also be defined on m-edge-coloured trees: For an
m-edge-coloured tree with k vertices, choose an arbitrary vertex-labelling, apply induction, and then remove the vertex labelling. It is clear that this is
independent of the vertex-labelling chosen.
B
(2) The inductions Ri,j
and LB
i,j are mutually inverse maps.

A CIRCULAR ORDER ON EDGE-COLOURED TREES

9

Lemma 4.3. Let i, j ∈ {1, . . . , m} with i < j and B be a maximal Si − Sj -chain with
no incident edges coloured by Si+1 , . . . , Sj−1 . Then we have
B
Ri,j
(G) = Li Li+1 · · · Lj−2 Rj−1 Rj−2 Rj−3 · · · Ri
= Rj−1 Rj−2 · · · Ri+1 Ri Li+1 Li+2 · · · Lj−1 ;

LB
i,j (G) = Li Li+1 · · · Lj−2 Lj−1 Rj−2 Rj−3 · · · Ri
= Rj−1 Rj−2 · · · Ri+1 Li Li+1 Li+2 · · · Lj−1 ,
where, in each case, the inductions of form Rp and Lp are applied to all maximal chains
B
contained in B. In particular, the induction Ri,j
(G) can be written as a product of
inductions of the form Rp or Lp for p = i, i + 1, . . . , j − 1.
Proof. Suppose first that B has the following form:
Si

a1

a2

Sj

Si

a3

···

a4

ar−1

Si

ar .

B
Then, in Ri,j
(G), B ′ becomes the chain

B ′ = a1

Sj

a3

Si

a2

Sj

a5

Si

a4

···

ar−2

Sj

ar .

On the other hand, applying Rj−2 Rj−3 · · · Ri+1 Ri (with each induction applying to all
the maximal chains of the appropriate type contained in B), we obtain the maximal
Sj−1 − Sj -chain
a1

Sj−1

a2

Sj

a3

Sj−1

a4

···

ar−1

Sj−1

ar .

B
Next, apply Rj−1
to get the maximal Sj−1 − Sj chain:

a1

Sj

a3

Sj−1

a2

Sj

a5

···

ar−2

Sj

ar .

It is then clear that subsequently applying Li Li+1 · · · Lj−2 (in each case applying the
induction to all the maximal chains of appropriate type contained in the full subgraph
on the vertices a1 , a2 , . . . , ar ) gives the chain B ′ .
The proof works in a similar way for the other configurations of maximal Si − Sj chains, i.e. for the above case with Si and Sj switched and for the chains of the form
a1

Si

a2

Sj

a3

Si

a4

···

ar−1

a4

···

ar−1

Sj

ar

and
a1

Sj

a2

Si

a3

Sj

The other identities are proved similarly.

Sj

ar .


Definition 4.4. Call two labelled m-edge-coloured trees with k vertices G, G′ induction
equivalent if there is a sequence of inductions taking G to G′ , either of the form Li , for
1 ≤ i ≤ m − 1 or of the form Ri , for 1 ≤ i ≤ m − 1. Clearly this is a reflexive relation. It
is symmetric since Li and Ri are inverse maps and it is easy to see that it is transitive.
Hence it is an equivalence relation. We write Γ(G) for the equivalence class containing
G.
We next show that two labelled m-edge-coloured trees with k vertices are induction
equivalent if and only if they have the same circular order. Firstly, Lemmas 4.5 and 4.6
show that the circular order is invariant under an induction of the form Ri or Li . Key to
showing the converse is Proposition 4.8, which shows that every labelled m-edge coloured
tree is induction equivalent to one whose labels are only S1 and Sm , which is necessarily
a line. This, together with a calculation of the order of induction (Lemma 4.9) allows a
counting argument for proving the converse; see Theorem 4.11.

10

MARSH AND SCHROLL

6
S2
G

1

S1

2

S3

3
a

S1

S3

4

5

R1,3
6
G′
1

S3

3
a

S1

2

S3

5

S1

S2
4

2,3,4,5
Figure 4. The induction R13
does not preserve the circular order:
σG (3) = 6 while σG′ (3) = 5

Lemma 4.5. Let G be a labelled m-edge-coloured tree with k vertices containing a maximal Si -Sj chain B with no incident edges coloured Sl , i < l < j. Then the circular
B
order, σG , is unchanged after an induction of the form Ri,j
or LB
i,j is applied.
Proof. We show the result for Ri,j -induction (the proof for Li,j -induction follows a
similar argument).
Let G be a labelled m-edge-coloured tree with k vertices and circular order σG and
containing a maximal Si -Sj -chain B such that no edges coloured Sl , for i < l < j are
B
incident to B. Let G′ = Ri,j
(G) with circular order σG′ . Let a be a vertex in B.
′
′
Let S1 , . . . Sm denote the maps corresponding to the symbols S1 , . . . , Sm in the labelled
m-edge-coloured tree G′ . There are two possible situations to consider.
Case 1 : Suppose first that a has edges incident to it which are coloured with labels
St with 1 ≤ t < i. Consider the edge e incident with a coloured with label Sr with r
minimal. Let T be the subtree of G \ B connected to a via e. Then σG (a) lies in T .
B
to G results in an m-edge-coloured tree G′ in which a is
Applying the induction Ri,j
reconnected to T by edge e, still coloured with Sr . We see that σG (a) = σG′ (a).
Case 2 : Suppose that a is not incident with any edges coloured with Sl for l < i. An
easy case-by-case check verifies that Sj′ Si′ (a) = Sj Si (a), so Sj′ · · · S1′ (a) = Sj · · · S1 (a).
Any edges incident with Sj Si (a) with label Sl for l > j are reattached to the same vertex
in G′ with the same label. It follows that σG (a) = σG′ (a).

Corollary 4.6. The circular orders of two induction equivalent labelled m-edge-coloured
trees with k vertices are the same.
Proof. In Lemma 4.5 assume that j = i + 1.



Remark 4.7. In general, the circular order of a labelled m-edge-coloured tree with k
vertices is not invariant under general inductions of the form Ri,j and Li,j with i < j + 1:
in the above proof suppose that we have an edge e coloured Sl , for i < l < j connected
to Si (a) in the chain B of G and let T be a subtree of G connected to e. Then σG (a)
B
lies on the subtree T . On the other hand in Ri,j
(G), the edge Sk is connected to
Si (a) = Si′ Sj′ Si′ (a) and thus σG′ (a) 6= σG (a) in general. For an example of this with
i = 1 and j = 3 (and T just consisting of the vertex 6), see Figure 4.
Note that this implies that it is not possible, in general, to write Ri,j as a composition
of inductions of the form Ri and Li , since such inductions preserve the circular order
(by Lemma 4.5). However, Lemma 4.3 says that sometimes this is possible, however.
Proposition 4.8. Let G be a labelled m-edge-coloured tree with k vertices. Then there
exists a labelled m-edge-coloured tree, induction equivalent to G, whose edges are only
coloured by S1 and Sm .

A CIRCULAR ORDER ON EDGE-COLOURED TREES

11

Proof. We first show that there exists a labelled m-edge-coloured tree G2 with k vertices
that is induction equivalent to G, none of whose edges is coloured with S2 , by removing
the symbols S2 one by one. Firstly, remove all edges coloured with symbols S4 , . . . , Sm
e By [2, Prop. 5.2] there exists a
and call the resulting labelled 3-edge-coloured tree G.
e to a labelled 3-edge-coloured
sequence of inductions of the form R1 and L2 taking G
e
e2 with
tree G2 with no edge coloured S2 . Let G2 be the labelled m-edge-coloured tree G
the detached edges reattached (to the vertices with the same label). Since none of the
detached edges are coloured with S1 , S2 , or S3 this sequence of inductions also takes G
e with corresponding maximal chains in G.
to G2 by identifying maximal chains in G
Suppose we have shown that G is induction equivalent to Gl−1 , where Gl−1 has no
edges coloured S2 , . . . , Sl−1 .
Then detach all edges coloured Sl+2 , . . . , Sm from Gl−1 . Call the resulting labelled
e By [2, Prop. 5.2] there is a sequence of inductions of the form
m-edge-coloured tree G.
e to G
el , where G
e l has no edges coloured S2 , . . . , Sl . Reattach
R1,l and Ll = Ll,l+1 taking G
the detached edges and call the resulting labelled m-edge-coloured tree Gl . Since none
of the reattached edges are coloured by S1 , Sl , or Sl+1 , this sequence of inductions takes
e with the maximal chains in Gl−1 .
Gl−1 to Gl by identifying the maximal chains in G
By Lemma 4.3, each application of R1,l can be written as a composition of inductions
Rp , Lp , p = 1, 2, . . . , l − 1, since Gl−1 has no edges coloured S2 , . . . , Sl−1 .
Note that none of the symbols S2 , . . . , Sl appears in Gl . Hence, by induction on l, we
can construct Gm−1 = G′ with no symbols S2 , . . . , Sm−1 and a sequence of inductions,
each of the form Rp or Lp , with 1 ≤ p ≤ m − 1, taking G to G′ .

Lemma 4.9.
(a) Let k be odd, let i 6= j and let G be a labelled m-edge-coloured
tree with k vertices whose edges are coloured with Si and Sj only. Let S be the
underlying unlabelled tree of G. Then Ri,j and Li,j have order k on G, producing
k distinct trees with shape S.
(b) Let k be even, i 6= j and let G be a labelled m-edge-coloured tree with k vertices
and whose edges are coloured with Si and Sj only. Let S be the underlying
unlabelled tree of G. Then Ri,j and Li,j have order k on G, producing k/2
distinct labelled trees whose underlying unlabelled tree is S in each case and k/2
distinct labelled trees whose underlying unlabelled tree is Ri,j (S).
Proof. (a) Since S contains only the symbols Si and Sj , it is a line. Suppose the
line is drawn horizontally and suppose the leftmost edge has colour Sj and vertices a1
G d
and a2 from left to right. Then in (Ri,j
) (G), if it is drawn with orientation given by
Si

Sj

a1
· (where one of the edges may not exist), the vertex a1 is the dth vertex
·
G d
from the left. It is clear that all the induced trees (Ri,j
) (G) have the same underlying
unlabelled tree (those for d odd should be read from right to left).
(b) The proof is similar to the one in (a), except that for d odd, the underlying
G d
unlabelled tree of (Ri,j
) (G) is Ri,j (S).

Remark 4.10. Since in the context of Lemma 4.9 the underlying unlabelled tree of G
is a line, we can replace Ri,j or Li,j in Lemma 4.9 by one of the products in Lemma 4.3.
We finally obtain:
Theorem 4.11. Let G and G′ be labelled m-edge-coloured trees with k vertices. Then
G′ is in Γ(G) if and only if σG = σG′ .
Proof. Suppose that G′ is in Γ(G). We have, by Lemma 4.6, that σG = σG′ . Conversely,
suppose that σG = σG′ . By Proposition 4.8 there exist labelled m-edge-coloured trees
with k vertices, G∗ , in Γ(G) and G′∗ in Γ(G′ ) where the underlying unlabelled trees of
G∗ and G′∗ contain symbols S1 and Sm only.

12

MARSH AND SCHROLL

Suppose that k is odd and that G∗ and G′∗ are as follows:
G∗ : a1

S1

S1

G′∗ : a′1

Sm

a2

Sm

a′2

S1

a3

S1

a′3

a4

···

ak−1

a′4

···

a′k−1

Sm

Sm

ak
a′k .

Then
σG∗ = (a1 a3 a5 . . . ak ak−1 ak−4 . . . a2 ) = (a′1 a′3 a′5 . . . a′k a′k−1 a′k−4 . . . a′2 ) = σG′∗ .
Because the underlying unlabelled tree of G′∗ is a line, G′∗ is determined by a′1 and
its circular order. Thus, given G∗ there are at most k possibilities for G′∗ such that
σG∗ = σG′∗ holds.
By Lemma 4.9 and Lemma 4.6, repeatedly applying either Ri,j -induction or Li,j induction to G∗ gives k distinct labelled m-edge-coloured trees H with k vertices satisfying σG∗ = σH . Hence any G′∗ such that σG∗ = σG′∗ must be one of these trees H.
Therefore, using Remark 4.10, G′∗ is in Γ(G∗ ) and thus G′ is in Γ(G).
Suppose that k is even. In this case, there are at most k/2 distinct possibilities for
G′∗ because of the symmetry of the underlying unlabelled tree. The result then follows
from Lemma 4.9, Remark 4.10, and Lemma 4.6 as above.

Lemma 4.12. Let G be a labelled m-edge-coloured tree with k vertices containing a
maximal Si -Sj chain B with l vertices and no incident edges coloured Sl , i < l < j.
B
Then Ri,j
has order l on G. In particular, Ri and Li have finite order on any maximal
chain in G.
Proof. This follows easily from Lemma 4.9.



Let G be a labelled 3-edge-coloured tree with k vertices. Let Γ′ (G) be the smallest
set of labelled 3-edge-coloured trees with k vertices closed under R1 and L2 (as defined
in [2, §4], identifying the symbols +, =, − with S1 , S2 and S3 respectively). Then:
Corollary 4.13.
(a) Two labelled m-edge-coloured trees with k vertices are induction equivalent if and only if there is a sequence of inductions only of the form
Rp (respectively, only of the form Lp ) taking one to the other.
(b) If G is a 3-edge-coloured tree with k vertices, then Γ(G) = Γ′ (G).
Proof. Part (a) follows from Lemma 4.12, using the fact that Lp (on a given maximal
chain) is the inverse of Rp . For part (b), note that (on a given maximal chain), L1 is
the inverse of R1 and R1 has finite order. Similarly, R2 is the inverse of L2 and L2 has
finite order.

Finally in this section, we note the interesting fact that every induction equivalence
class of labelled m-edge coloured trees contains a labelling of any given unlabelled m-edge
coloured tree. We first have:
Lemma 4.14. Any two (unlabelled) m-edge coloured trees are induction equivalent.
Proof. Let S and S ′ be arbitrary m-edge-coloured trees with k vertices. By Lemma 4.8,
S is induction equivalent to a labelled m-edge-coloured tree with k vertices containing
only the symbols S1 and Sm ; similarly for S ′ . If k is odd there is only one such tree:
•

Sm

S1

•

•

Sm

•

···

S1

•

•,

′

and it follows that S and S are induction equivalent. If k is even, there are two such
trees:
Sm : •
S1 : •

Sm
S1

•
•

S1
Sm

•
•

Sm
S1

•
•

···
···

•
•

Sm
S1

•
•.

A CIRCULAR ORDER ON EDGE-COLOURED TREES

13

Sm
Then R1,m
(Sm ) = S1 , so Sm is induction equivalent to S1 by Lemma 4.3. It follows that
S and S ′ are induction equivalent in this case also.


Corollary 4.15. Let G be a labelled m-edge-coloured tree with k vertices. Then every
possible m-edge-coloured tree with k vertices appears as the underlying unlabelled medge-coloured tree of a labelled m-edge-coloured tree in Γ(G).
Proof. Given a labelled m-edge-coloured tree with k vertices, G, whose underlying unlabelled tree is S, and an arbitrary m-edge-coloured tree with k vertices, S ′ , Lemma 4.14
shows that S and S ′ are induction equivalent. It follows that G and a vertex-labelling
of S ′ are induction equivalent, and the result follows.

5. Induction on m-Angulations of Polygons
By Theorem 3.5, the set of labelled m-edge-coloured trees with k vertices is in bijection
with the set of m-gon-labelled diagonal-coloured m-angulations of a polygon Pn with
n = (m − 2)k + 2 sides, up to rotation, where m-gon-labelled means that the m-gons are
labelled with 1, 2, . . . , k. The colours satisfy a boundary rule, i.e. those bounding each
m-gon in the m-angulations must be the symbols S1 , . . . , Sm in clockwise order.
Our aim in this section is to rewrite induction in the language of (m−2)-clusters. The
set of m-angulations of Pn containing k m-gons is in bijection with the set of (m − 2)clusters of type Ak−1 by Fomin-Reading [5]. Mutation corresponds to rotating a diagonal
one step anticlockwise in the subpolygon obtained when the diagonal is removed.
We shall see that induction has a description as a composition of such mutations
and appropriate recolourings of diagonals and vertex relabellings. An easy induction
argument based on cutting an m-angulation along one of its sides shows that:
Lemma 5.1. Every m-angulation M of a polygon has at least two m-gons with m − 1
boundary edges or is an m-angulation of an m-gon.✷
Remark 5.2. If all the diagonals in an m-angulation are incident with one vertex, then
by moving them one after another, we get the same m-angulation rotated through 2π/n.
We label the vertices of Pn 1, 2, . . . , n clockwise around the boundary, and use the
notation [i, j] to denote a diagonal in the polygon connecting vertex i with vertex j.
Lemma 5.3. Let M be an m-angulation of Pn with k m-gons. Then there is an explicit
sequence of mutations taking M to its rotation through 2π/n anticlockwise.
Proof. We induct on the number k of m-gons in the m-angulation. The result is trivial if
k = 1, so consider the general case. By Lemma 5.1, there is an m-gon M with a unique
internal edge e, joining vertices [i, i + (m − 1)] for some i. Let R be the subpolygon of Pn
given by the union of the m-gons incident with i. Applying Remark 5.2 to the induced
m-angulation of R to rotate it one step anticlockwise, we obtain a new m-angulation of
R, and hence of Pn , containing an m-gon M ′ with vertices i−1, i, i+1, . . ., i+(m−1)−1.
Let R′ be the subpolygon of R with M ′ removed. Applying Remark 5.2 repeatedly we
may rotate the induced m-angulation of R′ one step clockwise.
We obtain a new m-angulation of Pn . By induction we may rotate the subpolygon
with M ′ removed anticlockwise by an explicit sequence. It is easy to check that the total
effect of the above is to rotate the original m-angulation of Pn one step anticlockwise. 
Definition 5.4. Let M be a diagonal-coloured m-angulation of Pn . If there is at least
one internal diagonal in M and all of the internal diagonals of M are coloured only with
Si or Si+1 for fixed i, we call M a snake m-angulation. A subpolygon of Pn with this
property is called a snake subpolygon. Note that in any snake subpolygon the internal
diagonals must be of the form [i1 , i2 ], [i2 , i3 ], and so on.

14

MARSH AND SCHROLL
S3
S2
S4

S4
S4

5

S2

S1

4

S1

S3

S2

S4

3

S1

S3

Step 1

2

S4
2

S3
S1

S2

S1
S2

3

S3
S2

S3

S2

4

S2

S1

S1

5

S4
1

S1

S3

S4

S2

1

S1

Step 2
S4
5

S3
S2

S2

Redraw

S3

S1 4

S3

S4
5

S2

4

S4

S2

S4
2

2

S1

S3

S3
S1

S2

3

S1

3

1

S2

S1
S2

S4

S4
S3

S3

S2

S1

S1

S3

S2

1

S1

Figure 5. Mutations giving rise to R3 induction (see Proposition 5.5).
In a cluster algebra context, snake triangulations appeared in [6, Sect. 3.5] and for
general m in [5, Sect. 5.1] as m-snakes.
Let M be an m-gon-labelled diagonal-coloured m-angulation of Pn and let 1 ≤ i ≤ m.
Choose a maximal snake subpolygon B of M with internal diagonals coloured Si or Si+1 .
Let RB
i (M) be defined using the following procedure.
Step 1: Let M1 , M2 be the two m-gons in B with m − 1 boundary edges in B, and let
e = e1 be the internal edge of M1 in B. Let e2 , . . . , eN be the other internal edges in
B, numbered so that ei−1 and ei are incident for all i. If e1 has colour Si (respectively,
Si+1 ), mutate edges e2 , e4 , . . . (respectively, e1 , e3 , . . .), recolouring the new diagonals
with Si and using the boundary rule to recolour the rest of the polygon. The labelling
of an m-gon is given by the number of the m-gon before mutation whose intersection
with the boundary of B was the same.
Step 2: Let C1 , C2 be the union of the connected components of the complement of B
in Pn incident with M1 , M2 respectively, and let Di = Ci ∪ Mi . Applying Lemma 5.3
to D1 , D2 we get a sequence of mutations rotating the induced m-angulation of each Di
anticlockwise one step around its boundary. We recolour the diagonals according to the
boundary rule. The label of the image of an m-gon under this rotation is the same.
Note that Step 2 has the same effect as detaching each component of Ci in the original
m-angulation from an edge of M coloured Sj , j 6= i, i + 1, and reattaching it after Step 1
to a boundary edge of M with the same symbol Sj (now one step anticlockwise around
the boundary of M ), keeping the original colouring of the diagonals of Ci (i.e. from
before Step 1). Such a boundary edge of M always exists, since j 6= i, i + 1.
It is easy to see that the above procedure does not depend on the initial choice of
M1 . Note also that the procedure commutes with any rotational symmetry of Pn and so
gives a well defined induction on a diagonal-coloured m-angulation of Pn up to rotation.
Comparing the definitions of RiB and RB
i we see that:

A CIRCULAR ORDER ON EDGE-COLOURED TREES

15

Proposition 5.5. Suppose that 1 ≤ i ≤ m and let G be a labelled m-edge-coloured tree
with k vertices containing a maximal Si − Si+1 chain B. Let M be the corresponding
m-gon-labelled diagonal-coloured m-angulation of Pn up to rotation with maximal snake
subpolygon B corresponding to B. Then RiB (G) corresponds to RiB (M). ✷
For an example of Proposition 5.5, see Figure 5, with the snake subpolygon shaded.
Acknowledgements: We would like to thank Luca Q. Zamboni for some helpful conversations. RJM would like to thank Sibylle Schroll and the Department of Mathematics
at the University of Leicester for their kind hospitality.
References
[1] D. Bisch, V. Jones, Algebras associated to intermediate subfactors, Invent. Math. 128 (1997) 89–
157.
[2] J. Cassaigne, S. Ferenczi, L. Q. Zamboni, Combinatorial trees arising in the study of interval
exchange transformations, European J. Combin. 32 (2011) 1428–1444.
[3] M. Cho, D. Kim, S. Seo, H. Shin, Colored Prüfer codes for k-edge colored trees, Electron. J.
Combin. 11 (2004), 7 pp.
[4] S. Ferenczi, L. Q. Zamboni, Structure of k-interval exchange transformations: induction, trajectories, and distance theorems, J. Anal. Math. 112 (2010) 289–328.
[5] S. Fomin, N. Reading, Generalized cluster complexes and Coxeter combinatorics, Int. Math. Res.
Not. IMRN 44 (2005) 2709–2757.
[6] S. Fomin, A. Zelevinsky, Y -systems and generalized associahedra, Ann. of Math. (2) 158 (2003)
977–1018.
[7] P. Hilton, J. Pederson, Catalan numbers, their generalization, and their uses, Math. Intelligencer
13 (1991) 64–75.
[8] I. L. Hofacker, P. Schuster, P. F. Stadler, Combinatorics of RNA secondary structures, Discrete
Appl. Math. 88 (1998) 207–237.
[9] V. E. Hoggatt, Jr., M. Bicknell, Catalan and related sequences arising from inverses of Pascal’s
triangle matrices, Fibonacci Quart. 14 (1976) 395–405.
[10] R. Nussinov, G. Pieczenik, J. R. Griggs, D. J. Kleitman, Algorithms for loop matchings, SIAM J.
Appl. Math. 35 (1978) 68–82.
[11] N. J. A. Sloane, The On-Line Encyclopedia of Integer Sequences, 2010, www.oeis.org.
[12] R. P. Stanley, Enumerative combinatorics, Vol. 2, Cambridge University Press, Cambridge, 1999.
[13] M. S. Waterman, Secondary structure of single-stranded nucleic acids, in: Studies in foundations
and combinatorics, Academic Press, New York-London, 1978, pp. 167–212.
School of Mathematics, University of Leeds, Leeds LS2 9JT, United Kingdom
E-mail address: marsh@maths.leeds.ac.uk
Department of Mathematics, University of Leicester, University Road, Leicester LE1
7RH, United Kingdom
E-mail address: ss489@le.ac.uk

