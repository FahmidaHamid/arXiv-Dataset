Protein folding and binding can emerge as evolutionary
spandrels through structural coupling
Michael Manhart1 and Alexandre V. Morozov1,2‚àó

arXiv:1408.3786v1 [q-bio.PE] 17 Aug 2014

1 Department

of Physics and Astronomy and 2 BioMaPS Institute for Quantitative Biology,
Rutgers University, Piscataway, NJ 08854, USA

Abstract
Binding interactions between proteins and other molecules mediate numerous cellular processes, including metabolism, signaling, and regulation of gene expression. These
interactions evolve in response to changes in the protein‚Äôs chemical or physical environment (such as the addition of an antibiotic), or when genes duplicate and diverge.
Several recent studies have shown the importance of folding stability in constraining
protein evolution. Here we investigate how structural coupling between protein folding
and binding ‚Äì the fact that most proteins can only bind their targets when folded ‚Äì
gives rise to evolutionary coupling between the traits of folding stability and binding
strength. Using biophysical and evolutionary modeling, we show how these protein
traits can emerge as evolutionary ‚Äúspandrels‚Äù even if they do not confer an intrinsic
fitness advantage. In particular, proteins can evolve strong binding interactions that
have no functional role but merely serve to stabilize the protein if misfolding is deleterious. Furthermore, such proteins may have divergent fates, evolving to bind or not
bind their targets depending on random mutation events. These observations may explain the abundance of apparently nonfunctional interactions among proteins observed
in high-throughput assays. In contrast, for proteins with both functional binding and
deleterious misfolding, evolution may be highly predictable at the level of biophysical
traits: adaptive paths are tightly constrained to first gain extra folding stability and
then partially lose it as the new binding function is developed. These findings have
important consequences for our understanding of fundamental evolutionary principles
of both natural and engineered proteins.

Proteins carry out a diverse array of chemical and mechanical functions in the cell,
ranging from metabolism to signaling [1]. Thus proteins serve as central targets for natural
selection in wild populations, as well as a key toolbox for bioengineering novel molecules
with medical and industrial applications [2, 3]. Most proteins must fold into their native
state, a unique three-dimensional conformation, in order to perform their function, which
‚àó

Corresponding author: morozov@physics.rutgers.edu

1

typically involves binding a target molecule such as DNA, RNA, another protein, or a small
ligand [1]. Misfolded proteins may also form toxic aggregates and divert valuable protein
synthesis and quality control resources [4‚Äì7]. It is therefore imperative that the folded state
be stable against the thermal fluctuations present at physiological temperatures. However,
biophysical experiments and computational studies reveal that most random mutations in
proteins destabilize the folded state [8, 9], including mutations that improve function [9‚Äì11].
As a result many natural proteins tend to be only marginally stable, mutationally teetering
at the brink of substantial unfolding [12, 13]. With proteins in such a precarious evolutionary
position, how can they evolve new functions while maintaining sufficient folding stability?
Directed evolution experiments have offered a window into the dynamics of this process [2, 3], indicating the importance of compensatory mutations, limited epistasis, and
mutational robustness. Theoretical efforts to describe protein evolution in biophysical terms
have focused on evolvability [14], global properties of protein interaction networks [15, 16],
and reproducing observed distributions of protein stabilities and evolutionary rates [13, 17‚Äì
19]. However, a subtle but key property of proteins has not been explored in this context:
structural coupling of folding and binding (the fact that folding is required for function)
implies evolutionary coupling of folding stability and binding strength. Thus selection acting directly on only one of these traits may produce apparent, indirect selection for the
other. The importance of this effect was popularized by Gould and Lewontin in their influential paper on evolutionary ‚Äúspandrels‚Äù [20], defined as traits that evolve as byproducts
in the absence of direct selection. Since then the importance of coupling between traits
has been explored in many areas of evolutionary biology [21], including various molecular
examples [12, 22, 23].
How do coupled traits affect protein evolution? We consider a simple model that describes
evolution of a new binding interaction in the context of a directed evolution experiment [3],
as a result of gene duplication and divergence [24], or in response to a change in the protein‚Äôs chemical or physical environment, including availability and concentrations of various
ligands [25, 26] as well as temperature [27, 28]. We postulate a fitness landscape as a function of two biophysical traits: stability and the free energy of binding a target molecule.
We then use an exact numerical algorithm [29, 30] to quantitatively characterize adaptation on this fitness landscape, addressing key evolutionary questions of epistasis [31, 32],
predictability [25, 33, 34], and the tempo of adaptation [17, 35].

Results
Model of protein energetics. We consider a protein with two-state folding kinetics [1].
In the folded state, the protein has an interface that binds a target molecule. Because the
protein can bind only when it is folded, the binding and folding processes are structurally
coupled. Under the thermodynamic equilibrium assumption (valid when protein folding and
binding are faster than typical cellular processes), the probabilities of the three structural
states ‚Äì folded and bound (pf,b ), folded and unbound (pf,ub ), and unfolded and unbound
(puf,ub ) ‚Äì are given by their Boltzmann weights:
2

State

Free energy

Probability

folded,
bound

Ef + Eb

pf,b = Z ‚àí1 e‚àíŒ≤(Ef +Eb )

folded,
unbound

Ef

pf,ub = Z ‚àí1 e‚àíŒ≤Ef

unfolded,
unbound

0

puf,ub = Z ‚àí1

(1)

Here Œ≤ is the inverse temperature, Ef is the free energy of folding (also known as ‚àÜG), and
Eb = Eb0 ‚àí ¬µ, where Eb0 is the binding free energy and ¬µ is the chemical potential of the
target molecule. For simplicity, we will refer to Eb as the binding energy. Note that Ef < 0
for intrinsically-stable proteins and Eb < 0 for favorable binding interactions. The partition
function is Z = e‚àíŒ≤(Ef +Eb ) + e‚àíŒ≤Ef + 1.
The folding and binding energies depend on the protein‚Äôs genotype (amino acid sequence)
œÉ. We assume that adaptation only affects ‚Äúhotspot‚Äù residues at the binding interface [36,
37]; the rest of the protein does not change on relevant time scales because it is assumed
to be already optimized for folding. If positions away from the binding interface can accept
stabilizing mutations (and are not functionally constrained), they may be explicitly included
into the model as ‚Äúfolding hotspots.‚Äù In the present study we focus on L binding hotspot
residues which, to a first approximation, make additive contributions to the total folding
and binding free energies [38] (see SI Methods for the discussion of non-additive effects):
Ef (œÉ) =

Efref

+

L
X

i

f (i, œÉ ), Eb (œÉ) =

i=1

Ebmin

+

L
X

b (i, œÉ i ),

(2)

i=1

where f (i, œÉ i ) and b (i, œÉ i ) capture the energetic contributions of amino acid œÉ i at position i.
The reference energy Efref is the fixed contribution to the folding energy from all other residues
in the protein. Furthermore, by construction it is also the total folding energy of a reference
sequence œÉref (see Methods), so that each f (i, œÉ i ) can be interpreted as the change in total
folding free energy Ef (‚àÜ‚àÜG value) resulting from a single-point mutation of œÉref . The
parameter Ebmin is the minimum binding energy among all genotypes (see Methods). Amino
acid energies f (i, œÉ i ) and b (i, œÉ i ) are randomly sampled from distributions constructed using
available ‚àÜ‚àÜG data and other biophysical considerations (see Methods); the exact shape of
these distributions is unimportant for large enough L due to the central limit theorem.
Fitness landscape. We construct a simple fitness landscape based on the molecular
traits Ef and Eb . Without loss of generality, we assume that the protein contributes fitness
1 to the organism if it is always folded and bound. Let fub , fuf ‚àà [0, 1] be the multiplicative
fitness penalties for being unbound and unfolded, respectively: the fitness is fub if the protein

3

is unbound but folded, and fub fuf if the protein is both unbound and unfolded. Then the
fitness of the protein averaged over all three possible structural states in Eq. 1 is given by
F(Ef , Eb ) = pf,b + fub pf,ub + fub fuf puf,ub .

(3)

This fitness landscape is divided into three nearly-flat plateaus corresponding to the three
protein states of Eq. 1, separated by steep thresholds corresponding to the folding and binding
transitions (Fig. 1A). The heights of the plateaus are determined by the values of fub and
fuf , leading to three qualitative regimes of the global landscape structure (Fig. 1B‚ÄìD).
In the first case (Fig. 1B), a protein that is perfectly folded but unbound has no fitness
advantage over an unbound and unfolded protein: fub = fub fuf . Thus selection acts directly
only on the binding trait. This regime requires that either fub = 0 (binding is essential,
e.g., in the context of conferring antibiotic resistance to the cell [25]) or fuf = 1 (misfolded
proteins are not toxic). The latter case also includes directed evolution experiments where
only function is artificially selected for in vitro. In contrast, when fub = 1 and 0 ‚â§ fuf < 1
(Fig. 1C), a perfectly folded and bound protein has no fitness advantage over a folded but
unbound protein, and thus this case entails direct selection only for folding. These proteins
are harmful to the cell in the misfolded state (e.g., due to aggregation or significant costs
of degrading unfolded proteins [4‚Äì7]), while binding provides no intrinsic fitness advantage
(the protein may have other, functional binding interfaces). Finally, it is also possible to
have distinct selection pressures on both binding and folding. This occurs when 0 < fub < 1
and 0 ‚â§ fuf < 1 (Fig. 1D).
It is straightforward to generalize our three-state model to proteins with additional structural states (other local minima on the folding energy landscape, other binding modes)
and allow for simultaneous adaptation at multiple binding interfaces. Furthermore, the fitness landscape in Eq. 3 can be made an arbitrary nonlinear function of state probabilities.
However, these more complex scenarios would still share the essential features of our basic model: coupling between folding and binding traits and sharp fitness thresholds between
bound/unbound and folded/unfolded states. Thus our qualitative conclusions do not depend
on the specific model in Eq. 3.
Epistasis and local maxima. For protein sequences of length L with an alphabet of
size k, each of the k L possible genotypes is projected onto the two-dimensional trait space
of Ef and Eb (Eq. 2) and connected to L(k ‚àí 1) immediate mutational neighbors, forming a
network of states that the population must traverse (a simple example is shown in Fig. 1E).
Adaptive dynamics are determined by the interplay between the structure of the fitness
landscape and the distribution of genotypes in trait space.
This interplay gives rise to the possibility of epistasis and multiple local fitness maxima.
Our model is non-epistatic in energy space (Eq. 2). When the fitness contours are straight
parallel lines, there can be no sign epistasis on the fitness landscape (Fig. 1F). Magnitude
epistasis, on the other hand, is widespread due to the nonlinear dependence of fitness on
folding and binding energies. Curved fitness contours, which occur near folding or binding
thresholds in our model (Fig. 1B‚ÄìD), can produce sign epistasis in fitness, giving rise to
multiple local fitness maxima in the genotype space (Fig. 1E).
4

Evolutionary dynamics. We assume that a population encoding the protein of interest
evolves in the monomorphic limit: LN u log N  1, where L is the number of residues, N
is an effective population size, and u is the per-residue probability of mutation per generation [39] (see SI Methods). In this limit, the entire population has the same genotype at any
given time, and the rate of substitution from the current genotype to one of its mutational
neighbors is given by Eq. 1 in SI Methods. We use the strong-selection limit of the substitution rate (Eq. 2 in SI Methods), in which the effective population size enters only as an
overall time scale. In this regime, deleterious mutations never fix and adaptive paths have
a finite number of steps, terminating at a global or local fitness maximum. For compact
genomic units such as proteins, the monomorphic condition is generally met in multicellular
species, although it may be violated in some unicellular eukaryotes and prokaryotes [40]. Sequential fixation of single mutants is also a typical mode of adaptation in directed evolution
experiments [3]. For simplicity, we neglect more complex mutational moves such as indels
and recombination.
Far from the binding and folding thresholds the fitness landscape becomes flat (Fig. 1A)
and the strong-selection assumption may be violated. To establish the limits of validity
for our model, we calculate average selection coefficients of accessible substitutions (defined
as s = Ffinal /Finitial ‚àí 1, where Finitial and Ffinal are the initial and final fitness values of a
substitution), both throughout the landscape and at the local maxima (Fig. S1). We observe
that for typical values of the effective population size N ‚àà (104 , 107 ) [40, 41], the selection
strengths in the model justify our strong-selection approximation for realistic choices of
energy parameters.
Quantitative description of adaptation. Although our model is valid for any adaptive process, for concreteness we focus on a specific but widely-applicable scenario. A population begins as perfectly adapted to binding an original target molecule characterized by an
energy matrix b1 with minimum binding energy Ebmin
(defining a fitness landscape F1 ). The
1
population is then subjected to a selection pressure which favors binding a new target, with
energy matrix b2 and minimum binding energy Ebmin
(fitness landscape F2 ). The adaptive
2
paths are first-passage paths leading from the global maximum on F1 to a local or global
maximum on F2 , with fitness increasing monotonically along each path.
Each adaptive path œï with probability Œ†[œï] is a sequence of genotypes connecting initial
and final states. Using an exact numerical algorithm (SI Methods) [29, 30], we determine the
path-length distribution œÅ(`), which gives the probability of taking an adaptive path with
` amino acid substitutions, and the mean adaptation time tÃÑ. We also introduce Spath , the
entropy of the adaptive paths:
X
Spath = ‚àí
Œ†[œï] log Œ†[œï].
(4)
œï

The path entropy is maximized when evolution is neutral, resulting in all paths of a given
length being accessible and equally likely: Spath = `¬Ølog L(k ‚àí 1) [30], where `¬Ø is the average
path length.
We also consider the path density œà(œÉ), which gives the total probability of reaching a
5

state œÉ at any point along a path. When œÉ is a final state (a local fitness maximum on F2 ),
the path density is equivalent to the commitment probability. We calculate the entropy Scom
of the commitment probabilities as
X
Scom = ‚àí
œà(œÉ) log œà(œÉ).
(5)
final states œÉ

Direct selection for binding only. We first focus on the fub = fuf fub case in Eq. 3.
The geometry of the fitness contours is invariant under overall shifts in the binding energy
Eb (Fig. 1B); equivalently, the direction (but not the magnitude) of the selection force
~ log F/|‚àá
~ log F|) does not depend on Eb . Thus without loss of generality, we set E min =
(‚àá
b1
min
Eb2 in this section. The contours of constant fitness are parallel to the Ef axis when Ef is
low, indicating that, as expected, selection acts only on binding when proteins are sufficiently
stable.
However, for marginally stable proteins [12, 13, 42], the fitness contours begin to curve
downward, indicating apparent, indirect selection for folding, even though selection acts
directly only on the binding trait. Thus, adaptation will produce a trait (more stability)
that is neutral at the level of the fitness function simply because it is coupled with another
trait (binding) that is under selection. Folding stability can therefore be considered an
evolutionary spandrel [20]. Proteins may even be intrinsically unstable (Ef > 0) and only
fold when bound (Ef + Eb < 0), which we refer to as binding-mediated stability [43]. In this
regime, the fitness contours approach diagonal lines: selection effectively acts to improve
both binding and folding equally (Fig. 1B).
An example realization of evolutionary dynamics in the marginally stable regime is shown
in Fig. 2A,B (see Fig. S2 for stable and intrinsically unstable examples, and Fig. S3 for
averaged distributions of initial, intermediate, and final states). There is typically just one
or two fitness maxima; all maxima are usually accessible (Fig. 2C). For stable proteins, the
global maximum almost always coincides with the best-binding genotype and is usually as
far as a randomly-chosen genotype from the best-folding genotype (Fig. 2D; two random
sequences are separated by 1 ‚àí 1/k = 0.8 for k = 5). However, as Ef becomes greater,
the average distance between the maxima and the best-binding genotype increases, while
the average distance between the maxima and the best-folding genotype decreases, until
they meet halfway for intrinsically unstable proteins, where effective selection for binding
and folding is equally strong (Fig. 2D). In general the maxima lie on or near the Pareto
front [44], defined here as the set of genotypes such that either Ef or Eb cannot be decreased
further without increasing the other (the global maximum is always on the front, while local
maxima may not be) (Fig. 2A, Fig. S2).
As Ef increases, the average distance between initial and final states for adaptation
decreases. As a result the average path length (number of substitutions) decreases as well,
although the variance of path lengths is relatively constant over all energies (Fig. 2E). The
path entropy per substitution Spath /`¬Ø also decreases with Ef , reflecting greater constraints
on adaptive paths (note that Spath /`¬Ø = log L(k ‚àí 1) ‚âà 3.2 for neutral evolution). Finally,
Scom ‚âà 0.31 in the marginally stable regime (Fig. 2F). Since the average number of maxima
6

is ‚âà 1.9 in this regime (Fig. 2C), the maximum value of Scom is log 1.9 ‚âà 0.64, indicating
that not all maxima are equally accessible.
Direct selection for folding only. In this regime, fub = 1 and 0 ‚â§ fuf < 1 in Eq. 3.
Similar to the previous case, the geometry of the fitness contours and thus most landscape
properties are now independent of Ef (Fig. 1C); equivalently, normalized selection force
~ log F/|‚àá
~ log F| does not depend on Ef .
‚àá
When the nonfunctional binding is weak, the fitness contours are parallel to the Eb axis,
indicating that selection acts only on folding (Fig. 1C). However, with increasing binding
strength the fitness contours curve such that the effective selection force attempts to improve
both binding and folding equally. Thus binding emerges as an evolutionary spandrel in this
case. The weak-binding regime yields a single fitness maximum due to the lack of sign
epistasis; this maximum predominantly coincides with the best-folding genotype (Fig. 3A).
However, once the binding interaction becomes stronger, there is an increased likelihood of
multiple local maxima, located between the best-folding and best-binding genotypes.
Depending on the abundance of the old and new ligands in the cell and their binding
properties, several adaptive scenarios may take place. First, the best-binding strengths Ebmin
1
and Ebmin
of
the
old
and
new
targets
may
be
similar
in
magnitude.
If
both
are
weak,
initial
2
and final states are likely to be the best-folding genotype or close to it (Fig. 3A); in this
case, there is a high probability that no adaptation will occur (Fig. 3B). When Ebmin
and
1
Ebmin
are
both
low,
adaptation
usually
occurs
to
accommodate
the
binding
specificity
of
the
2
new ligand (Fig. 3B, Fig. S4A). Surprisingly, we see that proteins frequently evolve stronger
binding at the expense of folding (bottom panel of Fig. S4A). This happens due to the
constraints of the genotype-phenotype map: not enough genotypes are available to optimize
both traits simultaneously.
It is also possible to gain or lose binding affinity at the nonfunctional interface through
adaptation. In the first case, the new target has stronger binding than the old one (Ebmin
<
2
min
Eb1 ). Thus the initial state is the best-folding genotype or close to it, and the protein adapts
toward a genotype with intermediate folding and binding (Fig. S4B). As before, adaptation is
tightly constrained by the genotype-phenotype map, sacrificing the trait (folding stability)
under direct selection in order to affect the spandrel (nonfunctional binding interaction).
Effectively, the protein switches from being ‚Äúself-reliant‚Äù to needing a binding partner. In
the second case (Ebmin
< Ebmin
), the dynamics is opposite: the protein loses its nonfunctional
1
2
binding interface and becomes self-reliant (Fig. S4C). Thus proteins may acquire or lose
binding interfaces depending on the availability of ligands that can participate in bindingmediated stability. If the protein‚Äôs stability becomes suboptimal due to an environmental
change, its stability may be restored not only through stabilizing mutations, but also by
developing a novel binding interface.
Divergent evolutionary fates. In the region where the fitness contours in Fig. 1C are
curved, it is possible to have two or more local maxima accessible to adaptation, with at
least one having negative Eb (strong binding) and at least one having positive Eb (negligible
binding) (see Fig. 3C,D for an example landscape). The selection streamlines are divergent
in this regime (Fig. 1C). Thus a protein has two fates available to it: one in which it evolves

7

to bind the target and another in which it does not. The eventual fate of the protein is
determined by random mutation events. Indeed, the distribution of final states is strongly
bimodal (Fig. 3E), yielding a sizable probability of divergent fates across a range of binding
energies (Fig. 3F).
Simultaneous selection for binding and folding. Finally we consider a general
case in which 0 < fub < 1 and 0 ‚â§ fuf < 1 in Eq. 3 (Fig. 1D). The fitness landscape
is divided into two regions by a straight diagonal contour with fitness fub and slope ‚àí1.
Below this contour, the landscape is qualitatively similar to the case of selection for binding
only (Fig. 1B), while above the contour the landscape resembles that of the folding-only
selection scenario (Fig. 1C). Thus evolutionary dynamics for proteins with favorable binding
and folding energies will largely resemble the case of selection for binding only. However,
a qualitatively different behavior will be observed if the distribution of genotypes straddles
the diagonal contour (Fig. 4). This will occur when initial folding stability is marginal and
initial binding is unfavorable. In this case, selection streamlines around the diagonal contour
(Fig. 1D) and the genotype-phenotype map tightly constrain the adaptive paths to gain
extra folding stability first, and then lose it as the binding function is improved.
Tempo and rhythm of adaptation. The strength of selection is the primary determinant of the average adaptation time tÃÑ. If the selection coefficient s is small (but N s > 1),
the substitution rate W (œÉ 0 |œÉ) in SI Methods Eq. 1 is proportional to s. Thus, as selection
becomes exponentially weaker for lower energies (Fig. S1), adaptation becomes exponentially slower. The distribution of the total adaptation time over an adaptive path is highly
nonuniform. For example, in the case of selection for binding only and a marginally stable
protein, the adaptation time is concentrated at the end of the path, one mutation away
from the final state (Fig. S5A,B). Substitutions at the beginning of the path occur quickly
because there are many possible beneficial substitutions and because selection is strong; in
contrast, at the end of the path adaptation slows down dramatically as beneficial mutations
are depleted and selection strength weakens. This behavior is observed in most of the other
model regimes as well.
The exception to this pattern occurs in the case of selection for both binding and folding
in marginally-stable and marginally-bound proteins, due to the unique contour geometry
(Fig. 1D). As the adaptive paths wrap around the diagonal contour in the region of high
Eb and low Ef , the landscape flattens, making selection weaker and substitutions slower
(Fig. S5C). Thus most of the waiting occurs in the middle of the path rather than the end
(Fig. S5D). Adaptation accelerates toward the end of the path as the strength of selection
increases again. If the intermediate slow-down is significant enough, a protein may not have
time to complete the second half of its path before environmental conditions change, so that
it will never evolve the new binding function.

Discussion
Protein folding and binding as evolutionary spandrels. In the decades since Gould
and Lewontin‚Äôs paper [20], the existence of evolutionary spandrels has emerged as a critical
8

evolutionary concept. There are many possible scenarios in which spandrels can evolve [20,
21], although two key mechanisms are neutral processes, such as genetic drift and biases in
mutation and recombination [45], and indirect selection arising from coupled traits. Here we
have focused on the latter, which we expect to be more important on short time scales.
It has been previously argued that the marginal stability of most proteins may be an
evolutionary spandrel that evolved due to mutation-selection balance [3, 12, 13]. We suggest more broadly that having folding stability at all may be a spandrel for proteins with
no misfolding toxicity. Even more striking is the possibility that some binding interactions
may be spandrels that evolved solely to stabilize proteins with toxic misfolding; this would
significantly affect our interpretation of data on proteome-wide interactions [46]. In particular, we expect more widespread nonfunctional interactions among proteins with less intrinsic
stability. Indeed, protein abundance is believed to correlate positively with stability (‚àíEf )
to explain the observed negative correlation of abundance with evolutionary rate [18, 19].
Furthermore, models of protein-protein interaction networks imply that protein abundance
also correlates negatively with the number of interactions [16]. Together these argue that stability should indeed be negatively correlated with the number of interactions. Experiments
on specific proteins also support this finding: for example, destabilizing mutations in E. coli
dihydrofolate reductase were found to be compensated at high temperature by protein binding, which protected against toxic aggregation [28]. Previously the role of binding-mediated
stability has been primarily discussed in the context of intrinsically disordered proteins [47],
described by the high Ef regime of our model.
Pareto optimization of proteins. The Pareto front is a useful concept in problems
of multi-objective optimization [44]. The Pareto front in our model consists of the protein
sequences along the low Ef , low Eb edge of the genotype distribution (see e.g. Fig. 2A).
Pareto optimization assumes that all states on the front are valid final states for adaptation;
this in turn implies that fitness has linear dependence on the individual traits. However,
nonlinear fitness functions with saturation effects will confound this assumption. Our model
shows how this nonlinearity leads to a small subset of true final states on or even off the
front. Thus Pareto optimization does not capture a key feature of the underlying biophysics,
providing only a rough approximation to the true dynamics.
Epistasis and evolutionary predictability. Our results also shed light on the role
of epistasis ‚Äì the correlated effects of mutations at different sites ‚Äì in protein evolution.
Epistasis underlies the ruggedness of fitness landscapes [31, 32]. Magnitude epistasis is
widespread in our model, while sign epistasis only arises in regions where the fitness contours
are curved (Fig. 1E,F). This picture is qualitatively consistent with studies of empirical fitness
landscapes [32] and with directed evolution experiments [3].
Epistasis determines the predictability of evolution, an issue of paramount importance
in biology [25, 33, 34]. In most cases considered here, limited sign epistasis gives rise to less
predictable intermediate pathways (high Spath ) but highly predictable final outcomes (low
Scom ).
However, there are two major exceptions to this pattern. First, proteins with a binding
interaction under no direct selection may have multiple local maxima, some with strong and

9

others with weak binding (Fig. 3). Here both intermediate pathways and final states are
unpredictable ‚Äì pure chance, in the form of random mutations, drives the population to one
binding fate or the other. The second exception occurs in proteins with direct selection for
both binding and folding. Here there is usually a single maximum, but the adaptive paths are
tightly constrained in energy space (Fig. 4). Thus evolution of proteins with both functional
binding and deleterious misfolding, which should include a large fraction of natural proteins,
is highly predictable at the level of energy traits.

Methods
Energetics of protein folding and binding. Folding energetics are probed experimentally and computationally by measuring the changes in Ef resulting from single point mutations. Since these changes are observed to be universally distributed over many proteins [8],
we sample entries of f from a Gaussian distribution with mean 1.25 kcal/mol and standard
i
deviation 1.6 kcal/mol. For the reference sequence œÉref , f (i, œÉref
) = 0 for all i ‚àà {1, . . . , L},
ref
min
such that Ef (œÉref ) = Ef . The parameter Eb is defined as the binding energy of the genoi
type œÉbb with the lowest Eb : b (i, œÉbb
) = 0 for all i ‚àà {1, . . . , L}. Since binding hotspot
residues typically have a 1‚Äì3 kcal/mol penalty for mutations away from the wild-type amino
acid [36, 37], we sample the other entries of b from an exponential distribution defined in
the range of (1, ‚àû) kcal/mol, with mean 2 kcal/mol. This distribution is consistent with
alanine-scanning experiments which probe energetics of amino acids at the binding interface [48]. We consider L = 6 hotspot residues and a reduced alphabet of k = 5 amino acids
(grouped into negative, positive, polar, hydrophobic, and other), resulting in 56 = 15625
possible genotypes. Our population genetics model and the algorithm for exact calculation
of adaptive path statistics are available in SI Methods.

Acknowledgments
A.V.M. acknowledges support from National Institutes of Health (R01 HG004708) and an
Alfred P. Sloan Research Fellowship.

References
[1] Creighton TE (1992) Proteins: Structures and Molecular Properties. (W.H. Freeman
and Company, New York).
[2] Campbell RE et al. (2002) A monomeric red fluorescent protein. Proc Natl Acad Sci
USA 99:7877‚Äì7882.
[3] Bloom JD, Arnold FH (2009) In the light of directed evolution: Pathways of adaptive
protein evolution. Proc Natl Acad Sci USA 106:9995‚Äì10000.

10

[4] Bucciantini M et al. (2002) Inherent toxicity of aggregates implies a common mechanism
for protein misfolding diseases. Nature 416:507‚Äì511.
[5] Drummond DA, Wilke CO (2008) Mistranslation-induced protein misfolding as a dominant constraint on coding-sequence evolution. Cell 134:341‚Äì352.
[6] Geiler-Samerotte KA et al. (2011) Misfolded proteins impose a dosage-dependent fitness
cost and trigger a cytosolic unfolded protein response in yeast. Proc Natl Acad Sci USA
108:680‚Äì685.
[7] Bershtein S, Mu W, Serohijos AWR, Zhou J, Shakhnovich EI (2013) Protein quality
control acts on folding intermediates to shape the effects of mutations on organismal
fitness. Mol Cell 49:133‚Äì144.
[8] Tokuriki N, Stricher F, Schymkowitz J, Serrano L, Tawfik DS (2007) The stability effects
of protein mutations appear to be universally distributed. J Mol Biol 369:1318‚Äì1332.
[9] Tokuriki N, Stricher F, Serrano L, Tawfik DS (2008) How protein stability and new
functions trade off. PLoS Comput Biol 4:e1000002.
[10] Wang X, Minasov G, Shoichet BK (2002) Evolution of an antibiotic resistance enzyme
constrained by stability and activity trade-offs. J Mol Biol 320:85‚Äì95.
[11] Sun SB et al. (2013) Mutational analysis of 48g7 reveals that somatic hypermutation
affects both antibody stability and binding affinity. J Am Chem Soc 135:9980‚Äì9983.
[12] Taverna DM, Goldstein RA (2002) Why are proteins marginally stable?
46:105‚Äì109.

Proteins

[13] Zeldovich KB, Chen P, Shakhnovich EI (2007) Protein stability imposes limits on organism complexity and speed of molecular evolution. Proc Natl Acad Sci USA 104:16152‚Äì
16157.
[14] Bloom JD, Labthavikul ST, Otey CR, Arnold FH (2006) Protein stability promotes
evolvability. Proc Natl Acad Sci USA 103:5869‚Äì5874.
[15] Johnson ME, Hummer G (2011) Nonspecific binding limits the number of proteins in a
cell and shapes their interaction networks. Proc Natl Acad Sci USA 108:603‚Äì608.
[16] Heo M, Maslov S, Shakhnovich EI (2011) Topology of protein interaction network shapes
protein abundances and strengths of their function and nonspecific interactions. Proc
Natl Acad Sci USA 108:4258‚Äì4263.
[17] DePristo MA, Weinreich DM, Hartl DL (2005) Missense meanderings in sequence space:
a biophysical view of protein evolution. Nat Rev Genet 6:678‚Äì687.
[18] Drummond DA, Bloom JD, Adami C, Wilke CO, Arnold FH (2005) Why highly expressed proteins evolve slowly. Proc Natl Acad Sci USA 102:14338‚Äì14343.
11

[19] Serohijos AWR, Rimas Z, Shakhnovich EI (2012) Protein biophysics explains why highly
abundant proteins evolve slowly. Cell Rep 2:249‚Äì256.
[20] Gould SJ, Lewontin RC (1979) The spandrels of San Marco and the Panglossian
paradigm: A critique of the adaptationist programme. Proc R Soc Lond B 205:581‚Äì598.
[21] Pigliucci M, Kaplan J (2000) The fall and rise of Dr Pangloss: adaptationism and the
Spandrels paper 20 years later. Trends Ecol Evol 15:66‚Äì77.
[22] Weiss MA et al. (2002) Protein structure and the spandrels of San Marco: Insulin‚Äôs
receptor-binding surface is buttressed by an invariant leucine essential for its stability.
Biochemistry 41:809‚Äì819.
[23] Barrett RDH, Hoekstra HE (2011) Molecular spandrels: tests of adaptation at the
genetic level. Nat Rev Genet 12:767‚Äì780.
[24] Soskine M, Tawfik DS (2010) Mutational effects and the evolution of new protein functions. Nat Rev Genet 11:572‚Äì582.
[25] Weinreich DM, Delaney NF, DePristo MA, Hartl DL (2006) Darwinian evolution can
follow only very few mutational paths to fitter proteins. Science 312:111‚Äì114.
[26] Chou HH, Chiu HC, Delaney NF, SegreÃÄ D, Marx CJ (2011) Diminishing returns epistasis
among beneficial mutations decelerates adaptation. Science 332:1190‚Äì1192.
[27] Wichman HA, Badgett MR, Scott LA, Boulianne CM, Bull JJ (1999) Different trajectories of parallel evolution during viral adaptation. Science 285:422‚Äì424.
[28] Bershtein S, Mu W, Shakhnovich EI (2012) Soluble oligomerization provides a beneficial
fitness effect on destabilizing mutations. Proc Natl Acad Sci USA 109:4857‚Äì4862.
[29] Manhart M, Morozov AV (2013) Path-based approach to random walks on networks
characterizes how proteins evolve new functions. Phys Rev Lett 111:088102.
[30] Manhart M, Morozov AV (2014) in First-Passage Phenomena and Their Applications,
eds. Metzler R, Oshanin G, Redner S. (World Scientific, Singapore).
[31] Poelwijk FJ, Kiviet DJ, Weinreich DM, Tans SJ (2007) Empirical fitness landscapes
reveal accessible evolutionary paths. Nature 445:383‚Äì386.
[32] Szendro IG, Schenk MF, Franke J, Krug J, de Visser JA (2013) Quantitative analyses
of empirical fitness landscapes. J. Stat. Mech. p. P01005.
[33] Gould SJ (1990) Wonderful Life: The Burgess Shale and the Nature of History. (W.
W. Norton and Company, New York, USA).
[34] Lobkovsky AE, Koonin EV (2012) Replaying the tape of life: quantification of the
predictability of evolution. Front Gene 3:246.
12

[35] Kimura M (1983) The Neutral Theory of Molecular Evolution. (Cambridge University
Press, Cambridge, UK).
[36] Clackson T, Wells JA (1995) A hot spot of binding energy in a hormone-receptor interface. Science 267:383‚Äì386.
[37] Moreira IS, Fernandes PA, Ramos MJ (2007) Hot spots ‚Äî a review of the proteinprotein interface determinant amino-acid residues. Proteins 68:803‚Äì812.
[38] Wells JA (1990) Additivity of mutational effects in proteins. Biochemistry 29:8509‚Äì8517.
[39] Champagnat N (2006) A microscopic interpretation for adaptive dynamics trait substitution sequence models. Stoch Proc Appl 116:1127‚Äì1160.
[40] Lynch M (2007) The Origins of Genome Architecture. (Sinauer, Sunderland).
[41] Charlesworth B (2009) Effective population size and patterns of molecular evolution
and variation. Nat Rev Genet 10:195‚Äì205.
[42] Kumar MD et al. (2006) ProTherm and ProNIT: thermodynamic databases for proteins
and protein-nucleic acid interactions. Nuleic Acids Res 34:D204‚ÄìD206.
[43] Dixit PD, Maslov S (2013) Evolutionary capacitance and control of protein stability in
protein-protein interaction networks. PLoS Comput Biol 9:e1003023.
[44] Shoval O et al. (2012) Evolutionary trade-offs, Pareto optimality, and the geometry of
phenotype space. Science 336:1157‚Äì1160.
[45] Lynch M (2007) The evolution of genetic networks by non-adaptive processes. Nat Rev
Genet 8:803‚Äì813.
[46] Stark C et al. (2006) BioGRID: a general repository for interaction datasets. Nucleic
Acids Res 34(Database issue):D535‚ÄìD539.
[47] Wright PE, Dyson HJ (2009) Linking folding and binding. Curr Opin Struct Biol 19:31‚Äì
38.
[48] Thorn KS, Bogan AA (2001) ASEdb: a database of alanine mutations and their effects
on the free energy of binding in protein interactions. Bioinformatics 17:284‚Äì285.
[49] Kimura M (1962) On the probability of fixation of mutant genes in a population. Genetics 47:713‚Äì719.
[50] Istomin AY, Gromiha MM, Vorov OK, Jacobs DJ, Livesay DR (2008) New insight into
long-range nonadditivity within protein double-mutant cycles. Proteins 70:915‚Äì924.

13

Figures

A

5

Eb

B

10

Folded,
unbound
(F ‚âà fub)

D

Eb

Folded, bound
(F ‚âà 1)

5
10

5

Unfolded,
unbound
(F ‚âà fubfuf)

0

10

5

0

5

Ef

E

10

Eb

5

10

5

0

5

5

0

Ef

5

10

F

0

BA
BB

4
6

10

10

10

AB

AA

8
10

0
5

Ef
2

0

10

Eb

0

10

10

10
5

5

5

Eb

C

10

4

2

0

Ef

2

4

Eb

10

5

0

5

10

Ef
2
1
0
1
2
3
4
5
6

œÉ1 œÉ10
œÉ3 œÉ30
œÉ2 œÉ20
6 5 4 3 2 1 0 1 2

Ef

Figure 1: Fitness, selection, and epistasis in energy trait space. (A) Phase diagram of protein structural states. Dashed lines separate structural phases of the protein
corresponding to plateaus on the fitness landscape; arrows represent the folding transition
(green), binding transition (red), and the coupled folding-binding transition (blue). Fitness
landscapes F(Ef , Eb ) with direct selection (B) for binding only (fub = fuf = 0), (C) for
folding only (fub = 1, fuf = 0), and (D) for both binding and folding (fub = 0.9, fuf = 0).
Black contours indicate constant fitness values. The contours are uniformly spaced in energy
space; fitness differences between adjacent contours are not all equal. Streamlines indicate
~ log F, with color showing its magnitude (decreasing
the direction of the selection ‚Äúforce‚Äù ‚àá
from red to blue). (E) Projection of a genotype distribution and mutational network into
energy space for L = 2 and a two-letter (k = 2) alphabet. (F) Blue arrows indicate the
same mutation on different genetic backgrounds. When the fitness contours are straight,
the mutation is beneficial regardless of the background (œÉ1 or œÉ2 ). However, with curved
contours, the same mutation can become deleterious (œÉ3 ‚Üí œÉ30 ), indicative of sign epistasis.
Sign epistasis from curved contours can give rise to multiple local fitness maxima (e.g., AA
and BB in (E)).

14

A

B
10

Eb

2

5

Eb

0
10

5

0

5

10

D

2.0
1.6

m
macc

Œ¥f , Œ¥b

1.2

E

6

4

2 0

2

4

Ef
1.0
0.6
0.4
0.2

-14 -11 -8

8

0.8

m,macc 1.4

1.0

2
6

15

Ef
1.8

0
4

5

C

4

-5

-2

1

E ref
f

0.25

Stable
Marginal
Unstable

0.20
0.15

0.0

4

œÅ(`) 0.10

F
Spath/¬Ø`

0.05
0.00
0.0 0.5 1.0 1.5 2.0 2.5 3.0

`/L

Œ¥f
Œ¥b
-14 -11 -8

-5

1

4

f

1.8
1.7
1.6
1.5
1.4
1.3
1.2
1.1

Spath/¬Ø`

-14 -11 -8

Scom

-5

E ref
f

15

-2

E ref

-2

1

4

0.40
0.35
0.30
0.25
0.20
0.15
0.10
0.05
0.00

Scom

Figure 2:
Properties of adaptation with direct selection for binding only.
(A) Global distribution of folding and binding energies for all k L = 56 genotypes in a single
realization of the model with a marginally stable protein (Efref = ‚àí3 kcal/mol). The black
star indicates the initial state for adaptation (global maximum on F1 ), red triangles indicate
local fitness maxima on F2 , shaded according to their commitment probabilities œà(œÉ), and
the blue crosses indicate best-folding and best-binding genotypes. The magenta line connects
genotypes on the Pareto front, and the black contours indicate constant fitness F2 . (B) The
region of energy space accessible to adaptive paths, zoomed in from (A). Example paths are
shown in blue and green; black circles indicate intermediate states along paths, sized proportional to their path density œà(œÉ); small gray circles are genotypes inaccessible to adaptation.
(C) Average number m of local fitness maxima (solid, green) and average number macc of
local maxima accessible to adaptation (dashed, blue) versus Efref . The average number of
maxima is greatest at Efref ‚âà ‚àí3 kcal/mol, where multiple local maxima are separated by
‚âà 2.23 substitutions on average. (D) Average per-residue Hamming distance between the
maxima and the best-folding genotype (Œ¥f ; solid, green) and the best-binding genotype (Œ¥b ;
dashed, blue) versus Efref . (E) Average distributions œÅ(`) of path lengths (number of substitutions) ` for stable proteins (Efref = ‚àí15 kcal/mol), marginally stable proteins (Efref = ‚àí3
kcal/mol), and intrinsically unstable proteins (Efref = 5 kcal/mol). (F) Per-substitution path
entropy Spath /`¬Ø (solid, green) and entropy of commitment probabilities Scom (dashed, blue)
versus Efref . Panel (E) is averaged over 105 realizations of the model; all other averages are
taken over 104 realizations. In all panels fub = fuf = 0 and Ebmin
= Ebmin
= ‚àí5 kcal/mol.
1
2

16

A
m

1.35
1.30
1.25
1.20
1.15
1.10
1.05
1.00

B

1.0

Prob. of adaptation

0.8

m
Œ¥f
Œ¥b
-8

-6

-4

-2

0.6
0.4

Œ¥f ,Œ¥b Ebmin
2

0.2
0

0.0

Ebmin

C

Ebmin
1
2

Eb

0

0
2
4

0

5

10

15

6

Ef

F

6
4
2
0
2
4
6

Prob. div. fates

Eb

0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0.0

4

5

E

8 7 6 5 4 3 2 10

D

5

Eb

0
1
2
3
4
5
6
7
8

10

5

0

5

Ef

4

2 0

2

4

6

Ef
0.20
0.15
0.10
0.05
0.00

8

7

6

5 4

3

2

1 0

E min
b2

Figure 3: Properties of adaptation with direct selection for folding only. (A) The
average number of local maxima m (solid, green) and their average per-residue Hamming
distance from the best-folding (Œ¥f ; dashed, blue) and the best-binding (Œ¥b ; dotted, red)
genotypes versus Ebmin . (B) Probability that adaptation occurs when the binding target is
changed (i.e., the initial state is not coincident with any of the final states), as a function
of Ebmin
and Ebmin
. (C,D) Example landscape with divergent binding fates: there are two
1
2
accessible local maxima, one with Eb < 0 (favorable binding, œà(œÉ) = 0.6) and the other
with Eb > 0 (negligible binding, œà(œÉ) = 0.4). All symbols are the same as in Fig. 2A,B.
(E) Average distribution of local maxima, weighted by their commitment probabilities. The
average commitment entropy for realizations with divergent fates is Scom ‚âà 0.43. In (C)‚Äì(E)
we used Ebmin
= Ebmin
= ‚àí6.5 kcal/mol. (F) The probability of having divergent fates versus
1
2
min
min
Eb2 = Eb1 . Panel (E) is averaged over 105 realizations of the model; all other averages are
taken over 104 realizations. In all panels fub = 1, fuf = 0, and Efref = 0 kcal/mol.

17

A

B

15

C

10
8

10

Eb

8

6

Eb

5

6

4

Eb

2

5

0

5

10

2
2

2
5

4
0

0

0

10

4
10

8

6

Ef

4

Ef

2

0

2

10 8

6

4

2 0

2

4

Ef

Figure 4: Properties of adaptation with direct selection for both folding and
binding. (A, B) Distribution of folding and binding energies in an example landscape for a
marginally stable and marginally bound protein; all symbols are the same as in Fig. 2A,B.
(C) Landscape averaged over 105 realizations. Distribution of initial states is shown in
green, intermediate states in blue (weighted by their path densities), and final states in
red (weighted by their commitment probabilities). In all panels fub = 0.9, fuf = 0, and
Efref = Ebmin
= Ebmin
= ‚àí4 kcal/mol.
1
2

18

Supplementary Material:
Protein folding and binding can emerge as evolutionary
spandrels through structural coupling
Michael Manhart1 and Alexandre V. Morozov1,2
1 Department

of Physics and Astronomy and 2 BioMaPS Institute for Quantitative Biology,
Rutgers University, Piscataway, New Jersey 08854, USA

Supplementary Methods
Population genetics model. In the monomorphic limit, the population is described by
a single point in genotype space [39]. The population evolves over time via mutations that
arise sequentially and either fix or disappear. Each fixation event leads to an amino acid
substitution in the entire population. The rate of making a substitution from genotype œÉ to
genotype œÉ 0 is given by [35]
W (œÉ 0 |œÉ) = N u œÜ(œÉ 0 |œÉ),

(S1)

where N is the effective population size, u is the mutation rate, and œÜ(œÉ 0 |œÉ) is the probability
of a single œÉ 0 mutant fixing in a population of wild-type œÉ. Typically the fixation probability
depends only on the relative selection coefficient s = F(œÉ 0 )/F(œÉ) ‚àí 1 between the two
genotypes, where F(œÉ) is the fitness of genotype œÉ. For example, in the Wright-Fisher
model, œÜ(s) = (1 ‚àí e‚àí2s )/(1 ‚àí e‚àí2N s ), where N is the effective population size [49]. In the
strong-selection limit (N |s|  1),

1 ‚àí e‚àí2s for s > 0
œÜ(s) ‚âà
(S2)
0
for s < 0
Thus the effective population size N sets the overall time scale (N u)‚àí1 of substitutions but
does not affect fixation probabilities.
Statistics of adaptive paths. We calculate statistical properties of the adaptive paths
using a transfer matrix-like algorithm [29, 30]. Let S be the set of all genotypes accessible
to adaptation, and let Sf be the set of final state genotypes (e.g., local fitness maxima).
Define W (œÉ 0 |œÉ) as the rate of making a substitution
œÉ to genotype œÉ 0 (e.g.,
Pfrom genotype
0
given by Eq. S1). The rate matrix defines Œ∏(œÉ) = ( nn œÉ0 of œÉ W (œÉ |œÉ))‚àí1 , the mean waiting
time in genotype œÉ before a substitution occurs, where the sum is over all genotypes œÉ 0 one
mutation away from œÉ (nearest mutational neighbors, ‚Äúnn‚Äù). The substitution rates also
determine the probability Q(œÉ 0 |œÉ) = W (œÉ 0 |œÉ)Œ∏(œÉ) of making the substitution œÉ ‚Üí œÉ 0 , given
that a substitution occurs out of œÉ.

19

For each substitution ` and intermediate genotype œÉ, we calculate P` (œÉ), the total probability of all paths that end at œÉ in ` substitutions; T` (œÉ), the total average time of all such
paths; and Œì` (œÉ), their total entropy. These quantities obey the following recursion relations:
P` (œÉ 0 ) =

X

Q(œÉ 0 |œÉ)P`‚àí1 (œÉ),

(S3)

nn œÉ of œÉ 0

T` (œÉ 0 ) =

X

Q(œÉ 0 |œÉ) [T`‚àí1 (œÉ) + Œ∏(œÉ)P`‚àí1 (œÉ)] ,

nn œÉ of œÉ 0

Œì` (œÉ 0 ) =

X

Q(œÉ 0 |œÉ) [Œì`‚àí1 (œÉ) ‚àí (log Q(œÉ 0 |œÉ))P`‚àí1 (œÉ)] ,

nn œÉ of œÉ 0

where P0 (œÉ) = 1 if œÉ is the initial state and P0 (œÉ) = 0 otherwise, and T0 (œÉ) = Œì0 (œÉ) = 0 for
all œÉ ‚àà S. The final states œÉ ‚àà Sf are treated as absorbing to ensure that only first-passage
paths are counted. We use these transfer matrix objects to calculate the path ensemble
quantities described in the text:

œÅ(`) =

X

P` (œÉ),

œà(œÉ) =

œÉ‚ààSf

tÃÑ =

Œõ
X

X

T` (œÉ) =

`=1 œÉ‚ààSf

Œõ
X

Spath =

P` (œÉ),

(S4)

`=1

œÑ (`) =

X

œÑ (œÉ),

œÑ (œÉ) =

œÉ‚ààS

`=1
Œõ
X

Œõ
X

X

Œõ
X

Œ∏(œÉ)P` (œÉ),

`=1

Œì` (œÉ),

œÑ (`) =

X

Œ∏(œÉ)P` (œÉ).

œÉ‚ààS

`=1 œÉ‚ààSf

The
up to a path length cutoff Œõ, which we choose such that 1 ‚àí
PŒõ sums are calculated
‚àí6
œÅ(`)
<
10
.
Note
that
the calculations for the state-dependent quantities œà(œÉ) and
`=1
œÑ (œÉ) are simplified in this model (compared to more general cases [29, 30]) since the strongselection dynamics prevents the population from traversing loops in genotype space. The
time complexity of the algorithm scales as O(Œ≥N Œõ) [29], where Œ≥ is the average connectivity
and N is the total size of the state space. For genotypic sequences of length L and an
alphabet of size k, Œ≥ ‚àº L(k ‚àí 1) and N ‚àº k L .
Validity of the additive energy model. Double mutant experiments indicate that
the additive energy model is a good approximation for residues that are not in direct physical
contact [38, 50]. For spatially-close residues, the mutational effects are largely ‚Äúsub-additive‚Äù
(diminishing-returns magnitude epistasis): two (de)stabilizing mutations combined will still
usually be (de)stabilizing, but less so than the sum of their individual effects [38, 50]. For
example, Istomin et al. [50] find that while residues separated by more than 6 AÃä are nearly
additive (correlation R2 = 0.97 with a slope of 0.88 between the sum of ‚àÜ‚àÜG‚Äôs for two
single mutants and ‚àÜ‚àÜG for the double mutant), spatially-close residues are substantially
sub-additive (R2 = 0.84, slope of 0.54). Nonetheless, in regions with straight contours which
20

represent most of our fitness landscapes, sub-additive energies cannot produce sign epistasis;
substantial deviations from energy sub-additivity are required to create additional local
maxima or place significant constraints on adaptive paths. Thus it appears that deviations
from energy additivity will not lead to qualitative changes in our model‚Äôs predictions.

21

Supplementary Figures

A

B

Mean log10s

0

0.0
0.8
1.6
2.4
3.2
4.0
4.8
5.6
6.4

2

Direct selection
for binding only

(Ebmin = Ebmin
= Ebmin
)
1
2

4

Ebmin

6
8
10
12
14
15

C
Direct selection
for folding only
(Efref = ‚àí5 kcal/mol)

Ebmin
2

E
Direct selection
for folding only
(Efref =0 kcal/mol)

Ebmin
2

10

5

0

7

6

5 4

3

2

1 0

6.0
6.4
6.8
7.2
7.6
8.0
8.4
8.8

Ebmin
1
0
1
2
3
4
5
6
7
8

7

6

5 4

3

2

Ebmin
1

Ebmin

4

1.5

6

3.0

8

4.5

10

6.0

12

7.5

1 0

9.0

14

D
Ebmin
2

F

Mean log10s

8

0.0

2

15

Mean log10s

8

0

5

Efref
0
1
2
3
4
5
6
7
8

Mean log10s
near maxima

2.4
2.7
3.0
3.3
3.6
3.9
4.2
4.5

Ebmin
2

10

5

0

5

Efref

0
1
2
3
4
5
6
7
8

Mean log10s
near maxima

8

7

6

5 4

3

2

6.3
6.6
6.9
7.2
7.5
7.8
8.1
8.4
8.7
1 0

Ebmin
1

0
1
2
3
4
5
6
7
8

Mean log10s
near maxima
2.8
3.0
3.2
3.4
3.6
3.8
4.0
4.2
4.4
8

7

6

5 4

3

2

1 0

Ebmin
1

Figure S1: Average selection strength. (A) Average log10 s (s is the selection coefficient)
of all accessible beneficial substitutions as a function of Efref and Ebmin = Ebmin
= Ebmin
in
1
2
the case of direct selection for binding only (fuf = fub = 0). Due to the Eb symmetry of
this case (Fig. 1B), we can neglect differences in Ebmin
and Ebmin
without loss of generality.
1
2
(B) Same as (A) but limited to accessible substitutions that end at local fitness maxima.
(C) Average log10 s of all accessible beneficial substitutions as a function of Ebmin
and Ebmin
1
2
in the case of selection for folding only (fuf = 0, fub = 1, Efref = ‚àí5 kcal/mol). (D) Same as
(C) but limited to accessible substitutions that end at local fitness maxima. (E, F) Same as
(C, D) but for Efref = 0 kcal/mol. Simultaneous selection for both binding and folding yields
qualitatively similar results. All data points are averages over 104 landscape realizations.

22

A

B4

2
0
Eb 2
4
6
8

10

Eb

5
0
5

20 15 10

5

0

Ef

Ef

C

D
6
4
Eb 2
0
2

10

Eb

14 12 10 8 6 4 2 0

5
0
5

0

5

10 15 20

Ef

4 2 0 2 4 6 8

Ef

Figure S2: Example landscapes for stable and intrinsically unstable proteins with
direct selection for binding only. Symbols and randomly generated energy matrices (f ,
b1 , and b2 ) are the same as in Fig. 2A,B. (A, B) Stable protein (Efref = ‚àí15 kcal/mol). (C,
D) Intrinsically unstable protein (Efref = 5 kcal/mol). As in Fig. 2A,B, fub = fuf = 0 and
Ebmin
= Ebmin
= ‚àí5 kcal/mol.
1
2

23

A
Eb

10
8
6
4
2
0
2
4
6

B
Eb

16 14 12 10 8

6

4

2 0

10
8
6
4
2
0
2
4
6

C
Eb

10 8

6

4

Ef

2 0

Ef

2 4

6

10
8
6
4
2
0
2
4
6

0

5

10

Ef

Figure S3: Average landscapes for direct selection for binding only. As in Fig. 4C,
the distribution of initial states is shown in green, intermediate states in blue (weighted by
their path densities), and final states in red (weighted by their commitment probabilities).
(A) Stable proteins (Efref = ‚àí15 kcal/mol). (B) Marginally stable proteins (Efref = ‚àí3
kcal/mol). (C) Intrinsically unstable proteins (Efref = 5 kcal/mol). All landscapes are
averaged over 105 realizations. As in Fig. 2A,B, fub = fuf = 0 and Ebmin
= Ebmin
= ‚àí5
1
2
kcal/mol.

24

A
Eb

Strong binding to
strong binding

B

15

Weak binding to
strong binding
10

5

5

Eb

C

15

10

0

0

5

5

Strong binding to
weak binding
20
15

Eb

10
5
0

5

0

5

10

15

5

Ef

Eb

8
6
4
2
0
2
4
6
8

0

10

15

5

0

Ef

2

5

10

15

Ef
16

0

14

Eb

2

Eb

4

10

5

0

8

5

6

6
4

2

2

0

Eb

2

6

4

6

6

8

8
8

6

4

2 0

0

10

2

4

6

8

6

4

2

0

2

Ef

16
14
12

Eb

2
4

10

2

0

4

10

6
8

Ef

4

12

8

6

Ef

Eb

5

10
8
6
4

10

8

6

Ef

4

Ef

2 0

2

4

2

10

8

6

4

2

0

2

4

Ef

Figure S4: Example and average landscapes for direct selection for folding only.
Symbols in top and middle panels are the same as in Fig. 2A,B, and the color scheme in
the bottom panels is the same as in Fig. 4C and Fig. S3. (A) Strong binding to both old
and new targets (Ebmin
= Ebmin
= ‚àí8 kcal/mol). (B) Weak binding to old target and strong
1
2
min
binding to new target (Eb1 = 0 kcal/mol, Ebmin
= ‚àí8 kcal/mol). (C) Strong binding to old
2
target and weak binding to new target (Ebmin
=
‚àí8 kcal/mol, Ebmin
= 0 kcal/mol). We use
1
2
ref
fub = 1, fuf = 0, and Ef = 0 kcal/mol in all cases. In the bottom panels, the landscapes
are averaged over 105 realizations.

25

B

0.20

4

Probability

A

2

Eb

0
2
4
6

Eb

6

4

2 0

2

0.10
0.05
0.00
0.0

4

Ef

0.5

1.0

1.5

2.0

2.5

`/L

D

0.25

10
8
6
4
2
0
2

Probability

C

8

œÅ ( `)
œÑ(`)/tÃÑ

0.15

10

5

0.15
0.10
0.05
0.00
0.0

0

Ef

œÅ ( `)
œÑ(`)/tÃÑ

0.20

0.5

1.0

1.5

2.0

2.5

`/L

Figure S5: Distribution of adaptation times over intermediate states. (A) The
same landscape realization as in Fig. 2A,B (selection for binding only on a marginally stable
protein), but with each intermediate state œÉ sized proportional to œÑ (œÉ), the average time
spent in that state. (B) The probability œÅ(`) (solid, green) of taking an adaptive path of
exactly ` substitutions and the average time œÑ (`) (dashed, blue) spent by paths at the `th
substitution, averaged over 105 realizations with fub = fuf = 0, Efref = ‚àí3 kcal/mol, and
Ebmin
= Ebmin
= ‚àí5 kcal/mol. (C, D) Same as (A, B), but with the landscape realization
1
2
used in Fig. 4A,B (selection for both binding and folding, fub = 0.9, fuf = 0, Efref = Ebmin
=
1
Ebmin
=
‚àí4
kcal/mol).
2

26

