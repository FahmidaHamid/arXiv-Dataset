Lack of confidence in ABC model choice
Christian P. Robert, ‚àó
‚àó
k

‚Ä† ‚Ä°

Jean-Marie Cornuet, ¬ß Jean-Michel Marin, ¬∂ and Natesh S. Pillai k

UniversiteÃÅ Paris Dauphine,‚Ä† Institut Universitaire de France,‚Ä° CREST, Paris,¬ß CBGP, INRA, Montpellier, France,¬∂ I3M, UMR CNRS 5149, UniversiteÃÅ Montpellier 2, France, and
Department of Statistics, Harvard University, Cambridge, MA

arXiv:1102.4432v4 [stat.ME] 20 Jun 2011

Submitted to Proceedings of the National Academy of Sciences of the United States of America

Approximate Bayesian computation (ABC) have become an essential tool for the analysis of complex stochastic models. Grelaud et
al. (2009, Bayesian Ana 3:427‚Äì442) advocated the use of ABC for
model choice in the specific case of Gibbs random fields, relying on
a inter-model sufficiency property to show that the approximation
was legitimate. We implemented ABC model choice in a wide range
of phylogenetic models in the DIY-ABC software (Cornuet et al.
(2008) Bioinfo 24:2713‚Äì2719). We now present arguments as to
why the theoretical arguments for ABC model choice are missing,
since the algorithm involves an unknown loss of information induced
by the use of insufficient summary statistics. The approximation
error of the posterior probabilities of the models under comparison
may thus be unrelated with the computational effort spent in running an ABC algorithm. We then conclude that additional empirical
verifications of the performances of the ABC procedure as those
available in DIYABC are necessary to conduct model choice. 1
likelihood-free methods

|

Bayes factor

|

Bayesian model choice

|

sufficiency

Abbreviations: ABC, approximate Bayesian computation; ABC-MC, ABC model
choice; DIY-ABC, Do-it-yourself ABC; IS, importance sampling; SMC, sequential
Monte Carlo

I

nference on population genetic models such as coalescent
trees is one representative example of cases when statistical
analyses like Bayesian inference cannot easily operate because
the likelihood function associated with the data cannot be
computed in a manageable time (TavareÃÅ et al., 1997; Beaumont et al., 2002; Cornuet et al., 2008). The fundamental
reason for this impossibility is that the model associated with
coalescent data has to integrate over trees of high complexity.
In such settings, traditional approximation tools like
Monte Carlo simulation (Robert and Casella, 2004) from the
posterior distribution are unavailable for practical purposes.
Indeed, due to the complexity of the latent structures defining the likelihood (like the coalescent tree), their simulation
is too unstable to bring a reliable approximation in a manageable time. Such complex models call for a practical if
cruder approximation method, the ABC methodology (TavareÃÅ
et al., 1997; Pritchard et al., 1999). This rejection technique
bypasses the computation of the likelihood via simulations
from the corresponding distribution (see Beaumont, 2010 and
Lopes and Beaumont, 2010 for recent surveys, and CsilleÃÄry
et al., 2010a for the wide and successful array of applications
based on implementations of ABC in genomics and ecology).
We argue here that ABC is a generally valid approximation method for doing Bayesian inference in complex models.
However, without further justification, ABC methods cannot
be trusted to discriminate between two competing models
when based on insufficient summary statistics. We exhibit
simple examples in which the information loss due to insufficiency leads to inconsistency, i.e. when the ABC model selection fails to recover the true model, even with infinite amounts
of observation and computation. On the one hand, ABC using
the entire data leads to a consistent model choice decision but
it is clearly infeasible in most settings. On the other hand,
too much information loss due to insuffiency leads to a statistically invalid decision procedure. The challenge is in achieving
a balance between information loss and consistency. Theo-

www.pnas.org/cgi/doi/10.1073/pnas.xxx

retical results that mathematically validate model choice for
insufficient statistics are currently lacking on a general basis.
Our conclusion at this stage is to opt for a cautionary
approach in ABC model choice, handling it as an exploratory
tool rather than trusting the Bayes factor approximation. The
corresponding degree of approximation cannot be evaluated,
except via Monte Carlo evaluations of the model selection
performances of ABC. More empirical measures such as those
proposed in the DIY-ABC software (Cornuet et al., 2008) and
in Ratmann et al. (2009) thus seem to be the only available
solution at the current time for conducting model comparison.
We stress that, while Templeton (2008, 2010) repeatedly
expressed reservations about the formal validity of the ABC
approach in statistical testing, those criticisms were rebutted
in Beaumont et al. (2010); CsilleÃÄry et al. (2010b); Berger et al.
(2010) and are not relevant for the current paper.

Statistical Methods
The ABC algorithm. The setting in which ABC operates is the
approximation of a simulation from the posterior distribution
œÄ(Œ∏|y) ‚àù œÄ(Œ∏)f (y|Œ∏) when distributions associated with both
the prior œÄ and the likelihood f can be simulated (the later
being unavailable in closed form). The first ABC algorithm
was introduced by Pritchard et al. (1999) as follows: given
a sample y from a sample space D, a sample (Œ∏1 , . . . , Œ∏M ) is
produced by
Algorithm 1: ABC sampler
for i = 1 to N do
repeat
Generate Œ∏ 0 from the prior distribution œÄ(¬∑)
Generate z from the likelihood f (¬∑|Œ∏ 0 )
until œÅ{Œ∑(z), Œ∑(y)} ‚â§ 
set Œ∏ i = Œ∏ 0 ,
end for
The parameters of the ABC algorithm are the so-called
summary statistic Œ∑(¬∑), the distance œÅ{¬∑, ¬∑}, and the tolerance
level  > 0. The approximation of the posterior distribution
œÄ(Œ∏|y) provided by the ABC sampler is to instead sample
from the marginal in Œ∏ of the joint distribution
œÄ (Œ∏, z|y) = R

œÄ(Œ∏)f (z|Œ∏)IA,y (z)
,
œÄ(Œ∏)f (z|Œ∏)dzdŒ∏
A,y √óŒò

where IB (¬∑) denotes the indicator function of B and
A,y = {z ‚àà D|œÅ{Œ∑(z), Œ∑(y)} ‚â§ } .
The basic justification of the ABC approximation is that,
when using a sufficient statistic Œ∑ and a small (enough) tolerance , we have
Z
œÄ (Œ∏|y) = œÄ (Œ∏, z|y)dz ‚âà œÄ(Œ∏|y) .

1

CPR, JMM and NSP designed and performed research, JMC and JMM analysed data, and CPR,
JMC and JMM wrote the paper.

PNAS

Issue Date

Volume

Issue Number

1‚Äì10

In practice, the statistic Œ∑ is necessarily insufficient (since
only exponential families enjoy sufficient statistics with fixed
dimension, see Lehmann and Casella, 1998) and the approximation then converges to the less informative œÄ(Œ∏|Œ∑(y)) when
 goes to zero. This loss of information is a necessary price
to pay for the access to computable quantities and œÄ(Œ∏|Œ∑(y))
provides a convergent inference on Œ∏ when Œ∏ is identifiable
in the distribution of Œ∑(y) (Fearnhead and Prangle, 2010).
While acknowledging the gain brought by ABC in handling
Bayesian inference in complex models, and the existence of involved summary selection mechanisms (Joyce and Marjoram,
2008; Nunes and Balding, 2010), we demonstrate here that the
loss due to the ABC approximation may be arbitrary in the
specific setting of Bayesian model choice via posterior model
probabilities.
ABC model choice. The standard Bayesian tool for model
comparison is the marginal likelihood (Jeffreys, 1939)
Z
w(y) =
œÄ(Œ∏)f (y|Œ∏) dŒ∏ ,
Œò

which leads to the Bayes factor for comparing the evidences
of models with likelihoods f1 (y|Œ∏ 1 ) and f2 (y|Œ∏ 2 ),
R
œÄ1 (Œ∏ 1 )f1 (y|Œ∏ 1 ) dŒ∏ 1
w1 (y)
Œò
B12 (y) =
= R 1
.
w2 (y)
œÄ (Œ∏ 2 )f2 (y|Œ∏ 2 ) dŒ∏ 2
Œò2 2
As detailed in Beaumont et al. (2010), it provides a valid criterion for model comparison that is naturally penalised for
model complexity.
Bayesian model choice proceeds by creating a probability
structure across M models (or likelihoods). It introduces the
model index M as an extra unknown parameter, associated
with its prior distribution, œÄ(M = m) (m = 1, . . . , M ), while
the prior distribution on the parameter is conditional on the
value m of the M index, denoted by œÄm (Œ∏ m ) and defined on
the parameter space Œòm . The choice between those models is
then driven by the posterior distribution of M,
X
P(M = m|y) = œÄ(M = m)wm (y)
œÄ(M = k)wk (y)

belief is false: There have been at least three independent introductions from North America during the past two decades.
The above estimate is improved by regression regularisation (Fagundes et al., 2007), where model indices are processed as categorical variables in a polychotomous regression.
When comparing two models, this involves a standard logistic regression. Rejection-based approaches were lately introduced by Cornuet et al. (2008), Grelaud et al. (2009) and
Toni et al. (2009), in a Monte Carlo simulation of model indices as well as model parameters. Those recent extensions
are already widely used in population genetics, as exemplified by Belle et al. (2008); Cornuet et al. (2010); Excoffier
et al. (2009); Ghirotto et al. (2010); Guillemaud et al. (2009);
Leuenberger and Wegmann (2010); Patin et al. (2009); Ramakrishnan and Hadly (2009); Verdu et al. (2009); Wegmann
and Excoffier (2010). Another illustration of the popularity
of this approach is given by the availability of four softwares
implementing ABC model choice methodologies:
‚Ä¢ ABC-SysBio, which relies on a SMC-based ABC for infer-

ence in system biology, including model-choice (Toni et al.,
2009).
‚Ä¢ ABCToolbox which proposes SMC and MCMC implementations, as well as Bayes factor approximation (Wegmann
et al., 2011).
‚Ä¢ DIYABC, which relies on a regularised ABC-MC algorithm
on population history using molecular markers (Cornuet
et al., 2008).
‚Ä¢ PopABC, which relies on a regular ABC-MC algorithm for
genealogical simulation (Lopes et al., 2009).
As exposed in e.g. Grelaud et al. (2009), Toni and Stumpf
(2010), or Didelot et al. (2011), once M is incorporated within
the parameters, the ABC approximation to its posterior follows from the same principles as in regular ABC. The corresponding implementation is as follows, using for the summary
statistic a statistic Œ∑(z) = {Œ∑1 (z), . . . , Œ∑M (z)} that is the concatenation of the summary statistics used for all models (with
an obvious elimination of duplicates).

k

where wk (y) denotes the marginal likelihood for model k.
While this posterior distribution is straightforward to interpret, it offers a challenging computational conundrum in
Bayesian analysis. When the likelihood is not available, ABC
represents the almost unique solution. Pritchard et al. (1999)
describe the use of model choice based on ABC for distinguishing between different mutation models. The justification
behind the method is that the average ABC acceptance rate
associated with a given model is proportional to the posterior
probability corresponding to this approximative model, when
identical summary statistics, distance, and tolerance level are
used over all models. In practice, an estimate of the ratio of
marginal likelihoods is given by the ratio of observed acceptance rates. Using Bayes formula, estimates of the posterior
probabilities are straightforward to derive. This approach has
been widely implemented in the literature (see, e.g., Estoup
et al., 2004, Miller et al., 2005, Pascual et al., 2007, and Sainudiin et al., 2011).
A representative illustration of the use of an ABC model
choice approach is given by Miller et al. (2005) which analyses
the European invasion of the western corn rootworm, North
America‚Äôs most destructive corn pest. Because this pest was
initially introduced in Central Europe, it was believed that
subsequent outbreaks in Western Europe originated from this
area. Based on an ABC model choice analysis of the genetic
variability of the rootworm, the authors conclude that this
2

www.pnas.org/cgi/doi/10.1073/pnas.xxx

Algorithm 2: ABC-MC
for i = 1 to N do
repeat
Generate m from the prior œÄ(M = m)
Generate Œ∏ m from the prior œÄm (Œ∏ m )
Generate z from the model fm (z|Œ∏ m )
until œÅ{Œ∑(z), Œ∑(y)} ‚â§ 
Set m(i) = m and Œ∏ (i) = Œ∏ m
end for
The ABC estimate of the posterior probability œÄ(M =
m|y) is then the frequency of acceptances from model m in
P
the above simulation œÄÃÇ(M = m|y) = N ‚àí1 N
i=1 Im(i) =m .
This also corresponds to the frequency of simulated pseudodatasets from model m that are closer to the data y than the
tolerance . In order to improve the estimation by smoothing, Cornuet et al. (2008) follow the rationale that motivated
the use of a local linear regression in Beaumont et al. (2002)
and rely on a weighted polychotomous regression to estimate
œÄ(M = m|y) based on the ABC output. This modelling is
implemented in the DIYABC software.

The difficulty with ABC-MC. There is a fundamental discrepancy between the genuine Bayes factors/posterior probabilities) and the approximations resulting from ABC-MC.
Footline Author

Thus, unless g1 (y) = g2 (y), as in the special case of Gibbs random fields detailed below, the two Bayes factors differ by the
ratio g1 (y)/g2 (y), which is only equal to one in a very small
number of known cases. This decomposition is a straightforward proof that a model-wise sufficient statistic is usually not
i=1
i=1
sufficient across models, hence for model comparison. An imAn alternative representation is given by
mediate corollary is that the ABC-MC approximation does
not always converge to the exact Bayes factor.
PT
œÄ(M = 2)
t=1 Imt =1 IœÅ{Œ∑(zt ),Œ∑(y)}‚â§
The discrepancy between limiting ABC and genuine
d
,
B12 (y) =
PT
Bayesian inferences does not come as a surprise, because ABC
œÄ(M = 1)
t=1 Imt =2 IœÅ{Œ∑(zt ),Œ∑(y)}‚â§
is indeed an approximation method. Users of ABC algorithms
where the pairs (mt , z t ) are simulated from the joint prior and
are therefore prepared for some degree of imprecision in their
T is the number of simulations necessary for N acceptances
final answer, a point stressed by Wilkinson (2008) and Fearnin Algorithm 2. In order to study the limit of this approximahead and Prangle (2010) when they qualify ABC as exact
tion, we first let T go to infinity. (For simplification purposes
inference on a wrong model. However, the magnitude of the
Œ∑
and without loss of generality, we choose a uniform prior on
difference between B12 (y) and B12
(y) expressed by [ 1 ] is such
d
that there is no direct connection between both answers. In a
the model index.) The limit of B12 (y) is then
general setting, if Œ∑ has the same dimension as one component
P[M = 1, œÅ{Œ∑(z), Œ∑(y)} ‚â§ ]

of the n components of y, the ratio g1 (y)/g2 (y) is equivalent
B12
(y) =
P[M = 2, œÅ{Œ∑(z), Œ∑(y)} ‚â§ ]
to a density ratio for a sample of size O(n), hence it can be
RR
arbitrarily small or arbitrarily large when n grows. ContrastIœÅ{Œ∑(z),Œ∑(y)}‚â§ œÄ1 (Œ∏ 1 )f1 (z|Œ∏ 1 ) dz dŒ∏ 1
Œ∑
= RR
ingly, the Bayes factor B12
(y) is based on an equivalent to a
IœÅ{Œ∑(z),Œ∑(y)}‚â§ œÄ2 (Œ∏ 2 )f2 (z|Œ∏ 2 ) dz dŒ∏ 2
single observation, hence does not necessarily converge with
RR
IœÅ{Œ∑,Œ∑(y)}‚â§ œÄ1 (Œ∏ 1 )f1Œ∑ (Œ∑|Œ∏ 1 ) dŒ∑ dŒ∏ 1
n to the correct limit, as shown by the Poisson and normal
,
= RR
examples below and in SI. The conclusion derived from the
IœÅ{Œ∑,Œ∑(y)}‚â§ œÄ2 (Œ∏ 2 )f2Œ∑ (Œ∑|Œ∏ 2 ) dŒ∑ dŒ∏ 2
ABC-based Bayes factor may therefore completely differ from
Œ∑
Œ∑
where f1 (Œ∑|Œ∏ 1 ) and f2 (Œ∑|Œ∏ 2 ) denote the densities of Œ∑(z)
the conclusion derived from the exact Bayes factor and there
when z ‚àº f1 (z|Œ∏ 1 ) and z ‚àº f2 (z|Œ∏ 2 ), respectively. By
is no possibility of a generic agreement between both, or even
L‚ÄôHospital formula, if  goes to zero, the above converges to
of a manageable correction factor. This discrepancy means
Z
Z
that a theoretical validation of the ABC-based model choice
Œ∑
B12
(y) = œÄ1 (Œ∏ 1 )f1Œ∑ (Œ∑(y)|Œ∏ 1 ) dŒ∏ 1
œÄ2 (Œ∏ 2 )f2Œ∑ (Œ∑(y)|Œ∏ 2 ) dŒ∏ 2 , procedure is currently missing and that, due to this absence,
potentialy costly simulation-based assessments are required
when calling for this procedure.
namely the Bayes factor for testing model 1 versus model 2
Therefore, users must be warned that ABC approximabased on the sole observation of Œ∑(y). This result reflects
tions to Bayes factors do not perform as standard numerical
the current perspective on ABC: the inference derived from
or Monte Carlo approximations, with the exception of Gibbs
the ideal ABC output when  = 0 only uses the information
random fields detailed in the next section. In all cases when
contained in Œ∑(y). Thus, in the limiting case, i.e. when the alg1 (y)/g2 (y) differs from one, no inference on the true Bayes
gorithm uses an infinite computational power, the ABC odds
factor can be derived from the ABC-MC approximation withratio does not account for features of the data other than the
out further information on the ratio g1 (y)/g2 (y), most often
value of Œ∑(y), which is why the limiting Bayes factor only
unavailable in settings where ABC is necessary.
depends on the distribution of Œ∑ under both models.
Didelot et al. (2011) also derived this relation between
When running ABC for point estimation, the use of an
both Bayes factors in their formula [18]. While they still adinsufficient statistic does not usually jeopardise convergence
vocate the use of ABC model choice in the absence of sufficient
of the method. As shown, e.g., in (Fearnhead and Prangle,
statistic, we stress that no theoretical guarantee can be given
2010, Theorem 2), the noisy version of ABC as an inference
on the validity of the ABC approximation to the Bayes factor
method is convergent under usual regularity conditions for
and hence of its use as a model choice procedure.
model-based Bayesian inference (Bernardo and Smith, 1994),
Note that Sousa et al. (2009) resort to full allelic distriincluding identifiability of the parameter for the insufficient
butions in an ABC framework, instead of chosing summary
statistic Œ∑. In contrast, the loss of information induced by
statistics. They show how to apply ABC using allele frequenŒ∑ may seriously impact model-choice Bayesian inference. Incies to draw inferences in cases where selecting suitable sumdeed, the information contained in Œ∑(y) is lesser than the
mary statistics is difficult (and where the complexity of the
information contained in y and this even in most cases when
model or the size of dataset prohibits to use full-likelihood
Œ∑(y) is a sufficient statistic for both models. In other words,
methods). In such settings, ABC-MC does not suffer from
Œ∑(y) being sufficient for both f1 (y|Œ∏ 1 ) and f2 (y|Œ∏ 2 ) does not
the divergence exhibited here because the measure of distance
usually imply that Œ∑(y) is sufficient for {m, fm (y|Œ∏ m )}. To
does not involve a reduction of the sample. The same comsee why this is the case, consider the most favourable case,
ment applies to the ABC-SysBio software of Toni et al. (2009),
namely when Œ∑(y) is a sufficient statistic for both models.
which relies on the whole dataset. The theoretical validation
We then have by the factorisation theorem (Lehmann and
of ABC inference in hidden Markov models by Dean et al.
Casella, 1998) that fi (y|Œ∏ i ) = gi (y)fiŒ∑ (Œ∑(y)|Œ∏ i ) (i = 1, 2), i.e.
(2011) should also extend to the model choice setting because
R
œÄ(Œ∏ 1 )g1 (y)f1Œ∑ (Œ∑(y)|Œ∏ 1 ) dŒ∏ 1
the approach does not rely on summary statistics but instead
w1 (y)
Œò1
= R
B12 (y) =
Œ∑
on the whole sequence of observations.
w2 (y)
œÄ(Œ∏ 2 )g2 (y)f2 (Œ∑(y)|Œ∏ 2 ) dŒ∏ 2
Œò2
R
g1 (y) œÄ1 (Œ∏ 1 )f1Œ∑ (Œ∑(y)|Œ∏ 1 ) dŒ∏ 1
R
=
g2 (y) œÄ2 (Œ∏ 2 )f2Œ∑ (Œ∑(y)|Œ∏ 2 ) dŒ∏ 2
The ABC approximation to a Bayes factor, B12 say, resulting from Algorithm 2 is

N
N
X
X
d
B
Im(i) =1 œÄ(M = 1)
Im(i) =2 .
12 (y) = œÄ(M = 2)

=
Footline Author

g1 (y) Œ∑
B (y) .
g2 (y) 12

[1]

Results
PNAS

Issue Date

Volume

Issue Number

3

The specific case of Gibbs random fields. In an apparent contradiction with the above, Grelaud et al. (2009) showed that
the computation of the posterior probabilities of Gibbs random fields under competition can be done via ABC techniques, which provide a converging approximation to the true
Bayes factor. The reason for this result is that, for these
models in the above ratio [ 1 ], g1 (y) = g2 (y). The validation
of an ABC comparison of Gibbs random fields is thus that
their specific structure allows for a sufficient statistic vector
that runs across models and therefore leads to an exact (when
 = 0) simulation from the posterior probabilities of the models. Each Gibbs random field model has its own sufficient
statistic Œ∑m (¬∑) and Grelaud et al. (2009) exposed the fact that
the vector of statistics Œ∑(¬∑) = (Œ∑1 (¬∑), . . . , Œ∑M (¬∑)) is also sufficient for the joint parameter (M, Œ∏ 1 , . . . , Œ∏ M ).
Didelot et al. (2011) point out that this specific property
of Gibbs random fields can be extended to any exponential
family (hence to any setting with fixed-dimension sufficient
statistics, see Lehmann and Casella, 1998). Their argument
is that, by including all sufficient statistics and all dominating
measure statistics in an encompassing model, models under
comparison are submodels of the encompassing model. The
concatenation of those statistics is then jointly sufficient across
models. While this encompassing principle holds in full generality, in particular when comparing models that are already
embedded, we think it leads to an overly optimistic perspective about the merits of ABC for model choice: in practice,
most complex models do not enjoy sufficient statistics (if only
because they are beyond exponential families). The Gibbs
case processed by Grelaud et al. (2009) therefore happens to
be one of the very few realistic counterexamples. As demonstrated in the next section and in the normal example in SI,
using insufficient statistics is more than a mere loss of information. Looking at what happens in the limiting case when
one relies on a common model-wise sufficient statistic is a formal but useful study since it brings light on the potentially
huge discrepancy between the ABC-based and the true Bayes
factors. To develop a solution to the problem in the formal
case of the exponential families does not help in understanding
the discrepancy for non-exponential models.

Arbitrary ratios. The difficulty with the discrepancy between
Œ∑
B12 (y) and B12
(y) is that this discrepancy is impossible to
evaluate in a general setting, while there is no reason to expect a reasonable agreement between both quantities. A first
illustration was produced by Marin et al. (2011) in the case
of MA(q) models.
A simple illustration of the discrepancy due to the use of
a model-wise sufficient statistic is a a sample y = (y1 , . . . , yn )
that could come either from a Poisson P(Œª) distribution or
from a geometric G(p) distribution, already introduced in
Grelaud et al. (2009) as a counter-example to Gibbs random fields and later reprocessed in Didelot et al. (2011) to
support
P their sufficiency argument. In this case, the sum
S = n
i=1 yi = Œ∑(y) is a sufficient statistic for both models
but not across models. The distribution of the sample given
S is a multinomial M(S, 1/n, . . . , 1/n) distribution when the
data is Poisson,
P while it is the uniform distribution over the
y‚Äôs such that i yi = S in the geometric case, since S is then
a negative binomial N eg(n, p) variable. The discrepancy ratio
is therefore
!
Y
n+S‚àí1
g1 (y)/g2 (y) =
S! n‚àíS
yi ! .
S
i
When simulating n Poisson or geometric variables and using prior distributions as exponential Œª ‚àº E(1) and uniform
p ‚àº U(0, 1) on the parameters of the respective models, the
exact Bayes factor is available and the distribution of the discrepancy is therefore available. Fig 1 gives the range of B12 (y)
Œ∑
Œ∑
versus B12
(y), showing that B12
(y) is then unrelated with
B12 (y): the values produced by both approaches have nothŒ∑
ing in common. As noted above, the approximation B12
(y)
based on the sufficient statistic S is producing figures of the
magnitude of a single observation, while the true Bayes factor
is of the order of the sample size.
The discrepancy between both Bayes factors is in fact increasing with the sample size, as shown by the following result:
Lemma 1. Consider model selection between model 1: P(Œª)
with prior distribution œÄ1 (Œª) equal to an exponential E(1) distribution and model 2: G(p) with a uniform prior distribution
œÄ2 when the observed data y consists of iid
Pobservations with
expectation E[yi ] = Œ∏0 > 0. Then S(y) = n
i=1 yi is the minimal sufficient statistic for both models and the Bayes factor
Œ∑
based on the sufficient statistic S(y), B12
(y), satisfies
Œ∑
lim B12
(y) = Œ∏0‚àí1 (Œ∏0 + 1)2 e‚àíŒ∏0

n‚Üí‚àû

a.s.

Therefore, the Bayes factor based on the statistic S(y) is
not consistent; it converges to a non-zero, finite value.
In this specific
setting, Didelot et al. (2011) show that
Q
adding P = i yi ! to the S creates a statistic (S, P ) that is
sufficient across both models. While this is mathematically
correct, it does not provide further understanding of the behaviour of ABC-model choice in realistic settings: outside formal examples as the one above and well-structured if complex
exponential families like Gibbs random fields, it is not possible to devise completion mechanisms that ensure sufficiency
across models, or even select well-discriminating statistics. It
is therefore more fruitful to study and detect the diverging
behaviour of the ABC approximation as given, rather than
attempting at solving the problem in a specific and formal
case.

Fig. 1.

Comparison between the true log-Bayes factor (first axis) for the comparison of a Poisson model versus a P
negative binomial model and of the log-Bayes
factor based on the sufficient statistic
i yi (second axis), for Poisson (left) and
negative binomial (left) samples of size n = 50, based on T = 104 replications
4

www.pnas.org/cgi/doi/10.1073/pnas.xxx

Population genetics. We recall that ABC has first been introduced by population geneticists (Beaumont et al., 2002;
Pritchard et al., 1999) for statistical inference about the evolutionary history of species, because no likelihood-based approach existed apart from very simple and hence unrealistic
Footline Author

probabilities of evolutionary scenarios, we designed two experiments based on simulated data with limited information
content, so that the choice between scenarios is problematic.
This setting thus provides a wide enough set of intermediate
values of model posterior probabilities, in order to better evaluate the divergence between ABC and likelihood estimates.
In the first experiment, we consider two populations (1
and 2) having diverged at a fixed time in the past and a third
population (3) having diverged from one of those two populations (scenarios 1 and 2 respectively). Times are set to 60
generations for the first divergence and to 30 generations for
the second divergence. One hundred pseudo observed datasets
have been simulated, represented by 15 diploid individuals per
population genotyped at five independent microsatellite loci.
These loci are assumed to evolve according to the strict Stepwise Mutation model (SMM), i.e. when a mutation occurs, the
number of repeats of the mutated gene increases or decreases

1.0

situations. This approach has since been used in an increasing
number of biological studies (Estoup et al., 2004; Estoup and
Clegg, 2003; Fagundes et al., 2007), most of them including
model choice. It is therefore crucial to get insights in the validity of such studies, particularly when they deal with species of
economical or ecological importance (see, e.g., Lombaert et al.,
2010). To this end, we need to compare ABC estimates of
posterior probabilities to reliable likelihood-based estimates.
Combining different modules based on Stephens and Donnelly
(2000), it is possible to approximate the likelihood of population genetic data through importance sampling (IS) even
in complex scenarios. In order to evaluate the potential discrepancy between ABC-based and likelihood-based posterior

‚óè ‚óè
‚óè‚óè‚óè
‚óè
‚óè
‚óè ‚óè
‚óè
‚óè ‚óè
‚óè
‚óè‚óè
‚óè ‚óè ‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè ‚óè
‚óè ‚óè
‚óè ‚óè ‚óè‚óè ‚óè
‚óè
‚óè ‚óè ‚óè
‚óè ‚óè
‚óè‚óè
‚óè‚óè
‚óè ‚óè‚óè
‚óè
‚óè ‚óè
‚óè
‚óè ‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè ‚óè
‚óè ‚óè
‚óè ‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè ‚óè
‚óè

0.6

‚óè
‚óè

‚óè
‚óè‚óè

‚óè‚óè

0.4

‚óè

‚óè

‚óè ‚óè

‚óè

0.9

‚óè

‚óè

‚óè

‚óè

‚óè
‚óè
‚óè

0.2

ABC estimates of P(M=1|y)

0.8

‚óè

‚óè

‚óè

‚óè

‚óè

0.0

0.8

‚óè

0.2

0.4

0.6

0.8

1.0

0.7

0.0

Importance Sampling estimates of P(M=1|y)

0.5

Comparison of IS and ABC estimates of the posterior probability of scenario
1 in the first population genetic experiment, using 24 summary statistics

0.6

Fig. 2.

1.0

‚óè

0.8

‚óè
‚óè
‚óè

‚óè

0.6

‚óè

‚óè ‚óè

‚óè

‚óè

1

‚óè

‚óè‚óè

5

Fig. 5.

Boxplots of the posterior probabilities evaluated over 10 independent
Monte Carlo evaluations, for five independent simulated datasets in the first population genetic experiment

‚óè

‚óè
‚óè
‚óè
‚óè

4

‚óè

‚óè
‚óè

3

‚óè
‚óè

‚óè

‚óè

‚óè

2

‚óè

‚óè

‚óè

‚óè
‚óè

‚óè‚óè

‚óè

‚óè ‚óè

‚óè
‚óè‚óè

0.4

ABC estimates of P(M=1|y)

‚óè

‚óè
‚óè

‚óè
‚óè
‚óè
‚óè ‚óè
‚óè

‚óè
‚óè

‚óè

‚óè‚óè

‚óè

0.4

‚óè

‚óè

‚óè
‚óè‚óè
‚óè‚óè
‚óè‚óè ‚óè
‚óè
‚óè
‚óè‚óè‚óè‚óè‚óè
‚óè
‚óè ‚óè
‚óè ‚óè‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè

‚óè

‚óè
‚óè

0.2

‚óè

‚óè

‚óè

‚óè

‚óè

‚óè
‚óè

‚óè

0.0

0.2

0.4

0.6

0.8

1.0

Importance Sampling estimates of P(M=1|y)

Same caption as Fig 2 when using 15 summary statistics

1.0

0.7

0.8

Fig. 3.

0.9

0.0

‚óè

‚óè

‚óè
‚óè
‚óè

‚óè

‚óè

‚óè

‚óè
‚óè ‚óè‚óè
‚óè
‚óè
‚óè
‚óè

‚óè

0.4

‚óè

‚óè

‚óè

‚óè

‚óè‚óè

‚óè‚óè

‚óè

‚óè

‚óè
‚óè

‚óè
‚óè
‚óè

‚óè
‚óè

‚óè

‚óè ‚óè

‚óè

‚óè

‚óè
‚óè

‚óè

‚óè
‚óè

‚óè
‚óè

‚óè‚óè

‚óè

‚óè

‚óè
‚óè

‚óè
‚óè
‚óè
‚óè

‚óè

0.2

‚óè
‚óè
‚óè

‚óè

‚óè

‚óè

‚óè

0.4

0.6

‚óè

‚óè
‚óè
‚óè

0.6

‚óè
‚óè
‚óè‚óè

‚óè‚óè

‚óè

‚óè‚óè
‚óè

‚óè‚óè‚óè

0.5

0.8

‚óè
‚óè

ABC estimates of P(M=1|y)

‚óè‚óè

‚óè‚óè
‚óè

‚óè

‚óè

‚óè

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚óè
‚óè

‚óè

‚óè

0.0

1
0.0

0.2

0.4

0.6

0.8

Comparison of IS and ABC estimates of the posterior probability of scenario
1 in the second population genetic experiment
Footline Author

2

3

4

5

1.0

Importance Sampling estimates of P(M=1|y)

Fig. 4.

‚óè

Fig. 6.

Boxplots of the posterior probabilities evaluated over 10 independent
Monte Carlo evaluations, for five independent simulated datasets in the second population genetic experiment
PNAS

Issue Date

Volume

Issue Number

5

Tab. S1 Summary statistics used in the population genetic experiments, the Subset column corresponding to the ABC operated with
15 summary statistics and the last three statistics being only used in this reduced collection

Name

Subset

Definition

NAL1
NAL2
NAL3
HET1
HET2
HET3
VAR1
VAR2
VAR3
MGW1
MGW2
MGW3
FST1
FST2
FST3
LIK12
LIK13
LIK21
LIK23
LIK31
LIK32
DAS12
DAS13
DAS23
DM212
DM213
DM223

yes
yes
yes
yes
yes
yes
yes
yes
yes
no
no
no
no
no
no
no
no
no
no
no
no
yes
yes
yes
yes
yes
yes

average number of alleles in population 1
average number of alleles in population 2
average number of alleles in population 3
average heterozygothy n population 1
average heterozygothy n population 2
average heterozygothy n population 3
average variance of the allele size in population 1
average variance of the allele size in population 2
average variance of the allele size in population 3
Garza-Williamson M in population 1
Garza-Williamson M in population 2
Garza-Williamson M in population 3
average FST in population 1
average FST in population 2
average FST in population 3
probability that sample 1 is from population 1
probability that sample 1 is from population 3
probability that sample 2 is from population 1
probability that sample 2 is from population 3
probability that sample 3 is from population 1
probability that sample 3 is from population 2
shared allele distance between populations 1 and 2
shared allele distance between populations 1 and 3
shared allele distance between populations 2 and 3
distance (Œ¥¬µ)2 between populations 1 and 2
distance (Œ¥¬µ)2 between populations 1 and 3
distance (Œ¥¬µ)2 between populations 2 and 2

1.0

‚óè

‚óè

‚óè ‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè‚óè
‚óè
‚óè‚óè‚óè
‚óè ‚óè‚óè‚óè‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè ‚óè‚óè ‚óè‚óè
‚óè‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè ‚óè
‚óè

0.8

‚óè

‚óè
‚óè

0.2

0.4

0.6

‚óè ‚óè

0.0

Importance Sampling estimates of P(M=1|y) with 50,000 particles

by one unit with equal probability. The mutation rate, common to all five loci, has been set to 0.005 and effective population sizes to 30. In this experiment, both scenarios have
a single parameter: the effective population size, assumed to
be identical for all three populations. We chose a uniform
prior U [2, 150] for this parameter (the true value being 30).
The IS algorithm was performed using 100 coalescent trees per
particle. The marginal likelihood of both scenarios has been
computed for the same set of 1000 particles and they provide
the posterior probability of each scenario. The ABC computations have been performed with DIYABC (Cornuet et al.,
2008). A reference table of 2 million datasets has been simulated using 24 usual summary statistics (provided in Table
S1) and the posterior probability of each scenario has been
estimated as their proportion in the 500 simulated datasets
closest to the pseudo observed one. This population genetic

0.0

0.2

0.4

0.6

0.8

1.0

ABC estimates of P(M=1|y)

Fig. 7. Comparison between two approximations of the posterior probabilities
of scenario 1 based on importance sampling with 50,000 particles (first axis) and
ABC (second axis) for the larger population genetic experiment
6

www.pnas.org/cgi/doi/10.1073/pnas.xxx

setting does not allow for a choice of sufficient statistics, even
at the model level.
The second experiment also opposes two scenarios including three populations, two of them having diverged 100 generations ago and the third one resulting of a recent admixture
between the first two populations (scenario 1) or simply diverging from population 1 (scenario 2) at the same time of 5
generations in the past. In scenario 1, the admixture rate is
0.7 from population 1. Pseudo observed datasets (100) of the
same size as in experiment 1 (15 diploid individuals per population, 5 independent microsatellite loci) have been generated
for an effective population size of 1000 and mutation rates
of 0.0005. In contrast with experiment 1, analyses included
the following 6 parameters (provided with corresponding priors): admixture rate (U [0.1, 0.9]), three effective population
sizes (U [200, 2000]), the time of admixture/second divergence
(U [1, 10]) and the time of the first divergence (U [50, 500]). To
account for an higher complexity in the scenarios, the IS algorithm was performed with 10,000 coalescent trees per particle.
Apart from this change, both ABC and likelihood analyses
have been performed in the same way as experiment 1.
Fig 2 shows a reasonable fit between the exact posterior
probability of model 1 (evaluated by IS) and the ABC approximation in the first experiment on most of the 100 simulated
datasets, even though the ABC approximation is biased towards 0.5. When using 0.5 as the decision boundary between
model 1 and model 2, there is hardly any discrepancy between
both approaches, demonstrating that model choice based on
ABC can be trusted in this case. Fig 3 considers the same setting when moving from 24 to 15 summary statistics (given in
Table S1): the fit somehow degrades. In particular, the number of opposite conclusions in the model choice moves to 12%.
In the more complex setting of the second experiment, the discrepancy worsens, as shown on Fig 4. The number of opposite
conclusions reaches 26% and the fit between both versions of
the posterior probabilities is considerably degraded, with a
correlation coefficient of 0.643.
Footline Author

The validity of the importance sampling approximation
can obviously be questioned in both experiments, however
Fig 5 and Fig 6 display a strong stability of the posterior
probability IS approximation across 10 independent runs for
5 different datasets and gives proper confidence in this approach. Increasing the number of loci to 50 and the sample
size to 100 individuals per population (see SI) leads to posterior probabilities of the true scenario overwhelmingly close
to one (Fig 7), thus bluring the distinction between ABC and
likelihood based estimates but also reassuring on the ability
of ABC to provide the right choice of model with a higher
information content of the data. Actually, we note that, for
this experiment, all ABC-based decisions conclude in favour
of the correct model.

Discussion
Since its introduction by TavareÃÅ et al. (1997) and Pritchard
et al. (1999), ABC has been extensively used in several areas
involving complex likelihoods, primarily in population genetics, both for point estimation and testing of hypotheses. In
realistic settings, with the exception of Gibbs random fields,
which satisfy a resilience property with respect to their sufficient statistics, the conclusions drawn on model comparison
cannot be trusted per se but require further simulations analyses as to the pertinence of the (ABC) Bayes factor based
on the summary statistics. This paper has examined in details only the case when the summary statistics are sufficient
for both models, while practical situations imply the use of
insufficient statistics. The rapidly increasing number of applications estimating posterior probabilities by ABC indicates a
clear need for further evaluations of the worth of those estimations.
Further research is needed for producing trustworthy approximations to the posterior probabilities of models. At this
stage, unless the whole data is involved in the ABC approximation as in Sousa et al. (2009), our conclusion on ABCbased model choice is to exploit the approximations in an
exploratory manner as measures of discrepancies rather than
genuine posterior probabilities. This direction relates with
the analyses found in Ratmann et al. (2009). Furthermore,
a version of this exploratory analysis is already provided in
the DIY-ABC software of (Cornuet et al., 2008). An option
in this software allows for the computation of a Monte Carlo
evaluation of false allocation rates resulting from using the
ABC posterior probabilities in selecting a model as the most
likely. For instance, in the setting of both our population genetic experiments, DIY-ABC gives false allocation rates equal
to 20% (under scenarios 1 and 2) and 14.5% and 12.5% (under scenarios 1 and 2), respectively. This evaluation obviously
shifts away from the performances of ABC as an approximation to the posterior probability towards the performances of
the whole Bayesian apparatus for selecting a model, but this
nonetheless represents a useful and manageable quality assessment for practitioners.
ACKNOWLEDGMENTS. The first three authors‚Äô work has been partly supported
by Agence Nationale de la Recherche via the 2009‚Äì2013 project EMILE. They are
grateful to the reviewers and to Michael Stumpf for their comments. Computations
were performed on the INRA CBGP and MIGALE clusters.

References
Beaumont, M. (2010). Approximate Bayesian computation in evolution and ecology. Annual Review of Ecology, Evolution, and
Systematics, 41 379‚Äì406.
Footline Author

Beaumont, M., Nielsen, R., Robert, C., Hey, J., Gaggiotti,
O., Knowles, L., Estoup, A., Mahesh, P., Coranders, J.,
Hickerson, M., Sisson, S., Fagundes, N., Chikhi, L., Beerli,
P., Vitalis, R., Cornuet, J.-M., Huelsenbeck, J., Foll, M.,
Yang, Z., Rousset, F., Balding, D. and Excoffier, L. (2010).
In defense of model-based inference in phylogeography. Molecular Ecology, 19(3) 436‚Äì446.
Beaumont, M., Zhang, W. and Balding, D. (2002). Approximate Bayesian computation in population genetics. Genetics,
162 2025‚Äì2035.
Belle, E., Benazzo, A., Ghirotto, S., Colonna, V. and Barbujani, G. (2008). Comparing models on the genealogical relationships among Neandertal, Cro-Magnoid and modern Europeans
by serial coalescent simulations. Heredity, 102 218‚Äì225.
Berger, J., Fienberg, S., Raftery, A. and Robert, C. (2010).
Incoherent phylogeographic inference. Proc. Nat. Acad. Sci.
USA, 107 E57.
Bernardo, J. and Smith, A. (1994). Bayesian Theory. John Wiley, New York.
Cornuet, J.-M., RavigneÃÅ, V. and Estoup, A. (2010). Inference
on population history and model checking using DNA sequence
and microsatellite data with the software DIYABC (v1.0). BMC
Bioinformatics, 11 401.
Cornuet, J.-M., Santos, F., Beaumont, M. A., Robert, C. P.,
Marin, J.-M., Balding, D. J., Guillemaud, T. and Estoup,
A. (2008). Inferring population history with DIYABC: a userfriendly approach to Approximate Bayesian Computation. Bioinformatics, 24 2713‚Äì2719.
CsilleÃÄry, K., Blum, M., Gaggiotti, O. and FrancÃßois, O.
(2010a). Approximate Bayesian computation (ABC) in practice.
Trends in Ecology and Evolution, 25 410‚Äì418.
CsilleÃÄry, K., Blum, M., Gaggiotti, O. and FrancÃßois, O.
(2010b). Invalid arguments against ABC: A reply to A.R. Templeton. Trends in Ecology and Evolution, 25 490‚Äì491.
Dean, T., Singh, S., Jasra, A. and Peters, G. (2011). Parameter estimation for hidden markov models with intractable likelihoods. Tech. rep.
Didelot, X., Everitt, R., Johansen, A. and Lawson, D. (2011).
Likelihood-free estimation of model evidence. Bayesian Analysis,
6 1‚Äì28.
Estoup, A., Beaumont, M., Sennedot, F., Moritz, C. and Cornuet, J. (2004). Genetic analysis of complex demographic scenarios: spatially expanding populations of the cane toad, Bufo
Marinus. Evolution, 58 2021‚Äì2036.
Estoup, A. and Clegg, S. (2003). Bayesian inferences on the recent island colonization history by the bird Zosterops lateralis
lateralis. Mol. Ecol., 12 657‚Äì674.
Excoffier, C., Leuenberger, D. and Wegmann, L. (2009).
Bayesian computation and model selection in population genetics. ArXiv:0901.2231.
Fagundes, N., Ray, N., Beaumont, M., Neuenschwander, S.,
Salzano, F., Bonatto, S. and Excoffier, L. (2007). Statistical evaluation of alternative models of human evolution. Proc.
Nat. Acad. Sci. USA, 104 17614‚Äì17619.
Fearnhead, P. and Prangle, D. (2010). Semi-automatic approximate Bayesian computation. ArXiv:1004.1112.
Ghirotto, S., Mona, S., Benazzo, A., Paparazzo, F.,
Caramelli, D. and Barbujani, G. (2010). Inferring genealogical
processes from patterns of bronze-age and modern DNA variation in Sardinia. Mol. Biol. Evol., 27 875‚Äì886.
Grelaud, A., Marin, J.-M., Robert, C., Rodolphe, F. and
Tally, F. (2009). Likelihood-free methods for model choice in
Gibbs random fields. Bayesian Analysis, 3(2) 427‚Äì442.
Guillemaud, T., Beaumont, M., Ciosi, M., Cornuet, J.-M. and
Estoup, A. (2009). Inferring introduction routes of invasive
species using approximate Bayesian computation on microsatellite data. Heredity, 104 88‚Äì99.
Jeffreys, H. (1939). Theory of Probability. 1st ed. The Clarendon
Press, Oxford.
Joyce, P. and Marjoram, P. (2008). Approximately sufficient
statistics and Bayesian computation. Statistical Applications in
Genetics and Molecular Biology, 7 article 26.
Lehmann, E. and Casella, G. (1998). Theory of Point Estimation
(revised edition). Springer-Verlag, New York.

PNAS

Issue Date

Volume

Issue Number

7

Leuenberger, C. and Wegmann, D. (2010). Bayesian computation and model selection without likelihoods. Genetics, 184
243‚Äì252.
Lombaert, E., Guillemaud, T., Cornuet, J.-M., Malausa, T.,
Facon, B. and Estoup, A. (2010). Bridgehead effect in the
worldwide invasion of the biocontrol Harlequin Ladybird. PloS
ONE, 5 e9743.
Lopes, J. and Beaumont, M. (2010). ABC: a useful Bayesian
tool for the analysis of population data. Infection, Genetics and
Evolution, 10 825‚Äì832.
Lopes, J. S., Balding, D. and Beaumont, M. A. (2009). PopABC:
a program to infer historical demographic parameters. Bioinformatics, 25 2747‚Äì2749.
Marin, J., Pudlo, P., Robert, C. and Ryder, R. (2011). Approximate Bayesian computational methods. ArXiv:1011:0955.
Miller, N., Estoup, A., Toepfer, S., Bourguet, D., Lapchin,
L., Derridj, S., Kim, K. S., Reynaud, P., Furlan, L. and
Guillemaud, T. (2005). Multiple transatlantic introductions of
the Western corn rootworm. Science, 310 992.
Nunes, M. A. and Balding, D. J. (2010). On optimal selection of
summary statistics for approximate bayesian computation. Statistical Applications in Genetics and Molecular Biology, 9 34.
Pascual, M., Chapuis, M., BalanyaÃÄ, J., Huey, R., Gilchrist,
G., Serra, L. and Estoup, A. (2007). Introduction history of
Drosophila subobscura in the New World: a microsatellite-based
survey using ABC methods. Molecular Ecology, 16 3069‚Äì3083.
Patin, E., Laval, G., Barreiro, L., Salas, A., Semino, O.,
Santachiara-Benerecetti, S., Kidd, K., Kidd, J., Van
Der Veen, L., Hombert, J. et al. (2009). Inferring the demographic history of African farmers and pygmy hunter-gatherers
using a multilocus resequencing data set. PLoS Genetics, 5
e1000448.
Pritchard, J., Seielstad, M., Perez-Lezaun, A. and Feldman,
M. (1999). Population growth of human Y chromosomes: a study
of Y chromosome microsatellites. Molecular Biology and Evolution, 16 1791‚Äì1798.
Ramakrishnan, U. and Hadly, E. (2009). Using phylochronology
to reveal cryptic population histories: review and synthesis of 29
ancient DNA studies. Molecular Ecology, 18 1310‚Äì1330.
Ratmann, O., Andrieu, C., Wiujf, C. and Richardson, S.
(2009). Model criticism based on likelihood-free inference, with
an application to protein network evolution. Proc. Nat. Acad.
Sci. USA, 106 1‚Äì6.
Robert, C. and Casella, G. (2004). Monte Carlo Statistical Methods. 2nd ed. Springer-Verlag, New York.
Sainudiin, R., Thornton, K., Harlow, J., Booth, J., Stillman, M., Yoshida, R., Griffiths, R., McVean, G. and Donnelly, P. (2011). Experiments with the site frequency spectrum. Bulletin of Mathematical Biology. (To appear.), URL
http://www.isibang.ac.in/~statmath/eprints/2010/8.pdf.
Sousa, V., Fritz, M., Beaumont, M. and Chikhi, L. (2009).
Approximate Bayesian computation without summary statistics:
the case of admixture. Genetics, 181 1507‚Äì1519.
Stephens, D. and Donnelly, P. (2000). Inference in population
genetics (with discussion). J. Royal Statist. Society Series B, 62
602‚Äì655.
TavareÃÅ, S., Balding, D., Griffith, R. and Donnelly, P. (1997).
Inferring coalescence times from DNA sequence data. Genetics,
145 505‚Äì518.
Templeton, A. (2008). Statistical hypothesis testing in intraspecific phylogeography: nested clade phylogeographical analysis vs.
approximate Bayesian computation. Molecular Ecology, 18(2)
319‚Äì331.
Templeton, A. (2010). Coherent and incoherent inference in phylogeography and human evolution. Proc. Nat. Acad. Sci. USA,
107(14) 6376‚Äì6381.
Toni, T. and Stumpf, M. (2010). Simulation-based model selection for dynamical systems in systems and population biology.
Bioinformatics, 26 104‚Äì110.
Toni, T., Welch, D., Strelkowa, N., Ipsen, A. and Stumpf, M.
(2009). Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems. Journal
of the Royal Society Interface, 6 187‚Äì202.

8

www.pnas.org/cgi/doi/10.1073/pnas.xxx

Verdu, P., Austerlitz, F., Estoup, A., Vitalis, R., Georges,
M., TheÃÅry, S., Froment, A., Le Bomin, S., Gessain, A.,
Hombert, J.-M., Van der Veen, L., Quintana-Murci, L.,
Bahuchet, S. and Heyer, E. (2009). Origins and genetic diversity of pygmy hunter-gatherers from western central africa.
Current Biology, 19 312‚Äì318.
Wegmann, D. and Excoffier, L. (2010). Bayesian inference of
the demographic history of chimpanzees. Molecular Biology and
Evolution, 27 1425‚Äì1435.
Wegmann, D., Leuenberger, C., Neuenschwander, S. and Excoffier, L. (2011). ABCtoolbox: a versatile toolkit for approximate Bayesian computations. BMC Bioinformatics. To appear.
Wilkinson, R. D. (2008). Approximate Bayesian computation
(ABC) gives exact results under the assumption of model error.
ArXiv:0811.3355.

Appendix:

SI Results

A normal illustration. The following reproduces the Poisson
geometric illustration in a normal model. If we look at a fully
normal N (¬µ, œÉ 2 ) setting, we have
)
(
n
X
(yi ‚àí yÃÑ)2 /2 œÉ ‚àín
f (y|¬µ) ‚àù exp ‚àínœÉ ‚àí2 (yÃÑ ‚àí ¬µ)2 /2 ‚àí œÉ ‚àí2
i=1

hence
(
f (y|yÃÑ) ‚àù exp ‚àíœÉ ‚àí2

)
n
X
(yi ‚àí yÃÑ)2 /2 œÉ ‚àín IP yi =nyÃÑ .
i=1

If we reparameterise the observations into u = (y1 ‚àí
yÃÑ, . . . , yn‚àí1 ‚àí yÃÑ, yÃÑ), we do get

	
f (u|¬µ) ‚àù œÉ ‚àín exp ‚àínœÉ ‚àí2 (yÃÑ ‚àí ¬µ)2 /2
Ô£±
"n‚àí1 #2 Ô£º
n‚àí1
Ô£≤
X 2
X
 Ô£Ω
‚àí2
‚àí2
2
√ó exp ‚àíœÉ
ui /2 ‚àí œÉ
ui
Ô£æ
Ô£≥
i=1

i=1

since the Jacobian is 1. Hence
Ô£±
"n‚àí1 #2 Ô£º
n‚àí1
Ô£Ω
Ô£≤
X
X
u2i /2 ‚àí œÉ ‚àí2
ui /2 œÉ ‚àín
f (u|yÃÑ) ‚àù exp ‚àíœÉ ‚àí2
Ô£æ
Ô£≥
i=1

i=1

Fig. 8. Empirical distributions of the log discrepancy log g1 (y)/g2 (y) for
datasets of size n = 15 simulated from N (¬µ, œÉ12 ) (left) and N (¬µ, œÉ22 ) (right)
distributions when œÉ1 = 0.1 and œÉ2 = 10, based on 104 replications and a flat
prior
Footline Author

Considering both models
iid

y1 , . . . , yn ‚àº N (¬µ, œÉ12 )

and

iid

y1 , . . . , yn ‚àº N (¬µ, œÉ22 ) ,

the discrepancy ratio is then given by
Ô£±
Ô£´
"n‚àí1
#2 Ô£∂Ô£º
Ô£≤ œÉ ‚àí2 ‚àí œÉ ‚àí2 n‚àí1
Ô£Ω
X
X
œÉ2n‚àí1
2
2
1
Ô£≠
Ô£∏
exp
(y
‚àí
yÃÑ)
+
(y
‚àí
yÃÑ)
i
i
Ô£≥
Ô£æ
2
œÉ1n‚àí1
i=1
i=1
and is connected with the lack of consistency of the Bayes
factor:
Lemma 2. Consider model selection between model 1: N (¬µ, œÉ12 )
and model 2: N (¬µ, œÉ22 ), œÉ1 and œÉ2 being given, with prior distributions œÄ1 (¬µ) = œÄ2 (¬µ) equal to a N (0, a2 ) distribution and
when the observed data y consists of iid
P observations with finite mean and variance. Then S(y) = n
i=1 yi is the minimal
sufficient statistic for both models and the Bayes factor based
Œ∑
on the sufficient statistic S(y), B12
(y), satisfies
Œ∑
lim B12
(y) = 1

n‚Üí‚àû

a.s.

Fig 8 illustrates the behaviour of the discrepancy ratio
when œÉ1 = 0.1 and œÉ2 = 10, for datasets of size n = 15 simulated according to both models. The discrepancy (expressed
on a log scale) is once again dramatic, in concordance with
the above lemma.
If we now turn to an alternative choice of sufficient statistic, using the pair (yÃÑ, S 2 ) with
S2 =

n
X
(yi ‚àí yÃÑ)2 ,

we follow the solution of Didelot et al. (2011). Using a conjugate prior ¬µ ‚àº N (0, a2 ), the true Bayes factor is equal to the
Bayes factor based on the corresponding distributions of the
pair (yÃÑ, S 2 ) in the respective models. Therefore, with sufficient computing power, the ABC approximation to the Bayes
factor can be brought arbitrarily close to the true Bayes factor. However, this coincidence does not bring any intuition on
the behaviour of the ABC approximations in realistic settings.

Larger experiment. We also considered a more informative
population genetic experiment with the same scenarios (1 and
2) as in the second experiment. One hundred datasets were
simulated under scenario 1 with 3 populations, i.e. 6 parameters. We take 100 diploid individuals per population, 50 loci
per individual. This thus corresponds to 300 genotypes per
dataset. The IS algorithm was performed using 100 coalescent
trees per particle. The marginal likelihood of both scenarios
has been computed for the same set for both 1000 particles
(IS1) and 50,000 particles (IS2). A national cluster of 376
processors (including 336 Quad Core processors) was used for
this massive experiment (which required more than 12 calendar days for the importance sampling part).
The confidence about the IS approximation can be assessed on Fig 7, which shows that both runs most always provide the same numerical value, which almost uniformly is very
close to one. This makes the fit of the ABC approximation
to the true value harder to assess, even though we can spot
a trend towards under-estimation. Furthermore, they almost
all lead to correctly select model 1.

i=1

Footline Author

PNAS

Issue Date

Volume

Issue Number

9

