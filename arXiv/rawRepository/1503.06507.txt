Pitch Perfect: How Fruit Flies Control their Body Pitch Angle
Samuel C. Whitehead1∗ , Tsevi Beatus1∗ , Luca Canale2 , and Itai Cohen1

arXiv:1503.06507v1 [physics.bio-ph] 23 Mar 2015

1
Department of Physics, Cornell University, Ithaca,
New York 14853, USA; 2 Département de Mécanique,
École Polytechnique 911128, Palaiseau, France.
∗
Equal contributors
(Dated: March 30, 2015)

Flapping insect flight is a complex and beautiful phenomenon that relies on fast, active control mechanisms to counter aerodynamic instability. To directly investigate how freely-flying D.
melanogaster control their body pitch angle against such instability, we perturb them using impulsive mechanical torques and film their corrective maneuvers with high-speed video. Combining
experimental observations and numerical simulation, we find that flies correct for pitch deflections
of up to 40◦ in 29 ± 8 ms by bilaterally modulating their wings’ front-most stroke angle in a manner
well-described by a linear proportional-integral (PI) controller. Flies initiate this corrective process
after only 10 ± 2 ms, indicating that pitch stabilization involves a fast reflex response. Remarkably,
flies can also correct for very large-amplitude pitch perturbations–greater than 150◦ –providing a
regime in which to probe the limits of the linear-response framework. Together with previous studies regarding yaw and roll control, our results on pitch show that flies’ stabilization of each of these
body angles is consistent with PI control.
I.

Introduction

From walking humans to flying insects, many fascinating forms of bio-locomotion are contingent upon robust
stabilization control. Implementing this control is particularly difficult in the case of small, flapping-wing insects, since flapping flight is inherently subject to rapidlydivergent aerodynamic instabilities [1–13]. As such, flying insects have evolved stabilization techniques relying
on reflexes that are among the fastest in the animal kingdom [14] and robust to the complex environment that
insects must navigate [15–19].
In particular, pitching instability is a prominent obstacle for flight control in flapping insects. Analytical and
numerical modeling suggest that, for many two-winged
insects (e.g. flies), periodic flapping couples with longitudinal body motion to produce rapidly-growing oscillations of the body pitch angle [4, 11, 13, 20]. This oscillatory instability can be understood as the result of differential drag on the wings due to longitudinal body motion
[4, 11]. For example, if a fly pitches down while hovering,
its re-directed lift propels its body forward, causing an
increased drag on the wings during the forward stroke
relative to the backward stroke. Because dipteran wings
are attached to their bodies above the center of mass,
this drag asymmetry generates a torque that pitches the
fly up. Rather than acting as a restoring torque, the
drag–together with the body inertia–pitches the fly up,
beyond its initial pitch orientation. The fly then begins
to move backwards, and oscillation ensues in the opposite direction. This mechanism results in an undulating
instability of the body pitch angle, which doubles over a
timescale of ∼ 9 wing-beats [13]. Mitigating the effects of
this instability requires flies to actively adjust their wing
motion on time scales faster than the growth of these
oscillations.
Our work builds upon an already rich corpus of litera-

ture on insect flight control, a sizable portion of which
addresses the pitch degree of freedom. Experimental
studies subjecting tethered insects to both mechanical
pitching perturbations and visual pitching stimuli [1, 21–
25] have elucidated stereotyped kinematic responses for
pitch correction, including manipulation of wing stroke
angle, stroke plane orientation, wing-beat frequency, and
body configuration. However, tethered insects do not
constitute a closed-loop feedback system, since changes
to their wing kinematics do not affect their body orientations. Moreover, in the case of tethered flies, it has been
shown that the wing kinematics are qualitatively different
than those in free-flight [26, 27]. Thus, free-flight studies are necessary for a comprehensive understanding of
pitch control. Significant analysis has been performed on
freely-flying insects executing voluntary maneuvers [28–
30] or responding to visual stimuli [31–33], but the general challenge of systematically inducing mechanical perturbations on untethered insects has traditionally been a
barrier to the study of stabilization reflexes. Some notable exceptions to this include methods of mechanical
perturbation using air-flow vortices [15, 17, 18] or gusts
of wind [19]. However, such fluid-impulse methods are
difficult to tune, and are thus not ideal for of inducing
the fast, precise mechanical perturbations that are required for a quantitative understanding of pitch control.
To achieve the necessary speed and precision for measurements of body pitch control, we use a perturbation
scheme that has previously been applied to analyzing
control of the yaw [34] and roll [14] degrees of freedom.
We mechanically perturb free-flying D. melanogaster by
gluing small magnetic pins to their dorsal thoracic surfaces and applying short bursts (5-8 ms) of a vertical
magnetic field that pitches their bodies up or down. As
the flies correct their orientation, we measure their body
and wing kinematics using high-speed video (Figure 1a).
We recorded perturbation events with amplitudes typ-

2

II.
A.

Methods

Fly Preparation

We perform each experiment using common fruit flies
(Drosophila melanogaster, females) from an out-bred laboratory stock. Individual flies are anesthetized at 0-4◦ C,
at which point we carefully glue 1.5-2 mm long, 0.15 mm
diameter ferromagnetic pins to their notum (dorsal thoracic surface), oriented so that the pin lies in the flies’
sagittal plane. The pin is shown in Figure 1a (falsecolored blue) and Figure 2 (images). Control experiments
with untreated flies show that the addition of the pin does
not qualitatively alter flies’ flight kinematics. When attached, the pins add ∼20% to the mass and pitch moment of inertia of the fly, which falls within the range of
their natural body mass variations. Moreover, the pin
contributes negligibly to off-diagonal components of the
flies’ inertia tensors, and therefore does not introduce
any coupling between the rotational degrees of freedom
of the body. The primary effect of the added pin mass
is a dorsal shift of ∼0.2 mm in the flies’ center of mass,
which must be accounted for during calculations of aerodynamic torque.

d)
xb

roll000
xlab

c)

zlab

yaw000

ylab
pitch000

zb
xb
yb

Stroke0Angle

Magnetic0
Pulse

Body0Pitch0
Angle,00000[deg]

b)

e)

Body0Yaw0
Angle,00000[deg]

To generate corrective pitching torques, flies bilaterally modulate their wings’ front-most stroke angle, i.e.
they flap their wings more or less in the front to pitch
up or down, respectively. This corrective mechanism is
in general agreement with previous findings on active
body pitch stabilization in fruit flies [20, 21, 23, 36]. We
show that flies’ modulation of front stroke angle is wellmodeled by a linear, continuous, proportional-integral
(PI) controller with a time delay, ∆T = 6 ± 1.7 ms
(mean ± standard deviation). Our results indicate that
pitch control in fruit flies is an extremely fast and robust process, which can be accurately modeled by a simple controller for a wide range of perturbation amplitudes. Moreover, we find that flies are capable of correcting for pitch deflections of 150◦ or more, a perturbation regime in which the linear controller theory begins
to break down. Together with previous results on how
flies control yaw [34] and roll [14], the analysis of pitch
control presented here addresses a missing piece in our
understanding of how flies control each of their body angles individually.

a)

f)

Body0Roll0
Angle,00000[deg]

ically ranging 5-40◦ for both pitching up and pitching
down. For these perturbations, flies recover 90% their
pitch orientation within ∼30 ms. Moreover, we find that
the corrective process is initiated ∼2 wing-beats (∼ 10
ms) after the onset of the impulsive torque; such a short
latency time indicates that this corrective process is a reflexive behavior largely governed by input from the halteres, the flies’ rate-gyro-like mechanical sensing organs
[22, 23, 35].

80
60
40
20
20
0

-20
50
0
-50

0

20

Time0[ms]

40

FIG. 1: Pitch perturbation and correction. (a) snapshots
and a 3D model reconstruction from a representative pitch up
event at t = -25.5, 13, 56.5 ms. For the full video of this event,
see Movie S1. The middle snapshot (t = 13 ms) corresponds
to the maximum pitch up deflection. Ferromagnetic pin is
false-colored blue, the fly’s long body axis is given by the
green arrows, and the red arrow indicates the direction of the
perturbation. (b) and (c) definitions for the body and wing
Euler angle coordinates, respectively. ϕb , θb , and ρb indicate
the body Euler angles, while φw , θw , and ηw indicate wing
Euler angles; the stroke plane is shown in gray (c). Also
shown are the lab (b) and body (c) frames of reference. (d-f)
time series of body Euler angles for 18 perturbation events,
with the highlighted curves corresponding to the event from
(a). The yellow bar in (d-f) gives the timing of the magnetic
pulse (0-5.8 ms). Body angles in (d-f) are spline-smoothed
from raw data, with body yaw in (e) shifted by its value at
t = 0.

B.

Videography and Mechanical Perturbation

Once 15-30 flies have been prepared as above, we release them into a transparent cubic filming chamber of
side length 13 cm. On the top and bottom of the chamber
are attached two horizontally-oriented Helmholtz coils,
which produce a vertical magnetic field. The central region of the chamber is filmed by three orthogonal highspeed cameras (Phantom V7.1) at 8000 frames per sec-

3
ond. The cameras are calibrated using a direct linear
transformation scheme detailed in [37, 38]. When flies
enter the filming volume, an optical trigger simultaneously signals the cameras to record and supplies a 5-8 ms
current pulse to the Helmholtz coils. We varied both the
strength and duration of the magnetic pulse produced
by the coils across experiments. Maximal field strengths
reached ∼10−2 Tesla, and most experiments were performed with a pulse that lasted 5.8 ms. The magnetic
pulse exerts a torque on the ferromagnetic pin, pitching
the fly either up or down.
Of the movies collected using the above method, we selected 18 to analyze in full; 16 additional movies were partially analyzed to collect more data on pitch correction
time and to observe correction for very large-amplitude
perturbations (∼ 150◦ ). We chose movies to fully analyze based on the criteria that i) the time window during which the fly is in the field of view for all three
cameras is sufficiently long to observe pre- and postperturbation kinematics, ii) the perturbation primarily
affects the fly’s pitch orientation, iii) the fly is not performing any maneuver other than correction, and iv) we
sample a wide range of perturbation magnitudes for both
pitching up and pitching down across our data set. To
glean kinematic data from the raw footage, we use a
custom-developed image analysis algorithm detailed in
[14, 30]. This 3D hull reconstruction algorithm provides
a kinematic description of 12 degrees of freedom for the
fly (body orientation and center of mass position, as well
as three Euler angles for each wing).
III.
A.

Results

Body and Wing Kinematics During Pitch
Correction

Representative kinematics for perturbation events are
shown in Figures 1 and 2. Figure 1b shows definitions
for the body Euler angle coordinates–yaw (ϕb ), roll (ρb ),
and pitch (θb ). Figures 1d-f show time series of these
Euler angles before and after the application of a 5.8 ms
magnetic pulse (yellow strip) for 18 perturbation events.
Before the perturbation, flies typically maintain a pitch
angle of roughly 50◦ . Perturbations deflect the pitch angle by as much as 40◦ either up or down. While the flies’
yaw and roll angles are sometimes altered by the perturbation, pitch is the most consistently and significantly
affected degree of freedom immediately following the application of the pulse (at t ≈ 6 ms). Highlighted curves in
Figures 1d-f show an event in which the fly was pitched
up by 25◦ , attaining its maximal angular deflection at 15
ms after the onset of the perturbation. By 29 ms it has
corrected for 90% of the pitch deflection. The maximum
pitch velocity due to the perturbation was 2400 ◦ /s. For
the full movie of this perturbation event, see Movie S1.
The wing kinematics for two representative perturbations, one in which the fly is pitched up by 25◦ (the

same event highlighted in Figures 1d-f) and another in
which the fly is pitched down by 23◦ , are shown in Figure 2. Wing Euler angles–stroke (φw ), pitch (ηw ), and
deviation (θw )–are defined in Figure 1c. In general, the
wing kinematics we observe following the perturbation
are left/right symmetric. Hence, these kinematics can be
attributed to pitch correction, since both yaw [34] and
roll [14] correction require left/right asymmetric wing
motion. For the pitch up event, ∼10 ms, or 2 wingbeats, after the onset of the perturbation, the minima of
the wing stroke angles shift upward for both the left and
right wing, as indicated by the orange arrows in Figure
2a. During a given wing-beat cycle, the minimum of the
stroke angle for each wing corresponds to its front-most
position. Since pitch correction is left/right symmetric,
we refer to the average of the front-most positions for
the left and right wings as the front stroke angle, φfront
.
w
By 15 ms, the fly in Figures 2a-d has increased its φfront
w
from its pre-perturbation value by ∼25◦ . Physically, this
means that the fly is significantly reducing the amplitude
of its ventral stroke, i.e. flapping less forward. The duis 3 wing-beats. We do
ration of this increase in φfront
w
not observe any shifts in the fly’s back-most stroke angle,
, during the correction maneuvers.
φback
w
Conversely, for the pitch down event in Figures 2e-h,
∼10 ms after the perturbation onset the pitched-down fly
begins to decrease its φfront
. This corresponds to the fly
w
increasing the amplitude of its ventral stroke, i.e. flapping further forward. Again, there appears to be little
to no change in the back stroke angle. Put together,
these results are consistent with previous kinematic measurements [11, 21, 23, 36] and suggest that flies modulate their front stroke angle to produce corrective pitch
to pitch themselves down, and
torques, increasing φfront
w
decreasing it to pitch themselves up.

B.

Aerodynamic Forces and Torques

Intuitively, the relationship between front stroke angle
and pitching torque can be understood as follows. To
within a good approximation, the net aerodynamic force
generated by a flapping wing is directed perpendicular to
the wing’s surface [39, 40], so that portions of the wing
stroke during which the wing is in the front half of the
stroke plane (φw ≤ 90◦ ) generate pitch up torques, while
portions in the back half (φw ≥ 90◦ ) generate pitch down
torques. During non-maneuvering flight, these torques
cancel over a wing stroke. By biasing a wing stroke so
that it spends a smaller fraction of the stroke period in
the forward position, a smaller pitch up torque is generated during that cycle, such that the net pitch torque
will be directed downward. Conversely, by increasing the
front stroke angle, and thus increasing the portion of the
stroke spent in the front position, flies can generate a
net pitch-up torque over the course of a full stroke. This
can be observed in Figures 2 (orange arrows) and 3, in
which active adjustments to front stroke angle result in

4

Pitch Up Perturbation of 25°

Pitch Down Perturbation of 23°

e)

b)

c)

d)

PitchrTorquer WingrDeviation WingrPitch
WingrStroke
rrrrr[10-9rN⋅m] Angle,rrrrrr[deg] Angle,rrrrrr[deg] Angle,rrrrrr[deg]

a)
170

back

130
90
50
front

10
180

f)

140
100
60

g)

20
40
20
0

h)

2

pitch
up

0
-2
-10

0

10

20

Timer[ms]

30

40

pitch
down

-10

0

10

20

Timer[ms]

30

40

FIG. 2: Wing kinematics and aerodynamic torques for two representative perturbation events. (a-d) correspond to a pitch
up perturbation with maximum amplitude 25◦ ; (e-h) correspond to a pitch down perturbation with maximum amplitude 23◦ .
Plotted wing kinematics as a function of time include: stroke angle (a),(e); wing pitch angle (b),(f); and deviation angle (c),(g).
Instantaneous aerodynamic torques about the flies’ pitch axis are given in (d),(f). Orange arrows in (a) and (e) highlight
corrective front strokes, with corresponding arrows in (d) and (h) highlighting the changes in pitch torque resulting from the
corrective kinematics. Images above (a) and (d) show side views of the flies (raw data) at different points during the movie,
illustrating the changes in body pitch that accompany a perturbation. White and gray bars indicate forward and back strokes
respectively; yellow bar corresponds to the perturbation duration (0 - 5.8 ms).

net corrective pitching torques over the course of individual wing-beats. Modulating the balance of two opposing
forces or torques is used by flies in other maneuvers such
as forward [41] and sideways [30] flight, as well as yaw
[34] and roll [14] maneuvers, and appears in other biolocomoting systems, such as knifefish [42].
To quantify the effect of changing the front stroke angle, we calculate the pitching torque generated by the
wings during the maneuvers shown in Figure 2 using the
full 3D fly kinematics. To calculate the aerodynamic
force generated by the wings, we used a quasi-steady
aerodynamic force model that was previously calibrated
on a mechanical, scaled-up fly model [39, 40]. This model
gives the lift (FL ) and drag (FD ) forces generated by the

wings as:
FL = 21 ρ0 SUt2 r22 CL (α)

(1)

2 2
1
2 ρ0 SUt r2 CD (α)

(2)

FD =

CL and CD are the wing’s lift and drag coefficients respectively, and are given as functions of angle of attack
(α) by [40]; S is the wing area, r22 the non-dimensional
second moment of wing area (given as 0.313 by [43]), ρ0
the density of air, and Ut the wingtip velocity. Drag is
directed anti-parallel to the wing tip velocity, and lift
is perpendicular to both drag and the wing span vector. The total aerodynamic force is the vector sum of
the lift and drag forces. While this is a simple method
for calculating forces on flapping wings, we find that it

5

v-ΔvWingvFrontv
vvStrokevAnglevv
vvvvvvvvvvvvv[deg]
ΔvBodyvPitchvAnglev
vvvvvv[deg]

b)

10

3

0

0

c)
20

6

10

3

0

0

-10

-3

-20

-6 -10

20

10

-3

d)

Time-AveragedvBodyvv
Torquevvvvvvvv[10-9vN⋅m]

a)

CorrectiveaaΔaBodyaPitchaAngle
ForaMixedaWingaKinematicsa

0

1

2

3

4

=acorrection
=apre-correction

5

6

0

10

-10
0
-10

-20
-50

0

Timev[ms]

50

-30

0

50

Timev[ms]

100

FIG. 3: Mechanism for generating corrective pitch torques.
Data in (a),(b) corresponds to the pitch up event shown
in Figures 1d-f and 2a-d, while (c),(d) correspond to the
pitch down event shown in Figures 2e-h. (a),(c) wingstroke-averaged pitch torque (black line, spline interpolated)
and negative front stroke angle deviation (orange dots) vs
time. Front stroke angle deviation is defined by ∆φfront
(t) =
w
φfront
(t) − φfront
(0). We flip the sign of ∆φfront
to illustrate
w
w
w
correlation with torque. (b),(d) body pitch angle (red line)
vs time. As in previous plots, the yellow strip in (a)-(d) corresponds to the duration of the magnetic pulse.

quantitatively captures the relevant force production for
both pre- and post-perturbation wing kinematics. We
tested the effect of adding rotational forces to the aerodynamic model [40], which should give the next largest
contribution to force, but found negligible changes to our
calculation results.
From these lift and drag forces, we calculate aerodynamic torques exerted by the wings on the body, shown
in Figures 2d,h. The moment arm for the torque is given
by the vector from the fly’s center of mass to the wing’s
center of pressure, assumed to be in the chord center,
70% along the length of the wing’s span. In Figure 2d,
during the active correction, the fly’s wings generate a
net downward pitching torque to oppose the perturbation. The main effect we observe is that, during a given
wing cycle the wings generate less upward torque, resulting in a net downward bias for the torque on the body.
This net pitch down torque is highlighted by the orange
arrows in Figure 2d. Similarly, the pitched down fly in
Figure 2h generates net upward pitching torque during
active correction, also highlighted by orange arrows. The
corrective torques for these two events are well-correlated
with the measured modulations of front stroke angle (Figure 3a,c), a trend that we observe across all perturbation
events.
Interestingly, after the flies generate a corrective torque
for 2-3 wing-beats, we also observe a few wing-beats in
which they generate net torque in the opposite direction
(Figure 2d,h and 3a,c). As with the initial corrective
torque, this subsequent counter-torque arises from modulations of the front stroke angle, evident in Figures 3a,c.
The counter-torque acts to brake the corrective pitch-

FIG. 4: The magnitude of body pitch angle change resulting
from different combinations of wing Euler angles for both a
pitch up and pitch down event. Individual points correspond
to unique combinations of pre- and post-perturbation wing
angle kinematics, which are used with our quasi-steady aerodynamic model to calculate pitching torques, which in turn
are used to estimate pitch angle deflection over a wing-stroke.
Wing kinematics φw (stroke), θw (deviation), and ηw (wing
pitch) are defined in Figure 1c. Points above the axis correspond to kinematics taken from the pitch up event in Figures
2 and 3; points below the axis correspond to kinematics taken
from the pitch down event in Figures 2 and 3.

ing motion, mitigating the overshoot in body pitch angle
caused by the initial correction response. This allows for
faster correction times, since the initial corrective maneuver can generate larger torques, and thus more quickly
return the fly to pitch angles near its original orientation.
In movies that allowed us to track the fly for long times
after the perturbation, we observe that the front stroke
angle and the net aerodynamic torque often oscillate with
decaying amplitude and a period of ∼3-4 wing-beats.
Importantly, passive damping of pitch motion contributes negligibly to the correction maneuvers we observe, since the characteristic passive decay time for pitch
velocity is & 150 ms, much longer than the entire correction maneuver [44]. Taken together, our results indicate
that pitch correction for flies is an active process involv.
ing modulation of phifront
w
C.

The Importance of Stroke Angle Relative to
Other Degrees of Freedom

To assess the effect of front stroke angle modulation
on body pitch correction, we calculate the changes to
body pitch angle generated by changes in wing kinematics. We isolate the corrective effect of each wing kinematic variable by first identifying wing-strokes that correspond to both non-maneuvering (no net torque) and
corrective flight. We then separate out the kinematic
variables for each type of flight, and calculate the changes
to body pitch angle resulting from different combinations
of corrective and non-corrective kinematics, shown by
the color codes in Figure 4. For example, a point with
color combination blue-blue-red corresponds to a wingbeat with wing pitch and deviation angles taken from
the corrective maneuver and the stroke angle taken from

6
non-maneuvering flight. Our calculation uses the aerodynamic model detailed above to determine the torques produced by a given set of wing kinematics, assuming rigid
wings attached to a stationary body at a point above the
body center of mass. From the calculated torques, we
determine the net change in body pitch angle over the
course of each wing-stroke using numerical integration.
We perform this analysis for all 8 possible combinations of wing kinematics for data from two different perturbation events, the pitch up and pitch down events in
Figures 2 and 3. Points corresponding to combinations of
wing kinematics from the pitch up and pitch down events
are shown above and below the axis, respectively. In both
cases, the sign for ∆θb is chosen so that positive indicates
a corrective rotation. The grouping of points in Figure
4 indicates that body pitch correction is most closely associated with changes to wing stroke angle. The blueblue-red point, corresponding to corrective stroke angle
but non-maneuvering wing pitch and rotation, achieves
at least 60% of the correction to body pitch angle, consistent with [33]. Moreover, the only combinations that
give more than 30% of the total correction have corrective stroke angle (points of the form x-x-red). Changes
to wing pitch or deviation can contribute ∼ 40% to the
corrective process, but cannot alone account for corrective body kinematics. These results motivate a minimal
model for body pitch stabilization that considers only
variations in front stroke angle to drive pitch correction.

D.

The Corrective Effect of Stroke Angle Over a
Range of Perturbations

To further flesh out the relationship between front
stroke angle and corrective torque, we plot the maximum
measured corrective pitch acceleration generated by the
fly in each maneuver as a function of the corresponding change in front stroke angle measured at that time,
(Figure 5a). The maximum pitch acceleration
∆φfront
w
was measured at the extremum of θb , using a quadratic
polynomial fit. The plot demonstrates a strong correlation between changes in front stroke angle and corrective acceleration (linear R2 = 0.87). Consistent with the
two maneuvers in previous figures, Figure 5a shows that,
across our data set, flies increase ∆φfront
(flap less forw
ward) to pitch themselves down, and decrease ∆φfront
w
(flap further forward) to pitch themselves up.
The correlation between ∆φfront
and corrective pitch
w
acceleration in Figure 5a is also predicted by a calculation based on the quasi-steady aerodynamic force model
in Equations 1,2 (Figure 5a, gray line). To calculate the
aerodynamic pitch torques, we use a simplified wing kinematic model similar to that in [20] in which only the front
stroke angle is varied (see Supplementary). We average
the computed torques over a wing-beat, and divide by
the moment of inertia to obtain pitch acceleration. The
calculation relies only on the wing kinematics and fly
morphology [43], and has no fitted parameters. More-

over, we verified that the resultant acceleration is insensitive to body pitch rotations, suggesting that passive
damping contributes negligibly to correction [44]. The
results of our calculation, shown in Figure 5a, quantitatively reproduce the measured pitch acceleration, further
corroborating a model for pitch control that includes only
modulation of φfront
.
w
To rule out an alternative corrective mechanism, based
on modulation of back stroke angle, we plot corrective
pitch acceleration as a function of φback
, shown in Figure
w
5b. We find no discernible correlation between these two
variables. Calculating aerodynamic forces predicts that
changes to the back stroke angle could produce corrective
pitching torques in the same way that changes to front
stroke angle do; the fact that we do not observe this
in the data hints that morphological constraints favor
modulation of the front stroke angle.
E.

Correction Timescales

We also analyze the pitch correction timescales across
our data set. Figure 5c shows a histogram of latency
times for each corrective maneuver, defined as the time
between the onset of the perturbation and the first mea| > 4◦ ).
surable change in the front stroke angle (|∆φfront
w
The mean latency time is 9.9 ± 2.1 ms corresponding to
∼ 2 wing-beats (mean ± standard deviation, n = 18).
Figure 5d plots the total correction time for each maneuver as a function of the maximum body pitch deflection
in each perturbation event. We define the correction time
as the time between the onset of the perturbation and the
fly’s correcting 90% of the pitch deflection. The median
correction time is 29 ± 8 ms (mean ± standard deviation, n = 32). Finally, we find that the correction time is
weakly correlated with the perturbation amplitude (linear R2 = 0.093), which is consistent with a linear control
model.
F.

Control-Theory Model

We use a control-theoretic framework to describe flies’
method for pitch stabilization. In particular, we model
actuated changes to the front stroke angle as the output
of a proportional-integral (PI) controller with time delay
∆T , for which the input is body pitch velocity (block
diagram in Figure 6a). The response ∆φfront
is given by:
w
∆φfront
(t) = Kp θ̇b (t − ∆T ) + Ki ∆θb (t − ∆T )
w

(3)

Equation 3 states that adjustment of the front stroke
angle (∆φfront
) at a given time t is given by a linear
w
combination of the body pitch angle deviation from nonmaneuvering orientation (∆θb ) and body pitch velocity
(θ̇b ) at an earlier time t − ∆T . The parameters Kp and
Ki are the proportionality constants that determine the
relative weights of body pitch angle and pitch velocity.

7

6
3
0
w3
w6

w20 w10 0 10 20 30
ΔmFrontmStrokemAnglef
front
mmmmmmmm[deg]
ΔΦ
wm

CorrectionmTimem[ms]

Counts

6
4
2
0
4

d)

6

8

10

12

LatencymTimem[ms]

Halteres

6

+
3

-

0

correctiveP
torque

w3

+

Wings

w6
w5
5
w10
0
ΔmBackmStrokemAnglefm
back
mmmmmmmmmmmmm[deg]
ΔΦwm

+

b)
ΔPFrontPStrokePAngle
front
PPPPPPPP[deg]
ΔΦ
wP

c)

a)

b)
Data
Theory

BodymPitchmAcceleration
mθbmm[105mdeg/s2]

BodymPitchmAcceleration
θbmm[105mdeg/s2]

a)

50
40
30

20

Data
PIPCtrl
PPterm
IPterm

10
0

-10

20
0

10

20

30

40

Max8mBodymPitchm
DeflectionfmΔθbfmaxmm[deg]

FIG. 5: Statistics from many perturbation events. (a-b) Maximum corrective pitch acceleration generated by the fly as a
function of change in front stroke angle and back stroke angle. The gray line in (a) is the calculated pitch acceleration for
simplified wing kinematics. Note that the gray line has no fit
parameters, and is based purely on morphological parameters
[43], wing kinematics [20], and the quasi-steady aerodynamic
model. (c) A histogram of latency times across our data set,
with latency time defined as the time between the onset of
the magnetic perturbation and the beginning of a measurable corrective wing response (± 4◦ change in front stroke
angle). The orange background in corresponds to the mean
delay time ± standard deviation obtained from our controller
model fits. (d) The time for the pitch correction–defined as
the time it takes for the fly to recover 90% of its original pitch
orientation–plotted as a function of the maximum pitch deflection for each perturbation event. Solid and dashed lines
give mean ± standard deviation. The lack of discernible correlation in d) is a hallmark of linear control.

The same controller could be termed a PD controller, if
the input to the controller were the body pitch angle. Because the fly halteres are known to measure body angular
velocities [22, 23, 35], we choose the PI nomenclature. We
exclude controller models that depend on angular acceleration (PID) based on previous studies that have shown
flies’ corrective pitch response to be insensitive to angular acceleration [23]. Further analysis of the data in [23]
confirms this model framework (see Supplementary).
Importantly, a PI controller model with only angular
velocity as an input cannot account for pitch stabilization on long timescales, due to integration errors affecting measurement of the absolute pitch angle. Controlling
pitch on long timescales requires direct measurement of
the pitch angle, as could be achieved by the visual sys-

-10

0

10
20
TimeP[ms]

30

40

FIG. 6: Control theory model. (a) A block diagram for the PI
controller model. The effect of external torque (τext ) is sensed
by the halteres as angular velocity. The measured body pitch
velocity (θ̇b ) is subject to a time delay (∆T ), after which the
signal is split into two branches. One branch is multiplied by
Ki and integrated to yield pitch displacement, while the other
branch is multiplied by Kp . These signals are recombined
as an output, ∆φfront
, that adjusts the front stroke angle of
w
the wings. This adjustment to front stroke angle results in a
corrective wing torque (τw ), which is in turn sensed by the fly.
(b) Measured front stroke angle as a function of time for the
pitch up event in Figures 1, 2, and 3 (orange dots) compared
with the output of the fitted PI controller model (blue line).
The relative contributions from the P and I terms are shown
in the gray solid line and the brown dashed line, respectively.
Shaded blue region corresponds to the confidence interval of
the three control parameters.

tem. An interplay between the haltere and visual systems, as in [45], is necessary for comprehensive pitch
stability. The PI model presented here can accurately
account for the fly’s fast reflex response, which stabilizes
it against rapid pitch perturbations.
Using measured values for ∆φfront
, ∆θb , and θ̇b , we fit
w
for the parameters Kp , Ki , and ∆T . The three parameters are fit for each movie individually, using one data
point per wing-stroke. The fit is performed by evaluating Equation 3 on a dense 3D grid in parameter space
and finding the global minimum for the sum of squared
residuals between the control model and real data. The
results of a controller fit for the pitch up event in Figures 1, 2, and 3 are shown in Figure 6b. The orange
dots give the measured values of the front stroke angle,
while the blue line shows the output of the fitted controller model. We find excellent quantitative agreement
between the controller fit and our measured data with
an RMS error of 1.9◦ , which is on the order of the mea-

8

1
2
3
4
5
6
7
8
9

25
16
25
6
7
15
-24
-23
-21

0.5
0.1
0.5
0.5
0.2
0.3
0.3
0.2
0.2

±
±
±
±
±
±
±
±
±

0.24
0.25
0.19
0.23
0.61
0.24
0.29
0.31
0.26

6 ± 1.9
8 ± 3.4
4 ± 1.7
12 ± 7
7 ± 7.3
8 ± 3.2
6 ± 2.4
6 ± 2.0
8 ± 2.8

4
8
4
4
7
6
7
9
7

±
±
±
±
±
±
±
±
±

2.1
2.5
1.7
3.6
5.8
2.2
2.1
1.5
3.6

1.9
2.9
3.2
1.7
2.5
2.7
3.7
2.9
4.5

TABLE I: Fit results for PI controller model with confidence
intervals (CI) for each parameter.

We find that flies with no control or I control are subject to large, rapid oscillations of body pitch angle (Figure 7b), while flies with P control are subject to slightly
smaller, long-timescale oscillations (Figure 7a). In all
three of these cases, the simulated fly fails to remain
aloft and rapidly loses altitude. Among the four candidate models, PI control is the only one that is consistent
with the fast, robust pitch control that we observe experimentally (Figure 7a). Simulated flies implementing PI
control correct their orientation over timescales similar to
those in our experimental data. In contrast to the other
three controller models, the simulated flies using PI control maintain pitch stability over long times and remain
aloft. The general features of each control scheme show
little sensitivity to the values of the control parameters,
in agreement with the large confidence intervals that we
find for fitted control parameters in Section III F.

a)

Perturbation

BodyIPitchIAngleI
θbI[deg]

Mov. ∆θb Ki ± CI Kp ± CI ∆T ± CI RMS Err.
Num. [deg] [none]
[ms]
[ms]
[deg]

for the simulated controllers, we fit our experimental data
to each model, and to mimic the perturbation conditions
in our experiments we impose a 5 ms external mechanical
torque on the simulated flies (yellow strip), with magnitude comparable to our real system. For details on the
simulation, see Supplementary.

PII
PI

70
60
50
40
30
20

b) 200

BodyIPitchIAngleI
θbI[deg]

surement uncertainty for ∆φfront
. The controller model
w
not only captures the sharp rise in ∆φfront
in response
w
to the perturbation, but also the subsequent decrease in
∆φfront
corresponding to the braking counter-torque that
w
slows the fly’s downward pitching motion (Section III B).
The proportional (P) and integral (I) contributions to
the controller model are shown in solid gray and dashed
brown curves, respectively. The fast rise time of the response can be attributed to the proportional term.
We apply the same fitting process to nine movies. We
find the values of fitted control parameters (Table I) to be
Ki = 0.3 ± 0.15, Kp = 7 ± 2.1 ms, and ∆T = 6 ± 1.7 ms
(mean ± standard deviation), with an average RMS fitting error of 3.0◦ . The mean value of ∆T corresponds to
roughly 1 wing-beat, providing a lower bound for measured latency times (see Discussion). Figure 5c shows
the region corresponding to mean ∆T ± 1σ (highlighted
in orange) compared with measured latency times. Confidence intervals (CI) in Table I are calculated based on
a χ2 test for the fitting residuals in control parameter
space. The confidence interval size is large relative to
the fitted control parameters (> 50% in some cases). The
large confidence intervals, combined with the accuracy of
the fit, indicate that the model is robust to deviations in
the controller parameters.

II
None

100
0
-100
-200
0

50

100

150

200

250

300

350

TimeI[ms]

G.

Numerical Simulation

To corroborate our experimental evidence for the PI
controller, we perform a dynamical simulation of a mechanically perturbed fruit fly. The simulation solves the
equations of motion for the pitch, longitudinal, and vertical degrees of freedom, assuming the fly’s geometry,
simplified wing kinematics, and the quasi-steady aerodynamic force model detailed above. The body pitch
angle over time for simulated flies implementing different
control strategies is shown in Figure 7. The four simulated control schemes shown are: i) proportional-integral
(blue), ii) proportional (green), iii) integral control (orange), and iv) no control (red). To determine parameters

FIG. 7: Numerical simulation results for different controller
models. (a) Time series of body pitch angle for simulated
flies implementing proportional-integral (PI, blue) and proportional (P, green) control. (b) Time series of body pitch
angle for simulated flies implementing integral (I, orange) and
no (None, red) control. Time axes for both (a) and (b) are the
same, but the range of the pitch angle axis differs significantly
between the two. Gray region in (a) and (b) corresponds to
45 ± 2◦ , where 45◦ is the reference body pitch angle for each
controller. Hence, curves returning to and remaining within
this region indicate successful control. The yellow strip indicates the duration of the mechanical perturbation (0 - 5
ms).

9
H.

Extreme Perturbations

IV.

In addition to the 18 perturbation events analyzed in
full (Figure 1, 5), we examine two large-amplitude perturbation events. Snapshots and time courses of body pitch
angle are shown in Figure 8 for a pitch up and a pitch
down event, both with maximum pitch deflection greater
than 130◦ (Movie S2). Remarkably, both flies performed
successful correction maneuvers, although they were not
in-frame long enough to observe them returning to their
original orientation. The correction time for both largeamplitude events (> 50 ms) is longer than the correction
times shown in Figure 5, which can be attributed to the
fact that the controlled quantity ∆φfront
is biologically
w
constrained: front stroke angle is limited, for instance,
by the angle at which the body or the other wing obstructs a wing’s forward motion. If we input the body
pitch kinematics for the events in Figure 8 into our PI
controller model, the model predicts changes to φfront
in
w
excess of 100◦ –a value that is physiologically impossible
in the forward direction and not observed in the backward direction. Assuming the flies’ corrective response is
| ≤ 30◦ , a physiologically reasonable
bounded by |∆φfront
w
estimate, our numerical simulation predicts a response
time of ∼70 ms for a perturbation ∆θb = −150◦ , in excellent agreement with the experimental data.

a)

b)

A.

Discussion

Front Stroke Angle as the Controlled Quantity

We show that front stroke angle modulation is the primary mechanism for body pitch control in fruit flies, consistent with previous experiments [11, 21, 23] and is in the
same spirit as other proposed mechanisms that include
modulation of the mid-stroke angle [20]. Our computational results (Figures 5 and 7) show that a minimal
model, which only incorporates changes to front stroke
angle, and uses control parameters extracted from fits
to our measurements, is the simplest linear, continuous
model capable of stabilizing the body pitch angle on time
scales similar to those observed in the experiments.
Kinematic variables other than φfront
may also conw
tribute to pitch correction. Previous studies have associated changes to stroke plane deviation [46], wing-beat
frequency [23], and body posture [36] with pitch correction. In particular, we observe transient alterations in
both wing pitch and deviation angle during corrective
maneuvers. Figure 4 suggests that, when combined with
modulation of front stroke angle, changes to wing pitch
and deviation angle can account for up to 40% of body
pitch correction, consistent with [33]. The detailed role
of these kinematic variables in pitch control and whether
they are actively or passively actuated remains unknown.
B.

Discrete vs. Continuous Control Models

t = -15 ms
t = -1ms

t = 60 ms

Body Pitch Angle
θb [deg]

200

50

150

0

100
50

t = 65 ms

-50
0

20

Time [ms]

40

-100
60

0

20

40

Time [ms]

FIG. 8: Large perturbations. Overlaid snapshots from raw
data and time series of body pitch angle for (a) pitch up
perturbation and (b) pitch down perturbation (Movie S2).
The pitched up fly reaches a maximum pitch deflection of 130◦
at ∼20 ms after the onset of the perturbation. The pitched
down fly reaches a maximum pitch deflection of -155◦ after
∼30 ms. The loss of altitude during the correction is evident
in both cases and shown to scale. Yellow strips indicate the
5.8 ms magnetic pulse; red arrows indicate the direction of
each perturbation.

The periodic motion of wing flapping introduces inherent discreteness to insect flight. For processes occurring
on timescales comparable to a wing-stroke period–like
the perturbations and maneuvers we reported here–we
expect discrete effects to be more pronounced. In particular, modulations of front stroke angle can, by definition,
occur only once per wing-beat. Because perturbations
can be induced at any time during the wing-beat, but
the actuated kinematics are discretely constrained, latency times for correction depend on the phase of the
perturbation relative to the wing-stroke. Latency times
will be bounded from below by the flies’ neural response
time, but could potentially be as much as one wing-beat
longer as a result of the phase of the perturbation within
the wing-beat.
Measured latency times can also depend on discrete
sensing. The temporal sampling resolution with which
flies can measure mechanical perturbations is likely determined by motion of their halteres, the rate-gyro sensory
organs used in fast perturbation response [23]. Dipteran
halteres beat at the wing frequency and use Coriolis
forces to measure body angular velocities [22, 47]. The
largest sensitivity to mechanical perturbations is likely to
occur at times during the fly’s mid-stroke, when Coriolis
forces on the halteres are the largest [22]. Sensing at discrete times introduces a second relevant phase for correction latency time: the phase of the perturbation relative

10
to sensing. Similar to discrete actuation, discrete sensing
would lead to latency times longer than the neural response time. Moreover, even during the fly’s mid-stroke,
its halteres only have finite sensitivity. It is likely that
there exists some threshold for angular velocities that are
large enough to elicit a control response [48].
The continuous PI controller model does not account
for the effects of discrete actuation, discrete sampling,
or sensing threshold. Hence, the measured latency time
should constitute an upper bound for the delay time that
we obtain from the controller model. Indeed, the time
delays from our controller model (∆T = 6 ± 1.7 ms) is
roughly one wing-beat shorter than the measured latency
times (9.9 ± 2.1 ms).
Despite the inherent discreteness of the fly control systems, our continuous PI controller model quantitatively
captures the behavior of flies in response to pitch perturbations (Figure 6). This quantitative agreement leads to
an interesting open question: under what conditions does
it become necessary to use a discrete controller model
to describe flight stabilization? To answer this question
would require precise perturbation timing, in order to
probe the short timescales at which discretization becomes relevant. Such an analysis could provide significant insight into the timing and thresholding of fruit fly
reflexes.
C.

Physiological Basis for Pitch Control

Both the mechanism and timing for the pitch correction indicate a likely candidate muscle for control actuation: the first basalare muscle (b1), as suggested by
previous studies [20, 49]. Among dipteran flight control
muscles, b1 is unique in that it is active during every
wing-stroke [50–52], which would allow for the wing-beat
timescale pitch control that we observe. Moreover, b1
activity is strongly correlated with modulations of ven[53, 54]. In
tral stroke amplitude, i.e. changes in φfront
w
blowflies, b1 activity is also correlated with changes in deviation angle during the ventral stroke [55], which could
explain the slight shifts in deviation angle that we observe
during correction (Figure 2b,f). Our results indirectly
support the hypothesis that the b1 muscle is responsible
for pitch control through the regulation of φfront
. Testing
w
flies with disabled or altered b1 muscles could provide an
avenue for confirming the role of b1 in the pitch control
process.
D.

Linear Control of Body Orientation

In addition to the results on fruit flies reported here,
PI control has also been identified in pitch control for
hawkmoths [31, 32]. The anatomical similarities found
across species suggest that pitch instability is an obstacle
faced by many flapping insects [4, 11]; a natural question
raised by these collective findings is whether or not PI

control is a generic feature of pitch stabilization in insects. Beyond insects, what we refer to as PI control has
also been observed in fast obstacle avoidance in pigeons
[56]. Future research on the ubiquity of PI control could
have fascinating implications for the evolution of flight
stabilization mechanisms.
Extending beyond pitch stabilization, our results, together with previous studies on yaw [34] and roll [14]
control in fruit flies, show that the strategies flies use to
control each of their body Euler angles can be modeled
as PI controllers. However, the overarching structure in
which these three individual controllers are embedded is
still unknown. Given the non-commutativity of rotations
in 3D, the relationship between controllers that measure
different angular coordinates is likely to be non-trivial.
For example, in response to perturbations that simultaneously affect both the roll and yaw degrees of freedom,
previous studies observed preferential correction for roll
over yaw [14]. Because roll is known to be aerodynamically unstable, while yaw is passively stable [7, 9, 13],
the results from [14] suggest that control for different
body angles may be imposed hierarchically, with preference given to correcting degrees of freedom that are
most unstable. However, in our data set we observe perturbation events in which pitch is corrected prior to roll,
despite roll being the more unstable degree of freedom,
implying that the response to complex perturbations has
amplitude dependent features. Taken together, these results hint at a complex and intriguing control architecture used by flies to stabilize their orientation.
An understanding of the relationship between control
of different Euler angles could have profound implications
for how the fly encodes information about its body orientation. In the case of vision, organism-specific demands
have spurred the development of novel, specialized neural
structures in both mammals [57, 58] and insects [59, 60].
Pioneering work on information processing from halteres
has suggested similar morphology/function relationships
for the gyroscopic rate sensing in insects [61]. Connecting such analyses with the resultant control structure observed in free-flight behavioral experiments could provide
a window into the most basic ways in which flies sense
and interpret the world.
Acknowledgments

We thank Grace (Li) Chi and Andy Clark for providing
flies; Ty Hedrick for advice on camera calibration; Andy
Ruina and the Cohen group for useful conversations.
Funding

This work was supported in part by an NSF DMR
award (no. 1056662) and in part by an ARO award (no.
61651-EG). S.C.W. was supported by the NDSEG Fellowship. T.B. was supported by the Cross Disciplinary
Post-Doctoral Fellowship of the Human Frontier Science
Program.

11

[1] G. K. Taylor and A. L. Thomas, Journal of Experimental
Biology 206, 2803 (2003).
[2] M. Sun and Y. Xiong, The Journal of experimental biology 208, 447 (2005).
[3] G. K. Taylor and R. Żbikowski, Journal of The Royal
Society Interface 2, 197 (2005).
[4] M. Sun, J. Wang, and Y. Xiong, Acta Mechanica Sinica
23, 231 (2007).
[5] H. Liu, T. Nakata, N. Gao, M. Maeda, H. Aono, and
W. Shyy, Acta Mechanica Sinica 26, 863 (2010).
[6] I. Faruque and J. S. Humbert, Journal of theoretical biology 264, 538 (2010).
[7] Y. Zhang and M. Sun, Acta Mechanica Sinica 26, 175
(2010).
[8] Y.-L. Zhang and M. Sun, Acta Mechanica Sinica 27, 823
(2011).
[9] N. Gao, H. Aono, and H. Liu, Journal of Theoretical
Biology 270, 98 (2011).
[10] N. O. Prez-Arancibia, K. Y. Ma, K. C. Galloway, J. D.
Greenberg, and R. J. Wood, Bioinspiration & Biomimetics 6, 036009 (2011).
[11] L. Ristroph, G. Ristroph, S. Morozova, A. J. Bergou,
S. Chang, J. Guckenheimer, Z. J. Wang, and I. Cohen,
Journal of The Royal Society Interface 10 (2013).
[12] N. Xu and M. Sun, Journal of theoretical biology 319,
102 (2013).
[13] M. Sun, Rev. Mod. Phys. 86, 615 (2014).
[14] T. Beatus, J. M. Guckenheimer, and I. Cohen, Journal of
The Royal Society Interface 12 (2015), ISSN 1742-5689.
[15] S. A. Combes and R. Dudley, Proceedings of the National
Academy of Sciences 106, 9105 (2009).
[16] A. K. Dickerson, P. G. Shankles, N. M. Madhavan, and
D. L. Hu, Proceedings of the National Academy of Sciences 109, 9822 (2012).
[17] S. Ravi, J. D. Crall, A. Fisher, and S. A. Combes, The
Journal of Experimental Biology 216, 4299 (2013).
[18] V. M. Ortega-Jimenez, J. S. Greeter, R. Mittal, and T. L.
Hedrick, The Journal of experimental biology 216, 4567
(2013).
[19] J. Vance, I. Faruque, and J. Humbert, Bioinspiration &
biomimetics 8, 016004 (2013).
[20] S. Chang and Z. J. Wang, Proceedings of the National
Academy of Sciences 111, 11246 (2014).
[21] J. Zanker, Philosophical Transactions of the Royal Society of London. B, Biological Sciences 327, 43 (1990).
[22] G. Nalbach, Neuroscience 61, 149 (1994).
[23] M. H. Dickinson, Philosophical Transactions of the Royal
Society of London.Series B: Biological Sciences 354, 903
(1999).
[24] A. Sherman and M. H. Dickinson, Journal of experimental biology 207, 133 (2004).
[25] A. Sherman and M. H. Dickinson, Journal of Experimental Biology 206, 295 (2003).
[26] S. N. Fry, R. Sayaman, and M. H. Dickinson, Journal of
Experimental Biology 208, 2303 (2005).
[27] J. A. Bender and M. H. Dickinson, The Journal of experimental biology 209, 3170 (2006).
[28] A. R. Ennos, Journal of Experimental Biology 142, 49
(1989).
[29] S. N. Fry, R. Sayaman, and M. H. Dickinson, Science
300, 495 (2003).

[30] L. Ristroph, G. J. Berman, A. J. Bergou, Z. J. Wang,
and I. Cohen, Journal of Experimental Biology 212, 1324
(2009).
[31] B. Cheng, X. Deng, and T. L. Hedrick, The Journal of
Experimental Biology 214, 4092 (2011).
[32] S. P. Windsor, R. J. Bomphrey, and G. K. Taylor, Journal
of The Royal Society Interface 11, 20130921 (2014).
[33] F. T. Muijres, M. J. Elzinga, J. M. Melis, and M. H.
Dickinson, Science 344, 172 (2014).
[34] L. Ristroph, A. J. Bergou, G. Ristroph, K. Coumes, G. J.
Berman, J. Guckenheimer, Z. J. Wang, and I. Cohen,
Proceedings of the National Academy of Sciences 107,
4820 (2010).
[35] J. W. S. Pringle, Philosophical Transactions of the Royal
Society B: Biological Sciences 233, 347 (1948).
[36] G. K. Taylor, Biological Reviews 76, 449 (2001).
[37] M. A. Lourakis and A. Argyros, ACM Trans. Math. Software 36, 1 (2009).
[38] D. H. Theriault, N. W. Fuller, B. E. Jackson, E. Bluhm,
D. Evangelista, Z. Wu, M. Betke, and T. L. Hedrick, The
Journal of Experimental Biology 217, 1843 (2014).
[39] M. H. Dickinson, F.-O. Lehmann, and S. P. Sane, Science
284, 1954 (1999).
[40] S. P. Sane and M. H. Dickinson, Journal of Experimental
Biology 204, 2607 (2001).
[41] L. Ristroph, A. J. Bergou, J. Guckenheimer, Z. J. Wang,
and I. Cohen, Phys. Rev. Lett. 106, 178103 (2011).
[42] S. Sefati, I. D. Neveln, E. Roth, T. R. Mitchell, J. B.
Snyder, M. A. MacIver, E. S. Fortune, and N. J. Cowan,
Proceedings of the National Academy of Sciences 110,
18798 (2013).
[43] B. Cheng, S. Fry, Q. Huang, W. Dickson, M. Dickinson,
and X. Deng, in Robotics and Automation, 2009. ICRA
’09. IEEE International Conference on (2009), pp. 1889–
1896, ISSN 1050-4729.
[44] B. Cheng and X. Deng, pp. 39–44 (2010).
[45] S. J. Huston and H. G. Krapp, The Journal of Neuroscience 29, 13097 (2009).
[46] J. M. Zanker, Physiological Entomology 13, 351 (1988),
ISSN 1365-3032.
[47] J. Pringle, The Journal of physiology 108, 226 (1949).
[48] J. Fox and T. Daniel, Journal of Comparative Physiology
A 194, 887 (2008), ISSN 0340-7594.
[49] A. Fayyazuddin and M. H. Dickinson, Journal of Neurophysiology 82, 1916 (1999), ISSN 0022-3077.
[50] G. Heide, BIONA-report 2, 35 (1983).
[51] G. Heide and K. G. Götz, The Journal of experimental
biology 199, 1711 (1996).
[52] J. A. Miyan and A. W. Ewing, Philosophical Transactions of the Royal Society B: Biological Sciences 311,
271 (1985).
[53] M. H. Dickinson and M. S. Tu, Comparative Biochemistry and Physiology Part A: Physiology 116, 223 (1997).
[54] S. M. Walker, D. A. Schwyn, R. Mokso, M. Wicklein,
T. Mller, M. Doube, M. Stampanoni, H. G. Krapp, and
G. K. Taylor, PLoS Biol 12, e1001823 (2014).
[55] C. N. Balint and M. H. Dickinson, Journal of experimental biology 207, 3813 (2004).
[56] H.-T. Lin, I. G. Ros, and A. A. Biewener, Journal of The
Royal Society Interface 11, 20140239 (2014).
[57] T. Hafting, M. Fyhn, S. Molden, M.-B. Moser, and E. I.

12
Moser, Nature 436, 801 (2005).
[58] M. M. Yartsev, M. P. Witter, and N. Ulanovsky, Nature
479, 103 (2011).
[59] T. A. Ofstad, C. S. Zuker, and M. B. Reiser, Nature 474,
204 (2011).

[60] J. D. Seelig and V. Jayaraman, Nature 503, 262 (2013).
[61] J. L. Fox, A. L. Fairhall, and T. L. Daniel, Proceedings
of the National Academy of Sciences 107, 3840 (2010).

Pitch Perfect: How Fruit Flies Control their Body Pitch Angle
Supplementary Information
Samuel C. Whitehead1∗ , Tsevi Beatus1∗ , Luca Canale2 , and Itai Cohen1
1

arXiv:1503.06507v1 [physics.bio-ph] 23 Mar 2015

Department of Physics, Cornell University, Ithaca,
New York 14853, USA; 2 Département de Mécanique,
École Polytechnique 911128, Palaiseau, France.
∗
Equal contributors
(Dated: March 30, 2015)

I.

Movies

Movie 1:- A fruit fly undergoing a typical pitch up
perturbation and correction maneuver, corresponding to
the data presented in Figures 1-4 and 6 in the main text.
The side panels of the 3D box correspond to raw movies
from the three orthogonal high-speed cameras. The green
line, and its white projection onto the floor of the 3D
box, show the center-of-mass trajectory of the fly, with
red regions of the line representing the duration of the
magnetic pulse. The timing for the event, in milliseconds,
is given in the bottom left corner. If not attached, the
video can be found at https://youtu.be/2FGj7HUCL7E.
Movie 2:- Raw footage of three camera views of a fly
undergoing a large-amplitude pitch down perturbation,
corresponding to the data presented in Figure 8. The
center panel corresponds to the overhead view, while the
left and right panels correspond to side views. The timing
for the event, in milliseconds, is given in the bottom left
corner. The magnetic perturbation is applied from 0-5.8
ms. If not attached, the video can be found at https:
//youtu.be/EUIE9jRcusg.

• K, C are waveform parameters. K tunes the stroke
angle from pure sine wave to triangle wave, while C
tunes the wing pitch angle from sinusoid to square
wave.
• ω is the wing-beat frequency.
• δη , δθ are phase offsets.
For the calculation in Figure 5a we use ω = 250 × (2π)
rad/s; ηm = 53◦ ; η0 = 90◦ ; δη = 72.4◦ ; C = 2.4;
θm = 25◦ ; θ0 = 0◦ ; δθ = 90◦ ; K = .7; φm ∈ [60◦ , 87.5◦ ];
φ0 ∈ [87.5◦ , 115◦ ]. For the simulation in Figure 6, we use
similar parameters to the above, but set θm = θ0 = 0◦ for
simplicity and vary φm and φ0 according to our controller
model. Note that in the main text we refer to front and
), which are related
and φback
back stroke angles (φfront
w
w
to φm and φ0 by the linear relations:
φfront
= φ0 − φm
w
φback
w

III.
II.

Simplified Wing Kinematics

For both the calculation of aerodynamic torques in
Figure 5a and the dynamical simulation in Figure 7, we
use an analytic form for simplified wing kinematics taken
from [1]. These kinematics closely resemble the motion
of real fly wings, but are simple enough to write down
concisely.
asin(Ksin(ωt))
asin(K)
tanh(Csin(ωt + δη ))
ηw (t) = η0 + ηm
tanh(C)
θw (t) = θ0 + θm cos(2ωt + δθ )

φw (t) = φ0 + φm

(S1)
(S2)
(S3)

The wing Euler angles are defined in Figure 1c in the
main text. The terms in Equations S1, S2, and S3 are
defined as follows:
• φ0 , η0 , θ0 are angle offsets.
• φm , ηm , θm are amplitudes.

= φ0 + φm

(S4)
(S5)

Numerical Simulation

Using the simplified wing kinematics above and the
quasi-steady aerodynamic model detailed in the main
text (Equations 1 and 2), our numerical simulation solves
the Newton-Euler equations for vertical, forward, and
pitch rotational motion. Control is implemented by adjusting the front stroke angle of the prescribed wing kinematics according to Equation 3 in the main text. The Ki
and Kp parameters were determined by the fit to the experimental data. The inputs for the controller in each
wing beat–the body pitch angle and pitch velocity–were
taken as their mean values during the previous wing beat.
This scheme represents a time-delay of one wing-beat
while avoiding the effects of the inherent small-scale pitch
oscillations. Before we apply the perturbation, we let the
simulated fly stabilize to a steady-state body pitch angle
of 45◦ . The perturbation is then applied, with magnitude roughly corresponding to the accelerations observed
in the experiments. In simulation runs that tested controller models other than PI, we let the system stabilize
at θb = 45◦ using a PI controller and only then we applied the perturbation and simultaneously changed the
controller type.

Left wing amplitude [deg]

2
165

165

160

160

155

155

150

-20

-10
0
10
Pitch Angle [deg]

20

150

-200

-100
0
100
-1
Pitch Velocity [deg s ]

200

FIG. S1: Data extracted from [2] for the left wing amplitude in response to sinusoidal pitch perturbation. On the top, the
red circles represent the response to the pitch angle; on the bottom panel, the blue circles represent the response to the pitch
velocity in the same measurement. The black solid ellipses show the predicted response of a PI control model.

Analysis of Data from Previous Studies

Following [3], we further test the PI control model by
using it to predict the pitch response of tethered fruit
flies previously published by Dickinson [2]. In [2], flies
were tethered to a gimbal apparatus that oscillated about
different rotational axes. The left wing stroke amplitude
of the flies, Φleft , was measured using photodetectors that
recorded the wings’ shadows. As noted by [2], flies do not
adjust their back stroke angle during pitch correction, so
stroke amplitude is a good proxy for φfront
, the quantity
w
we measure in free flight experiments.
In one of the measurements reported in [2], pitch perturbations were imposed so that: θb (t) = Asin(ωt) and
θ̇b (t) = Aωcos(ωt), with A = 25◦ , period T = 0.63 s, and
maximum pitch velocity 250◦ s−1 . The left wing stroke
amplitude was plotted against both pitch angle and pitch
velocity (Figure 3a,c in [2]). Using standard image processing techniques, we extract the data from these plots.
The pitch oscillations in the tethered experiments have
period 630 ms, which is much longer than the observed
pitch correction latency times from our experiments (≈
10 ms), so we consider the controller time delay negligible. We then write the form for our controller, now in
terms of left wing-stroke amplitude, as:

165
Left wing Amp. [deg]

IV.

160

155

20

150
200

0

0
-1

Pitch Velocity [deg s ]

-200

-20

Pitch [deg]

(S6)

FIG. S2: Data extracted from [2] for the left wing amplitude
in response to sinusoidal pitch perturbation is plotted in the
3D space whose axes are (θb , θ̇b , Φleft ). The data points are
colored according to their original color in Figure S1. The
black solid line shows the predicted response of the same PI
control model shown in Figure S1.

where the left wing stroke amplitude, Φleft (t), and mean
stroke amplitude, Φmean , are related to the controlled
quantity from the main text, ∆φfront
(t), by the linear
w
relation: ∆φfront
(t)
=
Φ
(t)
−
Φ
left
mean . Note that conw
sidering only the left wing does not reduce generality of
this analysis, since pitch correction is left/right symmetric. We manually fit for for the control parameters from

the data. The fitted parameters obtained are Ki = 0.3
and Kp = 8 ms, comparable to the parameters from the
main text.
The predictions of the PI controller fit are shown in
Figures S1, S2, and S3. The output of the PI controller

Φleft (t) = Kp θ̇b (t) + Ki ∆θb (t) + Φmean

3
165

LeftRwingRAmp.R[deg]

RawRdata
PIRmodel

160

155

150
-3000

-2000

-1000
0
1000
-2
PitchRAccelerationR[degRs ]

2000

is plotted as a function of both pitch angle and pitch
velocity in Figure S1, yielding an ellipse in both cases
(R2 = 0.761 and 0.842 respectively). The linear model
for Φleft as a function of θ̇b gives R2 = 0.556. To show
the full dependence of the PI controller on both angle
and velocity, we also plotted the PI controller prediction
in the 3D space whose axes are (θb , θ̇b , Φleft ), shown in
Figure S2. The PI controller predicts an inclined ellipse
in this space, the projections of which onto the horizontal
axes yield the plots in Figure S1. The inclination of the
ellipse shows that corrective response depends on both
pitch angle and pitch velocity, i.e. the inclination of the
measured data in [2] is consistent with a PI controller.

3000

FIG. S3: Data extracted from [2] for the left wing amplitude in response to sinusoidal pitch perturbation is plotted
as a function of pitch acceleration. The data corresponds to
the same measurement (same fly and same perturbation) as
shown in Figures S1 and S2. The black solid line shows the
predicted response of the same PI control model as in Figures S1 and S2. Note that the PI controller model includes
no information about the pitch acceleration, suggesting that
pitch acceleration is unimportant in determining the flies’ corrective wing kinematics, and thus excluding a PID controller
model.

[1] S. Chang and Z. J. Wang, Proceedings of the National
Academy of Sciences 111, 11246 (2014).
[2] M. H. Dickinson, Philosophical Transactions of the Royal
Society of London.Series B: Biological Sciences 354, 903

Additionally, we show the predicted output of the PI
controller plotted as a function of pitch acceleration in
Figure S3. Consistent with [2], Figure S3 shows that the
fly’s corrective response can be quantitatively captured
without including information about the pitch acceleration. Figure S3 suggests that pitch acceleration is unimportant in determining the flies’ corrective wing kinematics, and thus excludes a PID controller model.

(1999).
[3] T. Beatus, J. M. Guckenheimer, and I. Cohen, Journal of
The Royal Society Interface 12 (2015), ISSN 1742-5689.

