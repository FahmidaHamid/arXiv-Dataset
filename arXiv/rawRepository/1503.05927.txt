arXiv:1503.05927v1 [q-bio.BM] 2 Mar 2015

Correlation function based Gaussian network models
Kelin Xia1 , Kristopher Opron2 and Guo-Wei Wei1,2,3 ∗
1
Department of Mathematics
Michigan State University, MI 48824, USA
2
Department of Biochemistry and Molecular Biology
Michigan State University, MI 48824, USA
3
Department of Electrical and Computer Engineering
Michigan State University, MI 48824, USA
March 23, 2015

Abstract
Gaussian network model (GNM) is one of the most accurate and efficient methods for biomolecular flexibility analysis.
However, the systematic generalization of the GNM has been elusive. We show that the GNM Kirchhoff matrix can
be built from the ideal low-pass filter, which is a special case of a wide class of correlation functions underpinning
the linear scaling flexibility-rigidity index (FRI) method. Based on the mathematical structure of correlation functions,
we propose a unified framework to construct generalized Kirchhoff matrices whose matrix inverse leads to correlation
function based GNMs, whereas, the direct inverse of the diagonal elements gives rise to FRI method. We illustrate
that correlation function based GNMs outperform the original GNM in the B-factor prediction of a set of 364 proteins.
We demonstrate that for any given correlation function, FRI and GNM methods provide essentially identical B-factor
predictions when the scale value in the correlation function is sufficiently large.

Key words: Gaussian network model, Flexibility-rigidity index, Thermal fluctuation

∗ Address

correspondences to Guo-Wei Wei. E-mail:wei@math.msu.edu

1

Under physiological condition, proteins undergo everlasting motions, ranging from atomic thermal fluctuation, sidechain rotation, residue swiveling, to domain swirling. protein
motion strongly correlates with protein functions, including
molecular docking,8 drug binding,1 allosteric signaling,6 self
assembly18 and enzyme catalysis.10 The range of protein
motions in a cellular environment depends on the structure’s
local flexibility, an intrinsic property of a given protein structure. Protein flexibility is reflected by the Debye-Waller or Bfactor, i.e., the atomic mean-square displacement, obtained
in structure determination by x-ray crystallography, NMR, or
single-molecule force experiments.7 However, the B-factor
cannot absolutely quantify flexibility: it also depends the
crystal environment, solvent type, data collection condition
and structural refinement procedure.14, 16
The flexibility of a biomolecule can be assessed by normal mode analysis (NMA),5, 11, 17, 21 elastic network model
(ENM),13, 23 Gaussian network model (GNM),3, 4 anisotropic
network model (ANM),2 graph theory,15 etc. NMA can be
regarded as time-independent molecular dynamics (MD).20
NMA diagonalizes the MD potential to obtain a set of eigenvalues and eigenvectors, where first few eigenvectors predict
the collective, global motions, which are potentially relevant
to biomolecular functionality. NMA with only the elasticity
potential, which is a leading term in the MD potential, was
introduced by Tirion,23 and was extended to the network
setting in ANM.2 Here network refers to the connectivity
between particles regardless of their chemical bonds.9 The
GNM is a highly accurate network based flexibility method.
Although it was originally advocated as an ENM4 and interpreted with the random Gaussian network theory,9 the
GNM is strictly not an elastic model22 — it utilizes a Kirchhoff matrix, rather than the harmonic potential of elasticity.
Additionally, its computational procedure does not directly
invoke the random Gaussian network theory. Due to the
lack of in-depth understanding, there is no rigorous analysis and/or systematic generalization of the GNM in the
literature. Therefore, there is a pressing need to better understand the working principle of the GNM theory, which is
crucial for its further improvement.
A common feature of the aforementioned approaches is
that, they all depend on the mode decomposition of the potential matrix, which typically has the computational complexity of O(N 3 ), where N is the number of elements in the
potential matrix. Yang et al.28 demonstrated that due to its
network setting, the GNM is about one order more efficient
than most other flexibility approaches.
Recently, we have proposed a few mode-decomposition
free methods for flexibility analysis, i.e., molecular nonlinear
dynamics,27 stochastic dynamics26 and flexibility-rigidity index (FRI).19, 25 Among them, the FRI is of O(N 2 ) in computational complexity and has been accelerated to O(N )
without loss of accuracy.19 The essential idea of the FRI
method is to evaluate the rigidity index or the compactness
of the biomolecular (network) packing by the total correlation. Then the flexibility index is defined as the inverse of
the rigidity index. The correlation between any two atoms or

residues is measured through correlation functions. The FRI
can be regarded as a generalization of Halle’s local density
model.12 The FRI method has been shown to be orders of
magnitude more efficient and about ten percent more accurate than the GNM for the B-factor prediction of a set of
365 proteins.19
The objective of the present work is to shed light on the
GNM and FRI methods. Specifically, we reveal that the
ideal low filter used in the GNM Kirchhoff matrix is a special admissible FRI correlation function, which is the limiting case of many commonly used FRI correction functions.
This finding paves the way for understanding the connection between the GNM and FRI methods. Additionally, we
introduce a generalized Kirchhoff matrix to provide a unified starting point for the GNM and FRI methods, which
throws light on the similarity and difference between GNM
and FRI. Moreover, based on this new understanding of the
GNM working principle, we propose infinitely many correlation function based GNM methods. Finally, we unveil that
the FRI and the GNM are asymptotically equivalent when
the cutoff value in the Kirchhoff matrix or the scale value
in the correlation function is sufficiently large. The present
work offers a new strategy for the design and construction
of accurate, efficient and robust methods for biomolecular
flexibility analysis.
To establish notation and facilitate new development, let
us present a brief review of the GNM and FRI methods.
Consider an N -particle coarse-grained representation of a
biomolecule. We denote {ri |ri ∈ R3 , i = 1, 2, · · · , N } the
coordinates of these particles and rij = kri − rj k the Euclidean space distance between ith and jth particles. In
a nutshell, the GNM prediction of the ith B-factor of the
biomolecule can be expressed as3, 4

BiGNM = a Γ−1 ii , ∀i = 1, 2, · · · , N,
(1)
where a is a fitting parameter
that can be related to the

thermal energy and Γ−1 ii is the ith diagonal element of
the matrix inverse of the Kirchhoff matrix,


i 6= j and rij ≤ rc
 −1,
,
(2)
Γij =
0,
i 6= j and rij > rc

 PN
− j,j6=i Γij , i = j
where rc is a cutoff distance.
The
evaluates
the



PN GNM theory
matrix inverse by Γ−1 ii = k=2 λ−1 uk uTk ii , where T
is the transpose and λk and uk are the kth eigenvalue and
eigenvector of Γ, respectively. The summation omits the
first eignmode whose eigenvalue is zero.
The FRI prediction of the ith B-factor of the biomolecule
can be given by19, 25
BiFRI = a PN

j,j6=i

1
wj Φ(rij ; η)

+ b, ∀i = 1, 2, · · · , N,

(3)

where a and b are fitting parameters, fi = PN w1 Φ(r ;η)
j
ij
j,j6=i
PN
is the ith flexibility index and µi = j,j6=i wj Φ(rij ; η) is the
2

Mathematically, the ILF is a special real-valued monotonically decreasing correlation function and also satisfies admissibility conditions (4) and (5). In fact, all FRI correlation
functions are low-pass filters as well. Therefore, both GNM
and FRI admit low-pass filters in their constructions. Indeed, GNM is very special in the sense that there is only
one unique ILF, while, there are infinitely many other lowpass filters. Figure 1 illustrates the behavior and relation of
the above low-pass filters or correlation functions. Clearly,
the ILF is completely localized for any given cutoff value.
In general, generalized exponential function and generalized
Lorentz function are delocalized and the former decays faster
than the latter for a given power. The combination of a low
power value and a large scale gives rise to nonlocal correlations. Our earlier test indicates that υ = 3 and η = 3Å provides a good flexibility analysis for a set of 365 proteins.19
To further bring to light the mathematical foundation of
the GNM and FRI methods, we consider a generalized Kirchhoff matrix26, 27
(
−Φ(rij ; η),
i 6= j
Γij (Φ) =
,
(11)
PN
− j,j6=i Γij (Φ), i = j

Figure 1: Illustration of admissible correlation functions. (a) Correlation functions approach the ILF as κ → ∞ or υ → ∞ at η = 7Å.
(b) Effects of varying scale value η. Local correlation is obtained with
large υ and small η values. Whereas, nonlocal correlation is generated
by small υ and large η values.

ith rigidity index. Here, wj is an atomic number depended
weight function that can be set to wj = 1 for a Cα network, and Φ(rij ; η) is a real-valued monotonically decreasing correlation function satisfying the following admissibility
conditions
Φ(rij ; η)

=

1

as rij → 0

(4)

Φ(rij ; η)

=

0

as rij → ∞,

(5)

where Φ(rij ; η) is an admissible FRI correlation function.
The generalized Kirchhoff matrix includes the Kirchhoff matrix as a special case. It is important to note that each diagonal element is a FRI rigidity index: µi = Γii (Φ). Therefore,
the generalized Kirchhoff matrix provides a unified starting
point for both the FRI and GNM methods. However, the
striking difference between the GNM and FRI methods is
that to predict B-factors, the GNM seeks a matrix inverse of
the Kirchhoff matrix (2), whereas, the FRI takes the direct
inverse of the diagonal elements of the generalized Kirchhoff
matrix (11).
Based on the above analysis, it is straightforward to construct correlation function based GNMs via the matrix inverse of the generalized Kirchhoff matrix (11), which leads
to infinitely many new GNMs, including the original GNM
as a special limiting case. It is also possible to contruct to
construct the FRI by using the Kirchhoff matrix, which gives
rise to a unique FRI. Question arise as what are the relative
performance of these correlation function based GNM and
FRI methods. Another question is whether there is any further relation between these two distinguished approaches.
Specifically, what is the relation between the diagonal elements of the GNM matrix inverse and the FRI direct inverse
of the diagonal elements, for a given generalized Kirchhoff
matrix? To answer these questions, we select two representative correlation functions, i.e., the Lorentz (υ = 3) and ILF
functions to construct the generalized Kirchhoff matrix (11).
The Lorentz function is a typical example for many correlation functions studied in our earlier work.19 In contrast, the
ILF function is an extreme case of FRI correlation functions.
The resulting two generalized Kirchhoff matrices (11) can be
used for calculating the GNM matrix inverse or the inverse
diagonal elements of the FRI matrix. This results in possible combinations or methods, namely, FRI-Lorentz, FRI-ILF,

where η is a scale parameter. Delta sequences of the positive
type24 are good choices. Many radial basis functions are also
admissible.19, 25 Commonly used FRI correlation functions
include the generalized exponential functions
κ

Φ(rij ; η, κ) = e−(rij /η) ,

κ>0

(6)

and generalized Lorentz functions
Φ(rij ; η, υ) =

1
υ,
1 + (rij /η)

υ > 0.

(7)

A major advantage of the FRI method is that it does not
resort to mode decomposition and its computational complexity can be reduced to O(N ) by means of the cell lists
algorithm used in our fast FRI (fFRI).19 In contrast, the
mode decomposition of NMA and GNM has the computational complexity of O(N 3 ).
To further explore the theoretical foundation of GNM, let
us examine the parameter limits of generalized exponential
functions (6) and generalized Lorentz functions (7)
κ

e−(rij /η) → Φ(rij ; rc ) as
1
υ → Φ(rij ; rc ) as
1 + (rij /η)

κ→∞

(8)

υ → ∞,

(9)

where rc = η and Φ(rij ; rc ) is the ideal low-pass filter (ILF)
used in the GNM Kirchhoff matrix
(
1, rij ≤ rc
Φ(rij ; rc ) =
.
(10)
0, rij > rc
Relations (8) and (9) unequivocally connect FRI correlation
functions to the GNM Kirchhoff matrix. It is important to
examine whether the ILF is still a FRI correlation function.
3

Figure 3: PCCs between various B-factors for protein 2Y7L. (a) Correlations between B GNM−ILF and B Exp , between B FRI−ILF and B Exp ,
and between B GNM−ILF and B FRI−ILF ; (b) Correlations between
B GNM−Lorentz and B Exp , between B FRI−Lorentz and B Exp , and between B GNM−Lorentz and B FRI−Lorentz .

Figure 2: Illustration of protein 2Y7L. (a) Structure of protein 2Y7L
having two domains; (b) Correlation map generated by using GNMLorentz indicating two domains; (c) Comparison of experimental Bfactors and those predicted by GNM-Lorentz (η = 16Å); (d) Comparison of experimental B-factors and those predicted by FRI-ILF
(rc = 24Å).

GNM-Lorentz and GNM-ILF. Performances of these methods are carefully analyzed.
To answer the above mentioned questions, we first employ a pathogenic fungus Candida albicans (Protein Data
Bank ID: 2Y7L) with 319 residues as shown in Fig. 2(a) to
explore the aforementioned four methods. We consider the
coarse-grained Cα representation of protein 2Y7L. We denote B GNM−ILF , B FRI−ILF , B GNM−Lorentz and B FRI−Lorentz
respectively the predicted B-factors of GNM-ILF, FRI-ILF,
GNM-Lorentz and FRI-Lorentz methods. The experimental B-factors from X-ray diffraction, B Exp , are employed
for a comparison. The Pearson product-moment correlation coefficient (PCC) is used to measure the strength of
the linear relationship or dependence between each two sets
of B-factors. To evaluate the performance of four methods,
we compute the PCCs between predicted B-factors and experimental B-factors. Since performance of these methods
depends on their parameters, i.e., the cutoff distance (rc ) in
the ILF or the scale value (η) in the Lorentz function, the
theoretical B-factors are computed over a wide range of rc
and η values.
Figure 3 depicts PCCs between various B-factors for protein 2Y7L. As shown in Fig. 3 (a), the cutoff distance rc
of the ILF is varied from 5Å to 64Å. The PCCs between
B GNM−ILF and B Exp , and between B FRI−ILF and B Exp ,
indicate that both GNM-ILF and FRI-ILF are able to provide
accurate predictions of the experimental B-factors. Their
best predictions are attained around rc = 24Å, which is significantly larger than the commonly used GNM cutoff distance of 7-9Å, partially due to the fact that protein 2Y7L is
4

relatively large.
It is interesting to observe that GNM-ILF and FRI-ILF provide essentially identical predictions when the cutoff distance
is equal to or larger than 20Å. This phenomenon indicates
that when the cutoff is sufficiently large, the diagonal elements of the GNM inverse matrix and the direct inverse of
the diagonal elements of the FRI correlation matrix become
linearly dependent. To examine the relation between GNMILF and FRI-ILF, we compute PCCs between B GNM−ILF and
B FRI−ILF over the same range of cutoff distances. As shown
in Fig. 3(a), there is a strong linear dependence between
B GNM−ILF and B FRI−ILF for rc ≥ 10Å. To understand this
dependence at large cutoff distance, we analytically calculate
ith diagonal element of the GNM inverse matrix

1
N −1
→
as N → ∞ (12)
Γ−1 (Φ(rij ; rc → ∞)) ii =
N2
N
and the FRI inverse of the ith diagonal element
1
PN

j,j6=i

Φ(rij ; rc → ∞)

=

1
1
→
as N → ∞. (13)
N −1
N

These results elucidate the strong asymptotic correlation between B GNM−ILF and B FRI−ILF in Fig. 3(a). They also
explain why predictions of the original GNM and FRI-ILF deteriorate as rc is sufficiently large because all the predicted
B-factors become identical, i.e., NN−1
with N = 319.
2
The performance and comparison between GNM-Lorentz
and FRI-Lorentz are illustrated in Fig. 3(b) for the scale
value η from 0.5Å to 64Å. First, it is seen that the GNMLorentz is a successful new approach. In fact, it outperforms
the original GNM for the peak PCCs. A comparison of the
predicted B-factors and the experimental B-factors is plotted in Figs. 2(c) and 2(d) for GNM-Lorentz and FRI-ILF,
respectively. It is seen that B FRI−ILF more closely matches
the experimental B-factors than B GNM−Lorentz does due to
the different fitting schemes employed by two methods as
shown in Eqs. (1) and (3), respectively.
As shown in Fig. 3(b), the predictions from GNM-Lorentz
and FRI-Lorentz become identical as η ≥ 5Å. A strong correlation between B GNM−Lorentz and B FRI−Lorentz is revealed

Additionally, the FRI-Lorentz method is able to attain the
best average prediction for 364 proteins among four methods
as shown in the zoomed in parts in Fig. 4(b). However, for
a given correlation function, the difference between FRI and
GNM predictions is very small.
Moreover, for a given admissible FRI function, GNM and
FRI B-factor predictions are strongly linearly correlated and
reach near 100% correlation when rc > 9Å or η > 0.5Å for
364 proteins as demonstrated in Fig. 4. This finding offers a
solid confirmation of Eq. (14). Therefore, correlation function based GNMs, including the original GNM as a special
case, are indeed equivalent to the corresponding FRI methods in the flexibility analysis for a wide range of commonly
used scale values.
Furthermore, it has been shown that the fast FRI is a
linear scaling method,19 while GNM scales as O(N 3 ) due
to their matrix inverse procedure. As a result, the accumulated CPU times for the B-factor predictions of 364 proteins
at rc = 7 or η = 3 are 0.88, 1.57, 5071.32 and 4934.79
seconds respectively for the FRI-ILF, FRI-Lorentz, GNM-ILF
and GNM-Lorentz. In fact, GNM methods are very fast for
small proteins as well. Most of the accumulated GNM CPU
times are due to the computation of three largest proteins
(i.e., 1F8R, 1H6V and 1QKI) in the test set.
It is worth mentioning that that the earlier FRI rigidity
index includes the contribution from the self correlation,
i.e., the diagonal term.19, 25 The present findings do not
change if the summation in the generalized Kirchhoff matrix (11) is modified to include the diagonal term and then
the calculation of GNM matrix inverse is modified to
 include the contribution from first eigen mode, i.e., Γ−1 ii =


PN
−1
uk uTk ii . In fact, this modification makes the
k=1 λ
generalized Kirchhoff matrix less singular and fast converging.
This work was supported in part by NSF grants IIS-1302285,
and DMS-1160352, and NIH Grant R01GM-090208. The
authors thank Jianyu Chen and Michael Feig for useful discussions and acknowledge the Mathematical Biosciences Institute for hosting valuable workshops.
References

Figure 4: PCCs between various B-factors averaged over 364 proteins.
(a) Correlations between B GNM−ILF and B Exp , between B FRI−ILF
and B Exp , and between B GNM−ILF and B FRI−ILF ; (b) Correlations
between B GNM−Lorentz and B Exp , between B FRI−Lorentz and B Exp ,
and between B GNM−Lorentz and B FRI−Lorentz .

at an even smaller scale value. This behavior leads us to
speculate a general relation

c
, η → ∞, (14)
Γ−1 (Φ(rij ; η)) ii −→ PN
j,j6=i Φ(rij ; η)
where c is a constant. Relation (14) means that the correlation function based GNM is equivalent to the FRI for a given
admissible correlation function when the scale parameter is
sufficiently large. This relation is certainly true for the ILF
as analytically proved in Eqs. (12) and (13). Relation (14)
is a very interesting and powerful result not only for sake
of understanding GNM and FRI methods, but also for the
design of accurate and efficient new methods.
It remains to prove that the above findings from a single protein are translatable and verifiable to a large class
of biomolecules. To this end, we consider a set of 364 proteins, which is a subset of the 365 proteins utilized and documented in our earlier work.19 The omitted protein is 1AGN,
which has been found to have unrealistic experimental Bfactors. We carry out systematic studies of four methods
over a rang of cutoff distances or scale values. For each
given rc or η, the PCCs between two sets of B-factors are
averaged over 364 proteins. Figure 4 illustrates our results.
Figure 4(a) plots the results of the ILF implemented in both
GNM and FRI methods with the cutoff distance varied from
4Å to 23Å. Figure 4(b) depicts similar results obtained by using the Lorentz function implemented in two methods. The
scale value is explored over the range of 0.5Å to 10Å.
First, the proposed new method, GNM-Lorentz, is very
successful for the B-factor prediction of 364 proteins as shown
in Fig. 4(b). The best GNM-Lorentz prediction is about
10.7% better than that of the original GNM shown in Fig.
4(a). In fact, GNM-Lorentz outperforms the original GNM
over a wide range of parameters for this set of proteins, which
indicates that the proposed generalization is practically valuable. Similarly, FRI-Lorentz is also about 10% more accurate than FRI-ILF in the B-factor prediction. Since the ILF
is a special case and there are infinitely many FRI correlation functions, there is a wide variety of correlation function
based GNMs that are expected to deliver more accurate flexibility analysis than the original GNM does.

[1] Daniel Alvarez-Garcia and Xavier Barril. Journal of Chemical
Theory and Computation, 10(6):2608–2614, 2014.
[2] A. R. Atilgan, S. R. Durrell, R. L. Jernigan, M. C. Demirel,
O. Keskin, and I. Bahar. Biophys. J., 80:505 – 515, 2001.
[3] I. Bahar, A. R. Atilgan, M. C. Demirel, and B. Erman. Phys.
Rev. Lett, 80:2733 – 2736, 1998.
[4] I. Bahar, A. R. Atilgan, and B. Erman. Folding and Design,
2:173 – 181, 1997.
[5] B. R. Brooks, R. E. Bruccoleri, B. D. Olafson, D.J. States,
S. Swaminathan, and M. Karplus. J. Comput. Chem.,
4:187–217, 1983.
[6] Z. Bu and D. J. Callaway. Advances in Protein Chemistry
and Structural Biology, 83:163–221, 2011.
[7] O. K. Dudko, G. Hummer, and A. Szabo. Phys. Rev. Lett.,
96:108101, 2006.
[8] Marcus Fischer, Ryan G. Coleman, James S. Fraser, and
Brian K. Shoichet. Nature Chemistry, 6:575–583, 2014.

5

[9] P. J. Flory. Proc. Roy. Soc. Lond. A,, 351:351 – 378, 1976.
[10] M. W. Fraser, J. S.and Clarkson, S. C. Degnan, R. Erion,
D. Kern, and T. Alber. Nature, 462:669–673, 2009.
[11] N. Go, T. Noguti, and T. Nishikawa. Proc. Natl. Acad. Sci.,
80:3696 – 3700, 1983.
[12] B. Halle. PNAS, 99:1274–1279, 2002.
[13] K. Hinsen. Proteins, 33:417 – 429, 1998.
[14] K. Hinsen. Bioinformatics, 24:521 – 528, 2008.
[15] D. J. Jacobs, A. J. Rader, L. A. Kuhn, and M. F. Thorpe.
Proteins-Structure, Function, and Genetics, 44(2):150–165,
AUG 1 2001.
[16] D. A. Kondrashov, A. W. Van Wynsberghe, R. M. Bannen,
Q. Cui, and Jr. G. N. Phillips. Structure, 15:169 – 177,
2007.
[17] M. Levitt, C. Sander, and P. S. Stern.
181(3):423 – 447, 1985.

J. Mol. Biol.,

[18] J. A. Marsh and S. A. Teichmann.
12(5):e1001870, 2014.

PLoS Biol,

[19] K. Opron, K. L. Xia, and G. W. Wei. Journal of Chemical
Physics, 140:234105, 2014.
[20] J. K. Park, Robert Jernigan, and Zhijun Wu. Bulletin of
Mathematical Biology, 75:124 –160, 2013.
[21] M. Tasumi, H. Takenchi, S. Ataka, A. M. Dwidedi, and
S. Krimm. Biopolymers, 21:711 – 714, 1982.
[22] M. F. Thorpe. Physical Biology, 4:60–63, 2007.
[23] M. M. Tirion. atomic analysis. Phys. Rev. Lett., 77:1905 –
1908, 1996.
[24] G. W. Wei. Journal of Physics A: Mathematical and General,
33:8577 – 8596, 2000.
[25] K. L. Xia, K. Opron, and G. W. Wei. Journal of Chemical
Physics, 139:194109, 2013.
[26] K. L. Xia and G. W. Wei. Physical Review E, 88:062709,
2013.
[27] K. L. Xia and G. W. Wei. submitted to Journal of Computational Physics, 2013.
[28] L. W. Yang and C. P. Chng. Bioinformatics and Biology
Insights, 2:25 – 45, 2008.

6

