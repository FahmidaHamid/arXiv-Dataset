arXiv:1501.05836v1 [q-bio.NC] 23 Jan 2015

Consolidating a Link Centered Neural
Connectivity Framework with Directed Transfer
Function Asymptotics
Luiz A. Baccalá

Daniel Y. Takahashi

Koichi Sameshima

January 26, 2015
Abstract
We present a unified mathematical derivation of the asymptotic behaviour of three of the main forms of directed transfer function (DTF)
complementing recent partial directed coherence (PDC) results [3]. Based
on these results and numerical examples we argue for a new directed ‘link’
centered neural connectivity framework to replace the widespread correlation based effective/functional network concepts so that directed network
influences between structures become classified as to whether links are
active in a direct or in an indirect way thereby leading to the new notions
of Granger connectivity and Granger influenciability which are more descriptive than speaking of Granger causality alone.

1

Introduction

Introduced as a frequency domain characterization of the interaction between
multiple neural structures directed transfer function (DTF) [16] can be thought
as a factor in the coherence between pairs of observed time series [5]. A historical
perspective on DTF by their authors can be found in [17] together with its many
variants.
On a par with it, stands partial directed coherence (PDC) [5] as its dual measure. The chief distinction between them is that PDC captures active immediate
directional coupling between structures whereas DTF, in general, portrays the
existence of directional signal propagation even if it is only indirect, by going
through intermediate structures rather through immediate direct causal influence [6]. DTF, therefore, represents signal ‘reachability’ in a graph theoretical
sense whereas PDC is akin to an adjacency matrix description [13].
Since DTF’s introduction, we examined two of its closely related variants
(a) directed coherence (DC) [2] which is DTF’s scale invariant form (and dual
to generalized PDC (gPDC)[8]) and (b) information DTF (ιDTF) which is an
information theoretic generalization of DTF, dual to information PDC (ιPDC),
both of which provide accurate size effect information [26, 27, 28].

1

In this paper, we derive and illustrate inference results for the above DTF
variants from a unified perspective closely paralleling the inference results in
[3] and further illustrated in [22] for PDC and its variants. The importance of
accurate asymptotics for DTF is that jointly DTF and PDC allow extending
the current paradigm of effective/function connectivity to a more general and
informative context [7].
After briefly reviewing DTF’s formulations (Sec. 2) together with a summary
of the unified asymptotic results (Sec. 3), numerical illustrations (Sec. 4) discuss
some implications of the results as further elaborated in Sec. 5 with their
implications for the new connectivity analysis paradigm we proposed in [7].
For reader convenience, mathematical details are left to the Appendix whose
implementation is to appear in the next release of the AsympPDC package [3].

2

Background

The departure point for defining all DTF related variants is an adequately fitted
multivariate autoregressive time series (i.e. vector time series) model to which
a multivariate signal x(n) made up by xk (n), k = 1, . . . , K simultaneously
acquired time series conforms to
x(n) =

p
X

A(l)x(n − l) + w(n),

(1)

l=1

where w(n) stands for a zero mean white innovations process of with Σw =
[σij ] as its covariance matrix and p is the model order. The aij (l) coefficients
composing each A(l) matrix describe the lagged effect of the j-th on the i-th
series, wherefrom one can also define a frequency domain representation of (1)
via the Ā(f ) matrix whose entries are given by

p
P

 1−
aij (l)e−j2πλl , if i = j

l=1
Āij (λ) =
(2)
p
P


aij (l)e−j2πλl , otherwise
 −
l=1

where j =

√

−1, so that one may define
H(λ) = Ā−1 (λ)

(3)

with Hij (λ) entries and rows denoted hi . This leads to a general expression
γij (λ) = p

s H̄ij (λ)
hH
i (λ)Shi (λ)

(4)

summarizing all the forms of DTF form j to i considered herein. The superscript
H
denotes the usual Hermitian transpose. The reader should be forewarned to
use the adequate expression for s and S to obtain each DTF variant in (4) using
Table 1.

2

Table 1: Defining variables according to DTF type in (4)
variable

3

DTF

DC

ιDTF

1/2

1/2

s

1

σii

σii

S

IK

(IK  Σw )

Σw

Result Overview

The statistical behaviour of (4) in terms of the number of times series data
points (ns ) can be approximated invoking the delta method [30] consisting of an
appropriate Taylor expansion of the statistics, leading, under mild assumptions,
to the following results:

3.1

Confidence Intervals

In most applications, because ns is large, usually only the first Taylor derivative
suffices. In the present context, parameter asymptotic normality implies that
DTF’s point estimate will also be asymptotically normal, i.e.
√

2

2

d

ns (|b
γij (λ)| − |γij (λ)| ) → N (0, γ 2 (λ)),

(5)

where γ 2 (λ) is a frequency dependent variance whose full disclosure requires the
introduction of further notation and is postponed to the Appendix.

3.2

Null Hypothesis Test

Under the null hypothesis,
2

H0 : |γij (λ)| = 0

(6)

γ 2 (λ) vanishes identically so that (5) no longer applies and the next Taylor term
becomes necessary [24]. The next expansion term is quadratic in the parameter
vector and corresponds to one half of DTF’s Hessian at the point of interest
with an O(n−1
s ) dependence.
The resulting distribution is that of a sum of at most two properly weighted
independent χ21 variables where the weights depend on frequency. Explicit computation is left to the Appendix given the need of specialized notation, but can
be summarized as
2
ns (hH
γij (λ)|
i (λ)Shi (λ))(|b

2

d

− |γij (λ)| ) →

q
X

lk (λ)χ21

(7)

k=1

where lk (λ) are at most two frequency dependent eigenvalues (q ≤ 2) coming
from a matrix that depends on DTF’s values. Note that implicit dependence

3

also comes from the left side of (7) on DTF’s denominator. See further details
in Proposition 2. Brief comments and explicit computational methods relating
sums of χ21 variables may be found in [20], [14] and [25].
These results closely parallel PDC ones in [3], the main difference lying in
how the frequency dependent covariance of the parameter vectors are computed.

4

Numerical Illustrations

In the examples that follow dashed lines indicate threshold values and gray
shades stand for point confidence intervals around significant points. Unless
stated otherwise, innovations noise is zero mean, unit variance and mutually
uncorrelated. The frequency domain graphs are displayed in the standard form
of an array where grayed diagonal panels contain the estimated time series power
spectra.
Example 1 Consider the connectivity from x1 → x2 whose dynamics is represented by an oscillator which influences another structure without feedback:
√
x1 (n) = 0.95 2x1 (n − 1) − 0.9025x1 (n − 2) + w1 (n)
x2 (n)

= −0.5x1 (n − 1) + 0.5x2 (n − 1) + w2 (n)

(8)

As in all bivariate cases, DTF and PDC coincide numerically, yet because
DTF computation requires actual matrix inversion in the general case, its null
hypothesis threshold limits are affected by the spectra (top panel in Fig. 1) (the
x1 (n) in this case) casting decision doubts at ns = 50 points (mid panel) as
opposed to the PDC case (bottom panel).
At ns = 500, DTF is above threshold for x1 → x2 throughout the frequency
interval (Fig. 2). Further comparison is provided in Fig. 3a where the actually
observed DTF values for ns = 50 are more spread than those in Fig. 3b for
ns = 500. In the x2 → x1 direction, (7) behaviour is readily confirmed.
Even though bivariate DTF and PDC numerically coincide, the need to take
into account Ā(λ) inversion under the DTF’s null hypothesis can lead to overly
conservative thresholds and consequent failure to properly reject H0 if ns is small
as in Fig. 1.
Example 2 This example shows an oscillator x1 (n) whose influence travels
back to itself through a loop containing the x2 (n) → x3 (n) link in the feedback
loop pathway (Fig. 4) and whose dynamics follows:
√
x1 (n) = 0.95 2x1 (n − 1) − 0.9025x1 (n − 2)
+0.35x3 (n − 1) + w1 (n)
x2 (n)

=

0.5x1 (n − 1) + 0.5x2 (n − 1) + w2 (n)

x3 (n)

=

x2 (n − 1) − 0.5x3 (n − 1) + w3 (n)

4

(9)

Spectra [a.u.]

x1

1

0

x2

1

0

0

.5

0

.5

Frequency(l )
1

2

2

1

|DTF| 2

0.5
2
1
0

0

.5

1

0
0

2

.5

2

1

0.4

|PDC| 2

1

0

0

.5

0
0

Frequency(l )

.5

Figure 1: Comparison between DTF (middle row) and PDC (bottom row) for
Ex. 1 showing the effect of the existing resonance (time series spectra top row)
on threshold decision levels (dashed curves) using ns = 50 simulated data points.
The effect of increasing ns can be appreciated in Fig. 2. Gray shades describe
95% confidence levels when above threshold.

5

1

2

0.1

2

1

|DTF| 2

1

0
0

0
0

.5

1

.5

|PDC| 2

0.1

0

0

.5

0
0

Frequency(l )

.5

Figure 2: For ns = 500 a DTF single trial realization is safely above threshold compare it to using ns = 50 in Fig. 1 (middle panel row). Gray shades describe
95% confidence levels when above threshold.

6

a

ns = 50
.999
.990
.950

.990

.250

.950

.050
.010
0.4

0.6

.750
.500
.001
0

0.8

|DT F ( l=.15)| 2

b

1
Normal quantile

1

.999

.750

.001

2

Weighted chi-square quantile

2

ns = 500

2

.999
.990
.950

Weighted chi-square quantile

Normal quantile

1

0.1

0.2

0.3

|DT F ( l=.15)| 2
2

0.4

1

.999

.750

.990

.250

.950

.050
.010
.001
0.75

0.8

0.85

|DT F ( l=.15)| 2

0.9

.750
.500
.001

0

0.005 0.01 0.015 0.02

|DT F ( l=.15)| 2

Figure 3: Quantile distribution behaviour showing the distribution goodness of
fit improvement as with sample size for Ex. 1 (ns = 50 (a) versus ns = 500
(b)). Statistical spread decrease in the non-existing link x2 → x1 is evident as
the improved normal fit of the x1 → x2 existing connection. For each value of
ns , m = 2000 simulations were performed.

7

with the covariance matrix of w given by

1
5
Σw =  5 100
0.3 2


0.3
2 ,
1

(10)

ensuring that x2 (n) contributes a large amount of innovation power to the loop.
Because ιDTF deals well with unbalanced innovations, it was used with ns =
500 (Fig. 5) and ns = 2000 (Fig. 6) points leading to the following features: (a)
the large |ιDTFi2 |2 above 1 for some frequencies are due to the large innovations
associated with x2 (n) in (10); (b) except for low ιDTF values that require more
points for reliable estimation, calculations confirm that signals originating at
any structure reach all other structures; and (c) because of the much smaller
relative power originating from x3 (n), its influence is much harder to detect.
The allied ιPDC, also shown, confirms which immediate links are directionally
active even for ns = 500.
It is interesting to observe that |ιDTF23 |2 has a peak around the x1 resonance frequency which manifests itself because the innovations originating in x3
(w3 (n)) are filtered by passing through the resonant filter represented by structure x1 before reaching x2 . This same type of influence is not so readily apparent
(clear only at ns = 2000) in |ιDTF13 |2 because the power contributed by x3 is
small with respect to that of other sources reaching x1 around that same resonant
frequency.
The sharp jump in |ιDTF32 |2 is a byproduct of the fast phase shift that takes
place around x1 ’s resonance as x2 ’s signal travels through it to reach x3 .
A glimpse of the ensemble ιDTF’s behaviour can be appreciated in Fig. 7
showing how difficult it is to detect it if its values are low.

2
1
3
Figure 4: Ex 2 loop connectivity structure. Signals from any structure reach all
other structures.
Example 3 The next example comes from [5], whose direct connections are

8

a

1

0.1

0

0

1

1

0.1

Spectra [a.u.]

0

i =2

| iDTF| 2

i =1

1

0

0

0

1

1

i =3

1

0

j =1

0
.5 0

j =2

0
.5 0

Frequency(l)

1

0.1

0

0

0

1

1

.01

j =3

.5

1

Spectra [a.u.]

i =2
0

0

0

0.1

1

1

i =3

|iPDC| 2

i =1

b

0

0

0

j =1

0
.5 0

j =2

0
.5 0

Frequency(l)

j =3

.5

Figure 5: Ex. 2 information ιDTF more widely spread results (a) contrasted
to ιPDC (b) results for ns = 500 and α = 0.05. Time series spectra are displayed along the main panel diagonal (gray backgrounds). Sources are marked
j (columns) and targets i (rows).

9

a

0.1

i =1

1

0

0
0.1

i =2

|iDTF|

2

1

0

0
0

1

.5

i =3

1

0

0

j =1

b

.5

0
0

j =2

.5

j =3

Frequency(l)
1

i =1

0.01

0

0
0.01

i =2

|iPDC|

2

1

0

0
0

1

.5

i =3

0.01

0
0

j =1

0
.5 0

j =2

.5

Frequency(l)

j =3

Figure 6: Improvement of connectivity estimates under ns = 2000 over Fig. 5
single trial behaviour using ιDTF (a) and ιPDC (b). Time series spectra are
omitted but can be appreciated from Fig. 5. Sources are marked j and targets
i.

10

a

ns = 500
2

Weighted chi-square quantile

Normal quantile

1
.999
.990
.950

2

.999

.750

.990

.250

.950

.050
.010

.750
.500
.001

.001
1

2

3

4

|i DT F ( l=.25)| 2

b

1

5

-3

x 10

.999
.990
.950
.750
.250
.050
.010
.001
1

1.5

2

0

0.01

2.0

|iDT F ( l=.25)| 2

3

-3

x 10

0.02

|i DT F ( l=.25)| 2

ns = 2000

2

Weighted chi-square quantile

0

Normal quantile

3

3

0.03

2

.999

.990
.950
.750
.500
.001

0

2

4

|iDT F ( l=.25)| 2

6

-3

x 10

Figure 7: Ex. 2 ιDTF quantile behaviour at λ = 0.25 for m = 2000 simulations
using ns = 500 (a) and ns = 2000 (b) data points.

11

contained in Fig. 8 and are dynamically described by:
√
x1 (n) = 0.95 2x1 (n − 1) − 0.9025x1 (n − 2)
+0.5x5 (n − 2) + w1 (n)
x2 (n)

= −0.5x1 (n − 1) + w2 (n)

x3 (n)

=

x4 (n)

= −0.5x3 (n − 1) + 0.25 2x4 (n − 1)
√
+0.25 2x5 (n − 1) + w4 (n)
√
√
= −0.25 2x4 (n − 1) + 0.25 2x5 (n − 1) + w5 (n)

x5 (n)

0.4x2 (n − 2) + w3 (n)

(11)

√

At first sight, signal pathways exist between all structures, i.e. a signal originating at any structure can reach all other structures. Note how difficult it is
to pinpoint the x2 onto x1 influence even at ns = 2000 (Fig. 9) throughout the
frequency domain interval.
The dynamic system (11) was nonetheless designed to have zero influence
at some frequencies as can be appreciated by the dip taken by |ιDTF45 |2 whose
x5 → x4 influence cannot be detected at its minimum even at ns = 2000 (λ =
0.15).

2
1

4

3

5

Figure 8: Connectivity diagram for Ex. 3 showing that a signal traveling from
any structure can reach any other structure.
Example 4 This last example refers to the connectivity represented in Fig. 10
and behaves dynamically according to
x1 (n)

=

√
0.95 2x1 (n − 1) − 0.9025x1 (n − 2)
+0.35x2 (n − 1) + w1 (n)

x2 (n)

=

0.5x1 (n − 1) + 0.5x2 (n − 1) + w2 (n)

x3 (n)

=

x2 (n − 1) − 0.5x3 (n − 1) + w3 (n)

(12)

whose DTF single trial behaviour can be appreciated in Fig. 11a and b for
ns = 50 and ns = 500 respectively, while Fig. 12 sums up its ensemble behaviour
between x1 and x3 .
12

1

i=1

.04

0
1

i=3

0

.08

.3

0
1

0
.1

.3

0

0

.04

.2

0
1

.3

0

0

.03

.1

0
.3

0
1

0

.1

0
.6
0

i=5

0

0

.6

.4
0

0

.04

Spectra [a.u.]

.6
0

i=4

| iDTF| 2

i=2

0

.3

.1

.01

0

j=1

0
.5 0

j=2

0
.5 0

j=3

0
.5 0

Frequency(l)

0

j=4

0
.5 0

j=5

.5

Figure 9: Single trial ιDTF results for the dynamic connectivity (ns = 2000,
α = 0.01) in Ex. 3. Time series spectra are displayed along the main panel
diagonal (gray backgrounds). Note that ιDTF is significant for all pairs (except
at some frequencies) confirming that signals from any structures can reach all
others. Sources are marked j and targets i.

13

In this case, there is no x3 influence on other time series, even though detection is more difficult at ns = 50 (Fig. 11) highlighting the importance of a
sufficiently large sample even for such very simple dynamics. This is confirmed
by the point quantile distributions in Fig. 12a (x1 → x3 ) which are somewhat
far from the theoretical asymptotic limit, being not yet quite normal compared
to the Fig. 12b (x1 → x3 ) case.

2
1
3
Figure 10: Connectivity diagram between all structures for Ex. 4. Signals from
x3 do not reach the other structures.

5

Discussion

The present unified asymptotics for the DTF forms, introduced respectively in
[16], [2] and [27], parallel the recent PDC developments in [3] and [22], confirm
early DTF
[16] threshold results [9] and provide estimator confidence intervals and thus
pave the way for developing rigorous size effect comparisons using ιDTF and
ιPDC under different experimental conditions.
The allied PDCs presented here should not be confused with the purpose of
many recent papers [31, 11, 10, 15] that compare connectivity techniques, DTF
and PDC among them.
Because many researchers often do not quite realize the conceptual differences between DTF and PDC, this is a good time to stress that they intrinsically measure different aspects of the connectivity between neural structures and
neither is conceptually better than the other [15], complementary description
aspects emerge when more than just two structures are simultaneously examined. This is clear from Ex. 2 whose loop allows signals from any structures
to reach all others - as illustrated by DTF’s null hypothesis rejection between
all structures at least for some frequencies. By contrast PDC shows the overall
direction signals travel within the loop of Ex. 2 by exposing the directional
relationship between adjacent structures.
Furthermore, it is also interesting to realize (Ex. 3) that it is entirely possible
to have nonzero PDC between pairs of structures and zero DTF between them

14

a

ns = 50
1

1

0

0

0

1

1

1

Spectra [a.u.]

i=2

| DTF | 2

i=1

1

0

0

0

1

1

i=3

1

0
0

b

j=1

0
.5 0

j=2

0
.5 0

Frequency(l)

j=3

.5

ns = 500
1

1

0

0

0

1

1

1

0

0

0

1

1

1

Spectra [a.u.]

i =2
i =3

| DTF | 2

i =1

1

0
0

j =1

0
.5 0

j =2

0
.5 0

Frequency(l)

j =3

.5

Figure 11: Single trial DTF results for Ex. 4 with ns = 50 (a) and ns = 500 (b),
using α = 0.01, reflecting the difficulty of inference if ns is low. Gray shades
indicate 99% confidence level for above threshold |DTF|2 .

15

a
1

3

Normal quantile

.999
.990
.950
.750
.250
.050
.010
.001

0

0.1

0.2

0.3
2

0.4

Weighted chi-square quantile

ns = 50
3
.999

.990
.950
.750
.500
.001

0

|DTF(l=.1)|

b

1

0.05

0.1

|DTF(l=.1)|

2

0.15

ns = 500
3

3
Weighted chi-square quantile

1
.999

Normal quantile

.990
.950
.750
.250
.050
.010
.001
0

0.05

0.1

|DTF(l=.1)|

2

0.15

1

.999

.990
.950
.750
.500
.001
0

0.005

0.01
2

|DTF(l=.1)|

Figure 12: Quantile DTF behaviour for Ex. 4 showing that under ns = 50
the asymptotic normality for the existing link x1 → x3 is not yet reached (a)
as opposed to (b) for ns = 500, using m = 2000 simulations in each case.
Reasonable fit for the nonexisting reverse connection is observed for both ns
values.

16

as happens for DTF from x5 to x4 in this case in the neighbourhood of the
network resonant frequency.
Another DTF contribution as to network description is very well illustrated
by the large intrinsic variance of w2 (x2 in Ex. 2) ensuring that its influence is
comparatively larger upon the other structures; its shape even (see |ιDTF32 |2
in Fig. 9a) reflects how its originating signal is filtered while traveling through
multiple structures. PDC’s descriptive interpretations of the direct immediate
link between structures can be further examined in [22].
This newly available objective possibility of performing rigorous hypothesis
testing for both DTF and PDC opens up an interesting opportunity in describing neural connectivity. Until now most connectivity has been discussed as
either being ‘effective’ and/or ‘functional’, terms coined by [1] and which found
widespread employment in functional neuroimaging [12] becoming cornerstone
descriptive goals for the recent Connectome effort (see www.connectome.org and
[21]).
The popularity of ‘effective’ and ‘functional’ concepts is in line with dynamical network structure descriptions that employ correlation, an undirected
quantity that leads to undirected network graphs [29] that stems exactly from
the traditional availability of rigorous means for quantifying its statistical reliability even in the light of evidence that its pairwise nature can lead to difficulties
in accurate structural description [4].
Furthermore, the effective/functional terminology is confusing: the ‘effective’
term is reserved for situations when dynamical models of some kind are used for
network portrayal whereas ‘functional’ usually refers to perceived statistically
significant commonalities (correlations) of dynamical behaviour without special
reliance on models. The confusion stems from the possibility of functional connectivity even without effective connectivity as when signal pairs covary under
the spell of common hidden stimuli and no conceivable anatomical links between
them.
Through their complementary vistas on connectivity we have proposed a new
“link” centered framework for network connectivity description [7] with PDC
describing the immediate direct links between structures and DTF portraying
how one structure ultimately influences another. In this new framework, directed links (as opposed to undirected ones as provided by correlation) are the
central objects of interest. Links now can be classified according to their state –
a directed link is in the direct-active state when PDC 6= 0, in the indirect-active
state if PDC = 0 and DTF 6= 0, is direct-inactive for PDC = 0 and indirectinactive when DTF = 0 as proposed in [23] with the present asymptotics for
DTF and PDC [3] – affording the necessary operational state identification tools.
Finally, Granger causality (GC), also popular in neural connectivity descriptions, has had conflicting defenses as to whether DTF or PDC, or even other
quantities, represent it in the frequency domain. Part of the confusion stems
from PDC’s immediate mirror of the Wald type likelihood ratio tests described
as GC tests by [19]. Because DTF and PDC indistinguishbly reflect GC in
the K = 2 time series case, but differentiate into distinct network descriptions
for K > 2, it may worth be developing new terminology to match this dif17

ferentiation. Within the present link centered framework, we propose to split
GC into the complementary views of Granger ‘connectivity’ in association with
PDC (graph adjacency) and Granger ‘influenciability’ in connection with ‘DTF’
(graph reachability) both now possessing proper rigorous statistical quantification. Our present introduction of G-connectivity to describe immediate structural active connections between structures as opposed to possibly long range
influences (G-influenciability) has the intention of standardizing nomenclature
and of organizing ideas in our newly proposed paradigm that emphasizes links
rover structures as the latter must be significantly active in the first place for
the meaningful analysis of their interplay to produce neural function.

Appendix
A

Propositions

To obtain the results in Sec. 3, specialized notation is needed. The first step
is to represent the (3) as vector of real variables by means of the vec column
stacking operator:
h̄(λ) = vec H(λ)

(A.1)

and whose associate real vector can be obtained by noting that




Re(h̄(λ))
h̄(λ)
h(λ) =
=T
Im(h̄(λ))
h̄∗ (λ)
where

∗

(A.2)

denotes complex conjugation and


1 1 1
⊗ IK 2
T =
2 −j j

(A.3)

√
for j = −1.
Also let
σ = vec Σw .

(A.4)
T

Together (A.1) and (A.4) can be combined in the parameter vector θ (λ) =
[hT (λ) σ T ]T so that the problem of computing DTF, in all its forms, can be
reduced to that of computing a ratio of quadratic forms
|γij (λ)|2 =

hT (λ)Icij S n (σ)Icij h(λ)
,
hT (λ)Ici S d (σ)Ici h(λ)

(A.5)

by employing the definitions
Icij =



Iij
0

18

0
Iij


(A.6)

and
Ici =



Ii
0


0
,
Ii

(A.7)

where
1. Iij whose entries are zero except for indices of the form (l, m) = ((j −
1)K + i, (j − 1)K + i), which equal 1 whose purpose is to choose the i, j-th
element of interest, while
2. Ii is nonzero only for entries whose indices are of the form (l, m) : l =
m = K(r − 1) + i, 1 ≤ r ≤ K, and chooses the i-th row of interest from
the original (3) matrix,
with S n (σ) and S d (σ) which do not depend on λ and take on different values
according to the DTF form under consideration as listed in Table 1.
The proof of (A.5) is immediate and follows of by direct substitution.

A.1

Main Asymptotic Results

The chief basic result is the delta method [30] which rests on the continuous
mapping nature of the parameters onto the statistics of interest in terms of ns
and the Taylor expansion of the mapping. It is worth summing its content as:
Theorem 1 If the distribution of vn = (v1 , . . . , vk )T estimated from n observations converges in distribution as
√
d
n(vn − µ) → N (0, Σv ).
(A.8)
Let g(v) be a real-valued function with continuous partials of order m > 1 in
the neighborhood of v = µ, with all the partials of order j with 1 ≤ j ≤ m − 1
vanishing at v = µ and non-vanishing m-th order partials at v = µ. Then
k
X
√
d 1
( n)m (ĝ(vn ) − g(µ)) →
...
m! i =1
1

k
X
im


m
Y

∂mg

Zi ,
∂xi1 . . . ∂xim x=µv j=1 j
=1

(A.9)

with
Z = (Z1 , . . . , Zk )T ∼ N (0, Σv ),

(A.10)

wherefrom one can readily deduce the following consequence for large n and non
null first derivatives in (A.9):
Corollary 1 For a real differentiable function g(v) asymptotically distributed
as in (A.8) then
√
d
n(ĝ(vn ) − g(µ)) → N (0, gT Σv g)
(A.11)
is the first delta method approximation where g = ∇v g is the gradient of g(v)
computed at µ [24].
19

Remark 1 Though defined for a scalar function of a vector the results from
Corollary 1 remain valid for a vector function where g then equals the Jacobian
of the transformation rather than the gradient see p. 26 Sec. 3.1 in [30].

A.2

Asymptotic θ Behaviour

Proposition 1 The asymptotic properties of θ’s are given by
√
d
ns (θ̂ − θ) → N (0, Ωθ )
where


Ωh
Ωθ =
0

0
Ωσ

(A.12)


(A.13)

with
Ωh (λ) = H(λ)C(λ)ΩC T (λ)HT (λ)

(A.14)

for

Re(HT (λ) ⊗ H(λ)) −Im(HT (λ) ⊗ H(λ))
H(λ) = −
Im(HT (λ) ⊗ H(λ)) Re(HT (λ) ⊗ H(λ))


and


Ω=

Ωα
Ωα


Ωα
,
Ωα

(A.15)

(A.16)

where Ωα is the covariance matrix of
α = vec[A(1) A(2) . . . A(p)]

(A.17)

T
given by Ωα = Γ−1
x ⊗ Σw , where Γx = E[x̄(n)x̄ (n)] for

x̄(n) = [x1 (n) . . . xK (n) . . .
x1 (n − p + 1) . . . xK (n − p + 1)]T ;

(A.18)

and
+T T
Ωσ = 2DK D+
K (Σw ⊗ Σw )DK DK

(A.19)

D+
K

with
standing for the Moore-Penrose pseudo-inverse of the standard duplication matrix [19] and


C(λ)
C(λ) =
,
(A.20)
−S(λ)
whose blocks are K 2 × pK 2 dimensional of the form
C(λ) = [C1 (λ) . . . Cp (λ)]

(A.21)

S(λ) = [S1 (λ) . . . Sp (λ)],

(A.22)

Cr (λ) = diag([cos(2πrλ) . . . cos(2πrλ)])

(A.23)

Sr (λ) = diag([sin(2πrλ) . . . sin(2πrλ)]).

(A.24)

and
for
and

20

Table 2: Defining variables according to DTF type in (A.5)

variable

DTF

DC

ιDTF

Sn
Sd

I2K 2
I2K 2

I2 ⊗ (IK  Σw ) ⊗ IK
I2 ⊗ (IK  Σw ) ⊗ IK

I2 ⊗ (IK  Σw ) ⊗ IK
I2 ⊗ Σw ⊗ IK

Proof
The proof follows by noting that h(λ) is a function of a(λ) given by


 
vec(Re(Ā(λ)))
vec(IpK 2 )
− C(λ)α
a(λ) =
=
0
vec(Im(Ā(λ)))

(A.25)

whose covariance matrix is given by (A.16) and is asymptotically independent
from σ whose covariance is (A.19) as shown in [3].
To obtain Ωh , first note that the gradient of h̄ in (A.1) can be obtained from
∇ā h̄ = −HT ⊗ H

(A.26)

omitting the explicit λ dependence to simplify notation, in view of (3) in Eq.
(1) from See Sec. 10.6, p. 198 in [18].
By writing

 
 
∇ā h̄
−HT ⊗ H
0
ā
=
(A.27)
∇ā h̄∗
0
−(HT ⊗ H)∗ ā∗
and multiplying by T defined in (A.2) leads to


−HT ⊗ H
0
∇a h = T
T −1 = H
0
−(HT ⊗ H)∗

(A.28)

Therefore the result of Remark 1 implies (A.14) and this completes the proof.


A.3

Confidence Interval Theorem

Proposition 2 Omitting the explicit frequency λ and σ dependencies to simplify notation, the confidence interval results
√

2

2

d

ns (|b
γij | − |γij | ) → N (0, γ 2 ),

(A.29)

where ns is the number of observations and
T
γ 2 = gh Ωh ghT + gσ Ωσ gσ
,

21

(A.30)

Table 3: Defining variables according to DTF type in (A.32)
variable

DTF

DC

ιDTF

ξn
ξd

0
0

diag(vec(IK ))
diag(vec(IK ))

diag(vec(IK ))
IK 2

for
gh = 2

hT Icij S n Icij h T c
hT Icij S n Icij
h Ii S d Ici
−2 T c
c
c
T
h Ii S d Ii h
(a Ii S d Ici h)2

(A.31)

and
gσ =

1
(Icij h)T ⊗ (hT Icij ) ΘK ξ n
hT Ici S d Ici h

hT Icij S n Icij h  c T
− T c
(Ii h) ⊗ (hT Ici ) ΘK ξ d
c
2
(h Ii S d Ii h)




(A.32)

where the values of ξ n and ξ d are listed on Table 3 and
ΘK = (I2 ⊗ TK 2 ,2 ⊗ IK2 )


vec(I2 ) ⊗ (IK ⊗ TK 2 ,1 ⊗ IK )(IK 2 ⊗ vec(IK ))

(A.33)

with TL,M standing for the commutation matrix [19].
When the innovation covariance is known a priori or does not need to be
T
estimated, the term gσ Ωσ gσ
in (A.30) is zero.
Proof
This proposition is an immediate consequence of Corollary 1 given the results
of Proposition 1 by rewriting (A.5) as
γ(θ) =

h(λ)T Icij S n (σ)Icij h(λ)
γn (θ)
=
γd (θ)
h(λ)T Ici S d (σ)Ici h(λ)

(A.34)

All one needs is to properly compute its gradient or that of its transpose.
The job is further simplified by noting the asymptotic independence of h and σ
for this allows their separate consideration as Ωθ is block diagonal.

Since DTF is a ratio (see (A.5)) one may write the transpose of the required
gradients as


1
∂γn
∂γd
∂γ
(A.35)
= 2 γd
− γn
γd
∂ψ T
∂ψ T
∂ψ T
where ψ represents either h or σ and respectively leads to gh and gσ .

22

Therefore the necessary gradients operate on the required defined quadratic
forms whose general differentiation with respect to h yields
∂(hT Ic SIc h)
= 2hT Ic SIc
∂hT
see p. 175 Eq. (2) in [18]

(A.36)

since all appropriately valued Ic SIc matrices are symmetric. Inserting the terms
in (A.35) leads to (A.31).
The nested dependence of γ(θ) on σ calls for chain rule use:
∂(hT Ic SIc h) ∂S
∂(hT Ic SIc h)
=
T
∂σ
∂S
∂σ T
where

∂(hT Ic SIc h)
= (Icij h)T ⊗ (hT Icij )
∂S
see p. 183 Eq. (3) in [18]

(A.37)

(A.38)

In its general form, S = I2 ⊗ S̄ ⊗ IK ( see Table 2). Thus, by the chain rule
∂S
∂S ∂ S̄
=
T
∂σ
∂ S̄ ∂σ T

(A.39)

where
∂S
= ΘK = (I2 ⊗ TK 2 ,2 ⊗ IK 2 )
∂ S̄


vec(I2 ) ⊗ (IK ⊗ TK 2 ,1 ⊗ IK )(IK 2 ⊗ vec(IK ))

(A.40)

(see p. 184 Eq. (13) in [18]).
All that is left to compute are the derivatives of S̄ in each case (as in Table
2). For for each possible S̄ value, one has
∂IK 2
=0
∂σ T
which follows from its lack of σ dependence in this case.
When S̄ = Σw ,
∂Σw
= IK 2 .
∂σ T
Finally considering S̃ = IK  Σw leads to
∂ S̃
= diag(vec(IK ))
∂σ T
see p. 185 eq. (16) in [18].

(A.41)

(A.42)

(A.43)

These results are summarized as ξ n and ξ d quantities that appear on Table 3
and comprise (A.32).
The use of Slutsky’s lemma concludes the proof by allowing the use of estimated quantities.

23

A.4

Null Hypothesis Test

Under the null hypothesis
2

H0 : |γij | = 0 ⇐⇒ Icij h = 0

(A.44)

both (A.31) and (A.32) equal zero, and (5) no longer applies so that the next
Taylor term becomes necessary [24] weighted by one half of PDC’s Hessian at
the point of interest with an O(n−1
s ) dependence. Via a device similar to that
used in [25], one can show that
Proposition 3 Under (A.44)
2
ns (hIci S d Ici h)(|b
γij |

d

2

− |γij | ) →

q
X

lk χ21

(A.45)

k=1

where lk are the eigenvalues of D = LT Icij S n Icij L, where L is the Choleski factor
of Ωh . Furthermore q = rank(D) ≤ 2, its value is 1 whenever λ ∈ {0, ±0.5}.
The result in (A.45) amounts to a linear combination of χ21 variables whose
relative weights depend on estimated parameter and covariance values. Keep in
mind that Ωh depends on λ (see eq. (A.14)).

Proof
In view of the generalized delta method version, Theorem 1 whose conditions
call for use of m = 2 under H0 (A.44) since both (A.31) and (A.32) become
nullified.
First of all, note that taking derivative of (A.31) and (A.32) with respect
to σ a second time does not alter the Icij a dependence and so also produces
null results. The same holds when deriving (A.32) with respect to a since it is
quadratic in Icij a.
By contrast, the only nonzero surviving term is that of taking the derivative
of (A.31) with respect to a, which, under H0 , reduces to
2
Ic Sn Icij .
c
T
h Ii Sd Ici h ij
Therefore the Hessian in (A.9) only has an upper nonzero block corresponding to the derivative of (A.31) with respect to h so that one only needs to
consider the distribution of the latter to write
d

ns (ĥT Icj Sd Icj ĥ)(|γ̂ij |2 − |γij |2 ) → xT Icij Sn Icij x,
d

(A.46)

using Theorem 1 for x → N (0, Ωh ). The use of Slutsky’s lemma concludes the
first part of the proof by allowing the use of estimated quantities.
24

Diagonalization of xT Icij Sn Icij x is done via a transformation through the
matrix L obtained from the Choleski decomposition of Ωh = LLT . By making
1/2
x = Ly, where L = Sn Icij L, yields xT Icij Sn Icij x = yT LIcij Sn Icij Ly = yT Dy
so that the elements of the vector y = (LT L)−1 LT x are made mutually independent zero mean and of unit variance. Now diagonalizing D = UΛUT with
UUT = Iq×q produces
yT Dy =

q
X

lk yT uk uTk y =

k=1

q
X

lk ζk2

(A.47)

k=1

where uk is the k-th column of U. It is easy to show that the variables ζk = uTk y
are mutually independent, normal zero mean and of unit variance so that ζk2 are
χ21 random variables.
As rank(X) = rank(XT ) and
rank(XY) ≤ min(rank(X), rank(Y)),
it follows, after recalling explicit λ dependence, that
rank(D)

= rank(LT Icij Sn Icij L)
= rank(LLT Icij Sn Icij )
= rank(Ωh (λ)Icij Sn Icij )
= rank(H(λ)C(λ)Ωα C T (λ)HT (λ)Icij Sn Icij ),

(A.48)

which is upper bounded by rank(Icij ) = 2. It is readily verified that, when
λ ∈ {0, ±0.5}, rank(C(λ)) = 1 imposes the upper bound thus concluding the
proof. As for the PDC case [3] if the model order p = 1, though a detailed proof
is more involved, one can show that the rank of C T (λ)HT (λ)Icij equals 1 as it
has only a single row that is not identically zero.

Acknowledgements
Work done under support from FAPESP (grant 2005/56464-9 – CInAPCe Programme), CAPES Bioinformatics Graduate Programme (D.Y.T.), FAPESP (grant
2008/08171-0 D.Y.T), Ciência sem Fronteira (D.Y.T.), CNPq (grant 304404/20098 L.A.B. and grant 309381/2012 K.S.).

References
[1] Aertsen AMHJ, Gerstein GL, Habib MK, Palm G (1989) Dynamics of
neuronal firing correlation: modulation of “effective connectivity”. J Neurophysiol, 61:900–917

25

[2] Baccalá LA, Sameshima K, Ballester G, Valle AC, Timo-Iaria C (1998)
Studying the interaction between brain structures via directed coherence
and Granger causality. Appl Signal Process, 5:40–48
[3] Baccalá LA, De Brito CSN, Takahashi DY, Sameshima K (2013) Unified
asymptotic theory for all partial directed coherence forms. Phil Trans R
Soc A, 371:1–13
[4] Baccalá LA, Sameshima K (2001a) Overcoming the limitations of correlation analysis for many simultaneously processed neural structures. Progress
in Brain Research, Advances in Neural Population Coding, 130:33–47
[5] Baccalá LA, Sameshima K (2001b) Partial directed coherence: a new
concept in neural structure determination. Biol Cybern, 84:463–474
[6] Baccalá LA, Sameshima K (2014a) Partial directed coherence. In:
Sameshima K, Baccalá LA (eds) Methods in Brain Connectivity Inference
through Multivariate Time Series Analysis. Boca Raton: CRC Press, pp
57–73
[7] Baccalá LA, Sameshima K (2014b) Multivariate time series brain connectivity: a sum up. In: Sameshima K, Baccalá LA (eds) Methods in Brain
Connectivity Inference through Multivariate Time Series Analysis. Boca
Raton: CRC Press, pp 245–251
[8] Baccalá LA, Takahashi DY, Sameshima K (2007) Generalized partial directed coherence. In 15th International Conference on Digital Signal Processing. Cardiff, pp 163–166
[9] Eichler M (2006) On the evaluation of information flow in multivariate
systems by the directed transfer function. Biol Cybern, 94:469–482
[10] Fasoula A, Attal Y, Schwartz D (2013) Comparative performance evaluation of data-driven causality measures applied to brain networks. J Neurosci
Methods, 215:170–189
[11] Florin E, Gross J, Pfeifer J, Fink GR, Timmermann L (2011) Reliability
of multivariate causality measures for neural data. J Neurosci Methods,
198:344–358
[12] Friston K (1994) Functional and effective connectivity in neuroimaging: a
synthesis. Hum Brain Mapp, 2:256–278
[13] Harary F (1994) Graph Theory. Addison-Wesley Series in Mathematics.
Boston: Perseus Books
[14] Imhof JP (1961) Computing the distribution of quadratic forms in normal
variables. Biometrika, 48:419–426
[15] Jovanović A, Peroviá A, Boročanin M (2013) Brain connectivity measures:
computation and comparison. EPJ Nonlin Biomed Phys, 1:1–25
26

[16] Kamiński MJ, Blinowska KJ (1991) A new method of the description of
the information flow in the brain structures. Biol Cybern, 65:203–210
[17] Kamiński MJ, Blinowska KJ (2014) Directed transfer function: a pioneering concept in connectivity analysis. In: Sameshima K, Baccalá LA (eds)
Methods in Brain Connectivity Inference through Multivariate Time Series
Analysis. Boca Raton: CRC Press, pp 13–33
[18] Lütkepohl H (1996) Handbook of Matrices. Chichester: John Wiley
[19] Lütkepohl H (2005) New Introduction to Multiple Time Series Analysis.
New York: Springer
[20] Patnaik PB (1949) The non-central χ2 and F -distributions and their applications. Biometrika, 36:202–232
[21] Perkel JM (2013) This is your brain: mapping the connectome. Science,
339:350–352
[22] Sameshima K, Baccalá LA (2014a) Asymptotic PDC properties. In:
Sameshima K, Baccalá LA (eds) Methods in Brain Connectivity Inference
through Multivariate Time Series Analysis. Boca Raton: CRC Press, pp
113–131
[23] Sameshima K, Baccalá LA (eds) (2014b) Methods in Brain Connectivity
Inference through Multivariate Time Series Analysis. Boca Raton: CRC
Press
[24] Serfling RJ (1980) Approximation Theorems of Mathematical Statistics.
New York: Wiley
[25] Takahashi DY, Baccalá LA, Sameshima K (2007) Connectivity inference
between neural structures via partial directed coherence. J Appl Stat,
34:1259–1273
[26] Takahashi DY, Baccalá LA, Sameshima K (2010a) Frequency domain connectivity: an information theoretic perspective. In Engineering in Medicine
and Biology Society (EMBC), 2010 Annual International Conference of the
IEEE, pp 1726 –1729
[27] Takahashi DY, Baccalá LA, Sameshima K (2010b) Information theoretic
interpretation of frequency domain connectivity measures. Biol Cybern,
103:463–469
[28] Takahashi DY, Baccalá LA, Sameshima K (2014) Information partial directed coherence. In: Sameshima K, Baccalá LA (eds) Methods in Brain
Connectivity Inference through Multivariate Time Series Analysis. Boca
Raton: CRC Press, pp 75–86

27

[29] Tononi G, Sporns O, Edelman GM (1994) A measure for brain complexity relating functional segregation and integration in the nervous system. Proc
Natl Acad Sci USA, 91:5033–5037
[30] van der Vaart AW (1998) Asymptotic Statistics. Cambridge: Cambridge
University Press
[31] Vélez-Pérez H, Louis-Dorr V, Ranta R, Dufaut M (2008) Connectivity
estimation of three parametric methods on simulated electroencephalogram
signals. In Engineering in Medicine and Biology Society, 2008. EMBS 2008.
30th Annual International Conference of the IEEE, pp 2606–2609

28

