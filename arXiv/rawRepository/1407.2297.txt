Transition to chaos in random networks with cell-type-specific connectivity
Johnatan Aljadeff1,2,a , Merav Stern3,4 ,a and Tatyana O. Sharpee1,2,b
1

arXiv:1407.2297v1 [q-bio.NC] 8 Jul 2014

2

Computational Neurobiology Laboratory, The Salk Institute for Biological Studies, La Jolla, California, USA
Center for Theoretical Biological Physics and Department of Physics, University of California, San Diego, USA
3
Department of Neuroscience, Columbia University, New York, New York, USA and
4
The Edmond and Lily Safra Center for Brain Sciences, Hebrew University, Jerusalem, Israel
(Dated: July 10, 2014)
In neural circuits, statistical connectivity rules strongly depend on neuronal type. Here we study
dynamics of neural networks with cell-type specific connectivity by extending the dynamic mean
field method, and find that these networks exhibit a phase transition between silent and chaotic
activity. By analyzing the locus of this transition, we derive a new result in random matrix theory:
the spectral radius of a random connectivity matrix with block-structured variances. We apply our
results to show how a small group of hyper-excitable neurons within the network can significantly
increase the network’s computational capacity.
PACS numbers: 87.18.Sn,02.10.Yn,05.90.+m,87.19.La

Conventional firing-rate models used to describe irregular activity in neural networks assume that connections
between neurons follow a single connectivity rule. In contrast to this class of models, recent experiments highlight
the diversity among neuron types, each having a different
degree of excitability and different form of connectivity
[1–5]. As a step towards bridging this gap between theory and experiment, we extend the conventional firingrate models and the mean-field methods used to analyze
them to the case of multiple cell-types and allow for celltype-dependent connectivity.
We show that multiple cell-type networks, like networks with a single cell-type [6], exhibit a phase transition between silent and chaotic activity. Previous studies
suggest that these networks have optimal computational
capacity close to the critical point at which this tranistion
occurs [7, 8]. In networks with cell-type specific connectivity the transition depends on the network’s connectivity structure, and is related to the spectral properties of
the random connectivity matrix serving as the model network’s connectivity matrix. Specifically, by finding the
location of the critical point for the multiple cell-type
network we derive a new result in random matrix theory: the support of the spectral density of asymmetric
matrices with block-structured variances.
We also show that the dynamical mean field equations
provide predictions for the autocorrelation modes that
can be concurrently sustained by a multiple cell-type network. Finally, we apply our results to a network that
includes a small group of hyper-excitable neurons, and
explain how this small group can significantly increase
the network’s computational capacity by bringing it into
the chaotic regime.
The critical point. The starting point for our analysis of recurrent activity in neural networks is a firing-rate
model where the activation xi (t) of the ith neuron determines its firing-rate φi (t) through a nonlinear function
φi (t) = tanh(xi ). The activation of the ith neuron de-

pends on the firing-rate of all N neurons in the network:
ẋi (t) = −xi (t) +

N
X

Jij φj (t),

(1)

j=1

where Jij describes the connection weight from neuron
j to i. Previous work [6] considered a recurrent random
network where all connections are drawn from the same
distribution, grouping all neurons into a single cell-type.
In that work the distribution of matrix elements was chosen to be Gaussian with mean zero and variance g 2 /N ,
where the parameter g defines the average synaptic gain
in the network. According to Girko’s circular law, the
spectral density of the random matrix J in this case is
uniform on a disk with radius g [9, 10]. When the real
part of some of the eigenvalues of J exceeds 1, the quiescent state xi (t) = 0 becomes unstable and the network
becomes chaotic [6]. Thus, for networks with cell-type
independent connectivity the transition to chaotic dynamics occurs when g = 1.
We extend these results to networks with D cell-types,
where each cell-type (or group of neurons) has a fraction αd of neurons in it. The mean connection weight
2
is hJij i = 0. The variances N hJij
i = gc2i dj depend on
the cell-type of the input (c) and output (d) neurons;
where ci denotes the group neuron i belongs to. In what
follows, indices i, j = 1, . . . , N and c, d = 1, . . . , D correspond to single neurons and neuron groups, respectively.
Averages over realizations of J are denoted by h·i. It
is convenient to represent the connectivity structure using a synaptic gain matrix G. Its elements Gij = gci dj
are arranged in D2 blocks of sizes N αc × N αd (Fig. 1ac, top insets). The mean synaptic gain, ḡ, is given by
P
PD
2 12
2 12
N −1 ( N
i,j=1 Gij ) = (
c,d=1 αc αd gcd ) .

Pd
0
Defining Jij
∼ N 0, N −1 and nd = N c=1 αc allows us to rewrite Eq. (1) in a form that emphasizes the
separate contributions from each group to a neuron:
ẋi = −xi +

D
X

d=1

g ci d

nd
X

j=nd−1 +1

0
φj (t) .
Jij

(2)

2

N

0

−1
−1

0
Re(λ)

1

activity

0

−1

time

1

N

0

0
Re(λ)

1

time

1 D=6 N

c

2

α 1N

0

−1

N

1

ρ(|λ|)

0

N

0.5
Im(λ)

1

1

group 2 group 1

α 1N

1 α 1N

b

2

activity

N

group 2 group 1

1

Im(λ)

α1N

1

Im(λ)

a

0

|λ|

−0.5
−0.5

0
Re(λ)

0.5

FIG. 1. Spectra and dynamics of networks with cell-type
dependent connectivity (N = 2500). The support of the spectrum of
√
the connectivity matrix J is accurately described by Λ1 (radius of blue circle) for different networks. Top insets - the synaptic
gain matrix G summarizes the connectivity structure. Bottom insets - activity of representative neurons from each type. The
line ℜ{λ} = 1 (purple) marks the transition from quiescent to chaotic activity. (a) An example of chaotic network with two
cell types. The average synaptic gain ḡ (radius of red circle) incorrectly predicts this network to be quiescent. (b) An example
silent network. The average synaptic gain ḡ incorrectly predicts this network to be chaotic. (c) An example network with six
cell-types. In all examples the radial part of the eigenvalue distribution ρ(|λ|) (orange line) is not uniform.

We use the dynamic mean field approach [6, 11, 12] to
study the network behavior in the N → ∞ limit. Averaging Eq. (2) over the ensemble from which J is drawn
implies that only neurons that belong to the same group
are statistically identical. Therefore, to represent the network behavior it is enough to look at the activities ξd (t)
of D representative neurons and their inputs ηd (t).
The stochastic mean field variables ξ and η will approximate the activities and inputs in the full N dimensional

hηc (t) ηd (t + τ )i =

D
X

na
X

nb
X

a,b=1 j=na−1 +1 l=nb−1 +1

ξ̇d (t) = −ξd (t) + ηd (t) ,

(3)

and provided that ηd (t) is drawn from a Gaussian distribution with moments satisfying the following conditions.
First, the mean hηd (t)i = 0 for all d. Second, the correlations of η should match the input correlations in the
full network, averaged separately

 0 over
 each group. Using
0
Eq. (3) and the property N Jij
Jkl
= δik δjl we get the
self-consistency conditions:

D
X

 0 0
2
Jkl hφ [xj (t)] φ [xl (t + τ )]i = δcd
gci a gdj b Jij
αb gcb
Cb (τ ),

(4)

b=1

where C (τ ) is the average firing rate correlation vector.
Its components (using the variables of the
full
network
and averaging over time) are Cd (τ ) =
Pnd
hφ[x
i (t)]φ[xi (t + τ )]i, translating to Cd (τ ) =
i=nd−1 +1
hφ[ξd (t)]φ[ξd (t + τ )]i using the mean field variables. Importantly, the covariance matrix H(τ ) with elements
Hcd (τ ) = hηc (t) ηd (t + τ )i is diagonal, justifying the definition of the vector H = diag (H). With this in hand
we rewrite Eq. (4) in matrix form as
H (τ ) = MC (τ ) ,

network provided that they satisfy the dynamic equation

(5)

where M is a constant matrix reflecting the network con2
nectivity structure: Mcd = αd gcd
.
A trivial solution to this equation is H(τ ) = C(τ ) = 0
which corresponds to the silent network state: xi (t) =
0. Recall that in the network with a single cell-type,
the matrix M = g 2 is a scalar and Eq. (5) reduces to
H(τ ) = g 2 C(τ ). In this case the silent solution is stable
only when g < 1. For g > 1 the autocorrelations of η

are non-zero which leads to chaotic dynamics in the N
dimensional system [6].
In the general case (D ≥ 1), Eq. (5) can be projected
on the eigenvectors of M leading to D consistency conditions, each equivalent to the single group case. Each
projection has an effective scalar given by the eigenvalue
in place of g 2 in the D = 1 case. Hence, the trivial solution will be stable if all eigenvalues of M have real part
< 1. This is guaranteed if Λ1 , the largest eigenvalue of
M, is < 1 [13]. If Λ1 > 1 the projection of Eq. (5) on the
leading eigenvector of M gives a scalar self-consistency
equation analogous to the D = 1 case for which the trivial solution is unstable. As we know from the analysis of
the single cell-type network, this leads to chaotic dynamics in the full network. Therefore Λ1 = 1 is the critical
point of the multiple cell-type network.
Another approach to show explicitly that Λ1 = 1 at the
critical point is to consider first order deviations in the
network activity from the quiescent state. Here C(τ ) ≈

3
∆(τ ) where ∆(τ ) is the autocorrelation vector of the
activities with elements ∆d (τ ) = hξd (t)ξd (t + τ )i. By
invoking Eq. (3) we have


d2
(6)
H(τ ) = 1 − 2 ∆(τ ).
dτ
Substituting Eq. (6) into Eq. (5) leads to an equation of
motion of a particle in a harmonic potential for ∆(τ ):
d2 ∆(τ )
= (I − M) ∆(τ ).
dτ 2

(7)

The shape of the multivariate potential depends on the
eigenvalues of M. The first bifurcation (assuming the
elements of M are scaled together) occurs when Λ1 =
1, in the direction parallel to the leading eigenvector.
Physical solutions should have k∆(τ )k < ∞ as τ → ∞
because ∆(τ ) is an autocorrelation function. When all
eigenvalues of M are smaller than 1 the trivial solution
∆(τ ) = 0 is the only solution (in the neighborhood of
xi (t) = 0 where our approximation is accurate). At the
critical point (Λ1 = 1) a non trivial solution appears, and
above it finite autocorrelations lead to chaotic dynamics
in the full system [14].
Recall the dependence of the connectivity parameters
and the critical point at which the network transitions
to chaos. In the single and multiple cell-type networks
this transition occurs when a finite mass of the spectral
density of J has real part > 1. Thus, when Λ1 = 1 the
eigenvalues of J are bounded in the unit circle r = 1. For

−20 0

20

0

−20 0 20
τ

variance

10

0
−2
−4
−6

1

2

3

1

2

3

eigenvector rank

−20 0 20
d

Λ 1 >Λ 2 >1>Λ 3

10

10

c=1
c=2
c=3

variance

1

c=1
c=2
c=3

∆ c (τ)

c

R
∆ c (τ)/u1c

0

10

b

Λ 1 >1>Λ 2 >Λ 3

>uRc |∆(τ)>

1

∆ c (τ)

a

10
10
10
10

0
−2
−4
−6

eigenvector rank

−20 0 20
τ

FIG. 2. Autocorrelation modes. Example networks have
N = 1200 and 3 equally sized groups with α, g such that M
is symmetric. (a) When D⋆ = 1, autocorrelations maintain a
constant ratio independent of τ . (b) Rescaling by the components uR
1c merges the autocorrelation functions. (c) When
D⋆ = 2, the autocorrelation functions are linear combinations of two autocorrelation “modes” that decay on different timescales. Projections of these functions huR
c |∆(τ )i are
R
shown in (d). Only projections on |uR
1 i, |u2 i are significantly
different
  from 0. Insets show the variance of ∆ (τ ) projected
on uR
averaged over 20 networks in each setting.
c

networks with cell-type independent connectivity, Λ1 =
g 2 and r = g. Requiring continuity, this implies that the
circle that bounds the eigenvalue density of J has radius
p
p
r(α, g) = Λ1 = max [λ(M)].
(8)

We have verified Eq. (8) using numerical simulations
(Fig. 1) for a number of different matrix configurations.
Strikingly, r is qualitatively different from the
√ mean
synaptic gain ḡ (Fig. 1a,b). The inequality Λ1 6= ḡ
is a signature of the block structured variances. It is not
observed in the case where the variances have columnar
structure [15], when rank{M} = 1 [16, 17], or when the
Jij ’s are randomly permuted.
Autocorrelation modes. Next we analyze the network
dynamics above the critical point. In the chaotic regime
the persistent population-level activity is determined by
the structure of the matrix M. Consider the decomposiPD
L
R
L
tion M = c=1 Λc |uR
c ihuc | where |uc i, huc | are the right
and left eigenvectors ordered by the real part of their corR
responding eigenvalues ℜ{Λc }, satisfying huL
c |ud i = δcd .
By analogy to the analysis of the scalar self consistency
equation in [6] we know that the trivial solution to Eq. (5)
R
is unstable in the subspace UM = span{|uR
1 i, . . . , |uD⋆ i},
⋆
where D is the number of eigenvalues of M with real
part > 1. In that subspace the solution to Eq. (5) is a
linear combination of D⋆ different autocorrelation functions. Conversely, in the D − D⋆ dimensional orthogonal
⊥
complement subspace UM
the trivial solution is stable.
As a consequence, the vectors H(τ ), ∆(τ ) are restricted
⊥
to UM and their projection on any vector in UM
is 0.
⋆
In the special case D = 1 only one eigenvalue of M has
a real part > 1, and the activity of neurons in all groups
follows the same autocorrelation function. The scaling is determined by the components uR
1c of the leading
right eigenvector of M (see Fig. 2a,b): ∆c (τ )/∆d (τ ) =
R
⋆
uR
1c /u1d . In general D can be larger than 1. In Fig 2c,d
we show an example network with three cell-types and
D⋆ = 2. Note that for asymmetric M, |uR
c i are not or⊥
thogonal and UM
is spanned by the left rather than the
⊥
L
right eigenvectors: UM
= span{huL
D⋆ +1 |, . . . , huD |}.
Universality and sparsity. Until now we have discussed connectivity matrices with elements drawn from
Gaussian distributions. However Girko’s circular law
[9, 10] is universal, meaning that the spectral density of
connectivity matrices describing single cell-type networks
depends only on the second moment of the matrix entry
distribution [18] (as long as the mean remains zero). This
suggests that our results for matrices with block structured variances, extend to non-Gaussian distributions,
2
provided that hJij i = 0 and N hJij
i = gc2i dj < ∞. Using
numerical simulations, we have verified that Eq. (8) holds
for a number of non-Gaussian matrix element distributions, including networks where connection strengths
were taken from sparse and β distributions (Fig. 3) [19].
Applications. We now illustrate how these theoretical results can give insight into a perplexing question
in computational neuroscience - how can a small number of neurons have a large effect on the representational

4
a

b

−0.5
0

N

−0.5

0
Re(λ)

P(Jij)

0
-1
4

N1

1

2

β(0.4,4)

10

N

β(1.1,0.9)

1
0

1

β(0.5,0.5)

2
0
-0.5

0-1
10

0

1

β(1,0.2)

5
0

J ij

0.5

0-1

0

Jij

1

0.25
Im(λ)

0

N

0

20

sparsity

Im(λ)

0.5

β distributions

1
P(Jij)

N1

1

strength

Sparse connectivity

N

0

−0.25
−0.25 0 0.25
Re(λ)

0.5

1

0.5

1

2

3
4
r (=√Λ1)

5

6

learning index

0.8
0.6

0.05

2
√Λ1=

0

b
0.1

3
√Λ1=

Ω0
2Ω 0
4Ω 0
20Ω 0
ave.

1
√Λ1=

learning index

a

α1 - fraction of young neurons

FIG. 3. Universality and sparse connectivity. (a) Our results
extend to sparse connectivity matrices, an example matrix
with non-Gaussian element distributions. The formula for
the radius (blue circle) is in agreement with the numerical
results. Insets shows average synaptic strengths, G (top) and
the sparsity levels (bottom). (b) In each block the elements
of J were drawn from a centered β distribution with different
parameters leading to skewed and bimodal distributions.

0.4
0.2

0
0.01
2
4
6 8 10
0.8 1
γ − hyperexcitability of young neurons

FIG. 4. Application to neurogenesis. (a) The learning index lΩ (α1 , γ) for four pure frequency target functions
√ (Ω0 =
π/120) plotted as a function of the radius r = Λ1 . The
training epoch lasted approximately 100 periods of the target signal. The radius is a good coordinate to describe the
learning capacity. (b) The same data, averaged over the target frequencies, plotted in√the γ − α1 plane. Contour lines of
lΩ (α1 , γ) (white) and of Λ1 (black) coincide approximately
in the region where lΩ peaks, supporting our conclusion√that
learning is modulated in parameter space primarily by Λ1 ,
the effective gain of the network.

capacity of the whole network? In adults, newborn neurons continuously migrate into the existing neural circuit
in the hippocampus and olfactory bulb regions [20]. Impaired neurogenesis results in strong deficits in learning
and memory. This is surprising since the young neurons,
although hyperexcitable, constitute only a very small
fraction (< 0.1) of the total network. To better understand the computational role young neurons may play,
we analyzed dynamics of a network with D = 2 groups
of neurons. The first group consists of the young neurons, so its size is significantly smaller than the second
group which consists of the mature neurons (α1 ≪ α2 ).
In our model, the connectivity within the existing neural
circuit (group 2) is such that by itself that subnetwork
would be in the quiescent state: g22 = 1 − ǫ < 1. To

model the increased excitability of the young neurons all
connections of these neurons were set to a larger value:
g12 = g21 = g11 = γ > 1 − ǫ.
We analyzed the network’s capacity to accurately reproduce a target output pattern. The activity of the
neurons serves as a “reservoir” of waveforms from which
the target signal f (t) is composed. We used the learning algorithm in [21] to find the vector w such that
PN
z(t) = i=1 wi φi (t) = f (t), where the modified dynamics have Jij → Jij + ui wj and u is a random vector with
entries of O(1). The single group network does this well
when its synaptic gain is g ≈ 1.5 [21], such that its initial
activity is in the weakly chaotic regime. For simplicity we
choose purely periodic target functions f (t) =
R A sin(Ωt).
We define the learning index as lΩ = |z̃(Ω)|/ |z̃(ω)|2 dω,
with z̃(ω) being the Fourier transform of z(t) generated
by the network after the learning epoch.
For fixed ǫ = 0.2 and N = 500 we computed
√ lΩ (α1 , γ)
and found that for this family of networks Λ1 plays a
role equivalent to that of g√in the single group network.
Performance is optimal for Λ1 ≈ 1.5, and networks with
different structure perform similarly as long as they have
similar values of Λ1 (Fig. 4). These results demonstrate
that a small group of neurons could place the overall network in a state conducive to learning. Importantly, because of the block structured connectivity,
√ the effective
gain is larger than the average gain ( Λ1 > ḡ), suggesting that modulating the synaptic gain can carry a
larger effect on the learning capacity of the multiple celltype network compared to what one may expect based
on changes in mean connectivity gain.
It is worth noting that typically outgoing connections
from any given neuron are all positive or all negative,
obeying Dale’s law [22]. Within random networks, this
issue was addressed by Rajan and Abbott [15] who studied a model where columns of J are separated to two
groups, each with its offset and element variance. They
computed the bulk spectrum by imposing a “detailed balance” constraint, where the sum of incoming connections
to each neuron is exactly 0 [15, 16]. The distribution of
outliers which appear when this constraint is lifted was
computed by Tao [23]. The dynamics of networks with
cell-type-dependent connectivity that is offset to respect
Dale’s law were addressed in [24] with some limitations,
and remain an important problem for future research.
Ultimately, neural network dynamics need to be considered in relation to external inputs. The response properties of networks with one cell-type have been recently
worked out [8, 25]. The analogy between the mean field
equations for the single and multi-group cases suggests
that our results can be used to understand the nonautonomous behavior of multiple cell-type networks.
The authors would like to thank Larry Abbott for his
support, including comments on the manuscript, and Ken
Miller for many useful discussions. This work was supported by NIH grant (R01EY019493) and NSF Career
award (IIS 1254123). MS was supported by the Gatsby
Foundation.

5

a
b

[1]

[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]
[10]
[11]
[12]
[13]

Equal contribution
sharpee@salk.edu
D. Schubert, R. Ktter, K. Zilles, H. J. Luhmann, and
J. F. Staiger, The Journal of neuroscience 23, 2961
(2003).
Y. Yoshimura, J. L. Dantzker, and E. M. Callaway, Nature 433, 868 (2005).
N. Suzuki and J. M. Bekkers, The Journal of Neuroscience 32, 919 (2012).
K. M. Franks, M. J. Russo, D. L. Sosulski, A. A. Mulligan, S. A. Siegelbaum, and R. Axel, Neuron 72, 49
(2011).
R. B. Levy and A. D. Reyes, The Journal of Neuroscience
32, 5609 (2012).
H. Sompolinsky, A. Crisanti, and H. J. Sommers, Physical Review Letters 61, 259 (1988).
N. Bertschinger and T. Natschläger, Neural computation
16, 1413 (2004).
T. Toyoizumi and L. F. Abbott, Physical Review E 84,
051908 (2011).
V. Girko, Theory Probab. Appl 29, 694 (1984).
Z. Bai, The Annals of Probability 25, 494 (1997).
S.-I. Amari, Systems, Man and Cybernetics, IEEE Transactions on , 643 (1972).
H. Sompolinsky and A. Zippelius, Physical Review B 25,
6860 (1982).
Note that M has strictly positive elements, so by the
Perron-Frobenious theorem its largest eigenvalue (in ab-

[14]

[15]
[16]
[17]
[18]
[19]

[20]
[21]
[22]
[23]
[24]
[25]

solute value) is real and positive and the corresponding
eigenvector has strictly positive components.
Establishing the existence of a positive Lyapunov exponent requires analysis of the full self consistency equations and cannot be done using the linearized approximation.
K. Rajan and L. F. Abbott, Physical review letters 97,
188104 (2006).
Y. Wei, Physical Review E 85, 066116 (2012).
Y. Ahmadian, F. Fumarola, and K. D. Miller, arXiv
preprint arXiv:1311.4672 (2013).
T. Tao, V. Vu, and M. Krishnapur, The Annals of Probability 38, 2023 (2010).
In the sparse example, scd is the fraction of nonzero elements, randomly drawn from a Gaussian distribution
2
with variance gcd
/N . The block-wise variance is there2
fore scd gcd
/N , and eigenvalues are bounded by a circle
2
with radius calculated using Mcd = αd scd gcd
.
C. Zhao, W. Deng, and F. H. Gage, Cell 132, 645 (2008).
D. Sussillo and L. F. Abbott, Neuron 63, 544 (2009).
J. Eccles, Notes and records of the Royal Society of London 30, 219 (1976).
T. Tao, Probability Theory and Related Fields 155, 231
(2013).
T. Cabana and J. Touboul, Journal of Statistical Physics
153, 211 (2013).
K. Rajan, L. F. Abbott, and H. Sompolinsky, Physical
Review E 82, 011903 (2010).

