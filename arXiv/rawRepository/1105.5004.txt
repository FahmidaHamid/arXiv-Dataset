arXiv:1105.5004v6 [math.ST] 18 Mar 2014

Bayesian Decision-theoretic Methods
for Parameter Ensembles
with Application to
Epidemiology

By
Cedric E. Ginestet
Under the supervision of
Nicky G. Best, Sylvia Richardson and David J. Briggs
In partial fulfilment of the requirements for the degree of
Doctor of Philosophy.
February 2011
Doctorate Thesis submitted to the
Department of Epidemiology and Biostatistics
Imperial College London.

1

Abstract
Parameter ensembles or sets of random effects constitute one of the cornerstones of modern statistical practice. This is especially the case in Bayesian hierarchical models, where several decision
theoretic frameworks can be deployed to optimise the estimation of parameter ensembles. The
reporting of such ensembles in the form of sets of point estimates is an important concern in epidemiology, and most particularly in spatial epidemiology, where each element in these ensembles
represent an epidemiological unit such as a hospital or a geographical area of interest. The estimation of these parameter ensembles may substantially vary depending on which inferential goals
are prioritised by the modeller. Since one may wish to satisfy a range of desiderata, it is therefore
of interest to investigate whether some sets of point estimates can simultaneously meet several
inferential objectives. In this thesis, we will be especially concerned with identifying ensembles of
point estimates that produce good approximations of (i) the true empirical quantiles and empirical
quartile ratio (QR) and (ii) provide an accurate classification of the ensemble’s elements above
and below a given threshold. For this purpose, we review various decision-theoretic frameworks,
which have been proposed in the literature in relation to the optimisation of different aspects of
the empirical distribution of a parameter ensemble. This includes the constrained Bayes (CB),
weighted-rank squared error loss (WRSEL), and triple-goal (GR) ensembles of point estimates. In
addition, we also consider the set of maximum likelihood estimates (MLEs) and the ensemble of
posterior means –the latter being optimal under the summed squared error loss (SSEL). Firstly,
we test the performance of these different sets of point estimates as plug-in estimators for the
empirical quantiles and empirical QR under a range of synthetic scenarios encompassing both
spatial and non-spatial simulated data sets. Performance evaluation is here conducted using the
posterior regret, which corresponds to the difference in posterior losses between the chosen plug-in
estimator and the optimal choice under the loss function of interest. The triple-goal plug-in estimator is found to outperform its counterparts and produce close-to-optimal empirical quantiles
and empirical QR. A real data set documenting schizophrenia prevalence in an urban area is also
used to illustrate the implementation of these methods. Secondly, two threshold classification
losses (TCLs) –weighted and unweighted– are formulated. The weighted TCL can be used to
emphasise the estimation of false positives over false negatives or the converse. These weighted
and unweighted TCLs are optimised by a set of posterior quantiles and a set of posterior medians,
respectively. Under an unweighted classification framework, the SSEL point estimates are found
to be quasi-optimal for all scenarios studied. In addition, the five candidate plug-in estimators are
also evaluated under the rank classification loss (RCL), which has been previously proposed in the
literature. The SSEL set of point estimates are again found to constitute quasi-optimal plug-in
estimators under this loss function, approximately on a par with the CB and GR sets of point
estimates. The threshold and rank classification loss functions are applied to surveillance data
reporting methicillin resistant Staphylococcus aureus (MRSA) prevalence in UK hospitals. This
application demonstrates that all the studied plug-in classifiers under TCL tend to be more liberal
than the optimal estimator. That is, all studied plug-in estimators tended to classify a greater
number of hospitals above the risk threshold than the set of posterior medians. In a concluding
chapter, we discuss some possible generalisations of the loss functions studied in this thesis, and
consider how model specification can be tailored to better serve the inferential goals considered.

Contents
Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Table of Content . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1 Introduction

1
4
7
8

2 Loss functions for Parameter Ensembles
2.1 Bayesian Decision Theory . . . . . . . . . . . . . . . .
2.1.1 Premises of Decision Theory . . . . . . . . . .
2.1.2 Frequentist and Bayesian Decision Theories . .
2.1.3 Classical Loss Functions . . . . . . . . . . . . .
2.1.4 Functions of Parameters . . . . . . . . . . . . .
2.2 Parameter Ensembles and Hierarchical Shrinkage . . .
2.2.1 Bayesian Hierarchical Models . . . . . . . . . .
2.2.2 Spatial Models . . . . . . . . . . . . . . . . . .
2.2.3 Estimation of Parameter Ensembles . . . . . .
2.2.4 Hierarchical Shrinkage . . . . . . . . . . . . . .
2.3 Ranks, Quantile Functions and Order Statistics . . . .
2.3.1 Ranks and Percentile Ranks . . . . . . . . . . .
2.3.2 Quantile Function . . . . . . . . . . . . . . . .
2.3.3 Quantiles, Quartiles and Percentiles . . . . . .
2.4 Loss Functions for Parameter Ensembles . . . . . . . .
2.4.1 Constrained Bayes . . . . . . . . . . . . . . . .
2.4.2 Triple-Goal . . . . . . . . . . . . . . . . . . . .
2.4.3 Weighted and Weighted Ranks Loss Functions
2.5 Research Questions . . . . . . . . . . . . . . . . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

11
11
12
13
14
15
16
17
18
19
21
21
21
22
23
24
24
25
26
28

3 Empirical Quantiles and Quartile Ratio Losses
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . .
3.2 Estimation of Empirical Quantiles and Quartile Ratio
3.2.1 Empirical Quantiles . . . . . . . . . . . . . . .
3.2.2 Empirical Quartile Ratio . . . . . . . . . . . .
3.2.3 Performance Evaluation . . . . . . . . . . . . .
3.3 Non-spatial Simulations . . . . . . . . . . . . . . . . .
3.3.1 Design . . . . . . . . . . . . . . . . . . . . . . .
3.3.2 Generative Models . . . . . . . . . . . . . . . .
3.3.3 Simulation Scenarios . . . . . . . . . . . . . . .
3.3.4 Fitted Models . . . . . . . . . . . . . . . . . . .
3.3.5 Plug-in Estimators under Q-SEL . . . . . . . .
3.3.6 Plug-in Estimators under QR-SEL . . . . . . .
3.4 Spatial Simulations . . . . . . . . . . . . . . . . . . . .
3.4.1 Design . . . . . . . . . . . . . . . . . . . . . . .
3.4.2 Spatial Structure Scenarios . . . . . . . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

30
30
33
33
34
36
36
36
37
37
38
38
41
43
43
44

3

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.

48
49
51
52
55
55
56
57
59

4 Threshold and Rank Classification Losses
4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 Classification Losses . . . . . . . . . . . . . . . . . . . .
4.2.1 Threshold Classification Loss . . . . . . . . . . .
4.2.2 Rank Classification Loss . . . . . . . . . . . . . .
4.2.3 Posterior Sensitivity and Specificity . . . . . . .
4.2.4 Performance Evaluation . . . . . . . . . . . . . .
4.3 Non-spatial Data Simulations . . . . . . . . . . . . . . .
4.3.1 Parameter Ensembles and Experimental Factors
4.3.2 Plug-in Estimators under TCL . . . . . . . . . .
4.3.3 Plug-in Estimators under RCL . . . . . . . . . .
4.4 Spatial Simulations . . . . . . . . . . . . . . . . . . . . .
4.4.1 Parameter Ensembles and Experimental Factors
4.4.2 Plug-in Estimators under Unweighted TCL . . .
4.4.3 Plug-in Estimators under Weighted TCL . . . .
4.4.4 Plug-in Estimators under RCL . . . . . . . . . .
4.4.5 Consequences of Scaling the Expected Counts . .
4.5 MRSA Prevalence in UK NHS Trusts . . . . . . . . . .
4.5.1 Data Pre-processing . . . . . . . . . . . . . . . .
4.5.2 Fitted Model . . . . . . . . . . . . . . . . . . . .
4.5.3 TCL Classification . . . . . . . . . . . . . . . . .
4.5.4 RCL Classification . . . . . . . . . . . . . . . . .
4.6 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . .
4.7 Proof of TCL Minimisation . . . . . . . . . . . . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

62
62
64
64
68
69
70
71
71
72
73
74
75
75
77
78
79
82
82
83
84
90
90
93

5 Discussion
5.1 Main Findings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.2 Generalised Classification Losses . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.3 Modelling Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

94
94
95
96

A Non-Spatial Simulations

97

B Spatial Simulations

99

3.5

3.6

3.4.3 Fitted Models . . . . . . . . . . . . . . . . . .
3.4.4 Plug-in Estimators under Q-SEL . . . . . . .
3.4.5 Plug-in Estimators under QR-SEL . . . . . .
3.4.6 Consequences of Scaling the Expected Counts
Urban Distribution of Schizophrenia Cases . . . . . .
3.5.1 Data Description . . . . . . . . . . . . . . . .
3.5.2 Models Used and Performance Evaluation . .
3.5.3 Results . . . . . . . . . . . . . . . . . . . . .
Conclusion . . . . . . . . . . . . . . . . . . . . . . .

C WinBUGS Codes
C.1 CAR Normal (BYM) Model
C.2 CAR Laplace (L1) Model .
C.3 MRSA Model . . . . . . . .
References . . . . . . . . . . . . .
Index . . . . . . . . . . . . . . .

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

102
102
103
104
104
109

4

Abbreviations
AVL
DAG
iid
ind
BHM
BYM
CAR
CB
CDI
CDF
DoPQ
EB
EDF
G-IG
GR
ICC
IQR
IQR-SEL
ISEL
L1
MCMC
MLE
MOR
MRSA
N-N
OR
pdf
PM
Q-SEL
QR
QR-SEL
RCL
RoPQ
RR
RSEL
SEL
SBR
SSEL
WRSEL
TCL

Absolute value error loss
Directed Acyclic Graph
Independent and identically distributed
Independent
Bayesian hierarchical model
Besag, York and Mollié model
Conditional autoregressive
Constrained Bayes
Carstairs’ deprivation index
Cumulative distribution function
Difference of posterior quartiles
Empirical Bayes
Empirical distribution function
Gamma-Inverse Gamma model
Triple-goal (G for empirical distribution and
R for rank)
Intraclass Correlation
Interquartile range
Interquartile range squared error loss
Integrated squared error loss
Laplace-based Besag, York and Mollié model
Markov chain Monte Carlo
Maximum likelihood estimate
Median odds ratio
Methicillin resistant Staphylococcus aureus
Normal-Normal model
Odds ratio
Probability density function
Posterior mean
Quantiles squared error loss
Quartile ratio
Quartile ratio squared error loss
Rank classification loss
Ratio of Posterior Quartiles
Relative risk
Rank squared error loss
Squared error loss
Smoothing by roughening algorithm
Summed squared error loss
Weighted rank squared error loss
Threshold classification loss

5

À mes parents.

6

Acknowledgements
Writing a thesis is always an arduous process, and the present one has been a particularly
testing one. However, during that long journey, I had the chance to receive support from
distinguished scholars. For my entry in the world of statistics, I am greatly indebted to Prof.
Nicky Best, my director of studies, who has entrusted me with the capacity to complete a PhD
in biostatistics, and has demonstrated mountains of patience in the face of my often whimsical
behaviour.
I also owe a great debt of gratitude to my second supervisor, Prof. Sylvia Richardson, who
has helped me a great deal throughout the PhD process, and has been particularly understanding
during the write-up stage. This revised thesis, however, would not be in its current form without
the advice and recommendations of the two examiners –Prof. Angelika van der Linde and Dr.
Maria De Iorio– and I am also extremely grateful to them. In particular, I would like to thank
Prof. Angelika van der Linde for suggesting how to simplify the minimisation of the threshold
classification loss (TCL).
This work was supported by a capacity building scholarship awarded by the UK Medical
Research Council. In terms of technical resources, I also wish to acknowledge the use of the
Imperial College High Performance Computing (HPC) Service. In particular, I would like to
thank Simon Burbidge for his help in using the HPC. In addition, I have also benefited form
the help of James Kirkbride from the Department of Psychiatry in Cambridge University, who
provided the schizophrenia prevalence data set.
Lastly, my greatest thanks go to Sofie Davis, who has been a trove of patience and encouragement throughout the last four years.

7

Chapter 1

Introduction
An important concern in epidemiology is the reporting of ensembles of point estimates. In disease
mapping, for example, one may wish to ascertain the levels of risk for cancer in different regions
of the British Isles (Jarup et al., 2002), or evaluate cancer mortality rates in different administrative areas (Lopez-Abente et al., 2007). In public health, one may be interested in comparing
different service providers such as neonatal clinics (MacNab et al., 2004). Estimation of parameter
ensembles may also be of interest as performance indicators, such as when compiling league tables
(Goldstein and Spiegelhalter, 1996). Thus, one of the fundamental tasks of the epidemiologist is
the summarising of data in the form of an ensemble of summary statistics, which constitutes an
approximation of a ‘parameter ensemble’.
Such a task, however, is complicated by the variety of goals that such an ensemble of point
estimates has to fulfil. A primary goal, for instance, may be to produce element-specific point
estimates, which optimally reflect the individual level of risk in each area. Alternatively, one may
be required to select the ensemble of point estimates that best approximate the histogram of the
true parameter ensemble (Louis, 1984). A related but distinct desideratum may be to choose the
set of point estimates that gives a good approximation of the true heterogeneity in the ensemble.
This is especially important from a public health perspective since unexplained dispersion in the
ensemble of point estimates may indicate the effect of unmeasured covariates. Naturally, there does
not exist a set of point estimates, which simultaneously optimise all of these criteria. However,
reporting several ensembles of point estimates corresponding to different desiderata can yield
to some inconsistencies, which generally lead epidemiologists to solely report a single set of point
estimates when communicating their results to the public or to decision makers. There is therefore
a need for considering how certain ensembles of point estimates can satisfy several epidemiological
goals at once.
A natural statistical framework within which these issues can be addressed is Bayesian decision
theory. This approach relies on the formulation of a particular loss function and the fitting of a
Bayesian model to the data of interest. The former formalises one’s inferential goals, whereas
the latter permits to derive the joint posterior distribution of the parameters of interest, which
will then be used for the optimisation of the loss function. Once these two ingredients are specified, standard arguments in decision theory imply that an optimal set of point estimates can be
obtained by minimising the posterior expected loss function. In spatial epidemiology, the use of
Bayesian methods, thanks to the now wide availability of computational resources, has increasingly become the procedure of choice for the estimation of small-area statistics (Lawson, 2009).
This has paralleled an increase in the amount of multilevel data routinely collected in most fields
of public health and in the social sciences. The expansion of Bayesian methods has especially been
motivated by an increased utilisation of hierarchical models, which are characterised by the use of
hierarchical priors (Best et al., 1996, Wakefield et al., 2000, Gelman et al., 2004). This family of
models has the desirable property of borrowing strength across different areas, which permits to
decrease the variability of each point estimate in the ensemble.
Such Bayesian models are generally used in conjunction with summed of squared error loss
8

(SSEL) function, whose optimal estimator is the set of posterior means of the elements of the
parameter ensemble of interest. The SSEL is widely used in most applications because it produces
estimators, which are easy to handle computationally, and often readily available from MCMC
summaries. Despite being the most popular loss function in both spatial and non-spatial epidemiology, this particular choice of loss function, however, remains criticised by several authors
(Lehmann and Casella, 1995, Robert, 1996). In particular, the use of the quadratic loss has been
challenged by researchers demonstrating that the posterior means tend to overshrink the empirical
distribution of the ensemble’s elements (Louis, 1984). The empirical variance of the ensemble of
point estimates under SSEL can indeed be shown to represent only a fraction of the true empirical
variance of the unobserved parameters (Ghosh, 1992, Richardson et al., 2004).
Due to these limitations and motivated by a need to produce parameter ensemble estimates
that satisfy other epidemiological desiderata, several authors have suggested the use of alternative
loss functions. Specifically, Louis (1984) and Ghosh (1992) have introduced a constrained loss
function, which produce sets of point estimates that match both the empirical mean and empirical
variance of the true parameter ensemble. Other authors have made use of the flexibility of the
ensemble distribution to optimise the estimation of certain parts of the empirical distribution
to the detriment of the remaining ones. This has been done by specifying a set of weights φ,
which emphasise the estimation of a subset of the elements of the target ensemble (Wright et al.,
2003, Craigmile et al., 2006). A particularly successful foray in simultaneously satisfying several
inferential objectives was achieved by Shen and Louis (1998), who proposed the use of triple-goal
ensembles of point estimates. These sets of point estimates constitute a good approximation of the
empirical distribution of the parameter ensemble. Moreover, their ranks are close to the optimal
ranks. Finally, they also provide good estimates of element-specific levels of risk.
Two specific goals, however, do not appear to have hitherto been fully addressed in the literature on Bayesian decision theory. These are (i) the estimation of the empirical quantiles and
the empirical quartile ratio (QR) of a parameter ensemble of interest, and (ii) the optimisation
of the classification of the elements of an ensemble above or below a given threshold. The first
objective lies close to a need of evaluating the amount of dispersion of a parameter ensemble. The
estimation of the QR indeed constitutes a good candidate for quantifying the variability of the
elements in the ensemble, which can then be related to the presence or absence of unmeasured risk
factor. While some epidemiologists have considered the problem of choosing a specific measure
of dispersion for parameter ensembles (Larsen et al., 2000, Larsen and Merlo, 2005), these methods have been formulated in a frequentist framework and little work has been conducted from a
Bayesian perspective.
The second goal, which we wish to explore in this thesis, is the classification of elements in a
parameter ensemble. Increased interest in performance evaluation and the development of league
tables in education and health has led to the routine gathering of surveillance data, which permit to
trace the evolution of particular institutions over time. Despite the range of drawbacks associated
with these methods (Goldstein and Spiegelhalter, 1996), a combination of factors has made the
use of surveillance data particularly popular. Excess mortality rates following paediatric cardiac
surgery in Bristol Royal Infirmary, for instance, has raised awareness about the significance of this
type of data (Grigg et al., 2003). The Shipman inquiry, in addition, has stressed the need for a
closer monitoring of mortality rates in general practices in the UK (Shipman-Inquiry, 2004). These
factors have been compounded by the public and political attention to hospital-acquired infections
such as methicillin resistant Staphylococcus aureus (MRSA) or Clostridium difficile (Grigg and
Spiegelhalter, 2007, Grigg et al., 2009). Such developments are reflected by the recent creation of
a new journal entitled Advances in Disease Surveillance, published by the International Society for
Diseases Surveillance in 2007. While some statistical work has focused on the monitoring of disease
counts over time (Spiegelhalter, 2005, Grigg et al., 2009), few authors have considered the problem
of classifying the elements of a parameter ensemble in low- and high-risk groups (Richardson et al.,
2004). Such classifications, however, may be particularly useful for the mapping of risk in spatial
epidemiology, where different groups of areas could be assigned different colours, according to each
group’s level of risk.
However, while the estimation of the empirical quantiles and empirical QR or the classification
9

of the elements of a parameter ensemble can be conducted optimally, these optimal estimators may
not succeed to meet other inferential goals. One of the central themes of this thesis will therefore
be to identify sets of point estimates that can simultaneously satisfy several inferential objectives.
For this purpose, we will study the behaviour of various plug-in estimators under the specific
loss functions of interest. Plug-in estimators are computed by applying a particular function to a
candidate set of point estimates. In order to evaluate the performance of each of these candidate
ensembles in comparison to the optimal choice of estimator under the loss functions of interest,
we will compute the posterior regret associated with the use of that specific candidate plug-in
estimator. We will compare different plug-in estimators using spatial and non-spatial simulations,
as well as two real data sets documenting schizophrenia and MRSA prevalence.
This thesis is organised as follows. In chapter 2, we describe the general principles of decision
theory and present the specific modelling assumptions commonly made in epidemiology and spatial
epidemiology. Several loss functions, which have been proposed for the estimation of parameter
ensembles in hierarchical models are introduced with their respective optimal estimators. Estimators resulting from these loss functions will be used throughout the thesis as plug-in estimators
under other loss functions of interest. Chapter 3 is specifically dedicated to the optimisation of
the empirical quantiles and empirical QR of a parameter ensemble, which permit to evaluate the
amount of dispersion in the ensemble distribution. In chapter 4, we consider the issue of classifying the different elements of a parameter ensemble above or below a given threshold of risk,
which particularly pertains to the analysis of surveillance data. Finally, in chapter 5, we consider
some possible extensions and generalisations of the techniques proposed in this thesis, with special emphasis on the specification of tailored Bayesian models, which may better serve the target
inferential goals.

10

Chapter 2

Loss functions for Parameter
Ensembles
Summary
In this introductory chapter, we briefly introduce the general decision-theoretic
framework used in Bayesian statistics, with special attention to point estimation
problems. We present three commonly used loss functions: the squared-error
loss, the absolute error loss and the 0/1-loss. A working definition of Bayesian
hierarchical models is then provided, including the description of three specific
families of models characterised by different types of prior structure, which will
be used throughout the thesis. The concept of a parameter ensemble in a hierarchical model is also defined with some emphasis on the optimal estimation
of the functions of parameter ensembles. Issues related to hierarchical shrinkage
are reviewed with a brief discussion of the Ghosh-Louis theorem. Several commonly adopted decision-theoretic approaches to the estimation of a parameter
ensemble are also introduced, including the constrained Bayes estimator (CB),
the triple-goal estimator (GR) and the weighted-rank squared-error loss estimator (WRSEL). Finally, we discuss plug-in estimators, which consist of functions
of an ensemble of point estimates. Differences between such plug-in estimators
and the optimal estimators of various functions of parameter ensembles will be
the object of most of the thesis at hand. In particular, the performance of optimal
and plug-in estimators will be studied within the context of two inferential objectives relevant to epidemiological practice: (i) the estimation of the dispersion
of parameter ensembles and (ii) the classification of the elements of a parameter
ensemble above or below a given threshold. We conclude with a description of
the posterior regret, which will be used throughout the thesis as a criterion for
performance evaluation.

2.1

Bayesian Decision Theory

In this section, we briefly introduce the premises of decision theory with special attention to point
estimation. We also consider the differences between the frequentist and the Bayesian approach
to the problem of point estimation, and describe three classical loss functions. A discussion of the
specific issues arising from the estimation of a function of the model’s parameters is also given, as
this is especially relevant to the thesis at hand. Note that, throughout this chapter and the rest of
this thesis, we will not emphasise the niceties of measure theory, but restrict ourselves to the level
of formality and the notation introduced by Berger (1980) and Robert (2007). Unless otherwise
specified, all random variables in this thesis will be assumed to be real-valued.

11

2.1.1

Premises of Decision Theory

Decision theory formalises the statistical approach to decision making. Here, decision making
should be understood in its broadest sense. The estimation of a particular parameter, for instance,
constitutes a decision as we opt for a specific value among a set of possible candidates. The
cornerstone of decision theory is the specification of a utility function. The main strength and
appeal of decision theory is that once a utility function has been selected, and a set of alternative
options has been delineated, the decision problem is then fully specified and the optimal decision
can be derived.
A rigorous approach to decision theory is based on the definition of three spaces. Firstly, let
Θ denotes the space of the true states of the world. Secondly, the decision space, denoted D,
will comprise the decisions –sometimes referred to as acts, actions or choices– that one can take.
A third space encompasses the consequences of a particular course of action. These are often
expressed in monetary terms, and for that reasons are generally termed rewards. This last space
will be denoted Z. The true states of the world, the decision space and the space of consequences
are linked together by a loss function defined as follows,
L : Θ × D 7→ Z,

(2.1)

where × denotes the Cartesian product. A loss function is thus a criterion for evaluating a possible
procedure or action δ ∈ D, given some true state of the world θ ∈ Θ. This loss function takes values
in the space of consequences Z. A decision problem is therefore fully specified when the above
four ingredients are known: (Θ, D, Z, L). Note that, in axiomatic treatments of decision theory,
the aforementioned quadruple is generally replaced by (Θ, D, Z, ), where  is a total ordering on
the space of consequences. Providing several properties of  hold (e.g. transitivity, asymmetry),
the existence of a loss function L can be demonstrated. Decision theory originated in the context
of game theory (von Neumann and Morgenstern, 1944), and was adapted to statistics by Savage
(1954). The formalisation of a decision problem as the quadruple (Θ, D, Z, ) is probably the
most accepted definition (Fishburn, 1964, Kreps, 1988, DeGroot, 1970, Robert, 2007), although
some other authors also include the set of all possible experiments, E, in the definition of a decision
problem (Raiffa and Schlaifer, 1960).
In this thesis, we will be especially interested in parameter estimation. Since the space of the
true states of the world is the set of values that the parameter of interest can take, we will simply
refer to Θ as the parameter space. In estimation problems, the space of decisions, denoted D,
is generally taken to be identical to the parameter space, Θ. In addition, both spaces are also
usually defined as subsets of the Real line. That is, we have
D = Θ ⊆ R.

(2.2)

For convenience, we will assume in this section that θ is univariate and study the multivariate
case in section . Moreover, the space of consequences is defined as the positive half of the Real
line [0, +∞). Thus, when considering point estimation problems, such as the ones of interest in
the present thesis, a decision problem will be defined as (Θ, Θ, [0, +∞), L), with L satisfying
L : Θ × Θ 7→ [0, +∞).

(2.3)

Albeit our discussion has centered on the specification of a particular loss function, historically,
the definition of a total ordering on Z has been associated with the choice of an arbitrary utility
function (see von Neumann and Morgenstern, 1944). However, the use of an unbounded utility
leads to several problems, as exemplified by the Saint Petersburg’s paradox. (This paradox involves
a gamble, which results in an infinite average gain, thereby leading to the conclusion that an
arbitrarily high entrance fee should be paid to participate in the game (see Robert, 2007, for a full
description).) As a result, the codomain of the utility function is usually taken to be bounded,
with U : Θ × Θ 7→ (−∞, 0]. This gives the following relationship with our preceding definition of

12

the loss function in estimation problems,
U (θ, δ) = −L(θ, δ).

(2.4)

In the context of decision theory, point estimation problems can be naturally conceived as
games, where the player attempts to minimise her losses (see Berger, 1980). Such losses, however,
are associated with some level of uncertainty. That is, there exists a space P of probability
distributions on Z. The total ordering on the space of consequences Z can then be transposed
onto the probability space P, using the expectation operator. An axiomatic construction of a total
ordering  on Z leading to the proof of the existence of a utility or loss function can be found in
several texts (see Savage, 1954, Fishburn, 1964, Kreps, 1988) or see Robert (2007) for a modern
treatment. The purpose of the game is therefore to minimise one’s loss, by selecting the optimal
decision, δ ∗ , which is defined as follows,
δ ∗ := argmin E[L(θ, δ)],

(2.5)

δ∈D

where := indicates that the LHS is defined as the RHS. Here, the two schools of thought in statistics
differ in their handling of the expectation operator. Frequentist and Bayesian statisticians have
traditionally chosen different types of expectations, as we describe in the next section.

2.1.2

Frequentist and Bayesian Decision Theories

From a statistical perspective, the specification of the space of the states of the world Θ and the
decision space D are complemented by the definition of a sample of observations, which we will
denote by y := {y1 , . . . , yn }, where y ∈ Y ⊆ Rn . We assume that this sample was generated from
a population distribution p(y|θ), with θ ∈ Θ. Our decision δ is therefore computed on the basis
of this sample, and we will denote this dependency by δ(y). Following Robert (2007), we will use
the term estimator to refer to the function δ(·). That is, an estimator is the following mapping,
δ : Y 7→ D,

(2.6)

where D is taken to be equivalent to the space of states of the world, Θ. An estimate, by contrast,
will be a single value in D = Θ, given some observation y.
From a frequentist perspective, the experiment that has generated the finite sample of observations y is assumed to be infinitely repeatable (Robert, 2007). Under this assumption of
repeatability, the optimal decision rule δ can be defined as the rule that minimises the expectation
of the loss function with respect to the (unknown) population distribution p(y|θ). This gives
Z
RF [θ, δ(y)] := L(θ, δ(y))p(y|θ)dy.
(2.7)
Y

The quantity RF is called the frequentist risk, whereas p(y|θ) can be regarded as the likelihood
function of traditional statistics, evaluated at the true state of the world, θ ∈ Θ.
In the context of Bayesian theory, by contrast, we specify a prior distribution on the space
of the states of the world, Θ. This distribution, denoted p(θ), reflects our uncertainty about the
true state of the world. Given these assumptions and the specification of a particular prior, it is
then possible to integrate over the parameter space. This gives the following Bayesian version of
equation (2.7),
ZZ
RB [p(θ), δ(y)] :=

L(θ, δ(y))p(y|θ)p(θ)dy dθ,

(2.8)

ΘY

which is usually termed the Bayes risk. Note that RB takes the prior distribution p(θ) as an
argument, since its value entirely depends on the choice of prior distribution on θ. The optimal
∗
decision δ that minimises RB in equation (2.8) can be shown (using Fubini’s theorem and Bayes’

13

rule, see Robert (2007) for a proof) to be equivalent to the argument that minimises the posterior
expected loss, which is defined as follows,
Z
ρ [p(θ|y), δ(y)] := L(θ, δ(y))p(θ|y)dθ,
(2.9)
Θ

where p(θ|y) is the posterior distribution of θ, obtained via Bayes’ rule,
p(θ|y) = R

p(y|θ)p(θ)
.
p(y|θ)p(θ)dθ
Θ

(2.10)

Since minimisation of ρ for all y is equivalent to the minimisation of RB , we will generally use the
terms Bayes risk and posterior (expected) loss interchangeably. The optimal decision under both
the Bayes risk and the posterior loss is termed the Bayes choice, action or decision.
For notational convenience, we will use the following shorthand for the posterior loss,
ρ [θ, δ(y)] := ρ [p(θ|y), δ(y)] ,

(2.11)

where the dependence of ρ on the posterior distribution p(θ|y), and the dependence of the decision
δ(y) on the data are made implicit. In addition, since in this thesis, we will adopt a Bayesian
approach to statistical inference, all expectation operator will be defined with respect to the
appropriate posterior distribution of the parameter of interest, generally denoted θ, except when
otherwise specified.
The defining condition for the Bayes choice to exist is that the Bayes risk is finite. In the
preceding discussion, we have assumed that the prior distribution on θ is proper. When specifying
improper priors, the Bayes risk will, in general, not be well defined. In some cases, however –when
an improper prior yields a proper posterior– the posterior expected loss will be well defined. The
decision that minimises ρ in that context is then referred to as the generalised Bayes estimator.
Several commonly used models in spatial epidemiology make use of improper prior distributions,
which nonetheless yield proper posteriors. In such cases, we will be using the generalised Bayes
estimator in the place of the Bayes choice.
We thus readily see why decision theory and Bayesian statistics form such a successful combination. The use of a prior distribution in Bayesian models completes the assumptions about the
space of the states of the world in decision theory. By contrast, the frequentist perspective runs
into difficulties by conditioning on the true parameter θ. As a result, the decisions that minimise
RF are conditional on θ, which is unknown. In a Bayesian setting, by contrast, the expected loss
is evaluated conditional on y, which does not constitute a problem since such observations are
known (see also Robert, 2007, for a discussion).
Decision theory puts no constraints on the nature of the loss function that one may utilise.
It should be clear from the foregoing discussion that the specification of the loss function will
completely determine which decision in D is considered to be optimal, everything else being
equal. In practice, the choice of a particular loss function is dependent on the needs of the
decision maker, and which aspects of the decision problem are of interest. However, to facilitate
comparisons between different estimation problems, there exists a set of loss functions which are
widely accepted and used throughout the statistical sciences. These classical loss functions are
described in the following section.

2.1.3

Classical Loss Functions

There exist three classical loss functions, which constitute the building blocks of many other loss
functions, and are therefore of key importance to our development. They are the following: (i)
the squared error loss, (ii) the absolute value error loss and (iii) the 0/1-loss. We review them
in turn, alongside their corresponding minimisers. These three loss functions are especially useful
for estimation problems, and will therefore be described with respect to some known sample of

14

observations, y.
Squared Error Loss
The quadratic loss or squared error loss (SEL) is the most commonly used loss function in the
statistical literature. It is defined as the Euclidean distance between the true state of the world θ
and the candidate estimator δ(y). Thus, we have
SEL(θ, δ(y)) := (θ − δ(y))2 .

(2.12)

In a Bayesian context, this loss function can be minimised by integrating SEL(θ, δ(y)) with respect
to the posterior distribution of θ, and minimising the posterior expected loss with respect to δ(y).
Since the SEL is strictly convex, there exists a unique minimiser to SEL, which is the posterior
mean: E[θ|y]. We will usually denote E[θ|y] by θSEL , when comparing that particular estimator
with other estimators based on different loss functions.
Absolute Value Error Loss
Another classical loss function is the absolute error loss (AVL), which makes use of the modulus
to quantify one’s losses. It is defined as follows,
AVL(θ, δ(y)) := |θ − δ(y)|,

(2.13)

and its minimiser in the context of Bayesian statistics, is the posterior median, which will be
denoted θAVL . It can be shown that the posterior median is not the unique minimiser of the
posterior expected AVL (see Berger, 1980). In addition, since the posterior median will be found
to be the optimal Bayes choice under other loss functions, it will be useful to denote this quantity
without any reference to a specific loss function. We will therefore use θMED to denote the
posterior median in this context. This quantity will be discussed in greater details in chapter 4,
when considering the classification of the elements of a parameter ensemble.
0/1-Loss
For completion, we also introduce the 0/1-loss function. It is defined as follows,
(
0 if δ(y) = θ;
L0/1 (θ, δ(y)) =
1 if δ(y) 6= θ.

(2.14)

The optimal minimiser of the 0/1-loss under the posterior distribution of θ is the posterior mode.
In the sequel, we will drop any reference to the data y, when referring to the estimator δ(y), and
simply use the notation δ. We now turn to a more specific aspect of loss function optimisation,
which will be especially relevant to the research questions addressed in this thesis.

2.1.4

Functions of Parameters

It will be of interest to consider the estimation of functions of parameters, say h(θ), where h
is some mapping from Θ to itself, or possibly to a subset of the true states of the world. For
convenience, we will assume in this section that θ is univariate, and study the multivariate case in
section 2.2.3. In such cases, the Bayesian decision problem can be formulated as follows. Choose
∗
the δ , which is defined as,
∗
δ := argmin ρ (h(θ), δ) ,
(2.15)
δ

where the minimisation is conducted over the decision space, here defined as D ⊆ Θ. When the
loss function of interest is the SEL, we then have the following equality, for any arbitrary function
h(·) of the parameter θ,
 i
h
2
E [h(θ)|y] = argmin E (h(θ) − δ)  y .
(2.16)
δ

15

ξ

θ1

...

θk+1

θk

θk−1

...

θn

Y1

...

Yk−1

Yk

Yk+1

...

Yn

Figure 2.1. Directed Acyclic Graph (DAG) for a general hierarchical model, with y = {y1 , . . . , yn }
denoting n observations and θ = {θ1 , . . . , θn } denoting the parameter ensemble of interest. The prior
distribution of each θi is controlled by a vector of hyperparameter ξ, which is given a hyperprior. Following
standard convention, arrows here indicate direct dependencies between random variables.
∗

That is, the optimal estimator δ ∈ D of h(θ) is the posterior expectation of h(θ). Here, the
decision problem is fully specified by defining both the parameter space Θ and the decision space
D, as the codomain of h(·).
If, in addition, h(·) is a linear function, it then follows from the linearity of the expectation
that
E [h(θ)|y] = h(E [θ|y]).
(2.17)
However, for non-linear h(·), this relationship does not hold. Let ρ denotes an arbitrary Bayesian
expected loss for some loss function L, we then have the following non-equality,


∗
∗
δ := argmin ρ (h(θ), δ) 6= h argmin ρ (θ, δ) =: h(θ ).
(2.18)
δ

δ
∗

∗

Much of this thesis will be concerned with the differences between δ and h(θ ), for particular
ρ’s. An estimator of h(θ) based on an estimator of θ will be referred to as a plug-in estimator.
∗
Thus, in equation (2.18), h(θ ) is the plug-in estimator of h(θ). Our use of the term plug-in,
here, should be distinguished from its utilisation in reference to the plug-in principle introduced
by Efron and Tibshirani (1993) in the context of the bootstrap. For Efron and Tibshirani (1993),
plug-in estimators have desirable asymptotic properties in the sense that such estimators cannot
∗
be asymptotically improved upon. In the present thesis, however, estimators such as h(θ ) are not
∗
deemed to be necessarily optimal, except in the sense that θ is the Bayes action for some ρ (θ, δ).
Specifically, it will be of interest to evaluate whether commonly encountered optimal Bayes
actions, such as the posterior means and medians can be used to construct quasi-optimal plug-in
estimators. This problem especially arises when the true parameter of interest is an ensemble of
parameters, as described in the next section.

2.2

Parameter Ensembles and Hierarchical Shrinkage

The notion of a parameter ensemble will be the object of most of our discussion in the ensuing
two chapters. In this section, we define this concept for general Bayesian models as well as for
specific hierarchical models that will be considered throughout the thesis. In addition, we present
the Ghosh-Louis theorem, which originally motivated research on the specific inferential problems
associated with parameter ensembles.

16

2.2.1

Bayesian Hierarchical Models

Bayesian hierarchical models (BHMs) can be conceived as Bayesian extensions of traditional mixed
models, sometimes called multilevel models, where both fixed and random effects are included in a
generalized linear model (see Demidenko, 2004). In its most basic formulation, a BHM is composed
of the following two layers of random variables,
ind

yi ∼ p(yi |θi , σi ),

g(θ) ∼ p(θ|ξ),

(2.19)

for i = 1, . . . , n and where g(·) is a transformation of θ, which may be defined as a link function as
commonly used in generalised linear models (see McCullagh and Nelder, 1989). The probability
density function at the first level of the BHM, p(yi |θi , σi ), is the likelihood function. The joint
distribution on the g(θ), here denoted p(θ|ξ), is a multivariate prior, which is directly specified as
a distribution on the transformed θ. Different choices of transformations, g(·), will hence induce
different joint prior distributions. The specification of a BHM is complete when one fixes values for
the vector of hyperparameters, ξ, or specifies a hyperprior distribution for that quantity. When the
θi ’s are independent and identically distributed (iid) given ξ, we obtain the hierarchical structure
described in figure 2.1 on page 16, which is represented using a directed acyclic graph (DAG). By
extension, we will refer to the prior on such θi ’s as an iid prior.
In the sequel, we will assume that the n vectors of nuisance parameters σi are known, albeit in
practice, this may not be the case. Typically, such σi ’s will include the sampling variance of each
yi . In its simplest form, the model in equation (2.19) will be assumed to be composed of conjugate
and proper probability density functions and each θi will be an iid draw from a hierarchical
prior. These modelling assumptions, however, will be sometimes relaxed in the present thesis. In
particular, we will be interested in the following three variants.
i. Conjugate proper iid priors on the θi ’s, where the link function g(·) is the identity function.
This simple case will encompass both the Normal-Normal model –sometimes referred to as
compound Gaussian model– and the compound Gamma or Gamma-Inverse Gamma model.
For the former, we have the following hierarchical structure,
ind

yi ∼ N (θi , σi2 ),

iid

θi ∼ N (µ, τ 2 ),

(2.20)

with i = 1, . . . , n, and where the σi2 ’s are known variance components. Secondly, for the
Gamma-Inverse Gamma model, we specify the following likelihood and prior,
ind

yi ∼ Gam(ai , θi ),

iid

θi ∼ Inv-Gam(α, β),

(2.21)

where the Gamma and Inverse-Gamma distributions will be specifically described in section
3.3.2.
ii. Non-conjugate proper iid priors on the θi ’s. In standard epidemiological settings, the specification of a Poisson likelihood for the observations naturally leads to the modelling of the
logarithm of the relative risks at the second level of the hierarchy. Such a model is sometimes
referred to as a log-linear model. In such cases, however, the conjugacy of the likelihood
with the prior on the θi ’s does not hold anymore. As an example of such non-conjugacy, we
will study the following model,
ind

yi ∼ Pois(θi Ei ),

iid

log θi ∼ N (α, τ 2 ),

(2.22)

for i = 1, . . . , n, where the link function g(·) := log(·). Here, the conjugacy of the prior with
the Poisson likelihood does not hold, and specific sampling schemes need to be adopted in
order to evaluate the posterior distributions of the θi ’s (see Robert and Casella, 2004).
iii. Non-conjugate improper non-iid priors on the θi ’s. In this final situation, all assumptions on
the prior distributions of the θi ’s will be relaxed. This type of model will be illustrated
17

in the context of spatial epidemiology, where Poisson-based generalized linear models are
commonly used to model counts of disease cases in each of a set of geographical areas, and
the joint prior distribution on the θi ’s models the spatial dependence between the regions of
interest. A popular choice of prior distribution reflecting inter-regional spatial dependence
is the intrinsic Gaussian conditional autoregressive (CAR) prior –an instance of a Markov
random field. The intrinsic CAR does not constitute a proper distribution (Besag, 1974).
However, Besag et al. (1991) have shown that the resulting marginal posterior distributions
of the θi ’s are proper (see also Besag and Kooperberg, 1995). It then follows that the
posterior expected loss for the parameter ensemble is finite, and that we can therefore derive
the generalised Bayes decision, which will be optimal for that decision problem. We describe
this particular family of spatial models in more detail in the following section.
In this thesis, when studying the properties of such epidemiological models, we will employ the
term prevalence to refer to the rate of a particular condition in the population at risk. That is,
the term prevalence here refers to the number of affected cases divided by the total number of
individuals at risk for that condition.

2.2.2

Spatial Models

Here, we briefly present some conventional modelling assumptions made in spatial epidemiology,
which will be used throughout the thesis (Wakefield et al., 2000). The starting point for modelling
a non-infectious disease with known at-risk populations is the Binomial model,
yij |pij ∼ Bin(Nij , pij ),

i = 1, . . . , n;

j = 1, . . . , J,

(2.23)

where pij and Nij represent, respectively, the risk of disease and the population size in the ith area
for the j th age strata. In this thesis, we are especially interested in modelling the prevalence of
rare non-infectious diseases, such as specific types of cancers. For rare conditions, we approximate
this model with a Poisson model
yij |pij ∼ Pois(Nij pij ).
(2.24)
Furthermore, we generally make a proportionality assumption, which states that pij = θi × pj ,
where θi is the relative risk (RR) for the ith area, and pj is the reference rate for age strata j,
which is assumed to be known. Each θi is here the ratio of the age-standardised rate of the disease
in area i compared to the age-standardised reference rate. Using the proportionality assumption,
we may then sum over the risk in each strata in order to obtain
ind

yi ∼ Pois(θi Ei ),

(2.25)

PJ
PJ
where yi = j=1 yij and Ei = j=1 Nij pj are the observed and expected counts, respectively.
Equation (2.25) is the likelihood of the model. Maximum likelihood, in this context, produces the
following point estimate ensemble,
yi
,
(2.26)
θ̂iMLE :=
Ei
for every i = 1, . . . , n, which are generally referred to as the standardised mortality or morbidity
ratios (SMRs). The θ̂iMLE ’s, however, tend to be over-dispersed in comparison to the true RRs.
In order to provide such a model with more flexibility, different types of hierarchical priors are
commonly specified on the θi ’s (see Wakefield et al., 2000, for a review). Two spatial BHMs will be
implemented in this thesis. A popular hierarchical prior in spatial epidemiology is the convolution
prior (Besag et al., 1991), which is formulated as follows,
log θi = vi + ui ,

(2.27)

for every region i = 1, . . . , n. Note, however, that this model will be implemented within the
WinBUGS software, which uses a different representation of the spatial random effects, based on

18

the joint specification of an intercept with an improper flat prior and a sum-to-zero constraint on
the ui (see Appendix C, and section 3.4.3).
Here, v is a vector of unstructured random effects with the following specification,
iid

vi ∼ N (0, τv2 ),

(2.28)

and the vector u captures the spatial auto-correlation between neighbouring areas. Priors on each
element of u are specified conditionally, such that
P

2
j∈∂i uj τu
ui |uj , ∀ j 6= i ∼ N
,
,
(2.29)
mi
mi
with ∂i is defined as the set of indices of the neighbours of the ith area. Formally, ∂i := {j ∼ i :
j = 1, . . . , n}, where i ∼ j implies that regions i and j are neighbours, and by convention, i ∈
/ ∂i .
Moreover, in equation (2.29), we have also used mi := |∂i | –that is, mi is the total number of
neighbours of the ith area. Therefore, each of the ui ’s is normally distributed around the mean
level of risk of the neighbouring areas, and its variability is inversely proportional to its number
of neighbours.
A different version of this model can be formulated using the Laplace distribution (Besag
et al., 1991). As this density function has heavier tails, this specification is expected to produce
less smoothing of abrupt changes in riskP
between adjacent areas. For the CAR Laplace prior,
we therefore have ui |uj , ∀ j 6= i ∼ L(ui | j∈∂i uj /mi , τu2 /mi ), for every i = 1, . . . , n, using the
following definition of the Laplace distribution,


1
1
exp
|m0 − x| .
(2.30)
L(x|m0 , s0 ) :=
2s0
s0
We will refer to this model as the CAR Laplace or L1 model. The rest of the specification of
this BHM is identical to the one chosen for the CAR Normal. In these two models, following
common practice in spatial epidemiology, two regions are considered to be neighbours if they
share a common boundary (Clayton and Kaldor, 1987, Besag et al., 1991, Waller et al., 1997).

2.2.3

Estimation of Parameter Ensembles

The set of parameters, θi ’s, in the hierarchical model described in equation (2.19) is generally
referred to as a vector of random effects (Demidenko, 2004). In this thesis, we will refer to such a
vector as an ensemble of parameters. That is, in a BHM following the general structure presented
in equation (2.19), the vector of parameters,
θ := {θ1 , . . . , θn },

(2.31)

will be referred to as a parameter ensemble. Several properties of a parameter ensemble may
be of interest. One may, for instance, wish to optimise the estimation of each of the individual
elements in the ensemble. A natural choice in this context is the sum of quadratic losses for each
parameter. This particular loss function is the summed squared error loss (SSEL) function that
takes the following form,
n
 X
2
SSEL θ, θ est =
θi − θiest ,
(2.32)
i=1

In this context, using the notation that we have adopted in section 2.1.1, the decision problem for
the estimation of a parameter ensemble using the SSEL function results in a parameter space Θ
and a decision space D which are both assumed to be subsets of Rn . The posterior expected loss
associated with the loss function in equation 2.32 can be minimised in a straightforward manner.
Its optimum is attained when selecting the vector of posterior means as Bayes choice, which will

19

be denoted by
θ̂ SSEL := {θ̂1SSEL , . . . , θ̂nSSEL } = {E[θ1 |y], . . . , E[θn |y]}.

(2.33)

This type of decision problems, characterised by the estimation of a set of parameters are sometimes
referred to as compound estimation problems or compound loss functions (Ghosh, 1992). We will
use of the term estimator to refer to an entire set of point estimates, such as θ̂ SSEL with respect to
a particular loss function, here SSEL. This indeed follows from the fact that such a multivariate
estimator is optimal under that posterior loss. Such an estimator, however, also constitutes an
ensemble of single point estimates.
Another property of a parameter ensemble, which may be of interest is the empirical distribution function (EDF) of that ensemble, which will generally be referred to as the ensemble
distribution. The EDF of θ is defined as follows,
n

Fn (t) :=

1X
I{θi ≤ t},
n i=1

(2.34)

for every t ∈ R, and where I is the usual indicator function. The term EDF is used here in
analogy with its usual application in the context of iid observations. Note, however, that neither
the elements of a true parameter ensemble nor the realisations of random effects can (in general) be
assumed to be realisations of iid variables. A range of different loss functions may be considered in
order to optimise the estimation of the EDF in equation (2.34). Previous authors have formalised
this decision problem by using the integrated squared error loss function (ISEL), which takes the
following form (see Shen and Louis, 1998),
Z
est
ISEL(Fn , Fn ) := (Fn (t) − Fnest (t))2 dt.
(2.35)
The posterior expectation of the ISEL can be easily minimised using Fubini’s theorem to invert
the ordering of the two integrals (i.e. the one with respect to t, and the one with respect to θ,
see Shen and Louis (1998), for a formal proof). It then follows that the optimal estimator of
E[ISEL(Fn , Fnest )|y] is the posterior EDF,
n

1X
P[θi ≤ t|y].
Fbn (t) := E[Fn (t)|y] =
n i=1

(2.36)

When there may be ambiguity as to which parameter ensemble the posterior EDF is based on, we
will emphasise the dependence on the vector θ, by using Fbθ (t).
Finally, as discussed in section 2.1.4, one is sometimes interested in specific functions of a
parameter. For the case of parameter ensembles, summary functions are often used to quantify
particular properties of the ensemble distribution, such as the variance of the ensemble, for instance. These functions are generally real-valued, and the decision problem, in this context, can
therefore be formalised as the standard quadruple: (R, R, [0, +∞), L), for some loss function L.
When using the quadratic loss, we may have
SEL(h(θ), δ) = (h(θ) − δ)2 ,

(2.37)

for a function of interest, h : Θ 7→ Θ, with Θ ⊆ Rn and Θ ⊆ R. One may, for instance, wish to
estimate the empirical variance of the parameter ensemble. This gives the following h(·),
n

1X
(θi − θ̄)2 ,
h(θ) :=
n i=1

(2.38)

Pn
where θ̄ := n−1 i=1 θi . Naturally, in this particular case, the optimal Bayes estimator would
be E[h(θ)|y]. However, as argued in section 2.1.4, since h(·) is a non-linear function of θ, the
posterior empirical variance is different from the empirical variance of the posterior means. It
20

turns out that this particular observation has led to a key result in the study of BHMs, as we
describe in the next section.

2.2.4

Hierarchical Shrinkage

Although the vector of posterior means is optimal under SSEL, their empirical variance is biased
in comparison to the empirical variance of the true parameters of interest. The theorem that
shows this systematic bias was first proved by Louis (1984) for the Gaussian compound case and
further generalised by Ghosh (1992), who relaxed the distributional assumptions, but retained
the modelling assumptions. In particular, whereas Louis (1984) proved this result for the case of
conjugate models composed of Normal distributions, Ghosh (1992) showed that this relationship
also holds for non-conjugate models based on arbitrary probability densities.
Theorem 1 (Ghosh-Louis Theorem). Let a parameter ensemble θ controlling the distribution
of a vector of observations y, in a general two-stage hierarchical model as described in equation
(2.19). If n ≥ 2, then
 #
"
#2
n
n
n

1X
1X
1X
2
(θi − θ̄)  y ≥
E[θi |y] −
E[θi |y] ,
E

n i=1
n i=1
n i=1
"

(2.39)

Pn
where θ̄ := n−1 i=1 θi ; with equality holding if and only if all {(θ1 − θ̄), . . . , (θn − θ̄)} have
degenerate posteriors.
A proof of this result is provided in Ghosh (1992), and a weighted version is presented in
Frey and Cressie (2003). The Ghosh-Louis theorem bears a lot of similarity with the law of total
variance, which posits that Var(X) = E [Var (X|Y )] + Var (E [X|Y ]). One may, however, note
that there exists one substantial difference between this standard law of probability and the result
at hand. The Ghosh-Louis theorem differs from the law of total probability in the sense that the
former is conditioning on the data on both sides of the equation.
The Ghosh-Louis theorem states a general property of BHMs. Hierarchical shrinkage is the
under-dispersion of the empirical distribution of the posterior means in comparison to the posterior
mean of the empirical variance of the true parameter ensemble. This should be contrasted to the
commonly encountered issue of shrinkage in Bayesian model, where a single posterior mean is
shrank towards its prior mean. Although hierarchical shrinkage is here presented as a problem, it
is often seen as a desirable property of BHMs; most especially when little information is available
for each data point. This theorem has been used both to justify such a modelling decision and
to highlight the limitations of this choice. In spatial epidemiological settings, Gelman and Price
(1999) have shown that such shrinkage especially affects areas with low expected counts. Before
reviewing the different decision-theoretic solutions that have been proposed to produce better
estimates of the empirical properties of parameter ensembles, we briefly introduce several statistical
concepts, which will be useful in the sequel.

2.3
2.3.1

Ranks, Quantile Functions and Order Statistics
Ranks and Percentile Ranks

We here adopt the nomenclature introduced by Laird and Louis (1989) on order statistics and rank
percentiles as a guidance for our choice of notation. Of particular importance to our development
is the definition of a rank. The rank of an element in a parameter ensemble is defined as follows,
Ri (θ) := rank(θi |θ) =

n
X

I {θi ≥ θj } ,

(2.40)

j=1

21

where the smallest θi in θ is given rank 1 and the largest θi is given rank n. In equation (2.40),
we have made explicit the fact that the rank of each θi depends on the entire parameter ensemble,
θ. In particular, this notation emphasises the fact that the function Ri (·) is non-linear in its
argument.
In the sequel, we will also make extensive use of percentile ranks (PRs). These are formally
defined as follows,
Ri (θ)
,
(2.41)
Pi (θ) :=
n+1
Quite confusingly, percentile ranks are sometimes referred to as “percentiles”, which should not
be confused with the notion of percentiles discussed in section 2.3.2 in reference to quantiles. In
general terms, the percentile rank of an element in a parameter ensemble is the percentage of
elements in the corresponding EDF, which are lower or equal to the value of that rank. Rank percentiles are especially useful in statistics when communicating ranking statistics to practitioners.
Percentile ranks are empirical quantities, in the sense that they depend on the size of the parameter ensemble, n. However, it can be shown that percentile ranks rapidly converge to asymptotic
quantities, which are independent of n (Lockwood et al., 2004).

2.3.2

Quantile Function

The quantile function, denoted Q(p), of a continuous random variable X is formally defined as
the inverse of the cumulative distribution function (CDF), F (x). Formally, since the function
F : R 7→ [0, 1] is continuous and strictly monotonic, we can define
Q(p) := F −1 (p),

(2.42)

for some real number p ∈ [0, 1]. In general, the inverse function of the CDF of most random
variables does not exist in closed-form. Among the rare exceptions are the uniform distribution, unif(x|a, b), and the exponential distribution, exp(x|λ), for which the quantile functions are
Q(p|a, b) = (1 − p)a + pb and Q(p|λ) = − log(1 − p)/λ, respectively (see Gilchrist, 2000). For
discrete random variables, whose CDF may only be weakly monotonic, the quantile distribution
function (QDF) is defined as
Q(p) := inf {x ∈ R : F (x) ≥ p} ,

(2.43)

for every p ∈ [0, 1]. Note that the latter definition holds for any arbitrary CDF, whether continuous
or discrete. Like the CDF, the QDF is monotone non-decreasing in its argument. It is continuous
for continuous random variables, and discrete for discrete random variables. However, whereas
the F (x) is right-continuous, its inverse is, by convention, continuous from the left. This last
property is a consequence of the use of the infimum in equation 2.43. When it is deemed necessary
for clarity, we will specify the random variable for which a quantile is computed by a subscript,
such as in QX (p), for the random variable X. More generally, we will distinguish between the
theoretical QDF and the empirical QDF, by denoting the former by Q(p) and the latter by Qn (p).
For some parameter ensemble θ of size n, we define the empirical QDF as follows,
Qn (p) := min {θ1 , . . . , θn : Fn (θi ) ≥ p} ,

(2.44)

where Fn is the EDF of the parameter ensemble as defined in equation (2.34). Note that our
utilisation of the EDF, in this context, corresponds to a slight abuse of the concept. As aforementioned, the EDF of a particular random variable, assumes that several iid realisations of
that random variable are available. In our case, given the hierarchical nature of the models under
scrutiny, and the possible spatial structure linking the different geographical units of interest, such
an iid assumption is not satisfied. Our use of the term empirical distribution should therefore be
understood solely in reference to our chosen mode of construction for the discrete distribution of
an ensemble of realisations.

22

When we wish to emphasise the vector of parameters with respect to which the QDF and EDF
are defined, we will use the notation, QX and FX , respectively. Sometimes, it will be useful to
allow the function Q(·) to accept multivariate arguments, such as p := {p1 , . . . , pk }. In such cases,
the QDF will be vector-valued, such that
Q(p) = Q({p1 , . . . , pk }) = {Q(p1 ), . . . , Q(pk )}.

(2.45)

In contrast to the sample mean, for which the relationship E[g(X)] = g(E[X]) only holds for
linear function g(·), the quantile function satisfies
Qh(X) (p) = h[Q(p)],

(2.46)

for every monotonic non-decreasing function h(·). In particular, we have the following useful
transformation
Qlog(X) (p) = log [QX (p)] ,
(2.47)
which follows from the monotonicity of the logarithm. Moreover, we can recover the mean of X
from its quantile function, by integrating the quantile function over its domain. That is,
Z
QX (p)dp = E[X],
(2.48)
[0,1]

which is a standard property of the quantile function (see Gilchrist, 2000). When considering
the quantile function of the standard cumulative normal distribution, denoted Φ(x), the quantile
function specialises to the probit, defined as probit(p) := Φ−1 (p). The probit is widely used in
econometrics as a link function for the generalised linear model when modelling binary response
variables.

2.3.3

Quantiles, Quartiles and Percentiles

In this thesis, we will be mainly concerned with the quantiles of parameter ensembles, these
quantities will therefore be defined with respect to the EDF of a vector θ. In such cases, the pth
empirical quantile of the ensemble θ is formally defined as
θ(p) := Qθ (p),

(2.49)

where the .50th quantile is the empirical median. In the sequel, we will also make use of the .25th ,
.50th and .75th quantiles, which are referred to as the first, second and third empirical quartiles,
respectively. Of particular interest is the difference between the third and first quartiles, which
produces the empirical interquartile range (IQR). For some parameter ensemble θ, we have
IQR(θ) := θ(.75) − θ(.25) .

(2.50)

In some texts, the term quantile is used to classify different types of divisions of the domain
of a probability distribution. More precisely, the k th q-quantile is defined as Qθ (k/q). In that
nomenclature, the percentiles therefore correspond to the 100-quantiles, which would imply that
the values taken by the quantile function are, in fact, percentiles. Other authors, however, have
used the term quantile in a more straightforward manner, where the pth quantile is simply defined
as Qθ (p), as in equation (2.49) (see, for instance, Koenker and Bassett, 1978). In the sequel, we
adopt this particular definition of quantiles and only use the term percentiles to refer to percentile
ranks, as introduced in section 2.3.1.
There exist different techniques to derive the quantile function and quantiles of a particular
CDF (see Steinbrecher and Shaw, 2008, for recent advances). One of the most popular methods has
been the algorithm AS 241 (Wichura, 1988), which permits to compute the empirical pth quantile
of any finite parameter ensemble very efficiently. We will make use of this standard computational
technique in chapter 3.
23

2.4

Loss Functions for Parameter Ensembles

In this section, we review three important approaches, which have been proposed to address the
issue of hierarchical shrinkage that we have highlighted in the previous section. These three
decision-theoretic perspectives will be specifically considered in chapters 3 and 4, and compared
with other methods through the construction of plug-in estimators. Here, the parameter space
satisfies Θ ⊆ Rn , and D = Θ, as before.

2.4.1

Constrained Bayes

In order to address the problem associated with hierarchical shrinkage, described in section 2.2,
Louis (1984) developed a particular set of point estimates that automatically correct for hierarchical
This approach is a constrained minimisation problem, where SSEL(θ, θ est ) =
Pn shrinkage.
est 2
i=1 (θi −θi ) is minimised subject to the following two constraints: (i) the mean of the ensemble
of point estimates is equal to the mean of the true ensemble,
n

θ̄est :=

n

1X
1 X est
θi =
θi =: θ̄,
n i=1
n i=1

(2.51)

and (ii) the variance of the ensemble of point estimates is equal to the variance of the true ensemble,
n

n

2
2
1 X est
1X
θi − θ̄est =
θi − θ̄ .
n i=1
n i=1

(2.52)

Based on these constraints, Louis (1984) derived the optimal Bayes estimator minimising the
corresponding constrained SSEL function. Since this method is developed within a Bayesian
framework, it is generally referred to as the constrained Bayes (CB) or constrained empirical
Bayes (EB) estimator, albeit its use is not restricted to models estimated using EB techniques
(see Rao, 2003). This result was further generalised by Ghosh (1992) for any distribution belonging
to the exponential family.
Theorem 2 (Ghosh-Louis Estimator). The minimiser of the SSEL under the constraints in equation (2.51) and (2.52) is
θ̂iCB := ω θ̂iSSEL + (1 − ω)θ̄ˆSSEL ,
(2.53)
P
n
where θ̂iSSEL := E[θi |y], for every i = 1, . . . , n, and θ̄ˆSSEL := 1/n i=1 θ̂iSSEL is the mean of the
empirical distribution of posterior means. The weight ω is defined as
1/2


−1


ω = 1 +

n

n
P
n
−1

Pn

i=1

i=1



Var [θi |y]

θ̂iSSEL

− θ̄ˆSSEL


2 

,

(2.54)

where Var[θi |y] is the posterior variance of the ith parameter in the ensemble.
Proof. The minimisation of the posterior expected loss is a constrained minimisation problem,
which can be solved using Lagrange multipliers (see Rao, 2003, page 221).
The role played by the weight ω is more explicitly demonstrated by transforming equation
(2.53), in order to obtain the following


θ̂iCB = θ̄ˆSSEL + ω θ̂iSSEL − θ̄ˆSSEL .
(2.55)
In addition, note that the expression in equation (2.53) resembles a convex combination of the
corresponding SSEL estimator of the ith element with respect to the mean of the ensemble. This

24

is not the case, however, since the weight ω may take values greater than unity. Note also that
the weights do not depend on the index i. This is a constant quantity, which is identical for all
elements in the parameter ensemble. In particular, for the Gaussian compound case, described in
equation (3.19), the CB estimates have a direct interpretation in terms of hierarchical shrinkage.
Let
ind
iid
yi ∼ N (θi , σ 2 ),
θi ∼ N (µ, τ 2 ),
(2.56)
where we assume that σ 2 , τ 2 and µ are known. Note that here, for convenience, we have assumed
σ 2 to be constant over all elements in the parameter ensemble, which differs from the model
specification described in equation (3.19). The use of the Bayes’ rule under quadratic loss yields
the conventional posterior mean, θ̂iSSEL = γyi +(1−γ)µ, where γ is the countershrinkage parameter,
defined as
τ2
.
(2.57)
γ := 2
σ + τ2
In this context, it can be shown that the Ghosh-Louis constrained point estimates bears some
important structural similarities with the formulae of the posterior means for this model. We have
.
θ̂iCB = γ 1/2 yi + (1 − γ 1/2 )µ,

(2.58)

.
where 0 ≤ γ ≤ 1 (see Rao, 2003, p.212), for every i = 1, . . . , n, and where = means that the
equality is an approximation. This is a particularly illuminating result, which intuitively illustrates
how this estimator controls for the under-dispersion of the posterior means. The coutershrinkage
parameter γ is here given more weight by taking its square root, as opposed to the use of γ in
computing the θ̂iSSEL ’s. This produces a set of point estimates which are therefore more dispersed
than the posterior means.
This set of point estimates has very desirable asymptotic properties. As an ensemble, the mean
and the variance of the CB point estimates converge almost surely to the mean and variance,
respectively, of the true ensemble distribution (Ghosh and Rao, 1994). Furthermore, the CB
estimator has a readily interpretable formulation as a shrinkage estimator, as we have seen for the
compound Gaussian case. However, the CB approach also suffers from an important limitation:
Its performance will be greatly influenced by the functional form of the true ensemble distribution.
In particular, since the CB estimator only match the first two moments of the true ensemble, the
empirical distribution of the CB point estimates may provide a poor approximation of the ensemble
distribution, when the distribution of interest is substantially skewed. The next approach attempts
to address this limitation by directly optimising the estimation of the EDF of the parameter
ensemble.

2.4.2

Triple-Goal

The triple-goal estimator of a parameter ensemble was introduced by Shen and Louis (1998). It
constitutes a natural extension of the CB approach. Here, however, instead of solely constraining
the minimisation exercise with respect to the first two moments of the ensemble distribution, we
consider three successive goals, which are optimised in turn (see also Shen and Louis, 2000). The
set of point estimates resulting from these successive minimisations are generally referred to as the
GR point estimates, where G denotes the EDF and R refers to the ranks. For consistency, we will
therefore adhere to this acronym in the sequel (Shen and Louis, 1998). Note, however, that the
GR point estimates are not optimal for these three goals, but will produce very good performance
under each of these distinct objectives. These three consecutive steps can be described as follows.
i. Firstly, minimise the ISEL function, as introduced in equation (2.35), in order to obtain an
estimate Fbn (t) of the ensemble EDF, Fn (t), for some ensemble of interest, θ = {θ1 , . . . , θn }.
As we have seen in equation (2.36), the optimal estimate is the posterior EDF defined as
follows,
n
1X
Fbn (t) := E[Fn (t)|y] =
P[θi ≤ t|y].
(2.59)
n i=1
25

ii. Secondly, minimise the ranks squared error loss (RSEL) in order to optimise the estimation
of the ranks of the parameter ensemble θ. Let Rest := Rest (θ) and R := R(θ) denote the
vector of candidate ranks and the vector of true ranks, respectively. We wish to minimise
the following loss function,
n

est

RSEL(R, R

2
1X
Ri − Riest .
)=
n i=1

(2.60)

The vector of optimisers R̄ of the posterior expected RSEL is composed of the following
elements,
n
X
R̄i := E[Ri |y] =
P(θi ≥ θj |y).
(2.61)
j=1

The R̄i ’s are not generally integers. However, one can easily transform the R̄i ’s into integers
by ranking them such that
bi := rank(R̄i |R̄),
R
(2.62)
bi ’s are then used as optimal estimates of the true ranks, under
for every i = 1, . . . , n. The R
RSEL.
iii. Finally, we generate an ensemble of points estimates, conditional on the optimal estimate of
bi ’s. This is done by
the ensemble EDF, Fbn , and the optimal estimates of the true ranks, R
setting
!
bi − 1
2
R
GR
−1
,
(2.63)
θ̂i := Fbn
2n
for every i = 1, . . . , n. The −1 in the numerator of equation (2.63) arises from the minimisation of the posterior expected ISEL (see Shen and Louis, 1998, for this derivation).
Despite the seeming complexity of the successive minimisations involved in producing the triplegoal estimators, the computation is relatively straightforward (more details can be found in Shen
and Louis, 1998). We note, however, that one of the limitations of the triple-goal technique is
that it heavily relies on the quality of the prior distribution –that is, the joint prior distribution
for the θi ’s, which we denoted by p(θ|ξ) in equation (2.19). Specific non-parametric methods have
been proposed to obtain an EB estimate of the prior distribution, which permits to attenuate
these limitations. The smoothing by roughening (SBR) algorithm introduced by Shen and Louis
(1999) is an example of such a technique. In such cases, the joint prior distribution, p(θ|ξ), is
estimated using the SBR algorithm. Estimation of the parameter ensemble is then conducted using
standard Bayesian inference based on this SBR prior. Shen and Louis (1999) demonstrated good
performance of this method using simulated data and rapid convergence of the SBR algorithm.

2.4.3

Weighted and Weighted Ranks Loss Functions

The standard SSEL framework can also be extended by the inclusion of a vector of weights within
the quadratic loss. These weights, denoted φ(θi ), may be specified as a function of the unknown
parameters of interest, with φ : R 7→ R. The weights may therefore be made to vary with each of
the elements in θ. In addition, since loss functions are assumed to be strictly positive, all weights
are also constrained to be positive: they satisfy φi ≥ 0, ∀ i = 1, . . . , n. The resulting weighted
squared error loss (WSEL) is then
WSEL(φ, θ, θ est ) =

n
X

φ(θi )(θi − θiest )2 ,

(2.64)

i=1

26

with φ(θi ) ≥ 0 for all i = 1, . . . , n. The set of optimal point estimates, denoted θiWSEL ’s, that
minimise the posterior expected WSEL take the following form
θ̂iWSEL := E[φ(θi )θi |y]/E[φ(θi )|y],

(2.65)

for every i = 1, . . . , n. Naturally, if the weights do not depend on the parameters of interest, then
the optimal estimators reduce to the posterior means. That is, when the weights are independent
of θ, they can be extracted from the expectations and cancel out. In the ensuing discussion, we
will therefore implicitly assume that the weights are functions of the θ, and they will be simply
denoted by φi ’s.
The weighted ranks squared error loss (WRSEL) is a component-wise loss function that spans
the entire set of order statistics of a given function (Wright et al., 2003). The vector of weights φ
is here dependent on the ranks of each of the θi ’s. Taking θ̂iWRSEL to be the Bayes decision under
WRSEL, we therefore have a compound loss function of the form,
WRSEL(φ, θ, θ est ) =

n X
n
X

φj I{Rj = i}(θi − θiest )2 ,

(2.66)

i=1 j=1

where as before Ri := Ri (θ) is the rank of the ith element in the parameter ensemble. For
notational convenience, we write
WRSEL(φ, θ, θ est ) =

n
X

φRi (θi − θiest )2 ,

(2.67)

i=1

Pn
where φRi := j=1 φj I{Rj = i} identifies the weight that is assigned to the ith rank. The Bayes
action minimising the posterior expected WRSEL is an ensemble of point estimates θ̂ WRSEL ,
whose elements are defined as
Pn
j=1 φj E[θi |Rj = i, y]P(Rj = i|y)
WRSEL
Pn
,
(2.68)
θ̂i
:=
j=1 φj P(Rj = i|y)
where P(Rj = i|y) is the posterior probability that the ith element has rank j. Each estimator
θ̂iWRSEL can therefore be seen as a weighted average of conditional posterior means of θi , given
that this element has rank j. Note that we can further
R simplify the formulae provided by Wright
et al. (2003) by using the law of total expectation, E(x|y)p(y)dy = E(x), such that


E θi φRi |y
 ,
θ̂iWRSEL = 
(2.69)
E φRi |y
for every i = 1, . . . , n, which is equivalent to the minimiser of the standard WSEL function
presented in equation (2.64).
In addition, Wright et al. (2003) noted that the WRSEL and the SSEL are equivalent up to a
multiplicative constant, which is the vector of weights φ. That is,
WRSEL = φ SSEL .

(2.70)

Moreover, the WRSEL trivially reduces to the SSEL when φ = 1n . It therefore follows that the
WRSEL is a generalization of the SSEL. This family of loss functions allows the targeting of a
range of different inferential goals by adjusting the shape of the vector of weights, φ. Wright
et al. (2003) and Craigmile et al. (2006) proposed a vector of weights consisting of a bowl-shaped
function of the rank of each of the θi ’s, which emphasises estimation of the extreme quantiles of
the ensemble distribution. Wright et al. (2003) makes use of the following specification for the

27

φi ’s,







n+1
n+1
φi := exp a1 i −
+ exp −a2 i −
,
2
2

(2.71)

for every i = 1, . . . , n, where both a1 and a2 are real numbers greater than 0. Different choices of
a1 and a2 permit to adjust the amount of emphasis put on the extremes of the EDF. In the sequel,
when considering spatial models, these two parameters will be fixed to a1 = a2 = 0.5, which is
a symmetric version of the specification used by Wright et al. (2003). When considering nonspatial models, however, we will see that the shape of the ensemble of WRSEL point estimates
is highly sensitive to the choice of a1 and a2 , as will be described in section 3.3.5. For such
non-spatial models, we will choose the following ‘softer’ specification: a1 = a2 = 0.05. Such
symmetric specifications of the φi ’s emphasises the estimation of the extrema over the estimation
of other elements occupying the middle ranks of the parameter ensemble. Therefore, the ensemble
distribution of WRSEL point estimators resulting from such a specification of the φi ’s will be
expected to be more dispersed than the empirical of the posterior means.

2.5

Research Questions

The main focus of this thesis is the estimation of functions of parameter ensembles. Given a
particular BHM, we wish to estimate a function h(·) of the parameter ensemble θ. As we have
seen in section 2.1.4, the optimal estimator of h(θ) for some loss function L is the following,
∗

δ := argmin E [ L(h(θ), δ)| y] .

(2.72)

δ
∗

Depending on the nature of the function h(·), the computation of the optimiser δ could be
0
relatively expensive. By contrast, computation of the ensemble of optimal point estimates, θ̂ L ,
for a variety of commonly used loss functions L0 , is generally straightforward. Moreover, in the
interest of consistency, one generally wishes to report a single set of point estimates that may
simultaneously satisfy several inferential desiderata. Thus, we are interested in evaluating the
0
∗
performance of h(θ̂ L ) as an alternative to the optimal estimator, δ . For instance, one may
evaluate the performance of a plug-in estimator based on the ensemble of posterior means, when
∗
this particular estimator –i.e. h(θ̂ SSEL )– is used in the place of δ .
A natural way of comparing the performance of different sets of estimators, is to utilise the
posterior regret (Shen and Louis, 1998). The posterior regret expresses the penalty paid for using a
sub-optimal estimator. That is, it is defined as the difference between the posterior loss associated
with using the Bayes choice and the posterior loss incurred for using another estimator. Formally,
the posterior regret for using δ 0 under L is
regret(L, δ 0 ) := E[L(θ, δ 0 )|y] − min E[L(θ, δ)|y].
δ

(2.73)

As for loss functions, regret(L, δ 0 ) ≥ 0, with equality holding if and only if δ 0 = argmin E[L(θ, δ)|y].
One of the first utilisations of this concept was Savage (1954), although not expressed in terms
of posterior expectations. Shen and Louis (1998) specifically used the posterior regret when
comparing ensembles of point estimators. This concept has also been used in more applied settings
such as in computing credibility premiums in mathematical finance (Gomez-Deniz et al., 2006).
For our purpose, we can specialise the definition in equation (2.73) to the estimation of functions of parameter ensembles in BHMs. We will be interested in considering the posterior regret
0
associated with using a plug-in estimator, h(θ̂ L ), for some loss functions L0 . We will therefore
compute the following posterior regret,
0

0

regret(L, h(θ̂ L )) = E[L(θ, h(θ̂ L ))|y] − min E[L(θ, δ)|y],
δ

(2.74)

∗

where the optimal estimator δ under L may be vector-valued. In general, we will refer to the

28

0

quantity in equation (2.74) as the posterior regret based on L(θ, h(θ̂ L )). When comparing different
plug-in estimators, the classical loss function, denoted L0 in equation (2.74), will be taken to be
one of the loss functions reviewed in section 2.4. In particular, following the research conducted
in estimating parameter ensembles in BHMs, the L0 function of interest will be taken to be the
SSEL, WRSEL, constrained Bayes or triple-goal loss. Moreover, we will also evaluate the posterior
regret for the ensemble of MLEs, as these estimators represent a useful benchmark with respect
to which the performance of other plug-in estimators can be compared. For clarity, since optimal
0
estimators under L0 are vectors of point estimates, we will denote them as θ̂ L . In order to facilitate
comparison between experimental conditions where the overall posterior expected loss may vary,
it will be useful to express the posterior regret in equation (2.74) as a percentage of the minimal
loss that can be achieved using the optimal minimiser. That is, we will generally also report the
following quantity,
0
0
100 × regret(L, h(θ̂ L ))
,
(2.75)
PercRegret(L, h(θ̂ L ) :=
minδ E[L(θ, δ)|y]
which we term the percentage regret. Both the posterior and percentage regrets will be used
extensively in the ensuing chapters. In order to emphasise the distinction between these two
quantities, the posterior regret in equation (2.74) will sometimes be referred to as the absolute
posterior regret.
Specifically, in chapters 3 and 4, we will study two aspects of parameter ensembles in BHMs.
Firstly, motivated by current practice in both epidemiology and spatial epidemiology, we will
consider the optimal determination of the heterogeneity or dispersion of a parameter ensemble. In
this case, the function h(·) will either be the quantile function, as described in section 2.3.3 or a
ratio of quartiles. Secondly, following an increased demand for the classification of epidemiological
units in low-risk and high-risk groups –for surveillance purposes, for instance– we will concentrate
our attention on optimising such classification. Here, the function h(·) will be defined as an
indicator function with respect to some cut-off point of interest, denoted by C. Specifically, we
will use two variants of the posterior regret introduced in equation (2.74) for the following choices
of L and h(·):
i. In chapter 3, we will optimise the estimation of the heterogeneity of a parameter ensemble.
Our main focus will be on defining h(·) as a ratio of some of the quartiles of the parameter
ensemble θ, with L being the quadratic loss.
ii. In chapter 4, we will treat the problem of classifying the elements of a parameter ensemble
below and above a particular threshold. Here, the function h(·) will be defined as the
indicator function with respect to some cut-off point C, and the loss function of interest L
will penalise misclassifications.

29

Chapter 3

Empirical Quantiles and Quartile
Ratio Losses
Summary
The amount of heterogeneity present in a parameter ensemble is crucial in both
epidemiology and spatial epidemiology. A highly heterogeneous ensemble of RRs,
for instance, may indicate the presence of a hidden risk factor not included in the
model of interest. In modern BHMs, however, the quantification of the heterogeneity of a parameter ensemble is rendered difficult by the utilisation of link functions
and the fact that the joint posterior distribution of the parameter ensemble is generally not available in closed-form. In this chapter, we consider the estimation of
such heterogeneity through the computation of the empirical quantiles and empirical quartile ratio (QR) of a parameter ensemble. We construct a simple loss
function to optimise the estimation of these quantities, which we term respectively
the quantile squared error loss (Q-SEL) and the QR squared error loss (QR-SEL)
functions. We compare the performance of the optimal estimators under these two
losses with the use of plug-in estimators based on ensembles of point estimates
obtained under standard estimation procedures using the posterior regret. These
candidate plug-in estimators include the set of MLEs and the ensembles of point
estimates under the SSEL, WRSEL, CB and triple-goal functions. In addition,
we also consider the ratio of posterior quartiles (RoPQ), as a possible candidate
for measuring the heterogeneity of a parameter ensemble. We evaluate the performance of these plug-in estimators using non-spatial and spatially structured
simulated data. In these two experimental studies, we found that the RoPQ and
GR plug-in estimators tend to outperform other plug-in estimators, under a variety of simulation scenarios. It was observed that the performance of the WRSEL
function is highly sensitive to the size of the parameter ensemble. We also noted
that the CAR Normal model tends to yield smaller posterior losses when using the
optimal estimator under both the Q-SEL and QR-SEL. In addition, we computed
these optimal and plug-in quantities for a real data set, describing the prevalence
of cases of schizophrenia in an urban population. On this basis, we draw some
recommendations on the type of QR summary statistics to use in practice.

3.1

Introduction

In mixed effects models, which can be regarded as the frequentist version of BHMs, the main focus
of the analysis has historically been on estimating fixed effects –that is, the regression coefficients of
particular covariates. However, since the values of the fixed effect parameters are highly dependent
on the values taken by the random effects, statisticians’ attention has progressively turned to
the systematic study of random effects (Demidenko, 2004). Such a vector of random effects
can be described as a parameter ensemble as introduced in section 2.2.1. A standard way of
quantifying the amount of heterogeneity present in a parameter ensemble is to use the intraclass
30

coefficient (ICC). The ICC can be computed whenever quantitative measurements are made on
units organised into groups. This statistic constitute a useful complement to the analysis of
variance (ANOVA), for instance, where individual units are grouped into N groups, with j =
1, . . . , N . The nested observations are then modelled as
yij = µ + αj + ij ,
iid

(3.1)

iid

where αj ∼ N (0, σα2 ) and ij ∼ N (0, σ2 ). Here, the αj ’s are independent of the ij ’s, and we
assume that there is an identical number of units in each group, i.e. i = 1, . . . , n. For this model,
the ICC is defined as follows,
σ2
(3.2)
ICC := 2 α 2 .
σα + σ
The ICC is a useful measure of parameter ensemble heterogeneity for general linear models that
contains random effects. However, there does not exist an equivalent measure for generalised linear
models. Indeed, in generalised linear models, the random effects of interest affect the response
through a link function, which transforms the distribution of the original random effects. Thus,
the variance parameter controlling the variability of these random effects only provides a distorted
image of the dispersion of the parameter ensemble of interest.
Generalised linear models are commonly used in epidemiology and spatial epidemiology. In
this context, the heterogeneity of a set of random effects may be indicative of the effect of hidden
covariates that have not been included in the model. An accurate estimation of the dispersion
of the random effects is therefore crucial for the detection of unexplained variability, which may
then lead to the inclusion of new candidate risk factors. Most Bayesian models used in modern
epidemiological practice, however, are hierarchical. In such models, the set of parameters of interest
will be a non-linear function of one or more random effects as well as unit-specific covariates.
The units may here be administrative areas within a region of interest such as hospitals, schools
or other aggregates. For general BHMs, therefore, there does not exist a unique parameter,
which controls for the variability of the unit-specific levels of risk. The variance parameters of
several random effects can be added together, but this only constitutes a heuristic solution for
quantifying the heterogeneity of the resulting empirical distribution of the parameters of interest.
For such generalized linear models commonly used in epidemiology, there is therefore a need for a
statistically principled way of estimating the heterogeneity of parameter ensembles.
One of the first formal attempts at estimating the amount of heterogeneity present in a set
of random effects was conducted by Larsen et al. (2000). These authors studied a mixed effects
logistic regression model, and considered the variance of the ensemble distribution of random
effects, as a potential candidate for a measure of dispersion. Formally, they considered N groups
of individuals with n subjects in each group. The probability of the ith individual in the j th cluster
to develop the disease of interest was modelled as


PK
exp αj + k=1 βk xik

,
P [Yij = 1|αj , xi ] =
(3.3)
PK
1 + exp αj + k=1 βk xik
where i = 1, . . . , n and j = 1, . . . , N , and where the random effects are assumed to be independent
iid
and identically distributed such that αj ∼ N (0, σα2 ), for every j. The βk ’s constitute a set of fixed
effects associated with individual-specific K-dimensional vectors of risk factors denoted by xi , for
every i. Although the variance parameter, σα2 , controls the distribution of the random effects, it
only affects the probability of developing the disease of interest through the logistic map and the
exact relationship between the variances at the first and second-level of the model hierarchy is
therefore difficult to infer from the sole consideration of σα2 .
Larsen et al. (2000) addressed this problem by assessing the amount of variability in the αj ’s
by computing the median odds ratio (MOR). For two randomly chosen αj ’s drawn from the
empirical distribution of the parameter ensemble, Larsen et al. (2000) considered the absolute

31

difference between these two parameters. Since the αj ’s are iid normal variates centered at zero
with variance σα2 , as described above, it can be shown that the difference between two such random
variates is αj − αk ∼ N (0, 2σα2 ) for any pair of indices satisfying j 6= k (Spiegelhalter et al., 2004).
Moreover, the absolute difference between two randomly chosen random effects is a truncated
Gaussian, sometimes called a half-Gaussian, with mean zero and variance 2σα2 . Larsen et al.
(2000) suggested taking the median of that distribution.
For the aforementioned specification, the
√
.
median of such a truncated Gaussian is Φ−1 (0.75)× 2σα2 = 1.09σα2 . When the αj ’s are ORs on the
logarithmic scale, the dispersion of the parameter ensemble becomes exp(1.09σα2 ) (see also Larsen
and Merlo, 2005). The MOR has been met with singular success in the literature, and has been
adopted by several authors in the medical and epidemiological sciences. In particular, it has been
used in cancer epidemiology (e.g. Elmore et al., 2002) and in the study of cardiovascular diseases
(e.g. Sundquist et al., 2004), as well as in the monitoring of respiratory health (e.g. Basagana
et al., 2004).
In a Bayesian setting, however, the MOR will only be available in closed-form if the posterior
distribution of the random effect ensemble is also available in closed-form. This will rarely be the
case in practice. For more realistic models, the computation of the MOR will typically require
a substantial amount of computational power in order to be estimated. Specifically, the calculation of the MOR is based on the distribution of the differences between two random variates.
The exhaustive evaluation of such a distribution, however, will require the computation of n2
differences for a parameter ensemble of size n. If one wishes to estimate this particular quantity
within a Bayesian context, one could specify a quadratic loss on the MOR. The optimal estimator
under that loss function is the posterior mean. It then follows that we would need to compute
the median of the distribution of the absolute differences of any two randomly chosen parameters
at each iteration of the MCMC algorithm used for fitting the model. Such an estimation scheme
becomes rapidly unwieldy as n grows (for n = 2000, about 2 × 106 differences, |αj − αk |, need to
be computed at each MCMC iteration). The use of the MOR for Bayesian models thus appears
to be impractical.
A less computationally intensive method for quantifying the dispersion of a parameter ensemble
is the use of the quartile ratio (QR). This quantity is defined as the ratio of the third to the first
quartile of a parameter ensemble. The use of quartiles for measuring heterogeneity comes here
with no surprise as these summary statistics have been shown to be especially robust to deviation
from normality (Huber and Ronchetti, 2009). That is, the utilisation of quartiles as summary
statistics of the data is less sensitive to small departures from general modelling assumptions.
This robustness of the quartiles is therefore especially significant when the field of application is
the generalised linear model, as in the present case. We will see that, for models with no covariates,
the logratio of the third to the first quartile of the empirical distribution of the RRs is equivalent
to the IQR of the random effects on their natural scale. Like the IQR, the ratio of the third to
first quartiles of the RRs can thus be regarded as a non-parametric measure of dispersion.
As any function of a parameter ensemble, the QR is amenable to standard optimisation procedures using a decision-theoretic approach. In this chapter, we will construct a specific loss function
to quantify the estimation of this quantity. In addition, it will be of interest to optimise the estimation of the quantiles of the ensemble distribution. Specifically, we will study the computation of
the optimal first and third quartiles of the ensemble distribution of the parameters of interest. As
described in section 2.5, one of our goals in this thesis is to compare the use of optimal estimators
with the performance of plug-in estimators, based on commonly used ensembles of point estimates.
We will conduct these comparisons using the posterior regret, as introduced in chapter 2. The
performance of the various plug-in estimators will be assessed by constructing two sets of data
simulations. Different experimental factors deemed to influence the estimators’ performance will
be manipulated in order to precisely evaluate their effects. In particular, the synthetic data sets
will be constructed using both a non-spatial and a spatial structure. The non-spatial simulations
used in the sequel reproduce in part some of the simulation experiments conducted by Shen and
Louis (1998), whereas the spatially structured risk surfaces will be based on the simulation study
implemented by Richardson et al. (2004).
In addition, we will also be evaluating the impact of using different types of plug-in estimators
32

for the estimation of the dispersion of parameter ensembles in a real data set. We will re-analyse
a published data set describing schizophrenia prevalence in an urban setting. Delineating the
geographical distribution of psychoses plays an important role in generating hypotheses about
the aetiology of mental disorders, including the role of socioeconomic status (Giggs and Cooper,
1987, Hare, 1956, Hollingshead and Redlich, 1958), urbanicity (Lewis et al., 1992), migration
(Cantor-Graae et al., 2003), ethnicity (Harrison et al., 1997) and, more recently, of family history
interactions that may betray effect modification by genes (Krabbendam and van Os, 2005, van Os
et al., 2003). A raised prevalence of schizophrenia in urban areas was first observed over 75 years
ago (Faris and Dunham, 1939), and has been consistently observed since (Giggs, 1973, Giggs and
Cooper, 1987, Hafner et al., 1969, Hare, 1956, Lewis et al., 1992, Loffler and Haffner, 1999). Faris
and Dunham (1939) demonstrated that the highest rates of schizophrenia occurred in inner-city
tracts of Chicago with a centripetal gradient. More recently, a dose-response relationship between
urban birth and the prevalence of schizophrenia has been reported in Sweden (Lewis et al., 1992),
the Netherlands (Marcelis et al., 1998) and Denmark (Pedersen and Mortensen, 2001), suggesting
that a component of the aetiology of schizophrenia may be associated with the urban environment.
This specific data set is especially relevant to the task at hand, since it is characterised by low
expected counts, which tend to lead to high levels of shrinkage in commonly used ensembles of
point estimates (Gelman and Price, 1999); thereby providing a good testing ground for comparing
the use of optimal dispersion estimators with the construction of plug-in estimators.
This chapter is organised as follows. We will first describe our decision-theoretic approach to
the estimation of both empirical quantiles and empirical QR in section 3.2. The construction of
the non-spatial simulations as well as the comparison of the optimal estimators with some plug-in
estimators of interest will then be reported in section 3.3. The specification of the spatial simulation
scenarios and the effects of the different experimental factors considered will be described in section
3.4. Finally, the analysis of the schizophrenia prevalence data set will be given in section 3.5, and
some conclusions on the respective performance of the different studied estimators will be provided
in section 3.6.

3.2

Estimation of Empirical Quantiles and Quartile Ratio

We here introduce two specific loss functions, which formalise our approach to the estimation of
parameter ensembles’ quantiles and QR. Both of these loss functions are straightforward adaptations of the quadratic loss, which provides easily derivable optimal minimisers. In addition, we
discuss the computation of the respective posterior regrets for these loss functions, as this will be
used for evaluating the performance of the plug-in estimators of the quantities of interest.

3.2.1

Empirical Quantiles

The empirical quantiles of a parameter ensemble are especially relevant when one wishes to quantify
the dispersion of the ensemble distribution of a parameter ensemble. As defined in section 2.3.3,
the pth empirical quantile of an n-dimensional parameter ensemble θ is
θ(p) := Qθ (p),

(3.4)

where Qθ (·) is the empirical QDF of θ, and p ∈ [0, 1]. The quantity θ(p) is a non-linear function
of θ. Optimal estimation of this quantity can be formalised by quantifying our loss using an SEL
function on θ(p) , which takes the following form,
SEL (Qθ (p), δ) = θ(p) − δ

2

.

(3.5)

We saw in section 2.1.4 that the optimal estimator for such a posterior expected SEL is the
posterior mean of the QDF of θ evaluated at p. Note that because θ(p) is a function of the entire
parameter ensemble θ, it follows that the posterior expected loss depends on an n-dimensional

33

joint posterior distribution. When more than one quantile is of interest, one may use a quantiles
squared error loss (Q-SEL) defined for some k-dimensional vector p ∈ [0, 1]k as
Q-SELp (θ, δ) :=

k
X

SEL (Qθ (pj ), δj ) =

j=1

k
X

θ(pj ) − δj

2

,

(3.6)

j=1

where we have emphasised the dependence of the Q-SEL on the full parameter ensemble θ. Note,
however, that θ and δ will generally not have the same dimension. Here, θ is n-dimensional
whereas δ is k-dimensional. Thus, the posterior expected Q-SEL is minimised by a k-dimensional
vector θ Q-SEL , which has the following elements,
 

Q-SEL
y .
(3.7)
:=
E
[
Q
(p
)|
y]
=
E
θ
θ(p
θ
j
(p
)
j
)
j
for every j = 1, . . . , k, where the expectation is taken with respect to the joint posterior distribution, p(θ1 , . . . , θn |y).
Parameter ensemble quantiles can also be estimated using plug-in estimators, which are based
on empirical distributions of point estimates, as described in section 2.5. For any loss function L0 ,
0
we define the empirical quantiles of an ensemble of point estimates denoted θ̂ L , as follows,
n 0
o
0
0
L0
θ̂(p)
:=: Qθ̂L0 (p) := min θ̂1L , . . . , θ̂nL : Fθ̂L0 (θ̂iL ) ≥ p ,
(3.8)
0

for any p ∈ [0, 1], where the EDF of the ensemble θ̂ L is defined as
n

Fθ̂L0 (t) :=

0
1X
I{θ̂iL ≤ t}.
n i=1

(3.9)

Note that equation (3.8) is solely the empirical version of the general definition of a quantile
reported in equation (2.43) on page 22. The performance of such plug-in estimators of the posterior
quantiles will be evaluated and compared to the optimal Bayes choice under Q-SEL. In particular,
we will consider ensembles of point estimates based on the loss functions described in section 2.4.
This will include the SSEL, WRSEL, CB and GR ensembles of point estimates, as well as the
MLEs.

3.2.2

Empirical Quartile Ratio

A natural candidate for the quantification of the dispersion of a parameter ensemble is the quartile
ratio (QR). This quantity is defined as the ratio of the third to the first empirical quartile of the
vector of parameters of interest, θ. For a given BHM, of the type described in equation (2.19),
the QR is defined as follows,
θ(.75)
Qθ (.75)
QR(θ) :=
=
,
(3.10)
Qθ (.25)
θ(.25)
where θ(.25) and θ(.75) denote the first and third empirical quartiles, respectively. For generalized
linear models, we will compute this quantity on the scale of the data –that is, as a ratio of ORs for
a binomial likelihood, or as a ratio of RRs for a Poisson likelihood. When considering a log-linear
model (e.g. Poisson likelihood combined with a normal prior on the log-intensities), the QR is
related to the IQR introduced in section 2.3.3. If we take the logarithm of the QR, we obtain the
IQR of the parameter ensemble on the prior scale, i.e. on the scale of the normal prior in the case
of a log-linear model. We have


θ(.75)
= log θ(.75) − log θ(.25) = IQR(g(θ)),
(3.11)
log
θ(.25)
where g(·) is the log link function.

34

The decision problem associated with the estimation of the QR can be formulated using a
quadratic loss taking the QR as an argument. For clarity, we will refer to that particular quadratic
loss as the QR squared error loss (QR-SEL). This loss function is defined as follows,

QR-SEL(θ, δ) := SEL(QR(θ), δ) =

θ(.75)
−δ
θ(.25)

2
.

(3.12)

The QR(·) function is a non-linear mapping of the parameter ensemble θ. Equation (3.12) is of
the form L(h(θ), δ), where L is the SEL and h(·) is the QR. The minimiser of the corresponding
posterior expected loss is therefore the following posterior quantity,
 

θ(.75) 
y ,
(3.13)
QR(θ|y) := E
θ(.25) 
which will be referred to as the posterior empirical QR, where recall that θ(.25) and θ(.75) denotes
the empirical first and third quartiles of θ = {θ1 , . . . , θn }.
It is of interest to compare the performance of this optimal estimator with some plug-in estima0
0
tors, QR(θ̂ L ). As before, the ensemble of point estimates θ̂ L has been obtained as the optimiser
of L0 , where L0 represents a commonly used compound loss function. This therefore gives the
following plug-in QR estimator,
L0
θ̂(.75)
L0
(3.14)
QR(θ̂ ) := 0 ,
L
θ̂(.25)
0

where both numerator and denominator are here defined as in equation (3.8). Note that QR(θ̂ L )
0
only depends on the data through the vector of point estimates, θ̂ L . An alternative solution to
the problem of estimating the QR of a parameter ensemble is the direct utilisation of the Bayes
choice for each quartiles. These quantities may have been estimated using the Q-SEL function
described in equation (3.6). In such a case, once the minimiser of the posterior expected Q-SEL
has been obtained, we can estimate the QR as the ratio of posterior empirical quartiles (RoPQ).
That is, we have
Q-SEL
θ(.75)
E[Qθ (.75)|y]
= Q-SEL ,
RoPQ(θ|y) :=
(3.15)
E[Qθ (.25)|y]
θ(.25)
where the numerator and denominator are components of the optimal estimator under Q-SEL, as
described in equation (3.7). Note that we have here drawn an explicit distinction between posterior
empirical quartiles and quartiles of an ensemble of point estimates, which are respectively denoted
Q-SEL
L0
by θ(p)
and θ̂(p)
, by using a hat to qualify the latter.
The QR is a useful indicator of the dispersion of a parameter ensemble, when the elements of
that ensemble are constrained to take positive values. For parameter ensembles with Normally
distributed elements, however, one needs to use a different measure of dispersion. In such contexts,
we will optimise the estimation of the IQR, as introduced in section 2.3.3. Such optimisation can
be conducted using a quadratic loss on the IQR such that
IQR-SEL(θ, δ) := SEL(IQR(θ), δ) = (θ(.75) − θ(.25) ) − δ

2

.

(3.16)

The optimal estimator of the posterior expected IQR-SEL is the posterior mean IQR,
IQR(θ|y) := E[θ(.75) − θ(.25) |y].

(3.17)

As for the posterior QR, plug-in estimators for this quantity can be defined by simply using the
quartiles of the empirical distribution of the corresponding point estimates. Alternatively, one can
also use two posterior empirical quartiles to estimate the IQR, as was done for the QR-SEL in
equation (3.15). The latter estimator will be referred to as the difference of posterior empirical

35

quartiles (DoPQ), defined as follows,
DoPQ(θ|y) := E[θ(.75) |y] − E[θ(.25) |y].

(3.18)

In the sequel, when dealing with ensembles of real-valued parameters taking both negative and
positive values, we will automatically replace the QR-SEL with the IQR-SEL.

3.2.3

Performance Evaluation

The performance of these different quantities will be evaluated using simulated data, as well
as compared in the context of real data examples. In the sequel, the posterior expected loss
associated with the use of the optimal estimators under the Q-SEL and the QR-SEL functions
will be compared to the posterior penalties incurred when using various plug-in estimators under
these loss functions. In particular, we will be interested in assessing Q-SEL for p := {.25, .75},
as this leads to a direct comparison with the optimisation of the QR-SEL, which is related to the
estimation of these specific quartiles. As described in section 2.5, we will therefore compute the
following posterior regrets.
In the notation of section 2.5, the function h(·), which takes an ensemble of point estimates as
an argument, becomes the empirical quantile function or the empirical quartile ratio depending on
whether we wish to evaluate the posterior regret of the Q-SEL or the one of the QR-SEL function.
Specifically, when the empirical quantiles are of interest, then equation (2.74) becomes
 



 
regret Q-SELp , Qθ̂L0 (p) = E Q-SELp θ, Qθ̂L0 (p)  y − min E Q-SELp (θ, δ) y ,
δ

where the optimal estimator, δ, minimising Q-SEL is the corresponding vector of posterior empirical quartiles, as described in equation (3.7). In the sequel, p will be taken to be {.25, .75}. In
addition, we will use


h

 i
0
0

regret QR-SEL, QR(θ̂ L ) = E QR-SEL θ, QR(θ̂ L )  y − min E [ QR-SEL(θ, δ)| y] ,
δ

when the focus is on the empirical quartile ratio, with the optimal estimator minimising QR-SEL
being here the posterior empirical QR, as described in equation (3.13). A similar posterior regret
can be defined for the IQR-SEL function introduced in equation (3.16). For every pair of L and L0
functions, where L will be either the Q-SEL or QR-SEL functions and L0 will be either the SSEL,
WRSEL, CB or GR loss functions. In addition, we will also consider the use of the RoPQ and the
DoPQ, as introduced in equation (3.15) and (3.18), when evaluating the QR-SEL and IQR-SEL
functions, respectively.

3.3
3.3.1

Non-spatial Simulations
Design

The proposed quantile and QR estimators were evaluated using synthetic datasets. The main
objective of these simulations was to assess the influence of various factors on quantile estimation,
and more specifically on the estimation of the QR of the posterior ensemble. Three factors were
of particular interest. Firstly, (i) the size of the parameter ensemble was hypothesised to have
a significant impact on the quality of the estimation, since as the number of variables in the
ensemble goes to infinity, the quantiles of that ensemble distribution become better identified. In
addition, (ii) we varied the level of heterogeneity of the sampling variances of the elements in
the parameter ensemble. Finally, (iii) we were also concerned with assessing the sensitivity of
empirical quantile and QR estimation on distributional assumptions. Two different hierarchical
models were therefore compared. In this set of simulations, the models used to generate the data
was also used to estimate the different posterior quantities of interest. That is, the generative and
fitted models were identical.
36

3.3.2

Generative Models

The data were simulated using two different BHMs, which were partially described in section 2.2.1.
We here give a full description of these models and our specific choices of hyperparameters. We
tested for the effect of skewness on the estimation of the parameter ensemble quantiles and QR
by comparing a compound Gaussian and a compound Gamma model. In the first case, the prior
distribution on the θi ’s is symmetric, whereas in the latter case, the prior on the θi ’s is skewed. For
convenience, conjugacy between the likelihood and the prior was respected for these two models
(Bernardo and Smith, 1994). Non-conjugate models will be studied in section 3.4, for the case of
spatial priors. These two simulation models and the specific values given to the hyperparameters
can be regarded as a replication the first part of the simulation design conducted by Shen and
Louis (1998). The models of interest in this section can be described as follows.
i. For the compound Gaussian or Normal-Normal (N-N) model, we had the following likelihood
and prior,
ind
iid
yi ∼ N (θi , σi2 ),
θi ∼ N (µ0 , τ02 ),
(3.19)
ind

respectively, for every i = 1, . . . , n. Standard application of Bayes’ rule gives θi |yi ∼
N (θ̂iSSEL , τ02 γi ), with θ̂iSSEL := γi µ0 + (1 − γi )yi , and where γi := σi2 /(σi2 + τ02 ) are the shrinkage parameters. The MLEs for this model are given by θ̂iMLE = yi for every i = 1, . . . , n.
In every simulation, the hyperparameters controlling the prior distribution of the θi ’s were
given the following specification: µ0 = 0, and τ02 = 1, as in Shen and Louis (1998). Note that
this simulation setup is somewhat artificial since τ02 is fixed to a particular value, instead of
being estimated from the data. However, this choice of specification has the advantage of
directly reproducing the simulation study of Shen and Louis (1998).
ii. For the compound Gamma or Gamma-Inverse Gamma (G-IG) model, the likelihood function
and prior take the following form,
ind

iid

yi ∼ Gam(ai , θi ),

θi ∼ Inv-Gam(α0 , β0 ),

(3.20)

for every i = 1, . . . , n. The Gamma and Inverse-Gamma distributions were respectively given
the following specifications:
Gam(ai , θi ) =

1
y ai −1 e−yi /θi ,
ai
θi Γ(ai ) i

(3.21)

with ai , θi > 0 for every i = 1, . . . , n, and
Inv-Gam(α0 , β0 ) =

β0α0 −α0 −1 −β0 /θi
θ
e
,
Γ(α0 ) i

(3.22)

with α0 , β0 > 0. From the conjugacy of the prior, we obtain the following posterior disind
tribution, θi |yi ∼ Inv-Gam(ai + α0 , yi + β0 ), and the MLEs are θ̂iMLE = yi /ai for every
i = 1, . . . , n. All simulations were based on the following choices of the hyperparameters:
α0 = 4, and β0 = 3, as in Shen and Louis (1998).
Detailed descriptive statistics of the synthetic data generated by these models are reported in tables
A.1 and A.2 in appendix A, for the simulated observations, and variance parameters, respectively.

3.3.3

Simulation Scenarios

In addition to the different models tested, two other factors were manipulated when producing
these synthetic data sets. Firstly, in order to evaluate the effect of the size of the ensemble
distribution on the quality of the classification estimates, we chose three different sizes of parameter
ensemble. Specifically, in the BHMs of interest, the vector of observations and the vector of

37

parameters are both of size n. In these simulations, we chose n to take the following values:
n ∈ {100, 200, 1000} .

(3.23)

The second experimental factor under consideration was the amount of variability associated with
each data point, i.e. the sampling variances of the yi ’s. This aspect of the synthetic data sets
was made to vary by selecting different ratios of the largest to the smallest (RLS, in the sequel)
sampling variances. Formally,
RLS(σ) :=

2
σ(n)
2
σ(1)

,

and

RLS(a) :=

a(n)
,
a(1)

(3.24)

for the compound Gaussian and compound Gamma models, respectively. Thus, different choices
of the vectors σ = {σ1 , . . . , σn } and a = {a1 . . . , an } produced different levels of that ratio. We
generated the scaling parameters similarly in the two models in order to obtain three comparable
levels of shrinkage. The sampling variances in both models were produced using
iid

log(σi2 ) ∼ Unif(−Cl , Cl ),

and

iid

log(ai ) ∼ Unif(−Cl , Cl ),

(3.25)

for the compound Gaussian and compound Gamma models, respectively, and where l = 1, . . . , 3.
Different choices of the parameters Cl ∈ {.01, 1.5, 2.3} approximately generated three levels of RLS,
such that both RLS(σ) and RLS(a) took the following values {1, 20, 100}, where small values of
RLS represented scenarios with small variability in sampling variances.
In spite of these modifications of n and RLS, the empirical mean of the ensemble distributions
of the true θi ’s was kept constant throughout all simulations, in order to ensure that the simulation
results were comparable. For the compound Gaussian model, the empirical ensemble mean was
fixed to 0, and for the compound Gamma model, the empirical ensemble mean was fixed to
1. These values were kept constant through adequate choices of the hyperparameters of the prior
distribution in each model. The combination of all these factors, taking into account the 2 different
models, the 3 different sizes of the parameter ensemble and the 3 different levels of RLS resulted
in a total of 1,800 different synthetic data sets with 100 replicates for each combination of the
experimental factors.

3.3.4

Fitted Models

As aforementioned, the fitted models were identical to the generative models. For both the compound Gaussian and compound Gamma models, no burn-in was necessary since each of the θi ’s are
conditionally independent given the fixed hyperparameters. The posterior distributions were directly available in closed-form for the two hierarchical models as both models were given conjugate
priors. Nonetheless, in order to compute the different quantities of interest, we generated 2,000
draws from the joint posterior distribution of the θi ’s in each model for each simulation scenario.
The various plug-in estimators were computed on the basis of these joint posterior distributions.
For this set of non-spatial simulations, the WRSEL function was specified using a1 = a2 = 0.05
(see section 2.4.3 on page 26).

3.3.5

Plug-in Estimators under Q-SEL

The results of these simulations for the Q-SEL function are presented in table 3.1 on page 39
for both the compound Gaussian (N-N) and the compound Gamma (G-IG) models. For the
posterior regret of each plug-in estimator, we have reported in parentheses the posterior regret as
a percentage of the posterior loss under the optimal estimator. This quantity is the percentage
regret, as described in section 2.5 on page 28. Specifically, for any ensemble of point estimates,

38

Table 3.1. Posterior regrets based on Q-SELp (θ, Qθ̂L0 (p)) with p := {.25, .75}, for five plug-in estimators
and with the posterior expected loss of the optimal estimator in the first column. Results are presented for
the compound Gaussian model in equation (2.20) and the compound Gamma model in equation (2.21),
for 3 different levels of RLS, and 3 different values of n, averaged over 100 replicate data sets. Entries
were scaled by a factor of 103 . In parentheses, the posterior regrets are expressed as percentage of the
posterior loss under the optimal estimator.
Scenarios
.
RLS = 1
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 20
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 100
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000

Q-SEL

MLE

SSEL

Posterior regretsa
WRSEL

24.9
12.7
2.6
8.8
4.4
0.9

182.8 (734)
176.4 (1389)
158.4 (6177)
170.6 (1938)
147.7 (3365)
137.2(15705)

79.3
81.7
80.4
59.7
62.9
62.7

(318)
(643)
(3134)
(678)
(1432)
(7179)

22.6
(91)
355.8 (2802)
3126.8 (121905)
57.6
(654)
182.7 (4164)
2193.1 (251039)

24.9
12.4
2.5
8.5
4.3
0.8

251.0 (1009)
233.0 (1886)
210.7 (8327)
186.9 (2201)
163.9 (3812)
156.2(18600)

95.7
106.4
97.8
79.0
76.5
77.0

(385)
(861)
(3865)
(930)
(1779)
(9167)

23.7
12.3
2.5
8.0
4.0
0.8

302.9 (1277)
254.9 (2077)
253.8(10161)
208.4 (2592)
190.2 (4698)
190.4(23096)

111.9
137.3
135.2
76.4
79.7
80.3

(472)
(1118)
(5413)
(950)
(1968)
(9744)

CB
8.5
5.3
1.3
6.0
6.2
5.9

GR

(34)
(42)
(51)
(69)
(141)
(680)

0.3(1)
0.0(0)
0.0(1)
0.2(2)
0.1(2)
0.0(4)

12.7
(51)
241.6 (1955)
2506.6 (99044)
73.3
(864)
185.9 (4324)
1979.9 (235817)

8.8 (35)
7.2 (58)
3.3 (131)
13.5 (159)
17.1 (398)
18.2(2166)

0.6(3)
0.1(1)
0.0(1)
0.2(3)
0.1(2)
0.1(6)

6.2
(26)
131.4 (1070)
1903.4 (76214)
66.3
(825)
169.0 (4174)
1622.9 (196836)

14.6 (62)
18.0 (147)
16.1 (643)
16.5 (205)
17.1 (422)
25.5(3090)

0.0(0)
0.0(0)
0.0(1)
0.5(6)
0.1(2)
0.1(8)

a

Entries for the posterior regrets have been truncated to the closest first digit after the decimal point, and
entries for the percentage regrets have been truncated to the closest integer. For some entries, percentage
regrets are smaller than 1 percentage point.
0

θ̂ L , we have computed the following percentage regret,

100 × regret Q-SELp , Qθ̂L0 (p)
  ,

minδ E Q-SELp (θ, δ) y

(3.26)

where the optimal estimator is the vector of posterior empirical quartiles for p := {.25, .75}. In
the sequel, most simulation results will be presented in tabulated format, where the first column
will correspond to the denominator in formulae (3.26), which is here posterior expected Q-SELp ,
and the remaining columns will provide both the posterior regret and the percentage regret in
parentheses expressed with respect to Qθ̂L0 (p), for different choices of L0 .
Overall, the lowest posterior regret for estimating the first and third quartiles was achieved
by using the GR plug-in estimator. That is, estimates of the posterior empirical quantiles using
the ensemble of GR point estimates was almost optimal under both models and all simulation
scenarios. By comparing the columns of table 3.1 corresponding to the posterior regrets of each
plug-in estimator, we can observe that the performance of the GR was followed by the ones of
the CB, SSEL and MLE ensembles in order of increasing percentage regret for every condition
where n > 100. The quartiles derived from the WRSEL ensemble outperformed the ones based
on the SSEL and MLE sets of point estimates when n = 100, under both types of models and
under all levels of the RLS. The WRSEL quartile estimator also surpassed the performance of
.
the CB ensemble of point estimates when RLS = 100 and n = 100. However, the performance of
the WRSEL estimator was very sensitive to the size of the parameter ensemble, and deteriorated
rapidly as n increased, under both types of models. Figure 3.1 on page 40 illustrates the impact
of an increase of the size of the parameter ensemble on the behaviour of the WRSEL ensemble of
point estimates. In panel (b), one can observe that the WRSEL ensemble distribution becomes
increasingly bimodal as n increases. This particular behaviour can be explained in terms of the
39

(a) SSEL

(b) WRSEL
0.7

n=100
n=200
n=1000

0.6

0.6

0.5

0.5

0.4

0.4

Density

Density

0.7

0.3

0.3

0.2

0.2

0.1

0.1

0.0

0.0
−4

−2

0
θ

2

4

−4

−2

0

2

4

θ

Figure 3.1. Effect of the change in the size of the parameter ensemble on the performance of the WRSEL
point estimates. Panel (b) shows a histogram of the ensemble of WRSEL point estimates for n = 1000
with superimposed lines representing the same set of point estimates under n = 100, 200 and 1000. We
have also provided the SSEL parameter ensemble in panel (a) for comparison. Results are here shown for
a randomly chosen data set among the 100 replicates. The superimposed curves were produced using a
Gaussian kernel over 512 equal-sized bins.

specification of the φi ’s in the WRSEL estimation procedure. Each of the φi ’s is a function of
both the parameters a1 and a2 and the size of the ensemble distribution, n. We here recall the
definition of these WRSEL weights,
 




n+1
n+1
φi := exp a1 i −
+ exp −a2 i −
,
(3.27)
2
2
for i = 1, . . . , n, and where for the present set of non-spatial simulations, we chose a1 = a2 = 0.05.
It can therefore be seen that as n increases, the range of the φi ’s tends to increase at an exponential
rate. Since these weights control the counterbalancing of hierarchical shrinkage in the ensemble
distribution, it follows that an increase in the size of the ensemble yields an accentuation of such
countershrinkage. As a result, we obtain the phenomenon visible in panel (b) of figure 3.1, where
the units in the tails of the WRSEL ensemble distribution are pushed away from the center of the
distribution, thus creating a bimodal distribution. This effect explains why the performance of
the WRSEL tends to rapidly deteriorate as n increases.
The relative performance –that is, in terms of percentage regrets– of all plug-in estimators,
except perhaps for the GR quartile estimator, appeared to worsen under the compound Gamma
model, in comparison to the compound Normal model. The percentage regrets of most plug-in
estimators, indicated in parentheses in table 3.1, can be observed to be higher under the compound
Gamma model. The sole exception to that trend was the performance of the GR plug-in quartiles
for which no systematic trend could be identified. Overall, however, that estimator also tended to
do slightly worse under the G-IG model, although its performance was still very close to optimal.
A comparison of the shape of the ensemble distributions of the different point estimates studied
40

in this simulation experiment is reported in figure 3.2 on page 42. It can be observed that the
empirical distribution of point estimates remains centered at zero under the N-N model, thereby
matching the central tendency of the true ensemble distribution. Under the G-IG model, however,
the skewness of the true ensemble distribution made it more difficult for plug-in estimators to
match the values of the quantiles of the true parameter ensemble.
Increasing the magnitude of the RLS was found to detrimentally affect the performance of the
MLE, SSEL and CB plug-in estimators. The percentage regrets for these three families of plug-in
estimators was found to increase systematically with the magnitude of the RLS. This effect may
be explained in terms of the added variability associated with a high RLS. For the MLEs, this
difference in percentage regrets is directly attributable to differences in sampling variance. For the
SSEL and CB plug-in estimators, one may explain the detrimental effect of the RLS experimental
factor in terms of hierarchical shrinkage. That is, units with very high sampling variance are
subject to a larger degree of hierarchical shrinkage than ensemble units with low sampling variance.
These changes may then modify the ordering of the units and the overall shape of the ensemble
of SSEL and CB point estimates, thereby leading to poorer performance than under low RLS. No
similar trend could be observed for the GR and WRSEL quartile estimators. The GR quartile
estimators seemed to be robust to changes in RLS levels, although the scale of the differences in
performance was too small to reach any definite conclusions. For the WRSEL plug-in estimator,
an increase in RLS was found to decrease percentage regret when considering the N-N model, but
not necessarily under the G-IG model.
Finally, increasing the size of the parameter ensemble resulted in a systematic increase of percentage regret for all plug-in estimators, except for the quartiles based on the triple-goal function.
As noted earlier, this relative deterioration of the performance of the plug-in estimators was particularly acute for the WRSEL estimators. The absolute value of the posterior loss under the
optimal Q-SEL estimator, however, tended to decrease as n increased. Thus, while the posterior
empirical quartiles are better estimated when the size of the parameter ensemble of interest is
large, the relative performance of the plug-in estimators tends to decrease when their performance
is quantified in terms of percentage regret. One should note, however, that for ensembles of point
estimates, which optimised some aspects of the ensemble empirical distribution, the absolute posterior regrets (cf. first column of table 3.1) tended to diminish with n, even if this was not true for
the corresponding percentage posterior regrets (cf. values in parentheses in the remaining columns
3.1). This trend was especially noticeable for the CB and GR plug-in estimators, whose absolute
posterior regrets can be seen to be lower under larger parameter ensembles.

3.3.6

Plug-in Estimators under QR-SEL

The simulation results for the QR-SEL function are reported in table 3.2, on page 43. For the
compound Gaussian model, we computed the plug-in estimators under the IQR-SEL function. For
this loss, the optimal estimator is the posterior IQR, and the RoPQ is replaced by the DoPQ, as
described in equation (3.18). We considered the effect of the different experimental factors on the
performance of the plug-in estimators, in turn.
Overall, the ordering of the different plug-in estimators in terms of percentage regret under
QR-SEL was found to be identical to the ordering observed under the Q-SEL function. The
empirical QR of the MLEs tended to exhibit the largest percentage regret across all conditions
and scenarios, except under the N-N model with n = 1000, for which the WRSEL plug-in estimator
performed worse. As was previously noticed under the Q-SEL, the WRSEL plug-in estimator of
the empirical QR was found to be very sensitive to the size of the parameter ensemble. That is,
the performance of the WRSEL plug-in estimator severely deteriorated as n grew large. We can
explain this effect in terms of the modification of the φi ’s in the WRSEL function following an
increase in n. Ignoring the WRSEL-based estimator, the SSEL plug-in estimator exhibited the
second worst percentage regret after the MLE-based QR. This was followed by the CB plug-in
estimator. The triple-goal and RoPQ were found to almost match the performance of the optimal
estimator under the QR-SEL function over all simulated scenarios. No systematic difference in
percentage regret could be identified between the GR and the RoPQ plug-in estimators.
41

(a) N−N

(b) G−IG

0.6

3.5

MLE
SSEL
WRSEL
CB
GR

3.0

0.5

2.5

Density

Density

0.4

0.3

2.0

1.5
0.2
1.0
0.1

0.5

0.0

0.0
−4

−2

0

2
θ

4

0

1

2

3

4

θ

Figure 3.2. Histograms of a randomly chosen simulated parameter ensemble under the compound
.
Gaussian and compound Gamma models in panel (a) and (b), respectively, for n = 100 and RLS = 1. For
each model, ensemble distributions of point estimates have been superimposed for five different estimation
schemes.

As for the Q-SEL function, increasing the level of heterogeneity of the sampling variances
had a detrimental effect on the percentage regret exhibited by the MLE, SSEL and CB plug-in
estimators. The performance of these three families of QR estimators systematically decreased
as RLS increased (cf. table 3.2 on page 43). The plug-in estimator under the WRSEL function,
by contrast, tended to behave in the opposite direction, whereby an increase in RLS yielded an
increase in performance, albeit this increase was restricted to the N-N model. Both the GR and
DoPQ/RoPQ plug-in estimators appeared to be robust to changes in RLS levels, although the GR
estimator of the QR exhibited a substantial increase in percentage regret for very large parameter
.
ensembles –i.e. for RLS = 100 and n = 1000, where the percentage regret for using the GR
reached 24% of the posterior loss under the optimal estimator.
The choice of statistical model had a strong effect on the performance of the MLE, SSEL and CB
plug-in estimators. Consider the values of the percentage regrets in parentheses in columns three,
five and nine of table 3.2 on page 43. For these three families of ensembles of point estimates, the
use of a compound Gamma model yielded a larger percentage regret. For the WRSEL estimator
of the QR, no systematic trend could be identified, as the performance of that estimator under
the different statistical models seemed to be also dependent on the choice of RLS levels and the
number of units in the parameter ensemble. In addition, the behaviour of the triple-goal plug-in
estimator appeared to deteriorate under the G-IG model. The DoPQ/RoPQ plug-in estimators,
by contrast, exhibited slightly lower percentage regret under the compound Gamma model.
Increasing the size of the parameter ensemble tended to produce worse plug-in estimators with
higher posterior percentage regrets. This trend can be observed for the MLE, SSEL, WRSEL
and CB plug-in estimators. The triple-goal and DoPQ/RoPQ-based QR estimators, by contrast,
appeared to be robust to an increase in the size of the parameter ensemble. No systematic effect
of the size of n could be noticed for these two families of estimators. In summary, the GR and
DoPQ/RoPQ plug-in estimators exhibited the best performance under both the Q-SEL and QR-

42

0

Table 3.2. Posterior regrets based on QR-SEL(θ, QR(θ L )), for five plug-in estimators, for the compound
Gaussian model in equation (2.20) and the compound Gamma model in equation (2.21), for 3 different
levels of RLS, and 3 different values of n, averaged over 100 replicate data sets. The posterior expected loss
of the optimal estimator is given in the first column. Entries were scaled by a factor of 103 . In parentheses,
the posterior regrets are expressed as percentage of the posterior loss under the optimal estimator.
Scenarios
.
RLS = 1
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 20
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 100
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000

QR-SEL

MLE

SSEL

Posterior regretsa
WRSEL

CB

21
11
2
27
14
3

329
325
313
18641
12501
12692

(1565)
(3001)
(14063)
(69283)
(92484)
(471628)

151 (717)
158 (1455)
160 (7198)
467 (1736)
488 (3608)
486 (18078)

39
(184)
705 (6503)
6258 (281565)
160
(593)
16
(116)
2098 (77969)

9 (45)
4 (38)
2 (76)
61 (226)
44 (328)
50 (1871)

21
10
2
27
13
3

448
436
412
22062
19019
17738

(2139)
(4237)
(19081)
(83039)
(142416)
(675792)

181 (866)
206 (1998)
195 (9012)
572 (2154)
565 (4228)
566 (21555)

20
(97)
478 (4643)
5016 (232022)
296 (1113)
63
(475)
850 (32365)

20
10
2
26
13
3

522 (2660)
463 (4578)
500 (24301)
65739 (256477)
36096 (284722)
29789(1140841)

213 (1087)
270 (2664)
270 (13108)
563 (2197)
572 (4510)
586 (22424)

7
(34)
259 (2555)
3804 (184974)
301 (1176)
97
(763)
569 (21800)

GR
0
0
0
0
0
0

RoPQ

(1)
(0)
(1)
(2)
(2)
(4)

0(2)
0(1)
0(0)
0(0)
0(0)
0(0)

10 (48)
9 (91)
6 (278)
105 (397)
153 (1148)
176 (6721)

0 (1)
0 (0)
0 (1)
0 (1)
0 (1)
0(11)

0(2)
0(1)
0(0)
0(0)
0(0)
0(0)

18 (93)
32 (320)
32 (1542)
148 (579)
147 (1160)
230 (8806)

0 (0)
0 (0)
0 (1)
1 (3)
0 (1)
1(24)

0(2)
0(1)
0(0)
0(0)
0(0)
0(0)

a

Entries for both the posterior and percentage regrets have been truncated to the closest integer. For some entries,
percentage regrets are smaller than 1 percentage point.

SEL functions, over all the scenarios considered. We now present a set of spatial simulations to
evaluate the behaviour of the different families of plug-in estimators of interest under more realistic
modelling assumptions.

3.4

Spatial Simulations

In this simulation study, four experimental factors were of interest. Firstly, we manipulated the
spatial structure of the true parameter ensemble. Secondly, we considered the effect of different
modelling assumptions. Thirdly, we modified the level of heterogeneity of the parameter ensemble,
and finally, we assessed the influence of changing the overall level of the expected counts, in each
scenario.

3.4.1

Design

The general framework for data generation followed the one implemented by Richardson et al.
(2004). The data were generated using a subset of expected counts from the Thames Cancer
Registry (TCR) for lung cancer in West Sussex, which contains n = 166 wards. The expected
counts, denoted Ei ’s for i = 1, . . . , n, were adjusted for age only, and correspond to the number
of cases of lung cancer occurring among males during the period 1989–2003. The overall level of
expected counts for lung cancer over the entire region varied from min(E) = 7.97 to max(E) =
114.35 with a mean of 42.44. The level of the expected counts was also made to vary across the
simulations, in order to assess its influence on the performances of the different plug-in estimators.
Specifically, we will study the effect of three different levels of expected counts over the performance
of the plug-in estimators of interest.
Four different types of spatial patterns were simulated. The main objective of these simulations
was to create a set of varying levels of difficulty for a smoothing technique, such as the CAR prior.
43

Relative Risks
SC1

SC2
2.2

2.0

1.8

1.6

SC3

SC4

1.4

1.2

1.0

0.8

0.6

Figure 3.3. True RRs based on expected counts (SF = 1.0) for lung cancer among males between 1989
and 2003, for 166 wards located in West Sussex, UK. The values of the RRs were generated using the
protocols described in section 3.4.2, and are respectively denoted by SC1 (one isolated cluster), SC2 (five
isolated clusters and five isolated areas), SC3 (spatial pattern generated using the Matèrn function), SC4
(spatial pattern using a hidden covariate). RRs in all four scenarios were here produced with a medium
level of variability.

The scenarios were thus constructed in order to include a scenario with only a single isolated area
of elevated risk (simulation SC1, the hardest scenario for a smoothing procedure) and a situation
containing a relatively smooth risk surface with clear spatial structure (simulation SC3). The
spatial simulations were constructed either by randomly selecting a subset of the areas in the
region and labelling these areas as elevated-risk areas (SC1 and SC2), or by directly modelling
the generation of the RRs ascribed to each area (SC3 and SC4). The construction of the spatial
scenarios occurred only once, and the overall level of the expected counts was kept constant
throughout the four spatial scenarios.

3.4.2

Spatial Structure Scenarios

Four different spatial structures were constructed, which respectively correspond to a situation
with one isolated foyer of elevated risk (SC1), five isolated foyers and five isolated areas of elevated
risk (SC2), a spatially distributed risk pattern (SC3), and the effect of a spatially structured risk
factor (SC4). For each scenario, we describe the generation of the true RRs. In each case, three
different levels of risk variability across the region was generated by manipulating scenario-specific
parameters. Scenarios SC1 and SC2 replicate the first two spatial simulations considered by
Richardson et al. (2004).
Simulation 1 (SC1). In the first scenario, a single isolated cluster of areas with elevated risk

44

Observed Counts
SC1

SC2
160

140

120

100

SC3

SC4
80

60

40

20

Figure 3.4. Simulated observed counts based on expected counts (SF = 1.0) for lung cancer among males
between 1989 and 2003, for 166 wards located in West Sussex, UK. The values of the yi ’s were generated
following the protocols described in section 3.4.2, with a medium level of variability in the RRs.

was generated by choosing an area randomly, and selecting its first-degree neighbours. The
cluster was chosen such that the total sum of the expected counts of the areas contained in
the cluster was approximately equal to 5% of the sum of the expected counts over the entire
region. The remaining areas in the region will be referred to as background areas. The set
of indices of the wards in the cluster will be denoted by E, whereas the background areas
will be denoted by B := {i = 1, . . . , n : i ∈
/ E}. The level of risk in each individual ward was
then fixed using the following rule,
(
1
if i ∈ B,
θi :=
(3.28)
LR if i ∈ E;
where LR stands for level of risk. Three different levels of elevated risk were chosen with
LR = {1.5, 2.0, 3.0}, thereby creating different levels of RR variability in the simulated data
sets.
Simulation 2 (SC2). In the second scenario, we created a situation of mixed heterogeneity by
combining both the simulation of clustered foyers of risks with the presence of isolated single
areas with elevated risks. Firstly, five single areas were categorised as elevated risk areas.
These areas corresponded to the 10th , 20th , 50th , 75th and 90th percentiles of the empirical
distribution of the expected counts. The indices of these five wards will be denoted by I.
In addition, we chose five non-contiguous clusters, which did not comprise the individual
areas of elevated risk. These foyers, denoted Cj ’s with j = 1, . . . , 5, were constructed using
the method described for the first scenario, ensuring that the cumulated expected counts in
45

SMRs
SC1

SC2

2.0

1.5

SC3

SC4

1.0

0.5

Figure 3.5. Simulated SMRs based on expected counts (SF = 1.0) for lung cancer among males between
1989 and 2003, for 166 wards located in West Sussex, UK. The values of the SMRs were generated following
the protocols described in section 3.4.2, with a medium level of variability in the RRs.

each cluster did not exceed 5% of the total sum of expected counts in the region. Variability
in levels of risk was here controlled by varying LR. As in the first scenario, for every i, we
defined the θi ’s according to the rule described in equation (3.28), except that the set of
indices of the elevated risk areas was here defined as
E := I ∪

5
[

Cj .

(3.29)

j=1

Note that some buffering was required in simulations SC1 and SC2 in order to ensure that
the randomly selected areas and clusters, respectively, were not adjacent or overlapping with
each other. This was done by selecting a buffer of background areas around each of the
cluster in SC1, and around each cluster and each of the individual areas in SC2. Note that
in the latter case, the neighbours of the neighbours of the regions included in any one cluster
were also excluded from further random selection, in order to ensure non-adjacent clusters.
Simulation 3 (SC3). In a third scenario, a spatially structured risk surface was generated using
the Matèrn function. Spatial structure was specified through the variance/covariance matrix,
Σ, of the log θi ’s. We computed the following symmetric matrix of intercentroidal distances,
denoted D, whose entries take the following values,
Dij = ||xi − xj ||2 ,

(3.30)

for every pair of indices (i, j), with ||·||2 denoting the L2-norm and where each xi represents a
46

set of 2-dimensional coordinates locating the centroid of the ith region in R2 . By convention,
Dii := 0 for every i. We then computed the mean intercentroidal distance between all pairs
of neighbours, defined as follows,
n
1 X
Dij I{i ∼ j},
w̄ =
N∂ i<j

(3.31)

where N∂ is the total number of neighbouring relationships in the entire region. We used
w̄ to select a particular level of risk decay, as a function of the intercentroidal distance.
Our objective was here to obtain high to moderate correlations when the intercentroidal
distance approached w̄. Spatial autocorrelations were then made to drop off to a low level
once the distances were equal to twice the value of the mean intercentroidal distance. We
used the Matèrn function to specify this form of spatial structure in the entries of the
variance/covariance matrix, such that
Σij =

1
2ν−1 Γ(ν)

√
√
(2 νDij φ)ν Kν (2 νDij φ),

(3.32)

choosing φ = 3000 and ν = 40, and where Kν (·) denotes the modified Bessel function of the
third kind of order ν. The resulting matrix Σ was then used to draw sets of realisations
from a multivariate normal distribution,
2
log(θ) ∼ MVN(0, σSC3
Σ),

(3.33)

2
with parameter σSC3
controlling for the overall marginal variance of the spatial structure.
Three different values of σSC3 among {0.1, 0.2, 0.3} were selected in order to vary the amount
of variability of the RRs.

Simulation 4 (SC4). The last scenario produced a risk surface characterised by a high heterogeneity, which was generated using a hidden covariate. We used the Carstairs’ deprivation
index (CDI) for each area in the region of interest in order to create spatial variation in levels
of risk (Carstairs and Morris, 1989a,b, Carstairs, 2000). The logRRs were here generated
using a linear combination of the ward-specific CDIs. Formally, we had
log(θi ) = α + βCi + vi ,

(3.34)

2
where vi ∼ N (0, σSC4
), and Ci indicates the level of social deprivation in the ith ward. The
intercept α was assumed to be null throughout the simulations. The regression coefficient,
β, took values in the set {0.2, 0.3, 0.4} in order to produce different levels of variability in the
parameter ensemble, while the standard deviation, σSC4 , was fixed to 0.1 in this scenario.
The set of values for β allowed the generation of scenarios with low, medium and high RR
variability.
Pn
PnThe simulated observed counts in each scenario were simulated under the constraint i=1 yi =
i=1 Ei (see Wright et al., 2003, for an example of synthetic simulations under this constraint).
This condition was respected by generating the full vector of observed counts, y, from a multinomial distribution parametrised
such that the number of trials corresponded to the total number
Pn
of expected counts i=1 Ei , denoted NE , and with the following vector of probability masses


E1 θ1
En θn
π := Pn
, . . . , Pn
, ,
(3.35)
i=1 Ei θi
i=1 Ei θi

and using
y ∼ Multinomial (NE , π) ,

(3.36)

47

for each of the scenarios and under the three levels of variability. For every combination of scenario
and variability, we produced 100 replicates, thereby totalling 1,200 different data sets. Since each
of these data sets was fitted with two different models, the complete spatial simulations generated
2,400 sets of joint posterior distributions of parameter ensembles. In addition, we also produced
further simulations in order to evaluate the effect of different scaling of the expected counts. We
employed three different values of the scaling factor (SF), such that
SF ∈ {0.1, 1.0, 2.0}.

(3.37)

That is, for each combination of the aforementioned experimental factors, we additionally varied
the level of the expected counts
ind
yi ∼ Pois(θi Ei SF),
(3.38)
for every i = 1, . . . , n, for a given vector of true θi ’s, whose generation depended on the specific
spatial scenario considered. The main simulation results in this section will be described for
SF = 1.0. In section 3.4.6, however, we will briefly consider the consequences of scaling up or
scaling down the expected counts for a smaller subset of simulated data, choosing SF to be either
0.1 or 2.0.
Typical examples of the different maps produced by this set of simulated scenarios are illustrated in Figures 3.3, 3.4, and 3.5, representing the true RRs, observed counts and standard
mortality ratios, respectively. These maps were produced for a medium level of variability with
2
2
LR = 2 for SC1 and SC2, σSC3
= σSC4
= 0.2 and β = 0.3, for SC3 and SC4. The full details of the
simulated data sets are given in tables B.1, B.2 and B.3, on pages 100, 100 and 101, respectively,
in appendix B. These tables also include descriptive statistics for simulated data based on different
scaling of the expected counts.

3.4.3

Fitted Models

The synthetic data sets were modelled using the two spatial BHMs described in section 2.2.2.
These models are characterised by the combined use of spatially structured and unstructured
random effects. This particular combination of random effects was originally introduced by Besag
et al. (1991), and is therefore sometimes referred to as the BYM model (see also Best et al.,
2005). The CAR Normal and CAR Laplace models were fitted using WinBUGS 1.4 (Lunn et al.,
2000) with 4,000 iterations including 2,000 burn-in. In this software, the ui ’s in the CAR priors
are constrained to sum to zero (Spiegelhalter et al., 2000). The non-stationarity of the model,
however, is induced by specifying a flat prior on α, which is the intercept for the log θi ’s in equation
(2.27). That is, we have
α ∼ Unif(−∞, +∞).
(3.39)
This particular formulation of the CAR distribution was suggested by Besag and Kooperberg
(1995). The CAR Normal and CAR Laplace models are fully specified once the hyperparameters
τv2 and τu2 in equations (2.28) and (2.29), respectively, are given hyperpriors. In our case, these
two parameters were given the following ‘vague’ specification,
τv−2 ∼ Gam(a0 , b0 ),

τu−2 ∼ Gam(a0 , b0 ),

(3.40)

where we chose a0 := .5 and b0 := .0005, which constitutes a common specification for BHMs
(Gelman, 2006). Note, however, that different choices of hyperparameters may yield different
posterior distributions of the parameters of interest. The WinBUGS codes used for these two
models is reported in appendix C. We now consider in greater detail the various aspects of a
parameter ensemble in a BHM that may be of interest, and how estimation of these aspects may
be optimised.
For each simulated scenario, we computed the posterior regrets under the Q-SEL and QR-SEL
functions, as described in section 3.2.3. In both cases, we estimated these loss functions with

48

respect to the vector of RRs, θ. For the Q-SEL function, this gave

regret Q-SELp , Qθ̂L0 (p) .

(3.41)

0

for different plug-in estimators, θ̂ L , and where the optimal estimator under this loss function is
the vector of posterior empirical p-quantiles as reported in equation (3.7). Similarly, the following
posterior regret was calculated to quantify the estimation of the QR using ensembles of sub-optimal
point estimates,


0
regret QR-SEL, QR(θ̂ L ) ,
(3.42)
defined with respect to QR-SEL(θ, δ), as described in section 3.2.3. Note that we have here chosen
to compute both the empirical quantiles and the QR on the scale of the RR. However, we could
have chosen to evaluate these quantities with respect to the logRRs. In section 3.6, we discuss the
implications of such a change of parametrisation on the decision-theoretic problems of interest.
All the results presented in the following sections are expressed as posterior expected losses,
which are functions of the joint posterior distribution of the parameters under scrutiny. Since
these evaluative criteria are highly dependent on the type of hierarchical models used for the
evaluation, we have also computed the mean squared error of the QR with respect to the true QR,
based on the simulated RRs. For the BYM model, we found that the optimal QR estimate (i.e.
the posterior mean of the empirical QR) was on average at a 0.082 square distance from the true
QR. That discrepancy was slightly higher for the Laplace model, at 0.087, when averaged over all
simulated scenarios.

3.4.4

Plug-in Estimators under Q-SEL

The results of the spatial data simulations for the estimation of the parameter ensemble’s quantiles
are presented in table 3.3, on page 50, for the CAR normal (denoted BYM in the table) and the
CAR Laplace (denoted L1 in the table). As for the non-spatial simulations, we reported the
percentage posterior regrets in parentheses for each plug-in estimator. Note that for these spatial
simulations, the parameters controlling the size of the φi ’s in the WRSEL function were given the
following specification, a1 = a2 = 0.5, which is a symmetric version of the original specification
used by Wright et al. (2003) for similar spatial models.
Overall, the GR plug-in estimator of the first and third quartiles outperformed the four other
plug-in estimators across all spatial scenarios and levels of the different experimental parameters.
The quartiles derived from the ensemble of CB point estimates tended to exhibit the second best
performance on most scenarios, followed by the quartiles of the SSEL and WRSEL ensemble
distributions, with the WRSEL displaying the worse performance, as can be observed in column
six of table 3.3, on page 50. The MLE-based empirical quartiles were poor when we considered
SC3 and SC4 as spatial scenarios. However, the MLE plug-in estimates outperformed the SSEL,
WRSEL and CB ensemble quartiles under scenarios SC1 and SC2, for simulations with medium
to high heterogeneity of the true RRs.
The most important experimental factor was the use of different scenarios, as can be observed
in table 3.3 by comparing the SC1/SC2 lines with the SC3/SC4 lines of each section of the
table. In particular, SC1 and SC2 tended to produce very different outcomes from the ones
obtained for the SC3 and SC4 synthetic data sets. One should note that the SC1 and SC2
spatially structured scenarios are somewhat artificial because the true distributions of the level
of risks in these scenarios is discrete: each RR can only take one of two values. This produced
some particularly counter-intuitive results when comparing the performances of different plug-in
estimators.
In figure 3.6 on page 51, the typical ensemble distributions for different choices of point estimates are reported under the four spatial scenarios. Despite the discrete nature of the true
distributions in scenarios SC1 and SC2, all ensembles of point estimators behaved similarly in
terms of level of shrinkage. That is, the WRSEL and SEL functions exerted a moderate to high
level of shrinkage towards the prior mean, whereas the CB and GR point estimators resulted in an
49

Table 3.3. Posterior regrets based on Q-SELp (θ, Qθ̂L0 (p)) with p := {.25, .75}, for five plug-in estimators,
and with the posterior expected loss of the optimal estimator in the first column. Results are presented
for three different levels of variability, with SF = 1.0 and for four spatial scenarios: an isolated cluster
(SC1), a set of isolated clusters and isolated areas (SC2), highly structured spatial heterogeneity (SC3),
and a risk surface generated by a hidden covariate (SC4). Entries, averaged over 100 replicate data sets in
each condition, are scaled by a factor of 103 with posterior regrets expressed as percentage of the posterior
loss under the optimal estimator in parentheses.
Scenarios
Q-SEL
Low Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
Med. Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
High Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4

MLE

SSEL

0.6
0.8
1.1
0.9
0.7
0.8
1.2
1.0

6.9 (1091)
4.1 (511)
3.4 (300)
5.5 (606)
7.2 (1058)
4.1 (504)
4.5 (375)
5.6 (578)

2.0
3.3
0.7
1.7
2.1
3.7
1.3
2.2

(315)
(416)
(63)
(183)
(316)
(458)
(108)
(232)

0.6
1.3
1.5
1.2
0.7
1.4
1.7
1.3

1.6
2.7
2.8
4.0
1.5
3.9
3.5
4.4

(246)
(200)
(181)
(325)
(223)
(270)
(208)
(338)

3.3
9.9
1.0
1.2
3.7
10.6
1.5
1.7

0.8
2.2
1.8
1.6
0.8
2.4
2.0
1.7

0.6
7.7
2.8
3.4
1.0
10.8
3.9
3.7

(85)
(353)
(158)
(214)
(120)
(447)
(196)
(224)

4.3
18.4
1.0
1.0
4.4
19.1
1.3
1.4

Posterior regretsa
WRSEL

CB

GR

22.0 (3477)
93.8 (11651)
151.4 (13427)
140.6 (15476)
21.1 (3104)
99.3 (12136)
206.2 (17237)
156.9 (16341)

0.3 (55)
1.1(142)
0.7 (58)
0.4 (48)
0.3 (41)
1.0(124)
0.6 (54)
0.4 (42)

0.1(11)
0.1 (7)
0.1 (5)
0.1 (7)
0.1(10)
0.1 (8)
0.1 (5)
0.1 (7)

(510)
(738)
(65)
(98)
(531)
(738)
(88)
(129)

65.9 (10179)
235.5 (17548)
215.0 (13906)
230.9 (18609)
71.1 (10299)
210.7 (14650)
321.7 (19389)
262.5 (20067)

1.3(195)
7.3(542)
0.8 (52)
0.5 (43)
1.3(188)
7.4(517)
1.0 (59)
0.7 (51)

0.1(10)
0.1 (5)
0.1 (4)
0.1 (5)
0.1(10)
0.1 (4)
0.1 (4)
0.1 (5)

(566)
(840)
(57)
(61)
(537)
(794)
(64)
(82)

115.2 (15209)
578.4 (26420)
253.8 (14156)
300.6 (18872)
124.0 (15255)
619.5 (25727)
357.2 (18064)
346.5 (20771)

2.6(342)
16.8(767)
1.1 (62)
0.8 (48)
2.6(316)
17.1(711)
1.2 (61)
1.0 (57)

0.1(10)
0.1 (3)
0.1 (4)
0.1 (4)
0.1 (9)
0.1 (3)
0.1 (5)
0.1 (4)

a

Entries for the posterior regrets have been here truncated to the closest first digit after the decimal point,
whereas entries for the percentage regrets have been truncated to the closest integer.

ensemble distribution closer to the true ensemble of the RRs. The MLEs, by contrast, tended to be
over-dispersed. In effect, the ordering of the different families of point estimators in terms of level
of shrinkage was maintained. Therefore, the estimators retained their typical properties. However,
it is these properties that have changed in their level of desirability. While the over-dispersion
of the MLEs is generally a disadvantage in terms of the estimation of the quantiles of the true
ensemble distribution; for SC1 and SC2, it has now become one of the desirable properties of a
point estimator because the true RRs are artificially over-dispersed in these two scenarios. These
observations account for the superiority of the quartiles based on the ensemble distribution of the
MLEs in comparison to the SSEL, WRSEL and CB plug-in estimators for these scenarios.
The level of variability of the true ensemble of RRs was also found to have a substantial effect
on the ordering of the different plug-in estimators in terms of percentage regret, although this effect
was mediated by the choice of spatial scenarios. For the discrete two-category spatial scenarios –
SC1 and SC2– the quartiles of the ensemble distributions of the SSEL, WRSEL and CB estimators
were detrimentally affected by an increase in the heterogeneity of the true parameter ensemble.
The MLE-based empirical quartiles, by contrast, appeared to improve their performance as the
true RRs became more dispersed, although this trend was mainly restricted to the SC1 scenario.
For SC3 and SC4, however, the effect of increasing the variability of the RRs tended to result
in a decrease in percentage regret for most plug-in estimators, although systematic trends were
difficult to isolate. Under SC4, the MLE, SSEL and WRSEL plug-in estimators were positively
affected by an increase in the heterogeneity of the RR ensemble.
50

(a)

(b)

8
Density

10

8
Density

10

6
4
2

4
2

0

0
0.0

0.5

1.0

1.5

2.0

0.0

0.5

1.0

θ

θ

(c)

(d)

4

4

3

3

Density

Density

6

2
1

1.5

2.0

MLE
SSEL
WRSEL
CB
GR

2
1

0

0
0.0

0.5

1.0

1.5

2.0

θ

0.0

0.5

1.0

1.5

2.0

θ

Figure 3.6. Histograms of simulated parameter ensembles, under scenarios SC1, SC2, SC3 and SC4 in
panels (a), (b), (c) and (d), respectively for a low variability specification. Distributions of point estimate
ensembles have been superimposed using different coloured lines, and are based on posterior distributions
produced under the CAR Normal model. For SC1 and SC2, in panels (a) and (b), the true parameter
ensemble of the RRs is a discrete distribution on solely two values.

The choice of the CAR prior –that is, the contrast between the BYM model with its robust
version based on the Laplace distribution– mainly affected the SSEL, WRSEL and CB plug-in
estimators, whose performance was worsened when using the CAR Laplace prior, under the SC3
and SC4 simulation scenarios. We note, however, that this trend was not completely verified for
the CB quartile estimator for which the use of the BYM model produced worse percentage regret
under low variability. The GR plug-in estimators, by contrast, appeared to be only marginally
affected by the choice of prior. The use of the Laplace prior slightly increased the posterior
expected loss (cf. first column of table 3.3, on page 50) associated with the optimal estimator
under the Q-SEL function, thereby indicating that the use of such a model leads to estimators of
empirical quartiles, which are inferior to the ones obtained when specifying a CAR Normal prior.

3.4.5

Plug-in Estimators under QR-SEL

The posterior regrets associated with the QR-SEL function for different plug-in estimators and
different levels of experimental factors are presented in table 3.4, on page 52. The results for the
QR-SEL function were found to follow the pattern described for the Q-SEL function. As in the
preceding section, the most important experimental factor was the choice of simulation scenario.
Although the over-dispersion of the MLEs was found to be disadvantageous when estimating the
QR under SC1 and SC2 with a low level of variability in the true RRs, this property became
advantageous as the variability of the RRs increased. The converse was true for the QRs of the
SSEL, WRSEL and CB ensemble distributions. That is, these three families of plug-in estimators
produced QRs associated with greater percentage regret under SC1 and SC2, as the level of
variability increased. As for the Q-SEL, the triple-goal plug-in estimator was found to outperform
all the other ensembles of point estimates across all scenarios and experimental conditions. For
the QR-SEL, we also evaluated the posterior regret associated with the use of the RoPQ. This
particular choice of estimator yielded a quasi-optimal performance with percentage regrets lower
than one percentage point under all scenarios considered.

51

0

Table 3.4. Posterior regrets based on QR-SEL(θ, QR(θ L )) for six plug-in estimators, and with the
posterior expected loss of the optimal estimator in the first column. Results are presented for three
different levels of variability, with SF = 1.0 and for four spatial scenarios: an isolated cluster (SC1), a
set of isolated clusters and isolated areas (SC2), highly structured spatial heterogeneity (SC3), and a risk
surface generated by a hidden covariate (SC4). Entries, averaged over 100 replicate data sets in each
condition, are scaled by a factor of 103 with posterior regrets expressed as percentage of the posterior loss
under the optimal estimator in parentheses.
Scenarios
QR-SEL
Low Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
Med. Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
High Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4

MLE

SSEL

1
1
3
1
1
1
3
2

18
13
14
20
19
12
19
18

(2583)
(1152)
(521)
(1349)
(2295)
(1016)
(686)
(1150)

5
9
2
5
5
11
5
8

(679)
(849)
(86)
(371)
(636)
(924)
(173)
(496)

1
3
6
3
1
3
6
3

3
2
16
18
3
3
21
17

(451)
(86)
(284)
(640)
(344)
(103)
(341)
(574)

9
30
5
5
10
32
8
8

1
6
8
5
1
6
9
5

1
16
18
19
2
24
26
17

(99)
(288)
(215)
(398)
(172)
(379)
(280)
(354)

13
63
5
5
13
67
7
8

Posterior regretsa
WRSEL

CB

GR

RoPQ

58 (8187)
489 (44527)
1355 (50724)
871 (58847)
61 (7454)
537 (46600)
2059 (72936)
1021 (65581)

1(106)
2(195)
2 (89)
1 (57)
1 (73)
2(167)
2 (62)
1 (51)

0
0
0
0
0
0
0
0

(1)
(0)
(1)
(0)
(2)
(0)
(1)
(1)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

(1327)
(1149)
(81)
(193)
(1271)
(1128)
(132)
(252)

72 (10596)
453 (17301)
3093 (54655)
2181 (77181)
100 (12706)
760 (26507)
5694 (93879)
2569 (86403)

4(585)
19(711)
3 (61)
1 (38)
4(514)
19(650)
4 (65)
1 (47)

0
0
0
0
0
0
0
0

(1)
(0)
(3)
(1)
(1)
(0)
(2)
(1)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

(1409)
(1128)
(65)
(108)
(1211)
(1077)
(77)
(155)

149 (16321)
76 (1357)
4858 (58570)
3930 (83209)
175 (16350)
103 (1658)
7609 (82689)
4772 (97158)

10(1043)
52(927)
10(122)
2 (34)
9(873)
54(870)
6 (70)
2 (40)

0
0
0
0
0
0
0
0

(2)
(1)
(1)
(1)
(1)
(1)
(1)
(1)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

a

Entries for both posterior and percentage regrets have been here truncated to the closest integer. For some
entries, percentage regrets are smaller than 1 percentage point.

As with quantile estimation, the use of the CAR Laplace prior resulted in higher posterior
expected losses when considering the optimal estimator of the QR, and also tended to produce
substantially larger percentage posterior regrets for the SSEL, WRSEL and CB plug-in estimators.
In summary, this spatial simulation study has shown that the different plug-in estimators of interest
tend to behave similarly under both the Q-SEL and QR-SEL functions. As for the non-spatial
study, the triple-goal estimators were found to exhibit the lowest amount of percentage regret
across all the simulation scenarios considered.

3.4.6

Consequences of Scaling the Expected Counts

Simulation results for two different scalings of the expected counts are reported in table 3.5 on
page 53 for the Q-SEL function and in table 3.6 on page 54 for the QR-SEL function. As in the
previous sections, percentage regrets with respect to the posterior loss under the optimal estimator
is reported in parentheses in the two tables.
For both the Q-SEL and QR-SEL functions, the use of smaller expected counts resulted in
a substantial increase of the posterior losses associated with the use of the optimal estimators
under all simulated scenarios. Similarly, the absolute posterior regrets associated with the use of
the MLE, SSEL, WRSEL and CB plug-in estimators tended to be larger when applying a scaling
factor of 0.1, in comparison to the use of a scaling factor of SF = 2.0. In terms of percentage
regret, however, this trend was reversed for the GR plug-in estimators under both the Q-SEL and
52

Table 3.5. Posterior regrets based on Q-SELp (θ, Qθ̂L0 (p)) with p := {.25, .75}, for five plug-in estimators,
and with the posterior expected loss of the optimal estimator reported in the first column. Results are
presented for three different levels of variability, and for four spatial scenarios: an isolated cluster (SC1),
a set of isolated clusters and isolated areas (SC2), highly structured spatial heterogeneity (SC3), and a
risk surface generated by a hidden covariate (SC4). Entries, averaged over 100 replicate data sets in each
condition, are scaled by a factor of 103 with posterior regrets expressed as percentage of the posterior loss
under the optimal estimator in parentheses.
Scenarios
Q-SEL
SF = 0.1 Low Variab.
BYM-SC1
4.2
BYM-SC2
4.1
BYM-SC3
6.3
BYM-SC4
5.5
L1-SC1
4.3
L1-SC2
4.1
L1-SC3
8.6
L1-SC4
6.0
SF = 0.1 Med. Variab.
BYM-SC1
5.7
BYM-SC2
8.6
BYM-SC3
7.4
BYM-SC4
7.4
L1-SC1
4.8
L1-SC2
6.7
L1-SC3
7.3
L1-SC4
8.0
SF = 0.1 High Variab.
BYM-SC1
6.1
BYM-SC2
8.3
BYM-SC3
7.5
BYM-SC4
7.6
L1-SC1
6.7
L1-SC2
8.4
L1-SC3
10.1
L1-SC4
7.3
SF = 2 Low Variab.
BYM-SC1
0.3
BYM-SC2
0.5
BYM-SC3
0.7
BYM-SC4
0.6
L1-SC1
0.3
L1-SC2
0.5
L1-SC3
0.7
L1-SC4
0.6
SF = 2 Med. Variab.
BYM-SC1
0.3
BYM-SC2
1.2
BYM-SC3
1.1
BYM-SC4
0.8
L1-SC1
0.4
L1-SC2
1.2
L1-SC3
1.2
L1-SC4
0.9
SF = 2 High Variab.
BYM-SC1
0.4
BYM-SC2
1.7
BYM-SC3
1.3
BYM-SC4
1.1
L1-SC1
0.7
L1-SC2
1.9
L1-SC3
1.5
L1-SC4
1.1

MLE

SSEL

Posterior regretsa
WRSEL

2.8 (66)
3.2 (78)
3.0 (47)
6.0 (109)
2.7 (61)
2.9 (70)
7.6 (89)
7.3 (121)

1.9 (46)
2.5 (60)
3.0 (47)
4.9 (88)
2.0 (45)
2.3 (55)
6.7 (78)
6.1 (101)

CB

GR

0.3 (7)
0.3 (8)
1.7 (27)
1.2 (21)
0.3 (6)
0.3 (7)
0.9 (11)
0.5 (8)

0.2
0.1
0.1
0.1
0.2
0.2
0.3
0.2

(4)
(1)
(1)
(2)
(4)
(5)
(4)
(3)

1.7
1.5
3.2
2.8
0.5
1.1
3.5
1.5

(30)
(18)
(43)
(38)
(9)
(17)
(48)
(19)

0.1
0.3
0.1
0.1
0.2
0.1
0.1
0.3

(1)
(3)
(1)
(2)
(4)
(2)
(2)
(4)

0.1
0.1
0.1
0.1
0.1
0.1
0.3
0.1

(1)
(1)
(1)
(1)
(1)
(1)
(3)
(1)

216.6
231.5
138.8
211.6
222.3
243.9
200.1
235.7

(5163)
(5614)
(2197)
(3827)
(5136)
(5912)
(2335)
(3900)

189.2
166.6
92.9
155.8
231.2
171.0
154.7
175.4

(3332)
(1941)
(1261)
(2115)
(4810)
(2559)
(2115)
(2184)

6.4
13.9
4.5
14.0
4.9
18.7
23.0
17.1

(114)
(162)
(61)
(190)
(102)
(280)
(314)
(213)

4.7
12.3
3.5
10.1
3.9
15.3
20.1
14.2

(82)
(144)
(48)
(137)
(80)
(229)
(275)
(177)

103.9
78.2
73.6
103.9
89.3
75.8
109.5
116.2

(1706)
(939)
(986)
(1364)
(1329)
(898)
(1079)
(1589)

17.7
26.0
6.6
11.8
27.7
38.9
17.7
32.0

(291)
(312)
(89)
(155)
(413)
(462)
(175)
(438)

14.5
24.0
7.3
9.2
23.2
39.9
18.1
28.0

(238)
(288)
(98)
(121)
(345)
(473)
(178)
(383)

6.4(104)
7.9 (95)
6.7 (90)
3.3 (43)
6.0 (89)
10.2(121)
5.8 (58)
5.0 (68)

1.6
1.3
1.3
1.5
1.6
1.3
1.7
1.5

(540)
(260)
(191)
(249)
(461)
(231)
(250)
(237)

1.3
2.7
0.3
0.7
1.4
2.6
0.5
0.7

(429)
(516)
(44)
(112)
(419)
(467)
(66)
(108)

1.0
1.6
0.2
0.5
1.0
2.0
0.4
1.0

(344)
(302)
(26)
(89)
(307)
(373)
(54)
(152)

0.5(159)
1.4(279)
0.3 (44)
0.2 (39)
0.5(143)
1.1(195)
0.4 (56)
0.1 (13)

0.1(25)
0.1(13)
0.1 (9)
0.0 (8)
0.1(16)
0.1 (9)
0.1 (9)
0.1(15)

0.2
3.1
1.5
1.1
0.7
4.3
2.1
1.2

(74)
(270)
(129)
(142)
(197)
(346)
(175)
(136)

1.8
8.8
0.5
0.3
1.9
7.7
0.7
0.5

(552)
(755)
(41)
(38)
(518)
(623)
(62)
(59)

1.5
6.3
0.3
0.2
1.6
7.1
0.6
0.5

(464)
(541)
(25)
(25)
(445)
(576)
(49)
(61)

1.1(327)
7.7(664)
0.5 (48)
0.3 (32)
1.0(274)
6.4(521)
0.8 (69)
0.3 (32)

0.1(24)
0.1 (5)
0.1 (5)
0.1 (7)
0.1(26)
0.0 (4)
0.1 (5)
0.1 (6)

0.3
8.7
0.8
1.6
0.7
9.2
0.8
1.7

(73)
(505)
(61)
(150)
(100)
(485)
(56)
(149)

2.3
12.4
0.5
0.5
2.2
12.8
0.8
0.3

(618)
(717)
(40)
(43)
(333)
(676)
(56)
(31)

1.9
10.7
0.6
0.3
1.5
11.5
0.6
0.5

(489)
(621)
(45)
(32)
(232)
(610)
(40)
(44)

1.7(449)
12.1(701)
0.6 (46)
0.4 (33)
1.6(241)
12.5(660)
0.7 (47)
0.4 (32)

0.1(19)
0.1 (4)
0.1 (9)
0.1 (6)
0.1(12)
0.1 (5)
0.2(12)
0.1 (5)

a

Entries for the posterior regrets have been truncated to the closest first digit after the decimal point, and
entries for the percentage regrets have been truncated to the closest integer.

53

0

Table 3.6. Posterior regrets based on QR-SEL(θ, QR(θ L )) for six plug-in estimators, and with the
posterior expected loss of the optimal estimator in the first column. Results are presented for three different
levels of variability, and for four spatial scenarios: an isolated cluster (SC1), a set of isolated clusters and
isolated areas (SC2), highly structured spatial heterogeneity (SC3), and a risk surface generated by a
hidden covariate (SC4). Entries, averaged over 100 replicate data sets in each condition, are scaled by
a factor of 103 with posterior regrets expressed as percentage of the posterior loss under the optimal
estimator in parentheses.
Scenarios
QR-SEL
SF = 0.1 Low Variab.
BYM-SC1
3
BYM-SC2
3
BYM-SC3
11
BYM-SC4
6
L1-SC1
4
L1-SC2
3
L1-SC3
17
L1-SC4
9
SF = 0.1 Med. Variab.
BYM-SC1
7
BYM-SC2
18
BYM-SC3
18
BYM-SC4
13
L1-SC1
5
L1-SC2
13
L1-SC3
16
L1-SC4
16
SF = 0.1 High Variab.
BYM-SC1
9
BYM-SC2
25
BYM-SC3
23
BYM-SC4
17
L1-SC1
12
L1-SC2
27
L1-SC3
30
L1-SC4
16
SF = 2 Low Variab.
BYM-SC1
0
BYM-SC2
1
BYM-SC3
1
BYM-SC4
1
L1-SC1
0
L1-SC2
1
L1-SC3
1
L1-SC4
1
SF = 2 Med. Variab.
BYM-SC1
0
BYM-SC2
2
BYM-SC3
4
BYM-SC4
2
L1-SC1
0
L1-SC2
2
L1-SC3
4
L1-SC4
2
SF = 2 High Variab.
BYM-SC1
0
BYM-SC2
4
BYM-SC3
6
BYM-SC4
3
L1-SC1
1
L1-SC2
4
L1-SC3
7
L1-SC4
4

MLE
945
992
783
1005
964
1037
1047
1070

SSEL

Posterior regretsa
WRSEL

CB

GR

RoPQ

(28427)
(30596)
(6819)
(15697)
(25898)
(29816)
(6098)
(12516)

7
8
10
17
6
7
25
21

(202)
(253)
(83)
(264)
(175)
(198)
(143)
(243)

5
6
9
14
5
5
20
17

(138)
(196)
(74)
(216)
(129)
(156)
(119)
(201)

0
1
4
1
0
0
2
1

(14)
(23)
(38)
(17)
(11)
(13)
(11)
(10)

0 (9)
0 (4)
0 (1)
0 (3)
0(10)
0(11)
1 (8)
1 (6)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

869 (12769)
957 (5237)
584 (3219)
855 (6678)
988 (18505)
957 (7170)
832 (5207)
894 (5756)

17
51
18
46
13
70
97
58

(254)
(279)
(102)
(361)
(251)
(524)
(605)
(375)

13
44
15
34
11
56
79
46

(187)
(243)
(84)
(265)
(197)
(416)
(493)
(299)

3
2
10
5
1
3
13
4

(42)
(13)
(57)
(42)
(19)
(21)
(83)
(23)

0
1
0
0
0
0
0
1

(1)
(7)
(1)
(2)
(8)
(3)
(3)
(8)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

0
0
0
0
0
1
1
0

(2)
(1)
(1)
(1)
(2)
(2)
(5)
(1)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (1)
0 (0)

564
629
528
736
455
603
748
713

(6583)
(2545)
(2276)
(4381)
(3806)
(2203)
(2533)
(4374)

60
144
26
52
101
220
86
144

(697)
(581)
(111)
(312)
(844)
(802)
(291)
(882)

49
141
30
41
82
221
84
123

(575)
(571)
(128)
(245)
(689)
(808)
(285)
(752)

18(209)
20 (83)
33(144)
2 (9)
17(144)
34(125)
18 (62)
15 (94)

4
3
4
6
4
3
6
5

(1541)
(373)
(313)
(519)
(1135)
(318)
(432)
(446)

3
7
1
2
3
7
2
2

(1158)
(889)
(50)
(180)
(1017)
(872)
(103)
(212)

2
4
0
2
3
6
1
3

(936)
(566)
(32)
(145)
(751)
(722)
(81)
(280)

1(363)
2(303)
1 (50)
0 (20)
1(296)
2(252)
1 (86)
0 (12)

0(52)
0(27)
0 (6)
0(10)
0(24)
0(14)
0(11)
0(20)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

1
4
5
5
2
7
7
4

(176)
(190)
(127)
(244)
(389)
(268)
(161)
(205)

5
23
2
1
5
21
2
2

(1505)
(1005)
(44)
(49)
(1260)
(847)
(47)
(95)

4
19
1
1
4
21
2
2

(1280)
(848)
(23)
(35)
(1096)
(864)
(56)
(95)

3(832)
16(717)
2 (61)
0 (26)
2(613)
13(552)
3 (66)
1 (30)

0(35)
0 (6)
0 (5)
0 (6)
0(51)
0 (5)
0 (6)
0 (5)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

0
19
3
10
1
20
4
9

(118)
(495)
(56)
(284)
(123)
(468)
(65)
(251)

6
34
2
2
6
36
4
1

(1527)
(900)
(32)
(45)
(520)
(834)
(60)
(37)

5
33
2
1
4
36
3
1

(1229)
(871)
(37)
(34)
(368)
(835)
(43)
(32)

4(1063)
29(754)
3 (49)
1 (20)
4(349)
30(700)
3 (50)
1 (36)

0(41)
0 (6)
1(10)
0 (8)
0(10)
0 (6)
1(10)
0 (4)

0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)
0 (0)

a

Entries for both the posterior and percentage regrets have been truncated to the closest integer. For some
entries, percentage regrets are smaller than 1 percentage point.

54

(a) CAR normal

(b) CAR Laplace

2.0

2.0

1.5

1.5

MLE
SSEL
WRSEL
CB
GR

Density

2.5

Density

2.5

1.0

1.0

0.5

0.5

0.0

0.0
0.0

0.5

1.0

1.5

RR estimates

2.0

2.5

0.0

0.5

1.0

1.5

2.0

2.5

RR estimates

Figure 3.7. Histograms of the ensembles of point estimates under SSEL for the schizophrenia prevalence
data set under the CAR Normal and CAR Laplace models in panels (a) and (b), respectively. Smoothed
empirical distributions of the five families of point estimates of interest have been superimposed.

QR-SEL functions. For this family of estimators, the percentage regrets tended to increase as the
SF became larger. This somewhat counter-intuitive result, however, may be explained in terms
of the comparative decrease of the posterior losses based on the optimal estimators for both the
Q-SEL and QR-SEL functions. That is, although the percentage regrets associated with the GR
plug-in estimators at SF = 2.0 was larger than the ones at SF = 0.1, these percentages tended to
correspond to smaller fractions of the corresponding posterior losses.

3.5

Urban Distribution of Schizophrenia Cases

In this section, we consider the use of different plug-in estimators for the estimation of the quantiles
and QR of a parameter ensemble for a real data set, which describes the spatial distribution of
cases of schizophrenia in an urban population. This particular data set was found to be especially
relevant to the problem at hand, as it is characterised by very low expected counts, thereby
inducing a high level of hierarchical shrinkage.

3.5.1

Data Description

We here re-analysed prevalence data on first-onset cases of schizophrenia collected from the Southeast London study area of the Aetiology and Ethnicity in Schizophrenia and Other Psychoses (AESOP) study (Kirkbride et al., 2006). This is a large, population-based, epidemiological case-control
study of first-episode psychoses conducted in Southeast London, Nottingham and Bristol. It was
designed to investigate differential rates of psychoses across different cities and ethnic groups in
the UK, based upon a comprehensive survey of all incident cases of first-episode psychoses. The
data has been shown to be of a very high quality, and the AESOP study is the largest ever study
of first episode psychoses conducted in the UK to date (see Kirkbride et al., 2006, for a detailed
description of AESOP). In the analyses presented here, we solely use a subset of the AESOP data
base, covering prevalence data from the Southeast London study centre only.
All individuals aged 16-64 years living in the study area having had contact with mental health
services for a first episode of any probable psychosis, non-psychotic mania or bipolar disorder
55

(a) MLE

(b) SSEL

(c) WRSEL

(d) CB

(e) GR

2.5

2.0

1.5

1.0

0.5

0.0

Figure 3.8. Maps of point estimates denoting the RRs for schizophrenia in 33 boroughs of Southeast
London. The ensembles of the MLEs, posterior means, WRSEL estimates, CB estimates, and triple-goal
estimates are plotted in panels (a) to (e), respectively.

were selected. Initial inclusion criteria were broad, based upon those used in the WHO 10country study (Jablensky et al., 1992). Ascertainment bias was minimised by incorporating a
wide variety of psychiatric services into the study design. Here, cases were excluded if an address
at first presentation was not obtained. The study took place over 24 months (September 1997August 1999). Subjects who passed the screen underwent the Schedules for Clinical Assessment in
Neuropsychiatry (SCAN); a modified Personal and Psychiatric History Schedule, and a schedule
developed to record sociodemographic data. International Classification of Diseases (10th Edition)
(ICD-10) diagnoses were made by consensus agreement from a panel of clinicians. All cases of
broadly defined schizophrenia, corresponding to ICD-10 F20 to F29 diagnoses were included. Full
details of the methodology used in this study have been provided by Kirkbride et al. (2006).

3.5.2

Models Used and Performance Evaluation

The expected counts in this data set ranged from 2.68 to 6.86 with a mean of 4.48 and a standard
deviation of 0.91. The observed counts ranged from 0 to 17 with a mean of 4.48 and a standard
deviation of 3.43. For three areas, the observed counts were null. We fitted the data with the
spatial CAR Normal and Laplace models described in section 3.4.3, using the same specification
for the hyperparameters as in the spatial simulation study. The BYM model considered here
constituted one of the five different models utilised in the original analysis of this data set by
Kirkbride et al. (2007). As before, the models were fitted using WinBUGS 1.4 (Lunn et al.,
2000). Our results are based on 50,000 MCMC samples collected after discarding 10,000 burn-in
realisations from the joint posterior. The φi ’s used in the computation of the WRSEL plug-in
estimators were here specified using a1 = a2 = 0.5, as previously done for the spatially structured
simulations.
We compared the values taken by the different plug-in estimators by expressing them as departure from the value of the optimal estimator. Our strategy, here, is similar in spirit to the one used
when computing the posterior regrets in equation (2.74), except that we were more specifically
interested in evaluating the direction of the departure from the optimal estimate. Thus, for every
loss function of interest L0 , we computed
0

Qp (θ̂ L ) − E[Qp (θ)|y],

(3.43)

separately for five different empirical quantiles, taking p ∈ {.05, .25, .50, .75, .95}. In addition, we
derived the departure of the empirical QR plug-in estimators from the posterior mean empirical
QR. Thus, we calculated
0
(3.44)
QR(θ̂ L ) − E[QR(θ)|y],
for the five ensembles of point estimates under scrutiny. The RoPQ was also derived for this data
set and compared to the posterior mean empirical QR in a similar fashion.

56

3.5.3

Results

In figure 3.7 on page 55, the ensemble distributions of the different families of point estimates have
been plotted. In this figure, the histograms represent the ensembles of the posterior means under
the CAR Normal and CAR Laplace models. The empirical distributions of other ensembles of
point estimates have been superimposed as densities. As expected, the empirical distribution of
the MLEs was found to be more dispersed than the ensemble distributions of the four other sets
of point estimates. In particular, the ensemble distributions of the SSEL and WRSEL estimators
were similar, and were found to be especially sensitive to hierarchical shrinkage. The ensemble
distributions of the CB and GR point estimates struck a balance between the over-dispersion of the
MLEs and the shrinkage of the SSEL and WRSEL ensembles. Overall, the CB and GR ensemble
distributions behaved similarly, albeit the empirical distribution of the GR point estimates tended
to be smoother. Changes in the modelling assumptions did not modify the behaviour of the
different families of point estimates. As can be observed from panels (a) and (b) of figure 3.7,
the ensemble distributions obtained under the CAR Normal and CAR Laplace priors did not
markedly differ. The maps of the ensembles of point estimates evaluated in this section have also
been reported in figure 3.8 on page 56, for the CAR Normal model.
A summary of the analysis conducted for this data set is provided in table 3.7 on page 58,
where we report several summary statistics for the estimation of five different empirical quantiles
and the empirical QR of the parameter ensembles of interest. As expected, the empirical quantiles
of the MLE point estimates were over-dispersed relative to the optimal estimators under both
modelling assumptions: the MLE plug-in estimates of θ(.05) and θ(.25) were found to be smaller
than the optimal empirical quantiles, whereas the MLE plug-in estimates of θ(.75) and θ(.95) were
found to be larger than the optimal empirical quantiles. By contrast, the ensemble of posterior
means followed exactly the opposite pattern: they were under-dispersed relative to the optimal
estimators due to hierarchical shrinkage. That is, the SSEL-based estimates of θ(.05) and θ(.25)
were larger than the corresponding posterior empirical quantiles and the SSEL-based estimates of
θ(.75) and θ(.95) were smaller than their posterior empirical counterparts. The plug-in empirical
quantiles obtained under the WRSEL, CB and GR functions were more difficult to classify, but
we note that the CB plug-in estimators appeared to perform best overall.
Regarding the posterior QR, table 3.7 shows that the MLE-based plug-in estimator tended
to over-estimate the posterior mean of the empirical QR, whereas most other plug-in estimators
were likely to under-estimate its value. The RoPQ also tended to be smaller than the posterior
mean of the empirical QR. Overall, the ordering of the different plug-in estimators with respect to
their departure from the optimal QR followed the ordering reported in our non-spatial and spatial
simulation studies. The sole exception to this parallel was the CB-based empirical QR, which
was observed to be slightly larger than the posterior mean of the empirical QR. These results
were found to be robust to a change in modelling assumptions, albeit the value of the posterior
mean of the empirical QR was found to be slightly smaller when using the CAR Laplace prior.
Most importantly, however, one can observe that the credible intervals for the posterior empirical
quantiles and the empirical QR were found to be larger under the CAR Laplace model, thereby
suggesting that the estimation of these quantities was noisier for this model than for the CAR
Normal.
In addition, in table 3.8 on page 59, we have reported the posterior regrets for the plug-in
estimators of interest under the Q-SEL and QR-SEL. For the estimation of the empirical quantiles
under Q-SEL, the ordering of the plug-in estimators in terms of percentage regrets reproduced the
one found in the simulation studies. In particular, the choice of the MLEs and WRSEL plug-in
estimators yielded the largest posterior regrets, whereas the triple-goal plug-in empirical quantiles
were found to be quasi-optimal. For this data set, however, the SSEL plug-in empirical quantiles
were found to be almost identical to the ones based on the CB ensemble. Under the QR-SEL
function, the CB plug-in estimator slightly outperformed the triple-goal plug-in estimator when
estimating the QR. This result should be contrasted with our synthetic data simulations, which
indicated that the triple-goal plug-in QR was generally better than the CB estimator in terms of
posterior regret. We note, however, that in the case of the schizophrenia prevalence data set, the

57

58

0.486
0.719
0.932
1.204
1.726
1.744

CAR Laplace
θ(.05)
θ(.25)
θ(.50)
θ(.75)
θ(.95)
QR
(0.21–0.91)
(0.52–0.97)
(0.77–1.10)
(0.98–1.45)
(1.09–2.35)
(1.07–2.49)

(0.22–0.87)
(0.52–0.96)
(0.77–1.10)
(0.99–1.45)
(1.12–2.35)
(1.11–2.50)

−0.48(100)
−0.14 (20)
−0.03 (4)
+0.33 (28)
+0.52 (30)
+0.94 (54)

−0.47(100)
−0.14 (20)
−0.03 (4)
+0.32 (27)
+0.51 (30)
+0.92 (52)

MLE

+0.16
+0.09
+0.01
−0.02
−0.27
−0.29

+0.16
+0.10
+0.02
−0.02
−0.26
−0.31

(35)
(13)
(2)
(2)
(16)
(17)

(35)
(15)
(2)
(1)
(15)
(18)

SSEL

+0.14
+0.08
+0.00
−0.09
−0.37
−0.37

+0.14
+0.10
+0.00
−0.08
−0.34
−0.38

(30)
(12)
(0)
(8)
(22)
(21)

(30)
(14)
(0)
(7)
(20)
(21)

WRSEL

−0.04
−0.01
−0.01
+0.09
+0.01
+0.11

(9)
(2)
(1)
(8)
(1)
(6)

−0.04 (10)
+0.01 (1)
−0.00 (0)
+0.11 (9)
+0.03 (2)
+0.06 (4)

CB

Departures from Posterior Meana

−0.09 (19)
+0.01 (1)
+0.02 (2)
−0.02 (2)
+0.05 (3)
−0.11 (7)

−0.07 (17)
+0.01 (1)
+0.02 (2)
−0.02 (2)
+0.05 (3)
−0.11 (6)

GR

–
–
–
–
–
−0.07

–
–
–
–
–
−0.06

RoPQ

–
–
–
–
–
(4)

–
–
–
–
–
(3)

Entries for the departures from the optimal estimates have been truncated to the closest second digit after the decimal point, while entries
for the percentage departures have been truncated to the closest integer.

a

0.473
0.714
0.932
1.211
1.735
1.761

Estimates (CIs)

CAR Normal
θ(.05)
θ(.25)
θ(.50)
θ(.75)
θ(.95)
QR

Models

Posterior Means

Table 3.7. Means and credible intervals (2.5th and 97.5th percentiles of posterior distributions) of the posterior empirical quantiles and posterior empirical QR
for the schizophrenia prevalence data set. Values of plug-in estimators are expressed as departures from the posterior mean empirical quantiles and the posterior
mean empirical QR, which are reported in the first column, as described in equations (3.43) and (3.44). For each plug-in estimator, the percentage departures
from the value of the optimal estimates –i.e. posterior means– have been reported in parentheses.

0

0

L
Table 3.8. Posterior regrets based on QR-SEL(θ, QR(θ L )), and Q-SEL(p, θ, θ(p)
) with p := {.25, .75},
for the schizophrenia prevalence data set. The posterior expected loss of the optimal estimator is given in
the first column. In parentheses, posterior regrets are expressed as percentage of the posterior loss under
the optimal estimator.

Models
Post. Loss

MLE

SSEL

Posterior regretsa
WRSEL
CB

GR

Q-SEL
CAR Normal
CAR Laplace

0.04
0.04

0.13(342)
0.13(341)

0.01 (24)
0.01 (32)

0.15(392)
0.16(434)

0.01 (25)
0.01 (32)

0.00(1)
0.00(1)

QR-SEL
CAR Normal
CAR Laplace

0.17
0.18

0.86(498)
0.89(492)

0.10 (55)
0.09 (47)

0.42(245)
0.49(273)

0.00 (3)
0.01 (7)

0.01(7)
0.01(8)

RoPQ

– –
– –

0.00(3)
0.00(3)

a

Entries for the posterior regrets have been truncated to the closest second digit after the decimal point.
Entries for the percentage regrets have been truncated to the closest integer.

small size of the parameter ensemble may have detrimentally affected the performance of the triplegoal estimator, which requires large parameter ensembles for a good estimation of the EDF. Since
the data set under scrutiny only had only 33 regions, it may be speculated that this negatively
affected the performance of that particular plug-in estimator. The behaviour of the remaining
QR plug-in estimators appeared to be in agreement with the conclusions of our synthetic data
simulations. In particular, the RoPQ was found to outperform all of its counterparts.
Overall, this re-analysis of Kirkbride et al.’s (2007) schizophrenia prevalence data set has
helped to characterise the heterogeneity of the empirical distribution of the RRs for schizophrenia
in the region of interest. Optimal estimation under the QR-SEL function has yielded a QR of
approximately 1.7, which implies that the areas in the upper quartile of risk exhibit 70% higher
risk for schizophrenia than the areas in the lower quartile of risk. This high level of heterogeneity
in the empirical distribution of the RRs in this region suggests the presence of unmeasured risk
factors which may account for the between-area variability.

3.6

Conclusion

One of the consistent findings of this chapter has been the good performance of the empirical
quantiles and empirical QR based on the ensemble of triple-goal point estimates. The GR plugin estimators behaved well throughout the set of simulations under both spatial and non-spatial
scenarios. This can be explained in terms of the optimality criteria satisfied by the triple-goal
point estimates described in section 2.4.2. The first goal that this ensemble of point estimates is
optimising is the estimation of the EDF of the parameters of interest. Since both the empirical
quantiles and the empirical QR are properties of the EDF, it follows that the ensembles of point
estimates optimising the estimation of the EDF would also be expected to do well when estimating
these empirical properties. These particular findings therefore highlight another potential benefit
of choosing to report the ensemble of triple-goal point estimates when conducting research in
epidemiology and spatial epidemiology. In addition, we have also noted the good performance
of the RoPQ and DoPQ under the QR-SEL and IQR-SEL functions, respectively. These plug-in
estimators were found to consistently outperform all other plug-in estimators in our simulation
studies. It can therefore be concluded that when the posterior quartiles of a parameter ensemble
have been collected, one can readily obtain a robust estimation of the dispersion of that ensemble
by using either the RoPQ or the DoPQ, depending on the nature of the models investigated.
This chapter has also highlighted several limitations associated with the use of the WRSEL
function for the estimation of parameter ensembles in both spatial and non-spatial models.
Through the manipulation of the size of the parameter ensemble in our non-spatial simulations,
we have first observed that the range of the WRSEL weights increased exponentially with the
size of the parameter ensemble. Naturally, this is an aspect of the WRSEL function that would

59

need to be calibrated according to the specificities of the estimation problem under consideration.
Moreover, we have also noted that the WRSEL plug-in estimators performed poorly under the
compound Gamma model. This is due to the fact that we have specified a vector of symmetric
weights on the ranks of the units in the ensemble of interest. Both of these problems can be
addressed by choosing different values of the parameters a1 and a2 controlling the range of the
WRSEL weights, despite the fact that the true empirical distribution of the parameters of interest
was skewed. Asymmetric choices may therefore help to deal with skewed parameter ensembles,
whereas assigning very low values to a1 and a2 would counterbalance the effect of a large n. However, since there does not currently exist an automated way of estimating there parameters from
the properties of the data, these issues ultimately limit the applicability of the WRSEL function
as an automated estimation procedure, since it necessitates a substantial amount of preliminary
tuning.
A second important conclusion of this chapter is the apparent superiority of the CAR Normal
over the CAR Laplace model for the estimation of both the empirical quantiles and the empirical
QR of a parameter ensemble. Our spatial simulation study has shown that the utilisation of the
CAR Laplace model tended to increase the posterior expected loss associated with the optimal
estimators of the ensemble’s quantiles and QR in comparison to the use of the CAR Normal model.
The CAR Laplace also yielded larger posterior regrets when using plug-in estimators. Finally, our
analysis of the schizophrenia prevalence data set showed that the posterior distributions of the
empirical quantiles and empirical QR were less concentrated around their means when using the
CAR Laplace model. In practice, we therefore recommend the use of the CAR Normal model
when the dispersion of the RRs is of special interest. However, one should note that we used
identical specifications for the variance hyperparameters for both the Normal and Laplace CAR
priors, which may have contributed to the comparatively poor performance of the Laplace prior
model. In particular, note that the variance parameter, τu2 , for both the CAR Normal and CAR
Laplace priors was given a Gamma prior, such that
τu2 ∼ Gam(0.5, 0.0005).

(3.45)

However, identical choices of variance parameters in a Laplace and a Normal distributions do not
result in identical amount of variability. While X ∼ N (0, 1) has a variance of 1.0, a Laplace
random variate with distribution L(0, 1) has a variance of 2.0. Thus, a fair comparison of the
CAR Normal and CAR Laplace performances would require the use of comparative hyperprior
distributions on the variance parameter of the ensemble priors, τu2 .
In both the spatially-structured simulations and in the analysis of the schizophrenia prevalence
data set, we have computed the Q-SEL on the scale of the RRs. That is, both the Q-SEL and
the QR-SEL were computed using θ as the parameter of interest. However, one should note that,
since the true empirical distribution of the RRs tends to be skewed, the estimation of low and high
quantiles will not be penalised symmetrically. A possible solution to this problem is to compute
the Q-SEL posterior regret on the logscale. In our notation, this may be formulated with respect
to the following ensemble of plug-in estimators,


L0
L0
L0
d
d
[
log θ := log θ1 , . . . , log θn .
(3.46)
That is, for some loss function L0 , each point estimate could be computed on the basis of the
joint posterior distribution of the RRs on the logscale, i.e. p(log θ|y). It then follows that the
corresponding optimal estimator under the Q-SEL function is the set of posterior empirical pquantiles of the ensemble of the log θi ’s. This gives the following posterior regret,


regret Q-SELp , Q [ L0 (p) ,
(3.47)
log θ

which is defined with respect to Q-SELp (log θ, δ) with p := {.25, .75}. Note that the optimal
estimator, δ = E[Qlog θ (p)|y] will here differ from the optimal estimator of the Q-SEL on the RR

60

scale, which we considered in the rest of this chapter. Thus, the estimation of the Q-SEL function
is not invariant under reparametrisation and such a change of scale produces two different decisiontheoretic problems, which cannot be directly compared. In practice, preference for one approach
over another will be determined by the specific needs of the modeller.
The good performance of the triple-goal plug-in estimators under both the Q-SEL and QRSEL functions indicate that this ensemble of point estimates could be useful in epidemiological
practice. As highlighted in chapter 1, the choice of specific point estimates in epidemiology and
most particularly in spatial epidemiology is made arduous by the wide set of desiderata that such
an ensemble of point estimates should fulfil. Here, we have seen that, in addition to providing
good estimation of the EDF, the ranks and the set of levels of risk; the GR point estimates also
provide a good approximation of the amount of heterogeneity in the ensemble. Therefore, the
triple-goal point estimates constitute a good candidate for both the mapping of area-specific levels
of risks and the reporting of summary statistics about the overall risk heterogeneity in the region
of interest. There are other inferential objectives, however, for which the GR point estimates
are far from optimal. These limitations will be highlighted in the next chapter where we study
different classification loss functions.

61

Chapter 4

Threshold and Rank Classification
Losses
Summary
In this chapter, we study the problem of the classification of a subset of parameters in an ensemble given a particular threshold. This problem can be envisaged
from two different perspectives as either (i) a rank-based classification problem or
(ii) a threshold-based classification problem. In the first case, the total amount of
data points that one wishes to classify is known. We are answering the question:
Which are the parameters situated in the top 10% of the ensemble? By contrast,
in the threshold-based classification, we are only given a particular threshold of
risk, and therefore need to determine both the total number of elements above
the pre-specified threshold, and the identity of these elements. We review some
previous research by Lin et al. (2006), who have investigated this problem from
the ranking perspective. We adopt a similar approach when one is concerned with
threshold-based classification and derive the minimiser in that case. We then evaluate the corresponding optimal estimators of these two families of loss functions
using spatial and non-spatial synthetic data for both weighted and unweighted
classification losses. Of special interest, we find that a decision rule originally
proposed by Richardson et al. (2004), in the context of spatial epidemiology, can
be shown to be equivalent to the specification of a weighted threshold-based classification loss. Overall, our experimental simulations support the use of the set
of posterior means as a plug-in estimator under balanced, but not necessarily under weighted, threshold-based classification. Finally, we illustrate the use of our
decision-theoretic frameworks for a surveillance data set describing prevalence of
MRSA in UK hospitals. The good performance of the SSEL point estimates on
both types of classification paradigms indicate that this may be a good choice of
classifiers in practice when one wishes to deprecate the occurrence of false alarms.

4.1

Introduction

The problem of the optimal classification of a set of data points into several clusters has occupied
statisticians and applied mathematicians for several decades (see Gordon, 1999, for a review). As
is true for all statistical methods, a classification is, above all, a summary of the data at hand.
When clustering, the statistician is searching for an optimal partition of the parameter space
into a –generally, known or pre-specified– number of classes. The essential ingredient underlying
all classifications is the minimisation of some distance function, which generally takes the form
of a similarity or dissimilarity metric (Gordon, 1999). Optimal classification will then result
from a trade-off between the level of similarity of the within-cluster elements and the level of
dissimilarity of the between-cluster elements. In a decision-theoretic framework, such distance
functions naturally arise through the specification of a loss function for the problem at hand.

62

Z
I {θ > Cα } dP[θ|y]

Cα
Figure 4.1. Posterior probability that parameter θ is larger than a given threshold Cα , which is here
P[θ > Cα |y]. In the framework proposed by Richardson et al. (2004), the element in the ensemble
corresponding to parameter θ is considered to be greater than Cα if P[θ > Cα |y] > α, for some α ∈ [0, 1].

The task of computing the optimal partition of the parameter space then becomes a matter of
minimising the chosen loss function.
In spatial epidemiology, the issue of classifying areas according to their levels of risk has been
previously investigated by Richardson et al. (2004). These authors have shown that areas can
be classified according to the joint posterior distribution of the parameter ensemble of interest.
In particular, a taxonomy can be created by selecting a decision rule D(α, Cα ) for that purpose,
where Cα is a particular threshold, above and below which we wish to classify the areas in the
region of interest. The parameter α, in this decision rule, is the cut-off point associated with
Cα , which determines the amount of probability mass necessary for an area to be allocated to
the above-threshold category. Thus, an area i with level of risk denoted by θi will be assigned
above the threshold Cα if P[θi > Cα |y] > α. Richardson et al. (2004) have therefore provided a
general framework for the classification of areas, according to their levels of risk. This research
has attracted a lot of interest in the spatial epidemiological literature, and has been applied to
a wide range of epidemiological settings, including healthcare use in France (Chaix et al., 2005),
disparities in the prevalence of psychotic disorders in London (Kirkbride et al., 2007), as well as
the study of the prevalence of bladder cancer (Lopez-Abente et al., 2006) and breast cancer (Pollan
et al., 2007), in Spain.
Central to the decision framework proposed by Richardson et al. (2004) is the choice of Cα and
α. We have illustrated this general classification problem in figure 4.1 on page 63. From this figure,
it is clear that the choice of the risk threshold Cα , apart from its dependence on α, is otherwise
arbitrary. Therefore, Cα may be chosen on the basis of previous research, and will ultimately
depend on the subjective evaluation of the spatial epidemiologists or applied statisticians working
on that particular classification problem. This decision will generally be informed by previous
epidemiological studies of identical or comparable risk surfaces. The choice of α, however, is
statistically problematic in the sense that its value will directly determine the sensitivity and the
specificity of the classification procedure. In selecting a value for α, one is faced with issues which
are reminiscent of the ones encountered by a statistician of a frequentist persuasion when deciding
which level of significance to adopt.
Moreover, it should be noted that, in order to obtain good discrimination using their classification procedure, Richardson et al. (2004) made use of a value of Cα substantially different from
the desired threshold. (That is, different statistical models were given different decision rules with
different associated Cα .) This is another undesirable consequence of the use of a particular cut-off
point α for optimal classification: it requires the choice of a threshold, which usually differs from
the true threshold of interest. We may, for instance, have a target threshold, which we will denote
by C and a decision rule D(Cα , α) with Cα 6= C. This particular dependence on α justifies our
choice of notation, as we have indexed the threshold Cα in order to emphasise that its value may
vary for different choices of α. Richardson et al. (2004) therefore adopted different decision rules
for different models, depending on the spread of the ensemble distribution estimated by these
different models. They studied the BYM model and the spatial mixture (MIX) model, introduced
by Green and Richardson (2002), and chose DBYM (1.0, 0.8) and DMIX (1.5, 0.05), respectively, as
decision rules for these two models, in order to produce a classification of areas into two clusters:

63

non-elevated and elevated risk areas. In this chapter, we will address the two main quandaries
associated with the classification method proposed by Richardson et al. (2004), which are (i) the
dependence of Cα in D(·, ·) on the choice of α, and (ii) the dependence of the entire decision rule
on the choice of model. It should be noted that these limitations were discussed by Richardson
et al. (2004), who emphasised the difficulties associated with the “calibration” of these decision
rules, when considering different models, and in particular with the use of the MIX model.
Our approach to this classification question in spatial epidemiology will draw extensively from
the work of Lin et al. (2006), who investigated rank-based classification problems in BHMs. Although this perspective on the classification of a subset of elements in an ensemble substantially
differs from the problem at hand, we will see that one can easily introduce similar loss families
in the context of threshold-based classification –that is, classification based on a particular cutoff point expressed on the scale of the parameters of interest, as opposed to Lin et al.’s (2006)
rank-based classification problems, where we are given a proportion (e.g. top 20%) of elements
in the ensemble, which we need to identify. Despite the inherent similarities between rank-based
and threshold-based classifications, we will see that the optimal minimisers of these losses are
substantially different. Moreover, experimentation with simulated data will show that different
plug-in estimators are quasi-optimal under these two decision-theoretic paradigms. One of the
clear advantages of our proposed classification framework is that it does not require any calibration, as the resulting estimates are optimal for a specific choice of threshold C, and thus do not
necessitate any subsequent tuning from the epidemiologist or applied statistician conducting the
classification.
The chapter is organised as follows. In section 4.2, we introduce both the threshold-based and
rank-based classification frameworks, and describe their respective optimal estimators. In section
4.3, we illustrate the use of these techniques with a non-spatial set of synthetic simulations. In
section 4.4, the performance of the plug-in estimators of interest is evaluated within the context
of a spatially structured set of data simulations. In section 4.5, these methods are illustrated with
a real data set describing MRSA prevalence in UK hospitals. Finally, we close the chapter by
discussing the broader implications of these results for epidemiologists and spatial epidemiologists
under the light of Bayesian decision theory, especially with respect to the choice of a particular
set of point estimates for a given set of data.

4.2

Classification Losses

In this section, we present our general decision-theoretic framework for the classification of elements
of a parameter ensemble above or below a given threshold. We also introduce the rank-based
classification framework introduced by Lin et al. (2006). For both types of classification schemes,
we will consider possible plug-in estimators that can be used in the place of the optimal estimators
for these particular loss functions. Some links with the concepts of posterior sensitivity and
specificity will also be described for both families of loss functions.

4.2.1

Threshold Classification Loss

We first describe our proposed family of loss functions, following the same structure advanced
by Lin et al. (2006). Here, we are given a particular cut-off point C. The loss associated with
misclassification either above or below the threshold of interest will be formulated as follows.
Following standard statistical terminology, we will express such misclassifications in terms of false
positives (FPs) and false negatives (FNs). These concepts are formally described as
FP(C, θ, δ) := I {θ ≤ C, δ > C} ,

(4.1)

FN(C, θ, δ) := I {θ > C, δ ≤ C} ,

(4.2)

and

64

which correspond to the occurrence of a false positive misclassification (type I error) and a false
negative misclassification (type II error), respectively. In equation (4.1), our decision –denoted δ–
is above threshold, whereas the true value of the parameter –denoted θ– is below threshold, and
the reverse situation can be observed in equation (4.2).
For the decision problem to be fully specified, we need to choose a loss function based on the
sets of unit-specific FPs and FNs. We here assume that C ∈ R if the parameters of interest are real
numbers, or C ∈ R+ if the parameters of interest are strictly positive such as when considering
RRs in the context of spatial epidemiology. Following the decision framework introduced by Lin
et al. (2006), we therefore formalise this problem using the threshold classification loss (TCL),
defined as follows. We first introduce the weighted version of the TCL function, and will then
specialise our definition to the case of unweighted threshold classification. Let 0 ≤ p ≤ 1. The
p-weighted threshold classification loss (TCLp ) function is then defined as
n

TCLp (C, θ, δ) :=

1X
p FP(C, θi , δi ) + (1 − p) FN(C, θi , δi ).
n i=1

(4.3)

One of the advantages of the choice of TCLp for quantifying the misclassifications of the elements
of a parameter ensemble is that it is normalised, in the sense that TCLp (C, θ, δ) ∈ [0, 1] for any
choice of C and p. Moreover, TCLp attains zero if the classification of each element is correct and
1.0 if none of the elements are correctly classified. As was previously done for the loss families
described in the preceding chapters, we will drop references to the arguments (C, θ, δ) controlling
TCLp (C, θ, δ), when their specification is obvious from the context. Our main result, in this
section, is the following minimisation.
Proposition 1. For some parameter ensemble θ, and given a real-valued threshold C ∈ R and
p ∈ [0, 1], we have the following optimal estimator under weighted TCL,
TCL
θ(1−p)
= argmin E [TCLp (C, θ, δ)|y] ,

(4.4)

δ

TCL
where θ(1−p)
is the vector of posterior (1 − p)-quantiles defined as


	
TCL
θ(1−p)
:= Qθ1 |y (1 − p), . . . , Qθn |y (1 − p) ,

(4.5)

where Qθi |y (1 − p) denotes the posterior (1 − p)-quantile of the ith element, θi , in the parameter
TCL
ensemble. Moreover, θ(1−p)
is not unique. That is, there exists more than one minimiser in
equation (4.4).
In our notation, we have emphasised the distinction between the posterior empirical quantile
of the ensemble and the individual posterior quantiles, as follows. In chapter 3, the posterior
quantile of the empirical distribution of the θi ’s was denoted E[Qθ (p)|y]. This quantity minimises
the posterior expected Q-SEL function for some given p. By contrast, in this chapter, we are
interested in the posterior quantile of a single θi , which we have denoted by Qθi |y (p) in proposition
1, and which is formally defined as

	
Qθi |y (p) := inf x ∈ Θi : Fθi |y (x) ≥ p ,
(4.6)
where Θi is the domain of θi . The proof of proposition 1 makes use of a strategy similar to the
one reported by Berger (1980), who showed that the posterior median is the optimal estimator
under AVL, as reported in section 2.1.3. We prove the result by exhaustion in three cases. The
full proof is reported in section 4.7, at the end of this chapter. Note that the fact that TCLp is
TCL
TCL
minimised by θ(1−p)
and not θ(p)
is solely a consequence of our choice of definition for the TCL
function. If the weighting of the FPs and FNs had been (1 − p) and p, respectively, then the
optimal minimiser of that function would indeed be a vector of posterior p-quantiles.
We now specialise this result to the unweighted TCL family, which is defined analogously to

65

equation (4.3), as follows,
n

TCL(C, θ, δ) :=

1X
FP(C, θi , δi ) + FN(C, θi , δi ).
n i=1

(4.7)

The minimiser of this loss function can be shown to be trivially equivalent to the minimiser of
TCL0.5 . The following corollary of proposition 1 formalises this relationship between the weighted
and unweighted TCL.
Corollary 1. For some parameter ensemble θ and C ∈ R, we have
θ MED = argmin E [TCL(C, θ, δ)|y] ,

(4.8)

δ

where

	
TCL
= Qθ1 |y (0.5), . . . , Qθn |y (0.5) ,
θ MED := θ(0.5)

(4.9)

is the vector of posterior medians, and this optimal estimator is not unique.
As noted earlier, this corollary immediately follows from proposition 1 by noting that
argmin E[TCL(C, θ, δ)|y] = argmin E[TCL0.5 (C, θ, δ)|y],
δ

(4.10)

δ

for every C. Note that although both the classical AVL loss described in section 2.1.3 and the
unweighted TCL presented here have identical minimisers, the relationship between these two
estimation schemes is not trivial. Indeed, the former is a problem of estimation, whereas the
latter is a problem of classification. However, it can be noted that for both the AVL and the TCL
functions, these estimators are not unique.
Our main focus in this chapter will be on the unweighted TCL, except in section 4.4.3, where we
consider the relationship between the decision rule originally proposed by Richardson et al. (2004)
and the weighted TCL. We also supplement this discussion with a set of simulations evaluating
the performance of plug-in estimators under weighted TCL. The rest of this chapter, however,
will focus on the unweighted TCL, and except otherwise specified, the TCL function will therefore
refer to the unweighted version presented in equation (4.7).
A graphical interpretation of the posterior TCL is illustrated in figure 4.2 on page 67. The
posterior expected loss under this function takes the following form,
n

1X
E [TCL(C, θ, δ)|y] =
n i=1

ZC

−∞

+∞
Z
dP[θi |y]I {δi > C} +
dP[θi |y]I {δi ≤ C} ,

(4.11)

C

whose formulae is derived using I {θ ≤ C, δ > C} = I {θ ≤ C} I {δ > C}. It is of special importance to note that when using the posterior TCL, any classification –correct or incorrect– will incur
a penalty. The size of that penalty, however, varies substantially depending on whether or not
the classification is correct. A true positive, as in diagram (a) in figure 4.2, can be distinguished
from a false positive, as in diagram (c), by the fact that the former will only incur a small penalty
proportional to the posterior probability of the parameter to be below the chosen cut-off point C.
By contrast, a false positive, as in panel (c), will necessarily incur a larger penalty, because more
mass is located below the threshold than above the threshold. We can make similar observations
when comparing diagrams (b) and (d). In addition, note that although the TCL attains zero when
the classification of each element in the ensemble is correct, this it not the case for the posterior
expected TCL, which is necessarily greater than zero. Moreover, this representation also clarifies
the arguments used in the proof of proposition 1, and provides an intuitive justification for the
use of the median as an optimal estimator under unweighted TCL.

66

(a)
ZC
I {δi > C}

dP[θi |y]

−∞

C

δi
(b)
+∞
Z
dP[θi |y]
I {δi ≤ C}
C

δi

C

(c)
ZC
I {δi > C}

dP[θi |y]

−∞

C δi
(d)
+∞
Z
I {δi ≤ C}
dP[θi |y]
C

δi C
Figure 4.2. Illustration of the components of the posterior expected TCL based on the posterior distribution of θi . The choice of a point estimate δi for the quantity θi results in either a correct classification
(a-b) or a misclassification (c-d), with (a) and (c) representing E[FP(C, θi , δi )|y] and (b) and (d) denoting
E[FN(C, θi , δi )|y].

67

4.2.2

Rank Classification Loss

We here briefly present a different family of classification loss functions based on ranks, which was
originally introduced by Lin et al. (2006). In this chapter, we will be interested in evaluating the
performance of various plug-in estimators for rank-based classification.
Lin et al. (2006) were concerned with the identification of the elements of a parameter ensemble
that represent the proportion of elements with the highest level of risk. In an epidemiological
setting, one may, for instance, wish to estimate the ten percent of hospitals that have the highest
RRs for a particular condition. Such a classification is therefore based on a particular rank
percentile cut-off denoted γ ∈ [0, 1], which determines a group of areas of high-risk. That is, we
wish to identify the areas whose percentile rank is above the cut-off point γ. Specific false positive
and false negative functions dependent on the percentile ranks of the parameter ensemble can be
defined following the convention introduced in equations (4.1) and (4.2). This gives
FP(γ, P, δ) := I {P ≤ γ, δ > γ} ,

(4.12)

FN(γ, P, δ) := I {P > γ, δ ≤ γ} ,

(4.13)

and
where the percentile rank, P , is a function of the ranks of θ, as formally defined in equation
2.41. In this chapter, the word percentile will refer to rank percentile, except specified otherwise.
Note that we have not made an explicit notational distinction between threshold-based FP and
FN functions and their equivalent in a percentile rank-based setting. However, which one we are
referring to should be obvious from the context. Of particular interest to our development and
related to these families of loss functions is the following unweighted rank classification loss (RCL)
function,
n
1X
FP(γ, Pi (θ), δi ) + FN(γ, Pi (θ), δi ),
(4.14)
RCL(γ, θ, δ) :=
n i=1
which is the rank-based analog of the unweighted TCL described in equation (4.7). Lin et al.
(2006) showed that the RCL function is minimised by the following estimator. We report this
result here and refer the reader to the original paper for a proof.
b =
Proposition 2 (Lin et al., 2006). For any 0 ≤ γ ≤ 1, the set of percentile ranks P
b
b
{P1 , . . . , Pn }, whose elements are defined as
Pbi :=



1
Ri P[P1 (θ) ≥ γ|y], . . . , P[Pn (θ) ≥ γ|y] ,
(n + 1)

(4.15)

satisfies
b = argmin E [RCL(γ, θ, δ)|y] .
P

(4.16)

δ

b is not unique.
Moreover, the minimiser P
b one can also derive the optimal rank R.
b In order
Associated with the optimal classifier P,
to gain a greater understanding of the mechanisms underlying the computation of this optimal
minimiser, one can expand the formulae in equation (4.15), using the definition of rank in equation
(2.40) on page 21, in order to obtain the following,
n

Pbi =

o
X n
1
I P [Pi (θ) ≥ γ|y] ≥ P [Pj (θ) ≥ γ|y] ,
(n + 1) j=1

(4.17)

for every i = 1, . . . , n. It can be seen from this expansion that the percentiles, which will optimally
classify the areas above a certain threshold, are the percentiles of the posterior probabilities of the
true percentiles being above the γ cut-off. We have already encountered this method of double
ranking when introducing the triple-goal estimator of Shen and Louis (1998). Proposition 2 also
68

states that the minimiser Pbi is not unique. This follows from the fact that the percentile ranks
on each side of γ form two subsets and the elements in these subsets can be permuted while
maintaining the optimality of the resulting percentile ranks. This non-uniqueness is especially
b
illustrated by the asymptotic equivalence between the minimiser P(γ|y)
and another popular
classifier in the literature: the Normand’s estimator (see Normand et al., 1997).
Albeit the TCL and RCL functions have a similar structure, they nonetheless differ in two
important ways. Firstly, the RCL can be simplified due to the symmetry between the FPs and
FNs, while no such symmetry can be employed to simplify the formulation of the TCL function.
From equation (4.14), the RCL can be simplified as follows,
n

n

2X
1X
FP(γ, Pi , δi ) + FN(γ, Pi , δi ) =
FP(γ, Pi , δi ),
n i=1
n i=1

(4.18)

where we have used the relation,
n
X

FP(γ, Pi , δi ) =

n
X

i=1

FN(γ, Pi , δi ),

(4.19)

i=1

which follows from the fact that any number of FPs in the context of rank classification is necessarily compensated by an identical number of FNs. By contrast, the equivalent relationship does
not hold for TCL. That is, the quantities
n
X
i=1

FP(C, θi , δi )

and

n
X

FN(C, θi , δi ),

(4.20)

i=1

need not be equal. This follows from the fact that the total number of data points that should be
classified above a particular threshold C is unknown when evaluating the TCL function. However,
this is not the case for the RCL function, where we know a priori the total number of percentiles,
which should be classified above the target percentile of interest, γ. That is, the RCL function is
optimised with respect to a vector δ, whose ‘size’ is a known quantity –where, by size, we mean
the total number of δi ’s above γ. By contrast, for TCL, one cannot derive the number of elements
in the latent categories. Thus, both the allocation vector δ, and the total number of elements
above C are unknown. In this sense, the minimisation procedure for the TCL function is therefore
more arduous than the optimisation of the RCL function.

4.2.3

Posterior Sensitivity and Specificity

Our chosen decision-theoretic framework for classification has the added benefit of being readily
comparable to conventional measures of classification errors widely used in the context of test
theory. For our purpose, we will define the Bayesian sensitivity of a classification estimator δ, also
referred to as the posterior true positive rate (TPR), as follows
Pn
E[TP(C, θi , δi )|y]
Pn
TPR(C, θ, δ) := i=1
,
(4.21)
i=1 P[θi > C|y]
where the expectations are taken with respect to the joint posterior distribution of θ. Similarly,
the Bayesian specificity, or posterior true negative rate (TNR), will be defined as
Pn
E[TN(C, θi , δi )|y]
Pn
TNR(C, θ, δ) := i=1
,
(4.22)
i=1 P[θi ≤ C|y]
where in both definitions, we have used TP(C, θi , δi ) := I {θi > C, δi > C} and TN(C, θi , δi ) :=
I {θi ≤ C, δi ≤ C}. It then follows that we can formulate the relationship between the posterior

69

expected TCL and the Bayesian sensitivity and specificity as
n
n
X
X
1
1
E[TCL(C, θ, δ)|y] = FPR(C, θ, δ)
P[θi ≤ C|y] + FNR(C, θ, δ)
P[θi > C|y].
n
n
i=1
i=1

where FPR(C, θ, δ) := 1 − TNR(C, θ, δ) and FNR(C, θ, δ) := 1 − TPR(C, θ, δ).
In the RCL framework, the definitions of the TPR and TNR in equations (4.21) and (4.22)
can be adapted to the context of percentile rank-based classification in the following manner:
Pn
E[TP(γ, Pi (θ), δi )|y]
Pn
,
(4.23)
TPR(γ, θ, δ) := i=1
i=1 P[Pi (θ) > γ|y]
and analogously for TNR(γ, θ, δ). One can easily derive the relationship between the posterior
RCL and the percentile rank-based definitions of Bayesian sensitivity and specificity. These are
E[RCL(γ, θ, δ)|y] =

n
X
2
FNR(γ, θ, δ)
P[Pi (θ) > γ|y],
n
i=1

(4.24)

where FNR(γ, θ, δ) := 1 − TPR(γ, θ, δ), and equivalently,
E[RCL(γ, θ, δ)|y] =

n
X
2
FPR(γ, θ, δ)
P[Pi (θ) ≤ γ|y],
n
i=1

(4.25)

with FPR(γ, θ, δ) := 1 − TNR(γ, θ, δ), which follows from equation (4.18) on page 69.

4.2.4

Performance Evaluation

The posterior regret will be used to compare the optimal classifiers under the TCL and RCL
0
functions with different plug-in classifiers, denoted h(θ̂ L ), for some loss function of interest L0 .
The posterior regret was introduced in section 2.5. For the unweighted TCL, this quantity takes
the following form,
0

0

regret(TCL, h(θ̂ L )) = E[TCL(C, θ, h(θ̂ L ))|y] − min E[TCL(C, θ, δ)|y],
δ

(4.26)

where here h(·) is simply the identity function returning the original vector of point estimates, and
the optimal estimator under TCL is the vector of posterior medians of the parameter ensemble of
interest. Similarly, the posterior regret under RCL takes the following form,
0

0

regret(RCL, h(θ̂ L )) = E[RCL(γ, θ, P(θ̂ L ))|y] − min E[RCL(γ, θ, δ)|y],
δ

(4.27)

where P(·) is a multivariate percentile rank function returning the vector of percentile rank cor0
responding to the ensemble of point estimates θ̂ L , and the optimal estimator under the RCL
is the minimiser reported in proposition 2. In this chapter, we will be interested in comparing
the optimal estimators under the TCL and RCL functions with different plug-in estimators based
on various ensembles of point estimates including the set of MLEs, the posterior means and the
WRSEL, CB and GR ensembles, as described in chapter 2.
Computationally, the posterior regrets of the TCL and RCL functions for several plug-in estimators can be calculated at a lesser cost by noting that both functions simply require the computation of the vector of penalties for misclassification once. Consider the posterior TCL first. Let
0
us denote the allocation vector for some classification estimator θ̂ L above and below the chosen
threshold C by
n
o
L0
L0
L0
z>
(
θ̂
)
:=
I{
θ̂
>
C},
.
.
.
,
I{
θ̂
>
C}
,
(4.28)
1
n
C

70

and z≤
C , respectively. In addition, we define the following vector of posterior probabilities,
p>
C (θ) := {P[θ1 > C|y], . . . , P[θn > C|y]} ,

(4.29)

with p≤
C being defined similarly for the n-dimensional vector of posterior probabilities of each θi
being below C. Then, the posterior TCL used as a criterion for evaluation in this section can
simply be computed as
E[TCL(C, θ, δ)|y] =

1 D ≤ >E 1 D > ≤E
z ,p
+
z ,p ,
n C C
n C C

(4.30)

where h·, ·i stands for the dot product. It is therefore sufficient to compute the vectors of penalties
≥
L0
–p>
C and pC – once and then apply it to any vector of plug-in classifiers, θ̂ . This formulae has also
the added advantage of providing some insights into the generating process of the threshold-based
loss quantities. Equation (4.30) shows that the posterior TCL is the sum of two dot products,
where the allocations of the elements and posterior probabilities of these elements being above
or below a threshold have been inverted. An equivalent computational formulae can be derived
for the posterior expected RCL. For the percentile rank-based performance, we evaluated the
0
0
0
percentile-based classifiers, denoted P(θ̂ L ) := {P1 (θ̂ L ), . . . , Pn (θ̂ L )}, using the following simplified Bayesian expected loss,
0

E[RCL(γ, θ, P(θ̂ L ))|y] =

2 D > ≤E
2 D ≤ >E
zγ , pγ =
z ,p ,
n
n γ γ

(4.31)

>
which can be derived from an application of equation (4.18), and where we have defined z≤
γ , zγ ,
>
≤
pγ and pγ , following the convention introduced in equations (4.28) and (4.29), respectively.
For all simulated scenarios and replicate data sets in the sequel, when considering the performance of plug-in estimators under TCL, we fixed the threshold C to the following value,
n

C := θ̄ +

2
1X
θi − θ̄
n i=1

!1/2
.

(4.32)

Pn
with θ̄ := n−1 i= θi being the true ensemble mean, and θ denotes the true ensemble distribution.
That is, we evaluated the ability of the target plug-in estimators to determine which elements in
the parameter ensemble should be classified as farther than one standard deviation from the
true empirical mean. For the RCL, we fixed γ = .80 for all scenarios and replicates, which
corresponded to the identification of the top 20% of ensemble’s elements taking the largest values.
These conventions for the TCL and RCL functions were applied to both the non-spatial and spatial
simulation experiments.

4.3

Non-spatial Data Simulations

The full description of the synthetic data sets used in this simulation experiment have been fully
described in chapter 3. We are here concerned with two BHMs: (i) the compound Gaussian and
(ii) compound Gamma models. In the next section, we briefly describe which parameters will be
the object of the classification scheme in each model family and recall the two main factors, which
were manipulated in these simulations.

4.3.1

Parameter Ensembles and Experimental Factors

Our choice of simulation models and the specific values given to the hyperparameters parallel the
first part of the simulation design conducted by Shen and Louis (1998). As in chapter 3, the same
models were used to generate and to fit the data. The parameter ensembles, denoted θ, in both
the compound Gaussian and compound Gamma models were classified according to the threshold

71

Table 4.1. Posterior regrets based on TCL(C, θ, δ), with C = E[θ] + sd[θ], for five plug-in estimators
for the conjugate Gaussian model in equation (2.20) and the conjugate Gamma model in equation (2.21),
and for 3 different levels of RLS, and 3 different values of n, averaged over 100 replicate data sets. The
posterior expected loss of the optimal estimator is given in the first column. Entries are scaled by a factor
of 103 . The posterior regrets expressed as percentage of the posterior loss under the optimal estimator is
indicated in parentheses.
Scenarios
.
RLS = 1
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 20
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 100
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000

TCL

MLE

Posterior regretsa
SSEL
WRSEL

CB

GR

133.6
133.1
133.2
109.7
102.4
99.1

49.9 (37)
49.1 (37)
48.8 (37)
74.0 (67)
72.1 (70)
72.4 (73)

0.0(0)
0.0(0)
0.0(0)
3.5(3)
2.9(3)
2.6(3)

16.6 (12)
69.7 (52)
167.3(126)
35.9 (33)
100.8 (98)
268.0(270)

13.3 (10)
13.2 (10)
13.9 (10)
37.3 (34)
33.7 (33)
29.4 (30)

13.3 (10)
13.8 (10)
14.1 (11)
31.2 (28)
32.1 (31)
33.3 (34)

127.9
131.4
128.5
102.9
100.4
93.9

61.3 (48)
59.5 (45)
59.5 (46)
68.2 (66)
67.7 (67)
69.0 (73)

0.0(0)
0.0(0)
0.0(0)
2.3(2)
2.5(3)
2.2(2)

15.0 (12)
63.4 (48)
173.0(135)
28.6 (28)
94.6 (94)
276.2(294)

15.2 (12)
14.3 (11)
14.1 (11)
30.1 (29)
28.1 (28)
25.0 (27)

17.2 (13)
18.8 (14)
18.7 (15)
30.1 (29)
31.5 (31)
31.8 (34)

122.8
123.3
123.4
99.2
93.5
93.2

70.5 (57)
68.4 (56)
70.6 (57)
62.8 (63)
64.4 (69)
63.3 (68)

0.0(0)
0.0(0)
0.0(0)
2.5(3)
1.9(2)
2.0(2)

12.6 (10)
53.6 (43)
174.1(141)
24.1 (24)
78.8 (84)
314.9(338)

14.9 (12)
15.2 (12)
14.6 (12)
25.4 (26)
23.5 (25)
21.7 (23)

23.4 (19)
23.3 (19)
24.3 (20)
29.9 (30)
30.9 (33)
32.1 (34)

a

Entries for the posterior regrets have been truncated to the closest first digit after the decimal point,
and entries for the percentage regrets have been truncated to the closest integer. For some entries,
percentage regrets are smaller than 1 percentage point.

described in equation (4.32). This choice of classification threshold resulted in approximately 16%
and 10% of the ensemble distribution being above C for the Normal-Normal and Gamma-Inverse
Gamma models, respectively. This choice of C therefore produced a proportion of above-threshold
ensemble elements of the same order of magnitude as the one used for the evaluation of the posterior
expected RCL, which was γ = .80. As in chapter 3, we manipulated the ratio of the largest to the
smallest (RLS) sampling variances in both models. In addition, we also considered the effect of an
increase of the size of the parameter ensemble on the posterior expected TCL and RCL functions.
The plug-in estimators of interest were the classifiers constructed on the basis of the ensemble of
MLEs, posterior means, as well as the WRSEL, CB and GR plug-in classifiers.

4.3.2

Plug-in Estimators under TCL

The results of these simulations for the TCL function are summarised in table 4.1 on page 72. As
in chapter 3, we have reported these results in terms of both absolute and percentage posterior
regrets. The percentage regret expresses the posterior regret of a particular plug-in estimator as
a proportion of the posterior expected TCL under the optimal estimator, θ MED .
Overall, the ensemble of posterior means exhibited the best performance over all simulation
scenarios considered. The SSEL plug-in classifiers was found to be substantially better than all the
other plug-in estimators in terms of posterior regrets. Moreover, since the set of optimal classifiers
under the TCL function is the ensemble of posterior medians, the performance of the ensemble
of posterior means was found to be no different from the one of the optimal classifiers under the
compound Gaussian model. The performance of the SSEL plug-in estimators also approached
optimality under the compound Gamma BHM, with its percentage posterior regret not exceeding
3%. Of the remaining four plug-in classifiers, the CB and GR ensembles of point estimates
performed best. The performance of these two ensembles of point estimates was approximately
72

Table 4.2. Posterior regrets based on RCL(γ, θ, δ), with γ := .80, for five plug-in estimators, for the
conjugate Gaussian model in equation (2.20) and the conjugate Gamma model in equation (2.21), and for
3 different levels of RLS, and 3 different values of n, averaged over 100 replicate data sets. The posterior
expected loss of the optimal estimator is given in the first column. Entries are scaled by a factor of 103 .
The posterior regrets expressed as percentage of the posterior loss under the optimal estimator is indicated
in parentheses.

RCL

MLE

Posterior regretsa
SSEL
WRSEL

173.01
172.53
172.19
221.72
221.60
221.21

0.09
0.10
0.08
0.11
0.11
0.12

(0)
(0)
(0)
(0)
(0)
(0)

0.03
0.04
0.03
0.06
0.05
0.06

(0)
(0)
(0)
(0)
(0)
(0)

0.06
0.15
1.41
0.11
0.16
0.89

(0)
(0)
(1)
(0)
(0)
(0)

0.03
0.04
0.03
0.06
0.05
0.06

(0)
(0)
(0)
(0)
(0)
(0)

0.05
0.04
0.04
0.04
0.04
0.05

(0)
(0)
(0)
(0)
(0)
(0)

169.13
172.33
169.80
216.42
215.70
215.53

9.64
9.07
8.91
2.60
2.03
2.08

(6)
(5)
(5)
(1)
(1)
(1)

0.91
0.76
0.79
0.08
0.06
0.05

(1)
(0)
(0)
(0)
(0)
(0)

0.18
0.77
9.88
0.15
0.26
2.04

(0)
(0)
(6)
(0)
(0)
(1)

0.91
0.76
0.79
0.08
0.06
0.05

(1)
(0)
(0)
(0)
(0)
(0)

2.10
2.05
2.04
0.20
0.22
0.22

(1)
(1)
(1)
(0)
(0)
(0)

20.68(12)
19.83(12)
19.53(12)
4.07 (2)
3.39 (2)
3.08 (1)

1.95
1.93
2.20
0.08
0.11
0.11

(1)
(1)
(1)
(0)
(0)
(0)

0.39 (0)
1.77 (1)
16.47(10)
0.22 (0)
0.68 (0)
6.81 (3)

1.95
1.93
2.20
0.08
0.11
0.11

(1)
(1)
(1)
(0)
(0)
(0)

4.24
3.96
4.76
0.58
0.71
0.69

(3)
(2)
(3)
(0)
(0)
(0)

Scenarios
.
RLS = 1
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 20
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 100
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000

169.24
167.74
167.94
209.71
212.23
210.66

CB

GR

a

Entries for the posterior regrets have been truncated to the closest second digit after the decimal point,
and entries for the percentage regrets have been truncated to the closest integer. For some entries,
percentage regrets are smaller than 1 percentage point.

equivalent over the range of scenarios studied. However, some differences are nonetheless notable.
The CB plug-in classifiers tended to exhibit a better performance than the triple-goal classifiers
under the compound Gaussian model. This superiority of the CB plug-in estimator over the GR
one was accentuated by an increase in RLS. This trend was also true under the compound Gamma
model, for which the CB plug-in classifiers modestly outperformed the triple-goal estimator.
The WRSEL and MLE plug-in classifiers exhibited the worst performance. Although the
WRSEL plug-in classifier tended to outperform the MLE-based one for small parameter ensembles,
the posterior regret of the WRSEL rapidly increased with n. The poor performance of the WRSEL
plug-in estimator can here be explained using the same arguments that we have discussed in
section 3.3.5 on page 38. The effect of the vector of weights in the WRSEL function is indeed
highly sensitive to the size of the parameter ensemble, as was described in equation (3.27) and can
be observed from figure 3.1. In addition, increasing the size of the parameter ensemble resulted in
a modest reduction of the posterior expected TCL under the optimal estimator for the compound
Gamma model, but not for the compound Gaussian model. Among the plug-in estimators, only
the CB classifier benefited from an increase in n, and this improvement was restricted to the
compound Gamma model. For all other plug-in estimators, no systematic effect of the size of the
parameter ensemble could be identified. We now turn to the RCL simulation results, which are
characterised by a different ordering of the plug-in classifiers.

4.3.3

Plug-in Estimators under RCL

Table 4.2 on page 73 documents the performance of the different classifiers under posterior expected
RCL. Overall, all estimators performed well with posterior regrets typically within a few percentage
points of the optimal estimator. The ensemble of posterior means and the CB plug-in classifier
performed slightly better than the other plug-in estimators considered. In fact, these two families
73

of classifiers exhibited identical performances on all the simulation scenarios. (This can be observed
by comparing columns 2 and 8 of table 4.2 on page 73). This is due to the fact that the CB plugin estimator is simply a monotonic function of the posterior means, which preserves the ranking
of this ensemble of point estimates. That is, from equation (2.53) in chapter 2, the CB point
estimates are defined as
θ̂iCB := ω θ̂iSSEL + (1 − ω)θ̄SSEL ,
(4.33)
and therefore it follows that
Ri (θ̂ SSEL ) =

n
n
n
o X
n
o
X
I θ̂iSSEL ≥ θ̂jSSEL =
I θ̂iCB ≥ θ̂jCB = Ri (θ̂ CB ),
j=1

(4.34)

j=1

which accounts for the identical posterior regrets of these two plug-in estimators in table 4.2.
The GR plug-in classifiers exhibited the third best percentage regret performance after the SSEL
and CB estimators. This is somewhat surprising since the ranks of the GR point estimates are
explicitly optimised as part of the triple-goal procedure. However, this optimisation of the ranks
is conditional upon the optimisation of the EDF of the parameter ensemble, and therefore the GR
point estimates are only expected to produce quasi-optimal ranks. The WRSEL plug-in classifier
.
tended to outperform the MLE one, although the latter appeared to do better for RLS = 1.
Manipulation of the RLS experimental factor resulted in a substantial increase of the posterior
regrets for all plug-in estimators under both the compound Gaussian and compound Gamma
models. This increase in posterior regret due to higher RLS was especially severe for the compound
Gaussian model. Under this model, all plug-in estimators performed worse as the RLS increased.
This may be explained in terms of the relationship between the level of the RLS factor and the
ranking of the different elements in a parameter ensemble. That is, the larger the RLS factor,
the greater was the influence of hierarchical shrinkage on the ordering of the ensemble’s elements,
since the θi ’s with larger sampling variance tended to be more shrunk towards the prior mean. It
was difficult to pinpoint the exact effect of changes in the size of the parameter ensemble on the
performance of the various plug-in estimators. As was noted before, the posterior regret associated
with the use of the WRSEL plug-in estimator substantially deteriorated as n increased (see section
3.3.5). However, no systematic trend related to an increase of the size of the parameter ensembles
seemed to emerge for the other plug-in estimators.
In contrast to threshold-based classification, most of the different plug-in estimators under the
RCL function exhibited performance very close to the one of the optimal estimator. In particular,
one can observe that all plug-in classifiers produced a percentage posterior regret of 0 in at least
one of the simulation scenarios. This starkly contrasts with the behaviour of the same ensembles
of point estimates under the TCL function. This set of non-spatial simulations therefore highlights a pressing need for carefully choosing plug-in estimators when considering threshold-based
classification. However, such a choice appears to be somewhat less consequential when considering
rank-based classification.

4.4

Spatial Simulations

We now turn to the set of spatial simulations, which have been conducted in order to evaluate
the performance of the different plug-in classifiers under both the TCL and RCL functions for
spatially structured parameter ensembles. In addition, we also consider the weighted TCL function, as this can be shown to be equivalent to the decision rule proposed by Richardson et al.
(2004). The complete description of these synthetic data sets was provided in section 3.4. In this
section, we solely highlight the specific aspects of the simulations, which are directly relevant to
the classification problem at hand.

74

4.4.1

Parameter Ensembles and Experimental Factors

We investigated four different spatially structured scenarios: SC1, characterised by one isolated
cluster of elevated risk; SC2, composed of a mixture of isolated areas and isolated clusters of
elevated risk; SC3, where the spatial structure of the level of risk was generated by the Matèrn
function; and SC4, where the risk surface was indexed by a hidden covariate. In addition, we varied
the heterogeneity of the risk surface in all of these scenarios by modifying the data generating
process, in order to produce a greater dispersion of the true RRs. We recovered these simulated
levels of risk by using two different models: BYM and the robustified Laplace version of the BYM
model, which is denoted by L1. These two models were fully described in section 3.4. Finally, we
also varied the level of the expected counts in order to asses the sensitivity of the performance
of the classification estimators to modifications in the amount of information available from the
data. All these analyses were conducted within the WinBUGS 1.4 software (Lunn et al., 2000). As
for the non-spatial data simulations, we evaluated the different classifiers using two loss criteria:
the posterior expected TCL and the posterior expected RCL functions. Moreover, we considered
the performance of five different plug-in classifiers based on the MLE, SSEL, WRSEL, CB and
triple-goal ensembles of point estimates. These different plug-in estimators were compared using
the posterior regrets of the TCL and RCL functions with respect to the vector of RRs, denoted θ
in the models of interest. We discuss the performance of the different plug-in classifiers under the
(i) unweighted TCL, (ii) weighted TCL and (iii) RCL functions, in turn. Finally, we evaluate the
consequences of scaling the expected counts on the performance of the various plug-in estimators
of interest.
All the results presented in this section are expressed as posterior expected losses, which are
functions of the joint posterior distribution of the parameter ensemble of interest. Naturally, this is
highly dependent on our choice of model. For completeness, we therefore also compared the optimal
classifiers with respect to the true values of the simulated data. For the BYM model, the use of
the optimal classifier (i.e. the vector of posterior medians) yielded 8.1% of misclassifications, on
average over all simulation scenarios. This misclassifcation rate was slightly higher for the Laplace
model at 8.6%.

4.4.2

Plug-in Estimators under Unweighted TCL

The results of the spatial simulations under the posterior expected TCL function are reported in
tables 4.3 on page 76. As before, the percentage regrets associated with each plug-in estimator is
reported in parentheses. Overall, the SSEL plug-in classifiers were found to be quasi-optimal for
all simulation scenarios. This may be explained by the fact that in both models of interest, the
full conditional distribution of each θi was a symmetric distribution.
The ordering of the remaining plug-in classifiers in terms of percentage regrets varies depending
on the type of spatial scenarios considered. Overall, the CB classifier was found to be the second
best plug-in estimator after the ensemble of posterior means. This was true for all spatial scenarios,
except under SC2, where the triple-goal estimator demonstrated better performance than the CB
classifier, except when considering a high degree of variability in the parameter ensemble. The
MLE-based classifiers behaved poorly throughout the entire set of simulations, and the WRSEL
plug-in classifier was consistently outperformed by its counterparts, except for the SC1 scenario
and under a high level of variability of the ensemble distribution.
Increasing the heterogeneity of the parameter ensemble tended to produce easier classification
problems for the plug-in estimators. This was especially apparent when examining the posterior
TCL under the optimal classifier, in table 4.3, where one can observe that the posterior expected
losses diminish with increased levels of heterogeneity, in all four spatial scenarios. That is, most
plug-in estimators appeared to benefit from an increase of the parameter ensemble’s dispersion.
In terms of relative performance as measured by percentage posterior regret, the areas in the
SC1 scenario were found to be easier to classify for all plug-in classifiers when greater levels of
heterogeneity was considered. Under SC2 and to a much lesser extent under SC3, only the MLE
and CB classifiers appeared to benefit from an increase in the parameter ensemble’s dispersion.

75

Table 4.3. Posterior regrets based on TCL(C, θ, δ) with C := E[θ] + sd[θ] for five plug-in estimators and
with the posterior expected loss of the optimal estimator in the first column. Results are presented for 3
different levels of variability and for 4 spatial scenarios: an isolated cluster (SC1), a set of isolated clusters
and isolated areas (SC2), highly structured spatial heterogeneity (SC3), and spatial structure generated
by a hidden covariate (SC4). Entries were scaled by a factor of 103 , with posterior regrets expressed as
percentage of the posterior loss under the optimal estimator indicated in parentheses.
Scenarios
TCL
Low Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
Med. Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
High Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4

71.6
49.8
67.9
51.4
76.1
52.0
78.2
60.4

MLE

SSEL

110.3 (154)
39.2 (79)
26.8 (39)
33.1 (64)
107.4 (141)
37.8 (73)
20.7 (26)
25.9 (43)

Posterior regretsa
WRSEL

CB

GR

0.1
0.1
0.1
0.1
0.1
0.1
0.2
0.1

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

117.9
151.3
156.2
191.8
115.7
159.9
159.0
197.0

(165)
(304)
(230)
(373)
(152)
(308)
(203)
(326)

12.9(18)
10.6(21)
1.7 (3)
4.4 (9)
14.4(19)
12.7(24)
3.1 (4)
5.5 (9)

20.1(28)
4.0 (8)
2.4 (4)
4.3 (8)
23.1(30)
5.6(11)
3.6 (5)
6.5(11)
7.9(30)
1.8 (4)
1.6 (4)
2.2 (6)
10.5(33)
2.0 (5)
2.1 (4)
2.6 (6)

26.6
44.1
42.6
36.8
31.3
44.1
48.3
40.3

25.2
15.2
10.9
12.7
23.3
13.8
7.9
9.7

(95)
(34)
(25)
(35)
(74)
(31)
(16)
(24)

0.0
0.1
0.1
0.0
0.0
0.1
0.1
0.1

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

78.6
104.9
110.9
178.2
83.8
113.2
119.9
191.3

(296)
(238)
(260)
(484)
(267)
(257)
(248)
(475)

1.1 (4)
4.9(11)
0.8 (2)
1.7 (5)
1.4 (4)
5.3(12)
1.6 (3)
2.4 (6)

2.9
25.5
35.9
27.3
4.1
25.0
40.8
28.7

1.5
3.9
8.6
6.0
1.4
3.7
5.1
4.5

(52)
(15)
(24)
(22)
(34)
(15)
(12)
(16)

0.0
0.0
0.1
0.0
0.0
0.0
0.1
0.0

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

0.7
106.1
107.8
98.7
1.6
107.7
116.7
115.1

(25)
(416)
(300)
(361)
(38)
(430)
(286)
(401)

0.0
1.2
0.6
0.9
0.1
1.0
0.9
1.2

(0)
(5)
(2)
(3)
(1)
(4)
(2)
(4)

0.2 (6)
3.7(15)
1.3 (4)
1.2 (5)
1.0(25)
4.1(16)
1.6 (4)
1.6 (6)

a

Entries for the posterior regrets have been truncated to the closest first digit after the decimal point,
and entries for the percentage regrets have been truncated to the closest integer. For some entries,
percentage regrets are smaller than 1 percentage point.

For SC4, the CB, MLE and to a lesser extent the GR plug-in classifiers appeared to benefit from
higher variability in the parameter ensemble. However, for the plug-in estimators, which failed to
estimate the overall shape of the ensemble distribution, such as the WRSEL classifier, the number
of areas above or below the prescribed threshold was more likely to be erroneous. Hence, we did
not observe any systematic improvement of the performance of the WRSEL classifier when the
parameter ensemble’s dispersion increased.
As was previously noted, the CAR Normal model was found to yield lower posterior losses than
the CAR Laplace model across all the studied spatial scenarios. In chapter 3, we have emphasised
that the simulation of discrete two-category distributions in the SC1 and SC2 scenarios had detrimental consequences on the quantile estimation procedures. We here make a similar caveat for the
assessment of classification estimators. The fact that the simulated ensemble distributions in SC1
and SC2 take a discrete form should be taken into account when evaluating the performance of
the classification procedures under scrutiny in this chapter. In particular, the classifiers, which are
dependent on the entire ensemble distribution will be more heavily penalised. This dependency
was especially detrimental to the GR-based classification because each point estimate in this set of
point estimates is dependent on the full ensemble distribution, as is visible from table 4.3 for SC1
especially. However, this detrimental effect on the performance of the GR classifier was attenuated
by an increase in the variability of the parameter ensemble.

76

Table 4.4. Posterior regrets based on TCL0.8 (C, θ, δ) with C := 1.0 for five plug-in estimators and
with the posterior expected loss of the optimal estimator in the first column. Results are presented for 3
different levels of variability and for 4 spatial scenarios: an isolated cluster (SC1), a set of isolated clusters
and isolated areas (SC2), highly structured spatial heterogeneity (SC3), and spatial structure generated
by a hidden covariate (SC4). Entries are scaled by a factor of 103 , with posterior regrets expressed as
percentage of the posterior loss under the optimal estimator in parentheses.
Scenarios
TCL0.8
Low Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
Med. Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
High Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4

MLE

SSEL

Posterior regretsa
WRSEL

CB

GR

80
52
39
47
84
57
48
53

92(114)
54(103)
39(100)
55(117)
85(101)
46 (80)
36 (75)
44 (83)

58
28
20
24
67
33
27
29

(72)
(53)
(51)
(51)
(80)
(58)
(55)
(56)

48
30
36
44
61
37
38
46

(59)
(58)
(91)
(94)
(72)
(64)
(78)
(88)

60
30
20
28
69
35
27
32

(74)
(58)
(51)
(59)
(82)
(62)
(55)
(61)

79 (98)
55(105)
20 (50)
37 (79)
85(101)
57(100)
27 (56)
42 (79)

68
25
30
34
70
28
37
38

74(109)
24 (99)
26 (86)
35(103)
67 (96)
19 (70)
24 (64)
30 (78)

46
9
14
17
49
11
18
19

(68)
(37)
(48)
(49)
(70)
(41)
(50)
(50)

24 (35)
9 (38)
41(134)
48(139)
26 (38)
11 (42)
38(103)
46(121)

47
10
14
18
50
12
18
21

(69)
(40)
(48)
(54)
(72)
(45)
(50)
(55)

68(101)
38(156)
15 (51)
24 (70)
71(102)
41(148)
21 (56)
28 (74)

52
7
28
26
52
9
32
28

55(106)
5 (66)
24 (85)
23 (90)
53(102)
4 (45)
22 (68)
20 (71)

30
1
15
12
31
2
17
13

(58)
(18)
(51)
(46)
(60)
(24)
(52)
(46)

37 (71)
6 (82)
45(159)
56(217)
36 (69)
6 (67)
42(128)
51(179)

30
1
15
13
31
2
17
14

(58)
(19)
(52)
(49)
(60)
(25)
(52)
(48)

61(117)
17(236)
15 (51)
17 (66)
62(119)
19(224)
18 (56)
20 (70)

a

Entries for both the posterior regrets and percentage regrets have been truncated to the closest
integers.

4.4.3

Plug-in Estimators under Weighted TCL

Here, we consider the performance of various plug-in estimators under a weighted TCL function. This decision-theoretic framework reproduces the decision rule proposed by Richardson
et al. (2004) for CAR models in the context of spatial epidemiology. In the notation adopted by
Richardson et al. (2004), the ith area in an ensemble was classified as having an “increased risk”
when the following condition was verified,
P[θi > C|y] > p.

(4.35)

For the BYM and BYM-L1 models, these parameters were given the following values: p = .80,
and C = 1.0. This particular decision rule can easily be seen to be equivalent to a weighted TCL
based on 1 − p as introduced in equation 4.3, such that
n

TCL0.8 (1.0, θ, δ) :=

1X
0.8 FP(1.0, θi , δi ) + 0.2 FN(1.0, θi , δi ),
n i=1

(4.36)

which implies that Richardson et al. (2004) selected a conservative decision rule, giving a larger
penalty to FPs than to FNs. As a result, the number of potential false alarms is deprecated. This
rule indeed requires that a large amount of probability mass (p = 0.80) is situated above threshold
before declaring an area to have “increased risk” for a given medical condition of interest. Using

77

proposition 1, the posterior expectation of the loss function in equation (4.36) is minimised by
TCL
the ensemble of posterior .20-quantiles, denoted θ(.20)
. We have evaluated the different plugin estimators of interest under this weighted classification loss and reported the results of these
simulations for the CAR Normal and CAR Laplace models in table 4.4 on page 77.
The ordering of the plug-in estimators in terms of percentage regrets reproduced the findings
reported under the weighted TCL. Moreover, the performance of the plug-in classifiers was found
to be approximately consistent across the different spatial scenarios considered. Overall, the SSEL
estimator exhibited the best performance throughout this simulation study. Under the SC1 and
SC2 scenarios, the SSEL classifier was more or less on a par with the CB estimator, especially
for medium to high heterogeneity. This can be observed by considering the first two rows of each
of the three sections of table 4.4 on page 77. However, the WRSEL classifier was found to do
marginally better than the SSEL and CB plug-in estimators under SC2 and for a low level of
variability in the ensemble distribution. Under the SC3 and SC4 scenarios, the SSEL, CB and
GR classifiers exhibited similar behaviour and outperformed their counterparts for all levels of
heterogeneity. This can be observed by comparing the different columns in the third and fourth
rows of each of the three sections of table 4.4. This set of simulations therefore showed that while
the set of posterior means constitute a good plug-in estimator under the unweighted TCL, it also
outperformed its counterparts under a weighted version of the same loss function, when a greater
penalty is given to false positives. In addition, we also conducted some further simulations under
TCL0.2 , which gives a greater penalty to false negatives (results not shown). These simulations
yielded a different ordering of the plug-in classifiers. In that case, the SSEL estimator were found
to be outperformed by some of its counterparts under several spatial scenarios. These findings are
contrasted and discussed in section 4.6.

4.4.4

Plug-in Estimators under RCL

The results of the spatial simulations under the posterior expected RCL are summarised in table
4.5 on page 79. Overall, the SSEL and CB classifiers were found to outperform their counterparts
under all the spatially structured scenarios studied. This corroborates our findings for the nonspatial simulations in section 4.3.3. As indicated in that section, the ranks obtained from these
two classifiers are identical, because of the monotonicity of the CB transformation of the posterior
means. The triple-goal estimator was also found to exhibit good performance, which closely
followed the ones of the SSEL and CB plug-in classifiers. The MLE and WRSEL demonstrated the
worse performance overall, with the use of the MLE classifier yielding lower percentage regret under
the SC3 and SC4 scenarios. By contrast, the WRSEL plug-in estimator outperformed the MLE
classifier on the SC1 and SC2 spatial scenarios, albeit as the variability of the ensemble distribution
increased, the MLE became better than the WRSEL estimator under SC2. This discrepancy in
performance between the MLE and WRSEL classifiers may be explained by the extreme cases
considered under the SC1 and SC2 scenarios, for which the WRSEL plug-in estimator was generally
found to outperform the MLE-based classifier. Indeed, as discussed in chapter 3, the discrete
nature of the true ensemble distributions in both SC1 and SC2 required a very high level of
countershrinkage, which was better achieved by the artificial re-weighting of the WRSEL function
than by the MLE classifiers. Note, however, that for the more standard SC3 and SC4 scenarios,
the MLE plug-in estimator was found to provide better ranks than the WRSEL estimator.
Increasing the amount of heterogeneity present in the ensemble distribution tended to systematically diminish the posterior expected loss under the optimal estimator. As noted in section
4.4.2 when considering the TCL function, greater variability in the ensemble distribution tended
to attenuate the effect of hierarchical shrinkage on rank estimation for all plug-in estimators. The
performance of the SSEL, CB and GR plug-in classifiers was approximately stable under different
levels of heterogeneity. The MLE-based estimator, however, substantially benefited from increasing the dispersion of the parameter ensemble. For the WRSEL classifier, the effect of increasing
the parameter ensemble’s heterogeneity was more difficult to evaluate, and tended to vary with
the spatial scenario considered.
As for all other simulations, the posterior expected RCL when using the optimal estimator was
78

Table 4.5. Posterior regrets based on RCL(γ, θ, δ) with γ = .80, for five plug-in estimators and with the
posterior expected loss of the optimal estimator in the first column. Results are presented for 3 different
levels of variability and for 4 spatial scenarios: an isolated cluster (SC1), a set of isolated clusters and
isolated areas (SC2), highly structured spatial heterogeneity (SC3), and spatial structure generated by
a hidden covariate (SC4). Entries were scaled by a factor of 103 , with posterior regrets expressed as
percentage of the posterior loss under the optimal estimator indicated in parentheses.
Scenarios
RCL
Low Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
Med. Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4
High Variab.
BYM-SC1
BYM-SC2
BYM-SC3
BYM-SC4
L1-SC1
L1-SC2
L1-SC3
L1-SC4

MLE

SSEL

Posterior regretsa
WRSEL

CB

GR

187.82
106.49
86.07
105.46
204.99
120.84
101.70
118.72

26.70
12.03
22.13
16.45
11.55
3.81
10.31
4.79

(14)
(11)
(26)
(16)
(6)
(3)
(10)
(4)

0.36
0.11
0.07
0.05
0.35
0.12
0.11
0.13

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

3.26
9.61
22.44
17.01
2.97
9.68
29.85
18.33

(2)
(9)
(26)
(16)
(1)
(8)
(29)
(15)

0.36
0.11
0.07
0.05
0.35
0.12
0.11
0.13

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

0.66
0.49
0.22
0.36
0.67
0.49
0.42
0.62

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(1)

163.44
35.37
66.60
75.85
169.40
42.21
78.77
83.99

16.05 (10)
2.36 (7)
12.45 (19)
7.33 (10)
5.63 (3)
0.71 (2)
3.64 (5)
2.25 (3)

0.33
0.03
0.03
0.03
0.42
0.05
0.06
0.07

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

5.57
7.75
22.54
21.10
5.88
12.85
32.29
22.24

(3)
(22)
(34)
(28)
(3)
(30)
(41)
(26)

0.33
0.03
0.03
0.03
0.42
0.05
0.06
0.07

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

0.92
0.11
0.19
0.30
1.17
0.15
0.37
0.40

(1)
(0)
(0)
(0)
(1)
(0)
(0)
(0)

152.71
8.88
61.47
57.71
155.96
10.15
70.20
62.13

10.83 (7)
0.51 (6)
8.96 (15)
3.74 (6)
4.01 (3)
0.33 (3)
3.15 (4)
0.91 (1)

0.42
0.05
0.03
0.02
0.39
0.06
0.08
0.03

(0)
(1)
(0)
(0)
(0)
(1)
(0)
(0)

9.59
4.00
21.32
15.73
10.28
5.07
29.69
17.94

(6)
(45)
(35)
(27)
(7)
(50)
(42)
(29)

0.42
0.05
0.03
0.02
0.39
0.06
0.08
0.03

(0)
(1)
(0)
(0)
(0)
(1)
(0)
(0)

1.42
0.11
0.16
0.18
1.70
0.13
0.39
0.23

(1)
(1)
(0)
(0)
(1)
(1)
(1)
(0)

a

Entries for the posterior regrets have been truncated to the closest second digit after the decimal
point, and entries for the percentage regrets have been truncated to the closest integer. For some
entries, percentage regrets are smaller than 1 percentage point.

lower under the CAR Normal model than under the CAR Laplace for all scenarios considered. In
comparison to the TCL function, one can also observe that, as discussed in section 4.3.3, the overall
size of the posterior and percentage regrets under the RCL function was found to be substantially
lower than under the TCL function. This indicated that the choice of a particular plug-in classifier
is more consequential under the TCL decision-theoretic framework than under the RCL function.

4.4.5

Consequences of Scaling the Expected Counts

Tables 4.6 and 4.7 on pages 80 and 81 document the posterior and percentage regrets of the
different plug-in estimators of interest under the TCL and RCL functions, respectively, for two
different scaling of the expected counts with SF ∈ {0.1, 2.0}. Overall, the posterior expected losses
under both the TCL and RCL functions were found to benefit from an increase of the level of
the expected counts. The percentage regrets of the different plug-in classifiers, however, did not
necessarily diminish with an increase in SF.
Under the TCL function, our results showed that the SSEL classifier tended to do better for
higher levels of expected counts. Although the differences in posterior and percentage regrets
tended to be small since the SSEL plug-in estimator is close to optimal under the TCL function,
a systematic trend is nonetheless notable, whereby the SSEL classifier showed consistent improvement for higher expected counts. Similarly, the MLE and CB plug-in classifiers benefited from an
increase in SF. Although this tended to be also true for the triple-goal classifier, its performance in

79

Table 4.6. Posterior regrets based on TCL(C, θ, δ) with C := E[θ] + sd[θ] for five plug-in estimators and
with the posterior expected loss of the optimal estimator in the first column. Results are presented for 3
different levels of variability and for 4 spatial scenarios: an isolated cluster (SC1), a set of isolated clusters
and isolated areas (SC2), highly structured spatial heterogeneity (SC3), and spatial structure generated
by a hidden covariate (SC4); as well as two different scaling (SF) of the expected counts. Entries were
scaled by a factor of 103 with posterior regrets expressed as percentage of the posterior loss under the
optimal estimator indicated in parentheses.
Scenarios
TCL
SF = 0.1 Low Variab.
BYM-SC1
128.3
BYM-SC2
11.0
BYM-SC3
119.4
BYM-SC4
53.9
L1-SC1
109.5
L1-SC2
7.2
L1-SC3
116.0
L1-SC4
45.9
SF = 0.1 Med. Variab.
BYM-SC1
74.8
BYM-SC2
33.5
BYM-SC3
49.2
BYM-SC4
55.4
L1-SC1
48.3
L1-SC2
35.1
L1-SC3
67.3
L1-SC4
58.7
SF = 0.1 High Variab.
BYM-SC1
50.3
BYM-SC2
30.0
BYM-SC3
65.2
BYM-SC4
51.1
L1-SC1
83.5
L1-SC2
29.7
L1-SC3
83.2
L1-SC4
62.1
SF = 2 Low Variab.
BYM-SC1
36.4
BYM-SC2
54.3
BYM-SC3
49.6
BYM-SC4
45.4
L1-SC1
46.5
L1-SC2
56.0
L1-SC3
55.7
L1-SC4
50.0
SF = 2 Med. Variab.
BYM-SC1
4.7
BYM-SC2
48.1
BYM-SC3
30.6
BYM-SC4
28.0
L1-SC1
9.3
L1-SC2
49.4
L1-SC3
34.0
L1-SC4
29.8
SF = 2 High Variab.
BYM-SC1
0.1
BYM-SC2
21.2
BYM-SC3
15.3
BYM-SC4
23.2
L1-SC1
0.3
L1-SC2
21.0
L1-SC3
17.8
L1-SC4
23.8

MLE

SSEL

Posterior regretsa
WRSEL

CB

GR

253.5 (198)
236.6 (2153)
113.5 (95)
204.3 (379)
270.0 (247)
241.1 (3346)
128.7 (111)
218.9 (477)

0.3
0.0
0.4
0.1
0.1
0.0
1.4
0.1

(0)
(0)
(0)
(0)
(0)
(0)
(1)
(0)

92.0
17.8
84.9
88.9
61.8
9.2
42.4
64.6

(72)
(162)
(71)
(165)
(56)
(127)
(37)
(141)

75.5(59)
5.7(52)
4.5 (4)
23.9(44)
80.3(73)
6.7(93)
23.3(20)
20.4(44)

66.4(52)
6.5(59)
6.3 (5)
17.4(32)
61.7(56)
6.2(86)
15.1(13)
23.3(51)

218.5
116.1
64.7
129.7
252.5
116.6
61.2
130.9

(292)
(346)
(131)
(234)
(523)
(332)
(91)
(223)

0.5
0.3
0.3
0.3
0.2
0.2
1.1
0.1

(1)
(1)
(1)
(0)
(0)
(1)
(2)
(0)

80.4
140.9
118.9
125.4
48.8
146.0
84.5
124.7

(108)
(420)
(241)
(226)
(101)
(416)
(125)
(213)

24.0(32)
13.6(41)
2.4 (5)
16.4(30)
25.1(52)
19.4(55)
12.5(19)
19.8(34)

23.4(31)
10.3(31)
6.2(13)
15.8(29)
23.2(48)
13.6(39)
9.0(13)
23.5(40)

110.6
37.0
63.9
62.9
82.0
36.9
61.2
57.2

(220)
(124)
(98)
(123)
(98)
(124)
(74)
(92)

0.1
0.1
0.4
0.2
0.2
0.2
0.6
0.3

(0)
(0)
(1)
(0)
(0)
(1)
(1)
(1)

101.5
163.8
106.5
188.8
132.4
166.1
92.2
161.7

(202)
(547)
(163)
(370)
(159)
(560)
(111)
(260)

2.2 (4)
5.4(18)
3.5 (5)
9.2(18)
11.4(14)
6.6(22)
9.8(12)
12.8(21)

17.6(35)
4.1(14)
4.2 (6)
7.4(14)
29.7(36)
5.2(18)
9.9(12)
15.1(24)

66.1 (182)
30.0 (55)
13.3 (27)
12.2 (27)
59.4 (128)
26.4 (47)
9.2 (16)
9.5 (19)

0.0
0.0
0.1
0.0
0.0
0.0
0.0
0.0

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

78.3
130.9
151.8
192.5
86.1
128.1
165.1
201.2

(215)
(241)
(306)
(424)
(185)
(229)
(296)
(402)

2.0 (6)
9.6(18)
0.7 (1)
1.1 (2)
1.8 (4)
9.4(17)
2.0 (4)
1.5 (3)

16.0(44)
3.9 (7)
2.8 (6)
1.7 (4)
19.8(43)
2.4 (4)
3.2 (6)
2.4 (5)

8.8 (186)
11.8 (25)
6.3 (21)
7.4 (26)
6.7 (72)
10.0 (20)
2.8
(8)
5.4 (18)

0.0
0.1
0.0
0.0
0.0
0.0
0.0
0.0

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

2.5
99.8
91.1
109.4
25.0
103.3
96.2
124.2

(53)
(208)
(298)
(391)
(269)
(209)
(283)
(417)

0.0
3.0
0.2
0.4
0.2
4.2
0.5
0.6

(0)
(6)
(1)
(2)
(3)
(8)
(2)
(2)

5.0(105)
2.1 (4)
0.3 (1)
1.7 (6)
4.4(48)
2.2 (5)
0.8 (2)
1.4 (5)

0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

0.0
95.8
16.5
58.1
0.0
100.2
21.3
66.6

(0)
(452)
(108)
(251)
(0)
(478)
(119)
(279)

0.0
0.4
0.2
0.4
0.0
0.4
0.3
0.7

(0)
(2)
(1)
(2)
(0)
(2)
(1)
(3)

0.0 (0)
4.4(21)
3.5(23)
0.8 (4)
0.0 (0)
4.7(22)
3.6(20)
1.0 (4)

0.0
1.1
4.1
2.7
0.0
1.6
1.8
2.1

(0)
(5)
(27)
(12)
(0)
(7)
(10)
(9)

a

Entries for the posterior regrets have been truncated to the closest first digit after the decimal point,
and entries for the percentage regrets have been truncated to the closest integer. For some entries,
percentage regrets are smaller than 1 percentage point.

80

Table 4.7. Posterior regrets based on RCL(γ, θ, δ) with γ = .80, for five plug-in estimators and with the
posterior expected loss of the optimal estimator in the first column. Results are presented for 3 different
levels of variability and for 4 spatial scenarios: an isolated cluster (SC1), a set of isolated clusters and
isolated areas (SC2), highly structured spatial heterogeneity (SC3), and spatial structure generated by a
hidden covariate (SC4); as well as two different scaling (SF) of the expected counts. Entries were scaled
by a factor of 103 with posterior regrets expressed as percentage of the posterior loss under the optimal
estimator indicated in parentheses.
Scenarios
RCL
SF = 0.1 Low Variab.
BYM-SC1
277.38
BYM-SC2
280.36
BYM-SC3
176.56
BYM-SC4
213.14
L1-SC1
288.44
L1-SC2
293.29
L1-SC3
248.41
L1-SC4
266.64
SF = 0.1 Med. Variab.
BYM-SC1
213.78
BYM-SC2
196.60
BYM-SC3
122.31
BYM-SC4
191.33
L1-SC1
280.59
L1-SC2
218.70
L1-SC3
208.18
L1-SC4
230.52
SF = 0.1 High Variab.
BYM-SC1
182.54
BYM-SC2
117.85
BYM-SC3
112.30
BYM-SC4
143.06
L1-SC1
207.60
L1-SC2
135.69
L1-SC3
155.10
L1-SC4
179.98
SF = 2 Low Variab.
BYM-SC1
176.52
BYM-SC2
66.23
BYM-SC3
82.39
BYM-SC4
79.16
L1-SC1
186.73
L1-SC2
73.88
L1-SC3
90.87
L1-SC4
85.05
SF = 2 Med. Variab.
BYM-SC1
168.41
BYM-SC2
26.11
BYM-SC3
46.24
BYM-SC4
54.57
L1-SC1
172.85
L1-SC2
25.80
L1-SC3
52.17
L1-SC4
58.02
SF = 2 High Variab.
BYM-SC1
163.70
BYM-SC2
19.77
BYM-SC3
41.49
BYM-SC4
45.21
L1-SC1
167.87
L1-SC2
19.99
L1-SC3
47.61
L1-SC4
46.52

MLE

SSEL

Posterior regretsa
WRSEL

CB

GR

15.82 (6)
10.29 (4)
64.78 (37)
46.40 (22)
7.11 (2)
2.99 (1)
13.79 (6)
7.98 (3)

1.71
1.21
0.30
0.50
0.84
0.84
0.34
0.44

(1)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

4.32 (2)
3.71 (1)
23.14 (13)
4.11 (2)
3.79 (1)
2.87 (1)
5.96 (2)
2.27 (1)

1.71
1.21
0.30
0.50
0.84
0.84
0.34
0.44

(1)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

1.77
1.43
0.83
0.72
0.92
0.83
0.40
0.54

(1)
(1)
(0)
(0)
(0)
(0)
(0)
(0)

48.11 (23)
18.45 (9)
60.99 (50)
34.96 (18)
4.85 (2)
6.35 (3)
6.12 (3)
6.08 (3)

0.83
0.24
0.13
0.17
0.79
0.24
0.23
0.48

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

4.26 (2)
5.29 (3)
22.57 (18)
4.76 (2)
3.17 (1)
3.53 (2)
3.23 (2)
2.55 (1)

0.83
0.24
0.13
0.17
0.79
0.24
0.23
0.48

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

1.05
0.55
0.30
0.32
0.75
0.45
0.31
0.61

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

44.78
15.45
49.51
34.08
6.85
4.25
23.98
1.97

(25)
(13)
(44)
(24)
(3)
(3)
(15)
(1)

0.47
0.07
0.14
0.09
0.19
0.05
0.19
0.10

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

4.02 (2)
12.03 (10)
15.31 (14)
12.02 (8)
2.61 (1)
7.35 (5)
5.43 (4)
3.94 (2)

0.47
0.07
0.14
0.09
0.19
0.05
0.19
0.10

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

1.04
0.60
0.42
0.40
0.61
0.34
0.75
0.36

(1)
(1)
(0)
(0)
(0)
(0)
(0)
(0)

30.11 (17)
7.20 (11)
13.60 (17)
5.55 (7)
16.80 (9)
2.39 (3)
5.99 (7)
1.00 (1)

0.36
0.01
0.05
0.08
0.76
0.03
0.12
0.04

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

4.98
17.47
21.08
21.89
4.61
21.69
36.52
23.86

(3)
(26)
(26)
(28)
(2)
(29)
(40)
(28)

0.36
0.01
0.05
0.08
0.76
0.03
0.12
0.04

(0)
(0)
(0)
(0)
(0)
(0)
(0)
(0)

1.25
0.12
0.38
0.21
1.14
0.33
0.57
0.31

(1)
(0)
(0)
(0)
(1)
(0)
(1)
(0)

19.20 (11)
2.37 (9)
8.51 (18)
2.33 (4)
7.70 (4)
2.41 (9)
3.37 (6)
0.77 (1)

0.51
0.31
0.01
0.00
0.45
0.08
0.04
0.03

(0)
(1)
(0)
(0)
(0)
(0)
(0)
(0)

7.57
14.22
19.38
14.51
9.23
15.72
23.93
23.41

(4)
(54)
(42)
(27)
(5)
(61)
(46)
(40)

0.51
0.31
0.01
0.00
0.45
0.08
0.04
0.03

(0)
(1)
(0)
(0)
(0)
(0)
(0)
(0)

1.17
0.40
0.01
0.17
1.67
0.36
0.11
0.31

(1)
(2)
(0)
(0)
(1)
(1)
(0)
(1)

9.72 (6)
0.50 (3)
4.46 (11)
2.15 (5)
5.38 (3)
0.50 (2)
1.58 (3)
0.45 (1)

1.17
0.06
0.05
0.00
0.37
0.18
0.07
0.05

(1)
(0)
(0)
(0)
(0)
(1)
(0)
(0)

9.28
15.13
15.40
15.45
8.27
15.29
22.15
17.94

(6)
(77)
(37)
(34)
(5)
(76)
(47)
(39)

1.17
0.06
0.05
0.00
0.37
0.18
0.07
0.05

(1)
(0)
(0)
(0)
(0)
(1)
(0)
(0)

1.91
0.38
0.07
0.00
1.92
0.35
0.38
0.21

(1)
(2)
(0)
(0)
(1)
(2)
(1)
(0)

a

Entries for the posterior regrets have been truncated to the closest second digit after the decimal
point, and entries for the percentage regrets have been truncated to the closest integer. For some
entries, percentage regrets are smaller than 1 percentage point.

81

Table 4.8. Number of hospitals above threshold for the MRSA data set with three different choices of
threshold. The number of hospitals above threshold using the optimal classifier for the TCL function is
reported in the first column. Classifications using plug-in estimators are reported as departures from the
number of hospitals classified above threshold using the vector of posterior medians. For each plug-in
estimator, the percentage departure has been indicated in parentheses.
Thresholds

TCL
C = 1/1.3
C = 1.0
C = 1.3

Number of Hospitals above Thresholda

Optimal
MLE

SSEL

5 (9)
2 (13)
11 (50)

−1(−2)
0 (0)
3 (14)

56
15
22

WRSEL
19 (34)
10 (67)
21 (95)

CB
2 (4)
1 (7)
8 (36)

GR
3 (5)
0 (0)
6 (27)

a

Entries for the percentage departure have been truncated to the closest integer. For some entries,
the percentage departure is smaller than 1 percentage point.

terms of percentage regrets was sometimes worse with larger levels of expected counts. This can
be observed by considering the percentage regrets in parentheses in the eleventh column of table
4.6 on page 80, and comparing the first part of the table for which SF = 0.1 with the second part of
the table for which SF = 2.0. A more confusing picture emerged for the WRSEL classifier. In this
latter case, the type of spatial scenario considered and the level of heterogeneity of the simulated
ensembles both played a substantial role in determining whether the WRSEL plug-in estimator
benefited from an increase in SF. The ordering of the different plug-in estimators, however, was
left unchanged by the use of different levels of expected counts.
A similar trend can be observed for the RCL function in table 4.7 on page 81. Here, changes
in SF did not, in general, modify the ordering of the plug-in estimators reported in section 4.4.4.
The WRSEL classifier, however, was found to be detrimentally affected by an increase of the level
of the expected counts under most spatial scenarios considered. This appeared to be true both in
terms of posterior and percentage regrets. For the remaining plug-in estimators, the differences
in percentage regrets associated an increase in SF was too small to allow the detection of any
systematic trend, except perhaps for the MLE classifier, whose performance notably improved
when specifying larger expected counts, albeit these improvements were restricted to the medium
and high heterogeneity simulations. The different classification procedures considered in this
chapter have also been applied to a real data example, which we describe in the next section.

4.5

MRSA Prevalence in UK NHS Trusts

The prevalence of MRSA in UK hospitals has been under scrutiny for the past 10 years, and
surveillance data on MRSA prevalence has been made publicly available. The classification of
National Health Services (NHS) trusts on the basis of MRSA risk may be of interest to medical
practitioners and patients wishing to minimise their probability to contract the condition. Several statistical issues have been raised and discussed on the basis of this data set, including the
evaluation of hospital performances over time (Spiegelhalter, 2005), and the monitoring of overdispersed MRSA counts (Grigg et al., 2009). In this section, we use this data set to illustrate the
implementation of a decision-theoretic approach to the classification of elements in a parameter
ensemble. Here, the NHS hospitals constitute the parameter ensemble of interest and our main
objective is to identify which hospitals have a level of risk for MRSA above a given threshold.

4.5.1

Data Pre-processing

The full data set was retrieved from the archives of the UK’s Department of Health
(www.dh.gov.UK). This data set documents MRSA prevalence in all NHS trusts in the UK.
Hospitals are classified in three categories: (i) general acute trusts, (ii) specialist trusts and (iii)
single speciality trusts. For each hospital, the data set covers four distinct time periods. In this

82

Table 4.9. Posterior regrets based on TCL(C, θ, δ) and RCL(γ, θ, δ) for the MRSA data set with three
different choices of thresholds in each case. The posterior expected loss of the optimal estimator is given in
the first column. In parentheses, posterior regrets are expressed as percentage of the posterior loss under
the optimal estimator. Entries have been all scaled by a factor of 103 .
Loss functions & Thresholds
Post. Loss

MLE

Posterior regretsa
SSEL
WRSEL

CB

GR

TCL
C = 1/1.3
C = 1.0
C = 1.3

121.69
125.14
65.36

0.80 (1)
0.15 (0)
8.18 (13)

0.13 (0)
0.15 (0)
0.15 (0)

27.93 (23)
14.78 (12)
45.62 (70)

0.16 (0)
0.15 (0)
3.85 (6)

0.33 (0)
0.15 (0)
3.77 (6)

RCL
γ = .60
γ = .75
γ = .90

131.58
105.63
67.65

0.40 (0)
1.43 (1)
4.14 (6)

0.40 (0)
0.63 (1)
1.13 (2)

0.32 (0)
5.48 (5)
0.86 (1)

0.40 (0)
0.63 (1)
1.13 (2)

0.40 (0)
1.55 (1)
1.13 (2)

a

Entries for the posterior regrets have been truncated to the closest second digit after the decimal point,
and the percentage regrets were truncated to the closest integer. For some entries, percentage regrets are
smaller than 1 percentage point.

thesis, we will focus on a subset of this longitudinal data, corresponding to the period running
from April 2003 to March 2004, and consider how to classify NHS trusts according to the number
of cases in that particular year. The Department of Health provided the prevalence of MRSA for
each hospital and the number of bed days over that period. (Bed days are the number of inpatient
hospital days per 1000 members of a health plan.) The NHS trusts with missing data or where no
cases of MRSA was observed were eliminated, due to the impossibility of retrieving the number of
bed days for these hospitals. That is, since the Department of Health only provided yearly numbers of observed cases and the rates of MRSA per bed days, the number of bed days could not be
computed for the hospitals with no observed cases, since the MRSA rates was zero for these trusts.
Data from the following seven hospitals were therefore discarded: Birmingham Women’s Hospital,
Moorfields Eye Hospital, Liverpool Women’s Hospital, Medway Hospital, Royal National Hospital
for Rheumatic Diseases, Sheffield Children’s Hospital, and the Royal Orthopaedic Hospital. The
final sample size was composed of 166 trusts with MRSA prevalence for the year 2003-2004. In
previous statistical publications, this data set has been utilised in order to illustrate the inherent
difficulties associated with the monitoring of changes in levels of risk over several time points.
Here, by contrast, we are mainly concerned with the classification of hospitals according to their
levels of risks, as opposed to a consideration of the evolution of trust-specific risk over several
years.

4.5.2

Fitted Model

We represent observed cases of MRSA by yi for each hospital, with i = 1, . . . , n, and n = 166.
The expected counts for each NHS trust were computed using the MRSA prevalence per thousand
bed days and the number of inpatient bed days in each trust. That is,
Ei := pMRSA × BDi ,
Pn

(4.37)

Pn

where pMRSA := i=1 yi / i=1 BDi is the population MRSA prevalence, and we have assumed
this rate to be constant across all UK hospitals. The BDi ’s denote the number of bed days in the
ith NHS trust in thousands.
A two-level hierarchical model with Poisson likelihood and a lognormal exchangeable prior on
the RRs was used to fit the data. This assumes that the counts are Poisson, but with potential
over-dispersion, due to clustering of cases caused by the infectiousness of the disease or other

83

unmeasured risk factors. The full model had therefore the following structure,
ind

yi ∼ Pois(θi Ei )

i = 1, . . . , n,

log θi = α + vi

(4.38)

iid

vi ∼ N (0, σ 2 ),
where the inverse of the variance parameter was given a ‘diffuse’ gamma distribution, σ −2 ∼
Gam(0.5, 0.0005), while a flat Normal distribution was specified for the intercept, α ∼
N (0.0, 10−6 ). For each hospital, we have RRi := θi . Since the joint posterior distribution of
the θi ’s is not available in closed-form, an MCMC algorithm was used to estimate this model. The
MRSA data was fitted using WinBUGS 1.4 (Lunn et al., 2000). The codes used for the estimation
of the model have been reproduced in Appendix C.
Five different ensembles of point estimates were derived from the joint posterior distribution of
the θi ’s, including the MLEs, the posterior means and medians, and the WRSEL, CB and triplegoal point estimates. Given the size of the parameter ensemble in this data set, the vector of weights
in the WRSEL function was specified using a1 = a2 = 0.1. (The sensitivity of the performance
of the WRSEL plug-in estimators to the choice of a1 and a2 will be discussed in chapter 5). We
considered the performance of these plug-in estimators under the TCL and RCL functions with
three different choices of thresholds in each case. Here, we selected C ∈ {0.77, 1.0, 1.3}, where the
.
first and third thresholds are equidistant from 1.0 on the logarithmic scale –that is, 1/1.3 = 0.77.
For C = 1/1.3, we evaluated the number of hospitals classified below threshold. That is, we were
interested in identifying the NHS trusts characterised by a substantially lower level of risk for
MRSA. A choice of a threshold of 1.3, in this study, implies that hospitals above this threshold
have an MRSA rate, which is 30% higher than the national average. A threshold lower than 1.0
(i.e. C = 1/1.3) was also selected in order to estimate which hospitals can be confidently classified
as having substantially lower MRSA rates than the remaining trusts. Note that in that case, the
definitions of the false positives and false negatives in equations (4.1) and (4.2) become inverted.
That is, for C < 1.0, we now have
FP(C, θ, δ) := I {θ > C, δ ≤ C} ,

(4.39)

FN(C, θ, δ) := I {θ ≤ C, δ > C} .

(4.40)

and
However, since we will solely be interested in unweighted classification loss, in this section, this
inversion does not affect the computation of the posterior and percentage regrets of the plug-in
estimators. The results are presented for the TCL and RCL functions, in turn.

4.5.3

TCL Classification

In table 4.8 on page 82, we have reported the departure of each plug-in classifier from the optimal
TCL estimator in terms of number of NHS hospitals classified above –or below, if C = 1/1.3–
threshold. Remarkably, for the three thresholds (C ∈ {1/1.3, 1.0, 1.3}), almost all plug-in classifiers
were found to yield a greater number of NHS trusts classified above (respectively below) threshold
than when using the set of posterior medians. The sole exception to this trend was for the
SSEL-based classifiers, which were modestly more conservative than the posterior medians under
C = 1/1.3. That is, the ensemble of posterior means produced a smaller set of hospitals considered
to have RRs lower than 1/1.3. This indicates therefore that the optimal TCL classifier generally
tends to produce more conservative classifications than its plug-in counterparts.
Moreover, we also note that, for this particular data set, the GR-based classification was found
to be closer to the optimal classification than the one based on the CB point estimates. These
results should be contrasted with our spatial and non-spatial data simulations, which have shown
that the CB and GR plug-in estimators tended to behave similarly under the TCL function. Not
surprisingly, however, the ensemble of posterior means was found to provide the smallest number
84

(a) MLE

(b) Posterior Means

1.0

1.0
Density

1.5

Density

1.5

0.5

0.5

0.0

0.0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

0.0

0.5

1.0

1.5

2.0

RR estimates

RR estimates

(c) Posterior Medians

(d) WRSEL

1.0

1.0

3.0

3.5

2.5

3.0

3.5

2.5

3.0

3.5

Density

1.5

Density

1.5

2.5

0.5

0.5

0.0

0.0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

0.0

0.5

1.0

1.5

2.0

RR estimates

RR estimates

(e) CB

(f) GR

1.0

1.0
Density

1.5

Density

1.5

0.5

0.5

0.0

0.0
0.0

0.5

1.0

1.5

2.0

RR estimates

2.5

3.0

3.5

0.0

0.5

1.0

1.5

2.0

RR estimates

Figure 4.3. Ensembles of point estimates of MRSA RRs under different loss functions for 166 NHS trusts
during the 2003–2004 period. The panels correspond to the (a) MLEs, (b) posterior means, (c) posterior
medians, (d) point estimates under WRSEL, (e) constrained Bayes point estimates and (f) triple-goal
point estimates. Classification of these point estimates is conducted with respect to a threshold taken to
be C = 1.3 (dashed line). A smoothed version of the histograms has also been superimposed.

85

(a) MLE−based Classification
2.5

Posterior RRs

2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

600

700

800

600

700

800

700

800

Bed Days (1000s)

(b) Posterior Means Classification
2.5

Posterior RRs

2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

Bed Days (1000s)

(c) Posterior Medians Classification
2.5

Posterior RRs

2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

600

Bed Days (1000s)

Figure 4.4. Classification of individual ‘general acute’ NHS trusts (n = 110) during the year 2003–
2004, on the basis of three different families of point estimates: (a) MLEs, (b) posterior means, and (c)
posterior medians. The marginal posterior distributions of trust-specific RRs for MRSA are represented
by box plots (Median, ± sd,±2 sd). In each panel, the trusts classified above threshold, C = 1.3 (dashed
line), are indicated in red.

86

(a) WRSEL Classification
2.5

Posterior RRs

2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

600

700

800

600

700

800

600

700

800

Bed Days (1000s)

(b) CB Classification
2.5

Posterior RRs

2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

Bed Days (1000s)

(c) GR Classification
2.5

Posterior RRs

2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

Bed Days (1000s)

Figure 4.5. Classification of individual ‘general acute’ NHS trusts (n = 110) during the year 2003–
2004, on the basis of three different families of point estimates: (a) WRSEL, (b) CB and (c) triple-goal
estimates. The marginal posterior distributions of trust-specific RRs for MRSA are represented by box
plots (Median, ± sd,±2 sd). In each panel, the trusts classified above threshold, C = 1.3 (dashed line), are
indicated in red. Note the particular poor performance of the WRSEL plug-in classifier in this case.

87

(a) MLE−based Classification
3.5

Posterior RRs

3.0
2.5
2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

600

700

800

900

700

800

900

700

800

900

Bed Days (1000s)

(b) Posterior Means Classification
3.5

Posterior RRs

3.0
2.5
2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

600

Bed Days (1000s)

(c) Posterior Medians Classification
3.5

Posterior RRs

3.0
2.5
2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

600

Bed Days (1000s)

Figure 4.6. Classification of individual ‘specialist’ NHS trusts (n = 43) during the year 2003–2004, on
the basis of three different families of point estimates: (a) MLEs, (b) posterior means, and (c) posterior
medians. The marginal posterior distributions of trust-specific RRs are represented by box plots (Median,
± sd,±2 sd). In each panel, the trusts classified above threshold, C = 1.3 (dashed line), are indicated in
red.

88

(a) WRSEL Classification
3.5

Posterior RRs

3.0
2.5
2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

600

700

800

900

600

700

800

900

600

700

800

900

Bed Days (1000s)

(b) CB Classification
3.5

Posterior RRs

3.0
2.5
2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

Bed Days (1000s)

(c) GR Classification
3.5

Posterior RRs

3.0
2.5
2.0
1.5
1.0
0.5
0.0
0

100

200

300

400

500

Bed Days (1000s)

Figure 4.7. Classification of individual ‘specialist’ NHS trusts (n = 43) during the year 2003–2004, on the
basis of three different families of point estimates: (a) WRSEL, (b) CB and (c) triple-goal estimates. The
marginal posterior distributions of trust-specific RRs are represented by box plots (Median, ± sd,±2 sd).
In each panel, the trusts classified above threshold, C = 1.3 (dashed line), are indicated in red.

89

of misclassified areas in comparison to the optimal classifier. For C = 1.0, one can observe that
both the SSEL and GR plug-in classifiers and the posterior medians yielded an identical number
of NHS trusts above threshold.
In addition, the performance of the different sets of plug-in estimators in terms of posterior
regret is also reported in table 4.9 on page 83 for the TCL and RCL functions. As aforementioned,
one can see that the smallest posterior regret is achieved by the SSEL classifier across all three
thresholds considered. In line with the results of our synthetic simulations, the triple-goal and CB
plug-in estimators were found to exhibit the second best performance. Both of these classifiers
tended to behave similarly under both the TCL and RCL functions. These plug-in estimators were
followed by the MLE and WRSEL classifiers in increasing order of posterior regret. Figure 4.3
on page 85 shows the empirical ensemble distributions of point estimates for the six ensembles of
point estimates that we have considered. In that figure, the RRs for MRSA for each NHS trust are
classified above and below C = 1.3. The pathological behaviour of the WRSEL point estimates
first discussed in section 3.3.5 is here particularly visible in panel (d), where the bimodality of the
WRSEL ensemble of point estimates can be seen to emerge. The classification of NHS trusts using
the six different types of classifiers can also be examined in greater detail in figures 4.4 and 4.5
on pages 86 and 87, which portray the classifications of the general acute NHS trusts. Similarly,
the classification of specialist NHS trusts under these different ensembles of point estimates can
be compared in figures 4.6 and 4.7 on pages 88 and 89, respectively. These box plots provide a
summary of the hospital-specific marginal posterior distributions of the level of risk for MRSA.
Specifically, one can see that for general NHS trusts, the set of hospitals classified above an RR
of 1.3 is lower when we use the set of posterior medians to classify them. This contrasts with
the adoption of the ensemble of MLEs and posterior means or other sets of point estimates for
the same task. A similar pattern is visible for the specialist NHS trusts in figures 4.6 and 4.7,
albeit to a lesser degree, since both the posterior means and posterior medians produce identical
classifications for this particular class of hospitals.

4.5.4

RCL Classification

Results on the use of plug-in estimators under the RCL function, in this data set, are reported in
table 4.9 on page 83. The different plug-in classifiers can here be compared in terms of posterior
and percentage regrets. We have computed the performance of these plug-in estimators using
three different proportions, γ ∈ {.60, .75, .90}. As pointed out in section 4.3.3, the SSEL and
CB classifications under RCL are necessarily identical. In addition, the performance of these
two classifiers was found to be very close to the one of the GR plug-in estimator. These three
plug-in estimators outperformed the MLE and WRSEL classifiers, as expected from our spatial
and non-spatial simulation results. As previously mentioned, it is important to note that the
differences in posterior regrets between different choices of plug-in classifiers were found to be
small in comparison to the differences in posterior regrets between different choices of classifiers
under the TCL function, thereby indicating that the choice of plug-in estimator is more important
under the latter function than when considering rank-based classification.

4.6

Conclusion

In this chapter, we have investigated a standard classification question, which often arises in both
epidemiology and spatial epidemiology. This problem centers on the allocation of a subset of
elements in a parameter ensemble of interest to an elevated-risk cluster according to the estimated
RRs for each of the elements in that ensemble. We have showed that such a problem can be
reformulated in a decision-theoretic framework, where standard machinery can be implemented
to optimise the solution of the problem. Doing so, we showed that the posterior expected TCL
function is minimised by the ensemble of posterior medians. In addition, we have also considered
the RCL function, whose properties and minimiser have already been documented by Lin et al.
(2006).

90

As in chapter 3, our main focus in this chapter has been on evaluating the performance of
various plug-in estimators under both the TCL and RCL functions. Overall, the ensemble of posterior means was found to perform close to optimality under both decision-theoretic paradigms,
thus indicating that this standard choice of point estimates could constitute a good candidate for
routine epidemiological investigations. In particular, the posterior means have the non-negligible
advantage of familiarity, which may aid the reporting of such point estimates in public health
settings. The good performance of the SSEL point estimates under the TCL function can be
explained by noting that, in most applications, the marginal posterior distributions of the parameters of interest will be asymptotically normally distributed. In such cases, as we gather more
information about each parameter in the ensemble, the set of posterior means converges towards
the set of posterior medians.
In section 4.4.3, we noted that the ensemble of SSEL point estimates also performed well
under weighted TCL. In that section, we reported the results of a set of simulations based on
TCL0.8 , which gives a greater penalty to false positives. However, in a separate set of simulations
(results not shown), we also evaluated the performance of the different plug-in estimators under
TCL0.2 , which gives a greater penalty to false negatives. In that case, we have found that the
set of posterior means was outperformed by other plug-in classifiers under several experimental
conditions. These discrepancies between different weighted TCLs can be explained in terms of
hierarchical shrinkage. The posterior means tend to be shrunk towards the prior mean, and will
therefore constitute a naturally conservative choice that is likely to produce less false positives,
but a greater amount of false negatives.
The GR and CB classifiers produced good performance on the TCL and RCL functions, as
measured by the posterior and percentage regrets. These plug-in estimators were followed by
the MLE and WRSEL classifiers. However, the performance differences between the candidate
estimators under the TCL decision-theoretic paradigm were much larger than the differences in
posterior regrets between the plug-in estimators under the RCL function. These discrepancies may
be explained in terms of the substantial differences between these two loss functions. As described
in section 4.2.2 on page 68, the optimisation of the RCL function only requires an adequate ordering
of the elements in the ensemble under scrutiny. For the TCL function, however, minimisation
necessitates not only a good ordering of the elements in the ensemble, but also a reasonably
precise estimation of the values of each of these elements. It appears that the combination of
these two desiderata makes the task of optimising the posterior TCL more difficult than the one
of minimising the RCL one, thereby yielding greater discrepancies between the different candidate
plug-in estimators.
In spatial epidemiology, it is often of interest to consider weighted classification loss functions,
which may, for instance, privilege true positives over false positives, or the converse. This is an
issue, which has been addressed by Richardson et al. (2004), who discussed different re-weighting
of the false positive and false negative rates. They used a numerical minimisation procedure
based on synthetic data sets, which showed that an area should be classified above a threshold
if approximately 80% of the mass of the posterior distribution of the level of risk in that area is
above the threshold of interest (for the BYM and BYM-L1 models). In section 4.4.3, we have
seen that this choice of decision rule is equivalent to the specification of a weighted TCLp with
p = .80. Thus, the decision rule proposed by Richardson et al. (2004) gives a greater penalty
to false positives. This represents a natural choice of classification framework in the context of
spatial epidemiology, which deprecates the number of potential false alarms. The adoption of a
conservative approach to the identification of institutions or geographical areas as characterised
by “elevated risk” is amply justified by the sensitive nature of public health studies and their
extensive media coverage.
In spite of our emphasis on the use of suboptimal classifiers, we also note that our analysis of the
MRSA data set has shown that the use of the set of posterior medians yield the most conservative
classification of the NHS trusts. In an area as sensitive as the level of risk for contracting MRSA,
one may prefer to err on the side of caution by classifying as few hospitals as possible as part
of an elevated-risk cluster. From a public health perspective, Grigg et al. (2009) among others
have argued in favour of the utilisation of conservative communication strategies when reporting
91

surveillance data. When communicating such epidemiological findings to a general audience, the
use of the optimal estimator under the TCL function may therefore be usually preferred in order
to attenuate the potential detrimental effects of too liberal a classification.

92

4.7

Proof of TCL Minimisation

Proof of proposition 1 on page 65.
Let ρp (C, θ, θ est ) denote E[TCLp (C, θ, θ est )|y]. We prove the result by exhaustion over three cases.
In order to prove that
ρp (C, θ, θ (1−p) ) ≤ ρp (C, θ, θ est ),
(4.41)
(1−p)

(1−p)

for any θ est ∈ Θ with θi
:= Qθi |y (1−p), it suffices to show that ρp (C, θi , θi
holds, for every i = 1, . . . , n. Expanding these unit-specific risks,
(1−p)

pI{θi

≤

(1−p)

> C}P [θi ≤ C|y] + (1 − p)I{θi

pI{θiest

> C}P [θi ≤ C|y] + (1 −

) ≤ ρp (C, θi , θiest )

≤ C}P [θi > C|y]

p)I{θiest

≤ C}P [θi > C|y] .

(4.42)

Now, fix C and p ∈ [0, 1] to arbitrary values. Then, for any point estimate θiest , we have
(
pP[θi ≤ C|y],
if θiest > C,
est
(4.43)
ρp (C, θi , θi ) =
(1 − p)P[θi > C|y], if θiest ≤ C.
(1−p)

The optimality of θi
over θiest as a point estimate is therefore directly dependent on the
(1−p)
relationships between θi
and C, and between θiest and C. This determines the following three
cases:
(1−p)

i. If θi

and θiest are on the same side of C, then clearly,
(1−p)

ρp (C, θi , θi
(1−p)

ii. If θi

(1−p)

(1−p)

(4.44)

≤ C and θiest > C, then,
ρp (C, θi , θi

iii. If θi

) = ρp (C, θi , θiest ),

) = (1 − p)P[θi > C|y] ≤ pP[θi ≤ C|y] = ρp (C, θi , θiest ),

(4.45)

> C and θiest ≤ C, then,
(1−p)

ρp (C, θi , θi

) = pP[θi ≤ C|y] < (1 − p)P[θi > C|y] = ρp (C, θi , θiest ),

(4.46)

Equation (4.44) follows directly from an application of the result in (4.42), and cases two and
three follow from consideration of the following relationship:
pP[θi ≤ C|y] R (1 − p)P[θi > C|y],

(4.47)

where R means either <, = or >. Using P[θi > C|y] = 1 − P[θi ≤ C|y], this gives
P[θi ≤ C|y] = Fθi |y (C) R 1 − p.

(4.48)

Here, Fθi |y is the posterior CDF of θi . Therefore, we have
(1−p)

C R Fθ−1
(1 − p) =: Qθi |y (1 − p) :=: θi
i |y

,

(4.49)

where R takes the same value in equations (4.47), (4.48) and (4.49).
This proves the optimality of θ (1−p) . Moreover, since one can construct a vector of point
(1−p)
estimates θiest satisfying θiest R C, whenever θi
R C, for every i, it then follows that θ (1−p) is
not unique.

93

Chapter 5

Discussion
In this final chapter, we review the main findings of the thesis, and explore possible extensions of
this work in several directions. In particular, we consider whether the loss functions used in this
thesis can be generalised in order to take into account more sophisticated inferential requirements.
Moreover, we also discuss how different modelling assumptions may better serve the decisiontheoretic questions addressed in the thesis.

5.1

Main Findings

In the present thesis, we have adopted a formal decision-theoretic approach to two inferential
issues that naturally arise in epidemiology and spatial epidemiology. Firstly, we have considered
how the estimation of the heterogeneity of a parameter ensemble can be optimised. Secondly, we
have derived the optimal estimator for the classification of the elements of a parameter ensemble
above or below a given threshold. For consistency, epidemiologists are generally under pressure to
report a single set of point estimates when presenting their research findings. We have therefore
also explored the utilisation of various plug-in estimators based on more commonly used sets of
point estimates in order to identify the ensembles of point estimates that may simultaneously
satisfy several of these inferential objectives.
Overall, our experimentation and real data analyses have shown that the GR plug-in estimator
is very close to optimality when evaluating the dispersion of a parameter ensemble, as quantified by
the posterior QR. By contrast, the best quasi-optimal plug-in estimator under both the TCL and
RCL functions was found to be the one based on the SSEL point estimates. Taken together, these
results confirm the inherent difficulties associated with attempting to satisfy several inferential
desiderata using a single set of point estimates. Ultimately, the two objectives considered in this
thesis have been found to be optimised by two different sets of point estimates. Nonetheless,
further research could investigate the formulation of nested decision-theoretic procedures in the
spirit of the triple-goal methods introduced by Shen and Louis (1998), which could sub-optimally
satisfy these two goals using a single set of point estimates. Specifically, one could construct a
decision-theoretic framework where the two inferential objectives are weighted, hence allowing
different modellers to express their preference for one goal over another in a formal manner.
Another of the consistent findings in this thesis has been the relatively poor performance of
the WRSEL introduced by Wright et al. (2003). In most of the spatial and non-spatial synthetic
simulations considered, this plug-in estimator tended to perform on a par with the MLE plug-in
estimator. The main objective of the WRSEL function is to counteract the effect of hierarchical
shrinkage in the models studied. Point estimates based on WRSEL have proved to be useful in
improving the estimation of the ‘spread’ of parameter ensembles. However, the WRSEL estimation
procedure was found to lack portability from one data set to another. Specifically, the main
difficulty with this approach resides in the necessary pre-specification of the set of weights that
recalibrate the loss function. We have seen that these φi ’s are determined by both the number of

94

elements in the ensemble and the values taken by two tuning parameters, a1 and a2 , which control
the symmetry and the magnitude of the re-weighting effected by the WRSEL function. A step
towards the automatisation of the use of the WRSEL for any data set may, for instance, include
the specification of both a1 and a2 as functions of the size of the ensemble.
Our work on classification loss was originally motivated by the paper of Richardson et al.
(2004) on the identification of geographical areas with “elevated risk”. Our exploration of various
classification loss functions in chapter 4 has demonstrated that the decision rule proposed by
Richardson et al. (2004) is equivalent to the utilisation of a weighted TCL function based on
p = .80. This particular choice of decision rule can be shown to give a greater penalty to false
positives than to false negatives, thereby safeguarding the public and decision makers against
potential false alarms.

5.2

Generalised Classification Losses

In chapter 4, we have described and used a classification loss function based on the ranking of the
elements in a parameter ensemble. The RCL function was originally introduced by Lin et al. (2006)
under a variety of guises. These authors suggested the use of several generalised RCL functions
that combined penalties for misclassifications with explicit penalties for the distance of the point
estimates from the threshold of interest. Their decision-theoretic framework was developed on
the basis of rank classification but could easily be adapted to the problem of classifying elements
in a parameter ensemble with respect to a threshold on the natural scale of these elements. The
basic principles underlying the TCL function introduced in this thesis, could therefore be extended
following the lead of Lin et al. (2006), in the following three directions. Here, each loss function
takes three parameters, p, q, b ≥ 0,
n

LC (p, q, b) :=

1X
|C − θiest |p FP(C, θi , θiest ) + b|C − θiest |q FN(C, θi , θiest ),
n i=1

L†C (p, q, b) :=

1X
|C − θi |p FP(C, θi , θiest ) + b|C − θi |q FN(C, θi , θiest ),
n i=1

L‡C (p, q, b) :=

1 X est
|θ − θi |p FP(C, θi , θiest ) + b|θest − θi |q FN(C, θi , θiest );
n i=1 i

|·|

n

(5.1)

n

where FP and FN are defined as in equations (4.1) and (4.2), respectively, on page 64. As for the
TCL, none of these families of loss functions produce a penalty if the true parameter θi and the
point estimate θiest are both above or below the cut-off point C. (Note, however, that this is not
true for the expected TCL, where integration over the parameter space will necessarily yield a loss
greater than zero, regardless of the correctness of the classification). If θi and θiest are not on the
|·|
same side of C, LC penalises the estimation procedure by an amount which is proportional to the
est
distance of θi from C; L†C penalises by an amount which is proportional to the distance of θi
from C; and L‡C penalises by an amount which is proportional to the distance between θiest and
θi . The parameters p and q permits to vary the strength of the penalties associated with the false
positives and the false negatives, respectively. Moreover, a final parameter, b, allows to further
adjust these two types of penalties by directly re-weighting their relative importance. Although
L†C and L‡C are of theoretical interest, it should be clear that these particular loss families would
be difficult to implement, in practice, because they rely on the unknown quantities, θi ’s.
The three generalisations of the TCL family in equation (5.1) will require specific optimisation procedures as was demonstrated by Lin et al. (2006), who considered similar generalisations
with respect to rank-based classification. Since the minimisation of the expected TCL and RCL
functions were found to differ substantially, it is not expected that the work of Lin et al. (2006)
on generalised RCLs will necessarily be relevant to the minimisation of the generalised TCLs described in equation (5.1). Further research will therefore be needed to explore these issues and

95

investigate the behaviour of various plug-in estimators under these generalised versions of the TCL
function.

5.3

Modelling Assumptions

Since the choice of a particular loss function only affects the post-processing of the joint posterior
distribution of the parameter ensemble of interest, such methods are only as good as the statistical
model on which they are based. The use of different models may therefore lead to substantial
improvements in either estimating the true heterogeneity of the ensemble or in classifying the
elements of that ensemble. This is a concern, which has already been voiced by several authors.
Shen and Louis (1999), for instance, have noted the dependence of their triple-goal estimator’s
performance on the quality of the ensemble prior distribution specified for the parameters of
interest. It is this type of concern that led these authors to propose the Smoothing by Roughening
(SBR) algorithm in order to produce an Empirical Bayes (EB) prior distribution for the θi ’s
(Shen and Louis, 1999). For spatial models, the critical influence of modelling assumptions on the
validity of the subsequent estimation of the level of heterogeneity in a parameter ensemble has
been highlighted by Lawson (2009) and Ugarte et al. (2009b).
In chapter 2, we have classified the models studied throughout the thesis in three categories
depending on the choice of second-level priors. This included (i) proper conjugate iid priors, (ii)
non-conjugate proper iid priors and (iii) non-conjugate improper non-idd priors on the θi ’s. It may
be of interest to consider non-parametric extensions of these models, such as ones based on the
Dirichlet process prior (MacEachern, 1994, MacEachern and Muller, 1998). The specification of
such priors in BHMs tends to give more flexibility to the model. In our case, this may particularly
help to evaluate the shape of the ensemble distribution with greater accuracy, which could yield
better estimates of the heterogeneity of the ensemble. The combination of a parametric likelihood
function with a non-parametric hierarchical prior is often referred to as a semi-parametric model.
When combined with the Q-SEL or QR-SEL functions, such semi-parametric Bayesian models
may be particularly well-suited to the type of inferential problems encountered in epidemiology,
where the estimation of the properties of the empirical distributions of parameter ensembles is
especially important.
In terms of the classification of the elements of an ensemble, Ugarte et al. (2009a) have compared the performance of a HBM with an EB strategy, and have concluded that the full Bayesian
framework may be preferable for the classification of elements in a parameter ensemble. In addition, a natural modelling approach to this problem may be the use of mixture models. One
of the important limitations of the procedure developed in chapter 4 is that we are imposing
the number of categories and fixing a particular cut-off point. When one is simply interested in
identifying the elements of an ensemble, which are characterised by a level of risk greater than a
certain threshold, this classification procedure could be sufficient. However, if one is interested in
the number of categories per se, a more sophisticated modelling strategy may be adopted, where
inference about the number of categories can be directly conducted. Richardson et al. (2004), for
instance, have considered the use of the reversible-jump MCMC algorithm in conjunction with a
decision-theoretic framework in order to classify the elements of an ensemble (see also Green, 1995,
Richardson and Green, 1997). As explained in the introduction of chapter 4, Richardson et al.
(2004) have calibrated their choice of classification thresholds differently, when utilising different
models. While we have shown that the use of the posterior median is optimal under the posterior
TCL function, it may nonetheless be of interest to investigate how specific modelling outputs, such
as the distribution of the number of mixture components in a semi-parametric mixture models
could be used in the context of classifying the elements of an ensemble in terms of levels of risk.
More specifically, the posterior distribution of the number of mixture components could aid with
the determination of the ideal cut-off value upon which the classification exercise is conducted.

96

Appendix A

Non-Spatial Simulations
In this appendix, we provide some descriptive statistics of the non-spatial simulated data sets used
in chapters 3 and 4.

97

Table A.1. Descriptive statistics for the simulated yi ’s. Presented for the Normal-Normal model
in equation (2.20) and the Gammma-Inverse gamma model in equation (2.21), and for 3 different levels
of RLS (ratio of the largest to the smallest σi ), and 3 different values for n, averaged over 100 synthetic
data sets.
Models & Shrinkage
.
RLS = 1
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 20
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000
.
RLS = 100
N-N, n = 100
N-N, n = 200
N-N, n = 1000
G-IG, n = 100
G-IG, n = 200
G-IG, n = 1000

Descriptive Statistics
2.5th Qua.
Median

97.5th Qua.

Mean

SD

-0.002
0.001
0.004
1.000
0.992
0.997

1.414
1.410
1.419
1.253
1.325
1.396

-2.682
-2.709
-2.766
0.027
0.024
0.020

-0.006
-0.001
0.006
0.588
0.575
0.572

2.641
2.707
2.775
4.252
4.308
4.478

0.014
0.022
0.005
1.408
1.413
1.412

1.569
1.554
1.558
2.099
2.190
2.235

-2.984
-2.998
-3.101
0.001
0.001
0.000

0.016
0.026
0.007
0.673
0.667
0.659

3.014
3.053
3.090
6.688
6.955
7.071

0.023
-0.003
0.006
2.191
2.101
2.130

1.786
1.767
1.773
3.807
3.690
3.749

-3.419
-3.562
-3.609
0.000
0.000
0.000

-0.001
-0.010
0.002
0.733
0.712
0.704

3.647
3.563
3.635
11.791
11.589
11.885

Table A.2. Descriptive statistics for the simulated σi ’s. Presented for the Normal-Normal model
in equation (2.20) and the Gammma-Inverse gamma model in equation (2.21), and for 3 different levels
of RLS (ratio of the largest to the smallest σi ), and 3 different values for n, averaged over 100 synthetic
data sets.
Models & Shrinkage
.
RLS = 1
n = 100
n = 200
n = 1000
.
RLS = 20
n = 100
n = 200
n = 1000
.
RLS = 100
n = 100
n = 200
n = 1000

Descriptive Statistics
Median
2.5th Qua.

97.5th Qua.

Mean

SD

1.000
1.000
1.000

0.006
0.006
0.006

0.991
0.991
0.991

1.000
1.000
1.000

1.009
1.009
1.010

1.398
1.426
1.415

1.135
1.152
1.147

0.246
0.244
0.241

0.993
1.017
1.001

4.027
4.125
4.147

2.158
2.119
2.139

2.503
2.464
2.487

0.117
0.115
0.113

1.022
1.006
0.999

8.627
8.663
8.839

98

Appendix B

Spatial Simulations
In this appendix, we provide some descriptive statistics of the spatial simulated data sets used in
chapters 3 and 4.

99

Table B.1. Descriptive statistics for the Ei ’s used in the synthetic data simulations. These
are here presented with respect to three different values of the scaling factor (SF), controlling the level of
the expected counts. The Ei ’s reported here correspond to the expected counts for lung cancer in West
Sussex adjusted for age only, occurring among males between 1989 and 2003. These data points have been
extracted from the Thames Cancer Registry (TCR).
Scaling Factor

SF = 0.1
SF = 1
SF = 2

Mean

SD

17
170
340

9
88
175

Descriptive Statistics
2.5th Qua.
Median
5
52
105

15
149
298

97.5th Qua.
39
389
778

Table B.2. Descriptive statistics for the Relative Risks (RRs) in the synthetic spatial simulations. Presented under three different levels of variability (low, medium and high), where the parameters
controlling the levels of variability are modified according to the spatial scenario (i.e. SC1, SC2, SC3 and
SC4) considered. Note that while the RRs were simulated from specific statistical models in SC3 and SC4,
they were set to specific values in SC1 and SC2.
Scenarios & Variability
Low Variab.
SC1 (LR = 1.5)
SC2 (LR = 1.5)
SC3 (σ = 0.1)
SC4 (β = 0.2)
Medium Variab.
SC1 (LR = 2)
SC2 (LR = 2)
SC3 (σ = 0.2)
SC4 (β = 0.3)
High Variab.
SC1 (LR = 3)
SC2 (LR = 3)
SC3 (σ = 0.3)
SC4 (β = 0.4)

Descriptive Statistics
2.5th Qua.
Median

97.5th Qua.

Mean

SD

1.018
1.107
1.027
1.025

0.093
0.206
0.283
0.243

1.000
1.000
0.604
0.696

1.000
1.000
0.992
0.971

1.500
1.500
1.622
1.590

1.036
1.215
1.194
1.055

0.187
0.412
0.513
0.367

1.000
1.000
0.535
0.612

1.000
1.000
1.077
0.954

2.000
2.000
2.408
1.938

1.072
1.430
1.193
1.095

0.373
0.824
0.598
0.515

1.000
1.000
0.465
0.531

1.000
1.000
1.049
0.935

3.000
3.000
2.641
2.358

100

Table B.3. Descriptive statistics for the simulated yi ’s. Presented for three choices of the Scaling
Factor (SF) of the expected counts, three different levels of variability (low, medium and high), and four
different spatial scenarios (i.e. SC1, SC2, SC3 and SC4).
Scenarios & Variability
SF = 0.1, Low Variab.
SC1 (LR = 1.5)
SC2 (LR = 1.5)
SC3 (σ = 0.1)
SC4 (β = 0.2)
SF = 0.1, Medium Variab.
SC1 (LR = 2)
SC2 (LR = 2)
SC3 (σ = 0.2)
SC4 (β = 0.3)
SF = 0.1, High Variab.
SC1 (LR = 3)
SC2 (LR = 3)
SC3 (σ = 0.3)
SC4 (β = 0.4)
SF = 1, Low Variab.
SC1 (LR = 1.5)
SC2 (LR = 1.5)
SC3 (σ = 0.1)
SC4 (β = 0.2)
SF = 1, Medium Variab.
SC1 (LR = 2)
SC2 (LR = 2)
SC3 (σ = 0.2)
SC4 (β = 0.3)
SF = 1, High Variab.
SC1 (LR = 3)
SC2 (LR = 3)
SC3 (σ = 0.3)
SC4 (β = 0.4)
SF = 2, Low Variab.
SC1 (LR = 1.5)
SC2 (LR = 1.5)
SC3 (σ = 0.1)
SC4 (β = 0.2)
SF = 2, Medium Variab.
SC1 (LR = 2)
SC2 (LR = 2)
SC3 (σ = 0.2)
SC4 (β = 0.3)
SF = 2, High Variab.
SC1 (LR = 3)
SC2 (LR = 3)
SC3 (σ = 0.3)
SC4 (β = 0.4)

Descriptive Statistics
2.5th Qua.
Median

97.5th Qua.

Mean

SD

4.300
4.312
4.314
4.325

3.061
3.084
3.182
3.291

1.000
1.000
1.000
1.000

3.775
3.825
3.650
3.550

12.144
11.725
12.219
12.463

4.311
4.325
4.331
4.328

3.382
3.458
3.529
3.666

1.000
1.000
1.000
1.000

3.625
3.275
3.300
3.100

12.494
13.350
13.344
13.669

4.304
4.345
4.341
4.355

3.982
4.177
3.649
4.210

1.000
1.000
1.000
1.000

3.050
3.000
3.300
3.050

14.475
15.331
13.619
15.456

42.440
42.440
42.440
42.440

24.587
25.761
25.681
28.559

10.294
9.931
9.531
8.575

36.850
36.125
36.475
36.650

104.000
104.469
106.369
114.831

42.440
42.440
42.440
42.440

27.544
30.502
30.418
32.439

10.350
8.750
7.381
6.813

36.000
33.225
34.625
35.300

122.906
122.244
117.656
125.587

42.440
42.440
42.440
42.440

34.910
38.826
31.448
38.143

9.638
6.725
7.744
6.081

34.100
29.275
33.500
32.700

175.525
151.644
123.769
135.731

84.886
84.886
84.886
84.886

48.263
51.058
53.573
56.077

22.631
21.744
18.131
17.500

73.575
71.700
72.200
74.275

200.469
212.281
220.244
227.494

84.886
84.886
84.886
84.886

53.721
59.674
56.546
65.128

22.181
20.056
18.444
14.856

72.175
66.075
69.750
70.825

216.163
248.344
231.025
250.919

84.886
84.886
84.886
84.886

68.050
77.636
64.130
75.035

20.881
16.775
15.100
12.675

69.400
57.625
67.325
66.125

268.369
316.769
244.894
271.725

101

Appendix C

WinBUGS Codes
C.1

CAR Normal (BYM) Model
CAR Normal

# CAR (convolution) Normal.
#######################################
model{
for (i in 1:N){
y[i] ~ dpois(lambda[i])
log(lambda[i]) <- log(E[i]) + theta[i]
theta[i] <- alpha + v[i] + u[i]
RR[i]
<- exp(theta[i])
v[i] ~ dnorm(0,tau2_v)
}
###############
# CAR prior:
u[1:N] ~ car.normal(adj[],weights[],num[],tau2_u)
for (j in 1:sumNumNeigh){
weights[j] <- 1.0
}
###############
# Hyperpriors.
alpha ~ dflat()
# Scaling Parameters.
tau2_v ~ dgamma(0.5,0.0005)
tau2_u ~ dgamma(0.5,0.0005)
sig_v <- sqrt(1/tau2_v)
sig_u <- sqrt(1/tau2_u)
}# EoF

102

C.2

CAR Laplace (L1) Model
CAR Laplace

# CAR (convolution) L1.
##################################################
model{
for (i in 1:N){
y[i] ~ dpois(lambda[i])
log(lambda[i]) <- log(E[i]) + theta[i]
theta[i] <- alpha + v[i] + u[i]
RR[i] <- exp(theta[i])
v[i] ~ dnorm(0,tau2_v)
}
###############
# CAR prior
u[1:N] ~ car.l1(adj[],weights[],num[],tau2_u)
for (j in 1:sumNumNeigh){
weights[j] <- 1.0
}
###############
# Hyperpriors.
alpha ~ dflat()
# Scaling Parameters.
tau2_v ~ dgamma(0.5,0.0005)
tau2_u ~ dgamma(0.5,0.0005)
sig_v <- sqrt(1/tau2_v)
sig_u <- sqrt(1/tau2_u)
}# EoF

103

C.3

MRSA Model
MRSA Model

# Loglinear Model.
##################################################
model{
for (i in 1:n){
y[i] ~ dpois(lambda[i])
log(lambda[i]) <- log(E[i]) + theta[i]
theta[i] <- alpha + v[i]
RR[i]
<- exp(theta[i])
v[i] ~ dnorm(0,tau2_v)
}
###############
# Hyperpriors.
alpha ~ dnorm(0.0,1.0E-6)
# Scaling Parameters.
tau2_v ~ dgamma(0.5,0.0005)
sig_v <- sqrt(1/tau2_v)
}# EoF

104

Bibliography
Basagana, X., Sunyer, J., Kogevinas, M., Zock, J.P., Duran-Tauleria, E., Jarvis, D., Burney, P.,
and Anto, J.M. (2004). Socioeconomic status and asthma prevalence in young adults: The
european community respiratory health survey. Am. J. Epidemiol., 160(2), 178–188.
Berger, J. (1980). A Robust Generalized Bayes Estimator and Confidence Region for a Multivariate
Normal Mean. The Annals of Statistics, 8(4), 716–761.
Bernardo, J. and Smith, A. (1994). Bayesian theory. Wiley, London.
Besag, J. (1974). Spatial interaction and the statistical analysis of lattice systems. Journal of the
Royal Statistical Society Series B (Statistical Methodology), 36, 192–236.
Besag, J. and Kooperberg, C. (1995). On Conditional and Intrinsic Autoregression. Biometrika,
82(4), 733–746.
Besag, J., York, J., and Molli, A. (1991). Bayesian image restoration, with two applications in
spatial statistics. Annals of the Institute of Statistical Mathematics, 43(1), 1–20.
Best, N., Richardson, S., and Thomson, A. (2005). A comparison of Bayesian spatial models for
disease mapping. Statistical Methods in Medical Research, 14, 35–59.
Best, N.G., Spiegelhalter, D.J., Thomas, A., and Brayne, C.E.G. (1996). Bayesian analysis of
realistically complex models. Journal of the Royal Statistical Society. Series A (Statistics in
Society), 159(2), 323–342.
Cantor-Graae, E., Pedersen, C., McNeil, T., and Mortensen, P. (2003). Migration as a risk factor
for schizophrenia: a danish population-based cohort study. Br J Psychiatry, 182(2), 117–122.
Carstairs, V. (2000). Socio-economic factors at areal level and their relationship with health.
In P. Elliott, J. Wakefield, N. Best, and D. Briggs (eds.) Spatial Epidemiology: Methods and
Applications, –. Oxford University Press, London.
Carstairs, V. and Morris, R. (1989a). Deprivation: explaining differences in mortality between
scotland and england and wales. British Medical Journal, 299(6704), 886–889.
Carstairs, V. and Morris, R. (1989b). Deprivation and mortality: an alternative to social class?
Journal of Public Health, 11(3), 210–219.
Chaix, B., Merlo, J., and Chauvin, P. (2005). Comparison of a spatial approach with the multilevel
approach for investigating place effects on health: the example of healthcare utilisation in france.
J Epidemiol Community Health, 59(6), 517–526.
Clayton, D. and Kaldor, J. (1987). Empirical bayes estimates of age-standardized relative risks
for use in disease mapping. Biometrics, 43(3), 671–681.
Craigmile, P., Cressie, N., Santner, T., and Rao, Y. (2006). A loss function approach to identifying
environmental exceedances. Extremes, 8(3), 143–159.

105

DeGroot, M. (1970). Optimal statistical decisions. Wiley, London.
Demidenko, E. (2004). Mixed Models: Theory and Applications. Wiley, London.
Efron, B. and Tibshirani, R. (1993). An introduction to the bootstrap. Chapman & Hall, London.
Elmore, J.G., Miglioretti, D.L., Reisch, L.M., Barton, M.B., Kreuter, W., Christiansen, C.L.,
and Fletcher, S.W. (2002). Screening mammograms by community radiologists: Variability in
false-positive rates. J. Natl. Cancer Inst., 94(18), 1373–1380.
Faris, R. and Dunham, H. (1939). Mental disorders in urban areas. University of Chicago Press,
Chicago.
Fishburn, P. (1964). Decision and Value Theory. Wiley, London.
Frey, J. and Cressie, N. (2003). Some results on constrained bayes estimators. Statistics and
Probability Letters, 65, 389–399.
Gelman, A. (2006). Prior distributions for variance parameters in hierarchical models. Bayesian
Analysis, 3, 515–533.
Gelman, A., Carlin, J., Stern, H., and Rubin, D. (2004). Bayesian Data Analysis. Chapman and
Hall, London, 2nd ed.
Gelman, A. and Price, P. (1999). All maps of parameter estimates are misleading. Statistics in
medicine, 18, 3221–3234.
Ghosh, M. and Rao, J.N.K. (1994). Small area estimation: An appraisal. Statistical Science, 9(1),
55–76.
Ghosh, M. (1992). Constrained bayes estimation with applications. Journal of the American
Statistical Association, 87(418), 533–540.
Giggs, J. (1973). Distribution of schizophrenics in nottingham. Transactions of the Institute of
British Geographers, 59, 5–76.
Giggs, J. and Cooper, J. (1987). Ecological structure and the distribution of schizophrenia and
affective psychoses in nottingham. British Journal of Psychiatry, 151, 627–633.
Gilchrist, W. (2000). Statistical modelling wih quantile functions. Chapman & Hall, London.
Goldstein, H. and Spiegelhalter, D.J. (1996). League tables and their limitations: Statistical issues
in comparisons of institutional performance. Journal of the Royal Statistical Society. Series A
(Statistics in Society), 159(3), 385–443.
Gomez-Deniz, E., Perez-Sanchez, J., and Vazquez-Polo, F. (2006). On the use of posterior regret [gamma]-minimax actions to obtain credibility premiums. Insurance: Mathematics and
Economics, 39(1), 115–121.
Gordon, A. (1999). Classification. Chapman and Hall, London.
Green, P. (1995). Reversible jump markov chain monte carlo computation and bayesian model
determination. Biometrika, 82, 711–32.
Green, P. and Richardson, S. (2002). Hidden markov models and disease mapping. Journal of the
American Statistical Association, 97, 1055–1070.
Grigg, O.A., Farewell, V.T., and Spiegelhalter, D.J. (2003). Use of risk-adjusted cusum and
rsprtcharts for monitoring in medical contexts. Statistical Methods in Medical Research, 12(2),
147–170.

106

Grigg, O.A., Spiegelhalter, D.J., and Jones, H.E. (2009). Local and marginal control charts applied
to methicillin resistant staphylococcus aureus bacteraemia reports in uk acute national health
service trusts. Journal of the Royal Statistical Society: Series A (Statistics in Society), 172(1),
49–66.
Grigg, O. and Spiegelhalter, D. (2007). A simple risk-adjusted exponentially weighted moving
average. Journal of the American Statistical Association, 102(477), 140–152.
Hafner, H., Reimann, H., and Immich, H. (1969). Inzidenz seelischer erkrankungen in mannheim
1965. Soc Psychiatr, 4, 127–135.
Hare, E. (1956). Mental illness and social condition in bristol. Journal of Mental Sciences, 102,
349–357.
Harrison, G., Glazebrook, C., and Brewin, J.e.a. (1997). Increased incidence of psychotic disorders
in migrants from teh caribbean to the united-kingdom. Psychological Medicine, 27, 799–806.
Hollingshead, A. and Redlich, F. (1958). Social class and mental illness. Wiley, New York.
Huber, P. and Ronchetti, E. (2009). Robust Statistics. Wiley, London, 2nd ed.
Jablensky, A., Sartorius, N., Ernberg, G., Anker, M., Korten, A., Cooper, J., Day, R., and
Bertelsen, A. (1992). Schizophrenia: manifestations, incidence and course in different cultures.
a world health organization ten-counter study. Psychological Medicine, S20, 1–97.
Jarup, L., Best, N., and Toledano, M. (2002). Geographical epidemiology of prostate cancer in
great britain. International Journal of Cancer, 97, 695–699.
Kirkbride, J., Fearon, P., Morgan, C., Dazzan, P., Morgan, K., Murray, R., and Jones, P. (2007).
Neighbourhood variation in the incidence of psychotic disorders in southeast london. Social
Psychiatry and Psychiatric Epidemiology, 42(6), 438–445.
Kirkbride, J.B., Fearon, P., Morgan, C., Dazzan, P., Morgan, K., Tarrant, J., Lloyd, T., Holloway, J., Hutchinson, G., Leff, J.P., Mallett, R.M., Harrison, G.L., Murray, R.M., and Jones,
P.B. (2006). Heterogeneity in incidence rates of schizophrenia and other psychotic syndromes:
Findings from the 3-center aesop study. Archives of General Psychiatry, 63(3)(3), 250–258.
Koenker, R. and Bassett, B. (1978). Regression quantiles. Econometrica, 46, 33–50.
Krabbendam, L. and van Os, J. (2005). Schizophrenia and urbanicity: a major environmental
influence–conditional on genetic risk. Schizophrenia Bulletin, 31, 795–799.
Kreps, D. (1988). Notes on the Theory of Choice. Underground Classics in Economics. Westview,
New York.
Laird, N.M. and Louis, T.A. (1989). Empirical bayes ranking methods. Journal of Educational
Statistics, 14(1), 29–46.
Larsen, K. and Merlo, J. (2005). Appropriate assessment of neighborhood effects on individual
health: Integrating random and fixed effects in multilevel logistic regression. American Journal
of Epidemiology, 161, 81–88.
Larsen, K., Petersen, J.H., Budtz-Jrgensen, E., and Endahl, L. (2000). Interpreting parameters
in the logistic regression model with random effects. Biometrics, 56(3), 909–914.
Lawson, A. (2009). Bayesian disease mapping: hierarchical modeling in spatial epidemiology. CRC
Press, London.
Lehmann, E. and Casella, G. (1995). Theory of Point Estimation. Wadsworth, Pacific Grove,
California.
107

Lewis, G., David, A., Andreasson, S., and et al. (1992). Schizophrenia and city life. Lancet, 340,
137–140.
Lin, R., Louis, T., Paddock, S., and Ridgeway, G. (2006). Loss function based ranking in two-stage
hierarchical models. Bayesian analysis, 1(4), 915–946.
Lockwood, J., Louis, T., and McCaffrey, D. (2004). Uncertainty in rank estimation: Implications
for value-added mode. Journal of Educational and Behavioral Statistics, 29, 67–101.
Loffler, W. and Haffner, H. (1999). Ecological patterns of first admitted schizophrenics to two
german cities over 25 years. Social Sciences and Medicine, 49, 93–108.
Lopez-Abente, G., Ramis, R., Pollan, M., Aragones, N., Perez-Gomez, B., Gomez-Barroso, D.,
Carrasco, J., Lope, V., Garcia-Perez, J., Boldo, E., and Garcia-Mendizabal, M. (2007). Atlas of
cancer mortality at municipality level in Spain 1989–1998. Area de Epidemiologia Ambiental y
Cancer del Centro Nacional de Epidemiologia ISCIII, Madrid.
Lopez-Abente, G., Aragones, N., Ramis, R., Hernandez-Barrera, V., Perez-Gomez, B., EscolarPujolar, A., and Pollan, M. (2006). Municipal distribution of bladder cancer mortality in spain:
Possible role of mining and industry. BMC Public Health, 6(1), 17–27.
Louis, T. (1984). Estimating a population of parameter values using bayes and empirical bayes
methods. JASA, 79, 393–398.
Lunn, D., Thomas, A., Best, N., and Spiegelhalter, D. (2000). Winbugs – a bayesian modelling
framework: concepts, structure, and extensibility. Statistics and Computing, 10, 325–337.
MacEachern, S. (1994). Estimating normal means with a conjugate style dirichlet process prior.
Communication in Statistics –Simulation and Computation, 23, 727–741.
MacEachern, S.N. and Muller, P. (1998). Estimating mixture of dirichlet process models. Journal
of Computational and Graphical Statistics, 7(2), 223–238.
MacNab, Y., Qiu, Z., Gustafson, P., Dean, C., Ohlsson, A., and Lee, S. (2004). Hierarchical bayes
analysis of multilevel health services data: A canadian neonatal mortality study. Health Services
and Outcomes Research Methodology, 5, 5–26.
Marcelis, M., Navarro-Mateu, F., Murray, R., and et al. (1998). Urbanization and psychosis: A
study of 1942–1978 birth cohorts in the netherlands. Psychological Medicine, 28, 871–879.
McCullagh, P. and Nelder, J. (1989). Generalized Linear Models. Chapman and Hall, 2nd ed.
Normand, S.L.T., Glickman, M.E., and Gatsonis, C.A. (1997). Statistical methods for profiling
providers of medical care: Issues and applications. Journal of the American Statistical Association, 92(439), 803–814.
Pedersen, C. and Mortensen, P. (2001). Evidence of a dose-response relationship between urbanicity during upbringing and schizophrenia risk. Archives of General Psychiatry, 58, 1039–1046.
Pollan, M., Ramis, R., Aragones, N., Perez-Gomez, B., Gomez, D., Lope, V., Garcia-Perez, J.,
Carrasco, J., Garcia-Mendizabal, M., and Lopez-Abente, G. (2007). Municipal distribution of
breast cancer mortality among women in spain. BMC Cancer, 7(1), 78–88.
Raiffa, H. and Schlaifer, R. (1960). Applied Statistical Decision Theory. Wiley Classics Library.
Rao, J. (2003). Small Area Estimation. Wiley.
Richardson, S., Thomson, A., Best, N., and Elliott, P. (2004). Interpreting posterior relative risk
estimates in disease-mapping studies. Environmental Health Perspectives, 112, 1016–1025.

108

Richardson, S. and Green, P.J. (1997). On bayesian analysis of mixtures with an unknown number
of components. Journal of the Royal Statistical Society. Series B, 59(4), 731–792.
Robert, C.P. (1996). Intrinsic losses. Theory and Decision, 40(2), 191–214.
Robert, C. (2007). The Bayesian Choice. Springer, London, 2nd ed.
Robert, C. and Casella, G. (2004). Monte Carlo Statistical Methods (2nd Ed.). Springer.
Savage, L. (1954). The Foundations of Statistics. Dover, New York.
Shen, W. and Louis, T. (1999). Empirical bayes estimation via the smoothing by roughening
approach. Journal of computational and graphical statistics, 8, 800–823.
Shen, W. and Louis, T. (2000). Triple-goal estimates for disease mapping. Statistics in Medicine,
19, 2295–2308.
Shen, W. and Louis, T.A. (1998). Triple-goal estimates in two-stage hierarchical models. Journal
of the Royal Statistical Society. Series B (Statistical Methodology), 60(2), 455–471.
Shipman-Inquiry (2004). Shipman Inquiry Fifth Report – Safeguarding Patients: Lessons from the
Past, Proposals for the future. Stationary Office, London.
Spiegelhalter, D. (2005). Problems in assessing rates of infection with methicillin resistant staphylococcus aureus. British Medical Journal, 331, 1013–1015.
Spiegelhalter, D., Abrams, K., and Myles, J. (2004). Bayesian approaches to clinical trials and
health-care evaluation. Wiley, London.
Spiegelhalter, D., Thomas, A., and Best, N. (2000). WinBUGS Version 1.3 User Manual. Medical
Research Council Biostatistics Unit., Cambridge.
Steinbrecher, G. and Shaw, W. (2008). Quantile mechanics. European Journal of Applied Mathematics, 19(02), 87–112.
Sundquist, K., Malmstrom, M., and Johansson, S.E. (2004). Neighbourhood deprivation and
incidence of coronary heart disease: a multilevel study of 2.6 million women and men in sweden.
J Epidemiol Community Health, 58(1), 71–77.
Ugarte, M.D., Goicoa, T., Ibez, B., and Militino, A.F. (2009a). Evaluating the performance of
spatio-temporal bayesian models in disease mapping. Environmetrics, 20(6), 647–665.
Ugarte, M., Goicoa, T., and Militino, A. (2009b). Empirical bayes and fully bayes procedures to
detect high-risk areas in disease mapping. Computational Statistics & Data Analysis, 53(8),
2938–2949.
van Os, J., Hannssen, M., Bak, M., and et al. (2003). Do urbanicity and familial liability coparticipate in causing psychosis? American Journal of Psychiatry, 160, 477–482.
von Neumann, J. and Morgenstern, O. (1944). Theory of Games and Economic Behavior. Princeton University Press, New York.
Wakefield, J., Best, N., and Waller, L. (2000). Bayesian approaches to disease mapping. In P. Elliott, J. Wakefield, N. Best, and D. Briggs (eds.) Spatial epidemiology: Methods and applications,
104–127. OUP, London.
Waller, L.A., Carlin, B.P., Xia, H., and Gelfand, A.E. (1997). Hierarchical spatio-temporal mapping of disease rates. Journal of the American Statistical Association, 92(438), 607–617.
Wichura, M.J. (1988). Algorithm as 241: The percentage points of the normal distribution. Applied
Statistics, 37(3), 477–484.
Wright, D., Stern, H.S., and Cressie, N. (2003). Loss functions for estimation of extrema with an
application to disease mapping. The Canadian Journal of Statistics, 31(3), 251–266.
109

