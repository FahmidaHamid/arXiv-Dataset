Collective response to perturbations in a data-driven fish school model
Daniel S. Calovi1,2 , Ugo Lopez1,2,3 , Paul Schuhmacher1,2 ,
Hugues Chaté4 , Clément Sire5,6 , and Guy Theraulaz1,2
1

Centre de Recherches sur la Cognition Animale,

arXiv:1409.6430v2 [q-bio.QM] 5 Jan 2015

UMR-CNRS 5169, Université Paul Sabatier,
118 Route de Narbonne, 31062 Toulouse Cedex 4, France
2

CNRS, Centre de Recherches sur la Cognition Animale, F-31062 Toulouse, France
3

LAPLACE (Laboratoire Plasma et Conversion d’Energie),

Université Paul Sabatier, 118 route de Narbonne, 31062 Toulouse Cedex 9, France
4

Service de Physique de l’État Condensé, CNRS URA 2464,
CEA – Saclay, 91191 Gif-sur-Yvette, France

5

Laboratoire de Physique Théorique, Université Paul Sabatier, 31062 Toulouse Cedex 4, France and
6

CNRS, Laboratoire de Physique Théorique, F-31062 Toulouse, France
(Dated: January 6, 2015)

Fish schools are able to display a rich variety of collective states and behavioural responses
when they are confronted to threats. However, a school’s response to perturbations may be
different depending on the nature of its collective state. We use a previously developed datadriven fish school model to investigate how the school responds to perturbations depending
on its different collective states, we measure its susceptibility to such perturbations, and
exploit its relation with the intrinsic fluctuations in the school. In particular, we study
how a single or a small number of perturbing individuals whose attraction and alignment
parameters are different from those of the main population affect the long-term behaviour
of a school. We find that the responsiveness of the school to the perturbations is maximum
near the transition region between milling and schooling states where the school exhibits
multistability and regularly shifts between these two states. It is also in this region that the
susceptibility, and hence the fluctuations, of the polarisation order parameter is maximal.
We also find that a significant school’s response to a perturbation only happens below a
certain threshold of the noise to social interactions ratio.

I.

INTRODUCTION

Fish schools behave as coherent entities and display complex emergent properties such as coordinated motion, different ordered collective states, and rapid escape manoeuvres when attacked
by predators [1–5]. These group-level properties provide evolutionary advantages to fish schools
and arise through social interactions by which individuals exchange information and perform spe-

2
cific behavioural responses such as changing their direction and velocity, or avoiding collision with
group members or obstacles in the environment [6–12]. These interactions facilitate the transfer
of information between fish and their ability to quickly respond to changes in the environment.
For instance, when some fish spot a predator they abruptly change their direction of travel. Their
close neighbours react in turn by changing their own velocity so that the information gradually
propagates through the whole group, allowing all individuals to escape [6]. Experimental and
theoretical works have shown that the same interactions can lead a few individuals having salient
information, such as knowledge about the location of a food source or of a migration route, to guide
other group members and bias the resulting direction of travel of the school [13–15]. In all these
situations, a small proportion of individuals deeply influence the collective behaviour of the whole
group. This is a direct consequence of the asymmetry of behavioural responses that exist between
the perturbing or informed individuals and the other group members. Indeed, the behaviour of a
perturbing or an informed fish is weakly influenced by the behaviour of its neighbours. While the
decisions of the neighbours are mostly dictated by the behaviour of nearby fish.
Theoretical investigations have shown that not only the features of local interactions among
individuals but also the number and position of neighbours to which a fish pays attention determine the patterns of collective motion that emerge at the group level [16–19]. For instance, we
have recently shown in a data-driven fish school model that the relative weights of attraction and
alignment interactions between fish give rise to a small number of specific collective states [20–22]:
a swarming (disordered) state in which fish aggregate without cohesion, with a low level of polarisation of their velocity; a schooling (ordered) state in which individuals are aligned with each other; a
milling (ordered) state in which individuals constantly rotate around an empty core; and a winding
(ordered) state, in which the group exhibits an elongated phase characterised by a linear crawling
motion. However, according to whether fish pay equal attention to their surrounding neighbours
or focus their attention only of those neighbours that are ahead of them [22] (i.e., interactions
depend on the neighbour angular position), the number of collective states that can be reached
by a school is different. Only the swarming and schooling states survive when the behavioural
reactions of fish do not depend on the angular position of their neighbours, while the full repertoire
of collective states exists when a front/back asymmetry in fish interaction is introduced. Moreover
the exploration of the model has shown that in the transition region between milling and schooling
states, the school exhibits multistability and regularly shifts from schooling to milling for the same
combination of individual parameters, a property that was also reported in the model of Couzin et
al. [18] and in experimental observations on groups of golden shiners [23].

3
While the past literature on schooling models has been devoted to a better understanding of
the link between interaction rules and collective behaviours, less attention was paid to the group
response and to its sensitivity to external perturbations [16, 18–20, 22, 24–27]. In particular, one
may wonder if a small number of perturbed or informed individuals could trigger the same response
whatever the collective state of the school.
In the present work, we extensively study a previously developed data-driven model [21], which
has been validated previously on actual experiments on Khulia mugil and was able to describe
quantitatively several properties: individual trajectories of a single fish in a tank (validating in
particular the noise and friction terms; see the Model section below), interaction between 2 to
30 fish, diffusion properties, mean distance between fish, mean fish alignment/polarisation vs the
velocity or the number of fish in the tank. In another work [22], the phase diagram of the model
without the tank boundaries (in free space) was studied as a function of the attraction and alignment
parameters, reproducing several collective states observed in actual fish schools (see below). The
excellent qualitative and quantitative accuracy of the model in describing real fish schools in a
tank is a good motivation to consider it as a fair description of fish moving in a free space (in
particular their response to a perturbation) for which relevant experiments would be much harder
to implement.
The present work hence addresses the response properties of a fish school in free space, using
the model as presented in [22], and that we will briefly review below for completeness, but also to
emphasise the crucial role played by the fish anisotropic angular perception of their environment.
We investigate how a single or a small number of perturbed individuals affect the long-term behaviour of a school. In particular, we study how the school responds to perturbations depending
on its different collective states, and introduce their susceptibility to such perturbations. We relate
the fish school response quantified by these susceptibilities to the fluctuations (for instance, of the
polarisation order parameter) already existing in the unperturbed fish school. This deep connection
between response to a perturbation and intrinsic fluctuations without perturbation, although well
understood and studied in the context of physical systems, is less familiar in the present context
of fish schools, but equally applies. It is thus also one of the main purpose of the present work to
illustrate and study qualitatively and quantitatively this general connection. In addition, we also
exploit the fact that fluctuations and hence adequate susceptibilities are maximum (and would
diverge in an infinite systems) at the transition between two (collective) states separated by a
continuous phase transition.
We then first analyse the school susceptibility in the absence of any perturbation and its relation

4
to fluctuations and to the identification of transition lines between the different collective states.
We also explore the influence on the group behaviour of a perturbing fish with an independent set of
attraction and alignment parameters, while keeping the main population in the high susceptibility
region, in order to determine the perturbations which have the higher impact. We finally explore
the model parameter space to determine how the relative weighting of attraction and alignment of
fish affects the school responsiveness to perturbations. Finally, we discuss the implications of our
work for real fish schools.

II.

MODEL

The present model was originally proposed by Gautrais et al. [20, 21] to describe the coordination of movements in groups of Khulia mugil through the use of stochastic equations of motion
for their angular velocity ωi = dφi / dt, while fish move with a constant speed along their angular
direction given by φi . In a previous work [22], we have introduced a non-dimensionalised version of
the model in which we included an angular modulation of the strength of interactions between a fish
and its neighbours according to their angular position, a property also supported by experiments
[20, 21], but of negligible consequence for fish in a not too large tank. This angular modulation
breaks the symmetry of interactions between fish in front and those in the back. For completeness,
we briefly recall the main ingredients of the model, where the individual angular velocity ωi evolves
according to the following non-dimensional stochastic differential equation:
α dωi (t) = − [ωi (t) − ωi∗ (t)] dt + dWi (t),

(1)

where α can be understood as an angular inertia term, ωi∗ is the response function resulting
from the interaction with the neighbouring fish (see figure 1(a)) and dWi (t) refers to a random
√
variable, uncorrelated in time, and uniformly distributed in the interval [−1, 1] (times dt). As a
consequence of the large number theorem, such a uniformly distributed noise has exactly the same
effect as the usual Gaussian noise (Wiener process) in the long run and in the limit of a time step
dt → 0, with the benefit of being much faster to implement numerically.
The interaction is described by the normalised linear superposition of pair interactions between
the focal fish and the first shell of Voronoi neighbours (see figure 1(b)) as follows:
ωi∗ =

1 X
[1 + cos(θij )] [β sin φij + γdij sin θij ] ,
Ni j∈V

(2)

i

where θij is the angular position between the focal fish i and the neighbour j, Ni refers to the
number of neighbouring fish in the first shell of the Voronoi tessellation Vi . The following terms

5
correspond respectively to the alignment and attraction “forces”, with β and γ controlling their
intensities. φij = φj − φi is the heading angle difference and dij is the non-dimensional distance
between j and the focal fish i. Originally, when investigating fish interactions, Gautrais et al. [21]
considered different kind of neighbourhoods to combine fish interactions. It was shown that besides
the Voronoi neighbourhood, other choices were compatible with the experimental data in a tank,
in particular the interactions between the k (k ≈ 6 − 8) nearest neighbours, which is remarkably
similar to the average number of neighbours contained in the first shell of the Voronoi tessellation
(hNi i = 6, exactly, in two dimensions).
In equation 2, the prefactor Aij = 1 + cos(θij ) modulates the amplitude of the interaction
between fish i and j, as a function of the angle of view of the former. It is larger if j is ahead i
than behind, and is hence maximum for θij = 0 (Aij = 2), minimum for θij = π (Aij = 0), while
its angular average is hAij i = 1. This term also introduces a strong asymmetry between the force
exerted by j on i and the one exerted by i on j, and hence breaks the (Newtonian) action-reaction
principle which is most familiar in the context of purely physical force, like gravitation. Apart
from the technical fact that the alignment and attraction forces become non conservative (i.e. not
deriving from a potential energy), it has the practical and important consequence of allowing for
the milling and winding phases, both observed in actual fish schools in the ocean (quasi free space).
In [22], we have shown that varying the parameters β and γ of the model strongly affects the
school behaviour, leading to four distinct collective states (see the complete phase diagram in [22]):
(I) schooling, (II) milling, (III) elongated winding state and (IV) swarming, all of which can be
visualised in figure 1(c).

III.

QUANTIFICATION OF COLLECTIVE BEHAVIOURS AND RESPONSES TO
PERTURBATIONS

We now proceed to describe the tools used to characterise the collective states and to measure
the susceptibility and the school response to perturbations. We also describe the numerical details
used for the simulations herein.

6

Figure 1: Graphical representation of fish interactions used in the model. (a) dij is the distance of fish j
from fish i; φij is the relative orientation of fish j compared to fish i; θij is the angle between the angular
position of fish j with respect to fish i. (b) Illustration of the Voronoi neighbourhood; arrows indicate fish
headings. A focal fish is displayed in red and his Voronoi neighbours in orange. (c) Snapshots of typical
configurations for the 4 distinct states displayed by the model.

A.

Order parameters

The aforementioned states can be quantified by two order parameters: (1) the polarisation order
parameter which provides a measure of how aligned the individuals in a group are:
1
P =
N

N

X ~
vi 


.

v

(3)

i=1

P takes values between 0 (no alignment on average) and 1 (all fish are aligned); and (2) the
rotational or milling order parameter which provides a measure of the milling behaviour. It is the

7
absolute value of the normalised angular momentum:
1
M=
N

N

X ~
ri ×~vi 


,

|~ri |v 

(4)

i=1

where |~vi | = v = 1 in the non-dimensional version of the model. M takes values between 0 (no
collective rotation) and 1 (strong collective rotation of the school). The analysis on the transition
line between the schooling and milling phases [22] shows that it obeys a simple functional form
√
β = A γ+B, and that it is independent of the angular inertia term α from equation (1) considering
values of equivalent of constant speeds between 0.4 and 1.2 m/s.

B.

Susceptibilities and fluctuations

In many physical systems, some physical quantity may be coupled linearly and influenced by
an external “field”. For instance, in a magnetic system, the atomic or electronic spins are coupled
and tend to align along the direction of an external magnetic field. Similarly, an elastic medium
(a spring or a rubber) can be elongated or compressed by exerting an external force. In general,
the linear response of such a quantity P (for instance, the spin/fish polarisation – i.e. the average
spin/fish direction) to a small change in the associated external field h is quantified by introducing
the P -susceptibility
P (h) =h→0 χh + ...,

χ=

∂P
.
∂h |h=0

(5)

In the present context of the dynamics of fish school, the change in the order parameter P
(or M ) to a small perturbation (of a nature detailed in the two next sections) will give a first
characterisation of the response of the system which will be presented in section IV B and IV C.
Moreover, for a system at equilibrium or in a stationary state associated to an energy functional
(an Hamiltonian), the fluctuation-dissipation theorem (FDT) [28] states that there exists a direct
relation, in fact an exact equality up to a constant factor, between the P -susceptibility, as defined
above by means of a small perturbing field, and the (thermal) fluctuations of P at equilibrium
h

i

χ = N hP 2 i − hP i2 =

∂P
,
∂h |h=0

(6)

where N is the number of particles, and the angular brackets refer to the average over time of the
corresponding quantity, e.g. hP i = limt0 →∞

1
t0

Pt0

t=0 P (t).

In practice, in numerical simulations, t0

is of course finite, and is taken as large as computation time permits. In addition, the susceptibility
is also averaged over as many different samples/initial conditions as computationally possible. Note

8
that the neighbouring spins/fish of a given spin/fish exert an effective magnetic/alignment field on
the latter, making the connection between response and fluctuations very natural. In addition, the
noise in equation (1) formally plays exactly the same role as the thermal noise in physics.
This powerful FDT has several very important implications, apart from the clear physical insight
gained on the relations between the fluctuations and the response of a system. For instance, in
numerical simulations (molecular dynamics or Monte Carlo), it is much easier and much more
precise to measure the susceptibility from the fluctuations of the order parameter P (see the first
equality in equation (6)), rather than applying a small field h, waiting for equilibrium to settle,
measuring the (small) perturbation on P , and ultimately trying to extrapolate to h = 0 (see the
second quality in equation (6), and the original definition of equation (5)). In the present study
of fish schools, we will first measure the susceptibility via the fluctuations of the system (first
equality in equation (6)), and will in particular compare this susceptibility to the change of the
order parameter under the addition of a few perturbing fish to the school (effectively acting as a
small perturbing field).
As already mentioned, the asymmetric forces resulting from the Aij = 1 + cos(θij ) term breaks
the Newtonian action-reaction principle and forbids the existence of an underlying Hamiltonian.
However, the FDT has been generalised in out of equilibrium situations, including in cases where
the system, although in a stationary state, is not formally described by an energy functional (see
[28] for a review). Hence, the connection between the fluctuations of the school polarisation and
the polarisation response to a perturbation made in the present work appears very natural, and
will lead to important biological implications.
In the same manner as we just defined the polarisation susceptibility, we can define the milling
susceptibility χm associated to the milling order parameter
h

i

χm = N hM 2 i − hM i2 .

(7)

Again, it should be intimately related to the change of M under a small perturbation defined
hereafter, a relation which will be illustrated in the Results section and in the supplementary
figures.
Finally, in the physical context, the susceptibility and hence fluctuations are known to diverge
(at least in the limit of an infinite system N → ∞) exactly at the critical point between two
phases separated by a continuous (second order) phase transition involving the considered order
parameter. In the present context of fish schools, we will be naturally interested in the behaviour
of the susceptibility and fluctuations near transition lines, in particular near the schooling-milling

9
transition. The maximum of the susceptibility (characterised by fluctuations or response) as a
function of the model parameters hence provides an alternative identification of the transition lines
which will be illustrated extensively in section IV A and in the supplementary figures.

C.

Quantifying school response to perturbations

To detect behavioural changes, we compare the average values of the polarisation and milling
order parameters for a given set of alignment and attraction parameters of the unperturbed case,
with the new average value given by the simulations with one or more perturbing fish. These results
are presented for different combinations of the attraction and alignment parameters: complete
parameter space scans, cross-sections where the attraction parameter is kept fixed, and lastly, by
the set of parameters which describe the transition between the milling and schooling state.

D.

Simulations

We investigate the long-term consequences on the resulting school behaviour of a small number of perturbing fish that differ from the main population by having a different combination of
attraction and alignment parameters. Henceforth, we call Np the number of perturbing fish and
Nm = N − Np the main population of a N fish school. Accordingly (γp , βp ), and (γm , βm ), are the
attraction and alignment parameters respectively of the perturbing fish and the main population.
All simulations were run in an unbounded space with 400 random initial conditions for 1000 nondimensional time units, where the first half was discarded to remove transient states. A simple
Euler’s method integration with a time step of dt = 1.44×10−3 proved sufficient to avoid numerical imprecisions. Simulations results shown in the next sections were performed with N = 100 or
200, meanwhile the number of perturbing fish Np may vary from 1 to 9 depending to the studied
conditions.

IV.
A.

RESULTS

Susceptibility of a group of fish without perturbations

Having defined the susceptibility previously via the order parameter fluctuations (see equation
(6)), we have calculated the polarisation susceptibility values for different combinations of attraction and alignment parameters in a group of N = Nm = 100 and N = Nm = 200 fish respectively,

10
shown in figures 2(a) and 2(b). One can clearly see that the highest values of susceptibility correspond perfectly to the fitted transition line between the schooling and milling regions. This
indicates that the transition region is a good candidate to test different types of perturbing fish.
Together with the susceptibility, other statistics of the unperturbed simulations were also computed, such as polarisation and the milling order parameters, so that we can use some regions of
this map as a baseline to measure the impact of perturbing fish on the school behaviour.
In section IV C (see in particular figure 5), and in the supplementary material (by considering the
milling susceptibility χm ), we will indeed find a very strong correlation between the susceptibility
computed from the fluctuations in the unperturbed system, and the response properties of the
system under small perturbations.

B.

Quantification of perturbations

We now proceed to investigate the impact of various combinations of attraction and alignment
parameters of a single perturbing fish on the resulting group behaviour. The main population
is located in the transition region (γm = 14, βm = 10) while the parameters γp and βp of the
perturbing fish both vary in the interval [0, 16] with a 0.4 step, forming an uniform 41×41 grid in
the parameters space. Figure 3 shows the resulting difference in the average polarisation P . Note
that since the main population is located in the transition region, the values of the polarisation
P and milling M parameters fluctuate around 0.5. This means that in the case where the group
changes to an almost perfect schooling state (P ≈ 1), the maximum difference is 0.5. Figure 3
shows that this change to a schooling state happens for both low attraction and low alignment
values (γp and βp < 2).
One can easily understand that for low values of γp , corresponding to a weak attraction, the
perturbing fish will not remain as close to the group as the others, forcing them to follow it,
and in doing so, increasing the polarisation of the group. For low values of βp , fish can have the
same attraction parameters as the main population, but the weak alignment disrupts the milling
intermittence completely. The six insets in figure 3 represent the distribution of perturbing fish
locations with respect to the group’s centroid (white circle), and reoriented according to the average
direction movement of the school (white arrow). Inset 1 shows the unperturbed case (γm = γp
and βm = βp ), where we can see that the perturbing fish has an equal distribution all around the
school. One can see in insets 2 to 4 (and in supplementary videos B.1 and B.2) that when there
is a low attraction (γp = 1) the perturbing fish stays most of the time ahead of the group. This

11

(a)
16

16
14

14

12

12
10

10
I-II

8

8

6

6

4

II

4

2

Polarisation suscepbility

Main population alignment (βm)

I

2
III

IV

0

0
0

2

4

6
8
10
12
Main population attraction (γm)

14

16

(b)
36

16

I

32
28

12

24
10

I-II

20
8
16
6
12
4

II

8

2

4

III

IV

0

Polarisation suscepbility

Main population alignment (βm)

14

0
0

2

4

6
8
10
12
Main population attraction (γm)

14

16

Figure 2: Susceptibility of unperturbed fish school simulations for 100 (a) and 200 (b) fish. The susceptibility
is calculated according to equation (6) for different values of the attraction and alignment parameters. Each
data point represents an average over 400 simulations with random initial conditions. The white lines
following the peak of susceptibility represents the function that fits the schooling/milling transition line as
reported in [22]. The circled numbers indicate the 4 different collective states (I) schooling, (II) milling,
(III) winding,(IV) swarming and the transition zone between schooling and milling (I-II).

“leading” behaviour in which the school is attracted by the perturbing fish, but not the opposite,
is a consequence of the smaller attraction of the perturbing fish compared to the main population
(γp < γm ). Higher values of γp combined with a weak alignment (γp = 7 or 14, and βp = 1) lead
the perturbing fish to stay usually behind the group’s centroid (insets 5 and 6 and supplementary

(βp)

12

16

0.4

12
1

10

0.3

8

0.2

3

6
0.1
4
0

2
4

0

0

5

2

4

6

Difference in average polarisation

0.5

2

14

6

8

10

12

14

16 (γp)

Figure 3: Each data point represents the difference in the average polarisation caused by a single perturbing
fish, while varying its attraction (γp ) and alignment (βp ) parameters, in comparison to the unperturbed
case located on the transition region (γm = 14, βm = 10). The six insets shown here represent the location
distribution of the perturbing fish positions in relation to the group’s centroid (white circle), and reoriented
in according to the average direction movement of the group (white arrow).

video B.3). It is also important to highlight that in the latter case the perturbing fish is much
closer to the group’s centroid in comparison to the conditions shown in the insets 2 through 4. The
reason for the perturbing fish to remain close and behind to the school’s centroid is quite simple.
The high attraction insures that the perturbing fish remains close to the school, but with a low
alignment, it is unable to cope with the directional changes of the other fish. As a consequence, it
remains behind the school.
We also performed the same systematic analysis of the impact of a perturbing fish on the
group behaviour when the main population is in the schooling or the milling state. Supplementary

13
figures A.2 and A.3 show the results of these simulations. When the main population is located
in the schooling region (γm = 4, βm = 14) a perturbing fish causes almost no change to the group
behaviour. When the population is located in the milling region (γm = 14, βm = 4) one can
observe a change from milling to schooling for low parameter values of the perturbing fish (γp and
βp < 2) and intermittent transition between schooling and milling appear for low attraction and
high alignment values (γp < 2 and βp > 10). As explained previously, these effects in the milling
region are only due to a fish which is not able to remain close to the group, forcing its neighbours
to follow him, and in doing so, disrupting the mill, as shown in figure 3 (insets 2 to 4). It is worth
noting that: (1) the only observed change in the group behaviour resulting from the presence of
a perturbing fish is a transition to schooling; (2) only a perturbing fish with very low attraction
values (γp ≈ 0) is able to disrupt a group engaged in a milling state; any other behaviour of the
perturbing fish has no effective impact on the group tendency to rotate.

C.

Group response to perturbations

Considering the results shown in figure 3, we have chosen a configuration of parameters for the
perturbing fish (γp = 14 and βp = 1) which lies in the winding region (inset 6). The choice is
motivated to prevent the perturbing effects to be the simple consequence of non gregarious fish
(γp ≈ 0), like the situations depicted in insets 2 to 4 in figure 3. We now proceed to analyse the
group response to this perturbation for different configurations of the main population parameter
space. We focus on a cross section of the parameter space keeping a fixed value of γm = 10 and
varying βm in the interval [0, 16] represented by the vertical purple line in figure 4(a). Highlighted in
figure 4(b) are typical time series of the polarisation and milling order parameters in the schooling
region (I), the transition region (I-II) and the milling region (II). One can see that in the transition
region, simulations with the perturbing fish display a change to a purely schooling behaviour.
We can now investigate how an increasing number of perturbing fish affect group behaviour.
We performed simulations with Np = 1, 3 , 5, 7, and 9 perturbing fish (and Nm = 99, 97, 95, 93,
and 91, when N = 100 fish, and Nm = 199, 197, 195, 193, and 191, in simulations with groups of
N = 200 fish).
Figure 5 shows the resulting difference in the average polarisation induced by the perturbation
in comparison to the unperturbed condition in groups of 100 and 200 fish respectively. In both
cases the resulting change in the group polarisation and the susceptibility follow a similar pattern
reaching a peak in the transition region. A smaller peak can also be seen for values of low βm .

14

Figure 4: (a) Transition functions between schooling and milling fitted for simulations with 100 and 200
√
fish βm = A γm + B where [A = 3.22, B = −2.23] for 100 fish and [A = 3.28, B = −1.17] for 200 fish.
(b) Time series of polarisation P and M milling parameters when the main population is in 3 different
states: schooling (γm = 4, βm = 14), milling (γm = 14, βm = 4) and the transition between both states
(γm = 14,βm = 10), for unperturbed condition (red line) and with a single perturbing fish introduced in the
group (blue line, γp = 10, βp = 1).

This peak is related to the transition from the milling zone to the winding region.
Increasing the number of perturbing fish leads to an increase of the group polarisation (linear
perturbation regime) up to a saturation value (3 < Np < 5). Ultimately, it shows a steady
decline with more perturbing fish. This happens due to the fact that the perturbing fish have a
lower alignment parameter value, meaning that after the initial perturbing effect, they will have a
negative impact (non linear perturbation regime) in the average polarisation of the school. While
100 and 200 fish simulations show a very similar pattern of change in group polarisation for all
quantities of perturbing fish, simulations with 200 fish display a systematic lower response due to
the perturbing fish.
One might notice the difference in two orders of magnitude between difference in average polarisation and susceptibility. This comes from the fact that the susceptibility is proportional to N P 2 ,
while the difference in average polarisation is only proportional to P . Also, our main concern here
is to use the susceptibility as a reference point to which the group responses are compared.

15

(a)
15

0.5
0.4

Np=1
Np=3
Np=5
Np=7
Np=9
Susceptibility

0.4

0.3

0.3
0.2
0

2 4 6 8 10
Perturbing fish Np

10
Susceptibility

Difference in average polarisation

0.5

0.2
5
0.1

0
0

(b)
35

0.5
0.4

Np=1
Np=3
Np=5
Np=7
Np=9
Susceptibility

0.4

0.3

30

0.3
0.2
0

2 4 6 8 10
Perturbing fish Np

25
20

0.2

15

Susceptibility

Difference in average polarisation

0.5

10

0.1

5
0
0
0

2

4

6
8
10
Main population alignment (βm)

12

14

16

Figure 5: Difference in the average polarisation (left axis) in groups of 100 (a) and 200 (b) fish, with 1, 3, 5,
7, and 9 (light to dark blue) perturbing fish (γp = 14, βp = 1), as a function of the alignment parameter of
the main population (βm [0, 16]), keeping the attraction parameter of the main population to a constant value
(γm = 10). The black line represents the susceptibility values (right axis) for the unperturbed condition.
The insets show the maximum difference in average polarisation as a function of the number of perturbing
fish.

Having established that the transition zone is the region of the parameter space in which a fish
group displays the highest responsiveness to perturbations, we have studied the group response
throughout this region. As previously seen [22], the transition between schooling and milling follows

16
√
the functional form βm = A γm + B, where A and B fitted the parameter space data in which
the school presented both polarisation and milling parameter values above 0.8 more than 40% of
the time (see figure 4). We can systematically vary the attraction parameter γm within the range
[0, 16] and determine the parameter βm estimated by this procedure. In the following analysis, the
parameters of the single perturbing fish are kept unchanged (γp = 14 and βp = 1).
Figure 6 shows that even for a range of parameters where the susceptibility has already reached a
maximum value, the difference in average polarisation still increases with the attraction parameter
γm before it starts oscillating around the values shown at γm = 16. This means that while
being in the transition region is a required condition for a group of fish to exhibit sensitivity to
perturbations, a minimum level of attraction and alignment between fish is required to significantly
alter the group’s response to these perturbations. This additional requirement is probably due to
the fact that both γm and βm increase while keeping a constant noise, indicating that the main
population only reacts to the perturbation when the ratio noise to social interactions is kept below
a certain threshold.

V.

DISCUSSION

How interactions between individuals control the sensitivity to perturbations of the group to
which they belong and its ability to respond to threats is an important issue to understand the
evolution of collective behaviours in animal swarms. The survival of each individual within the
group strongly depends on the capacity of individuals to perform collective adaptive responses to
different conditions. Performing such responses not only requires coordination mechanisms but also
a high responsiveness to perturbations at the group level, which can be favored by the presence
of highly-correlated fluctuations in the unperturbed state (illustrating again the deep connection
between response and fluctuation) [29, 30].
Here we have addressed this question through an extensive investigation of the responsiveness
of a fish school model to long-term standardised perturbations in the form of a single or a small
number of fish that display different interactions than the main population in the school. We show
that the school response depends not only on the characteristics of the perturbing fish, but of the
collective state of the school as well. Indeed, in the parameter space defining the way fish interacts
with their neighbours, there is a region that maximises the school response to perturbations. This
region is located throughout the transition between schooling and milling states, where the school
exhibits multistability and regularly shifts between both states, and where fluctuations are hence

17

(a)
35
30

0.4

25
0.3
20
0.2

15
10

N=100
N=200
Susceptibility N=100
Susceptibility N=200

0.1

0

Susceptibility

Difference in average polarisation

0.5

5
0

0

2

4

6
8
10
12
Main population attraction (γm)

14

16

Figure 6: (a) Difference in average polarisation for 100 and 200 fish (light blue and orange filled circle
respectively) with a single perturbing fish (γp = 14 and βp = 1), along the transition region between
√
schooling and milling defined by βm = A γm + B. A and B have been estimated for different group sizes:
where A = 3.08, B = −1.97 for N = 100 and A = 3.28, B = −1.17 for N = 200. The corresponding
susceptibility for unperturbed fish of 100 and 200 fish is shown on the right axis (blue and red hollow circle
respectively).

maximal.
The perturbing fish consists in agent(s) with intensities of the attraction and alignment behaviours which differ from the rest of the group. Borrowing the concept of susceptibility from
magnetic systems and other analyses of collective behaviour in biological systems [31, 32], we analysed its equivalent in our simulations to measure the group’s behavioural change caused by the
perturbing fish. We found that groups of fish display the highest susceptibility in the transition
region between the schooling and milling states (figure 2). If one assumes that our fish are indeed in
a transition region, the results presented here could be compared to recent works [29, 32, 33] which
have shown that animal swarms are in a critical state to better adapt to various environmental
conditions.
Indeed, the evolutionary advantages of social behaviour in animals can easily be reduced if the

18
organisms fail to adapt rapidly and/or efficiently to a new challenging situation, for instance, in
case of a predator attack. It has been argued for some time that a more probable solution for
this problem is for a biological system to stay in a perpetual state of transition from the most
common behaviour available, close to criticality [29, 32–35], so that a minimal effort on its part
is able to push the collective behaviour into the new and more appropriate one. Despite this, the
system should also be steady/robust enough to ignore certain perturbations and avoid unnecessary
transitions.
Our systematic study of the impact of perturbations in the parameter space reveals that a group
of fish in the transition zone is highly affected by a perturbing fish with low attractions and/or
alignment values (figure 3). When choosing which set of parameters to use for the perturbing fish,
we avoided the trivial case where low attraction values coupled with the Voronoi neighbourhood
causes a following behaviour. For this reason, we used a set of parameters that induced the
perturbing fish to be located closer to the group’s centroid. We found that the group responds to
this perturbation by significantly increasing its level of polarisation, shifting from a state in which
the group spends half the time in the schooling and milling states to a new state where the group
is schooling permanently (figures 4, 5(a) and 5(b)).
We also checked whether the transition region is the only factor involved in the group’s responsiveness. As shown in figure 6, even in the transition region (maximum susceptibility), at lower
values of γm (and low βm ), the school does not show the same responsiveness. The main difference in this region compared to other transitions points is the value of noise to social interactions
ratio. This is in agreement with the observed lower responsiveness of the school as the number of
perturbing fish is increased (insets of figures 5(a) and 5(b)). This can be seen as an unnecessary
large amount of noise, which cancels the impact of the perturbation and decreases the noise to
social interactions ratio, as if the main population of the school was located in lower values of the
transition.
In this context, it is also interesting to mention the work of Ioannou et al. [36], who studied the
predatory tactics of a fish towards a virtual school with different attraction and alignment parameters. They found that the most frequently attacked fish (figure 2 of [36]) have low attraction and/or
low alignment parameters like the most influential perturbing fish in our model (figure 3). The
fact that this parameter region (low attraction and/or alignment) corresponds to a vulnerability
of the species (in Ioannou’s work) and to a large capacity to change the behaviour of the whole
school, suggests that when such deviant behaviour is detected it automatically triggers the other
group members to flee either from the current location and/or from the vulnerable perturbing fish

19
itself.
Previous works [13, 26] had already studied the impact of perturbations in fish schools, but they
focused on punctual or instantaneous perturbations, while we looked into the long-term changes
that result from the perturbation. These analyses were also mainly related to changes in the
school trajectory, and did not focus on the main behavioural changes undergone by the school.
When studying perturbations, one can either study how a punctual change immediately affects the
system, and the subsequent recovering of the system to its original state, or one can investigate
what is the minimal constant perturbation imposed on the system which is able to completely
change its properties.
A similar approach to this continuous perturbation analysis has been presented by Aureli et
al. [27], where they used a self-propelled particle model to study the effect of an external leader
particle. However, Aureli et al. have chosen a perturbing agent which is totally independent from
the school’s reactions. This choice also enabled them to compare their results with experiments
performed with a remote controlled robotic fish able to influence a school of Giant Danios (Devario
aequipinnatus) [37]. Despite these similarities, there are two main differences between the two
models: (i) the total independence of the perturbing agent, equivalent here to γp = βp = 0; (ii) the
movement of the perturbing agent itself differs completely from the school. More specifically, the
perturbing agent and the school can have different speeds. These differences limit the comparisons
between the two approaches. Nevertheless, for the case where the perturbing agent has a similar
speed as the rest of the particles, they observed an increase in polarisation similar to the one we
have found in figures 3, A.2, and A.3, for the case γp = βp = 0. Unfortunately, the observed state
in their simulations and experiments of agents/fish milling around the perturbing agent cannot be
reproduced here due to the fact that all fish have the same speed. Given the model dependence on
the fish distance, in the case where the perturbing fish was fixed at some point, the main population
would be forced to remain close, either swarming or milling around it, depending of the attraction
parameters βm used.
In order to best preserve the data-driven model developed by Gautrais et al. [20, 21], certain
limitations to the analysis arise. For instance, one can mention the recent work by Couzin et al.
[12] which has shown the importance of speed variation for the fish collective response. However,
in their original work, Gautrais et al. [20] observed that speed variation was minimal and could be
neglected for the considered species. Another limitation results from the size of the school, given
the dependence in fish distance for their interactions. This term causes a limitation in size of the
school as seen in our previous work [22], limiting simulations around the sizes of 100 and 200 fish

20
presented here.
In conclusion, our work has revealed that the collective states of a school deeply influence its
ability to respond to external or internal perturbations. By providing a high responsiveness to
perturbations, the transition region between milling and schooling appears to be a highly desired
state that optimises the ability of the fish to react collectively (e.g. to a predator attack), thus
increasing the survival of each individual within the school. Our results call for further experimental
observations on fish schools in order to measure both their susceptibility and responsiveness to
perturbations.

VI.

ACKNOWLEDGEMENTS

We are grateful to J. Gautrais for inspiring discussions. We thank the Laboratoire Plasma et
Conversion d’Energie (CNRS UMR 5283) and the Laboratoire de Physique Théorique (CNRS UMR
5152) for providing us access to their computing facilities. D. S. C. was funded by the Conselho
Nacional de Desenvolvimento Cientı́fico e Tecnológico â Brazil. U. L. was supported by a doctoral
fellowship from the scientific council of the University Paul Sabatier. This study was supported by
grants from the Centre National de la Recherche Scientifique and University Paul Sabatier (project
Dynabanc).

[1] Breder, C. M. 1951 Studies on the structure of fish schools. Bull. Am. Mus. Nat. Hist. 98, 3–27
[2] Radakov, D. 1973 Schooling in the Ecology of Fish. (J. Wiley, New York).
[3] Partridge,

B.

1982 The structure and function of fish schools. Sci. Am. 246,

114

(10.1038/scientificamerican0682-114).
[4] Treherne, J. & Foster, W. 1981 Group transmission of predator avoidance-behavior in a marine insect
the trafalgar effect. Anim. Behav. 29, 911–917 (10.1016/S0003-3472(81)80028-0).
[5] Domenici, P., Standen, E. & Levine, R. 2004 Escape manoeuvres in the spiny dogfish (squalus acanthilas). J. of Exp. Biol. 207, 2339–2349 (10.1242/jeb.01015).
[6] Krause, J. & Ruxton, G. 2002 Living in Groups, Oxford Series in Ecology and Evolution. (Oxford
University Press, Oxford).
[7] Treherne, J. E. & Foster, W. A. 1980 The effects of group size on predator avoidance in a marine
insect. Anim. Behav. 28, 1119 – 1122 (10.1016/S0003-3472(80)80100-X).
[8] Foster, W. A. & Treherne, J. E. 1981 Evidence for the dilution effect in the selfish herd from fish
predation on a marine insect. Nature 293, 466–467 (10.1038/293466a0).

21
[9] Magurran, A. 1990 The adaptive significance of schooling as an anti-predator defence in fish. Ann.
Zool. Fenn 27, 51–66
[10] Domenici, P. & Batty, R. 1997 Escape behaviour of solitary herring (clupea harengus) and comparisons
with schooling individuals. Mar. Biol. 128, 29–38 (10.1007/s002270050065).
[11] Herbert-Read, J., Perna, A., Mann, R., Schaerf, T., Sumpter, D. J. T. & Ward, A. J. W. 2011 Inferring
the rules of interaction of shoaling fish. PNAS 108, 18726–18731 (10.1073/pnas.1109355108).
[12] Katz, Y., Tunstrøm, K., Ioannou, C., Huepe, C. & Couzin, I. D. 2011 Inferring the structure and
dynamics of interactions in schooling fish. PNAS 108, 18720–18725 (10.1073/pnas.1107583108).
[13] Romey, W. L. 1996 Individual differences make a difference in the trajectories of simulated schools of
fish. Ecol. Model. 92, 65 – 77 (10.1016/0304-3800(95)00202-2).
[14] Huse, G., Railsback, S. & Feronö, A. 2002 Modelling changes in migration pattern of herring: collective
behaviour and numerical domination. J. Fish Biol. 60, 571–582 (10.1111/j.1095-8649.2002.tb01685.x).
[15] Couzin, I., Krause, J., Franks, N. & Levin, S. 2005 Effective leadership and decision-making in animal
groups on the move. Nature 433, 513–516 (10.1038/nature03236).
[16] Aoki, I. 1982 A simulation study on the schooling mechanism in fish. Bull. J. Soc. Sci. Fish 48,
1081–1088
[17] Huth, A. & Wissel, C. 1992 The simulation of the movement of fish schools. J. Theor. Biol. 156, 365
– 385 (10.1016/S0022-5193(05)80681-2).
[18] Couzin, I., Krause, J., James, R., Ruxton, G. & Franks, N. 2002 Collective memory and spatial sorting
in animal groups. J. Theor. Biol. 218, 1–11 (10.1006/jtbi.2002.3065).
[19] Viscido, S. V., Parrish, J. K. & Grünbaum, D. 2005 The effect of population size and number
of influential neighbors on the emergent properties of fish schools. Ecol. Model. 183, 347 – 363
(10.1016/j.ecolmodel.2004.08.019).
[20] Gautrais, J., Jost, C., Soria, M., Campo, A., Motsch, S., Fournier, R., Blanco, S. & Theraulaz, G. 2009
Analyzing fish movement as a persistent turning walker. J. Math. Biol. 58, 429–445 (10.1007/s00285008-0198-7).
[21] Gautrais, J., Ginelli, F., Fournier, R., Blanco, S., Soria, M., Chaté, H. & Theraulaz, G. 2012 Deciphering
interactions in moving animal groups. PLoS Comp. Biol. 8, e1002678 (10.1371/journal.pcbi.1002678).
[22] Calovi, D. S., Lopez, U., Ngo, S., Sire, C., Chaté, H. & Theraulaz, G. 2014 Swarming, schooling,
milling: phase diagram of a data-driven fish school model. New J. Phys. 16, 15026 (10.1088/13672630/16/1/015026).
[23] Tunstrøm, K., Katz, Y., Ioannou, C., Huepe, C., Lutz, M. & Couzin, I. 2013 Collective states, multistability and transitional behavior in schooling fish. PLoS Comp. Biol. 9 (10.1371/journal.pcbi.1002915).
[24] Hemelrijk, C. K. & Hildenbrandt, H. 2008 Self-organized shape and frontal density of fish schools.
Ethology 114, 245–254 (10.1111/j.1439-0310.2007.01459.x).
[25] Hemelrijk, C. K., Hildenbrandt, H., Reinders, J. & Stamhuis, E. J. 2010 Emergence of oblong school
shape: Models and empirical data of fish. Ethology 116, 1099–1112 (10.1111/j.1439-0310.2010.01818.x).

22
[26] Kolpas, A., Busch, M., Li, H., Couzin, I. D., Petzold, L. & Moehlis, J. 2013 How the spatial position of
individuals affects their influence on swarms: A numerical comparison of two popular swarm dynamics
models. PLoS ONE 8, e58525 (10.1371/journal.pone.0058525).
[27] Aureli, M. & Porfiri, M. 2010 Coordination of self-propelled particles through external leadership. EPL
92, 40004 (http://dx.doi.org/10.1209/0295-5075/92/40004).
[28] Marconi, U. M. B., Puglisi, A., Rondoni, L. & Vulpiani, A. 2008 Fluctuation-dissipation: Response theory in statistical physics. Phys. Rep. 461, 111 – 195 (http://dx.doi.org/10.1016/j.physrep.2008.02.002).
[29] Attanasi, A., Cavagna, A., Del Castello, L., Giardina, I., Melillo, S., Parisi, L., Pohl, O., Rossaro, B.,
Shen, E., Silvestri, E., & Viale, M. 2014 Finite-size scaling as a way to probe near-criticality in natural
swarms. Phys. Rev. Lett. 113, 238102 (10.1103/PhysRevLett.113.238102).
[30] Chaté, H. & Muñoz, M. 2014 Insect swarms go critical. Physics 7, 120 (10.1103/Physics.7.120).
[31] Cavagna, A., Cimarelli, A., Giardina, I., Parisi, G., Santagati, R., Stefanini, F. & Viale, M. 2010
Scale-free correlations in starling flocks. PNAS 107, 11865–11870 (10.1073/pnas.1005766107).
[32] Attanasi, A., Cavagna, A., Del Castello, L., Giardina, I., Melillo, S., Parisi, L., Pohl, O., Rossaro, B.,
Shen, E., Silvestri, E., & Viale, M. 2014 Collective behaviour without collective order in wild swarms
of midges. PLoS Comput Biol 10, e1003697 (10.1371/journal.pcbi.1003697).
[33] Bialek, W., Cavagna, A., Giardina, I., Mora, T., Pohl, O., Silvestri, E., Viale, M. & Walczak, A. M.
2014 Social interactions dominate speed control in poising natural flocks near criticality. PNAS 111,
7212–7217 (10.1073/pnas.1324045111).
[34] Mora, T. & Bialek, W. 2011 Are biological systems poised at criticality?. J. Stat. Phys. 144, 268–302
(10.1007/s10955-011-0229-4).
[35] Boedecker, J., Obst, O., Lizier, J., Mayer, N. & Asada, M. 2012 Information processing in echo state
networks at the edge of chaos. Theor. Biosci. 131, 205–213 (10.1007/s12064-011-0146-8).
[36] Ioannou, C. C., Guttal, V. & Couzin, I. D. 2012 Predatory fish select for coordinated collective motion
in virtual prey. Science 337, 1212–1215 (10.1126/science.1218919).
[37] Aureli, M., Fiorilli, F. & Porfiri, M. 2012 Portraits of self-organization in fish schools interacting with
robots. Physica D 241, 908 – 920 (http://dx.doi.org/10.1016/j.physd.2012.02.005).

23
Appendix A: Supplementary figures

In figure A.1, we present the milling susceptibility χm measuring the fluctuations of the milling
order parameter in the unperturbed system, and introduced in equation 7.

16

18

14

16
14

12

12
10
10
8
8
6
6
4

Milling suscepbility

Main population alignment (βm)

(a)

4

2

2

0

0
0

2

4

6
8
10
12
Main population attraction (γm)

14

16

(b)
20

16

18
16

12
14
10

12

8

10

6

8
6

Milling suscepbility

Main population alignment (βm)

14

4
4
2

2

0

0
0

2

4

6
8
10
12
Main population attraction (γm)

14

16

Supplemental Material, Figure A.1: Milling susceptibility of unperturbed fish school simulations for 100
(a) and 200 (b) fish, as calculated from equation 7 (milling fluctuations), and for different values of the
attraction and alignment parameters. Each data point represents an average over 400 simulations with
random initial conditions. The white lines following the peak of susceptibility represents the function that
fits the schooling/milling transition, as reported in [22].

24
As already seen for the polarisation susceptibility χ (see figure 2 in the main text), the milling
susceptibility χm should sharply increase near the schooling-milling transition line, but should
also be more sensitive to the narrow winding phase than the polarisation susceptibility, near the
winding-milling transition line. Indeed, this is confirmed in figure A.1(a) where the schoolingmilling transition is clearly identified (as it was by using the polarisation susceptibility), and
where the narrow winding-milling transition line is much more clearly apparent than by using the
polarisation susceptibility (compare figure 2(a) to figure A.1(a)). In addition, the weakening of
the milling susceptibility enhancement near the winding-milling transition as one increases the
number of fish N observed in figure A.1(b) (as compared to figure A.1(a)) strongly suggests that
the winding phase probably disappears for larger N , its very elongated shape making it more
unstable as N increases.
0.05

16

0.04

12
0.03
10
8

0.02

6
0.01
4
2

Difference in average polarisation

Perturbing fish alignment (βp)

14

0

N=200

0

-0.01
0

2

4

6
8
10
12
Perturbing fish attraction (γp)

14

16

Supplemental Material, Figure A.2: Each data point represents the difference in the average polarisation
caused by a single perturbing fish, while varying its attraction (γp ) and alignment (βp ) parameter, in
comparison to the unperturbed case located on the schooling region (γm = 4, βm = 14).

25

0.1

16

0
-0.1

12

-0.2
10
-0.3
8
-0.4
6
-0.5
4

Difference in average milling

Perturbing fish alignment (βp)

14

-0.6

2

N=200

-0.7

0

-0.8
0

2

4

6
8
10
Pertubing fish attraction (γp)

12

14

16

Supplemental Material, Figure A.3: Each data point represents the difference in the average polarisation
caused by a single perturbing fish, while varying its attraction (γp ) and alignment (βp ) parameter, in
comparison to the unperturbed case located on the milling region (γm = 14, βm = 4).

Appendix B: Supplementary movies

Supplemental Material, Movie B.1: Inset3.mp4 - Simulation with 100 fish where Np = 1 (red fish), γp = 1,
βp = 7 and the main population located in the transition between schooling and milling (γm = 14, βm = 10).

Supplemental Material, Movie B.2: Inset4.mp4 - Simulation with 100 fish where Np = 1 (red fish), γp = 1,
βp = 1 and the main population located in the transition between schooling and milling (γm = 14, βm = 10).

Supplemental Material, Movie B.3: Inset6.mp4 - Simulation with 100 fish where Np = 1 (red fish), γp = 14,
βp = 1 and the main population located in the transition between schooling and milling (γm = 14, βm = 10).

