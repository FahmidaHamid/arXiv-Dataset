Modeling stochastic phenotype switching and
bet-hedging in bacteria: stochastic nonlinear dynamics
and critical state identification
Chen Jia1,2 , Min-Ping Qian1 , Yu Kang3 , Da-Quan Jiang1,4,‚àó
1

LMAM, School of Mathematical Sciences, Peking University, Beijing 100871, P.R. China
2

arXiv:1311.2216v2 [q-bio.MN] 17 Jan 2015

3

Beijing International Center for Mathematical Research, Beijing 100871, P.R. China

CAS Key Laboratory of Genome Sciences and Information, Beijing Institute of Genomics,
Chinese Academy of Sciences, Beijing 100101, P.R. China;
4

Center for Statistical Science, Peking University, Beijing 100871, P.R. China
‚àó

Correspondence: jiangdq@math.pku.edu.cn

Abstract
Fluctuating environments pose tremendous challenges to bacterial populations. It is observed in numerous bacterial species that individual cells can stochastically switch among
multiple phenotypes for the population to survive in rapidly changing environments. This
kind of phenotypic heterogeneity with stochastic phenotype switching is generally understood to be an adaptive bet-hedging strategy. Mathematical models are essential to gain a
deeper insight into the principle behind bet-hedging and the pattern behind experimental
data. Traditional deterministic models cannot provide a correct description of stochastic
phenotype switching and bet-hedging, and traditional Markov chain models at the cellular
level fail to explain their underlying molecular mechanisms. In this paper, we propose a
nonlinear stochastic model of multistable bacterial systems at the molecular level. It turns
out that our model not only provides a clear description of stochastic phenotype switching and bet-hedging within isogenic bacterial populations, but also provides a deeper insight into the analysis of multidimensional experimental data. Moreover, we use some
deep mathematical theories to show that our stochastic model and traditional Markov chain
models are essentially consistent and reflect the dynamic behavior of the bacterial system
at two different time scales. In addition, we provide a quantitative characterization of the
critical state of multistable bacterial systems and develop an effective data-driven method
to identify the critical state without resorting to specific mathematical models.
Keywords: phenotypic heterogeneity, phenotypic variation, multistability, gene network,
stochastic gene expression

Introduction
Bacteria in the wild exist in ever-changing environments and have to surmount the challenges posed by environmental fluctuations. Numerous experiments have confirmed that multiple distinct phenotypes can coexist within an isogenic bacterial population [1‚Äì10]. This phenotypic heterogeneity in genetically identical cells has received increasing attention in recent
years since it could help the bacteria to survive in rapidly changing environments [11, 12].
In the framework of traditional population genetics, a bacterial population enhances its fitness
via genetic changes caused by mutation or recombination. However, extracellular conditions
can change so rapidly that adaptation only by mutation or recombination would be too slow.
One solution to this problem is to allow individual cells to stochastically switch among multiple phenotypes without genetic changes, a phenomenon widely known as stochastic phenotype
1

switching [13‚Äì18]. Generally, the multiple phenotypes within an isogenic bacterial population
result from the multiple steady-state expression levels of a group of stress-related genes. Such
kind of gene expression pattern with multiple steady-state expression levels are widely known
as multistability [3, 7].
Phenotypic heterogeneity is a widespread phenomenon in the bacterial realm. Examples
of phenotypic heterogeneity include lactose utilization in Escherichia coli [19], competence
development in Bacillus subtilis [20‚Äì22], sporulation in Bacillus subtilis [23‚Äì26], and persistence in Mycobacterium tuberculosis [27‚Äì29]. The potential function of phenotypic heterogeneity with stochastic phenotype switching is generally understood to be a bet-hedging strategy [7, 12, 30, 31], a term originating from finance. In response to fluctuating environments, a
heterogeneous bacterial population could optimize its fitness by altering the proportion of cells
in each subpopulation via stochastic phenotype switching to achieve an optimal ‚Äòinvestment
portfolio‚Äô.
To study the evolution of heterogeneous bacterial populations, a number of Markov chain
models have been proposed at the cellular level [1, 6, 14, 16, 17, 32‚Äì34]. These models assumed a priori that the bacterial population has multiple distinct phenotypes. In these models,
each phenotype is modeled as a state of the Markov chain and stochastic phenotypic switching
is modeled as the state transition of the Markov chain. However, these models take phenotypic heterogeneity and stochastic phenotypic switching for granted and fail to account for their
underlying molecular mechanisms.
Recent research has demonstrated that phenotypic heterogeneity within isogenic bacterial
populations often results from the feedback circuitry of the gene regulatory network [35, 36].
To account for the molecular mechanism of phenotypic heterogeneity, a number of deterministic models have been proposed at the molecular level [19, 22, 27, 29, 37]. In these models,
different steady states of gene expression are described as different stable fixed points (attractors) of a deterministic system composed of several ordinary differential equations which are
written down based on the regulatory relationship of the gene network. However, deterministic
models cannot provide a correct description of many important experimental phenomena, such
as stochastic phenotype switching and bet-hedging. In every deterministic model, if the expression level of an individual cell lies in an attraction basin at a particular time, it will never leave
this attraction basin and thus phenotype switching will never occur.
Although deterministic models can give rise to multiple attractors and attraction basins,
they do not allow transitions among different attraction basins. One solution to this problem is
to consider stochastic effects, which allow the system to transition among different attraction
basins and thus drive stochastic phenotype switching. This fact is analogous to the simulated
annealing techniques in optimization problems, in which noise is indispensable to make the
search escape from the trap of local minimum points and reach the global minimum point. In
order to better understand the role that stochastic effects play in bistable systems, Qian and
coworkers studied the relations between deterministic and stochastic nonlinear dynamics in
great detail [38‚Äì43]. However, their models are usually so abstract and oversimplified that they
cannot be directly applied to practical problems with experimental data and observations.
Stochastic effects are extremely important not simply because they are indispensable for the
model to generate phenotype switching, but because gene expression is an inherently stochastic process. Recent developments of single-cell and single-molecule experiments have shown
that many important cellular processes, such as transcription, translation, replication, and gene
regulation, are inherently stochastic [44‚Äì53]. Due to stochastic effects, the expression levels of
the stress-related genes in a multistable system will have a multimodal distribution.
2

In this paper, we propose a unified nonlinear stochastic model of multistable bacterial systems at the molecular level based on a core double-positive-feedback gene network. By studying
its stochastic nonlinear dynamics, we show that our model not only provides a clear description
of phenotypic heterogeneity, stochastic phenotype switching, and bet-hedging within isogenic
bacterial populations, but also provides a deeper insight into the analysis of multidimensional
experimental data, such as gene expression data and the data of more comprehensive indicators
like the forward scatter (FSC) and the side scatter (SSC) measured by flow cytometry.
Next, we use the mathematical tool of large deviation theory established by Freidlin and
Wentzell [54] to show that every multistable dynamical system under a small random perturbation can be approximated by a Markov chain with multiple states, each corresponding to an
attraction basin of the multistable system. In this way, our stochastic model at the molecular
level can be reduced to a Markov chain model at the cellular level. This justifies the wide applications of previous Markov chain models of population evolution, in particular, the Markov
chain model proposed by Lander and coworkers [33] about the dynamics of the phenotypic
proportions in human breast cancer cell lines.
In addition, we point out a widespread misunderstanding on the analysis of gene expression data, inspired by our recent work about antibiotic resistance in Escherichia coli. Previous
studies tended to think that phenotypic heterogeneity can be identified by the multistable expression of a single pivotal gene (reviewed in [2, 7]). However, phenotypic heterogeneity in
bacterial populations often results from the interaction of a group of stress-related genes. We
use simulation results to show that in many cases, the expression data of a group of genes give
rise to an apparent multimodal distribution, however, we cannot observe the multistable expression if we only focus on the expression data of a single gene. This suggests that the traditional
method to identify phenotypic heterogeneity by measuring the expression of a single pivotal
gene is sometimes ineffective.
Finally, we use our stochastic model to provide an answer to the important question of
identifying the critical state of multistable bacterial systems. In our stochastic model, there is
a saddle lying on the boundary of two adjacent attraction basins which characterizes a critical
state between two steady states of gene expression. The critical state is not targeted in the
previous work since it is rarely observed in experiments and cannot be estimated by simple
statistical analysis of gene expression data. However, the identification of the critical state has
drawn increasing attention in recent years since it is closely related to the early diagnosis of
complex diseases [55, 56]. In this paper, we develop an effective method to identify the critical
state of multistable bacterial systems using the time-course data of gene expression without
resorting to specific mathematical models.

Model
In natural bacterial systems, phenotypic heterogeneity and stochastic phenotype switching
always originate from the feedback circuitry of the regulatory network which governs a group
of stress-related genes. In order to better understand the general principles behind phenotypic
heterogeneity, we illustrate the gene regulatory networks that govern some best-understood
multistable systems in bacteria (Fig. 1(a)-(d)). A crucial similarity shared by these examples is
that the wiring of the gene regulatory network forms a double-positive-feedback loop. In order
to establish a unified model of these bacterial systems, we focus on the core double-positivefeedback gene network depicted in Fig. 1(e), where, protein X is the product of a pivotal stressrelated gene, i.e., gene X , protein Y is a transcription factor which activates the expression of
3

gene X , and A is an inducer whose concentration reflects the fluctuations in extracellular environmental conditions, such as fluctuations in temperature, pH, and concentrations of nutrients
and toxins [23, 27].

(a)

(b)

Glucose IPTG

quorum sensing

ComS

cAMP

IPTG

CRP

Lac I

ComK

Rok

Lac Y

mRNA
comK

lac operon

(e)

TF

output

inducer

Y

X

A

gene X

(c)

(d)

enviornmental
signals
Phosphorelay

SigH

Spo0A-P

Spo0A

tetracycline

Rel
MprA-P

AbrB

poly-P
MprA

MprB-P

MprB

mprAB

spo0A

Figure 1. Schematic models of bacterial systems with phenotypic heterogeneity. a-d. Examples of
naturally occurring bacterial systems with phenotypic heterogeneity. a. Lactose utilization in E. coli
[19]. b. Competence development in B. subtilis [20]. c. Sporulation in B. subtilis [23]. d. Persistence
in M. tuberculosis [29]. e. The core double-positive-feedback gene network shared by a-d. X (red) is
the product (protein or mRNA) of a pivotal stress-related gene. Y (blue) is a transcription factor which
activates the expression of gene X. A (green) is an inducer whose concentration reflects extracellular
environmental conditions.

We use lowercase letters x, y , and a to denote the concentrations of X, Y, and A, respectively. Since gene expression is an inherently stochastic process, the dynamics of x and y can be
described by the following two-dimensional system of stochastic differential equations (SDEs):
‚àö
(
xÃá = ‚àíŒ±(x ‚àí F (a, y)) + 2Œæx ,
(1)
p
yÃá = ‚àíŒ≤(y ‚àí G(x)) + 2Œ∑Œæy ,
where F (a, y) describes the activation of protein X by inducer A and protein Y, G(x) describes
the activation of protein Y by protein X, and Œ± and Œ≤ are two parameters characterizing the
response speeds of proteins X and Y, respectively. In addition, Œæx and Œæy are two independent
standard white noises satisfying hŒæx (t)i = hŒæy (t)i = 0 and hŒæx (t)Œæx (t0 )i = hŒæy (t)Œæy (t0 )i =
Œ¥(t0 ‚àí t). Since the fluctuations in the levels of proteins X and Y can be different, we use
two noise levels  and Œ∑ to describe their stochastic fluctuations. We emphasize here that noise
in gene regulatory networks generally comes from a great number of sources and may not be
subsumed into white noises. Fortunately, the specific noise distributions will hardly affect the
4

main results of this paper. To make our discussion friendly to both theoretical and experimental
biologists, we would like to use white noises to describe noise in gene expression. For the
rationality of this assumption, please see Discussion.
If we ignore stochastic effects, then the stochastic system (1) can be reduced to the following deterministic system as the two noise levels,  and Œ∑ , tend to zero:
xÃá = ‚àíŒ±(x ‚àí F (a, y)), yÃá = ‚àíŒ≤(y ‚àí G(x)).

(2)

We note that the fixed points of this deterministic system are the solutions to the following
equations: x ‚àí F (a, G(x)) = 0 and y = G(x). In natural bacterial systems, the most common
expression of F (a, G(x)) has the following form (see Supplementary Information):
F (a, G(x)) =

Œ≥xn
+ (¬µa + Œ¥),
K + xn

(3)

where the Hill function Œ≥xn /(K +xn ) with n > 1 describes the activation of gene X by protein
Y, the term ¬µa describes the activation of protein X by inducer A, and the term Œ¥ describes a
basal expression level of gene X independent of the activation of protein Y.
It turns out that the deterministic system (2) has one or three fixed points under different
inducer concentrations (Fig. 2(a)). To be specific, the inducer concentration a has two threshold
levels, a0 and a1 . If a < a0 or a > a1 , the system has only one fixed point (Fig. 2(a)). If
a < a0 , the only attractor (xL , yL ) describes the phenotype of low-expressing cells in which
gene X is inactivated. If a > a1 , the only attractor (xH , yH ) describes the phenotype of highexpressing cells in which gene X is activated. If a0 < a < a1 , however, the system has
three fixed points, including two attractors, (xL , yL ) and (xH , yH ), and a saddle (xM , yM )
(Fig. 2(a),(b)), where the two attractors describe the phenotypes of low- and high-expressing
cells, respectively, whereas the saddle is a critical state between the two steady states of gene
expression. Mathematically, each attractor of a deterministic system has an attraction basin,
and two adjacent attraction basins are separated by a boundary (Fig. 2(b)).

Results
Phenotypic heterogeneity and bet-hedging
In the recent decade, single-cell and single-molecule experiments have made significant
progresses and shown that gene expression is an inherently stochastic process. Although deterministic models, such as the deterministic system (2), can give rise to multiple attractors and
attraction basins, they cannot provide a correct description of stochastic phenotype switching
and bet-hedging. These two facts show that the reduction from the stochastic system (1) to the
deterministic system (2) is inappropriate.
In the following discussion, we focus on the stochastic system (1) in which the two noise
levels,  and Œ∑ , are strictly positive. Although the system does not satisfy detailed balance, we
can still obtain an approximate steady-state probability distribution ps (a, x, y) of the system
(see Supplementary Information), which has the following form:


1
1
ps (a, x, y) = exp ‚àí U (a, x, y) ,
(4)
Z

where Z is a normalization constant and U (a, x, y) is an approximate global potential, also
called landscape, of the system defined as
Z x
Œ≤
2
U (a, x, y) =
(y ‚àí G(x)) + Œ±
(u ‚àí F (a, G(u))du.
(5)
2Œ∑
0
5

We make a crucial observation that the fixed points of the deterministic system (2) are exactly the solutions to the equation ‚àÇx U (a, x, y) = ‚àÇy U (a, x, y) = 0. This shows that the attractors of the deterministic system are the local minimum points of the approximate global potential U (a, x, y) and thus are the local maximum points of the steady-state distribution ps (a, x, y).
From Fig. 2(c)-(e), we see that the steady-state distribution of the levels of proteins X and Y is
controlled by the inducer concentration a. If a < a0 , the steady-state distribution has only the
left peak, suggesting that the bacterial population contains almost exclusively low-expressing
cells under favorable conditions (Fig. 2(c)). If a0 < a < a1 , the steady-state distribution has
both the left and right peaks, each corresponding to a phenotype. With the increase of the inducer concentration, a larger fraction of cells will switch from the low- to the high-expressing
subpopulation to maximize survival (Fig. 2(d)). If a > a1 , the left peak of the steady-state
distribution disappears, suggesting that the bacterial population contains almost exclusively
high-expressing cells under unfavorable conditions (Fig. 2(e)). The above discussion clearly
explains how the bet-hedging strategy could help the bacterial population better adapt to rapidly
changing environmental conditions.
Generally, the steady-state gene expression levels in a multistable bacterial system have
a multimodal distribution, which can be viewed as the superposition of multiple monomodal
distributions, each concentrated within an attraction basin. The attractors are the locally mostprobable states and thus are most likely to be observed in experiments. Based on the stochastic
system (1), we simulate the time course of the levels of proteins X and Y in a single cell (Fig. 2
(b)). The simulation result shows that the gene expression data are generally distributed around
the attractors and are rarely distributed around the boundary of the attraction basins. These
facts clearly show that each phenotype of a bacterial population cannot be simply described as
an attractor of the deterministic model, but should be understood as a monomodal distribution
concentrated within an attraction basin.

A widespread misunderstanding on the analysis of gene expression data
Phenotypic heterogeneity in isogenic bacterial populations often results from the interaction
of a group of stress-related genes and biochemical species. Previous studies tended to think that
phenotypic heterogeneity can be identified by the multistable expression of a single pivotal gene
(reviewed in [2, 7]). In experiments, however, it often happens that the steady-state expression
data of a single gene does not display a multimodal distribution, and only when a subpopulation
of cells are sorted out to start from some extreme initial conditions, the multimodal distribution
can be observed at certain times before reaching the steady state. Thus it is rather difficult to
determine whether the bacterial population has multiple phenotypes or not. To explain these
experimental phenomena, we point out that phenotypic heterogeneity often results from the
interaction of a group of stress-related genes and may not be observed if we only focus on the
expression data of a single gene. In our recent study about antibiotic resistance in Escherichia
coli (unpublished work), we found that the expression data of the hydrolase gene only lead to a
monomodal distribution, whereas the expression data of a group of stress-related genes lead to
an apparent multimodal distribution.
We now use our stochastic model to account for this interesting phenomenon. Based on
the stochastic system (1), we simulate the steady-state levels of proteins X and Y in 500,000
virtual cells under a set of model parameters (Fig. 2(f)). From the simulation result, we see
that the two-dimensional gene expression data are distributed around two attractors in the phase
plane and lead to a bimodal distribution, which can be viewed as the superposition of two

6

(a)

(b)
1.4

a < a0
a0 < a < a1
a > a1

0.6

0.8

1

level of protein X

1.4
1.2 y = x - (Œºa+ Œ¥)
1
0.8 y = Œ≥xn /(K+xn)
0.6
0.4
0.2
0
-0.2
-0.4
-0.6
0
0.2 0.4

1.2

1.2

aractor

1

boundary
0.8

most-probable
path
saddle

0.6
0.4
0.2 aractor
0

1.4

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

level of protein Y

(f)

(c)

1.4
30

a<a0

10
0

a0<a<a1

12
8

a0<a<a1

a0<a<a1

(e) 30
20

0.6
0.4
0.2
0

a>a1

10
1 1.5
0
0.5 ein X
-0.4 -0.2 0 0.2 0.4
0
t
0.6 0.8 1 -0.5
pro

level of protein Y

lo
leve

f

1.05 1.1

level of protein Y

(g)

4
0
20
15
10
5
0

1
0.8

-0.2
0.7 0.75 0.8 0.85 0.9 0.95 1

steady-state distribuon

steady-state distribuon

(d) 20
15
10
5
0

1.2

level of protein X

20

4

7x 10
6
5
4
3
2
1

0
0.7 0.75 0.8 0.85 0.9 0.95 1

1.05 1.1

level of protein Y

Figure 2. Stochastic description of multistability. a. Numbers of fixed points under different inducer
concentrations. The curve represents the Hill function y = Œ≥xn /(K + xn ) and the lines represent the
function y = x ‚àí (¬µa + Œ¥). The intersections of the curve and the line give the positions of the fixed
points. b. The simulation data of the time course of the levels of proteins X and Y in a single cell.
When a0 < a < a1 , the deterministic model has three fixed points, including two attractors and a saddle,
which lies on the boundary of two attraction basins. The expression levels of the cell stay around the
two attractors at most times and cross the boundary around the saddle. c-e. The steady-state probability
distribution of the levels of proteins X and Y. c. When a < a0 , the steady-state gene expression levels
have a monomodal distribution, which attains its unique maximum at the attractor (xL , yL ). d. When
a0 < a < a1 , the steady-state gene expression levels have a bimodal distribution, which attains two
maxima at both the two attractors, (xL , yL ) and (xH , yH ). e. When a > a1 , the steady-state gene
expression levels have a monomodal distribution, which attains its unique maximum at the attractor
(xH , yH ). f. The simulation data of the steady-state levels of proteins X and Y in 500,000 virtual cells
under a set of model parameters. The two-dimensional gene expression data are distributed around two
attractors and thus lead to an apparent bimodal distribution. g. The marginal distribution of the level
of protein Y based on the two-dimensional gene expression data. The blue and red curves represent the
marginal distributions of low- and high-expressing cells, respectively, and the black curve represents the
marginal distribution of all cells. There is an obvious overlap between the marginal distributions of lowand high-expressing cells, resulting in a monomodal overall marginal distribution.

7

monomodal distributions. Although these two monomodal distributions are concentrated within
two different attraction basins in the phase plane, there is an obvious overlap between their
marginal distributions, whose superposition, which represents the steady-state distribution of
the level of protein Y, has only one peak (Fig. 2(g)). This suggests that the traditional idea
to identify phenotypic heterogeneity by the multistable expression of a single pivotal gene is
sometimes ineffective. The above discussion also shows that our stochastic model can help us
gain a deeper insight into the pattern behind multidimensional experimental data.

From the molecular level to the cellular level
We have seen that our stochastic model provides a clear description of phenotypic heterogeneity and bet-hedging within isogenic bacterial populations at the molecular level. However,
more widely used models in the previous work are Markov chain models at the cellular level.
These models assume a priori that the bacterial population has multiple distinct phenotypes,
each of which corresponds to a state of the Markov chain and can switch to other phenotypes
with certain transition rates. This raises the question of whether the two kinds of models, our
stochastic model at the molecular level and the Markov chain models at the cellular level, are
consistent in some way or not. We now use the mathematical tool of large deviation theory
established by Freidlin and Wentzell [54] to answer this question.
The Freidlin-Wentzell theory is mainly concerned about the dynamic behavior of a multistable dynamical system under random perturbations, such as the stochastic system (1), when
the noise level is not too large. The conclusions of the Freidlin-Wentzell theory are not very
intuitive at first sight and the proofs of them are rather tedious. Readers who are interested
in the mathematical aspects of the Freidlin-Wentzell theory may refer to [54, 57]. To make
readers understand this useful mathematical tool, we would like to list the major results of the
Freidlin-Wentzell theory as follows.
Basic Result 1. No matter how small the noise level is, the accumulation of the stochastic forces
will make the system escape from the trap of an attraction basin and enter another attraction
basin. Before the system escapes from an attraction basin, it will spend most of the time staying
around the attractor and spend little time staying around the boundary of the attraction basin.
These facts can be seen from our numerical simulation in Fig 2(b) and Fig. 3(a).
Basic Result 2. Each point x in an attraction basin has a local potential V (x) called the quasipotential. If the system has a global potential U (x), as in Equation (5), then the quasi-potential
V (x) can be calculated explicitly as
V (x) = 2(U (x) ‚àí U (x0 )),

(6)

where x0 is the attractor in this attraction basin. When the system escapes from one attraction
basin to another, it must cross the boundary around a specific point y0 where the quasi-potential
attains its minimum. In most cases, the minimum point y0 of the quasi-potential on the boundary
is exactly the saddle of the system. These facts can be seen from our numerical simulation in
Fig. 2(b).
Basic Result 3. The time needed for the system to escape from an attraction basin is referred
to as the escape time. The escape time T from an attraction basin approximately follows an
exponential distribution. The mean escape time hT i, which is approximately the time constant
of the exponential distribution, has the form of


1
.
hT i = k exp
V0 ,
(7)
2
8

where k is a positive constant,  is the noise level, and V0 = V (y0 ) is the minimum value of the
quasi-potential on the boundary. By Basic Result 2, if the system has a global potential U (x),
then V0 /2 = U (y0 ) ‚àí U (x0 ), which represents the potential difference between the minimum
point y0 of the potential on the boundary and the attractor x0 . These facts can be seen from our
mathematical derivations in Supplementary Information.
It is a well-known result that the time needed for a Markov chain to make a state transition
follows the exponential distribution. The Freidlin-Wentzell theory tells us that the escape time
from each attraction basin approximately follows an exponential distribution. This shows that if
we combine each attraction basin into a state, then the stochastic system with multiple attractors
can be approximated by a Markov chain with multiple states at the time scale of exp(1/).
When the noise level  is small, exp(1/) becomes very large. This shows that the approximate
Markov chain reflects the large-time-scale dynamic behavior of the stochastic system.
According to the above discussion, each stochastic model of a multistable system at the
molecular level can be reduced to a Markov chain model at the cellular level. These two kinds
of models at two different levels are essentially consistent and reflect the dynamic behavior of
the system at two different time scales. For instance, the stochastic model (1) proposed in this
paper has two attraction basins when a0 < a < a1 , and thus can be approximated by a Markov
chain model with two states, each corresponding to a phenotype. If the feedback architecture
of the gene network becomes more complicated, then the stochastic system may possess three
or more attraction basins and thus can be approximated by a Markov chain model with three or
more states. For examples of Markov chain models with two, three, or four states, readers may
refer to [16, 17, 33].

Stochastic phenotype switching
To survive in rapidly changing environments, a heterogenous bacterial population may allow individual cells to stochastically switch among multiple phenotypes, ensuring that some
cells are always prepared for an unforeseen environmental fluctuation. This kind of phenotype
switching is stochastic and temporary: An individual cell may switch to an alternative state at a
random time and switch back again after some random time. Even without a significant change
in environmental conditions, stochastic phenotype switching still exists. Stochastic phenotype
switching has been observed in a wide range of bacterial species. As an example, upon encountering nutrient limitation, a minority of Bacillus subtilis cells transiently enter the competent
state with the capability for DNA uptake from the environment before returning to vegetative
growth [20].
To better understand the principle behind stochastic phenotype switching, we simulate the
time course of the level of protein X in an individual cell based on the stochastic system (1) (Fig.
3(a)). The simulation result shows that the cell switches between the low- and high-expression
states at certain random times. The Freidlin-Wentzell theory shows that the escape times TL
and TH from the low- and high-expression states approximately follow exponential distributions. The mean escape times, hTL i and hTH i, have the following form (see Supplementary
Information and Basic Result 3):


2œÄ
1
.
hTL i = ‚àö
exp
‚àÜUL ,
Œ∫L Œ∫M



(8)
2œÄ
1
.
hTH i = ‚àö
exp
‚àÜUH
Œ∫H Œ∫M

9

where ‚àÜUL and ‚àÜUH are the potential differences between the saddle and the two attractors
(Fig. 3(c)) and Œ∫L , Œ∫M , and Œ∫H are the curvatures of the one-dimensional effective potential
U (a, x, G(x)) at xL , xM , and xH , respectively. At the time scale of exp(1/), the dynamic
behavior of the stochastic system (1) can be approximated by a Markov chain model with two
states (Fig. 3(b)).

(a)

(b)
1.4

TH

Gene expression

1.2

high-expression state

1
0.8
0.6
0.4

low-expression state

0.2
0
-0.2
0

200

TL

400

600

800

1000

Time

(c)

(d)
noise level Œµ = 0

ŒîUL

noise level Œµ > 0

ŒîUH

Figure 3. Stochastic phenotype switching driven by stochastic forces. a. The simulation data of the
time course of the level of protein X in a single cell. The cell switches between the low- and highexpression states at certain random times. b. The simplified dynamics of the stochastic system (1) as a
two-state Markov chain. c. The steady-state behavior of the system when the noise level  is zero. The
curve represents the one-dimensional effective potential U (a, x, G(x)). If the low-expressing cells are
sorted out at a particular time, then all cells will stay in the low-expression state forever and phenotype
switching is impossible. d. The steady-state behavior of the system when the noise level  is positive.
The accumulation of stochastic forces will drive individual cells to surmount the potential barrier and
make a state transition.

According to Equation (8), the mean escape time is an exponential function of the potential
barrier. The higher the potential barrier, the longer time is needed for a cell to make a state
transition. Equation (8) also shows that the mean escape times have the time scale of exp(1/).
This suggests that stochastic phenotype switching is a large-time-scale dynamic behavior of the
system. When the noise level  is small, the escape time may be longer than the time of cell
division. For a fraction of cells, stochastic phenotype switching may not occur in a single cell
cycle, and thus they can pass their phenotypic state to the next generation.
If there were no stochastic effects, the phenotype of each individual cell would never
change. Specifically, if the low-expressing cells are sorted out at a particular time, then all
cells will stay in the low-expression state forever and phenotype switching is impossible (Fig.
3(c)). In the presence of stochastic effects, however, the accumulation of stochastic forces will
drive individual cells to surmount the potential barrier and make a state transition (Fig. 3(d)).

10

This suggests that stochasticity in gene expression is the driving force for stochastic phenotype
switching.

Importance of the critical state
We have seen that at certain ranges of the inducer concentration, the two attractors of the
stochastic system (1) are separated by a boundary, forming two attraction basins. The saddle
of the system lies exactly on the boundary of the two attraction basins (Fig. 2(b)) and thus
characterizes a critical state between the two steady states of gene expression. This saddle
is not targeted in the previous work since it is rarely observed in experiments and cannot be
estimated by simple statistical analysis of gene expression data. However, the identification
of the critical state has drawn increasing attention in recent years due to the following three
reasons.
First, the saddle represents a critical level of gene expression. Recent studies on complex
diseases show that any disease progression can be divided into a normal state, a pre-disease
state, and a disease state [55, 56], similar to the low-expression state, the critical state, and the
high-expression state described in this paper. Once the expression levels of the disease-related
genes in a person is close to the saddle, we have good reasons to believe that this person is in a
pre-disease state and is at high risk of disease progression. This suggests that the identification
of the critical state is closely related to the early diagnosis of complex diseases.
Second, the saddle is the most important point on the boundary of two adjacent attraction
basins. According to the Freidlin-Wentzell theory, when the system escapes from one attraction
basin to another, it must cross the boundary around a specific point where the quasi-potential
attains its minimum. To see this, we simulate the time course of the levels of proteins X and Y
in an individual cell based on the stochastic system (1) (Fig. 2(b)). The simulation result shows
that the protein levels of the cell stay around the attractors at most times and cross the boundary
of two attraction basins around the saddle, which is exactly the minimum point of the potential
U (a, x, y) on the boundary.
Third, the saddle characterizes a critical state of the transition between multiple attraction
basins. In order to accomplish stochastic phenotype switching, the system needs first to climb
up the potential from one attractor to the saddle, and then to fall down the potential from the
saddle to another attractor. Before reaching the saddle, the accumulation of stochastic forces
will drive the system to climb up the potential against the potential gradient. This process in
general will take rather a long time. Once the system crosses the saddle, it will reach another
attractor along the potential gradient in a very short time. This shows that the dynamic features
of a multistable system before and after reaching the saddle are totally different. To be more
precise, let Tu denote the time needed for the system to climb up the potential and let Td
denote the time needed for the system to fall down the potential. The Freidlin-Wentzell theory
shows that the ratio of Tu to Td has the time scale of exp(1/). This suggests that the process
of climbing up the potential is much longer than that of falling down the potential, which is
consistent with the old saying: Diseases come on horseback, but go away on foot.

Identification of the critical state
The critical state of a multistable system is important in many ways. Thus it is natural to
ask whether we can identify the critical state in an effective way based on the noisy data of
gene expression. Recently, Chen et al. [58] have developed a method of identifying the leading
network in complex diseases by evaluating a kind of network entropy, and Gore et al. [59] have
11

used generic statistical indicators to provide early warning signals for catastrophic collapse
in the budding yeast population. Inspired by their ideas, in this section, we shall develop an
effective method to identify the critical state of a multistable system using the time-course data
of gene expression. Moreover, we shall validate the effectiveness of our method through both
theoretical derivations and numerical simulation.
We have seen that at certain ranges of the inducer concentration, the pivotal gene, gene
X, has two steady-state expression levels, xL and xH , and a critical expression level xM . We
assume that we have measured the level of protein X in each individual cell within a bacterial
population at two times, t and t + h, where the interval h of two successive measurements is
chosen to have the time scale of 1/, which is much shorter than the time scale exp(1/) of
stochastic phenotype switching. Intuitively, if the protein level in an individual cell is around
xL or xH at time t, then the protein level at time t + h should be also around xL or xH since the
interval h is much shorter than the time needed for stochastic phenotype switching (Fig. 4(a)).
However, if the protein level in an individual cell is around xM at time t, then the protein level
at time t + h will become rather scattered since the critical state is rather unstable (Fig. 4(a)).
Let x(t) denote the level of protein X at time t, whose value can differ significantly between
two individual cells. The above discussion illuminates us to define the variance D(x) at x as
the variance of x(t + h) conditioned on the information of x(t) = x. More precisely, we define
the variance D(x) at x as
D(x) = Variance(x(t + h)|x(t) = x),

(9)

where Variance(Z) = h(Z ‚àí hZi)2 i is the variance of the random variable Z . According to
the above discussion, the variance D(x) around xL or xH should be small since the distribution
of x(t + h) will be rather concentrated if x(t) is around xL or xH , whereas the variance D(x)
around xM should be large since the distribution of x(t + h) will be rather scattered if x(t) is
around xM . This suggests that we may detect the critical state by seeking the maximum point
of the variance function D(x).
We next validate the above intuitive discussion from the theoretical point of view. In fact,
the theoretical expression of the variance function D(x) has the following form (see Supplementary Information):


pL (x) pH (x)
.
2
D(x) = (xH ‚àí xL ) pL (x)pH (x) + 
+
,
(10)
Œ∫L
Œ∫H
where pL (x) and pH (x) are two functions (see Supplementary Information for specific expressions) satisfying pL (x) + pH (x) = 1. We denote the maximum point of the variance function
D(x) by xmax . By Equation (10), we can easily see that xmax satisfies
pH (xmax ) =

1
(Œ∫L ‚àí Œ∫H )
+
.
2 2(xH ‚àí xL )2 Œ∫L Œ∫H

(11)

In order to find the location of the maximum point xmax , we depict the graph of the function
pH (x) in Fig. 4(b), from which we see that the function pH (x) is sigmoidal with a critical
transition around xM . With the decrease of the noise level , the slope of the function pH (x)
at xM tends to infinity. This fact, together with Equation (11), indicates that when the noise
level  is small, the maximum point xmax of the variance function D(x) is very close to xM .
This suggests that the variance function D(x) may provide a clear signal for the position of the
critical state.

12

protein level at me t+h

decease of Œµ

(b)

(a)
1.2
1
0.8

p

0.6
0.4
0.2
0
0.2 0.3 0.4 0.5

0.7 0.8 0.9

crical state

1

1
0.9
0.8
0.7
0.6
H 0.5
0.4
0.3
0.2
0.1
00.2 0.3 0.4 0.5

protein level at me t

1

level of protein X

(c)

(d)
0.16

1.5

0.14

variance funcon

0.7 0.8 0.9

crical state

1

0.12
0.5

0.1
0.08

0

0.06

x(0)
x(h)

-0.5

x(0)

x(h)

0.04
-1

0.02
00.2 0.3 0.4 0.5

0.7 0.8 0.9

crical state

-1.5-2

1

-1.5 -1

-0.5

0

0.5

1

1.5

2

level of protein X
Figure 4. Identification of the critical state. a. The simulation result of the level of protein X at two
times, t and t+h, for an ensemble of 760 samples. The samples at time t+h are rather concentrated if the
protein level is around xL or xH at time t, whereas those are rather scattered if the protein level is around
xM at time t. b. The graph of the function pH (x). The function pH (x) experiences a critical transition
around the critical state xM . With the decrease of the noise level , the slope of the function pH (x) at xM
tends to infinity. c. The variance function D(x). The variance D(x) at x is defined as the variance of the
level of protein X at time t + h conditioned on the information that the protein level equals x at time t.
The blue line represents the theoretical curve of the variance function and each red circle represents the
simulation result based on the simulated dynamics of 300 virtual cells. The variance function changes
slowly around the stable fixed points, xL and xH , and experiences a drastic change around the critical
state xM . d. A multistable stochastic system with periodic orbits. The lines with arrows give the phase
portrait the system. The origin (0,0) (orange dot) is the unique critical point (saddle) of the system. The
system has many periodic orbits inside and outside the two homoclinic orbits. We simulate the dynamics
of the system at time h = 3.5 for an ensemble of 60 samples under two different initial values (red
and orange dots). The green dots represent the samples at time h when the system starts from the point
(-1,0.45) (red dot) on a periodic orbit and the blue dots represent the samples at time h when the system
starts from the critical point (orange dot).

A natural and important question is that whether we can estimate the variance function
D(x) from the noisy data of gene expression. The answer is of course affirmative. Recent experimental techniques such as fluorescent labeling and microfluidic devices allow us to measure
the expression level of the pivotal gene in each individual cell within a bacterial population at
a series of times t1 , ¬∑ ¬∑ ¬∑ , tm with interval h. We assume that the experimental data of the n-th
cell have the form of x(n, t1 ), ¬∑ ¬∑ ¬∑ , x(n, tm ), where x(n, ti ) represents the expression level of
the n-th cell at time ti . For each time ti , if x(n, ti ) is in a given small neighborhood of x, we
pick out its next datum x(n, ti+1 ), whereas if x(n, ti ) is not in the given small neighborhood

13

of x, we throw away its next datum. By evaluating the sample variance of those data which are
picked out, we can obtain a good estimation of the variance D(x) at x.
To validate the effectiveness of our method, we simulate the time course of the level of
protein X in 4800 virtual cells based on the stochastic model (1) and estimate the variance D(x)
at several discrete levels of x (red circles in Fig. 4(c)), from which we see that the simulation
result coincides perfectly with the theoretical result (blue line in Fig. 4(c)). Moreover, we see
that the variance function D(x) changes drastically around xM , whereas there is no significant
change in D(x) around xL and xH (Fig. 4(c)). This suggests that our method is effective in
detecting the critical state of a multistable system using the noisy data of gene expression, even
if no detailed mathematical model is available.
Before leaving this section, we would like to point out that our method of identifying the
critical state is not only effective in simple multistable systems with stable fixed points, but also
effective in complicated multistable systems with periodic orbits or stable limit cycles, in which
case the time-course data of the system will oscillate. To see this, we consider the following
two-dimensional system of SDEs:
‚àö
(
xÃá = y + 2Œæx ,
(12)
p
yÃá = ‚àíx3 + x + 2Œ∑Œæy ,
where  and Œ∑ are two noise levels and Œæx and Œæy are two independent standard white noises. If
 = Œ∑ = 0, then the stochastic system is reduced to a deterministic system whose phase portrait
is illustrated in Fig. 4(d). The origin (0,0) (orange dot) is the only saddle and thus is the only
critical point of the system. Interestingly, the stable and unstable manifolds at the critical point
match up exactly, forming two homoclinic orbits. Moreover, the system has many periodic
orbits inside and outside the two homoclinic orbits.
In order to see whether our method can be applied to identify the critical point of the
stochastic system (12), we simulate the dynamics of the system at time h = 3.5 for an ensemble
of 60 samples under two different initial values (red and orange dots) (Fig. 4(d)). The simulation
result shows that the samples at time h (green dots) are rather concentrated if the system starts
from the point (-1,0.45) (red dot) on a periodic orbit, whereas the samples at time h (blue dots)
become rather scattered if the system starts from the critical point (orange dot). This suggests
that the variance at the critical point is much larger than the variances at the points lying on
the periodic orbits. Accordingly, we see that our method of identifying the critical state by
seeking the maximum point of the variance function may be applied to various complicated
multistable systems, not restricted to simple multistable systems with stable fixed points, such
as the stochastic system (1).

Discussion
Comparison with the previous work
Multistability in biological systems has been widely studied in recent two decades and it
has become an important recurring theme in cell signaling. In this paper, we study a class of
multistable biological systems, i.e., heterogeneous bacterial populations with stochastic phenotype switching and also provide a data-driven method to identify the critical state of multistable
bacterial systems. In recent literature, an influential paper about multistability is the paper of
Angeli, Ferrell, and Sontag [60], who studied a large class of biological systems with positive
feedbacks and also provided a method of detecting bistability, bifurcations, and hysteresis in
14

these systems. The themes of their paper is closely related to ours. Thus we find it necessary to
discuss the similarities and differences between their paper and ours.
First, both the paper of Angeli et al. and ours studied multistability in biological systems
with a positive-feedback network. Recent studies show that multistability always arises in biological systems that contain a positive-feedback loop and it has been proved that the existence of
at least one positive-feedback loop is a necessary condition for the existence of multiple steady
states [61‚Äì63]. In our paper, we show that phenotypic heterogeneity in bacterial populations
often results from the underlying double-positive-feedback gene networks, which is consistent
with the above theoretical results.
Second, the paper of Angeli et al. studied the deterministic nonlinear dynamics of multistable biological systems and our paper studies the stochastic nonlinear dynamics of heterogenous bacterial populations. In fact, deterministic models may lead to phenotypic heterogeneity,
but they cannot explain the widely observed phenomena of stochastic phenotype switching and
bet-hedging. In our paper, we use our stochastic model to provide a clear description of stochastic phenotype switching and bet-hedging within heterogenous bacterial populations and study
the role that stochastic effects play in generating these important experimental phenomena.
Third, in the paper of Angeli et al., the relationship between the deterministic model of
multistable systems and the widely used Markov chain model of population evolution is not
clear. In our paper, we use the Freidlin-Wentzell theory to show that our stochastic model at
the molecular level can be approximated by a Markov chain model at the cellular level, which
reflects the large-time-scale dynamics of multistable bacterial systems, when the noise level is
small. It turns out that only by considering the stochastic dynamics of multistable bacterial
systems can we unify the models at the two different levels.
Fourth, the paper of Angeli et al. provided a possible method to detect multistability and
bifurcations in a class of multistable systems satisfying the so-called ‚Äúmonotonicity‚Äù and ‚Äúopenloop steady-state response‚Äù assumptions. Their method strongly depends on the properties of
the system when the feedback is blocked. In order to detect multistability and bifurcations, the
response data of the open-loop, feedback-blocked system to input stimuli must be obtained.
This requirement is obvious too strong for realistic biological systems. In our paper, however,
we provide an effective data-driven method to identify the critical state of multistable biological
systems. In our method, only the time-course data of gene expression in individual cells are
needed, even if no detailed mathematical model is available.

Rationality of our stochastic model
In our stochastic model, we have used white noises with two different noise levels to describe the stochastic fluctuations in proteins X and Y, respectively. In this subsection, we shall
explain the rationality of this assumption. The content of this section is somewhat technical.
Readers who are unfamiliar with the knowledge of stochastic processes can skip this part.
In fact, the most precise model of the gene network in living cells is the chemical master
equation (CME) [64]. Mathematically, the CME is the equation satisfied by the probability
distribution of a Markov jump process which describes the copy number fluctuations of all
participating macromolecules in the gene network. However, the dimension of the CME model
is often so high that the theoretical expressions of many important quantities related to the
system cannot be explicitly calculated. This makes the CME model difficult to be directly
applied to practical problems with experimental data and observations.
In order to simplify the CME model, Kurtz [65‚Äì67] proved in his pioneering work that every

15

CME model can be approximated reasonably well by the so-called chemical Langevin equation
when the volume of the system is large. Mathematically, the chemical Langevin equation [68]
is the equation satisfied by the probability distribution of an SDE model which describes the
concentration fluctuations of all participating macromolecules in the gene network. To be more
precise, we assume that there are n macromolecules involved in the gene network whose concentrations are denoted by x1 , x2 , ¬∑ ¬∑ ¬∑ , xn . The general form of an SDE model which governs
x1 , x2 , ¬∑ ¬∑ ¬∑ , xn is given by
xÃái = bi (x) +

‚àö

2i

n
X

œÉij (x)Œæj ,

i = 1, 2, ¬∑ ¬∑ ¬∑ , n,

(13)

j=1

where x = (x1 , x2 , ¬∑ ¬∑ ¬∑ , xn ), b(x) = (b1 (x), b2 (x), ¬∑ ¬∑ ¬∑ , bn (x)) is the drift coefficient of the
SDE, œÉ(x) = (œÉij (x))n√ón is the diffusion coefficient of the SDE, and Œæ1 , Œæ2 , ¬∑ ¬∑ ¬∑ , Œæn are n
independent standard white noises. Mathematically, it can be proved that when the matrix
œÉ(x) is bounded from both below and above, almost all the major properties of the SDE model
related to the Freidlin-Wentzell theory will change little if œÉ(x) is regarded as the identity matrix
[54, 57], in which case the SDE model (13) can be simplified as
‚àö
xÃái = bi (x) + 2i Œæi , i = 1, 2, ¬∑ ¬∑ ¬∑ , n.
(14)
In fact, the SDE has been applied to model the concentration fluctuations of macromolecules
in gene networks in some previous studies [20]. Some reviews on this topic can be found in
[69‚Äì71].
In the core double-positive-feedback gene network depicted in Fig. 1(e), there are only
two participating macromolecules, proteins X and Y, if the inducer concentration is regarded
as a parameter. In this case, the simplified SDE model (14) is exactly our two-dimensional
stochastic model (1). To make biologists, especially experimental biologists, understand the
main results of this paper, we would like to use white noises to describe stochasticity in gene
expression and use the simplified SDE (14) to model multistable bacterial systems. Under this
simplification, our stochastic model (1) can be simply understood as the random perturbation
of the traditional deterministic model.

Strengths and deficiencies of the SDE model
Just as George Box‚Äôs famous saying said: all models are wrong, but some are useful. Our
model is no exception. In this paper, we use the SDE to model the concentration fluctuations
of the participating macromolecules in the gene network of heterogenous bacterial populations.
However, the SDE model proposed in this paper has some deficiencies. In fact, in living bacterial systems, some macromolecules, such as mRNA and protein molecules, may exist at very
low copy numbers [52], in which case the concept of concentration makes no sense. Thus the
SDE model cannot provide a good approximation of the CME model when the copy numbers
of the participating macromolecules are very small.
However, compared with the CME model, the SDE model proposed in this paper has many
strengths. First, the dimension of the CME model is often too high to be directly applied to
practical problems with experimental data and observations. If the gene network of the bacterial
system contains n macromolecules and the maximal possible copy numbers of these n macromolecules are N1 , N2 , ¬∑ ¬∑ ¬∑ , Nn . Then the dimension of the CME model will be N1 N2 ¬∑ ¬∑ ¬∑ Nn .
However, the SDE model compresses the dimension of the system to a large extent. If the
gene network of the bacterial system contains n macromolecules, then the dimension of the
16

SDE model is only n. This makes the system easy to be analyzed and makes many important
quantities related to the system easy to be explicitly calculated.
Second, the mathematical theory of the SDE model is well developed, whereas that of the
CME model is poorly developed due to its high complexity. In this paper, we use the FreidlinWentzell theory to explain stochastic phenotype switching and bet-hedging within isogenic bacterial populations and the consistence between our stochastic model and the traditional Markov
chain models of population evolution. We believe that an analogue of the Freidlin-Wentzell
theory must exist in the CME model. However, such a theory for the CME model is not well
developed up till now.
Third, the CME model is so abstract that it is not easy for biologists to understand and
follow. In fact, without some deep mathematical knowledge, it is very difficult to understand
the relationship between the CME model and the traditional deterministic model. However, the
SDE model can be simply viewed as the random perturbation of the deterministic model. This
makes the SDE model easy to be understood for both theoretical and experimental biologists.
Due to these reasons, we choose to use the SDE to model heterogenous bacterial populations, instead of the CME. We believe that the SDE, or equivalently, the chemical Langevin
equation, which does not lose much information of the complicated CME, is a useful tool in the
modeling of gene regulatory networks with inherent noises and in the analysis of the stochastic
nonlinear dynamics of biological systems.

Potential of our stochastic model
Given the small size of a cell and the small copy numbers of participating macromolecules,
cellular processes during gene expression are inherently stochastic. In this paper, we establish a
unified nonlinear stochastic model of multistable bacterial systems at the molecular level based
on a core double-positive-feedback gene network (Fig. 1(e)) and provide a clear description
of phenotypic heterogeneity, stochastic phenotype switching, and bet-hedging within isogenic
bacterial populations. Although we have used the expression levels of two stress-related genes
to establish our model, we point out here that the variables in our model are not necessarily
the expression levels of the stress-related genes, but can include more comprehensive indicators
measured by flow cytometry and other techniques, such as FSC (roughly proportional to cell
size), SSC (roughly proportional to cell granularity and complexity), and the ATP concentration
(positively correlated with total cell energy).
In our recent study about antibiotic resistance of Escherichia coli (unpublished work), we
found that the one-dimensional expression data of the hydrolase gene only lead to a monomodal
distribution, but the multidimensional expression data of a group of stress-related genes lead to
an apparent multimodal distribution. This phenomenon is described in this paper. Our simulation result shows that although the expression data of a group of genes are distributed within
multiple attraction basins, their marginal distribution may overlap to a large extent so that we
may not be able to observe a multimodal distribution if we only focus on the expression data
of a single gene. In our future work, we shall further apply the general framework discussed in
this paper to the specific problem of antibiotic resistance of Escherichia coli.
Biological systems with multistability are ubiquitous in nature. Some fundamental cellular
processes, such as decision-making processes in cell cycle progression [72], cell fate determination [73‚Äì76], and apoptosis [77, 78], display multistable features. In addition, multistability
is also involved in disease progression, which can be divided into a normal state, a pre-disease
state, and a disease state [55, 56]. Although various multistable biological systems have dif-

17

ferent feedback regulatory networks, the mathematical structures behind them are quite similar.
We hope that the stochastic approach discussed in this paper can give enlightenment to the
understanding of biological systems with multistability and to the analysis of the related new
phenomena and new questions.

Methods
The parameters used to draw the figures in the main text are chosen as Œ± = 1, Œ≤ = 2,
Œ≥ = 0.8, K = 0.05, Œ¥ = 0, and n = 6. The inducer concentration a and the two noise levels, 
and Œ∑ , are chosen appropriately when drawing different figures.

Acknowledgements
The authors gratefully acknowledge Prof. Michael S. Waterman at the University of Southern California and Prof. Michael Q. Zhang at Tsinghua University for stimulating discussions.
This work is supported by NSFC 11271029 and NSFC 11171024.

References
[1] Kussell E, Leibler S (2005) Phenotypic diversity, population growth, and information in fluctuating
environments. Science 309:2075‚Äì2078.
[2] Smits WK, Kuipers OP, Veening JW (2006) Phenotypic variation in bacteria: the role of feedback
regulation. Nat Rev Microbiol 4:259‚Äì271.
[3] Dubnau D, Losick R (2006) Bistability in bacteria. Mol Microbiol 61:564‚Äì572.
[4] Avery SV (2006) Microbial cell individuality and the underlying sources of heterogeneity. Nat Rev
Microbiol 4:577‚Äì587.
[5] Dhar N, McKinney JD (2007) Microbial phenotypic heterogeneity and antibiotic tolerance. Curr
Opin Microbiol 10:30‚Äì38.
[6] Lu T, Shen T, Bennett MR, Wolynes PG, Hasty J (2007) Phenotypic variability of growing cellular
populations. Proc Natl Acad Sci U S A 104:18982‚Äì18987.
[7] Veening JW, Smits WK, Kuipers OP (2008) Bistability, epigenetics, and bet-hedging in bacteria.
Annu Rev Microbiol 62:193‚Äì210.
[8] Fraser D, K√¶rn M (2009) A chance at survival: gene expression noise and phenotypic diversification strategies. Mol Microbiol 71:1333‚Äì1340.
[9] Jablonka E, Raz G (2009) Transgenerational epigenetic inheritance: prevalence, mechanisms, and
implications for the study of heredity and evolution. Q Rev Biol 84:131‚Äì176.
[10] Snijder B, Pelkmans L (2011) Origins of regulated cell-to-cell variability. Nat Rev Mol Cell Biol
12:119‚Äì125.
[11] Mao J, Blanchard AE, Lu T (2014) Slow and steady wins the race: A bacterial exploitative competition strategy in fluctuating environments. ACS Synth Biol .
[12] Rulands S, Jahn D, Frey E (2014) Specialization and bet hedging in heterogeneous populations.
Phys Rev Lett 113:108102.
[13] Acar M, Mettetal JT, van Oudenaarden A (2008) Stochastic switching as a survival strategy in
fluctuating environments. Nat Genet 40:471‚Äì475.
[14] SalatheÃÅ M, Van Cleve J, Feldman MW (2009) Evolution of stochastic switching rates in asymmetric
fitness landscapes. Genetics 182:1159‚Äì1164.
[15] Leisner M, Stingl K, Frey E, Maier B (2008) Stochastic switching to competence. Curr Opin
Microbiol 11:553‚Äì559.

18

[16] GaaÃÅl B, Pitchford JW, Wood AJ (2010) Exact results for the evolution of stochastic switching in
variable asymmetric environments. Genetics 184:1113‚Äì1119.
[17] Libby E, Rainey PB (2011) Exclusion rules, bottlenecks and the evolution of stochastic phenotype
switching. P Roy Soc B - Biol Sci 278:3574‚Äì3583.
[18] Rainey PB, et al. (2011) The evolutionary emergence of stochastic phenotype switching in bacteria.
Microb Cell Fact 10:S14.
[19] Ozbudak EM, Thattai M, Lim HN, Shraiman BI, Van Oudenaarden A (2004) Multistability in the
lactose utilization network of escherichia coli. Nature 427:737‚Äì740.
[20] SuÃàel GM, Garcia-Ojalvo J, Liberman LM, Elowitz MB (2006) An excitable gene regulatory circuit
induces transient cellular differentiation. Nature 440:545‚Äì550.
[21] Tsang J, Van Oudenaarden A (2006) Exciting fluctuations: monitoring competence induction dynamics at the single-cell level. Mol Syst Biol 2.
[22] Schultz D, Jacob EB, Onuchic JN, Wolynes PG (2007) Molecular level stochastic model for competence cycles in bacillus subtilis. Proc Natl Acad Sci U S A 104:17582‚Äì17587.
[23] Sonenshein AL, Hoch JA, Losick R (2002) Bacillus subtilis and its closest relatives: from genes to
cells (Asm Press Washington DC:).
[24] Errington J, et al. (2003) Regulation of endospore formation in bacillus subtilis. Nat Rev Microbiol
1:117‚Äì126.
[25] Morohashi M, et al. (2007) Model-based definition of population heterogeneity and its effects on
metabolism in sporulating bacillus subtilis. J Biochem (Tokyo) 142:183‚Äì191.
[26] de Jong IG, Veening JW, Kuipers OP (2010) Heterochronic phosphorelay gene expression as a
source of heterogeneity in bacillus subtilis spore formation. J Bacteriol 192:2053‚Äì2067.
[27] Sureka K, et al. (2008) Positive feedback and noise activate the stringent response regulator rel in
mycobacteria. PLoS One 3:e1771.
[28] Gefen O, Balaban NQ (2009) The importance of being persistent: heterogeneity of bacterial populations under antibiotic stress. FEMS Microbiol Rev 33:704‚Äì717.
[29] Ghosh S, et al. (2011) Phenotypic heterogeneity in mycobacterial stringent response. BMC Syst
Biol 5:18.
[30] Veening JW, et al. (2008) Bet-hedging and epigenetic inheritance in bacterial cell development.
Proc Natl Acad Sci U S A 105:4393‚Äì4398.
[31] Beaumont HJ, Gallie J, Kost C, Ferguson GC, Rainey PB (2009) Experimental evolution of bet
hedging. Nature 462:90‚Äì93.
[32] Wolf DM, Vazirani VV, Arkin AP (2005) Diversity in times of adversity: probabilistic strategies in
microbial survival games. J Theor Biol 234:227‚Äì253.
[33] Gupta PB, et al. (2011) Stochastic state transitions give rise to phenotypic equilibrium in populations of cancer cells. Cell 146:633‚Äì644.
[34] Zhou D, Wu D, Li Z, Qian M, Zhang MQ (2013) Population dynamics of cancer cells with cell
state conversions. Quantitative Biology :1‚Äì8.
[35] Karmakar R, Bose I (2007) Positive feedback, stochasticity and genetic competence. Phys Biol
4:29‚Äì37.
[36] Mitrophanov AY, Groisman EA (2008) Positive feedback in cellular control systems. Bioessays
30:542‚Äì555.
[37] Mantzaris NV (2007) From single-cell genetic architecture to cell population dynamics: quantitatively decomposing the effects of different population heterogeneity sources for a genetic network
with positive feedback architecture. Biophys J 92:4271‚Äì4288.
[38] Vellela M, Qian H (2009) Stochastic dynamics and non-equilibrium thermodynamics of a bistable
chemical system: the schloÃàgl model revisited. J R Soc Interface 6:925‚Äì940.
[39] Qian H, Bishop LM (2010) The chemical master equation approach to nonequilibrium steady-state

19

of open biochemical systems: Linear single-molecule enzyme kinetics and nonlinear biochemical
reaction networks. Int J Mol Sci 11:3472‚Äì3500.
[40] Qian H (2011) Nonlinear stochastic dynamics of mesoscopic homogeneous biochemical reaction
systems ‚Äì an analytical theory. Nonlinearity 24:R19.
[41] Ge H, Qian H (2011) Non-equilibrium phase transition in mesoscopic biochemical systems: from
stochastic to nonlinear dynamics and beyond. J R Soc Interface 8:107‚Äì116.
[42] Qian H (2012) Cooperativity in cellular biochemical processes: noise-enhanced sensitivity, fluctuating enzyme, bistability with nonlinear feedback, and other mechanisms for sigmoidal responses.
Annu Rev Biophys 41:179‚Äì204.
[43] Qian H, Ge H (2012) Mesoscopic biochemical basis of isogenetic inheritance and canalization:
Stochasticity, nonlinearity, and emergent landscape. Mol Cellu Biomech 9:1‚Äì30.
[44] McAdams HH, Arkin A (1997) Stochastic mechanisms in gene expression. Proc Natl Acad Sci U
S A 94:814‚Äì819.
[45] Elowitz MB, Levine AJ, Siggia ED, Swain PS (2002) Stochastic gene expression in a single cell.
Science Signalling 297:1183.
[46] Ozbudak EM, Thattai M, Kurtser I, Grossman AD, van Oudenaarden A (2002) Regulation of noise
in the expression of a single gene. Nat Genet 31:69‚Äì73.
[47] Paulsson J (2004) Summing up the noise in gene networks. Nature 427:415‚Äì418.
[48] K√¶rn M, Elston TC, Blake WJ, Collins JJ (2005) Stochasticity in gene expression: from theories to
phenotypes. Nat Rev Genet 6:451‚Äì464.
[49] Raser JM, O‚ÄôShea EK (2005) Noise in gene expression: origins, consequences, and control. Science
309:2010‚Äì2013.
[50] Cai L, Friedman N, Xie XS (2006) Stochastic protein expression in individual cells at the single
molecule level. Nature 440:358‚Äì362.
[51] Yu J, Xiao J, Ren X, Lao K, Xie XS (2006) Probing gene expression in live cells, one protein
molecule at a time. Science 311:1600‚Äì1603.
[52] Xie XS, Choi PJ, Li GW, Lee NK, Lia G (2008) Single-molecule approach to molecular biology in
living bacterial cells. Annu Rev Biophys 37:417‚Äì444.
[53] Sanchez A, Choubey S, Kondev J (2013) Regulation of noise in gene expression. Annu Rev Biophys
42:469‚Äì491.
[54] Freidlin MI, Wentzell AD (2012) Random perturbations of dynamical systems, volume 260
(Springer).
[55] Kim D, Rath O, Kolch W, Cho K (2007) A hidden oncogenic positive feedback loop caused by
crosstalk between wnt and erk pathways. Oncogene 26:4571‚Äì4579.
[56] Kellershohn N, Laurent M (2001) Prion diseases: dynamics of the infection and properties of the
bistable transition. Biophys J 81:2517‚Äì2529.
[57] Olivieri E, Vares ME (2005) Large deviations and metastability. 100 (Cambridge University Press).
[58] Liu R, et al. (2012) Identifying critical transitions and their leading biomolecular networks in complex diseases. Sci Rep - UK 2:813.
[59] Dai L, Vorselen D, Korolev KS, Gore J (2012) Generic indicators for loss of resilience before a
tipping point leading to population collapse. Science 336:1175‚Äì1177.
[60] Angeli D, Ferrell JE, Sontag ED (2004) Detection of multistability, bifurcations, and hysteresis in
a large class of biological positive-feedback systems. Proc Natl Acad Sci U S A 101:1822‚Äì1827.
[61] GouzeÃÅ JL (1998) Positive and negative circuits in dynamical systems. J Biol Syst 6:11‚Äì15.
[62] Snoussi EH (1998) Necessary conditions for multistationarity and stable periodicity. J Biol Syst
6:3‚Äì9.
[63] Cinquin O, Demongeot J (2002) Positive and negative feedback: striking a balance between necessary antagonists. J Theor Biol 216:229‚Äì241.

20

[64] Gillespie DT (1992) A rigorous derivation of the chemical master equation. Physica A 188:404‚Äì
425.
[65] Kurtz TG (1970) Solutions of ordinary differential equations as limits of pure jump markov processes. J Appl Probab 7:49‚Äì58.
[66] Kurtz TG (1971) Limit theorems for sequences of jump markov processes approximating ordinary
differential processes. J Appl Probab 8:344‚Äì356.
[67] Kurtz TG (1972) The relationship between stochastic and deterministic models for chemical reactions. J Chem Phys 57:2976‚Äì2978.
[68] Gillespie DT (2000) The chemical langevin equation. J Chem Phys 113:297‚Äì306.
[69] Rao CV, Wolf DM, Arkin AP (2002) Control, exploitation and tolerance of intracellular noise.
Nature 420:231‚Äì237.
[70] Wilkinson DJ (2009) Stochastic modelling for quantitative description of heterogeneous biological
systems. Nat Rev Genet 10:122‚Äì133.
[71] Meister A, Du C, Li YH, Wong WH (2014) Modeling stochastic noise in gene regulatory systems.
Quantitative Biology 2:1‚Äì29.
[72] Yao G, Lee TJ, Mori S, Nevins JR, You L (2008) A bistable rb‚Äìe2f switch underlies the restriction
point. Nat Cell Biol 10:476‚Äì482.
[73] Ferrell Jr JE, Machleder EM (1998) The biochemical basis of an all-or-none cell fate switch in
xenopus oocytes. Science 280:895‚Äì898.
[74] Xiong W, Ferrell JE (2003) A positive-feedback-based bistable memory modulethat governs a cell
fate decision. Nature 426:460‚Äì465.
[75] Corson F, Siggia ED (2012) Geometry, epistasis, and developmental patterning. Proc Natl Acad Sci
U S A 109:5568‚Äì5575.
[76] Yan L, et al. (2013) Single-cell rna-seq profiling of human preimplantation embryos and embryonic
stem cells. Nat Struct Mol Biol 20:1131‚Äì1139.
[77] Eissing T, et al. (2004) Bistability analyses of a caspase activation model for receptor-induced
apoptosis. J Biol Chem 279:36892‚Äì36897.
[78] Spencer SL, Gaudet S, Albeck JG, Burke JM, Sorger PK (2009) Non-genetic origins of cell-to-cell
variability in trail-induced apoptosis. Nature 459:428‚Äì432.

21

