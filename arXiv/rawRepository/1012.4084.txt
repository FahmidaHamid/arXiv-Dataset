arXiv:1012.4084v4 [cs.DM] 23 Jul 2011

Structure and Recognition of 3,4-leaf Powers of Galled Phylogenetic
Networks
Michel Habib1 and Thu-Hien To2
LIAFA - CNRS and Université Paris Diderot - Paris VII,
Case 7014, 75205 Paris Cedex 13, France
1
2
habib@liafa.jussieu.fr
toth@liafa.jussieu.fr
July 26, 2011

Abstract
A graph is a k-leaf power of a tree T if its vertices are leaves of T and two vertices are adjacent
in T if and only if their distance in T is at most k. Then T is a k-leaf root of G. This notion
was introduced in [13] motivated by the search for underlying phylogenetic trees. We study
here an extension of the k-leaf power graph recognition problem. This extension is motivated
by a new biological question for the evaluation of the latteral gene transfer on a population of
viruses. We allow the host graph to slightly differs from a tree and allow some cycles. In fact
we study phylogenetic galled networks in which cycles are pairwise vertex disjoint. We show
some structural results and propose polynomial algorithms for the cases k = 3 and k = 4. As a
consequence, squares of galled networks can also be recognized in polynomial time.

1

Introduction

The reconstruction of the evolutionary history of a set of species, based on quantitative biological
data, is one of the most challenging problems in computational biology.
Most often the evolutionary history is modeled by an evolutionary tree called phylogeny whose
leaves are labeled by species and each internal node represents a speciation event whereby an
ancestral specie gives rise to two children. Practically from the biological data one constructs a
similarity undirected graph on the set of species where adjacency indicates evolutionary closeness,
and then the problem is to build a phylogeny tree from this data. If we understand the distance
between species as a distance prescribed (k) in the phylogeny, the reconstruction problem is known
as the recognition of k-leaf power graphs [13], for a survey on leaf powers see [3].
Our motivation comes from a question biological question from [2, 1, 12]. They ask us how
to measure the relative importance of latteral genes transfer between viruses [7] compare to the
normal evolution Darwinian rules. In other words can we infer a tree from the virus biological data
or something else (a tree-like structure plus extra edges).
Therefore we consider the problem in which the evolutionary history is modelled by a generalization of trees, the so-called galled networks in which cycles are allowed but under the constraint
that they pairwise do not intersect.
In the next sections we first consider some easy facts about phylogenetic networks and in section
4, when studying 4-leaf g-networks we show an important difference with 4-leaf power of trees. Using
1

maximal clique graphs and block decomposition we propose a polynomial algorithm to recognize
these graphs.

2

Preliminaries

It is easy to see that G is a k-leaf N power iff each of its connected component is. So, we may
assume in the following that G is connected. The case k = 2 is obvious since only sibling leaves
can be adjacent, therefore only disjoint union of cliques can be 2-leaf N power graphs.
Most of the tools developed for the study of k-leaf tree power graphs, are also useful in the
generalisation to other classes of phylogenetic networks. Therefore we will extend the notions of
basic tree, visible vertex and critical clique as can be found in [4, 5].
A tree or a network is called basic if each inner vertex is attached to at most one leaf.
A vertex of N is visible if there is a leaf attached to it, otherwise it is invisible. For any leaf
x of N , let p(x) (for parent of x) be the inner vertex that x is attached to. For any not leaf u, let
l(u) (for leaf of u) be the leaf attached to u if u is visible, and be empty if u is invisible.
The two following results were already known for k-leaf tree power and can be easily extended
to other classes of networks.
Proposition 1 If G is a k-leaf N power, then there exists a k-leaf N root N 0 of G such that there
is a bijection between the critical cliques of G and the set of leaves which are adjacent to the same
vertex in N 0 .
Proof: Let X be a critical clique of G and N ∈ N be one of its roots. Let us suppose that in N ,
the leaves labelled by X are adjacent to several different visible vertices v1 , . . . , vm , and denote Xi
the set of leaves adjacent to vi . By moving all X2 , . . . , Xm so that they become adjacent to v1 , and
then delete all new created leaves if there is any, we obtain a network N 0 . It is obvious that the
leaf set of N 0 and of N is the same, and N 0 is still a N network, since we ask the class N to be
hereditary and closed under addition and removing leaves. Let G0 be the k-leaf power of N 0 . We
will prove that G0 is equal to G.
For any two leaves a, b, if a, b ∈
/ X then their distance in N and in N 0 are the same. So, if they
are connected (resp. non connected) in G, they are also connected (resp. non connected) in G0 .
If a is in X but b ∈
/ X . Suppose that in G, b is adjacent to a, so it is adjacent with all X
because X is a critical clique of G. Then the distance between b and the leaves of X1 in N are at
most k, i.e in N 0 the distance from b to the leaves of X are at most k. Then, b is adjacent to all X
in the G0 . The same, if b is not adjacent to X in G, then b is not adjacent to any leaf of X in G0 .
If a, b are both in X. Since X is a clique of G, ab is connected in G. They are obviously
connected in G0 because their distance in N 0 is exactly 2 (they are attached to the same node v1 ).
So, G0 is equal to G.
By using this construction for any critical clique of G, then for each critical clique X of G, there
is a vertex vX in N 0 such that all vertices in X are attached to vX of N 0 . Suppose that there are
two critical cliques X, Y such that vX = vY , then it is easy to see that in the k-leaf power of N 0 ,
X ∪ Y is a critical clique. However, the k-leaf power of N 0 is G, it is a contradiction because X, Y
are critical cliques in G so X ∪ Y can not be a critical clique of G. This achieves the proof.
2
Proposition 2 G is a k-leaf N power if and only if CC(G) is a k-leaf basic N power.
2

Proof: Suppose that G is a k-leaf N power and N is one of its roots. By the above proposition,
we can choose N such that the leaves of any critical clique of G are attached to the same visible
vertex. By contracting each set of leaves of N which adjacent to the same node, we obtain a basic
network N 0 ∈ N . It is easy to see that N 0 is a k-leaf power of CC(G).
Conversely, if CC(G) is a k-leaf basic N network power and N 0 is one of its basic roots. By
replacing each leaf of N 0 by the set of leaves of the corresponding critical cliques, we obtain a
network N which is a k-leaf root of G.
2

3

3-leaf power of N networks.

It is known that a connected graph G is a 3-leaf tree power if and only if its critical clique graph
is a tree [14, 4, 6]. Our next result generalizes this result to N network powers.
Theorem 1 A graph G is a 3-leaf N power if and only if its critical clique graph belongs to N .
Proof: Using previous Proposition 2, let us suppose that CC(G) = (V, E) is a 3-leaf N power
graph and let N be one of its roots. By definition it exists a bijective mapping θ from V to the
leaves of N .
For every t, t0 leaves of N dist(t, t0 ) ≤ 3 iff p(t)p(t0 ) is an edge of N . Therefore θ−1 (t)θ−1 (t0 ) ∈ E
iff p(t)p(t0 ) is an edge of N . So CC(G) is isomorphic to a subgraph of N . We have forced the class
N to be hereditary, so CC(G) belongs to N .
Conversely, if CC(G) belongs to N , let us build a phylogenetic network N from CC(G) by
adding to every x ∈ V a leaf l(x) attached to x. N is supposed to be closed by adding leaves, so
N ∈ N . Furthermore we immediately have dN (l(x), l(y)) = 3 iff xy ∈ E.
2
Corollary 1 The recognition of 3-leaf N power is equivalent (same complexity) of the recognition
problem for N .
Corollary 2 3-leaf g-network powers can be recognized in linear time.
Proof: Since it is well-known that computing twins (false or true) can be done in linear time see
[10], therefore calculating CC(G) can be done in linear time. Recognition of g-networks can also
be done in linear time simply by using a depth-first search traversal and computing the block (2connected components) decomposition of the graph. To conclude we just have to check if every
block contains at most one cycle and if these cycles intersect.
2

4

4-leaf basic g-network powers

For k = 4 the problem becomes harder to solve and therefore for technical purpose we choose to
consider first a slight generalization of trees namely g-networks.
Definition 1 Let L be a set of n species. A g-network on L is a connected undirected graph
containing n vertices of degree 1 which are bijectively labelled by L and in which induced cycles are
pairwise vertex-disjoint.
Moreover, by computing CC(G), one can easily transform a 4-leaf g-network power to a 4-leaf
basic g-network power. So, we study the problem only on basic models.
3

4.1

Preliminaries

As a first remark we notice that if G is a 4-leaf basic g-network power then it has a root N which
does not contain any two adjacent invisible vertices. This is simply because if there were an edge
between two invisibles vertices, this edge cannot be used to connect 2 leaves via a path of length
≤ 4. Therefore this edge can be deleted in N . So we can suppose that our networks do not contain
two adjacent invisible vertices. This assumption implies that for any two vertices x, y of G, there
is a path from x to y in G iff there is a path from θ(x) to θ(y) in N .
Definition 2 For a subset of vertices M of G let us define for a root N of G, N [M ] to be the
minimal connected induced subgraph of N whose leaves are exactly θ(M ) and for which ∀x, y ∈
M, dN [M ] (θ(x), θ(y)) = dN (θ(x), θ(y)).
When N is known, for every subset of vertices M , N [M ] is uniquely defined and easy to compute.
The family F of g-networks described in Figure 1 is made up with an infinite family of visible,
invisible (quasi) stars together with 5 networks N4 , N5 , N50 , N500 , N6 based on cycles of length 4 to
6.

(a) An invisible star

(b) An invisible quasi star

(c) A visible
star

(g) N50

(d) A visible
quasi star

(h) N500

(e) N4

(f) N5

(i) N6

Figure 1: F the family of roots of maximal clique for 4-leaf basic g-networks power

Observation 1 Suppose that G has a 4-leaf basic g-network root N . Then M is a maximal clique
of G iff N [M ] is isomorphic to one of the subgraphs in F.
We denote i-cycle for a chordless cycle of length i. So, N4 is a 4-cycle without invisible vertex,
N5 is a 5-cycle without invisible vertex, N50 is a 5-cycle with one invisible vertex, N500 is a 5-cycle
with two invisible vertices and N6 is a 6-cycle with 3 visible vertices of pairwise distance 2.
An invisible star (Figure 1(a)) consists of an invisible vertex u, called the middle vertex of it,
and all visible vertices adjacent to u as well as the leaves attached to these visible vertices. Two
visible vertices of an invisible star can be adjacent, in this case we have an invisible quasi star
(Figure 1(b)). Because there is no intersecting cycle in the constructing networks, there are at
most two adjacent visible vertices in each invisible quasi star.

4

A visible star (Figure 1(c)) consists of a visible vertex u, called the middle vertex of it, the leaf
of u and all visible vertices adjacent to u as well as the leaves attached to these visible vertices.
If there are two adjacent visible vertex u, u0 such that they are not adjacent to any other visible
vertex, then the visible star of u is exactly the visible star of u0 , we can consider either u or u0 as
the middle vertex of this visible star. Similarly we define also visible quasi star (Figure 1(d)).
Moreover, if a visible or invisible star is totally included in another visible or invisible star, or
a network N4 , N5 , N50 , N500 , N6 then we do not consider it as a visible or invisible star. For example,
this is the case of the visible star whose middle vertex is p(b) in Figure 1(e) when p(b) is not adjacent
to any other visible vertex different from p(a), p(c); or the invisible stars having {a, d} as the leaf
set in Figure 1(g) when the middle vertex of this star is not adjacent to any other visible vertex
different from p(a), p(d).
Proof: ⇒ Let M = {x1 , . . . , xk } be a maximal clique of G, then in N we have d(xi , xj ) ≤ 4 for
any i, j.
We first prove that N [M ] cannot contain more than one cycle. In fact, if there are two cycles
C1 , C2 in N [M ], they are vertex disjoint and be separated by a path containing at least one edge.
Let u1 , u2 be the extremities of this path on C1 , C2 . There must exist a
visible vertex vi on Ci different from ui for any i = 1, 2. Indeed, suppose
otherwise, then in order that the distance between every pair of leaves
in M are at least 4, all leaves of M are attached to either u1 or u2 . It
implies by the definition of N [M ] that N [M ] consists of only the path
from u1 to u2 but not the cycles C1 , C2 , a contradiction. Let xi be the
leaf attached to vi . Hence, dN (x1 , x2 ) ≥ 5, it means that they are not
connected in G, a contradiction.
If N [M ] contains a cycle, that cycle has at most 6 vertices. Otherwise there are two leaves
whose distance is greater than 4. So, the Figures 1(b), 1(d), 1(e), 1(f), 1(g), 1(h), 1(i) correspond
to all the possible configurations of N [M ] in this case.
If N [M ] does not contain any cycle, then in order that d(xi , xj ) ≤ 4 for any i, j, N [M ] must be
a star (visible or invisible).
⇐ It is obvious that the 4-leaf power of any network of F is a clique. By definition, not any
network of F is included in another one. So each one correspond to a maximal clique of G.
2
Therefore, one can construct a 4-leaf g-network leaf of a graph G by replacing each maximal
clique M of G by a network in the family F in an appropriate way.
It should be noticed that the networks N4 , N5 , N50 , N500 and N6 of the family F are not chordal
graphs. Nevertheless maximal cliques still play a great role as will be shown in the following
sections.
Definition 3 (Maximal cliques graph) Let G be a biconnected graph. The maximal cliques
graph of G, denoted by M C(G) is a graph whose nodes correspond to maximal cliques of G. Two
nodes A, B are connected by an edge if and only if the corresponding maximal cliques of A and
B have common vertices, and furthermore A ∩ B is maximal with respect to A or B. (A ∩ B is
maximal with respect to A if there is not any node C such that A ∩ C is included in A ∩ B).
The label of a node A of M C(G), denoted by l(A), is equal to the vertex set of the maximal
clique A. The label of an edge AB, denoted by l(AB), is equal to the common vertex set of the
5

A

B

C

bg

D

cg

deg

F
def

A=(abg), B=(bcg), C=(cdeg), D=(defg), E=(defh)
(a) G

(b) M C(G)

Figure 2: An example of maximal cliques graph

two maximal cliques A, B. The label of a subgraph S, denoted by l(S), is equal to the union of the
labels of the edges of S. The weight of an edge of M C(G) is the cardinal of its label. The size of
a node is the cardinal of its label.
Let A be a node of M C(G), denote by N [A] the induced subgraph of N as defined in Definition
2, on the maximal clique of G corresponding to the node A. For the sake of simplicity, when we
represent N [A] in figures, except the leaves of A which have concrete labels, we denote the labels
of the other leaves by A.
We say that a network n is a 4-leaf root of a subgraph S of M C(G) iff M C(n4l ) = S.
Let S be a subgraph of M C(G), then denote by G[S] the induced subgraph of G on the vertex
set consisting of all l(A) for every node A of S. If a network n is a root of G[S], we also say that
it is a root of S.
With this definition of M C(G), we can deduce several properties of M C(G) related to the
family F in the observation below.
Observation 2 Let N be a 4-leaf basic g-network root of G.
(i) If AB is an edge of M C(G) such that l(AB) = {x, y} and N [A], N [B]
are visible (quasi) star, then x, y are the two leaves attached to the middle
vertices of N [A] and N [B].
(ii) If AB is an edge of M C(G) such that |AB| = 3 then either N [A], N [B] are visible quasi
stars sharing a same triangle or one of them is N4 or N5 or N50 and the other is a visible star.
Ax
A

y

B

t

z

x

y B

u

t

z

t

z

B

xyz
z

(iii) If ABC is a triangle of M C(G), then:
- either |AB| = |BC| = |AC| = 2, then one
of N [A], N [B], N [C] is either an invisible quasi
stars or a N500 .
z
C
A x
y
xy
xy
B
A x
xy
A
B
y B
C

6

x

y B x

y B

- or |AB| = |BC| = |AC| = 3, then
N [A], N [B], N [C] are 3 visible quasi stars
sharing the same triangle.
C
Ax y
xyz xyz
B
xyz
B
A
z C

(iv) If AB is an edge of M C(G) such that |AB| = 1 then either N [A] or N [B] is an invisible
(quasi) star.
(v) If M A, M B are two edges of M C(G) such that |M A| = |M B| = 3 and AB is not an edge
of M C(G) then N [M ] is either N4 or N5 or N50 and N [A], N [B] are visible stars.
Proof: (i) We check all the possible configurations of N [A], N [B] such that they have two common
leaves x, y.
Suppose these common vertices are not middle vertices of N [A], N [B],
and the middle vertices of N [A], N [B] are respectively a, b. So, there is a
4-cycle N4 with the leaves x, y, a, b. Let C be the maximal clique corresponding to this cycle. Then A ∩ C = {x, a, b} and B ∩ C = {y, a, b}, i.e.
A ∩ B is include in A ∩ C and B ∩ C. By definition of M C(G), AB is not
an edge of M C(G), a contradiction.
Suppose that x is the label of the middle vertex of N [A], but y is not the
label of the middle vertex of N [B]. Because x is contained in the star N [B],
so b is also in the star having p(x) as middle vertex. In other words, b is
contained in N [A], i.e. A, B have 3 common vertices x, y, b, a contradiction.
So, x, y are the labels of the middle vertices of N [A], N [B].
(ii,iii) It is easy to check theses claim by considering all possible configurations of N [A], N [B],
(and N [C]) with the condition of vertex-disjoint cycles in N .
(iv) Suppose that neither N [A] nor N [B] is an invisible (quasi) star, and let x be the unique
common leaf of N [A] and N [B]. By considering all other possible configurations of N [A] and N [B],
we can deduce that it is not possible.
For example suppose that N [A], N [B] are visible (quasi) stars. Let
xA , xB be the leaves of the middle vertex of N [A] and N [B]. Let consider
the visible (quasi) star having p(x) as its middle vertex, it corresponds to
the maximal clique C. So, C contains xA , xB . We deduce that A ∩ B ⊂
A ∩ C and A ∩ B ⊂ B ∩ C. By definition of M C(G), AB is not an edge,
a contradiction.
If N [A] is visible (quasi) star, N [B] is N4 , let xA be the leaf of
the middle vertex of N [A]. Let consider the visible (quasi) star having
p(x) as its middle vertex, it corresponds to the maximal clique C. So, C
contains xB and y, t. We deduce that A ∩ B ⊂ A ∩ C and A ∩ B ⊂ B ∩ C.
By definition of M C(G), AB is not an edge.
Similarly, we can check that in any other case, there is always a maximal clique C such that
A ∩ B ⊂ A ∩ C and A ∩ B ⊂ B ∩ C, a contradiction.
(v) We have |M A| = 3, so by Observation (ii):
- either N [A], N [M ] are visible quasi stars sharing a triangle. Since |M B| = 3, N [B] must be
also a visible quasi star which share the same triangle with N [M ] and N [A]. So, AB is connected
by an edge of weight 3 in M C(G), a contradiction.
- or N [M ] is N4 , N5 , or N50 and N [A], N [B] are visible stars, so we are done.
2
Lemma 1 If G is a 4-leaf basic g-network power, then
(i) each edge of G is contained in at most 3 maximal cliques.
(ii) any two maximal cliques have at most 3 vertices in common.

7

Proof: Let N be a 4-leaf basic g-network root of G.
(i) Let xy be an edge of G which is contained in a maximal clique A.
- If N [A] is not a visible or invisible quasi star: suppose that there are other two maximal
cliques B, C that contain xy. Then for any configuration of the family F that N [A], N [B], N [C]
take, we can check that N [A ∪ B ∪ C] contains always two non disjoint cycles, contradicting that
N is a g-network. So, it this case, there are at most 2 maximal cliques containing xy.
- If N [A] is a visible or invisible quasi star: then there are at most two other maximal cliques
different from A that can contain x, y by the same reason. In the case that there are exactly 2
other maximal cliques B, C that contain x, y, then ABC is a triangle of M C(G).
(ii) Let A, B be two maximal cliques having more than 1 common vertices. Always by the
condition of vertex-disjoint cycles in N , we deduce that if both N [A], N [B] are either visible stars
or invisible (quasi) stars or N500 , or N6 , then they have at most 2 common leaves. If one of them is
a visible quasi star or N4 or N5 , or N50 , then they have at most 3 common leaves. Moreover, when
they have exactly 3 common vertices, either one of them is N4 or N5 or N50 , or both of them are
visible quasi stars (Claim (ii) of Observation 2).
2
Corollary 3 For G = (V, E) a 4-leaf basic g-network power, the number of maximal cliques of G
is bounded by 3|E|.
Theorem 2 For G = (V, E) a 4-leaf basic g-network power graph, M C(G) can be computed in
O(|V |.|E|2 ).
Proof: It suffices to use any algorithm that generates all maximal cliques of G in O(|V |.|E|) delay
using polynomial space as described in [8]. If it has more than 3.|E| maximal cliques, we can stop
the algorithm and conclude that it is not a 4-leaf basic g-network power, otherwise we can calculate
the edges of M C(G) within the same complexity.
2
When a clique is a block, let us call it a block clique. Another similar property with 4-leaf basic
tree roots is stated in the following lemma.
Lemma 2 If G is a 4-leaf basic g-network power, then there exists a 4-leaf basic g-network root N
of G such that for any block clique B of G, N [B] is an invisible star.
Proof: Let B1 , . . . Bm be the blocks of G. Let N0 be a 4-leaf basic g-network root of G. For any
Bi , let Ni = N0 [Bi ]. By the above analysis, N0 is obtained by combining Ni for all i = 1, . . . , m.
For any block clique Bi we replace Ni by the invisible star Si having the vertices of Bi as its leaf set
such that if Ni , Nj have x and p(x) as common vertices, then Si and Nj also have x and p(x) as
common vertices. Let the resulting network is N . It is obvious that Si is a 4-leaf basic g-network
root of Bi . We will prove that N is a 4-leaf root of G. It is easy to check that tor any two leaves x, y
of G, if x, y are not in the same block, then their distance in N are greater than 4. This corresponds
to the fact that x, y are not connected in G. If x, y are contained in one block and this block is
not a clique, then their distance in N is exactly their distance in N0 . If this block is a clique then
their distance in N is exactly 4 because they are two leaves of an invisible star. That corresponds
to the fact that xy is connected in G because they are in the same clique. Therefore, G is a 4-leaf
power of N .
It is obvious that N is a basic network. We must prove furthermore that the cycles in N are
pairwise vertex-disjoint. From the assumption that there is no adjacent invisible vertex in N , we
8

deduce that each cycle of N is contained in the root of a block of G. Since N0 is a g-network, the
cycles in each Ni are pairwise vertex-disjoint. The invisible stars Si do not contain any cycle, so
the cycles in N are always pairwise disjoint, i.e. N is a basic g-network.
2

4.2

Adding extra constraints to the root graphs

(a)

(b)

(c)

(d)

Figure 3: Examples of the simplification

Let us suppose that there is a root N in which there exists a 3 or 4 or 5-cycle having only
one vertex which is adjacent to other inner vertex not on the cycle. An easy observation shows
that in such a case we can simplify the root to another simpler network (in each case the cycle is
shortened) without changing the 4-leaf power and the properties of disjoint cycles of the network as
illustrated in Figures 3(a), 3(b), 3(c). If there is a 5-cycle with one invisible vertex u as in Figure
3(d) such that p(x), p(t) and u are not adjacent to any other inner vertex not on the cycle, then we
can replace it by the 4-cycle in the right. We apply such a transformation at most once for each
cycle.
Therefore we can suppose that the networks that we construct are connected, do
not have any two adjacent invisible vertices and do not contain any such 3, 4, 5-cycle.
Moreover, according to Lemma 2, then induced subgraph of the roots on each block
clique of G is an invisible star.

4.3

Sketch of the analysis of the 4-leaf case

We consider separately each block of G. The steps of the algorithm on one block is resumed in
the example of Figure 4. Firstly, we calculate the maximal cliques graph M C(Bi ) of each block
Bi . Next, we find all particular subgraphs of M C(B) such that every root of each one has exactly
one cycle. Some conditions must be taken into account on the root set of these subgraphs in order
that they are compatible with the others in the same block as well as in the adjacent blocks. After
this step, we have the set of cycles of a 4-leaf basic g-network of G, namely cycle-root set Rc .
Therefore, by separating the corresponding subgraphs from Bi the obtain graph B\Rc must be the
square of a forest (Theorem 5). The later problem is known to be linear. So, it is easy to construct
a root of B\Rc which is compatible with the cycle-root set Rc . So, by combining them together,
we obtain a 4-leaf basic g-network of Bi . The final step is combining the root of each block to have
the corresponding root of G.
Hence, recognition of 4-leaf basic g-network powers can be done in polynomial time. As a
consequence, squares of basic g-networks can also be recognized in polynomial time.

9

ct
ct
e

b
t
u

z

y

c

zt
tx xy

i

ux

f

x
a

zt

ce

xd

xz

dh

M C(Bi )

e

t
c
t
z

u
y
a

t
b
z
t z t
z x
u u
y
a
y x
d
x
g
i
h

M C(Bi \ RC )
b
c
t
u
z
d
y
x a
RC [Bi ]

f

b

e

c

dh

g

b

f

xd

h
d
Bi

ce

Bi \ RC
e
t

f
c
z

t
z

i
u
u

h

x d
g

a 4-leaf basic g-network root of Bi

z

x i
h

y

g
x y x ad
a 4-leaf basic g-network root of Bi \ RC

Figure 4: Construction a 4-leaf basic g-network root of a block Bi of G

Almost the remaining of this paper is devoted to construct the cycles in the roots of G (Section
4.4). For this purpose, we introduce some special subgraphs of M C(G) namely Ce (G), Co (G) (when
G is biconnected) and Cc (G) (when G is not biconnected).

4.4

Detecting the cycles in the roots of G.

We call a cycle is big if it contains at least 7 vertices, otherwise it is small . It should be noticed
that all cycles that we mention here (cycles of M C(G) or cycles of networks) are chordless cycles.
We will denote the cycle in N by the lower-case letter c and the cycle in M C(G) by the upper-case
letter C.
Let N be a basic g-network. For any cycle c of N , let us define the set of
labels of the visible vertices of c as l(c) = {x ∈ L | p(x) ∈ c} . Denote by
S(c) the subnetwork of N consisting of c and all (quasi) visible and invisible
stars having a vertex of c as their middle vertices.
Example 1 In the figure in the right, we have a cycle c and S(c). By
definition, l(c) = {x1 , x2 , x3 , x4 , x5 }.
10

Lemma 3 If G is biconnected, is not a clique and has a 4-leaf basic g-network root N , then:
(i) Any invisible vertex of N is contained in a cycle.
For any cycle c of N and for any vertex u on c:
(ii) If u is visible then u is not adjacent to any invisible vertex not on c. Furthermore, if u is
adjacent to only invisible vertex on c, then u is not adjacent to any other inner vertex not on c.
(iii) If u is invisible, let s be the (quasi) invisible star having u has its middle vertex, then for
any visible vertex v of s which is not on c, v is not adjacent to any other inner vertex different
from u.
Proof: (i) Suppose that N has an invisible vertex u which is not contained in any cycle.
Let x, y be two leaves of the invisible star of u, and let z be a leaf not in this
invisible star which has distance at most 4 with x. Since G is biconnected,
there is at least a path in G from y to z which does not pass x. We deduce
that in N there is at least a path from p(y) to p(z) that does not pass p(x).
In other words, there is a cycle passing u, a contradiction.
(ii) Let c be a cycle of N and let u be a visible vertex on c.
Suppose that u is adjacent to an invisible vertex i not on c. Let v be another
vertex adjacent to i, so v is visible. Let x, y be the leaves of u, v. Let t be another
leaf such that p(t) is on c. If in N all path from t to y passes by u, then all paths
from t to y in G must pass x. This is a contradiction because G is biconnected.
So there is another path from p(t) to p(y) which does not pass u, this means
that there is another cycle different from c intersecting with c. This is impossible
because N is a g-network.
Suppose that u is adjacent to 2 invisible vertices on c, let x1 , x2 be the
leaves of these two invisible vertices. Suppose that u is adjacent to a vertex v
not on c. As showed above, v must be visible, let y be the leaf of v. In order
that y is contained in the same block with x, x1 , x2 , there must exist a path
from y to x1 in G which does not pass x. It implied that in N there exists a
path from p(y) to p(x1 ) which does not pass p(x). However, that will create a
cycle intersecting with c, a contradiction.
(iii) Let c be a cycle of N and let u be an invisible vertex on
c. Let x be a leaf of the star s of u such that p(x) is not on c.
Let y be a leaf of this star such that p(y) is on c. Suppose that
p(x) is adjacent to an inner vertex different from u, then there
is a leaf z not in s such that dN0 (x, z) ≤ 4. Then, in G there is
a path from z to y which passes x. Because G is biconnected,
there must be a path from z to y in G which does not pass x.
That will produce in N another cycle intersecting with c at u
(there are two cases indicated in the figure), a contradiction.

2

We introduce a list of subgraphs C1 , . . . , C9 of M C(G) that will be used in the sections below
(Figure 5) to detect the cycles in the roots of G.
C2 is a star of M C(G) consisting of at least two edges such that all of its edges have weight 3
and non of them belongs to a subgraph C1 .
C6 is a cycle which is not contained in any subgraph C3 .
C9 is a segment of weight 3 which is not contained in any subgraph C1 or C2 .
C 0 is a cycle of M C(G) which is different from C1 , C6 and C8 .
11

(a) C1

(b) C2

(c) C3

(h) C8

(d) C4

(i) C9

(e) C5

(f) C6

(g) C7

(j) C 0

Figure 5: Some subgraphs of M C(G) that imply cycles in the roots of G

The other subgraphs have exactly the forms described in the corresponding figures.
The following lemma states a relation between the cycles of M C(G) and the cycles in the 4-leaf
basic g-network roots of G.
Lemma 4 Suppose that G has a 4-leaf basic g-network root N . Then for any cycle C of M C(G),
which is not a 4-cycle in any subgraph C3 of M C(G), there is a cycle c in N such that l(C) = l(c).
And for any subgraph S isomorphic to C3 of M C(G), there is a 6-cycle without invisible vertex
c in N such that l(S) = l(c).
Proof: Let C = [A1 , . . . Ak , A1 ] be a cycle in M C(G). Let us denote the label of Ai Ai+1 by li .
Using Observation 1, N can be constructed by replacing each Ai by a subnetwork of F along
the cycle in a way such that if Ai , Ai+1 has li in common then their corresponding subnetworks
also have the leaves li in common. Since all the graphs in F are connected, that creates a cycle c
in N .

(a)

(b)

(c)

(d)

Figure 6: Some small cycles of N and the corresponding cycles in M C(G)

So if there is an Ai such that N [Ai ] contains a cycle, then this cycle intersects with c. Since
the cycles in N must be pairwise disjoint, in this case the cycle of N [Ai ] must be exactly c. As
indicated in Observation 1, the subnetworks of F contain cycles of at most 6 vertices. By taking
the 4-leaf power of all possible configurations of S(c), there are only 4 cases that the corresponding
12

maximal cliques graph is a cycle: A 3-cycle without any invisible vertex (Figure 6(a)), a 3-cycle
with exactly one invisible vertex (Figure 6(b)), a 5-cycle with exactly two invisible vertices (Figure
6(c)), a 6-cycle with one invisible vertex (Figure 6(d)). It can be verified that in all these cases
that l(c) equals l(C).

Figure 7: A 6-cycle without invisible vertex and
its maximal cliques graph.

Figure 8: N [Ai ] is either a visible or invisible
star.

Especially, for the case of 6-cycle without any invisible vertex, the corresponding maximal
cliques graph is isomorphic to the graph C3 (Figure 7). For the other cases, there is no cycle in the
corresponding maximal cliques subgraphs.
On the other hand, if there is not any Ai such that N [Ai ] contains a cycle, then N [Ai ] is a
visible star or an invisible star for all i. By replacing each node Ai by a visible or invisible star
having A as the leaf set such that if the two maximal cliques have x, y (or x) in common then the
corresponding stars also have two leaves x, y (or x) in common, we obtain a cycle c having l(c) such
that l(c) is equal to l(C) (Figure 8).
2
This lemma shows that M C(G) can contain chordless cycles or G can contain chordless cycles.
This makes a big difference with the k-leaf tree power graphs which were proved to be strongly
chordal [4].
4.4.1

Easy cycles when G is biconnected

They consist of all the big cycles, some 6-cycles with 2 invisible vertices, and some small cycles
without invisible vertices.
Let us denote by C1 (G) the set of subgraphs isomorphic to C1 of M C(G). So it contains all
triangles of M C(G) with 3 edges of the same label weighted by 3.
C2 (G) the set of all subgraphs C2 of M C(G).
C3 (G) the set of all subgraphs isomorphic to C3 of M C(G).
C 0 (G) the set of cycles of M C(G) which are different from C1 , C6 and C8 .
Let Ce (G) = C 0 (G) ∪ C1 (G) ∪ C2 (G) ∪ C3 (G) (e for easy).
Lemma 5 Suppose that G has a 4-leaf basic g-network root N . For any cycle C = [A1 A2 . . . Ak , A1 ]
of C 0 (G), N [Ai ] is either an invisible star or a visible star, and it is an invisible star iff |Ai−1 Ai | =
|Ai Ai+1 | = 1.
Proof: C is not a 4-cycle in any subgraph of C3 (G) because C ∈ C 0 (G). By Lemma 4, any root N
of G contains a cycle c such that l(c) = l(C).
The first case of the proof of Lemma 4 can not happen because in this case, the corresponding
maximal cliques graph is either a triangle or a 4-cycle having all edges of weight 2, so can not be
in C 0 (G).
13

For the second case, N [Ai ] is either a star or an invisible star for any i. Remark that if an
invisible star has two common vertices with another star or invisible star, then a 4 cycle is created.
This cycle intersect with c, a contradiction. Hence an invisible star here has at most one common
vertex with other stars. In other words, if N [Ai ] is an invisible star then Ai−1 Ai , Ai Ai+1 have weight
1. Conversely, suppose that N [Ai ] is a visible star, we will prove that either |Ai−1 Ai | or |Ai Ai+1 |
is greater than 1. If N [Ai−1 ] (resp. N [Ai+1 ]) is also visible star, then Ai Ai−1 (resp. Ai Ai+1 ) has
weight 2. If both N [Ai−1 ] and N [Ai+1 ] are invisible stars, then by Lemma 3 (ii), the middle vertex
of N [Ai ] is not adjacent to any other inner vertex not on c. The later implies that the visible star
N [Ai ] consists of only a middle vertex and a leaf, i.e. it is included in N [Ai−1 ] and N [Ai+1 ], a
contradiction. So, N [Ai ] is an invisible star if and only if the edges Ai−1 Ai , Ai Ai+1 have weight 1.
2

(a) A triangle of C1 (G)
and one of its root

(b) A subgraph of C2 (G) and some of its roots

Figure 9: Illustration of Lemma 6

Lemma 6 Suppose that G has a 4-leaf basic g-network root N , then:
1. For each triangle A1 A2 A3 ∈ C1 (G), N [A1 ], N [A2 ], N [A3 ] are visible quasi stars sharing the
same triangle.
2. For any star S = M A1 . . . Ak of C2 (G) where M is the middle node and k ≥ 2, each N [Ai ]
is a visible star, N [M ] is a cycle having the label set equals to l(M ), and:
- either |M | = 5, then N [M ] is an N5 .
- or |M | = 4, then:
If there is not any edge of weight 2 in M C(G) incident to M , then N [M ] is an N4 .
Otherwise, N [M ] is a N50 and k = 2. Let M M 0 be an edge of weight 2 in M C(G). Then, if
l(M M 0 ) is disjoint with l(M A1 ) ∩ l(M A2 ) then N [M 0 ] is the invisible star having the only invisible
vertex on the cycle of N [M ] as its middle vertex. Otherwise, N [M 0 ] is a visible star.
3. For each subgraph S of C3 (G), N [S] contains a 6-cycle c without invisible vertex such that
l(c) = l(S). Moreover, for any node A of S which has a neighbour node in M C(G) not in S, N [A]
is a visible star.
Proof: 1. This result is the Claim (iii) of Observation 2.
2. For any i = 1, . . . , k, by Claim (v) of Observation 2 we deduce that either both N [M ] and
N [Ai ] are visible quasi stars, or exactly one of them is an N4 or N5 or N50 . If N [M ] is a visible
quasi star, then there can not be 2 edges having weight 3 incident to M , except when M Ai is in a
triangle of C1 (G) which is a contradiction with the definition of C2 (G). So, N [M ] is either an N4
or N5 or N50 . Remark that in these cases the label set of the cycle in N [M ] is equal to l(M ). So:
- If |M | = 5 then N [M ] is an N5 .
14

- If |M | = 4 then N [M ] is either an N4 or N50 .
Remark that if N [M ] is an N4 , then all edges of M have weight 3. So, if there is an edge
M M 0 of weight 2, then N [M ] must be a N50 (the last cycle in Figure 9(b)). In this figure, we can
see that only the two stars having p(y) and p(z) as middle vertices can have 3 common leaves with
N [M ]. Therefore, if l(M M 0 ) is disjoint with l(M A1 ) ∩ l(M A2 ), then l(M M 0 ) = {x, t}, and N [M 0 ]
is the invisible star having the invisible vertex of N [M ] as its middle vertex.
If there is not any edge of weight 2 incident to M , then N [M ] can be either an N4 or N50 .
However, with the constrains that we impose on N (Figure 3(d)), we choose N [M ] as an N4 .
3. In the proof of Lemma 4, we proved that if S is a C3 , then N [S] contains a 6-cycle c without
invisible vertex such that l(c) = l(S). In a S(c), there are 8 networks of the family F consisting of
2 subnetworks N6 and 6 visible stars. Observing that if a maximal clique A corresponds to an N6
then it can not have a neighbour node not in S, otherwise another cycle intersecting with c will be
created. So if a node A of S has a neighbour not in S, then it N [A] must be a visible star.
2
Lemmas 5 and 6 are constructive. So it is possible to construct the roots of each subgraph
S ∈ Ce (G) if we can determine the label of the middle vertex of each visible (quasi) star in the root.
This is also easily done with the following remark.
Remark 1 (Middle vertex) Let N be a 4-leaf basic g-network root of G. Let A be a node of
M C(G) such that N [A] is a visible (quasi) star. Let B be a neighbour of A in M C(G) such that
|AB| ≥ 2 and N [B] is not an N6 . Then the label of the middle vertex of N [A] is contained in
l(AB).

(a)

(b)

(c)

(d)

(e)

Figure 10: The leaf of the middle vertex of N [A] is a leaf of N [B]
This remark can be easily proved by checking all the possible configurations of N [B]. Indeed,
remark that N [B] is not an invisible (quasi) star because otherwise |AB| = 1. For any other
configurations of N [B], the leaf of the middle vertex of N [A] is always a leaf of N [B] (see Figure
10).
So, the choice of the label of the middle vertex of N [A] is unique except in some case when A
has at most one such neighbour node. For the later case, let B be the only neighbour of A such
that |AB| ≥ 2. Then it depends on the configuration of N [B] that we can deduce easily the label of
the middle vertex of N [A]. If B does not have neither a further neighbour C such that |BC| ≥ 2,
then the choice of the label of the middle vertex of N [A] does not influence the construction of the
remaining part of N . Remark that for any S ∈ Ce (G), except the label of the middle vertices of
the visible (quasi) stars, the other part of the roots of S is uniquely determined by Lemmas 5, 6.
Hence, with the above remark, we can consider all roots of S as only one root, because they have
the same configuration and by replacing one by another, we do not change its 4-leaf power as well
as the properties of disjoint cycles. With this convention, we have the following result.
15

Corollary 4 Each subgraph of Ce (G) has a unique root.
By Lemmas 5, 6, and by the condition of vertex-disjoint cycles in the roots of G, we deduce
that all subgraphs of C 0 (G), C1 (G), C3 (G) must be node disjoint and not contain any middle node
of any subgraph of C2 (G).
4.4.2

Other cycles when G is biconnected

The other cycles in the roots of G when G is biconnected consist of all small cycles which are not
detected in the previous section. We will use the subgraphs C4 , . . . , C9 of M C(G) to recognize them.
They are not easy cycle because each such subgraph can have several roots containing different
cycles, and we must consider furthermore conditions to determine which cycles are contained in a
4-leaf basic g-network root of G.
Observation 3 For i = 4, . . . , 9, every 4-leaf basic g-network root of Ci contains a small cycle,
and any subgraph smaller than Ci does not have this property.
Indeed, using Observation 1 and by considering all the possible configurations, we find for each
Ci a finite list of its possible roots. They are the networks in Figures 11, ..., 16. Each root has
exactly one cycle. Note that C9 can actually have some more roots but by the constraints imposed
on the networks, its root have only 2 forms R9,1 , R9,2 . However, not all networks listed in Figures
11, ..., 16 are always roots of the corresponding Ci . We must check furthermore the size of each
maximal clique. For example, with C4 , if the maximal clique D contains more than 3 vertices, then
R4,3 can not be its root because in this network D corresponds to the maximal clique having 3
vertices x, y, z.

(a) C5
(a) C4

(b) R4,1 (A)

(c) R4,2 (A)

(e) R4,4 (x)

(f) R4,5

(c) R5,2 (A)
(d) R4,3 (xz)

Figure 11: C4 and its 4-leaf basic g-network roots

(d) R5,3 (A)

(b) R5,1 (A)

(e) R5,4 (A)

Figure 12: C5 and its 4-leaf basic g-network
roots

Example 2 (Roots of Ci ) C5 has 4 forms or roots: R5,1 , R5,2 , R5,3 , R5,4 . Each form can have
several derivations: for the form R5,1 , we have R5,1 (A) as in Figure 12(b) and also R5,1 (D) by
permuting A and D, B and C. In general, the list of roots of each Ci is generated up to permutation
with respect to symmetry.
16

(a) C6

(b) R6,1 (yztu)
(a) C7

Figure 13: C6 and its 4-leaf
basic g-network roots

(a) C8

(b) R7,1 (Ay)

(c) R7,2 (xz) (d) R7,3 (Ay)

Figure 14: C7 and its 4-leaf basic g-network roots

(b) R8,1 (AB) (c) R8,2 (AB)

(a) C9

(b) R9,1 (xy) (c) R9,2 (Axy)

Figure 15: C8 and its 4-leaf basic g-network Figure 16: C9 and its 4-leaf basic g-network
roots
roots
These subgraphs in M C(G) are not necessarily node-disjoint, and they are not necessarily nodedisjoint with the subgraphs of Ce (G). Moreover, two different subgraphs can contain same cycle in
their roots. We give here 2 examples.
Example 1: the subgraph in the following figExample 2: the subgraph in the following figure consists of two subgraphs C4 and its root
ure consists of a subgraph C4 and a subgraph
contains only one cycle.
C8 . Its root contains only one cycle.

By considering all possible cases, we obtain a list of subgraphs in Figure 17 such that each one
consists of 2 intersecting Ci , Cj but its root contains exactly one cycle. Denote by Ci (G) the set of
all subgraphs in M C(G) isomorphic to Ci and not contained in any subgraphs of Ce (G). Moreover,
to avoid the redundancy of the cycles that they infer, for each subgraph isomorphic to one in Figure
17, we count only one of the two Ci , Cj into the corresponding list. In the figure, the chosen one is
in bold.
Let Co (G) = ∪ Ci (G) for i = 4, . . . , 9 (o for other), then we have the following remark. Suppose
that G has a 4-leaf basic g-network root N . Let S1 , S2 be two distinct subgraphs of Ce (G) ∪ Co (G),
then the cycles in N [S1 ] and N [S2 ] are distinct.
Lemma 7 Suppose that G is biconnected and has a 4-leaf basic g-network root. Then there is a
4-leaf basic g-network root N of G such that any cycle of N is contained in a root of a subgraph of
Ce (G) ∪ Co (G).
Proof: Let c be a cycle of N . We consider each possible configuration of c.
17

(a) C4 + C4

(b) C4 + C5

(c) C4 + C6

(g) C5 + C8

(d) C4 + C7

(h) C7 + C9

(e) C4 + C8

(f) C5 + C7

(i) C7 + C2

Figure 17: The list of subgraphs in which each one consists of two Ci , Cj but infers only one cycle
in its roots. The bold one is the one chosen to put into the corresponding list.

If c is a big cycle, or a 6-cycle with 2 invisible vertices of distance 3, then the maximal cliques
graph of the 4-leaf power of S(c) is a cycle of C 0 (G). Hence, c is contained in a root of a subgraph
of C 0 (G).
If c is a triangle without invisible vertex, then by the constraint imposed on the roots of G, c
has at least two vertices which are adjacent to other inner vertices not on c. The corresponding
maximal cliques graph is then either C1 or C9 . So c is contained in a root of C1 (G) or C9 (G).
Similarly, we show the other cases.
If c is a 6-cycle with one invisible vertex, then c is contained in a root of a subgraph of C6 (G)
of C 0 (G).
If c is a 4, 5-cycle without invisible vertex, then c is contained in a root of a subgraph of C2 (G).
If c is a 6-cycle without invisible vertex, then c is contained in a root of a subgraph of C3 (G).

(a)

(d)

(b)

(e)

(c)

(f)

Figure 18: Replacing some subnetworks cycles by subnetworks without cycle
If c is a triangle with one invisible vertex: If it is contained in a network as R8,1 , then c is
18

contained in a root of a subgraph of C8 (G). Otherwise, we can replace it by the network in Figure
18(a) which does not contain any cycle and the resulting network is still a root of G.
If c is a 4-cycle with one invisible vertex: If C is contained in a network as R4,1 or R5,1 or R7,1 ,
then c is contained in a root of a subgraph of C4 (G) or C5 (G) or C7 (G). Otherwise, we can replace
it by the network in Figure 18(b) right.
If c is a 4-cycle with two invisible vertices (Figure 18(c) left), then M C(G) consists of only
nodes AB connected by an edge of weight 2. So, N in the Figure 18(c) right is a root of G and it
does not contain any cycle.
If c is a 5-cycle with one invisible vertex: If c is contained in a network corresponding to a root
of C2 or as R5,2 or R7,2 , then c is contained in a root of a subgraph of C2 (G) or C7 (G). Otherwise,
we can replace it by the network in Figure 18(d) right.
If c is a 5-cycle with two invisible vertices: If c is contained in a network as R4,3 or R5,2 or R8,2 ,
then c is contained in a root of a subgraph of C4 (G) or C5 (G) or C8 (G). Otherwise, we can replace
it by the network in Figure 18(e) right.
If c is a 6-cycle with two invisible vertices of distance 2: If c is contained in a network as R4,2
or R4,4 or R5,3 or R5,4 or R7,3 , then c is contained in a root of a subgraph of C4 (G) or C5 (G) or
C7 (G). Otherwise, we can replace it by the network in Figure 18(f) right.
Finally, if c is a 6-cycle with 3 invisible vertices, then c is contained in a root of a subgraph of
C4 (G).
2
So, if G is biconnected, the sets Ce (G) and Co (G) capture all the cycles that appear in a root of
G, and different cycle is contained in a root of a different subgraph. There may exist some roots of
G which contain other cycles but we can always replace them by the subnetworks without cycles
as in Figure 18.

Further conditions for the roots of Ci , i = 4, 5, . . . , 9
With a given S ∈ Co (G), not every root of S can always appear in some basic g-network root of G,
if there is any. For example, let S ∈ C4 (G) as in Figure 11(a). If in M C(G), A has a neighbour node
not in S, then by Lemma 3 (iii), N [A] can not be an invisible (quasi) star. So, the root R4,1 (A) of
S can not be presented in any 4-leaf basic g-network root of G. A further example is the following.
Example 3 Let M C(G) be the graph in Figure 19 where A is a maximal clique of G consisting
of {m, k, u, s}. S consists of M, A is a subgraph of C9 (G). Let us consider the two roots R1 , R2 of
S. R1 is an induced subgraph of a 4-leaf basic g-network root of G. However, if we choose R2 as a
root of S to reconstruct a root of G, we obtain a network having intersecting cycles. So, R2 will be
not chosen to construct 4-leaf basic g-network roots of G.
Before presenting the way to choose the appropriate roots for each subgraph of Co (G), we show
some properties that these roots must have.
For any S ∈ Co (G), we denote by ext(S) the induced subgraph of M C(G) consisting of S and
all nodes of M C(G) having distance at most 2 to at least a node of S. For example in Figure 19,
if S is the edge M A, then ext(S) is the path [M, A, B, C].
Lemma 8 Let A be a node of a subgraph S ∈ Co (G). Let us consider the nodes around S in ext(S).
For any 4-leaf basic g-network root N of G:
(i) If A has a neighbour node not in S, then N [A] is not an invisible (quasi) star.
19

YES

R1

R2

NO

Figure 19: An example of r(S)

(ii) Suppose that there are two nodes B, C 6∈ S such that B is a neighbour of A, and C is a
neighbour of B but not of A:
- If S 6∈ C9 (G), then N [A] is a visible star.
- If S ∈ C9 (G), then N [A] is either a visible (quasi) star or N50 . Moreover, if N [A] is an
N50 , then N [B] is a visible star.
Proof: (i) This claim is deduced from Lemma 3 (iii).
(ii) By Claim (i), N [A] can not be an invisible (quasi) star because otherwise it can not have
the neighbour B.
- Suppose that S 6∈ C9 (G): By observing the lists of roots of each Ci where i = 4, . . . , 8, we see
that N [A] is either a visible star, or N50 or N500 or N6 .
The only configuration of N [S] such that N [A] is an N50 is R7,2 (Figure 14(c)), i.e. S ∈ C7 (G).
Then N [B] is necessarily a visible star having the middle vertex on the cycle of N [A], and B must
have 3 common vertices with A. So, (A, B) corresponds to a subgraph S1 in either C9 (G) or C2 (G).
It means that S ∪ S1 is isomorphic to the subgraph in either Figure 17(h) or 17(i). However, by
definition, the cycle of N [A] is implied from S1 , not from S, and S is not chosen to be in C7 (G), a
contradiction.
If N [A] is N500 , then the possible configurations of N [S] are R4,3 , R5,2 , R8,2 . Moreover, N [S] can
not be R8,2 because in this network, all 2 possible neighbours of the maximal cliques corresponding
to N500 are in S. It means that A can not have such a neighbour B. So, N [S] has form of either
R4,3 or R5,2 , i.e. S is either in C4 (G) or in C5 (G). N [B] can not be an invisible (quasi) star because
otherwise it can not have such a neighbour C (by Lemma 3 (iii)). N [B] can not contain a cycle
because otherwise its cycle intersects with the cycle of N [A]. So, N [B] must be a visible star
having the middle vertex on N [A]. However, that will create a triangle ABX in M C(G), where X
is the neighbour of A in S such that N [X] is a visible star having the middle vertex on N [A]. Let
S1 = (ABX), so S1 is a subgraph of C8 (G). It means that S ∪ S1 is isomorphic to the subgraph in
Figure 17(e) or 17(g). However, by definition, in this case S is not chosen to be in C4 (G) or C5 (G),
and the corresponding cycle in N [A] is implied from S1 , not from S.
Similarly, if N [A] is N6 , by analysing the lists of roots as above, we deduce a contradiction.
20

Hence, N [A] is a visible star.
- Suppose that S ∈ C9 (G): So N [S] has form of either R9,1 or R9,2 where N [A] is either a visible
(quasi) star or isomorphic to N50 . In the latter case, if N [B] contains a 4, 5, 6-cycle, it will intersect
with the cycle of of N [A]. If N [B] is an invisible (quasi) star then its middle vertex must be on
the cycle of N [A], and B does not have the neighbour C, a contradiction. If N [B] is a visible quasi
star then its triangle intersect with the cycle of N [A]. Hence, N [B] must be a visible star.
2
By observing the lists of roots of Co (G), we deduce the following.
Observation 4 (i) For i = 4, 6, 8, 9, ∀S ∈ Ci (G), every root of S contains a cycle c such that
l(S) ⊆ l(c).
(ii) ∀S ∈ C5 (G), denote by lc(S) the only common vertex of the 4 maximal cliques of S, then
every root of S contains a cycle c such that lc(S) ∈ l(c).
Example 4 (i) The subgraph C4 in Figure 11(a) has several roots, but the cycles in all of its roots
always have the label set contains {x, y, z}, i.e. equals to l(S).
(ii) The subgraph C5 in Figure 12(a) has several roots, but the cycles in all of its roots always
have the label set containing x, which is the common vertex of the 4 maximal cliques of this subgraph.

The following definition shows how to determine the appropriate roots of each subgraph of
Co (G).
Definition 4 Let S ∈ Co (G), we define r(S) as the set of roots r of S such that:
1. The cycle c in r is vertex-disjoint with the cycle in the root of every subgraph of Ce (G).
Moreover, l(c) is disjoint with l(S 0 ) for any S 0 ∈ Ci (G), i = 4, 6, 8, 9 and it is disjoint with lc(S 0 )
for any S 0 ∈ C5 (G).
2. r is the induced subgraph of a 4-leaf basic g-network r0 where r0 is a root of ext(S) which
satisfies the properties in Lemma 8.
The following properties of r(S) can be deduced from the above definition.
Lemma 9 Let S ∈ Co (G), and let r0 , r1 be two distinct networks of r(S). For i = 0, 1, let ri0 be a
root of ext(S) which satisfies the properties in Lemma 8 such that ri is the induced subgraph of ri0
on S . Let A be a node of S which has a neighbour B and B has a neighbour C not adjacent with
A such that B, C 6∈ S, then:
1. r00 [A ∩ B] and r10 [A ∩ B] have the same configuration.
0
2. Denote by r0,1
the network obtained by overlaying the common part of r00 [S] and r10 [B ∪ C]
0
on A ∩ B. Then they cycles in r0,1
are vertex-disjoint.
Proof: Remark that dM C(G) (A, B) = 1, dM C(G) (A, C) = 2, so B, C ∈ ext(S).
1. Let M be a neighbour of A in S, and let r0 be a certain 4-leaf basic g-network root of ext(S)
which satisfies the properties in Lemma 8. We will prove that r0 [A ∩ B] has only one configuration
by considering all possible cases:
(i) If S 6∈ C9 (G), let l(AM ) = {m, k}. By Lemma 8 (ii), r0 [A] is a visible star.

21

(i)-a If |AB| = 1, let l(AB) = {m}, then r0 [A] has p(m) as its
middle vertex, and r0 [B] must be an invisible (quasi) star (according to
Observation 2 (iv)). The configuration of r0 [A ∩ B] is as the figure on
the right.
(i)-b If |AB| = 2 and l(AM ) ∩ l(AB) = {m}, let l(AB) = {m, q},
then due to Remark 1, p(m) must be the middle vertex of r0 [A]. We
have the configuration as the figure on the right.
D

kx

B C
M A
(i)-c If |AB| = 2 and l(AM ) ∩ l(AB) = ∅, then
=
qs
mk
mx
(M, A, B) is a subgraph C7 .
E D
B
k
0
If S ∪ S has the configuration C4 + C7 as in Figure 17(d) where
s
0
0
x
q
S is a C4 , then r [M ] is a N6 , r [A] is a visible star. We have
m
E
the configuration as the figure in the right.
Otherwise, the cycles in the root of S and S 0 are distinct. S 0 can have 3 forms of roots: R7,1 ,
R7,2 , R7,3 .
- If r0 [M, A, B] has form R7,1 , and r0 [M ] is an invisible star, then the cycle in the root of
0
S and S is the same, a contradiction. So in this case r0 [B] is an invisible star, i.e. B can not have
a neighbour C, a contradiction.
- If r0 [M, A, B] has form R7,2 , then all the four vertices p(m), p(k), p(q), p(s) are contained
in the cycle of this root. However, by observing the lists of roots of each Ci , we see that either
p(m) or p(k) must be contained in the cycle of every root of S. So, these two cycles intersect,
contradicting r0 is a g-network.

S0

- Hence, r0 [M, A, B] has form R7,3 where
r0 [B] is an N6 as in the figure on the right and
the middle vertex of r0 [A] is on the cycle of r0 [B].
(i)-d If |AB| = 3, let l(AB) = {m, q, s}, then according to Observation 2 (ii), r0 [B] is
either a visible quasi star or N4 or N5 or N50 . By Remark 1, p(m) is the middle vertex of r0 [A]. We
have the configuration in the following figure.

(ii) If S ∈ C9 (G), let l(AM ) = {m, k, s}, then |AB| = 2 and l(AB) ∩ l(AM ) 6= ∅. The roots
of S have two forms: R9,1 and R9,2 . There are 2 following cases.

22

(ii)-a |l(AM ) ∩ l(AB)| = 1, let l(AB) = {m, u}. r0 [B]
must be a visible (quasi) star having p(u) as its middle vertex.
If r0 [S] has form R9,1 where r0 [A] and r0 [M ] are two visible quasi
star sharing the same triangle, then by Remark 1, the middle
vertex of r0 [A] is p(m). If r0 [S] has form R9,2 then r0 [A] is an
N50 and r0 [B] is a visible star. Moreover, if r0 [B, C] contains a
cycle passing p(u), then N [S] has form R9,1 because otherwise
the cycle in r0 [B, C] will intersect with the cycle in r0 [S].
(ii)-b |l(AM ) ∩ l(AB)| = 2, let l(AB) = {m, k}. Suppose that r0 [S] has form R9,1 , then for any configuration of r0 [B],
|l(M A) ∩ l(AB)| ≤ 1, a contradiction. So, r0 [S] has form R9,2 where
r0 [A], r0 [B] are two visible stars having either p(m) or p(k) as their
middle vertices. Moreover, if l(AB) ∩ l(BC) = {k}, then r0 [B] has
p(k) as its middle vertex, and r0 [A] has p(m) as its middle vertex.
We see that in each case the possible configurations of r0 on A ∩ B are unique even in the case
that it has several possible configurations on M, A, B, C as in the cases (i)-d, (ii)-a. In other words,
r00 [A ∩ B] and r10 [A ∩ B] have the same configuration.
2. Due to Claim 1, we can combine r00 [S] with r10 [B, C] by overlaying their common part on
0 . So we have r 0 [S] = r 0 [S] and r 0 [B, C] = r 0 [B, C]. Suppose
A ∩ B to obtain the network r0,1
0,1
0
0,1
1
0
0 [S] and c is contained in
that r0,1 has two intersecting cycles c0 , c1 . Then c0 is contained in r0,1
1
0 [B, C]. This claim will also be proved by considering all possible cases that are analysed above.
r0,1
0 [A] is a visible star. So c is contained in r 0 [M ], and it
(i) If S 6∈ C9 (G): In this case r0,1
0
0,1
0
passes the middle vertex of r0,1 [A]. In order that c0 and c1 intersect, the cycle c1 must be contained
0 [B] and c , c intersect at the middle vertex of r 0 [A].
in r0,1
0 1
0,1
0 [B] must be an invisible (quasi) star. Then in order that r 0 [B]
(i)-a As proved above, r0,1
0,1
contains a cycle, it must be an invisible quasi star and its triangle contains p(m). However, the
other leaf of this triangle is also contained in A. It means that A, B have more than one common
vertices, a contradiction.
(i)-b We consider furthermore the node C to determine the possible forms of r0 [B] where
r0 is a certain 4-leaf basic g-network root of G which satisfies the properties in Lemma 8. In this
case, r0 [B] is either a visible (quasi) star, N50 , N500 or N6 . It can be checked that each possible
configuration of BC brings about a unique configuration of r0 [B]. So r00 [B] and r10 [B] are the same.
Since r00 is a g-network, r00 [M ] and r00 [B] do not contain intersecting cycles. Hence, the cycles in
0 [M ] = (r 0 [M ]) and r 0 [B] = (r 0 [B] = r 0 [B]) do not intersect.
r0,1
0
0,1
1
0
(i)-c For a certain r0 , it can be seen that r0 [B] has only one configuration which is N6
and this cycle passes the middle vertex of r0 [A]. Hence, the cycles in r00 [B] and r10 [B] are the same.
0 [M ] and r 0 [B] do not intersect.
Similarly with the above case, we deduce that the cycles in r0,1
0,1
(i)-d It can be seen that in all possible configurations, r00 [B] and r10 [B] contain a cycle
0 [M ] and r 0 [B] have p(m) as a common vertex, then r 0 [M ] = (r 0 [M ]) and
passing p(m). If r0,1
0,1
0
0,1
r00 [B] also have p(m) as a common vertex. The later is a contradiction because r00 is a g-network.
(ii) If S ∈ C9 (G):
(ii)-a Suppose that r00 corresponds to the first configuration and r10 corresponds to the
0 [A] is a visible quasi star having p(m)
second configuration of the case (ii)-a in Claim 1. Then r0,1
0
as its middle vertex and r0,1 [B] is a visible star having p(u) as its middle vertex. It means that the
0 [A], and c must be contained in r 0 [C]. However, these two cycles
cycle c0 is the triangle of r0,1
1
0,1

23

do not intersect.
Suppose that r00 is the second configuration and r10 is the first configuration of the
0 [A]. We know that r 0 [B, C] is a
case (ii)-a in Claim 1. Then c0 is contained in cycle N50 of r0,1
0,1
0
0 [B] is
visible (quasi) star. In order that r0,1 [B, C] contains a cycle intersecting with c0 , either r0,1
0 [C] contains a cycle passing the middle vertex of r 0 [B]. In the first
a visible quasi star or r0,1
0,1
0
case, we deduce that r1 [A] and r10 [B] have 3 common leaves, a contradiction because |AB| = 2. In
the second case, we deduce that C is contained in a subgraph S1 of Ci (G) where i ∈ {4, 5, 6, 8, 9}.
So, the label of the middle vertex of r10 [B] intersects with either l(S1 ) if i ∈ {4, 6, 8, 9} or lc(S1 )
if i = 5. The later shows that r10 does not satisfy the property 1 of Definition 4, i.e r10 6∈ r(S), a
contradiction.
(ii)-b r0 [A, B] has a unique configuration as indicated in the case (ii)-b of Claim 1. In
this configuration r0 [A] contains the cycle c0 and r0 [B] is a visible star. So, c0 is contained in
0 [A] and c is contained in r 0 [C]. Moreover, r 0 [A] = r 0 [A]. If c intersects with c , then the
r0,1
1
0
0
0,1
0
1
0 [C]) also intersects with the cycle in r 0 [A] = (r 0 [A] = r 0 [A]). The later is a
cycle in r10 [C] = (r0,1
1
0
0,1
contradiction because r10 is a g-network.
2
Theorem 3 Let G be a biconnected graph which has a 4-leaf basic g-network root N0 , and S ∈
Co (G).
1. Let r0 = N0 [S], then r0 ∈ r(S)
2. For any other network r1 ∈ r(S) different from r0 , we can replace r0 in N0 by r1 and the
obtained network N1 is also a 4-leaf basic g-network root of G.
Proof: (i) It is obvious that r0 is a root of S. We have to show that r0 satisfies the 2 conditions
in Definition 4. Let c be the cycle in r0 . The first condition: we know that the cycle in the root
of each subgraph in Ce (G) is contained in N0 , then c can not intersect with any of them. For any
S1 ∈ Co (G) different from S, N0 [S1 ] contains a cycle different from c. So, l(c) can not intersect
with the leaf set l(S1 ) if S1 ∈ Ci (G) where i = 4, 6, 8, 9 or with lc(S1 ) if S1 ∈ C5 (G). The second
condition is obviously satisfied because r00 = N0 [ext(S)] is a root of ext(S) and it obviously has the
properties in Lemma 8 because N0 is a 4-leaf basic g-network root of G. Moreover, r0 is an induced
subgraph of r00 on S. Therefore, r0 ∈ r(S).
(ii) Let r1 be another root of r(S) different from r0 (Figure 4), so there is basic g-network r10
which is a root of ext(S) and satisfies the properties in Lemma 8 such that r1 = r10 [S]. We will
construct a basic g-network N1 as follows. Let H1 , . . . , Hm be the connected components of M C(G)
obtained after deleting S. Then for each Hi , there are two possible cases.
Case (a): If all nodes of Hi are adjacent to at least a node of S, then denote N i = r10 [Hi ].
Case (b): Otherwise, let N i = N0 [Hi ].
In case (a), both N i and r1 are induced subgraphs of r10 , then we can combine N i with r1 by
overlaying their common part. In case (b), let A be a node of S with has a neighbour B and
B has a neighbour C such that B, C ∈ Hi . So the common vertices of Hi and S are contained
in A ∩ B. According to Claim 1 of Lemma 9, r00 [A ∩ B] and r10 [A ∩ B] are the same. Moreover,
r00 [A ∩ B] = N0 [A ∩ B] = N i [A ∩ B], and r10 [A ∩ B] = r1 [A ∩ B]. Then N i [A ∩ B] and r1 [A ∩ B] are
the same. So, we can also combine N i with r1 by sticking their common part on A ∩ B (Figure 4).
Denote the obtained network by N1i .
It is easy to see that N1i is a 4-leaf root of S ∪ Hi . Indeed, for case (a), both r1 and N i is
an induced subgraphs of r10 , i.e. N1i = r10 [S ∪ Hi ]. We know that r10 is a root of ext(S), so N1i
is a root of S ∪ Hi . For case (b), we have (N1i [S])4l = r14l = S, and (N1i [Hi ])4l = (N i )4l = Hi .
24

A'
x

xt

ac

A yw

M

A'

w

t

F

yv

yz

F

v

B wa

C
ab

A'
C

c

E

z

D

a

A

A

r1

N0
A'

y

C

w

x

c

r1

t

C
y

w

c
E

E

w

z

y
A

w

M

b

B

D

t
z

y
z

A'

M

t

y

MC(G)

x

x

E

M

a

D
b

B

N

i

A

D

a
b

B

N1i

Figure 20: S = (A0 , M, A). The two subnetworks r0 , r1 of r(S) are in bold.

Moreover, for any x ∈ S \ Hi , y ∈ Hi \ S, dN0 (x, y) and dN i (x, y) are both greater than 4. Hence,
1
(N1i )4l = (N0 [S ∪ Hi ])4l = S ∪ Hi . Then N1i is a 4-leaf root of S ∪ Hi .
Let N1 be the network obtained by combining all N i to r1 as described above for every Hi .
Hence, N1 is a 4-leaf basic network root of G.
We must show furthermore that N1 is a g-network, i.e. its cycles are pairwise vertex disjoint.
Let c be the cycle of r1 . All cycles of N1 different from c are pairwise vertex-disjoint because by
construction, they are also the cycles of N0 and N0 is a g-network. So, it remains to show that not
any cycle in N1 different from c intersects with c. By Definition 4, c does not intersect with the
cycle in the root of any subgraph of Ce (G). Suppose that there is a cycle c0 in N1 that intersects
with c. Because c0 does not contained in the root of any subgraph of Ce (G), it is a small cycle
and different from a 6-cycle without invisible vertex. For all possible configurations of c0 , it can be
checked that c0 is contained in N1 [X] where X is a node in ext(S). Moreover, X can not be in S
because otherwise r1 contains two cycles c, c0 . So, X ∈ ext(S) \ S. Suppose that X is a node of
a certain Hi in case (a). Then by construction, N1i is an induced subgraph of r10 . Since r10 does
not contain intersecting cycles, therefore N1i can not have intersecting cycles, contradicting the two
intersecting cycles c, c0 be both in N1i . Otherwise X is a node of a certain Hi in case (b). So, there
exist two nodes B, C in H i such that B, C are adjacent and B has a neighbour A in S where either
X = B or X = C. However, by Lemma 9, r10 [S] and r00 [B, C] do not have intersecting cycles. It
means that N1i [S] = (r10 [S]) and N1i [B, C] = (r00 [B, C]) do not have intersecting cycles. In other
words, c, c0 do not intersect. Hence, N1 is a basic g-network.
Therefore, N1 is a 4-leaf basic g-network root of G and N1 is obtained by replace r0 in N0 by
r1 .
2

25

Using Definition 4 and Lemma 8, one can calculate for each subgraph S of Co (G) the root set
r(S) basing on the lists of roots in Figures 11, ..., 16 and the analysis of configurations in the proof
of Lemma 9. However, Theorem 3 does not hold when G is not biconnected.
4.4.3

Other cycles when G is not biconnected

When G contains several blocks, we consider separately each block and construct 4-leaf basic gnetworks roots of each one. However, there are some conditions must be taken into account on the
roots of two adjacent blocks.
Lemma 10 Let B1 , . . . , Bm be the blocks of G. Then G is a 4-leaf basic g-network power if and
only if each Bi is a 4-leaf basic g-network power and for any two blocks Bi , Bj having a common
vertex x, there exist some roots Ni , Nj of Bi , Bj such that:
- either all the neighbours of p(x) in Ni are invisible or all the neighbours of p(x) in Nj are
invisible.
- if p(x) is contained in a cycle of Ni (resp. Nj ) then it is not contained in any cycle of Nj
(resp. Ni ).
Proof: ⇒ Suppose that G has a 4-leaf basic g-network power N . Let Ni = N [Bi ] for any i = 1, . . . k,
so each Ni is a 4-leaf basic g-network root of Bi . Suppose that there is a neighbour Ci of p(x) in
Ni and a neighbour Cj of p(x) in Nj which are both visible. Let yi , yj be the leaves attached to
Ci , Cj . So the distance of yi , yj is 4, or yi yj are connected in G, which is a contradiction with the
fact that Bi , Bj are 2 distinct blocks.
The second condition is implied from the fact that N is a g-network and so its cycles are pairwise
disjoint.
⇐ Suppose that each Bi has a 4-leaf basic g-network rot Ni and the two conditions are satisfied.
We construct N by combining all Ni by the same way in [5]: For any cut-vertex x corresponding
to a leaf which is a cut-vertex of G, we glue p(x) together and remove all copies of x except one.
So N is a 4-leaf root of G and N is a g-network. Indeed, the distance between any 2 leaves in one
block does not change, the distance between any 2 leaves of 2 distinct blocks which do not equal
the cut-vertex of these blocks are always greater than 4 (from the first condition), and the cycles
in N are pairwise disjoint (from the second condition and from the fact that each Ni is a basic
g-network).
2
By Lemma 10, the conditions at the cut-vertices of G impose some further cycles in the roots of
G apart from those in the roots of the subgraphs in Ce (G) and Co (G). The subgraphs C10 , C11 , C12
in the following allow us to recognize them.
yz
Let C10 (G) be the set of subgraphs of M C(G) which is not contained in any subA
C
graphs of Ce (G) ∪ Co (G) and isomorphic to C10 in the figure on the right where A
contains a cut-vertex of G different from y, z.
xy
Let C11 (G) be the set of subgraphs of M C(G) which is not contained in any subA
C
graphs of Ce (G) ∪ Co (G) and isomorphic to C11 in figure on the right where x is a
cut-vertex of G, and A, C do not have any other neighbours in the same block.
xy
xz
Let C12 (G) be the set of subgraphs of M C(G) which is not contained in any subC
A
graphs of Ce (G) ∪ Co (G) and isomorphic to C12 in the figure on the right where x is
a cut-vertex of G, and A, B, C do not have any other neighbours in the same block.
26

B

And Cc (G) = C10 (G) ∪ C11 (G) ∪ C12 (G) (c for cut-vertex).
The following lemma shows that Cc (G) allows us to recognize the remaining cycles.
Lemma 11 Let G be a 4-leaf basic g-network power and let B be a block of G which is not a
clique and contains a cut-vertex x. Suppose that B has a basic g-network root NB in which p(x) is
adjacent to only invisible vertex. Then NB has a cycle c which is contained in a root of a subgraph
of Ce (B) ∪ Co (B) ∪ Cc (B) such that S(c) contains x.
Proof: By Lemma 3 (i), each of invisible vertices adjacent to p(x) is contained in a cycle of NB .
Because NB does not have intersecting cycles, these invisible vertices are contained in an unique
cycle.
So, there are only 2 possible cases as in the figures on the right, where u, v are
invisible vertices contained in the cycle c. In both two cases, x is contained
in S(c). In the first case, x is contained in exactly one maximal clique of B,
corresponding to the invisible star of u. In the second case, x is contained in
at most 3 maximal cliques of B. Two of them correspond to the two invisible
stars of u, v, and it may exist the third one corresponding to the cycle c passing
p(x), u, v. In the latter case, c must be either N500 or N6 because only these
networks of F can have 2 invisible vertices on their cycle.
Suppose that x is not contained in any subgraph of Ce (B) ∪ Co (B), then the cycle c is not
contained in any root of Ce (B) or Co (B). So c is one of the cycle in the networks that are replaced
by the networks without cycle in the proof of Lemma 7 (Figures 18(a), 18(b), 18(c), 18(d), 18(e),
18(f)). By calculating the corresponding maximal cliques graphs, there are 3 cases:
- x is contained in exactly one maximal clique A of B, then x is contained in a subgraph of
C10 (B).
- x is contained in exactly two maximal cliques A, C of B, then x is contained in a subgraph
of C11 (B). Indeed, if A, C have neighbours in B, then by checking the root list we see that the
corresponding subgraph does not have any root in which p(x) is adjacent to only invisible vertex,
a contradiction.
- x is contained in exactly three maximal cliques A, B, C of B, then x is contained in a subgraph
of C12 (B). Indeed, if A, B, C have neighbours in B, then either there is not any root in which p(x) is
adjacent to only invisible vertex, or the corresponding subgraph is in Ce (G) ∪ Co (G), contradictions.
2
For each subgraph C10 , C11 , C12 , we find also a finite list of its corresponding roots (Figures
21, 22, 23). Beside the roots without cycle (Figures 21(f), 22(c), 23(c)), we have also the roots
containing cycles for the case that all neighbour vertices of p(x) are invisible (figures 21(b), 21(c),
21(d), 21(e), 22(b), 23(b)). These cycles do not necessarily appear in the roots of one block (because
we can replace it by a cycless network as proved in Lemma 7), but when p(x) needs to be adjacent
to only invisible vertices, they necessarily appear.
For any subgraph S ∈ Cc (G), we also restrain the choices of roots of S from the full provided
lists as in Definition 4. Hence, the obtained root set r(S) has the same properties as the root set
of the subgraphs of Co (G) in Theorem 3. In fact, only the subgraphs of C10 (G) are concerned here
because by definition the subgraphs of C11 (G) and C12 (G) do not have other neighbours in the same
blocks.
Denote S(G) = Ce (G) ∪ Co (G) ∪ Cc (G) , we have the following lemma.
27

yz
A

C

(a) C10

(b) R10,1 (y)

(c) R10,2

(d) R10,3 (y)

(e) R10,4

(f) R10,5 (y)

Figure 21: C10 and its 4-leaf basic g-network roots, x is a cut-vertex contained in A.

xy
A

xy
A

C

(a) C11

(b) R11,1

(c) R11,2 (x)

xz
C

(a) C12

Figure 22: C11 and its 4-leaf basic gnetwork roots, x is a cut-vertex.

B

(b) R12,1

(c) R12,2

Figure 23: C12 and its 4-leaf basic gnetwork roots, x is a cut-vertex.

Corollary 5 Suppose that G has at least one 4-leaf basic network root. Then there is a 4-leaf basic
network root N of G such that any cycle of N is contained in a root of a subgraph of S(G).
Proof: It can be seen that each cycle listed in Figures 18(a), 18(b), 18(c), 18(d), 18(e), 18(f) of
Lemma 7 is contained in a root of a subgraph of Cc (G) in Figures 21, 22, 23. Combining with the
proof of Lemma 7, we are done.
2
So, we are going to construct the roots of G in which each cycle is contained in a root of a
subgraph of S(G) .
For each block B which contains a cut-vertex x, we introduce two variables cB (x) and iB (x)
with the convention that: cB (x) = true in a root of B if p(x) is not contained in any cycle of this
root, f alse otherwise; iB (x) = true in a root of B if p(x) is adjacent to only invisible vertices in this
root and f alse otherwise. The 2 conditions in Lemma 10 can be rewritten as: in any root of G we
have cB (x) ∨ cB0 (x) = true and iB (x) ∨ iB0 (x) = true for any two blocks B, B 0 sharing a cut-vertex
x. We say that these values are compatible in this case.
If B is a block clique, then by the constraints imposed on the roots of G, we have cB (x) = true
and iB (x) = true because the root of B is an invisible star. So, there is no constraint imposed by
B on the root of B 0 . Hence, we need to consider only the case that neither B nor B 0 is a clique.
If x is not in any subgraph of S(B), then by Lemma 11, Corollary 5, p(x) is not contained in any
cycle and it is adjacent to at least one visible vertex. So in this case, we can impose cB (x) = true
and iB (x) = f alse.
If x is contained in at least a subgraph of S(B) which has several roots and each one gives a
different values for these variables, then we must choose the appropriate one. So, the conditions in
Lemma 10 restrain the choices of roots of each subgraph of S(G) which contains a cut-vertex. For
example, the root set of a subgraph S1 may restrain the choice of roots of a subgraph S2 which is
contained in an adjacent block of the block of S1 . This restriction may influent the choice of roots
of other subgraphs and so on. However, we propose in the following theorem an efficient way to
apply these conditions.
28

Theorem 4 Given S(G) and the root set of each subgraph in S(G), one can find in linear time a
root for each subgraph of S(G), if there is any, such that the conditions in Lemma 10 are satisfied
at any cut-vertex of G.
Proof: Let BC(G) be the block tree of G. We choose a certain node R of BC(G) as its root. At
the beginning, we impose root(S) = r(S), i.e. the root set of S for any subgraph S of S(G). We
apply the condition in Lemma 10 as follows:
- Begin with the blocks corresponding to the leaves of BC(G): for any subgraph S ∈ S(G) of
these blocks, we keep root(S) = r(S).
For each block B of G, denote by BCB (G) the subtree of BC(G) rooted at B.
Induction hypothesis: Let B is the currently considered block, then for any root in root(S) of
a subgraph S of B, there exists at least a root in root(S 0 ) for each subgraph S 0 in any block of
BCB (G) such that the conditions in Lemma 10 are satisfied at any cut-vertex between two adjacent
blocks in BCB (G).
- Consider a block B such that all of its descendants have been already considered. Let B 0
be a block in BCB (G) which has a common cut-vertex x with B. For any subgraph S of S(B)
which contains x, we keep only the roots r in root(S) such that for any subgraph S 0 of S(B 0 ) which
contains x, there is at least a root r0 in root(S 0 ) which gives the compatible values to r.
- We continue this process up to the root R. Suppose that root(S) 6= ∅ for every subgraph S of
the block R. Then by the induction hypothesis, there is at least a root in root(S) for each subgraph
S of any block of BC(G) such that the conditions in Lemma 10 are satisfied at any cut-vertex of
G. Otherwise, if there exists a subgraph S of the block R such that root(S) = ∅, then G is not a
4-leaf basic g-network power.
Finally, we can easily choose for each subgraph S of S(G) a root in root(S) as follows:
- Choose for each subgraph S of R a certain root in root(S).
- Next, for each subgraph S 0 of S(B) where B is a child block of R, choose a certain root in
root(S) which is compatible with the chosen roots on R if they share a common cut-vertex. There
exists always at least such a root due to the above proof.
- We continue to do that down to the leaf block of BC(G).
Hence, the obtained collection of roots verify the property stated in the theorem.
2
We call each collection of roots calculated in Theorem 4 a subroot set of G. So, if R is a
subroot set of G, then each subgraph of S(G) has exactly one root in R. Moreover, the cycles in
the networks of R are pairwise vertex disjoint, and the conditions in Lemma 10 are satisfied at
any cut-vertex x of G. Therefore, according to Corollary 4 and Theorem 3, if G is a 4-leaf basic
g-network power then there is always a basic g-network N containing the subnetworks of R as
induced subgraphs.
Let Rc = {S(c)| c is a cycle in a network of R}, namely a cycle-root set of G.
After constructing the collection of cycles, we consider the remaining parts of the roots in the
next section.

4.5

Putting the things together and constructing the roots

Let N be a basic g-network without invisible vertices. Denote by X(N ) the graph obtained from
N by labelling each inner vertex following the label of its leaf and removing all of the leaves. So X
is a bijection from the set of basic g-networks without invisible vertices to the set of g-networks. It
is easy to see that the 4-leaf power of N is exactly the square of X(N ).
29

Proposition 3 Let H be the square of a tree and its vertices are distinctly labelled.
If H is a clique then the square tree roots of H are all possible stars having vertices set equal to
the vertices set of H.
If H contains 2 maximal cliques then H has two square tree roots, each one consisting of two
adjacent stars. These roots have the same forms but are labelled differently.
If H contains at least 3 maximal cliques then H has a unique square tree root.

(a) A clique and its square tree
roots.

(b) A graph consisting of 2 maximal
cliques and its two square tree roots.

(c) A graph and its unique square tree
roots.

Figure 24: Tree square roots.

Proof: If H is a clique, it is easy to see that its tree roots must be stars. These stars are different
by the labels of their middle vertices (Figure 24(a)).
[4] represents a characteristic of the square of a tree and the way to construct its roots: each
maximal clique corresponds to a star, and the middle vertex of a star is uniquely determined (Figure
24(c)) except when H contains only two maximal cliques. For example H has 2 maximal cliques
A, B, so they have exactly 2 common vertices x, y. So, the star corresponding to A can take either
x or y as its middle vertex, and the star corresponding to B take the other vertex as its middle
vertex. Hence, in this case H has two roots (Figure 24(b)).
2
Given a cycle-root set Rc of G, and a block B of G, denote by Rc [B] the cycles of Rc restricted
on B.
Definition 5 Let B be a block of G and let Rc be a cycle-root set of G. We define B \ Rc as the
graph such that M C(B \ Rc ) is constructed as follows:
For each cycle c in Rc [B], let A1 , . . . , Ak be the nodes of M C(B) corresponding to the visible,
invisible (quasi) stars of S(c). Let M be the node corresponding to the subnetwork of F contains c
if there is any. Then, delete M and all edges between Ai from M C(B).
Example 5 For instance, see the two examples in Figures 25, 26. In Figure 25, M C(B) contains
a cycle which is a subgraph of C 0 (B). By Lemma 5, there is a cycle in any root of B in which each
node A, B, C, D, E, F corresponds to a visible or invisible star of this cycle. So, in M C(B \ Rc ),
we delete the edges between them. In Figure 26, M C(B) contains subgraph AM B in C2 (B). By
Lemma 6, there is a cycle in any root of B in which each node A, B corresponds to a visible star
and M corresponds to the cycle. So, in M C(B \ Rc ), we delete M and the edges M A, M B.

30

W

W

x4 x8
x5
F
x1

x4 x8

E x4 D

E

x3 x4
C
x
x
A B 2 3 Y
x1 x2 x2 x6
x1 x9

X

D

F

C
B

A

Y

x2 x6

x6 x7

x6 x7

x1 x9

Z

X

M C(B)

Z
M C(B\Rc )

Figure 25: Example 1
M

A
xyz
ya
X

B
yzt

A
zb
Y
bc

B

ya
X

Z
M C(B)

M C(B\Rc )

zb
Y
bc
Z

Figure 26: Example 2

Definition 6 (Separating the stars) Let c be a
cycle in a network N . The operation of separating the stars of S(c) is illustrated in the figure, i.e.
the stars which have the middle vertices on c are separated. Denote by T(N) the graph obtained from N
by this operation on all cycles of N .
So, for any network N , T (N ) is a forest. By Lemma
3-(i), if N has an invisible vertex, then it must be
contained in a cycle of Rc [Bi ].
So, each tree of T (N ) is either an invisible star or a tree without invisible vertex.
Theorem 5 Let B1 , . . . , Bk be the blocks of G, then G is a 4-leaf basic g-network power iff G has
a cycle-root set Rc such that for every 1 ≤ i ≤ k, Bi \ Rc is the square of a forest.
Proof: ⇒ Suppose that G has a 4-leaf basic g-network root N . Then, the collection of cycles of
N forms a cycle-root set Rc of G. For each block Bi of G, let Ni = N [Bi ].
If Bi is a clique then N [Bi ] is an invisible star, i.e. it does not contain any cycle. So, B \ Rc = B,
which is obviously the square of a tree.
Otherwise, for any i = 1, . . . , k, we calculate T (Ni ). By Definitions 5 and 6, each connected
component H of Bi \ Rc is a 4-leaf power of a tree T in the forest T (Ni ). If T is an invisible star,
then H is a clique, so it is obviously the square of a tree. Otherwise, T is without invisible vertex,
then H has X(T ) as a square tree root. In other words, Bi \ Rc is the square of a forest.
31

⇐ Suppose that G has a cycle-root set Rc such that Bi \ Rc is the square of a forest for any i.
If Bi is a clique, then we construct Ni as an invisible star having the leaf set equal to the vertex
set of Bi .
Otherwise, we will show a way to construct a network Ni which is a 4-leaf basic g-network root
of Bi . Let H be a connected component of Bi \ Rc , so H is the square of a tree. There are two
cases:
- H is a clique which corresponds to an invisible (quasi) star having the middle vertex on a
cycle of Rc [Bi ]. In this case we construct a 4-leaf root r of H which is an invisible star. It is the
case of the clique (u, t) in Figure 4.
- otherwise, we will construct a 4-leaf root r of H which is a basic tree without invisible vertex.
It is equivalent with constructing a square tree root t = X −1 (r) of H. The root r of H must be
compatible with the cycles in Rc [Bi ], it means that it must satisfy the following conditions: For any
maximal clique A of H such that there is a cycle c of Rc [Bi ] and S(c)[A] is a visible (quasi) star,
then r[A] must be the visible star having the same label of the middle vertex of S(c)[A]. In other
words, t[A] is a star having the same label of the middle vertex of S(c)[A].
For example, in Figure 4, let consider the connected component H which contains the maximal
clique A = (b, c, t, z) of Bi \ Rc . There is a cycle c in Rc [Bi ] where S(c)[A] is a visible star having t
as the label of the middle vertex. So, we construct the root of H as a visible star also having t as
the label of the middle vertex.
There is always such a root of H because:
. If H is a clique, i.e. H = A, then S(c)[A] is certainly a root of H. So we need only to
choose r = S(c)[A].
. If H contains 2 maximal cliques A, B, then the label of the middle vertex of S(c)[A] is one
of the common labels of A, B (see Remark 1). It is also the way that we choose the middle vertex
for the root of H in this case (see Proposition 3).
. If H contains at least 3 maximal cliques, then by Proposition 3, it has a unique square
root t. The label of the middle vertex of t[A], or r[A], and S(c)[A] must have the same label. This
claim is followed from the fact that when we construct the roots for each subgraph S in S(B), we
consider also the nodes around S (see the way of determining the middle vertex in Remark 1 and
of considering the nodes around each subgraph up to distance 2 in Definition 4).
Denote by Fi the forest consisting of the roots of Bi \ Rc such that the root of each connected
component of Bi \ Rc is constructed as above. We calculate Ni by overlaying the common parts
of the stars in the trees of Fi . In fact, Ni = T −1 (Fi ), because this is the inverse operation of
separating the cycles in Definition 6. It is easy to see that Ni is a 4-leaf root of Bi , and each cycle
in Rc [Bi ] is a cycle of Ni .
We must prove furthermore that Ni is a basic g-network. For each block Bi , each cycle of Rc [Bi ]
is a cycle of Ni , so these cycles are vertex disjoint. Suppose that Ni has a cycle c not in Rc [Bi ]. Ni
is a 4-leaf root of Bi , so by Corollary 5, c must be contained in a root of a subgraph S of S(Bi ).
However, by definition of cycle-root set, S must has a root r whose cycle is contained in Rc [Bi ].
This cycle must be exactly c because otherwise r has two distinct cycles, a contradiction. Hence,
Ni is a basic g-network.
Finally, we combine Ni for any i = 1, . . . , k by gluing all p(x) for any cut-vertex x of G and
deleting all copies of x except one. So, the resulting network N is a 4-leaf basic g-network root of
G due to Lemma 10 and the property of the cycle-root set Rc , i.e. no cycles in the roots of two
different blocks of G can intersect.
2

32

We can resume the method to construct a 4-leaf basic g-network root of G in the following
algorithm. See Figure 4 for an illustration.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17

Data: A connected undirected graph G, and a fixed k
Result: A 4-leaf basic g-network root of G, if there exists one
for (each block B of G) do
Calculate M C(B);
Calculate S(B) = Ce (B) ∪ Co (B) ∪ Cc (B);
Construct the root set r(S) of each subgraph S ∈ S(B);
if (∃S ∈ S(B) such that r(S) = ∅) then
return null ;
if (G does not have any cycle-root set) then
return null ;
Calculate a cycle-root set Rc of G.
for (each block B of G) do
Calculate M C(B \ Rc ) and B \ Rc ;
if (B \ Rc is not the square of a forest) then
return null ;
Construct the square root of each connected component of B \ Rc compatible with Rc ;
Construct a 4-leaf basic g-network root of B;
N ← Combine the 4-leaf basic g-network root of each block;
return N
Algorithm 1: Construction of 4-leaf basic g-network root

Corollary 6 Recognizing a 4-leaf power of a basic g-network and constructing one of its roots, if
there is any, can be done in polynomial time.
Proof: We will prove that Algorithm 1 is polynomial.
Calculating the blocks of G is done in linear time.
For each block B of G, let VB , EB be the number of vertices and edges of B. We know that M C(B)
is calculated in |VB |.|EB |2 (Theorem 2) and BC(B) is constructible in linear time O(|VB | + |EB |).
We consider now the complexity to calculate the subgraphs of S(B). It can be deduced from
Lemmas 5, 6 and the lists of roots of C6 , C8 that the subgraphs of C 0 (B), C1 (B), C3 (B), C6 (B),
C8 (B) must be pairwise node disjoint, otherwise the cycles in their roots intersect. Moreover, they
are the only subgraphs of S(B) that contain cycles. It implies that if B is a 4-leaf basic g-network
power, then each non trivial block of M C(B) is a one of these subgraphs.
Remark that:
- Each subgraph of C 0 (B), C1 (B), C6 (B), C8 (B) is a cycle,
- Each subgraph of C3 (B) contains 8 nodes, 12 edges,
- The number of nodes of M C(B) is bounded by 3.|EB | (Corollary 3).
So if B is a 4-leaf basic g-network power, then the number of edges of M C(B) is bounded by
c.|EB |, where c is a constant. Hence, calculating the blocks of M C(B) and checking the form of
each one can be done in O(|EB |).
33

Calculating C2 (B) is also done in O(|EB |).
Calculating the other subgraphs of Co (B), Cc (B) is done in O(|EB |4 ) because each subgraph has
at most 4 nodes. So, its takes in total O(|EB |4 ) to construct S(B).
Next, constructing the root set of each subgraph is done in at most O(|EB |) following the
constructible Lemmas 5, 6 for the subgraphs in Ce (B), and following the provided finite list of
roots, the construction of r(S) in Definition 4 for the subgraphs in Co (B) ∪ Cc (B). There are at
most O(|EB |) subgraphs, then in total it takes O(|EB |2 ) to find the roots set for each subgraph of
S(B).
By Theorem 4, applying the condition between two non-disjoint blocks in order to calculate a
cycle-root set Rc is done in linear time O(|VB | + |EB |).
Calculating B \ Rc , determining if it is the square of a forest [11, 5] and constructing a root of
it by Theorem 5 are done in linear time O(|VB | + |EB |).
Finally, combining the root of the blocks of G is done in linear time O(|V | + |E|).
Then, we have the total complexity is O(|V |.|E|2 + |E|4 ) = O(|E|4 ) (because G is connected).
2
Corollary 7 Recognizing a square of a basic g-network and constructing one of its root, if there is
any, can be done in polynomial time.
Proof: It is easily to see that G is the square of a basic g-network iff it is the 4-leaf power of
a basic g-network without invisible vertex. So, it can be deduced from Theorem 5 that G is the
square of a basic g-network iff G is biconnected, has a cycle-root set Rc such that the cycles in Rc
are without invisible vertex, and G \ Rc is the square of a forest. So, any cycle of C 0 (G) must have
all edges of weight 2. We do not need to calculate Ci (G) for i = 4, . . . , 8 because all roots of these
subgraphs contain at least one invisible vertex. We do not neither have to calculate Cc (G) because
G is biconnected. So, the complexity of this problem is equal to the complexity of calculating the
maximal cliques graph, which is O(|V |.|E|2 ).
2

5

Conclusions and Perspectives

Of course the complexity of our algorithm could be improved, but we hope that these partial
structural results on k-leaf N network power could help to answer the biological question described
in the introduction. We have proven here that the recognition of 4-leaf g-network power graphs is
polynomial. It would be natural to enlarge this result to the class of extended Cactus graphs (with
leaves but for which two cycles share at most one vertex).
But we propose a stronger conjecture in the same flavour that [9]:
Conjecture: The recognition of 4-leaf N power graphs is polynomial for every bounded
treewidth N class of phylogenetic networks.

References
[1] E. Bapteste, MA O’Malley, RG Beiko, M Ereshefsky, JP Gogarten, L Franklin-Hall, FJ Lapointe, J Dupré, T Dagan, and Martin W. Boucher Y. Prokaryotic evolution and the tree of
life are two different things. Biology Direc., pages 4–34, 2009.

34

[2] Eric Bapteste and Richard M. Burian. On the need for integrative phylogenomics, and some
steps toward its creation. Biology and Philosophy, 25(4):711–736.
[3] Andreas Brandstädt. On leaf powers. Technical report, University of Rostock, 2010.
[4] Andreas Brandstädt and Van Bang Le. Structure and linear time recognition of 3-leaf powers.
Information Processing Letters, 98:133–138, 2006.
[5] Andreas Brandstädt, Van Bang Le, and R. Sritharan. Structure and linear-time recognition
of 4-leaf powers. ACM Transactions on Algorithms, 5(1), 2008.
[6] Michael Dom, Jiong Guo, Falk Hüffner, and Rolf Niedermeier. Error compensation in leaf
power problems. Algorithmica, 44(4):363–381, 2006.
[7] Lima-Mendez G, Van Helden J, Toussaint A, and Leplae R. Reticulate representation of
evolutionary and functional relationships between phage genomes. Molecular Biology and
Evolution, 25(4):762–777, 2008.
[8] Alain Gély, Lhouari Nourine, and Bachir Sadi. Enumeration aspects of maximal cliques and
bicliques. Discrete Applied Mathematics, 157(7):1447–1459, april 2009.
[9] Frank Gurski and Egon Wanke. The clique-width of tree-power and leaf-power graphs. In Proceedings of the 33rd international conference on Graph-theoretic concepts in computer science,
WG’07, pages 76–85, Berlin, Heidelberg, 2007. Springer-Verlag.
[10] Michel Habib, Christophe Paul, and Laurent Viennot. A synthesis on partition refinement: A
useful routine for strings, graphs, boolean matrices and automata. In STACS, pages 25–38,
1998.
[11] Paul E. Kearney and Derek G. Corneil. Tree powers. J. Algorithms, 29(1):111–131, 1998.
[12] FJ Lapointe, P Lopez, Y Boucher, J Koenig, and E. Bapteste. Clanistics: a multi-level
perspective for harvesting unrooted gene trees. Trends Microbiology, 18(8):341–347, 2010.
[13] N. Nishimura, P. Ragde, and D.M. Thilikos. On graph powers for leaf-labeled trees. J. of
Algorithms, 42:69–108, 2002.
[14] Dieter Rautenbach. Some remarks about leaf roots. Discrete Mathematics, 306:1456–1461,
2006.

35

