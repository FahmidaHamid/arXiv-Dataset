arXiv:1501.02278v1 [q-bio.QM] 9 Jan 2015

José Henrique Hildebrand Grisi Filho

Caracterização de circuitos pecuários com base em
redes de movimentação de animais

São Paulo
2012

José Henrique Hildebrand Grisi Filho

Caracterização de circuitos pecuários com base em
redes de movimentação de animais

A
ID

Tese apresentada ao Programa de Pós-Graduação em
Epidemiologia Experimental Aplicada às Zoonoses da
Faculdade de Medicina Veterinária e Zootecnia da Universidade de São Paulo para obtenção do tı́tulo de Doutor em Ciências

G
I
R
R
O
C

Departamento:
Medicina Veterinária Preventiva e Saúde Animal

V

S
R
E

O
Ã

Área de concentração:
Epidemiologia Experimental Aplicada às Zoonoses

Orientador: Prof. Dr. Marcos Amaku

De acordo:
Orientador(a)

São Paulo
2012
Obs.: A versão original se encontra disponı́vel na Biblioteca da FMVZ/USP

FOLHA DE AVALIAÇÃO
Nome: Grisi Filho, José Henrique Hildebrand
Tı́tulo: Caracterização de circuitos pecuários com base em redes de movimentação de
animais

Tese apresentada ao Programa de Pós-Graduação em
Epidemiologia Experimental Aplicada às Zoonoses da
Faculdade de Medicina Veterinária e Zootecnia da Universidade de São Paulo para obtenção do tı́tulo de Doutor em Ciências
Data:

/

/
BANCA EXAMINADORA

Prof. Dr. :
Instituição:

Julgamento:

Prof. Dr. :
Instituição:

Julgamento:

Prof. Dr. :
Instituição:

Julgamento:

Prof. Dr. :
Instituição:

Julgamento:

Prof. Dr. :
Instituição:

Julgamento:

Agradecimentos

Ao Prof. Dr. Marcos Amaku, pela orientação, sabedoria, paciência e confiança;
Ao Prof. Dr. Fernando Ferreira, por toda a ajuda, sugestões, apoio e amizade;
Aos colegas Raul e Rı́sia, pelo trabalho em equipe sem o qual esta tese não seria a
mesma;
À todos os colegas do LEB que fazem deste um excelente local de trabalho;
À minha famı́lia, por tudo;

Projeto financiado pela FAPESP e CNPq.
Ao Instituto de Defesa Agropecuária do Estado do Mato Grosso, pela disponibilização
de dados essenciais ao trabalho.

À todos que contribuı́ram, de forma direta ou indireta, para a conclusão desta tese.

RESUMO
GRISI-FILHO, J. H. H. Caracterização de circuitos pecuários com base em redes
de movimentação de animais. [Characterization of production zones based on animal
movement networks.] 2012. 46 f. Tese (Doutorado em Ciências) - Faculdade de Medicina
Veterinária e Zootecnia, Universidade de São Paulo, São Paulo, 2012.
Uma rede é um conjunto de nós conectados entre si por um conjunto de arestas. Redes
podem representar qualquer conjunto de objetos que possuam relações entre si. Comunidades são conjuntos de nós relacionados de uma maneira significativa, provavelmente
compartilhando propriedades e/ou atuando de forma similar dentro de uma rede. Quando
a análise de redes é aplicada ao estudo de padrões de movimentação animal, as unidades
epidemiológicas de interesse (propriedades, estabelecimentos, municı́pios, estados, paı́ses,
etc) são representadas como nós, enquanto a movimentação animal entre elas é representada por arestas de uma rede. Descobrir a estrutura de uma rede, e portanto as
preferências e rotas comerciais, pode ser útil para um pesquisador ou gestor de saúde
animal. Foi implementado um algoritmo de detecção de comunidades para encontrar grupos de propriedades que é consistente com a definição de circuito pecuário, assumindo
que uma comunidade é um grupo de nós (fazendas, abatedouros) no qual um animal vai
mais provavelmente permanecer durante sua vida. Este algoritmo foi aplicado na rede interna de movimentação animal de 2007 do Estado do Mato Grosso. Esse banco de dados
contém informação sobre 87.899 propriedades e 521.431 movimentações durante o ano,
totalizando 15.844.779 de animais movimentados. O algoritmo de detecção de comunidades encontrou uma partição da rede que mostra um claro padrão geográfico e comercial,
duas importantes caracterı́sticas para aplicações em medicina veterinária preventiva, além
de possuir uma interpretação clara e significativa em redes de comércio onde ligações se
estabelecem a partir da escolha dos nós envolvidos.
Palavras-chave: Epidemiologia. Análise de redes. Análise de comunidades. Circuito
pecuário. Movimentação animal.

ABSTRACT
GRISI-FILHO, J. H. H. Characterization of production zones based on animal
movement networks. [Caracterização de circuitos pecuários com base em redes de
movimentação de animais.] 2012. 46 f. Tese (Doutorado em Ciências) - Faculdade de
Medicina Veterinária e Zootecnia, Universidade de São Paulo, São Paulo, 2012.
A network is a set of nodes that are linked together by a set of edges. Networks can
represent any set of objects that have relations among themselves. Communities are
sets of nodes that are related in an important way, probably sharing common properties
and/or playing similar roles within a network. When network analysis is applied to study
the livestock movement patterns, the epidemiological units of interest (farm premises,
counties, states, countries, etc.) are represented as nodes, and animal movements between
the nodes are represented as the edges of a network. Unraveling a network structure,
and hence the trade preferences and pathways, could be very useful to a researcher or
a decision-maker. We implemented a community detection algorithm to find livestock
communities that is consistent with the definition of a livestock production zone, assuming
that a community is a group of farm premises in which an animal is more likely to
stay during its life time than expected by chance. We applied this algorithm to the
network of within animal movements made inside the State of Mato Grosso, for the year
of 2007. This database holds information about 87,899 premises and 521,431 movements
throughout the year, totalizing 15,844,779 animals moved. The community detection
algorithm achieved a network partition that shows a clear geographical and commercial
pattern, two crucial features to preventive veterinary medicine applications, and also has
a meaningful interpretation in trade networks where links emerge from the choice of trader
nodes.
Keywords: Epidemiology. Network analysis. Community analysis. Livestock production
zone. Animal movement.

SUMÁRIO

1 INTRODUÇÃO

8

1.1 Redes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

1.2 Análise de Comunidades em Medicina Veterinária . . . . . . . . . . . .

9

1.3 Definição de Comunidade e Circuitos Pecuários . . . . . . . . . . . . . 11

2 MATERIAIS E MÉTODOS

13

2.1 Base de dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2.2 Detecção de circuitos pecuários . . . . . . . . . . . . . . . . . . . . . . . . 13
2.2.1

Número de Bell, máximos locais e máximos globais . . . . . . . . . . . . . . 16

2.2.2

Otimização da função de modularidade . . . . . . . . . . . . . . . . . . . . . 17

2.2.3

Obtenção de uma solução única . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.3 Avaliação do desempenho do algoritmo . . . . . . . . . . . . . . . . . . . 21
2.3.1

Escalonamento multidimensional . . . . . . . . . . . . . . . . . . . . . . . . 22

2.4 Softwares utilizados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23

3 RESULTADOS

24

4 DISCUSSÃO

30

5 CONCLUSÕES

36

REFERÊNCIAS

37

APÊNDICE

40

8

1 INTRODUÇÃO
1.1

Redes
Uma rede é um conjunto de nós (ou vértices) conectados entre si por um con-

junto de arestas (ou ligações), como demonstrado na figura 1.1. Redes podem representar
qualquer conjunto de objetos que possuam relações entre si. Podem, por exemplo, representar as relações sociais entre indivı́duos (figura 1.2). Em uma rede ponderada cada
aresta possui um valor, que representa a intensidade da ligação entre dois nós. Redes
podem ser direcionadas e não-direcionadas: uma rede direcionada apresenta a direção da
relação entre dois nós, sendo portanto uma ligação de saı́da para um e uma ligação de
entrada para o outro; uma rede não-direcionada assume que a relação entre dois nós é
sempre recı́proca. Em uma rede direcionada e ponderada, o grau de entrada de um nó
(kiin ) é o número de nós conectados a este por ligações de entrada, enquanto o grau de
saı́da (kiout ) é o número de nós conectados a este por ligações de saı́da. Analogamente, o
grau ponderado de entrada (kwiin ) é a soma dos valores das arestas que um nó recebe, e
o grau ponderado de saı́da (kwiout ) é a soma dos valores das arestas que um nó envia. O
grau ponderado total (kwi ) é igual à soma dos graus ponderados de entrada e de saı́da,
enquanto o grau total (ki ) é o número de nós ligados ao nó de interesse, independente da
direção da ligação.
Figura 1.1 - Ilustração de uma rede, com indicação de nós e arestas

Quando a análise de redes é aplicada ao estudo da movimentação animal dentro
de um sistema produtivo, as unidades epidemiológicas de interesse (propriedades, estabelecimentos, municı́pios, estados, paı́ses, etc) são representadas como nós, enquanto a

9
Figura 1.2 - Rede de associações frequentes entre 62 golfinhos de Doubtful Sound, New
Zealand (Lusseau et al., 2003)

movimentação animal entre elas é representada por arestas de uma rede, onde o valor de
cada aresta traz o número de animais comercializados entre dois nós. Assim, o grau de
entrada de um nó equivale à quantidade de unidades que enviaram animais para este e
o grau de saı́da equivale à quantidade de estabelecimentos para os quais um nó enviou
animais. O grau ponderado de entrada equivale à quantidade de animais comprados e o
grau ponderado de saı́da equivale à quantidade de animais vendidos por uma propriedade.
A análise de redes têm sido utilizada para estudar uma grande variedade de problemas
dentro da medicina veterinária, incluindo análises de epidemias (Gibbens et al., 2001),
análises etológicas (Lusseau e Newman, 2004), padrões de distribuição de doenças, modelos preditivos (Harvey et al., 2007), análises de risco, eficácia de sistemas de vigilância
entre outros. Martı́nez-López, Perez e Sánchez-Vizcaı́no (2009) fazem uma revisão sobre
o assunto.
1.2

Análise de Comunidades em Medicina Veterinária
Comunidades são conjuntos de nós relacionados entre si de uma maneira signifi-

cativa, provavelmente compartilhando propriedades e/ou atuando de forma similar dentro
de uma rede. Estudos recentes utilizaram a análise de comunidades em redes de trânsito
animal com o intuito de revelar a estrutura subjacente da rede (Green, Gregory e Munro,
2009; Green et al., 2011; Lentz et al., 2011).

10
Descobrir essa estrutura e portanto as preferências de comércio entre propriedades pode se mostrar útil para um pesquisador ou tomador de decisão. Em primeiro lugar,
permite a identificação dos fluxos de comércio entre zonas de produção, possibilitando
um melhor entendimento do sistema de produção animal. A existência e funcionalidade
de grupos dentro de uma rede pode influenciar o espalhamento de doenças, alterando a
velocidade de espalhamento, o tamanho final e a duração de uma epidemia (Salathé e
Jones, 2010). Análises de comunidade poderiam ser usadas para determinar os grupos de
uma amostra estratificada que visa levar em consideração o trânsito animal, ou ajudar
no planejamento de um sistema de vigilância voltado ao risco, escolhendo grupos de nós
sob risco que possuam intenso comércio entre si. Seria possı́vel, na ocasião de erradicação
de uma doença especı́fica, dividir um programa sanitário em etapas nas quais um grupo
de municı́pios é sanitizado por vez, caso esses municı́pios apresentem baixo risco de reinfecção devido a movimentos oriundos de fora do grupo. Propriedades que compartilham
preferências comerciais podem compartilhar práticas de manejo e biossegurança, e serem
selecionadas para um programa sanitário direcionado. A Organização Mundial de Saúde
Animal (OIE), define em seu Terrestrial Animal Health Code (World Organisation for Animal Health, 2010), os conceitos de zoneamento, regionalização e compartimento. Dada
a dificuldade de estabelecer e manter uma condição livre de doença para o território de
um paı́s inteiro, pode ser vantajoso estabelecer e manter uma subpopulação com condição
sanitária diferenciada dentro de seu território. Assim, a delimitação de zonas sanitárias
dentro de uma região pode levar em consideração não apenas municı́pios com as mesmas
condições sanitárias, mas também regiões que possuam intenso comércio com estes. A
análise de comunidades pode ajudar no planejamento da fronteira deste tipo de área, caso
haja isolamento de uma subpopulação (p.ex, com restrição de movimentação), bloqueando o comércio entre fazendas de áreas diferentes: essa abordagem poderia otimizar a
divisão de tal região e avaliar quanta perda econômica é esperada devido a restrição de
comércio após uma zona especı́fica ser estabelecida.
Esses são apenas alguns exemplos. Como uma técnica exploratória, suas aplicações
são virtualmente infinitas, facilitando a formulação de novas hipóteses, a avaliação de pre-

11
missas, a seleção de futuras ferramentas analı́ticas e o planejamento de futuras coletas de
dados.
1.3

Definição de Comunidade e Circuitos Pecuários
A tarefa de dividir uma rede em comunidades, intuitiva a princı́pio, não é re-

almente bem definida. Os principais elementos do problema, i.e. os conceitos de comunidade e cluster, não são rigorosamente definidos, requerendo um grau de arbitrariedade
e/ou bom senso. Uma grande variedade de algoritmos e ferramentas foram desenvolvidos
para revelar a estrutura comunitária de uma rede (Fortunato, 2010), e a escolha de qual
algoritmo utilizar deve levar em consideração as definições e premissas do modelo, e se os
mesmos são adequados para resolver o problema em questão.
Como notado por Bigras-Poulin et al. (2006), em redes de movimentação de
gados de corte as fazendas agem no geral como produtoras (algumas com grau de entrada igual a zero, chamadas de “fazendas de cria”) de gado, e abatedouros agem como
escoadouros. Esses dois tipos de comportamento impõem um fluxo direcionado à rede.
É portanto razoável assumir que a direção dos movimentos não pode ser ignorada sem a
perda de informação importante, e é melhor usar ferramentas que levem em consideração
essa direção sempre que possı́vel.
As poucas aplicações recentes de detecção de comunidades em redes de trânsito
animal que consideram a direção dos movimentos (Green, Gregory e Munro, 2009; Green
et al., 2011) usam a definição de comunidade dada por Newman e Girvan (2004) e adaptada a redes direcionadas por Leicht e Newman (2008): um conjunto de nós é uma
comunidade se o número de ligações internas a este exceder o esperado para um mesmo
conjunto de nós no modelo nulo (Fortunato, 2010). O que equivale a dizer que os nós que
formam uma comunidade são mais densamente conectados entre si do que um conjunto
similar que não forma uma comunidade. Essa definição é bastante útil e intuitiva, mas
não é a única definição de comunidade possı́vel.
Kim, Son e Jeong (2010) desenvolveram um método para detecção de comunidades que leva em consideração a direcionalidade e o peso das ligações, e que possui

12
melhor desempenho que o método desenvolvido por Leicht e Newman (2008) em alguns
casos, trazendo uma definição de comunidade mais adequada em algumas situações. Esse
método é baseado no cálculo do LinkRank, um conceito derivado do PageRank do Google
(Page et al., 1999). Nessa definição, uma comunidade é definida como um grupo de nós
nos quais um passeador aleatório permanece mais provavelmente do que o esperado pelo
acaso. Se definirmos um circuito pecuário como o conjunto de localidades pelas quais um
animal passará durante o ciclo produtivo (figura 1.3), então essa definição de comunidade
é mais adequada para encontrar tais grupos, especialmente se desejamos compreender os
fluxos entre zonas de produção de uma região ou paı́s. Uma comunidade seria então definida como um grupo de locais onde um animal permanecerá mais provavelmente durante
sua vida (o ciclo produtivo) do que o esperado pelo acaso.
Assim, o objetivo deste estudo foi implementar e testar um método de detecção
de comunidades que identifique circuitos pecuários em uma rede de movimentação de
animais.
Figura 1.3 - Exemplo de circuito pecuário

13

2 MATERIAIS E MÉTODOS
2.1

Base de dados
Foi analisada a rede interna de movimentação de bovinos do Estado do Mato

Grosso do ano de 2007 (movimentos realizados entre 01/01/2007 e 31/12/2007), fornecida
pelo INDEA (Instituto de Defesa Agropecuária do Estado do Mato Grosso). Essa base de
dados contém informações sobre 87.899 propriedades (fazendas, frigorı́ficos, eventos, etc)
e 521.431 movimentos ao longo do ano, totalizando 15.844.779 de animais movimentados.
Essa base foi analisada previamente por Negreiros (2010), que fez uma extensa busca
para eliminar inconsistências cadastrais. O Estado do Mato Grosso é o terceiro maior do
Brasil, com uma área de 903.357 km2 e o maior rebanho nacional, com aproximadamente
28.757.438 bovinos (13% do rebanho nacional em 2010), sendo em sua maioria rebanhos de
exploração de corte (Instituto Brasileiro de Geografia e Estatı́stica, 2010). Está localizado
na região centro oeste do paı́s e possui 141 municı́pios.
Foram extraı́das informações sobre as propriedades de origem e destino e sobre o
número de animais movimentados. Essas informações foram então resumidas para a menor
divisão pública administrativa, agrupando os movimentos feitos por propriedades que
pertenciam ao mesmo municı́pio. A rede analisada possui portanto 141 nós (municı́pios)
e 3.980 arestas, estas últimas ponderadas pelo total de animais movimentados entre dois
municı́pios durante o ano de 2007. A figura 2.1 traz uma representação dessa rede, onde
cada nó está localizado no centróide no respectivo municı́pio (aproximadamente).
2.2

Detecção de circuitos pecuários
Uma partição C é uma divisão de um conjunto de N objetos em clusters (ou

grupos) não vazios e não sobrepostos. Os termos clusters, grupos e comunidades serão
utilizados como sinônimos no presente trabalho. É possı́vel representar uma partição
C como um vetor de tamanho N, no qual o i-ésimo elemento de C é igual o grupo ao
qual pertence o objeto i. Assim, uma partição C = {{1}, {1}, {2}, {2}} é a divisão de
um conjunto de 4 objetos em dois grupos, nos quais os dois primeiros objetos foram

14
Figura 2.1 - Rede de movimentação interna de animais do Mato Grosso durante o ano de
2007. Movimentos agrupados por municı́pios

designados ao primeiro grupo e os dois últimos objetos foram designados ao segundo
grupo. Da definição de comunidades emerge uma função chamada modularidade, a qual
reflete a qualidade de qualquer partição em descrever a estrutura modular presente em
uma rede. Quanto maior o valor de modularidade de uma partição, melhor essa partição
descreve a estrutura da rede. A função de modularidade proposta por Kim, Son e Jeong
(2010) pode ser calculada usando a seguinte equação:

Qlr =

X

[Lij − πi πj ]δgi gj ,

(2.1)

ij

onde Qlr é a modularidade de uma dada partição; Lij é o valor de LinkRank da aresta
que conecta os nós i e j; πi é o valor de PageRank do nó i; πj é o valor de PageRank do
nó j; e δgi gj = 1 caso os nós i e j sejam designados à mesma comunidade e δgi gj = 0 caso
contrário. O valor do LinkRank de uma dada aresta entre os nós i e j é uma medida de
sua importância, dada por:
Lij = πi Gij ,

(2.2)

15
onde πi é o valor de PageRank (Page et al., 1999) do nó i e G é a Matriz Google (“Google
Matrix”, no original), uma matriz de probabilidade para o processo de passeio aleatório.
A equação 2.1 pode então ser formulada da seguinte maneira:

Qlr =

X

πi ∗ [Gij − πj ]δgi gj .

(2.3)

ij

O PageRank é um algoritmo de análise de ligações que produz um ranking global da importância de todos os nós de uma rede, baseado na matriz de probabilidade do
processo de passeio aleatório (também chamado de “caminhada do bêbado”). Tradicionalmente, o cálculo do PageRank leva em consideração o grau de entrada de um nó e
o grau de entrada de seus vizinhos. Alternativamente, o PageRank pode ser calculado
levando em consideração o grau ponderado de entrada de um nó e o grau ponderado de
entrada de seus vizinhos, o que foi feito neste trabalho, dada a importância do número
absoluto de animais movimentados para a definição de circuito pecuário. O PageRank
é uma medida propagada através da rede, baseada na premissa de que nós importantes
recebem ligações de nós importantes (figura 2.2). Para maiores detalhes, veja Langville e
Meyer (2006) e Kim, Son e Jeong (2010).
Figura 2.2 - PageRank calculado em rede simples

Figura 2.2 - Legenda:
Os nós A, B e C recebem o mesmo número de ligações (i.e. grau de entrada igual a 1). No
entanto, o nó C possui um maior valor de PageRank que A e B, porque a ligação que C
recebe provém de um nó importante (com maior grau de entrada, nó D), elevando assim
seu PageRank.

16
2.2.1 Número de Bell, máximos locais e máximos globais
Como pode ser visto na equação 2.1, a modularidade depende da alocação de
N nós em 0 < g ≤ N comunidades não-vazias. Para encontrar a partição de maior
modularidade, seria preciso calcular a modularidade de todas as partições possı́veis. O
número de partições possı́veis para um conjunto de N objetos é dado pelo número de Bell:
N
−1
X



N −1
.
BN =
Bn
n
n=0

(2.4)

Utilizando a equação 2.4, conclui-se que o número de partições possı́veis para um
conjunto de 141 objetos, é de: 28.911.910.353.139.891.247.190.947.943.924.637.289.025.637.429.885.820.537.824.520.005.904648.590.799.334.719.349.750.642.778141.473.707.684.781.558.911.314.718.429.702.080.529.710.551.046.049.912.485.833.910.034.612.983.281.492.385.095, ou aproximadamente 2.89 ∗ 10178 . Considerando que o cálculo da modularidade
de cada partição leve em média 5 milissegundos, o que parece ser uma boa estimativa,
demoraria cerca de 1.6 ∗ 10168 anos para calcular a modularidade de todas as partições
possı́veis. Se fossem utilizados 1.000 computadores apenas para essa tarefa, o tempo seria
reduzido para 1.6 ∗ 10165 anos. Se o cálculo fosse otimizado para ser realizado a cada ciclo
do processador de um computador, utilizando um processador moderno capaz de realizar
5 milhões de cálculos por segundo (5GHz), ainda assim seriam necessários 6.4 ∗ 10160 anos,
utilizando 1.000 computadores apenas para essa tarefa. Se faz necessário, portanto, um
método para descobrir partições com altos valores de modularidade sem ter de calcular a
modularidade de todas as partições existentes.
Um método possı́vel seria começar com uma partição qualquer, digamos C =
{{1}, {2}, ..., {N}} e calcular a modularidade dessa partição. Então em cada passo poderı́amos sortear um nó e verificar se a mudança desse nó para uma comunidade aleatória
forma uma partição de maior modularidade. Caso a nova partição possua uma modularidade maior, passamos a utilizar essa nova partição. Propomos então uma nova mudança e
continuamos até que não seja possı́vel, com qualquer mudança, aumentar a modularidade.

17
A desvantagem desse método é que existe a possibilidade de obtermos uma
partição de baixa modularidade, mas que a partir dela nenhuma mudança única resulte em
aumento de modularidade. Essa situação é conhecida como “máximo local”(figura 2.3).
O máximo de uma função é chamado de “máximo global”. É necessário, portanto, um
método capaz de encontrar o máximo global de uma função sem que seja necessário
calcular a modularidade de todas as partições possı́veis do conjunto de dados.
Figura 2.3 - Exemplo de função com dois máximos locais e um global

2

3

1

Figura 2.3 - Legenda:
Os pontos 1 e 3 indicam máximos locais. O ponto 2 indica o máximo global da função.

2.2.2 Otimização da função de modularidade
Para otimizar a função de modularidade e encontrar uma partição ótima da
rede, foi utilizado o algoritmo de Arrefecimento Simulado (Simulated Annealing - SA)
(Kirkpatrick, Gelatt e Vecchi, 1983). Esse algoritmo é um método de otimização baseado
em um procedimento probabilı́stico que evita que a solução encontrada pertença a um
máximo local, e já foi aplicado para a otimização de modularidade anteriormente (Guimerà
e Amaral, 2005; Kim, Son e Jeong, 2010; Good, de Montjoye e Clauset, 2010).
No estado inicial, cada nó é designado à sua própria comunidade. Em cada passo
do algoritmo, um nó aleatório é designado à uma comunidade aleatória, e a mudança ∆Qlr

18
na modularidade é computada:

lr
∆Qlr = Qlr
n − Qo ,

(2.5)

lr
onde Qlr
n é a modularidade da nova partição e Qo é a modularidade da partição anterior.

Se ∆Qlr > 0, a mudança é aceita e a nova partição é assimilada para o próximo passo.
Se ∆Qlr ≤ 0 então há uma probabilidade P (∆Qlr ) de que a mudança será aceita:

P (∆Qlr ) = exp(

∆Qlr
),
T

(2.6)

onde T é um número real positivo, representando a temperatura atual do sistema. Talvez valha a pena mencionar que T não se trata de uma temperatura real. O método
de arrefecimento simulado foi inspirado na termomecânica, e a repetição desse processo
durante tempo suficiente simula o movimento de átomos de um material sob processo de
recozimento à uma temperatura T , utilizado para obtenção de estados de baixa energia
de um sólido, daı́ o termo.
Depois de I iterações o sistema é “resfriado”, multiplicando a temperatura presente T por um fator de resfriamento c (0 < c < 1). Este processo se repete até que
o sistema esteja “congelado”, ou seja, nenhuma mudança proposta é aceita durante o
ciclo de uma temperatura. Isso significa que em altas temperaturas o sistema irá explorar
muitas configurações, e à medida em que o algoritmo avança e a temperatura decresce, o
sistema passa a se concentrar nas melhores soluções, evitando mudanças que decresçam
muito o valor de modularidade. Um esquema simplificado se encontra na figura 2.4
O número limite de iterações I, o valor da temperatura inicial Ti e o fator de
resfriamento c devem ser ajustados para cada função especı́fica a ser otimizada. Neste
trabalho foram inicialmente utilizados os valores sugeridos por Guimerà e Amaral (2005),
posteriormente ajustados até a obtenção de um desempenho satisfatório, de maneira que
o algoritmo teste um conjunto suficientemente grande de soluções. Os valores foram
ajustados em I = N 2 (N = número de nós da rede), Ti = 1.000 e c = 0, 95. Para

19
Figura 2.4 - Esquema de funcionamento do algoritmo de Arrefecimento Simulado

20
reduzir o tempo gasto pelo algoritmo, foi gerada uma matriz de Modularidade Mm, de
tamanho N x N onde Mmij é o resultado de Lij − πi πj , o termo dentro dos colchetes da
equação 2.1. Assim, essa matriz Mm contém a contribuição à modularidade total caso os
nós i e j sejam designados à mesma comunidade, possibilitando o cálculo direto de ∆Qlr ,
evitando o cálculo da modularidade total da partição testada a cada passo.
2.2.3 Obtenção de uma solução única
Good, de Montjoye e Clauset (2010) mostraram que redes com estrutura modular apresentam frequentemente um alto número de degenerações, partições de alta modularidade que escondem a partição situada no máximo global (melhor solução). Assim,
frequentemente redes exibirão não apenas um claro máximo global de modularidade, mas
um platô de soluções, todas com alta modularidade, não muito diferentes entre si. Embora
isso pareça impor um obstáculo para a detecção de comunidades dentro de uma rede, na
verdade mostra a possibilidade de escolher uma divisão da rede que atenda necessidades
especı́ficas de uma situação sem violar a definição de comunidade previamente definida.
Ao invés de analisar todas as partições de alta modularidade, pode ser útil extrair padrões
comuns dessas partições, revelando onde elas concordam, i.e. quais nós aparecem juntos
em todas as soluções encontradas. A solução final pode ser encarada como “blocos de construção”(“building blocks”), os quais podem ser submetidos posteriormente a um método
de aglomeração adequado.
Para resumir a informação obtida, foram selecionados os melhores resultados
(partições com valores de modularidade até 1% abaixo do máximo encontrado) e identificados como comunidades os grupos de municı́pios que foram designados para o mesmo
cluster em todas as partições selecionadas. Essa solução foi obtida pela multiplicação
elemento a elemento (produto Hadamard) das matrizes de similaridade de cada partição
selecionada:
Sm = Sm1 ◦ Sm2 ◦ ... ◦ Smn ,

(2.7)

onde Sm é a matriz de similaridade correspondente à partição final C e Smn é a matriz
de similaridade correspondente à partição Cn . Uma matriz de similaridade é uma matriz

21
esparsa de tamanho N x N, onde o elemento Smij = 1 se os nós i e j pertencem ao
mesmo cluster e 0 caso contrário. Tendo como estrutura comunitária a partição C, foi
possı́vel analisar o comércio de animais intra e intercomunitário.
2.3

Avaliação do desempenho do algoritmo
Uma maneira útil de avaliar se as partições obtidas são similares ou diferentes

entre si é a distância de Variação de Informação (Variation of Information - VI) (Meila,
2007). A distância VI é uma métrica baseada em teoria da informação e entropia, e mede
a quantidade de informação não compartilhada entre duas partições. A entropia associada
a uma partição C é dada pela seguinte equação:

H(C) = −

g
X

P (g) log P (g),

(2.8)

g=1

onde P (g) é a probabilidade de escolher um objeto aleatório da partição C que pertença
à comunidade g:
P (g) =

ng
,
N

(2.9)

onde ng é o número de objetos pertencentes à comunidade g. Logo H(C) provê a incerteza
total a respeito de C. Define-se P (g, g ′) como a probabilidade de um objeto pertencer à
comunidade g na partição C e simultaneamente à comunidade g ′ na partição C ′ , ou seja,
a distribuição conjunta das variáveis aleatórias associadas às duas partições:

P (g, g ′) =

|Cg ∩ Cg′ ′ |
.
N

(2.10)

Então a informação mútua entre as partições C e C ′ é dada por:
′

′

I(C, C ) =

G
G X
X
g=1

g ′ =1

P (g, g ′) log

P (g, g ′)
,
P (g)P ′(g ′ )

(2.11)

22
e essa é a quantidade de incerteza sobre C ′ que é reduzida se conhecermos C. A Variação
de Informação (figura 2.5) pode então ser definida da seguinte maneira:

V I(C, C ′) = H(C) + H(C ′ ) − 2I(C, C ′).

(2.12)

Figura 2.5 - Representação gráfica da Variação de Informação (Meila, 2007)

Quando aplicada a duas partições iguais V I = 0. Quando aplicada a partições
extremas que não compartilham nenhuma informação, como por exemplo a partição onde
cada nó pertence à sua própria comunidade C = {{1}, {2}, ..., {N}} e a partição onde
todos os nós pertencem à mesma comunidade C ′ = {g}, o valor de VI é o máximo possı́vel,
V I = log N (onde N é o tamanho das partições analisadas). Essa distância foi calculada
entre a solução final, todas as soluções dadas pelo algoritmo SA e 50 partições aleatórias.
Esse conjunto de distâncias pode ser organizado em uma matriz de distância simétrica D,
onde Dij = Dji , que representa a VI entre as partições Ci e Cj .
2.3.1 Escalonamento multidimensional
Para facilitar a interpretação da magnitude das distâncias encontradas, optou-se
por projetar a matriz D em um plano euclidiano utilizando a técnica de escalonamento
multidimensional. O escalonamento multidimensional (Multidimensional Scaling - MDS)
constrói uma configuração de N pontos em um espaço euclidiano tal que as distâncias

23
entre pontos coincida, tanto quanto possı́vel, as dissimilaridades originais entre N objetos
(Cox e Cox, 2000).
2.4

Softwares utilizados
A função de modularidade, o algoritmo SA e o código para obtenção de uma

solução única foram implementados no software R (R Development Core Team, 2010). Os
mapas foram produzidos no software R (R Development Core Team, 2010), utilizando os
seguintes pacotes: “PBSmapping” (Schnute et al., 2010), “maptools”(Lewin-Koh et al.,
2011), “sp”(Bivand, Pebesma e Gomez-Rubio, 2008) e “foreign”(R Development Core
Team, 2011). As representações gráficas de redes foram produzidas no software Gephi
(Bastian, Heymann e Jacomy, 2009). As distâncias VI foram calculadas utilizando o
pacote “mcclust”(Fritsch, 2009).

24

3 RESULTADOS
Após 50 iterações, o algoritmo SA foi capaz de identificar 24 partições únicas
que maximizam a função de modularidade. Essas partições são muito similares entre si,
tanto em termos de informação como em valores de modularidade (figura 3.1 e figura 3.2).

Figura 3.1 - Partições amostradas e superfı́cie de modularidade.

Figura 3.1 - Legenda:
Distância entre os pontos nos eixos x e y representam a distância VI (stress = 23.89). Pontos verdes são partições obtidas pelo algoritmo SA, pontos pretos são partições aleatórias
e o pronto azul claro é a partição final. A superfı́cie colorida é a função de modularidade,
reconstruı́da a partir de todas as partições analisadas. Partições obtidas pelo algoritmo
SA estão localizadas no máximo da função de modularidade, muito próximas umas das
outras quando comparadas com as partições aleatórias. Ainda, a partição final permanece
perto das soluções do SA, e sua flexibilidade é obtida com o sacrifı́cio de uma pequena
parcela de sua modularidade.

A solução final, que resume a informação de todas as outras partições, retém
um bom valor de modularidade, apresentando uma alta flexibilidade para a definição de
clusters sem violar a definição de comunidade escolhida. Esta possui 11 comunidades,

25
Figura 3.2 - Partições obtidas com Arrefecimento Simulado e superfı́cie de modularidade

sendo que 2 municı́pios permaneceram desagrupados, dado que eles foram designados
a comunidades distintas por duas ou mais partições (figuras 3.3 e 3.4). Apenas três
municı́pios foram designados a comunidades não adjacentes, mostrando que a solução em
questão possui um claro padrão geográfico.
A partição encontrada mostra também um claro padrão comercial. Comunidades detectadas preferem comercializar animais internamente (Tabelas 3.1 e 3.2). Em
10 das 11 comunidades encontradas um animal vendido têm mais chance de permanecer
em sua própria comunidade (comprado por um nó interno à comunidade) do que ir para
outra comunidade (Tabela 3.1). Embora a comunidade 3 mostre uma fraca preferência
em comercializar animais internamente, devido em grande parte ao seu intenso comércio
com a comunidade 5 e 6 (Tabelas 3.1 e 3.2), o comércio interno é ainda maior do que o
comércio desta com qualquer outra comunidade.

26

Figura 3.3 - Circuitos pecuários do Mato Grosso (detalhado)

(a) Movimentos internos

(b) PageRank

Figura 3.3 - Legenda:
A posição dos nós é dada pelo centroide do municı́pio correspondente (aproximado). As
cores dos nós identificam as 11 comunidades encontradas. Nós brancos permaneceram
desagrupados. O tamanho da aresta é proporcional ao número de animais movimentados
entre dois municı́pios, e sua cor identifica a comunidade de origem de uma ligação. Na
figura 3.3(a) o tamanho dos nós é proporcional ao número de animais comercializados
internamente. Na figura 3.3(b) o tamanho dos nós é proporcional ao valor de PageRank.

27

Figura 3.4 - Circuitos pecuários do Mato Grosso.

(a) Municı́pios

(b) Fluxo de animais

Figura 3.4 - Legenda:
A figura 3.4(a) mostra as 11 comunidades encontradas (municı́pios em branco permaneceram desagrupados). A figura 3.4(b) mostra o comércio entre comunidades: números
representam a identificação de cada comunidade (correspondendo às Tabelas 3.1 e 3.2); a
intensidade da cor e o tamanho das arestas estão correlacionados com o número de animais comercializados entre duas comunidades; o tamanho dos nós depende do número de
animais transitados dentro de uma comunidade; e a intensidade de cor dos nós depende da
probabilidade de que um animal vendido permaneça em sua própria comunidade (diagonal
da Tabela 3.1).

W

ij
Tabela 3.1 - Movimentos de saı́da (%). Mij = kwout
onde Wij é o número de animais movimentados da comunidade i para a comunidade
i
out
j, e kwi é o número de animais vendidos pela comunidade i (grau ponderado de saı́da). Comunidades mostram clara preferência de
vender animais internamente. O comércio realizado pelos 2 municı́pios não agrupados foi omitido.

1
2
3
4
5
6
7
8
9
10
11 Total de Animais
1 91,60 0,02 0,00 0,00 3,68 0,69 0,27 1,44 0,02 1,56 0,00
2.519.752
2 0,02 71,31 0,13 0,54 1,35 0,80 19,21 0,17 6,26 0,00 0,08
924.083
3 0,00 10,54 39,23 0,00 23,73 10,69 14,72 0,04 1,05 0,00 0,00
89.107
4 0,00 6,53 0,00 76,02 0,01 2,17 7,04 0,02 2,41 0,00 5,80
1.228.075
5 5,56 0,30 0,73 0,00 70,91 0,27 8,78 10,57 0,42 0,00 0,01
523.644
6 0,08 1,11 1,07 0,19 0,00 94,70 1,74 0,18 0,14 0,00 0,74
3.371.829
7 0,28 9,44 0,14 0,17 3,23 1,11 72,46 9,73 2,77 0,00 0,37
1.265.583
8 2,14 0,42 0,00 0,02 3,39 0,20 8,17 83,66 0,78 0,01 0,01
1.016.299
9 0,02 5,31 0,01 0,22 0,02 0,07 4,50 0,16 89,60 0,01 0,07
3.439.689
10 15,18 0,00 0,02 0,00 0,22 0,33 0,00 0,03 0,01 82,57 0,01
724.604
11 0,00 4,10 0,05 3,26 0,00 16,66 5,52 0,01 0,57 0,00 69,83
656.241

28

Tabela 3.2 - Movimentos de entrada (%). Mij =

Wij
kwjin

onde Wij é o número de animais movimentados da comunidade i para a comunidade

j, e kwjin é o número de animais comprados pela comunidade j (grau ponderado de entrada). O comércio realizado pelos 2 municı́pios
não agrupados foi omitido.
1
2
3
4
5
6
7
8
9
10
11
Total de Animais

1
2
3
4
5
6
7
8
9
10
11
92,38
0,05
0,01
0,00
15,88
0,52
0,43
3,32
0,01
6,08
0,01
0,01
58,75
1,51
0,51
2,13
0,22
11,19
0,14
1,79
0,00
0,12
0,00
0,84 44,54
0,00
3,62
0,28
0,83
0,00
0,03
0,00
0,00
0,00
7,15
0,03
95,60
0,02
0,78
5,45
0,02
0,92
0,00
12,67
1,16
0,14
4,89
0,00
63,59
0,04
2,90
5,05
0,07
0,00
0,01
0,10
3,34 45,79
0,67
0,03
94,19
3,71
0,54
0,14
0,00
4,41
0,14
10,65
2,18
0,22
6,99
0,42
57,81
11,23
1,09
0,00
0,82
0,87
0,38
0,04
0,02
5,90
0,06
5,23
77,57
0,25
0,01
0,02
0,03
16,30
0,42
0,78
0,14
0,08
9,76
0,49
95,58
0,03
0,46
4,40
0,00
0,15
0,00
0,27
0,07
0,00
0,02
0,00
92,58
0,01
0,00
2,40
0,44
2,19
0,00
3,23
2,28
0,01
0,12
0,00
81,47
2.498.589 1.121.681 78.501 976.503 583.919 3.390.257 1.586.209 1.096.007 3.224.366 646.296 562.458

29

30

4 DISCUSSÃO
Ao enfrentar o desafio de definir de comunidades, a escolha de qual algoritmo
utilizar deve levar em consideração as definições e premissas do modelo, e se os mesmos
são adequados para resolver o problema em questão.
O método desenvolvido por Kim, Son e Jeong (2010) é baseado no cálculo de
LinkRank, uma medida baseada no PageRank e na matriz Google. O PageRank pode ser
interpretado como a probabilidade de que um passeador aleatório encontre um determinado nó (utilizando uma taxa mı́nima fixa α, chamada de probabilidade de teletransporte,
para maiores detalhes consultar Langville e Meyer (2006)). Já a matriz Google traz as
probabilidades de caminhos de saı́da de um nó para um passeador aleatório que esteja
percorrendo a rede. Portanto, quando aplicado a uma rede ponderada e direcionada de
trânsito animal entre municı́pios, o método calcula os caminhos possı́veis a serem percorridos por um animal aleatório, a quantidade de animais comercializados, a preferência
comercial das propriedades de cada municı́pio, e a probabilidade de um animal aleatório
transitar por um determinado municı́pio. Por ser uma medida propagada através da rede,
nós que se encontram no fim do ciclo produtivo, como municı́pios contendo frigorı́ficos e
fazendas de engorda, acumulam uma maior fração de PageRank.
Uma alteração no cálculo do Pagerank poderia ajustar de maneira mais precisa a
distribuição de probabilidades referida, bastando para isso alterar a taxa α para um valor
que reflita a reposição de animais no sistema como um todo. Ou, alternativamente, poderse-ia alterar esse parâmetro para refletir a reposição de animais apenas em propriedades
de cria e ciclo completo, por exemplo. Tais alterações não foram realizadas, visto não ser
objetivo deste projeto avaliar esta probabilidade com tamanha precisão.
O método, portanto, deveria valorizar partições nas quais os animais possuam
maior probabilidade de permanecer em uma comunidade do que sair desta. A única
ressalva é que, como pode ser observado na equação 2.1, maior será a contribuição ao
valor da modularidade da designação de dois nós a mesma comunidade quanto maior for

31
a diferença entre o LinkRank (Lij ) e o produto de seus PageRanks (πi πj ). Trabalhase com a premissa, portanto, de que é esperado que nós de elevado PageRank estejam
conectados uns aos outros. Essa caracterı́stica traz importantes implicações. Em primeiro
lugar, se dois nós i e j de elevado PageRank não possuı́rem um alto valor nas células
correspondentes da matriz de passeio aleatório Gij e Gji (o que indica uma fraca conexão
entre eles) esses nós provavelmente serão designados a comunidades diferentes, pois sua
contribuição à Qlr será negativa (já que, de acordo com a equação 2.3, se Gij < πj então
Qlr < 0). Com isso, nós que tendem a acumular grande parte do PageRank da rede, como
municı́pios que possuam frigorı́ficos ou grandes comerciantes de gado, serão designados a
comunidades diferentes a não ser que possuam elevado comércio entre si. Desta maneira,
é mais provável que os municı́pios com os maiores valores de PageRank da rede formem
comunidades que orbitem em volta deles, agregando municı́pios de valores mais baixos de
PageRank mas com os quais possuam elevados valores nas células da matriz Google.
Em segundo lugar, um par de municı́pios com baixo valor de PageRank será
designado à mesma comunidade se possuir internamente uma fração representativa do
seu comércio Gij e Gji . Por último, caso um municı́pio de baixo valor de PageRank i
possua um comércio modesto com um municı́pio de alto valor de PageRank j (representado por um valor médio em Gij , mas de modo que Gij < πj ) sua contribuição à Qlr
será negativa. Obviamente, essas deduções atuam de maneira conjunta para os 141 municı́pios estudados, e o método de maximização utilizado busca a melhor combinação de
municı́pios em grupos, de modo que se a contribuição de dois nós à modularidade for
negativa (Qlr
ij < 0), mas superada pela agregação de ambos à mesma comunidade de um
lr
terceiro (Qlr
im >> 0; Qjm >> 0), ambos serão designados ao mesmo grupo.

Dessa maneira, valoriza-se ligações fortes com nós de baixo PageRank, o que
implica em descontar o efeito agregador que municı́pios de alto PageRank exercem na rede.
Ainda, o método praticamente ignora o comércio feito de maneira ocasional (onde Gij é
baixo), o que é desejável para uma técnica exploratória desta natureza, haja vista que o
objetivo principal é realçar os grandes padrões de movimentação e reduzir a sobrecarga
decorrente do excesso de informações causado por movimentos não-significativos.

32
Outro método possı́vel de ser utilizado, projetado para redes direcionadas, é o
método de Leicht e Newman (2008), o qual utiliza a seguinte equação para o cálculo de
modularidade:
Q=

kiin kjout
1 X
[Aij −
]δgi ,gj .
m ij
m

(4.1)

Como pode ser visto na equação 4.1, o método de Leicht e Newman (2008) considera o
número de ligações de cada nó, e pode ser adaptado para uma rede ponderada, alterando
a matriz de adjacência A pela matriz contendo o peso das arestas W , e alterando os
termos de grau kiin e kjout pelos graus ponderados kwiin e kwjout . No entanto, o método
não utiliza em seus cálculos a topologia da rede como um todo, apenas dados dos nós
individualmente, como grau de entrada e grau de saı́da. Embora o método de Kim, Son e
Jeong (2010) também utilize caracterı́sticas individuais de nós e arestas, como PageRank
e LinkRank, esses são fruto de um cálculo que leva em consideração a topologia da rede
estudada, sendo portanto influenciados por ligações indiretas a estes, como por exemplo
o fluxo encadeado de animais entre vários municı́pios.
Embora a técnica de arrefecimento simulado tenha encontrado várias partições
distintas, esses resultados mostram uma notória similaridade entre si, concordando na
alocação em comunidades da maioria dos municı́pios, o que é evidenciado pela figura 3.1,
onde nota-se que as partições encontradas possuem baixa Variação de Informação entre si.
É possı́vel notar, na figura 3.2, que as partições obtidas também possuem valores muito
similares de modularidade (entre 0,22 e 0,23).
Redes que possuem mais de uma partição com alto valor de modularidade são
comuns e esperadas. Isso apresenta um obstáculo para escolher, dentre várias partições,
qual seria a correta. No entanto, é possı́vel perceber essa caracterı́stica como uma vantagem, dado que possibilita a escolha da partição que melhor atenda às necessidades de um
pesquisador ou tomador de decisão, mantendo a definição escolhida de comunidades.
Extrair as concordâncias entre as diferentes partições é uma maneira útil de
obter grupos pequenos que podem ser posteriormente aglomerados de maneira a atender
os objetivos especı́ficos de um estudo sem violar a definição de comunidade escolhida.

33
Nota-se na figura 3.1 a baixa Variação de Informação entre a partição final,
obtida através do produto Hadamard, e as partições encontradas pelo algoritmo de Arrefecimento Simulado. Isto evidencia que grande parte da informação contida nas 24
partições encontradas foi conservada após a operação que deu origem à solução final.
A figura 3.4(a) mostra que a partição obtida reflete um claro padrão comercial,
no qual apenas três municı́pios foram designados a uma comunidade com a qual não
possuem contato geográfico. Seria necessário verificar individualmente a razão deste fato
curioso. Um deles, o municı́pio de Ipiranga do Norte, foi criado em 2005, desmembrado
do municı́pio de Tapurah, que por sua vez foi designado a uma comunidade adjacente,
mantendo o padrão encontrado no restante do estado. Uma possı́vel explicação seria a de
que, em 2007, o sistema do INDEA se encontrasse em fase de adequação à existência do
municı́pio, atualizando dados cadastrais dos produtores da região.
Na figura 3.3(b) nota-se que muitas comunidades possuem um ou dois municı́pios
com alto valor de PageRank. Na comunidade de cor laranja, no sudoeste do estado, o
municı́pio de Tangará da Serra é o que se destaca com maior valor de PageRank. Na
comunidade de cor azul clara, no centro sul do estado, os municı́pios são Cuiabá (a
capital do estado) e Várzea Grande (situado na região metropolitana de Cuiabá). Na
comunidade vermelha, na região leste do estado, o municı́pio de destaque é Barra do
Garças. Na comunidade azul escura, no sudeste do estado, destacam-se os municı́pios
de Rondonópolis e Pedra Preta. Na comunidade de cor verde clara, no centro leste do
estado, nota-se o municı́pio de Paranatinga. Na comunidade verde escura, no centro norte
do estado, destacam-se, de maneira mais modesta, os municı́pios de Sinop e Colider. Todos
os municı́pios mencionados são conhecidos por conterem um ou mais frigorı́ficos em seus
territórios, o que corrobora a hipótese de que nós no fim da cadeia produtiva concentram
grande parte do PageRank da rede e de suas respectivas comunidades.
Nota-se, através das tabelas 3.1 e 3.2, que essa solução final é consistente com
a ideia de circuitos pecuários, visto que um animal vai mais provavelmente permanecer
em sua comunidade de origem, ao invés de ser transferido para outra comunidade qual-

34
quer. A única exceção à essa regra é a comunidade 3. Como pode ser visualizado na
figura 3.4, esta comunidade é formada por apenas três municı́pios da região central do
estado, todos com baixo valor de PageRank (figura 3.3(b)), indicando, possivelmente, a
ausência de frigorı́ficos na região. Na tabela 3.2 vemos que esta é a comunidade que menos
comprou animais (cerca de 80.000), e que a mesma adquire animais prioritariamente da
comunidade 6 (45,79% dos animais comprados), situada imediatamente ao norte desta.
Na tabela 3.1 vemos que esta é a comunidade que menos vende animais (cerca de 90.000),
prioritariamente para as comunidades 2 (10,54%), 5 (23,73%), 6 (10,69%) e 7 (14,72%).
À exceção da comunidade 6, todas essas se situam ao sul da comunidade 3 (figura 3.4(b)),
caracterizando a mesma como uma ponte entre municı́pios do norte (comunidade 6) e
municı́pios do sul (comunidades 2, 5 e 7).
Esse padrão de movimentação, caracterizado pelo fluxo de animais no sentido
norte-sul, pode ser observado em outras regiões do estado, com o auxı́lio da figura 3.4(b)
e da tabela 3.1. Começando pela região nordeste, por exemplo, vemos que a comunidade
10 envia 15,18% de seus animais vendidos para a comunidade 1, que por sua vez envia
3,68% de seus animais vendidos para a comunidade 5, que por sua vez envia animais para
as comunidades 7 (8,78%) e 8 (10,57%). Já na região noroeste, nota-se a existência de
dois fluxos distintos. Um no sentido oeste-leste, começando pela comunidade 4, que envia
animais para a comunidade 11 (5,8%), que por sua vez envia animais para a comunidade 6
(16,66%). E outro no sentido norte-sul, começando também pela comunidade 4, enviando
animais para as comunidades 2 (6,53%) e 7 (7,04%). Paralelamente, a comunidade 11
envia animais para as comunidades 2 (4,1%) e 7 (5,52%), e a comunidade 6 envia animais
para as comunidades 2 (1,11%), 3 (1,07%) e 7 (1,74%). Esse fluxo pode ser causado pela
concentração da população humana na região sul do estado, ao redor da capital Cuiabá,
ou pela proximidade desta região com o estado de São Paulo, onde localiza-se grande
mercado consumidor de carnes.
Fica evidenciado que após uma análise da estrutura da indústria pecuária em
um estado, é possı́vel fornecer informações importantes para aplicações diversas na área
de defesa sanitária, principalmente na vigilância e no controle de enfermidades. Ao obter

35
uma partição na qual animais possuam a tendência de permanecer em suas regiões, um
estudo de circulação viral pode levar em conta as diferentes comunidades encontradas
na sua estratificação, buscando assim dividir a área estudada em diferentes zonas de
produção. Considerando a relação entre os circuitos pecuários, seria possı́vel, na ocasião
de erradicação de uma doença especı́fica, atuar sequencialmente nessas diferentes zonas de
produção, começando por aquelas que possuam menor probabilidade de reinfecção, ou que
dependam menos, do ponto de vista econômico, do ingresso de animais de outras regiões,
na eventual possibilidade de criar zonas com diferentes status sanitário com restrição de
comércio.
Uma possı́vel análise seria agregar as informações dos fluxos de animais com a
infraestrutura do estado para locomoção de animais e suas particularidades ambientais,
como grandes estradas e rotas de trânsito que são bloqueadas na estação de chuvas, a
fim de estudar como o fluxo de animais é influenciado por estes. Nota-se, por exemplo,
na figura 3.3 que na região nordeste do estado há uma extensão no sentido norte-sul
entre as comunidades 6, 5, 1 e 10 (figura 3.4(b)) com baixa densidade de ligações. Esta
extensão corresponde à área do Parque Indı́gena do Xingú, criado em 1961, que possui
aproximadamente 27.000 km2 .
A solução final apresenta um padrão geográfico e comercial claro, caracterı́stica
crucial para aplicações em medicina veterinária preventiva, além de possuir uma interpretação clara e útil em redes de comércio onde ligações emergem das escolhas de nós comerciantes, e esses últimos são fortemente influenciados pelos “hubs”(nós com alto valor
de PageRank), os quais normalmente apresentam alta competitividade quando comparados com outros nós da rede. A solução final também é consistente do ponto de vista de
informação, dada a baixa Variação de Informação entre esta e as partições encontradas
pelo Arrefecimento Simulado. A técnica apresentada permite extrair informações relevantes acerca do fluxo de uma rede de trânsito animal, permitindo um melhor entendimento
da relação existente entre suas zonas de produção.

36

5 CONCLUSÕES
Vimos que o método descrito nessa tese pode revelar a estrutura comunitária de
uma rede direcionada de trânsito animal. Acreditamos que essa abordagem é apropriada
para redes de trânsito animal e circuitos pecuários, assim como outras redes onde o caminho percorrido por um passeador aleatório (ou as escolhas dos nós em estabelecer ligações
com outros nós) está incluı́da na definição de comunidade. Essa abordagem pode ser
utilizada para melhor compreender o fluxo interno de uma rede, ajudar no planejamento
de um sistema de vigilância baseado em risco, melhorar modelos preditivos, guiar uma
amostra estratificada, determinar áreas alvos para programas sanitários e definir zonas
para restrição de movimentação.

37

REFERÊNCIAS
Bastian, M.; Heymann, S.; Jacomy, M. Gephi: An Open Source Software for
Exploring and Manipulating Networks. In: International AAAI Conference on
Weblogs and Social Media. 2009.
Bates, D.; Maechler, M. Matrix: Sparse and Dense Matrix Classes and Methods.
2011.
Bigras-Poulin, M.; Thompson, R.A.; Chriel, M.; Mortensen, S.; Greiner,
M. Network analysis of Danish cattle industry trade patterns as an evaluation of risk
potential for disease spread. Preventive veterinary medicine, vol. 76, no. 1-2: pp.
11–39. 2006.
Bivand, R.S.; Pebesma, E.J.; Gomez-Rubio, V. Applied spatial data analysis with
R. 2008.
Cox, T.; Cox, M. Multidimensional Scaling, Second Edition, vol. 88 of
C&H/CRC Monographs on Statistics & Applied Probability. Chapman and
Hall/CRC. 2000.
Fortunato, S. Community detection in graphs. Physics Reports, vol. 486, no. 3-5:
pp. 75–174. 2010.
Fritsch, A. mcclust: Process an MCMC Sample of Clusterings. 2009.
Gibbens, J.C.; Sharpe, C.E.; Wilesmith, J.W.; Mansley, L.M.;
Michalopoulou, E.; Ryan, J.B.M.; Hudson, M. Descriptive epidemiology of the
2001 foot-and-mouth disease epidemic in Great Britain: the first five months.
Veterinary Record, vol. 149, no. 24: pp. 729–743. 2001.
Good, B.H.; de Montjoye, Y.A.; Clauset, A. Performance of modularity
maximization in practical contexts. Physical Review E, vol. 81, no. 4: p. 20. 2010.
Green, D.M.; Gregory, A.; Munro, L.A. Small- and large-scale network structure
of live fish movements in Scotland. Preventive veterinary medicine, vol. 91, no. 2-4:
pp. 261–9. 2009.
Green, D.M.; Werkman, M.; Munro, L.A.; Kao, R.R.; Kiss, I.Z.; Danon, L.
Tools to study trends in community structure: application to fish and livestock trading
networks. Preventive veterinary medicine, vol. 99, no. 2-4: pp. 225–8. 2011.
Guimerà, R.; Amaral, L.a.N. Cartography of complex networks: modules and
universal roles. Journal of statistical mechanics (Online), vol. 2005, no. P02001: p.
nihpa35573. 2005.
Harvey, N.; Reeves, A.; Schoenbaum, M.a.; Zagmutt-Vergara, F.J.; Dubé,
C.; Hill, A.E.; Corso, B.a.; McNab, W.B.; Cartwright, C.I.; Salman, M.D.
The North American Animal Disease Spread Model: a simulation model to assist
decision making in evaluating animal disease incursions. Preventive veterinary
medicine, vol. 82, no. 3-4: pp. 176–97. 2007.

Instituto Brasileiro de Geografia e Estatı́stica, I. Pesquisa Pecuária
Municipal. 2010.
Kim, Y.; Son, S.W.; Jeong, H. Finding communities in directed networks. Physical
Review E, vol. 81, no. 1: pp. 1–9. 2010.
Kirkpatrick, S.; Gelatt, C.D.J.; Vecchi, M.P. Optimization by Simulated
Annealing. Science, vol. 220, no. 4598: pp. 671–680. 1983.
Langville, A.N.; Meyer, C.D. Google’s PageRank and Beyond: The Science
of Search Engine Rankings. Princeton University Press. 2006, 240 pp.
Leicht, E.; Newman, M.E.J. Community Structure in Directed Networks. Physical
Review Letters, vol. 100, no. 11: pp. 1–4. 2008.
Lentz, H.H.K.; Konschake, M.; Teske, K.; Kasper, M.; Rother, B.;
Carmanns, R.; Petersen, B.; Conraths, F.J.; Selhorst, T. Trade communities
and their spatial patterns in the German pork production network. Preventive
veterinary medicine, vol. 98, no. 2-3: pp. 176–81. 2011.
Lewin-Koh, N.J.; Bivand, R.; Pebesma, E.J.; Archer, E.; Baddeley, A.;
Bibiko, H.J.; Dray, S.; Forrest, D.; Friendly, M.; Giraudoux, P.; Golicher,
D.; Rubio, V.G.; Hausmann, P.; Hufthammer, K.O.; Jagger, T.; Luque, S.P.;
MacQueen, D.; Niccolai, A.; Short, T.; Stabler, B.; Turner, R. maptools:
Tools for reading and handling spatial objects. 2011.
Lusseau, D.; Newman, M.E.J. Identifying the role that animals play in their social
networks. Proceedings Biological sciences / The Royal Society, vol. 271 Suppl:
pp. S477–81. 2004.
Lusseau, D.; Schneider, K.; Boisseau, O.J.; Haase, P.; Slooten, E.; Dawson,
S.M. The bottlenose dolphin community of Doubtful Sound features a large proportion
of long-lasting associations. Behavioral Ecology and Sociobiology, vol. 54, no. 4:
pp. 396–405. 2003.
Martı́nez-López, B.; Perez, A.M.; Sánchez-Vizcaı́no, J.M. Social network
analysis. Review of general concepts and use in preventive veterinary medicine.
Transboundary and emerging diseases, vol. 56, no. 4: pp. 109–20. 2009.
Meila, M. Comparing clusterings—an information based distance. Journal of
Multivariate Analysis, vol. 98, no. 5: pp. 873–895. 2007.
Negreiros, R.L. Caracterização e análise da rede de movimentação de
bovinos no Estado de Mato Grosso. 2010. Tese (Doutorado em Ciências) Faculdade de Medicina Veterinária e Zootecnia, Universidade de São Paulo, São Paulo.
2010, 121 pp.
Newman, M.; Girvan, M. Finding and evaluating community structure in networks.
Physical Review E, vol. 69, no. 2: pp. 1–15. 2004.
Page, L.; Brin, S.; Motwani, R.; Winograd, T. The PageRank Citation Ranking:
Bringing Order to the Web. Stanford InfoLab. 1999.

39
R Development Core Team. R: A language and environment for statistical
computing. 2010.
R Development Core Team. foreign: Read Data Stored by Minitab, S, SAS, SPSS,
Stata, Systat, dBase, ... 2011.
Salathé, M.; Jones, J.H. Dynamics and control of diseases in networks with
community structure. PLoS computational biology, vol. 6, no. 4: p. e1000736. 2010.
Schnute, J.T.; Boers, N.; Haigh, R.; Couture-Beil, A. PBSmapping: Mapping
Fisheries Data and Spatial Analysis Tools. 2010.
World Organisation for Animal Health. Terrestrial Animal Health Code,
vol. 33. World Organisation for Animal Health. 2010, 1–19 pp.

40

APÊNDICE - Códigos desenvolvidos
Algoritmo
O código deve ser utilizado na seguinte ordem:
1. Em uma rede com N nós, criar uma matriz W de tamanho NxN, onde Wij é a
quantidade de animais que o nó i enviou ao nó j;
2. Calcular a matriz de hiperlinks normalizada por linhas H;
3. Calcular o vetor de PageRank pr;
4. Calcular a matriz Google G;
5. Calcular a matriz de LinkRank Lm;
6. Calcular a matriz de Modularidade Mm;
7. Executar o Arrefecimento Simulado.
Todos os códigos foram implementados no programa R (R Development Core
Team, 2010). Os códigos para calcular a matriz de hiperlinks normalizada por linhas
(H), o vetor de PageRank (pr) e a matriz Google (G) foram adaptados dos códigos
disponı́veis por Langville e Meyer (2006). O código para produzir a rede de referência
(Kim, Son e Jeong, 2010) utilizam o pacote “Matrix”(Bates e Maechler, 2011).
Códigos em linguagem R
Código para produzir a matriz de hiperlinks normalizada por linhas (H):

rnhm <- function(A)
{
Srow

<- rowSums(A)

n

<- dim(A)[1]

H

<- matrix(0,n,n)

41
for (i in 1:n)
{
if (Srow[i] != 0)
H[i,] <- A[i,]/Srow[i]
}
return(H)
}
Código para calcular o vetor de PageRank (pr):
pagerank <- function(H,alpha=0.85,epsilon=1e-8,pr0)
{
n <- dim(H)[1]
if (missing(pr0))
pr0 <- rep(1/n,n)
rowsumvector <- rowSums(H) == 0
a <- rowsumvector*1
residual <- 1
pr <- pr0
while (residual >= epsilon)
{
prevpr <- pr
pr <- as.vector((alpha*pr)%*%H) + (alpha*(pr%*%a)+1-alpha)*rep(1/n,n)
residual <- dist(rbind(pr,prevpr),method=’manhattan’)
}
return(pr)
}
Código para produzir a matriz Google (G):
gmatrix <- function(A,alpha=0.85)

42
{
Srow <- rowSums(A)
n

<- dim(A)[1]

G <- matrix(0,n,n)
for (i in 1:n)
{
if (Srow[i] != 0)
G[i,] <- alpha*(A[i,]/Srow[i]) + (1/n)*(1-alpha)
else
G[i,] <- 1/n
}
return(G)
}
Código para calcular a matriz de LinkRank (Lm):
linkrank <- function (G,pr)
{
n <- length(pr)
L <- matrix(0,n,n)
for (i in 1:n)
L[i,] <- pr[i] * G[i,]
return(L)
}
Código para produzir a matriz de Modularidade (Mm):
lrmM <- function(L,pr)
{
n <- length(pr)
qlrM <- matrix(0,n,n)

43
prMA <- pr%o%pr
for (i in 1:n)
{
LL <- L[i,]
prL <- prMA[i,]
for (j in 1:n)
{
qlrM[i,j] <- LL[j] - prL[j]
}
}
diag(qlrM) <- 0;
return(qlrM)
}
Código do Arrefecimento Simulado:

kim <- function(qlrM, Tc=1, minTc=1e-10, cool=0.995,
max_itry, max_heat, max_rej)
{
#Parameters
n <- dim(qlrM)[1]
c <- 1:n
lc <- unique(c)
if (missing(max_itry))
max_itry <- n^2
if (missing(max_heat))
max_heat <- 0.125 * max_itry
if (missing(max_rej))
max_rej <- max_itry
#Initial variables

44
itry <- heat <- rej <- 0
while (Tc >= minTc & rej < max_rej)
{
itry <- itry+1
nsort <- sample(n,1)
csort <- sample(lc[-which(lc==c[nsort])],1)
LqlrM <- qlrM[nsort,]
CqlrM <- qlrM[,nsort]
oldm <- sum(LqlrM[c==c[nsort]]) + sum(CqlrM[c==c[nsort]])
newm <- sum(LqlrM[c==csort]) + sum(CqlrM[c==csort])
if (newm>=oldm)
{c[nsort] <- csort}
else
{
if (runif(1) < exp((newm-oldm)/Tc))
{
c[nsort] <- csort
heat <- heat + 1
}
else
{
rej <- rej + 1
}
}
if (itry > max_itry | heat > max_heat)
{
Tc <- cool*Tc
itry <- heat <- rej <- 0
}

45
}
#Last ouptut
writeLines(paste(paste(’Final Temperature =’, signif(Tc,digits=1)),’\n’))
return(c)
}
Função para criar a rede de referência proposta por Kim, Son e Jeong (2010).
Depende do pacote Matrix (Bates e Maechler, 2011):
benchmark <- function(size,n,w=1)
{
require(Matrix)
comm <- Matrix(0,nrow=size, ncol=size, sparse = T)
#internal links
for (i in 1:(size-1))
comm[i,i+1] <- 1
comm[i+1,1] <- 1
network <- comm
for (i in 1:(n-1))
network <- bdiag(network,comm)
#external links
central.node <- ceiling(median(1:size))
for (i in 1:(n-1))
network[central.node+size*(i-1),1+size*i] <- w
network[central.node+(size*(n-1)),1] <- w
return(network)
}
Exemplo utilizando a rede de referência proposta por Kim, Son e Jeong (2010).
size <- 4; n <- 4; w <- 1

46
A <- benchmark(size,n,w)
H <- rnhm(A)
pr <- pagerank(H)
G <- gmatrix(A)
L <- linkrank(G,pr)
qlrM <- lrmM(L,pr)
membership <- kim(qlrM,Tc=0.1,minTc=0.0005)

