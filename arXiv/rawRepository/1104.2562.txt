arXiv:1104.2562v1 [q-bio.PE] 13 Apr 2011

Mathematical aspects of phylogenetic groves
Mareike Fischer
Abstract. The inference of new information on the relatedness of species
by phylogenetic trees based on DNA data is one of the main challenges
of modern biology. But despite all technological advances, DNA sequencing is still a time-consuming and costly process. Therefore, decision criteria would be desirable to decide a priori which data might contribute
new information to the supertree which is not explicitly displayed by any
input tree. A new concept, so-called groves, to identify taxon sets with
the potential to construct such informative supertrees was suggested by
Ané et al. in 2009. But the important conjecture that maximal groves can
easily be identified in a database remained unproved and was published
on the Isaac Newton Institute’s list of open phylogenetic problems. In
this paper, we show that the conjecture does not generally hold, but also
introduce a new concept, namely 2-overlap groves, which overcomes this
problem.
Mathematics Subject Classification (2010). Primary 92B05; Secondary
94C15.
Keywords. phylogenetic tree, grove, supertree, compatibility.

1. I NTRODUCTION
One of the main challenges of biological sciences is the reconstruction of the
‘Tree of Life’, i.e. the phylogenetic tree displaying all living species on earth.
The genetic sequence data on some clusters of species are already available
in databases like GenBank or SwissProt, and there are algorithms available
to reconstruct the tree of each cluster. Unfortunately, many frequently used
tree inference methods like maximum parsimony or maximum likelihood
are known to be NP-hard ([2], [3], [4]), which is why for such a huge number of species only heuristics can be used – but these are usually not very
reliable given such amounts of data. Therefore, the Tree of Life cannot be
constructed all at once. Scientists rather depend on supertree methods to
Financial support from the Wiener Wissenschafts-, Forschungs- und Technologiefonds (WWTF)
to Arndt von Haeseler is greatly appreciated.

2

Mareike Fischer

combine known phylogenies on fewer taxa ([5], [6], [7]). But even if there is
no conflict amongst the input trees, not all supertrees reveal new information: for instance, if the input trees have no shared taxa, they can be combined in any possible way and therefore do not lead to new conclusions on
the relatedness of the species involved. In order to avoid this problem, Ané
et al. [1] suggested to use the concept of groves – sets of clusters with the potential to construct informative supertrees. As this potential merely depends
on certain overlap properties of the input taxon sets, no a priori knowledge
on underlying phylogenies is required. However, in order for groves to be
useful for practical purposes, they should be easily identifiable in databases.
Regarding this question, Ané et al. state the following conjecture:
Conjecture 1.1. The following equivalent properties are true.
1. For any set S of taxon sets, the set of maximal groves in S is a partiton
of S .
2. If two groves intersect, their union is a grove.
3. Two maximal groves do not intersect.

Obiously, property (1) would reduce the search for maximal groves at
least to a search on all possible partitions of the set of taxon sets under investigation, even if this might still be hard. Actually, the above conjecture raised
a lot of attention. It was published both on the Isaac Newton Institute’s list of
open phylogenetic problems in 2007 (see http://www.newton.ac.uk/programmes/PLG/
as well as on the ‘Penny Ante’ list of the Annual New Zealand Phylogenetics Meeting in Kaikoura in 2009 (see http://
www.math.canterbury.ac.nz/bio/events/kaikoura09/penny.shtml).
In this paper, we first show that the concept of groves can be simplified by introducing tripartition groves, and then we prove that unfortunately
the conjecture is not in general true. We show this by presenting an explicit
counterexample to property (2) of Conjecture 1.1. We also prove that the
conjecture even fails when making the definition of groves more restrictive
to enforce informativeness. Despite these negative results, we also characterize a new concept of groves, namely 2-overlap groves, which guarantees
property (2), and hence the whole conjecture, to hold.

2. Preliminaries
The main idea of the grove concept is to decide in advance, i.e. before even
constructing any phylogeny, if a set of various taxon sets has the potential to
deliver new information when being combined into one common supertree.
In the context of rooted phylogenies, ‘new information’ of a supertree refers
to resolving at least one triple of taxa which is not resolved by any of the
input trees, as triples are the smallest informative unit in the rooted setting. Such triples which get resolved by a supertree but not by any of the
input phylogenies are called resolved cross triples. In order to define groves

Mathematical aspects of phylogenetic groves

3

explicitly, we therefore need some formal definitions of a phylogeny and of
(resolved) cross triples.
Recall that a rooted binary phylogenetic X-tree is a tree T = (V (T ), E(T )),
with vertex set V (T ) and edge set E(T ), on a leaf (taxon) set X = {1, . . . , n} ⊂
V (T ) with only vertices of degree 1 (leaves) or 3 (internal vertices) and one
vertex of degree 2, which is called root. In this paper, when there is no ambiguity we often just write ‘tree’ or ‘phylogeny’ when referring to a rooted
binary phylogenetic X-tree.
A topology assignment P on a set S of taxon sets is a set of trees such that a)
for each taxon set in S there is exactly one tree in P and b) all these trees are
compatible, i.e. can be displayed by one common tree, which is then called
supertree.
We are now in a position to define cross triples. In the following, we
denote by L(S) the set of all taxa of a set of taxon sets S , i.e. L(S) = { x :
∃ S ∈ S : x ∈ S }.
Definition 2.1 (Cross triple). Let S be a set of taxon sets X1 , . . . , Xm and let
π = S1 | . . . |Sk be a partition of S , i.e.

k
S

i =1

Si = S and Si ∩ S j = ∅ for all i 6= j.

Then, a cross triple of S with respect to π is a set of three taxa { x, y, z} ⊂ L(S)
such that no Si contains all three of them.
Recall that for three taxa x, y, z there are exactly three possible rooted
binary phylogenetic tree topologies, namely (( x, y), z), (( x, z), y) and ((y, z),
x ) as shown in Figure 1. A topology assignment on a set S of taxon sets
might lead to various possible supertrees, and these trees need not agree on
how three taxa x, y, z are related. In order to formally characterize this, we
now define what it means if a cross triple is resolved.

x

y

z

x

z

y

y

z

x

F IGURE 1. Three taxa x, y, z can be resolved in three different ways, which means three different rooted tree topologies are possible.
Definition 2.2 (Resolved cross triple). Let S = X1 , . . . , Xm be a set of taxon
sets and let π = S1 | . . . |Sk be a partition of S . Let { x, y, z} be a cross triple
of S with respect to π. { x, y, z} is called resolved if there is a topology assignment on S such that all possible supertrees of this assignment display the
same of the three possible rooted trees on { x, y, z}.

4

Mareike Fischer

Example.
1. The set S = {{v, w, x } , { x, y, z}} does not have any resolved cross
triple with respect to π = { v, w, x } | { x, y, z}, because no matter which
topology assignment is chosen, the two input trees only intersect in
only one taxon, namely x. Therefore, they can be combined in all possible ways such that no cross triple, like e.g. { v, w, y}, gets resolved (this
is formally shown in [1, Lemma 4.1] as cited in Lemma 3.2).
2. For set S̃ = {{w, x, y } , { x, y, z}} and partition π̃ = { w, x, y } | { x, y, z}
there is a topology assignment P , namely P = { T1 , T2 } as shown in
Figure 2, such that all cross triples, like e.g. {w, y, z}, are resolved. In
this case this is due to the fact that there is only one supertree.

T1

w

y

T2

x

x

y

z

w

y

x

z

F IGURE 2. For S̃ = {{w, x, y} , { x, y, z}}, the depicted
topology assignment P := { T1 , T2 } leads to a unique supertree. Therefore, all cross triples with respect to the only
possible partition of S̃ , namely π̃ = { w, x, y} | { x, y, z}, are
resolved.
It is known that in the rooted case, either all possible supertrees of a
topology assignment on a set S of taxon sets agree on how a certain triple
{ x, y, z} ⊂ L(S) should be resolved, or all three possible trees shown in
Figure 1 are displayed in the set of supertrees [8, Prop. 9.1]. However, if the
latter scenario happens for all possible cross triples, there is no information
in the supertrees that is not already inherent in the topology assignment
itself. We will now formalize this idea.
Definition 2.3 (Informative topology assignment). Let S be a set of taxon
sets and π a partition of S such that there exists a cross triple of S with
respect to π. Then, a topology assignment P on S is called informative with
respect to π if some cross triple of S with respect to π is resolved by P .
Example (continued). In the above example, for the set S = {{v, w, x } ,
{ x, y, z}} there is no informative topology assignment. However, the set
S̃ = {{w, x, y} , { x, y, z}} has an informative topology assignment with respect to partition π̃ = {w, x, y} | { x, y, z}, namely the one shown in Figure
2.

Mathematical aspects of phylogenetic groves

5

As stated above, the idea now is to decide without considering specific input trees if a set of taxon sets has the potential to resolve cross triples.
Ané et al. showed in [1] that this can be done with their grove concept, because the potential to resolve cross triples mainly depends on certain overlap properties of the underlying taxon sets. We now define groves as in [1].
Definition 2.4 (Grove). A grove is a set S of taxon sets such that for each
possible partition π of S it holds either that
• there exists no cross triple of S with respect to π, or
• there exists an informative topology assignment on S w.r.t. π.
Example (continued). In the previous example, the set S = {{v, w, x } ,
{ x, y, z}} is not a grove, because there is a partition of S , namely π =
{v, w, x } | { x, y, z}, which has some cross triples but no resolved one for any
topology assignment. On the other hand, the set S̃ = {{ w, x, y } , { x, y, z}}
is a grove because there is only one possible partition of S̃ , namely π̃ =
{w, x, y} | { x, y, z}, with respect to which there is an informative topology
assignment as shown in Figure 2.
So groves have the property that if there is a cross triple with respect
to a partition, at least one of these cross triples has to be resolved by some
topology assignment. This implies that the supertree(s) on all taxon sets in
a grove S reveal some new information which is not present in any of the
input phylogenies. But it has to be noted that the authors of [1] by the first
property in Definition 2.4 explicitly allow for the situation where there is
no cross triple for any partition of S . This occurs, for instance, if S contains
one taxon set in which all taxa of S are present. In this case, the supertree
is always identical to the tree induced by this taxon set and therefore never
reveals new information. The authors state that they include this case for
biological reasons, which are not further explained. However, this means
that while groves may have the potential to reveal new information, they
are not guaranteed to do so. In Section 3.4 we define informative and strictly
informative groves in order to overcome this problem.
Next, in order to understand Conjecture 1.1, we need to introduce a
formal concept of maximality.
Definition 2.5 (Maximal grove). A grove S in a database D of taxon sets is
called maximal with respect to D , or maximal for short, if there is no taxon set
X in D such that S ∪ X is also a grove.

3. Results
3.1. Characterizing groves
Our main goal in this section is to simplify the concept of groves by introducing tripartition groves. Moreover, we state some general properties of
splits, partitions and groves. Our first two lemmas formalize the concept of

6

Mareike Fischer

cross triples and resolved cross triples for so-called splits. Recall that a split
σ = S1 |S2 of a set of taxon sets S is a bipartition of S , i.e. a partition of S
into two disjoint parts.
Lemma 3.1. Let S be a set of taxon sets, let π = S1 | . . . |Sk be a partition of S and
let σ = Ŝ1 |Ŝ2 be a split of S .
1. Assume there is a cross triple of S with respect to π. Then, there are i, j ∈
{1, . . . , k}, i 6= j, such that there are two taxa si , s j fulfilling the following
properties:
• si ∈ L(Si ), si ∈
/ L(S j ), and
• s j ∈ L(S j ), s j ∈
/ L(Si ).
2. Assume |L(S)| ≥ 3 and assume there is no cross triple of S with respect to
σ. Then, either L(Ŝ1 ) ⊆ L(Ŝ2 ) or L(Ŝ2 ) ⊆ L(Ŝ1 ), i.e. either all taxa of Ŝ1
also lie in Ŝ2 or vice versa.
Proof.
1. Let { x, y, z} be a cross triple of S with respect to π. By definition of
cross triples, x, y, z are not all contained together in any Sm , m = 1, . . . , k.
Without loss of generality, choose Sx ∈ {S1 , . . . , Sk } such that x ∈
L(Sx ) and y ∈
/ L(Sx ). However, as y ∈ S , there is an Sy ∈ {S1 , . . . , Sk }
such that y ∈ L(Sy ). If possible, choose Sy such that x ∈
/ L(Sy ). Then,
let si := x, s j := y and Si := Sx , S j := Sy . Else, if all sets which contain
y also contain x, choose a set Sz such that z ∈ L(Sz ). Now if y was contained in Sz , Sz would also contain x, which contradicts the cross triple
assumption. For the same reason, z ∈
/ L(Sy ). So in this case, y ∈ L(Sy ),
y∈
/ L(Sz ), z ∈ L(Sz ), z ∈
/ L(Sy ). Then, let si := y, s j := z and Si := Sy ,
S j := Sz . This completes the proof.
2. Assume there is no cross triple of S with respect to σ. If not all taxa
of Ŝ1 are contained in Ŝ2 , this implies that there is a taxon s1 such that
s1 ∈ Ŝ1 and s1 ∈
/ Ŝ2 . If additionally not all taxa of Ŝ2 are contained in
Ŝ1 , this implies that there is a taxon s2 such that s2 ∈ Ŝ2 and s2 ∈
/ Ŝ1 .
Now as |L(S)| ≥ 3, there is a z ∈ S such that z 6= s1 , s2 . Then, by
definition the set {s1 , s2 , z} is a cross triple of S with respect to σ. This
contradicts the assumption and thus completes the proof.

Next we recall a result by Ané et al. in order to prove the following
lemma.
Lemma 3.2 (Lemma 4.1 of [1]). Let X and X ′ be two taxon sets that share at
most one taxon. Then, any trees on X and X ′ , respectively, are compatible and any
cross triple of S := X ∪ X ′ with respect to π := X | X ′ remains unresolved.
Lemma 3.3. Let S be a set of taxon sets and let σ = S1 |S2 be a split of S . If there
is a resolved cross triple of S with respect to σ, then
1.

(a) there is a taxon s1 ∈ S1 such that s1 ∈
/ S2 and
(b) there is a taxon s2 ∈ S2 such that s2 ∈
/ S1 and

Mathematical aspects of phylogenetic groves

7

(c) there are two taxa x, y ∈ L(S), x 6= y, such that x, y are both in
L(S1 ) ∩ L(S2 ).
2. If properties 1. (a)-(c) hold and additionally there are taxon sets X1 ∈ S1 and
X2 ∈ S2 such that s1 , x, y ∈ X1 and s2 , x, y ∈ X2 , then there is a resolved
cross triple of S with respect to σ.
Proof.
1. By Lemma 3.1, all cross triples imply properties (1) and (2). Now
we show that a resolved cross triple additionally implies (3). Assume
there are no taxa x, y with the properties specified in (3). This means
that S1 and S2 share at most one taxon. Now we can choose any trees
T1 for S1 and T2 for S2 . As they overlap in at most one taxon, they
are compatible by Lemma 3.2 and can be combined into a common
supertree by pruning any edge of T1 to any edge of T2 . This way, no
cross triple can be resolved. So if a cross triple is resolved, (3) must
hold.
2. Now we show that (a), (b) and (c) together with the properties s1 , x, y ∈
X1 ⊆ S1 and s2 , x, y ∈ X2 ⊆ S2 imply that there is a resolved cross triple
of S with respect to σ. We prove this by construction of an informative
topology assignment. We choose T1 for X1 and T2 for X2 such that they
are so-called caterpillar trees as depicted by Figure 3.

T1

x

y

T2

s1

s2

x

y

s2

x

y

s1

F IGURE 3. Whenever the so-called caterpillar trees T1 and
T2 are compatible and have the depicted taxon labellings,
all supertrees combining these two trees will display the
subtree (((s2, x ), y), s1 ) as shown on the right.
In particular, we choose T1 such that the taxa x and y specified
by property (3) are together on the only 2-clade (so-called ‘cherry’) and
taxon s1 (specified by properties (a) and (c)) is the taxon sharing the 3clade with them. Moreover, we choose T2 such that s2 and x (specified
by properties (b) and (c)) are together on the 2-clade and taxon y is the
taxon sharing the 3-clade with them. The whole setting of T1 and T2 is
shown in Figure 3. All other properties of T1 and T2 as well as all other
trees for the other sets in S1 and S2 (if there are any) are chosen arbitrarily but in a way that leaves them compatible (i.e. if two sets share
some taxa, we do not add conflicting information to the corresponding
trees). By properties (a) and (b), the triple {s1 , s2 , x }, for instance, is a

8

Mareike Fischer
cross triple with respect to σ. Now every supertree comprising T1 and
T2 (along with other trees if applicable) takes the fact into account that
by T1 , x and y should be closer together than to any other taxon which
is also included in T1 . Also, by T2 , x and s2 are closer to one another
than any one of them is to y, but still closer to y than to any other taxon
of T2 . This implies the following subtree for each possible supertree:
(((s2 , x ), y), s1). Therefore, the cross triple {s1 , s2 , x } is resolved as the
only possible way to display this triple is ((s2 , x ), s1 ) as shown in Figure 3. Thus, we have constructed an informative topology assignment
of S with respect to σ. This completes the proof.


Next we introduce the definition of split groves and tripartition groves in
order to simplify the definition of groves.
Definition 3.4 (Split grove). A split grove is a set S of taxon sets such that
for each possible split σ of S it holds either that

• there exists no cross triple of S with respect to σ, or
• there exists an informative topology assignment on S w.r.t. σ.
Remark 3.5. Obviously, every grove is also a split grove by definition. However, the opposite is not always true. This can be seen by looking at the set
S := {{ x, y}, {y, z}, { x, z}}. None of the possible splits σ1 := { x, y}|{y, z},
{ x, z}, σ2 := { x, y}, {y, z}|{ x, z} or σ3 := {y, z}|{ x, y}, { x, z} has any cross
triples, as all taxa are displayed together on one side of the split, respectively. So by Definition 3.4, S is a split grove. However, the partition π :=
{ x, y}|{y, z}|{ x, z} has a cross triple, namely { x, y, z}. This cross triple is not
resolved by any tree combining the three 2-taxon sets (‘cherries’) as 2-taxon
trees do not provide any information on the tree topology. Thus, S is not a
grove as there is a partition which has a cross triple, but no resolved one.
As the above remark shows, the concept of split groves is not strong
enough to cover the grove concept and to simplify it. Therefore, we next
introduce tripartition groves and then show that they indeed are equivalent
to groves. Recall that a tripartition is a partition of a set into three disjoint
subsets.
Definition 3.6 (Tripartition grove). A tripartition grove is a set S of taxon
sets such that for each possible split or tripartition τ of S it holds either that
• there exists no cross triple of S with respect to τ, or
• there exists an informative topology assignment on S w.r.t. τ.
Again, all groves are tripartition groves by definition. Next we show
that the converse is also true, which provides a significant simplification of
the grove concept.
Theorem 3.7. Every tripartition grove is a grove and every grove is a tripartition
grove.

Mathematical aspects of phylogenetic groves

9

Proof. As mentioned before, the second part directly follows by definition.
We now prove the first part. Therefore, let S be a tripartition grove and let
π = S1 | . . . |Sk be a partition of S . If there is no cross triple of S with respect
to π, there is nothing to show. So now assume that there is a cross triple
{ x, y, z} of S with respect to
π. We have to show
that there is also a resolved
S
S
S
cross triple. Let S xy :=
Si , S xz :=
Si ,
Syz :=
Si ,

Ŝ :=

S

i ∈{1,...,k }

i ∈{1,...,k }

i ∈{1,...,k }

x ∈ Si , z ∈
/ Si

z ∈ Si , y ∈
/ Si

y ∈ Si , x ∈
/ Si

Si . Now let τ := S xy |S xz |Syz ∪ Ŝ be a tripartition seperating

i ∈{1,...,k }

x,y,z ∈
/Si

{ x, y, z} such that it is a cross triple with respect to τ by construction. This is
possible as { x, y, z} is a cross triple of S with respect to π and thus the three
taxa do not appear together in any Si . Note that it is possible, if π is a 2partition, i.e. a split, that one of the sets S xy , S xz , Syz as well as the set Ŝ may
be empty. However, as S is a tripartition grove, the existence of a cross triple
with respect to τ implies the existence of a resolved cross triple { x̂, ŷ, ẑ} of
S with respect to τ. This cross triple is also a cross triple with respect to π
(otherwise { x̂, ŷ, ẑ} would appear together in one Si and would therefore
not be separated by τ, either). So using the same topology assignment that
resolves { x̂, ŷ, ẑ} for τ, { x̂, ŷ, ẑ} is a resolved cross triple of S with respect to
π. This completes the proof.

Theorem 3.7 shows that the concepts of groves and tripartition groves
are identical. This characterization of groves thus simplifies the search for
groves already drastically, as it reduces the analysis from all possible partitions to splits and tripartitions.
In the following section, we finally investigate Conjecture 1.1.

3.2. Examining unions of intersecting groves
Our main goal in this section is to show that Conjecture 1.1 does not generally hold. Therefore, we first show that indeed the three properties of the
conjecture are equivalent, which enables us to provide a counterexample to
property (2) and thereby disprove property (1).
Lemma 3.8. The three properties stated by Conjecture 1.1 are equivalent.
Proof.
• We start by showing that (1) implies (2). Let S1 , S2 ⊆ D be groves in a
database of taxon sets D such that S1 ∩ S2 6= ∅. Assume S1 ∪ S2 is not
a grove. Let S1max , S2max be maximal supergroves of S1 , S2 , respectively.
I.e. S1max , S2max are groves that contain S1 or S2 , respectively, and by
Definition 2.5 they are such that no other taxon set of D can be added
to them without destroying the grove property. Note that it is possible
that Si = Simax for i = 1, 2. As by assumption S1 ∪ S2 is not a grove,
we have Simax 6= S1 ∪ S2 for i = 1, 2. Now as S1 ∩ S2 6= ∅, we have

10

Mareike Fischer

S1max ∩ S2max 6= ∅. But because of property (1) of Conjecture 1.1, the set
of maximal groves of S are a partition of S , which in particular means
that they cannot intersect. So this is a contradiction and therefore the
assumption is wrong. Thus, S1 ∪ S2 is a grove.
• Next we show that (2) implies (3). Let S1max , S2max be two maximal groves
such that S1max 6= S2max . Assume S1max ∩ S2max 6= ∅. Then by property (2),
S1max ∪ S2max is a grove. But as S1max 6= S2max , there is at least one taxon
set included in S1max ∪ S2max which is not present in S1max or S2max , respectively. Therefore, |S1max ∪ S2max | > |S1max | and |S1max ∪ S2max | > |S2max |.
This contradicts the maximality of S1max , S2max . Thus, the assumption is
wrong and S1max ∩ S2max = ∅.
• Last, we show that (3) implies (1). As (3) already states that maximal
groves do not intersect, it only remains to show that each taxon set
X ∈ D belongs to a maximal grove. All X ∈ D are groves by definition
(as for single sets there is no partition). Now each such grove can either
be combined with other taxon sets in D in order to form a bigger grove
(which then can be maximized adding more taxon sets if possible), or
no such combination is possible. In the latter case, X itself is maximal
by definition. So in both cases, X belongs to a maximal grove.

We are now in a position to show that Conjecture 1.1 does not hold.
Proposition 3.9. Conjecture 1.1 is not generally true. In particular, the union of
intersecting groves is not necessarily a grove.
Proof. We provide an explicit counterexample to property (2) of Conjecture
1.1. Let S1 := {{1, 2, 3} , {1}} and S2 := {{1, 4, 5} , {1}}. Then, S1 is a grove
as there is only one possible partition, namely π := {1, 2, 3} | {1}, and for
this partition there are no cross triples. By the same argument, S2 is also a
grove. Now S1 ∩ S2 = {{1}} 6= ∅. If Conjecture 1.1 was true, S1 ∪ S2 =
{{1, 2, 3} , {1} ,
{1, 4, 5}} would be a grove. But by Lemma 3.2, this cannot be the case, as
the sets {1, 2, 3} and {1, 4, 5} only share one taxon and thus all cross triples
between the two sets remain unresolved. Moreover, the set {1} does not
contribute any new information to either of the trees. Therefore, S1 ∪ S2 is
not a grove.

In our proof, we explicitly use Lemma 4.1 of [1] in order to show that
the example provided is a counterexample to property (2) of Conjecture 1.1,
but of course one can also examine all possible topology assignments for the
sets {1, 2, 3} and {1, 4, 5} (the singleton {1} does not contribute any information). The only possible cross triples of S1 ∪ S2 (if there are any, which is
only the case for partitions which split the sets {1, 2, 3} and {1, 4, 5} apart
from each other) are {1, 2, 4}, {1, 2, 5}, {1, 3, 5}, {2, 3, 4}, {2, 3, 5}, {2, 4, 5}
and {3, 4, 5}. Now the intuitive reason why none of these cross triples is
resolved when combining the topologies assigned to the sets {1, 2, 3} and
{1, 4, 5} is that their only overlap is taxon 1, which does not suffice to fix
anything in the possible supertrees.

Mathematical aspects of phylogenetic groves

11

3.3. Some corrections concerning the paper by Ané et al. [1]
It should be noted that S1 := {{1, 2, 3} , {1}} and S2 := {{1, 4, 5} , {1}} as
presented in the proof of Proposition 3.9 are indeed both groves, despite
the fact that each of them consists only of two taxon sets which overlap with
one another in just one taxon. This is in contrast to a statement in the context
preceding Proposition 5.1 of [1], where the authors claim that the smallest
example of a grove with one-taxon overlaps consists of four taxon sets. In
fact, the authors make the same mistake in both Propositions 5.1 and 5.2.
Therefore, we will now formally state these Propositions and correct them
thereafter.
Proposition 5.1 of [1] Let S be a set of three taxon sets such that no
two elements of S share more than one taxon.
1. Then, no cross triple of S with respect to any partition is resolved, and
2. therefore, S is not a grove.
The second statement in Proposition 5.1 of [1] is wrong. In fact, the
authors correctly prove the first statement but then conclude the second
statement out of the first without taking into account that their definition
of groves does not require the existence of any cross triples. The first part
of the proposition, however, is correct and interesting; it is another formal
statement proving that S1 ∪ S2 as in the proof of Proposition 3.9 cannot be a
grove. This is due to the fact that this set can be partitioned such that it has
cross triples, but as it consists of three taxon sets where no element shares
more than one taxon with another element, no such cross triple can be resolved.
Nonetheless, there are groves consisting of three taxon sets where no
two elements share more than one taxon. For instance, S := {{1, 2, 3}, {1, 2},
{2, 3}} is a grove contradicting statement (2) of Proposition 5.1 of [1]. This
is due to the fact that one set in S contains all taxa, so no partition contains
any cross triples.
As the authors use Proposition 5.1 of [1] to prove the following proposition, it is not surprising that the same mistake occurs there, too.
Proposition 5.2 of [1]Let S be a set of four taxon sets such that no two
elements of S share more than one taxon. Then, S is a grove if and only if
1. each taxon set shares a taxon with each other taxon set, and
2. each of the six overlaps involves a different taxon.
The statement of Proposition 5.2 of [1] can be proven wrong by considering the set S := {{1, 2, 3}, {1, 2}, {1, 3}, {1}}. Again, as one taxon set in S
contains all taxa, no partition produces any cross triples, which makes S a
grove. But all six overlaps involve the same taxon, namely taxon 1. However,
the other direction of Proposition 5.2 of [1] is true, as well as both directions
are true for groves which do indeed have at least one cross triple with respect to a partition.

12

Mareike Fischer

The mistake made in the above propositions is explicable considering
the main purpose of the grove idea: only sets of taxon sets with the potential to deliver new information should be considered. As explained before,
this idea is not really reflected in Definition 2.4, the definition of groves as
given by the authors. However, it will be shown in Section 3.4 that simply excluding trivial cases (like e.g. groves containing a set of all taxa) from
the definition does unfortunately not improve the situation with regards to
Conjecture 1.1.
3.4. Informative groves and strictly informative groves
Now we modify the concept of groves in order to guarantee more informativeness. We have seen for instance that the example in the proof of Proposition 3.9 leading to the problematic case only employs groves S1 and S2
which both contain one set which includes all their taxa, respectively. So
any supertree of the sets in S1 will always be identical to the tree assigned
to this taxon set (and the same holds for S2 , respectively). Therefore, whilst
both S1 and S2 fulfill the requirements of groves, they do not represent very
interesting cases as no supertree of them can ever reveal new information.
We now examine Conjecture 1.1 for more interesting cases, namely informative and strictly informative groves.
Definition 3.10.
1. A grove S is called informative, if there exists a partition π of S such
that there is an informative topology assignment on S w.r.t. π.
2. A grove S is called strictly informative, if for all partitions π of S there
is an informative topology assignment on S w.r.t. π.
We now state a result analogous to Proposition 3.9 for informative
groves.
Proposition 3.11. The union of intersecting informative groves is not necessarily
a grove.
Proof. We provide an explicit counterexample. Let S1 := {{1, 2, 3} , {2, 3, 4} ,
{4}} and S2 := {{4, 5, 6} , {5, 6, 7} , {4}}. Then, S1 is an informative grove
as the only way to partition S1 such that there are cross triples is to split
{1, 2, 3} and {2, 3, 4} apart. Then, the cross triples are {1, 2, 4} and {1, 3, 4},
which are for instance resolved when the topology assignment ((1, 2), 3)
and ((2, 3), 4) is chosen, as then the only possible supertree is (((1, 2), 3), 4).
This is analogous to the example depicted by Figure 2. By the same argument, S2 is an informative grove. Now S1 ∩ S2 = {{4}} 6= ∅. But S1 ∪ S2 =
{{1, 2, 3} , {2, 3, 4} , {4} , {4, 5, 6} , {5, 6, 7}} is not a grove. As above, the intuitive reason is that for partiton π := {1, 2, 3} , {2, 3, 4} , {4} | {4, 5, 6} ,
{5, 6, 7}, no matter which topology assignment is chosen, the fact that S1
and S2 overlap in just one taxon, namely taxon 4, is not enough to fix the
supertrees. Basically, one can choose compatible trees for all taxon sets such
that supertrees for S1 and S2 are computed, respectively. Then, by Lemma

Mathematical aspects of phylogenetic groves

13

4.1 of [1], as the taxa of S1 and S2 only intersect in one taxon, the two trees
are compatible and can be combined in any possible way to form a common supertree, as the only condition is that both contain taxon 4. Therefore,
no cross triple of this partition is resolved (but there are cross triples with
respect to π, e.g. {1, 2, 5}). Thus, S1 ∪ S2 is not a grove.

It is worth noting that the union of informative groves does not only
lose informativeness when the underlying groves intersect, but rather the
grove property itself. We now show a weaker statement for strictly informative groves.
Proposition 3.12. The union of intersecting strictly informative groves is not
necessarily strictly informative (even if it is a grove).
Proof. We provide an explicit counterexample. Let S1 := {{1, 2, 3} , {2, 3, 4}}
and S2 := {{1, 2, 3} , {1, 3, 4}}. Then, S1 is a strictly informative grove as
the only way to partition S1 is to split {1, 2, 3} and {2, 3, 4} apart. The cross
triples are {1, 2, 4} and {1, 3, 4}, which are for instance resolved when the
topology assignment ((1, 2), 3) and ((2, 3), 4) is chosen, as then the only possible supertree is (((1, 2), 3), 4). This is analogous to the situation depicted
in Figure 3. By the same argument, S2 is a strictly informative grove. Now
S1 ∩ S2 = {{1, 2, 3}} 6= ∅. But S1 ∪ S2 = {{1, 2, 3} , {2, 3, 4} , {1, 3, 4}} is not
strictly informative. This can be seen when examining the split {1, 2, 3} |
{2, 3, 4} , {1, 3, 4}, which has no cross triples and therefore does not fulfill
the strict informativeness criterion.

While Proposition 3.12 shows that even strictly informative groves do
not fulfill the properties of Conjecture 1.1 (2), we conjecture that a scenario
as the one in Proposition 3.11 is not possible for strictly informative groves.
Conjecture 3.13. The union of two intersecting strictly informative groves is
a grove.

3.5. 2-overlap groves
As the previous sections show, the grove concept introduced by Ané et al.
[1] does not fulfill the properties specified in Conjecture 1.1, even if it is
interpreted in a stricter way as in Section 3.4. As explained in Section 1,
Conjecture 1.1 (1) is of importantance concerning the search for groves in
databases. We now introduce an alternative grove definition, which fulfills
the conjecture and thus simpflifies the search for groves. In order to do so,
we first need to define 2-overlap graphs.
Definition 3.14. Let S be a set of taxon sets X1 , . . . , Xk . Its 2-overlap graph is
the graph G := (S , E), where an edge { Xi , X j } ∈ E if and only if Xi and X j
share at least 2 taxa, i.e. | Xi ∩ X j | ≥ 2.
Definition 3.15 (2-overlap grove). Let S be a set of taxon sets. Then, S is
called a 2-overlap grove if and only if its 2-overlap graph is connected.

14

Mareike Fischer

Example. Figure 4 shows an example S where the 2-overlap graph is connected which makes S a 2-overlap grove, as well as an example Ŝ , whose
2-overlap graph consists of two connected components such that Ŝ is not a
2-overlap grove.
We now show that 2-overlap groves are indeed groves.
Theorem 3.16 (Theorem 1.1 of [1]). Every set of taxon sets whose 2-overlap
graph is connected is a grove.
Corollary 3.17. Every 2-overlap grove is a grove.
The proof of Corollary 3.17 is a direct conclusion of Theorem 3.16. So all
2-overlap groves are groves, but – as can be seen for instance in Proposition
3.9 – not all groves are 2-overlap groves. There, we used the groves S1 :=
{{1, 2, 3} , {1}} and S2 := {{1, 4, 5} , {1}}, whose 2-overlap graphs are both
not connected, to show that the union of intersecting groves need not be a
grove. Next we show that such issues naturally cannot arise with 2-overlap
groves.
Theorem 3.18. If two 2-overlap groves intersect, their union is also a 2-overlap
grove.
Proof. Let S1 , S2 be two 2-overlap groves such that S1 ∩ S2 6= ∅.Then, there
is a taxon set S ∈ S1 ∩ S2 . Now, as the 2-overlap graphs of S1 and S2 are
both connected, both are in particular connected to S. Thus, S connects the
two 2-overlap graphs and therefore the 2-overlap graph of S := S1 ∪ S2 is
connected. By Definition 3.15, this implies that S is a 2-overlap grove. This
completes the proof.

As Lemma 3.8 naturally also applies to 2-overlap groves, it turns out
that 2-overlap groves have all required properties stated by Conjecture 1.1
(not just the second one), and thus resolve all problems inherent to the grove
concept of Definition 2.4. And as all 2-overlap groves are also groves, they
also have the potential to construct informative supertrees.
Remark 3.19. Note that while all 2-overlap groves are also groves, they are
not directly related to strictly informative groves, as neither property implies the other. We show this with the following two examples.
1. The set of taxon sets S = {{1, 2}, {1, 2, 3}} is a 2-overlap grove, because its 2-overlap graph is connected as shown in Figure 4. However,
as the only possible partition, namely the split {1, 2}|{1, 2, 3}, does not
have any cross triples and thus also no resolved ones, S is a grove, but
not a strictly informative one. So it has to be noted that the 2-overlap
grove concept still includes some groves which contain one set with all
taxa, in which case a supertree cannot provide new information.
2. The set of taxon sets Ŝ = {{2, 3, 6}, {1, 4, 5}, {2, 4, 5, 7}} is a not a 2overlap grove, because its 2-overlap graph is not connected as shown
in Figure 4. However, choosing the topology assignment P :=

Mathematical aspects of phylogenetic groves

15

{((2, 3), 6), ((1, 4), 5), (((4, 5), 2), 7)} leads to supertrees in which the
position of the taxa 3 and 6 varies for each tree, but all contain the subtree T := ((((1, 4), 5), 2), 7) (the so-called ‘maximum agreement subtree’) as shown in Figure 5. Moreover, the triple {1, 3, 7} is a cross triple
for all possible partitions of Ŝ , and this cross triple is resolved by the
maximum agreement subtree. Thus, this topology assignment resolves
a cross triple for all possible partitions. Therefore, Ŝ is a strictly informative grove.

{1, 4, 5}
S:

{1, 2}

{1, 2, 3}

Ŝ :

{2, 3, 6}
{2, 4, 5, 7}

F IGURE 4. The set S = {{1, 2}, {1, 2, 3}} is a 2-overlap
grove but not a strictly informative grove. For the set Ŝ , the
situation is vice versa.

T

2

3

6

1

4

5

4

5

2

7

1

4

5

2

7

F IGURE
5. The
topology
assignment
P
:=
{((2, 3), 6), ((1, 4), 5), (((4, 5), 2), 7)} leads to various
supertrees, as the position of the taxa 3 and 6 varies.
However, all supertrees contain the maximum agreement
subtree T := ((((1, 4), 5), 2), 7), so that in any case the triple
{1, 3, 7} gets resolved.

4. Discussion
In this paper, we showed that the concept of groves as introduced by Ané et
al. [1] can be simplified to the much simpler concept of tripartition groves.
This reduces the search for groves in databases drastically from investigating all partitions to analyzing only splits and tripartitions only, which is a
great improvement. But we also showed that groves as introduced by Ané

16

Mareike Fischer

et al. unfortunately do not fulfill the requirements of Conjecture 1.1, which
implies that they are hard to find in databases of taxon sets even when our
simplification is considered. We also investigated slightly modified versions
of the original grove definition in order to enforce more informativeness,
but even then there were similar drawbacks in the grove concept. Finally,
we successfully proved that our new concept of 2-overlap groves fulfills all
properties of the conjecture, while these 2-overlap groves are also groves in
the original sense of the definition. So they comprise the good properties of
groves, namely for instance offering the potential of informative supertrees,
with a property that makes them more easily identifiable in databases. It
should be noted that the latter is not only due to the fact that Conjecture
1.1 (2) holds for 2-overlap groves, but also to the fact that the construction of
the 2-overlap graph of a database can be done more efficiently and more easily than investigating all cross triples of all possible splits and tripartitions.
Moreover, the 2-overlap graph of a database immediately displays all maximal 2-overlap groves in the database and thus shows quickly which taxon
sets should be combined in order to find new information in the corresponding phylogenetic supertrees. It should be noted, though, that our concept of
2-overlap groves only covers a subset of the groves by Ané et al. [1], as all
2-overlap groves are groves but the opposite does not hold. Therefore, some
taxon sets which only overlap in a single taxon are not covered by our concept, whereas they may be considered as groves. However, we claim that
these examples are rather artificial in the sense that in practice, biologists
rarely wish to combine trees with only one taxon in common. So the simplification gained by restricting ourselves to 2-overlaps seems to outweigh the
possible drawbacks by considering fewer cases. Altogether, we think this
new concept is promising and more research should be done. For instance,
practical analyses in real databases would be really helpful.
Acknowledgment
I wish to thank Mike Steel, Arndt von Haeseler, Oliver Eulenstein and Anne
Kupczok for helpful discussions. I also wish to thank Clemens Zarzer for his
fruitful suggestions on previous versions of the manuscript as well as his
programming support. Financial support from the Wiener Wissenschafts-,
Forschungs- und Technologiefonds (WWTF) to Arndt von Haeseler is greatly
appreciated.

References
[1] C. Ané, O. Eulenstein, R. Piaggio-Talice, M. Sanderson, Groves of phylogenetic trees.
Ann. Comb. 13 (2009), 139–167.
[2] L.R. Foulds, R.L. Graham, The Steiner problem in phylogeny is NP-complete. Adv.
Appl. Math. 3 (1982), 43–49.
[3] S. Roch, A short proof that phylogenetic tree reconstruction by maximum likelihood is
hard. IEEE/ACM Trans. on Comp. Biol. and Bioinf. 3 (2006), 92–94.

Mathematical aspects of phylogenetic groves

17

[4] B. Chor, T. Tuller, Finding a maximum likelihood tree is hard. J. of ACM, 53 (2006),
722–744.
[5] O.R.P. Bininda-Emonds (Editor), Phylogenetic Supertrees: Combining Information to
Reveal the Tree of Life. Dordrecht: Kluwer Academic, 2004.
[6] A.D. Gordon, Consensus Supertrees: The Synthesis of Rooted Trees Containing Overlapping Sets of Labelled Leaves. J. Classif., 3 (1986), 335–348.
[7] B.R. Baum, Combining trees as a way of combining data sets for phylogenetic inference,
and the desirability of combining gene trees. Taxon, 41 (1992), 3–10.
[8] D. Bryant, M. Steel, Extension operations on sets of leaf-labelled trees. Adv. Appl.
Math. 16 (4) (1995), 425–453.
Mareike Fischer
Center for Integrative Bioinformatics Vienna (CIBIV)
Max F. Perutz Laboratories
(Joint research institute of the
University of Vienna, Medical University of Vienna, Veterinary University of Vienna)
Dr. Bohr Gasse 9
A-1170 Vienna
Austria
e-mail: email@mareikefischer.de

