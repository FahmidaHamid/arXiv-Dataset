arXiv:1408.4417v2 [q-bio.PE] 20 Jan 2015

Exact solutions for the selection–mutation equilibrium in the
Crow–Kimura evolutionary model
Yuri S. Semenov1 , Artem S. Novozhilov2,∗
1 Applied
2 Department

Mathematics–1, Moscow State University of Railway Engineering,
Moscow 127994, Russia

of Mathematics, North Dakota State University, Fargo, ND 58108, USA

Abstract
We reformulate the eigenvalue problem for the selection–mutation equilibrium distribution in the case of a haploid asexually reproduced population in the form of an equation
for an unknown probability generating function of this distribution. The special form of
this equation in the infinite sequence limit allows us to obtain analytically the steady state
distributions for a number of particular cases of the fitness landscape. The general approach
is illustrated by examples; theoretical findings are compared with numerical calculations.
Keywords: Selection–mutation equilibrium, quasispecies model, Crow–Kimura model, error threshold, single peaked landscape
AMS Subject Classification: Primary: 92D15; 92D25; Secondary: 15A18

1

Introduction

Selection and mutation are two main evolutionary forces that shape (together with recombination and genetic drift) the life histories of evolving populations. The mathematical theory of
selection–mutation models is deep and elaborate (e.g., [7]), covering various biological assumptions, such as different mutation schemes, consequence of ploidy, mating systems, heterogeneous
environment, etc. The scope of the theory notwithstanding, even the simplest possible formulation of a multi locus mutation–selection model in the case of an asexually reproduced haploid
population still presents mathematical challenges. The goal of our manuscript is to introduce
an approach that allows, at least in some special cases, a relatively straightforward derivation
of the steady state distribution for such model.
Consider a haploid one locus asexually reproduced population with N + 1 alleles. Let pi =
pi (t) be the frequency of the i-th allele at time t, i = 0, . . . , N ; the corresponding Malthusian
fitness is denoted mi . Let µij denote the mutation rate of allele j to allele i. Then, assuming
∗

Corresponding author: artem.novozhilov@ndsu.edu

1

that the reproduction events and mutations are separated, we end up with a nonlinear system
of ordinary differential equations (e.g., [1, 8]) of the form
ṗi = (mi − m)pi +

N
X

µij pj ,

i = 0, . . . , N,

(1.1)

j=0

P
P
where µii = − j6=i µij , and m = N
j=0 mj pj is the mean population fitness. In the matrix form
system (1.1) reads
ṗ = (M − mI)p + Mp,
(1.2)
where M = diag(m0 , . . . , mN ) is the fitness landscape, M = (µij ) is the mutation matrix,
p = (p0 , . . . , pN )⊤ , and I is the identity matrix. Model (1.2) is invariant with respect to
rescalings of the Malthusian fitnesses as m̃i = mi + m̃ for any constant m̃ and does not allow
for lethal mutations.
A basic fact about model (1.2) is as follows. Given that the matrix M is irreducible, then
there exists a unique globally stable positive selection–mutation equilibrium limt→∞ p(t) = p̂
that can be found as the normalized eigenvector
of the matrix M + M corresponding to the
P
strictly dominant eigenvalue λ = m̂ = N
m
p̂
j=0 j j (e.g., [7, 21]). In Eigen’s theory of the origin
of life, which is equivalent to the selection–mutation approach in haploid populations [24], the
eigenvector p̂, which describes the equilibrium frequencies of the self-replicating macromolecules,
was called the quasispecies [9, 10, 11].
To obtain further theoretical results on the form of the dominant eigenvalue λ and/or
selection–mutation equilibrium p̂, additional assumptions on the form of the fitness landscape
M and/or mutation matrix M are necessary. For example, a profitable way is to neglect the
reverse mutations, i.e., put (e.g., [23])
µij > 0,

i > j,

µij = 0,

i < j,

or even more restrictive (e.g., [22])
µj+1,j > 0,
µij = 0,

i 6= j, i 6= j + 1.

A less restrictive assumption is to assume that allele j can mutate only to the neighbors j − 1
and j + 1, other mutations are prohibited [1, 3, 13]. In the last case, assuming additionally that
µj−1,j = µj,
µj+1,j = µ(N − j),

(1.3)

µjj = −µN,

for some constant µ > 0, it is possible to write down an explicit solution for the equilibrium
frequencies p̂i in the case of an additive or Fujiyama fitness landscape, defined as mj = −M j
for some constant M > 0 [3, 14, 16] (we reproduce this solution, using our method, below in
Example 3.6).
We stress that no simple analytical expressions for the components of p̂ are known for a
general fitness landscape M and the mutation scheme (1.3); even in the case of a single or
2

sharply peaked landscape, defined as M = diag(m0 , 0, . . . , 0), m0 > 0, there exists no analytical
solution.
The mutation scheme (1.3) naturally arises if one changes the point of view from a one locus
N + 1 allele population to a biallelic N locus haploid population, which is scrutinized in the
quasispecies theory [1, 6, 10, 15]. To this end, consider a population of sequences, each sequence
consists of N sites (loci), and each site can be either in 0 or 1 state (two alleles per each locus).
Let µ > 0 denote the mutation rate per site per sequence per time unit, such that 0s mutates to
1s and 1s mutates to 0s with the same rate µ > 0. Also assume that fitness is determined by the
number of 1s in the sequence such that we have N + 1 different sequence classes with fitnesses
m0 , m1 , . . . , mN (this is sometimes called permutation invariant or symmetric fitness landscape).
Then the dynamics of the frequencies of classes are determined by model (1.2) with (1.3), which
is often called in the literature the paramuse or Crow–Kimura quasispecies model [1].
It was shown that model (1.2), (1.3) is equivalent to a so-called Ising quantum chain (e.g.,
[3]). This fact allowed obtaining a number of analytical results about the mean population
fitness λ = m̂ (and for some other population averages) in the selection–mutation equilibrium
when the sequence length approaches infinity (N → ∞) under an appropriate scaling of the
model parameters [3].
A similar infinite sequence point of view was taken in [13] (see also [2] for a more recent
generalization), where a maximum principle for the mean population fitness was formulated.
For our needs the maximum principle can be formulated as follows (we note that a more general
case is treated
in [13]).
Assume that mi = N ri = N r(xi ), xi = i/N ∈ [0, 1] and define g(x) =
p

µ 1 − 2 x(1 − x) . Then the scaled equilibrium fitness r̂ = m̂/N is given by

r̂ ≈ r̂∞ = sup r(x) − g(x) .

(1.4)

x∈[0,1]

Using the approximate expression for the mean fitness in (1.4) it is possible to obtain expressions
for other averages such as the variance per site of fitness and of distance from the fittest class [13].
However, no attempt was made in [13] to obtain analytical expressions for p̂∞ (we use index ∞
throughout the text to denote the expressions in the infinite sequence limit).
An exact integral representation of p̂∞ for the infinite sequence length for the mutation
scheme (1.3) and the single peaked landscape was written in [12], however, transparent analytical
expressions were obtained only for r̂∞ and p̂∞,0 . In [18] a full solution for p̂∞,i was written down
by disregarding the reverse mutations from class j to class j−1. The same solution was rigorously
obtained in [6] together with estimates of the speed of convergence. In [17], using the Hamilton–
Jacobi formalism, a general solution for p̂∞ depending on an arbitrary scaled fitness landscape
r(x) is suggested in an integral form. This general solution is, however, not straightforward to
apply to obtain relatively simple analytical expressions for the selection–mutation equilibrium
frequencies p̂∞,i . Therefore, we conclude that there exists no simple general way to find the
quasispecies distribution p̂∞ even under the simplifying assumption of the infinite sequence
length.
The goal of the present text is to suggest a straightforward way of calculating the selection–
mutation equilibrium for the model (1.2), (1.3) in the infinite sequence length limit that leads to
transparent analytical expressions at least for some particular fitness landscapes (for an extensive
background for the current work we refer to [6] and [19]).

3

2

A general approach to solve for the selection–mutation equilibrium

Our goal is to find approximations for
P the dominant eigenvalue λ = m̂ and the corresponding
normalized eigenvector p̂ (such that N
i=0 p̂i = 1 and p̂i ≥ 0 for any i) of the eigenvalue problem
(M + µQ)p̂ = λp̂,

where M = diag(m0 , . . . , mN ), µ > 0, and

−N
1
0
0
N
−N
2
0

 0
N
−
1
−N
3

Q=
0
N − 2 −N
 0
 ...
...
...
...

 0
0
...
...
0
0
...
...

... ...
... ...
... ...
... ...
... ...
2 −N
0
1

(2.1)


0
0 

0 

0 
.
... 

N 
−N

We note that at the equilibrium both m̂ and p̂ are the functions of the mutation rate µ: m̂ =
m̂(µ), p̂ = p̂(µ). Together with the matrix Q we also consider a linear differential operator
Q : P (s) −→ (1 − s2 )P ′ (s) − N (1 − s)P (s),

(2.2)

acting on the (N + 1)-dimensional vector space of polynomials of degree less or equal N . By
direct calculations, matrix Q is the matrix
of Q in the standard basis {1, s, . . . , sN }. For any
P
i
m = (m0 , . . . , mN ) ∈ RN +1 and P (s) = N
i=0 pi s we introduce the notation
m ◦ P (s) =

N
X

mi p i s i .

i=0

Then problem (2.1) can be rewritten for the unknown probability generating function P (s) as
m ◦ P (s) + µQP (s) = m̂ P (s),

(2.3)

m ◦ P (s) + µ(1 − s2 )P ′ (s) − µN (1 − s)P (s) = m̂ P (s),

(2.4)

where m̂ = m ◦ P (1), or

with the normalization condition P (1) = 1. Inasmuch as problem (2.4) is equivalent to (2.1) then,
due to the Perron–Frobenius theorem, there exists a unique solution P (s) satisfying P (1) = 1.
There is little hope to be able to solve equation (2.4) explicitly (one such example, well known in
the literature, is given below, see Example 3.6). It is possible, however, to find approximations
of the quantities of interest in the case N → ∞ at least for some particular fitness landscapes
under some additional assumptions.
To formulate the general approach, we introduce the notations
r=

m
,
N

r̂ =
4

m̂
.
N

After dividing by N equation (2.4) takes the form
r ◦ P (s) +

µ
(1 − s2 )P ′ (s) − µ(1 − s)P (s) = r̂ P (s).
N

Now we make the following assumptions:
H1: There exists the limit

lim P (s) = P∞ (s).

N →∞

The distribution p̂∞,i = p̂i , i = 0, 1, 2, . . ., corresponding to P∞ (s) =
called the limit distribution.
H2:

lim

N →∞

P∞

i=0 p̂i s

i,

will be

µ
(1 − s2 )P ′ (s) = 0.
N

H3: For some limit operator r ∞
lim r ◦ P (s) = r ∞ ◦ P∞ (s).

N →∞

Remark 2.1. The assumption H2 is a formal consequence of H1 and H3, but we decided to
keep it in the list because it gives the main idea of the suggested method.
If H1–H3 hold then problem (2.4) is reduced to a nonlinear functional equation with respect
to the unknown probability generating function P∞ (s),
− µ(1 − s)P∞ (s) + r ∞ ◦ P∞ (s) = r̂ ∞ P∞ (s),

(2.5)

with the conditions
r ∞ ◦ P (1) = r̂ ∞ ,

P∞ (1) = 1.

(2.6)

Problem (2.5)–(2.6) can be effectively solved at least for some simple choices of the fitness
landscape M (see the next section for representative examples). A careful scrutiny of validity
of the obtained solutions requires a deeper analysis of the convergence of the eigenvalue m̂ and
the quasispecies p̂ when N → ∞. This, for instance, can be done with the help of parametric
solutions to (2.1) introduced in [6] (in Appendix A.1 we outline the approach used in [6], in
Appendix A.2 we provide an alternative parametric solution approach, which is illustrated by
applying it to Example 3.8). Notwithstanding these concerns, a formal solution of (2.5)–(2.6)
is of significant value, because, as the examples show, the found solutions closely approximate,
even for moderate values of N , numerical solutions of (2.1).
In a sense our approach is a generalization of the so-called random variable technique (e.g.,
[4]), and assumption H2 implies that we disregard all the mutations from j to j − 1 classes,
similarly to [22, 23]. To see this, consider the mutation scheme of the form
µj−1,j = µ1 j,
µj+1,j = µ2 (N − j),

µjj = −µ1 j − µ2 (N − j),
5

(2.7)

where µ1 6= µ2 . Then, as it can be directly checked, operator Q takes the form


d
Q : P (s) −→ µ2 (s − 1) N − s
P (s) + µ1 (1 − s)P ′ (s).
ds
After dividing by N and formally taking the limit, the only term that is left is
−µ2 (1 − s)P (s),
which agrees with (2.5) and shows that for the limit equation the rate of backward mutations
µ1 is neglected.
To conclude this section, we suggest the following approach: Solve problem (2.5)–(2.6) for
each µ. For the found solution P∞ (s) check H1–H3. If the hypotheses do not hold then notice
that P∞ (s) ≡ 0 solves (2.5)–(2.6), with r̂ ∞ (µ) ≡ 0. This corresponds to the delocalization
phenomenon of the quasispecies distribution, or, in terms of the Ising model, the phase transition, which was called the error threshold in the quasispecies theory. A number of examples
illustrating this approach are given in the following section.

3

Examples of the steady state distributions

Here we present several examples of the selection–mutation equilibrium for known and new
fitness landscapes; we also compare the analytical results with the numerical calculations. Two
well known cases are Example 3.1, treated in [6, 12, 18], and Example 3.6, treated originally in
[3, 14, 16]. We present full solutions in these two cases to demonstrate how our approach works.
Example 3.8 was discussed and partially analyzed in [6], however, no derivation for the steady
state distribution p̂∞ was provided; here we present all the details. Other examples are new
and are not treated anywhere else to the best of our knowledge.
Example 3.1 (Single peaked landscape). We start with a testbed (both numerical [20] and
analytical [12]) for the quasispecies model, which was called the single or sharply peaked landscape.
Let
r ∞ = (1, 0, . . . , 0, . . .).
Then
r ∞ ◦ P∞ (s) =
Equation (2.5) takes the form

∞
X

ri p̂i ti = p̂0 = P∞ (0).

i=0

−µ(1 − s)P∞ (s) + P∞ (0) = r̂ ∞ P∞ (s).
Plug s = 0 in the last expression and find
−µP∞ (0) + P∞ (0) = r̂∞ P∞ (0).
Assuming that P∞ (0) 6= 0 we find

r̂ ∞ (µ) = 1 − µ,
6

1

1

(b)

r̂(µ)

p̂(µ)

(a)

0
0

1

0
0

1.5

1

µ

µ

Figure 1: Comparison of numerical calculations for the single peaked landscape r = (1, 0, . . . , 0)
with N = 50 with the theoretical predictions of Example 3.1. The black solid lines are the
exact solutions for the case N → ∞ and the grey dashed lines are numerical computations. (a)
The mean population fitness versus the mutation rate. (b) The selection–mutation equilibrium
p̂ versus the mutation rate. After µ ≥ 1 the quasispecies distribution becomes degenerate
(binomial)
and hence, using the condition P∞ (1) = 1,
P∞ (s) =

1−µ
,
1 − µs

which is the probability generating function of the geometric distribution with the parameter µ.
Therefore the limit distribution is geometric
p̂∞,i = (1 − µ)µi ,

i = 0, 1, . . . .

We see, in view of H1—H3, that the discussion above holds only for µ < 1, therefore at µ = 1
the structure of the limit distribution abruptly changes and we obtain the solution P∞ (s) = 0
for µ ≥ 1. The mean population fitness has the form shown in Fig. 1a. This abrupt change in
the quasispecies distribution was called by Eigen et al. the error threshold [5] (see also [6, 13]
for an extensive discussion of this notion).
Example 3.2. As a second example, consider a slight generalization of the single peaked landscape in the form
r ∞ = (2, 1, 0, . . . , 0, . . .).
′ (0)s, and (2.5) takes the form
Then r ∞ ◦ P∞ (s) = 2P∞ (0) + P∞
′
−µ(1 − s)P∞ (s) + 2P∞ (0) + P∞
(0)s = r̂∞ P (s).

Plugging s = 0 yields
−µP∞ (0) + 2P∞ (0) = r̂ ∞ P∞ (0).
Assuming P∞ (0) 6= 0 we find

r̂∞ = 2 − µ,
7

1

1

(b)

p̂(µ)

p̂(µ)

(a)

0
0

0
0

2

2

µ

µ

Figure 2: Comparison of numerical calculations for the fitness landscape in Example 3.2 with
the theoretical predictions. The black solid lines are the exact solutions for the case N → ∞
and the grey dashed lines are numerical computations. (a) N = 50; (b) N = 100
and hence
′
−µ(1 − s)P∞ (s) + 2P∞ (0) + P∞
(0)s = (2 − µ)P∞ (s),

or
′
µsP∞ (s) + 2P∞ (0) + P∞
(0) = 2P∞ (s).

(3.1)

After differentiating the last expression with respect to s and plugging s = 0 we find µP∞ (0) =
′ (0). Plugging this into (3.1) implies
P∞
P∞ (s) = P∞ (0)

2 + µs
,
2 − µs

and finally, using the condition P∞ (1) = 1, we obtain
∞

P∞ (s) =

2 − µ X (2 − µ)µj j
(2 − µ)(2 + µs)
=
+
s .
(2 + µ)(2 − µs)
2+µ
(2 + µ)2j−1
j=1

Again, the reasonings above work only for µ < 2, and for µ ≥ 2 we obtain that r̂(µ) = 0 and
the quasispecies distribution is degenerate (see also Fig. 2).
Example 3.3. Let
r ∞ = (1, 2, 0, . . . , 0, . . .).
′ (0)s, and (2.5) takes the form
Then r ∞ ◦ P∞ (s) = P∞ (0) + 2P∞
′
−µ(1 − s)P∞ (s) + P∞ (0) + 2P∞
(0)s = r̂∞ P∞ (s).

We must assume that P∞ (0) = p̂∞,0 = 0 since max rk = 2 = r1 > r0 , therefore we cannot just
plug s = 0 in the last equality. Instead, we differentiate it and find
′
′
′
(s).
−µ(1 − s)P∞
(s) + µP∞ (s) + 2P∞
(0) = r̂ ∞ P∞

8

1

1

(b)

p̂(µ)

p̂(µ)

(a)

0
0

0
0

2

2

µ

µ

Figure 3: Comparison of numerical calculations for the fitness landscape in Example 3.3 with
the theoretical predictions. The black solid lines are the exact solutions for the case N → ∞
and the grey dashed lines are numerical computations. (a) N = 50; (b) N = 100
′ (0) 6= 0,
Then, for s = 0, assuming that p̂∞,0 = 0 and P∞

r̂∞ = 2 − µ.
Therefore,
′
−µ(1 − s)P∞ (s) + 2P∞
(0)s = (2 − µ)P∞ (s),

or
P∞ (s) =
which, together with P∞ (1) = 1, gives

′ (0)s
2P∞
,
2 − µs

∞

P∞ (s) =

µ  µj−1 j
(2 − µ)s X 
1−
=
s ,
2 − µs
2 2j−1
j=1

which holds only for µ < 2, for µ ≥ 2 the distribution becomes degenerate (see Fig. 3).
Remark 3.4. In general, if max rk = ra and rj < ra for j > a then we need additional initial
conditions
′
(a−1)
P∞ (0) = P∞
(0) = . . . = P∞
(0) = 0.
These initial conditions are motivated by the comparison of the theoretical predictions with the
numerical calculations, and at this point we lack an analytical proof of the validity of these
conditions in general.
Example 3.5 (A geometric landscape). Let 0 < q < 1 and
r ∞ = (1, q, q 2 , . . . , q N , . . .),
then r ∞ ◦ P∞ (s) = P∞ (qs), and (2.5) reads
−µ(1 − s)P∞ (s) + P∞ (qs) = r̂ ∞ P∞ (s).
9

Plugging s = 0 and assuming P∞ (0) 6= 0 we find
r̂∞ = 1 − µ,
which implies
P∞ (qs) = (1 − µs)P∞ (s).

(3.2)

Using the fact P∞ (1) = 1 and plugging into the last expression s = 1, s = q, s = q 2 , . . . we find
P∞ (q) = 1 − µ, P∞ (q 2 ) = (1 − µq)P∞ (q) = (1 − µ)(1 − µq), . . . , P∞ (q n ) =

n−1
Y
j=0

(1 − µq j ), . . .

Taking the limit n → ∞ implies
n

P∞ (0) = lim P∞ (q ) =
n→∞

Assuming P∞ (s) =

P∞

j=0 p̂j s

j

∞
Y

(1 − µq j ).

j=0

in (3.2), we obtain

q n p̂n = p̂n − µp̂n−1 ,

or

p̂n =

µ
p̂n−1 ,
1 − qn

which gives, for 0 < µ < 1, the limit distribution (see also Fig. 4)
p̂0 =

∞
Y

(1 − µq j ),

j=0

µn
p̂0 .
k
k=1 (1 − q )

p̂n = Qn

The value µ = 1 is critical and corresponds to the error threshold. See Fig. 4 for comparison of
the theoretical predictions and numerical computations.
Q
We note that there are effective methods to calculate the expressions of the form ∞
j=0 (1 −
c
j

µq ) numerically. For instance, in Mathematica this is done with the help of function QPochhammer[µ, q].
Example 3.6 (Additive or Fujiyama fitness landscape). The only fitness landscape for which
problem (1.2) with the mutation scheme (1.3) can be analytically solved for the selection–
mutation equilibrium is the additive fitness landscape, which we define here as


2
N
1
=0 .
r = r N = 1, 1 − , 1 − , . . . , 1 −
N
N
N
The solution can be found in [3, 14] and arguably is most naturally derived using the tensor
products for the representation of matrices M + M. Here we re-derive the same solution using
the generating function approach.
Since
s
r N ◦ PN (s) = PN (s) − PN′ (s),
N
then (2.4) reads
µ
s
(1 − s2 )PN′ (s) − µ(1 − s)PN (s) + PN (s) − PN′ (s) = r̂ N PN (s).
N
N
10

1

1

(b)

p̂(µ)

p̂(µ)

(a)

0
0

0
0

1

1

µ

µ

Figure 4: Comparison of numerical calculations for the fitness landscape in Example 3.5 with
the theoretical predictions. The black solid lines are the exact solutions for the case N → ∞
and the grey dashed lines are numerical computations. (a) N = 10; (b) N = 50
Making the substitution PN (s) = W N (s) yields the ODE
µ(1 − s2 )W ′ (s) − µ(1 − s)W (s) + W (s) − sW ′ (s) = r̂N W (s),
or

W ′ (s)
A
B
=
+
,
W (s)
s+a s+b

where
p
1 + 4µ2 + 1
1 + 4µ2 − 1
, b=
, ab = 1, a > 0, 0 < b < 1,
a=
2µ
2µ
1 2r̂ N + 2µ − 1
1 2r̂ N + 2µ − 1
A= + p
, B= − p
, A + B = 1.
2
2
2 1 + 4µ2
2 1 + 4µ2
p

Integrating this ODE yields

W (s) = C(s + a)A (s − b)B ,

with the condition C(1 + a)A (1 − b)B = 1. We formally have that W (b) = 0, but this cannot
occur, since 0 < b < 1 and the polynomial PN (s) has all non-negative coefficients and is not
equal to zero anywhere on the interval [0, 1]. This implies that B = 0, and therefore A = 1, and
W (s) =

s+a
.
1+a

Moreover, the condition B = 0 implies that independently of N
p
1 − 2µ + 1 + 4µ2
.
r̂ N =
2
The final solution is
PN (s) =



s+a
1+a

11

N

,

and therefore the steady state distribution is binomial:
 
N
bj
p̂N,j =
j = 0, . . . , N,
j (1 + b)N
which holds for any µ > 0, there exists no error threshold for this fitness landscape.
Example 3.7. Consider a close relative of the additive fitness landscape in the form


2
K
1
= 0, . . . ,
r ∞ = 1, 1 − , 1 − , . . . , 1 −
K
K
K
where K ∈ N and does not depend on N .
We have

K−1
X

r ∞ ◦ P∞ (s) =

a=0

and (2.5) reads
−µ(1 − s)P∞ (s) +

K−1
X
a=0

1−

1−

a
p̂a sa ,
K

a
p̂a sa = r̂ ∞ P∞ (s).
K

Plugging s = 0 and assuming P∞ (0) 6= 0 implies
r̂∞ = 1 − µ.
Therefore,
P∞ (s) =

PK−1
a=0


a
p̂a sa
1− K
,
1 − µs

and we need to determine p̂a for a = 0, . . . , K − 1. Since we have
K−1
X
a=0

then for 1 ≤ a ≤ K − 1
or

1−


∞
X
a
p̂a sa = (1 − µs)
p̂a sa ,
K
a=0

1−

a
p̂a = p̂a − µp̂a−1 ,
K

µK
p̂a−1 .
a
The last recurrent formula implies that for 1 ≤ a ≤ K − 1
p̂a =

p̂a =

(µK)a
p̂0 .
a!

To determine p̂0 , we use P∞ (1) = 1, which yields, for µ < 1,
K−1
X
a=0

1−

a
p̂a = 1 − µ,
K
12

(3.3)

1

1

(b)

p̂(µ)

p̂(µ)

(a)

0
0

0
0

1

1

µ

µ

Figure 5: Comparison of numerical calculations for the fitness landscape in Example 3.7 with
the theoretical predictions. The black solid lines are the exact solutions for the case N → ∞ and
the grey dashed lines are numerical computations. (a) N = 100, K = 10; (b) N = 200, K = 10
or, using the expressions for p̂a :
1 = p̂0

K−2
X
a=0

(µK)K−1
(µK)a
+
a!
(1 − µ)(K − 1)!

!

,

which allows us to find p̂0 . Now we determined all p̂a for 0 ≤ a ≤ K − 1 and from (3.3) we have
that for j ≥ K
K−1
X
a
p̂a µj−a .
1−
p̂j =
K
a=0

To simplify the expressions for p̂j we note that due to the central limit theorem (CLT), for
K → ∞,
p̂0 ∼ e−µK .

Indeed, if ξ1 , . . . ξK are independent identically distributed Poisson random variables with the
mean Eξi = µ, then XK = ξ1 + . . . ξK has the Poisson distribution with the mean and the
variance EXK = Var XK = µK. Therefore, using the CLT,
K−2
X
a=0

(µK)K−1
P(XK = K − 1)
(µK)a −µK
e
+
e−µK = P(XK ≤ K − 2) +
a!
(1 − µ)(K − 1)!
1−µ


(1 − µ)K − 2
XK − µK
P(XK = K − 1)
√
√
≤
→ P(X < ∞) + 0 = 1
=P
+
1−µ
µK
µK

as K → ∞. Here X is the standard normally distributed random variable.
Therefore, for the case 1 ≪ K ≪ N the equilibrium distribution is approximately Poisson
with parameter µK (see Fig. 5).
In all the examples above the limit mean fitness r̂∞ can be determined from the maximum
principle (1.4). The next example shows that in the case when r(x) has a point of discontinuity
such that at this point function r(x) neither left nor right continuous then a formal application
of the maximum principle (1.4) may lead to incorrect conclusions.
13

Example 3.8. Let N = 2A be an even number, and
r N = (0, . . . , 0, 1, 0, . . . , 0),
where 1 is exactly at the A-th position. In [6], using a parametric solution to the eigenvalue
problem (this solution is outlined in Appendix A.1), it was proved that
p
r̂∞ = µ2 + 1 − µ,

which is defined for any µ > 0, there is no error threshold for this fitness ladscape. In Appendix
A.2 we re-derive this result using a new approach.
The maximum principle (1.4) for this example cannot be applied because r(x) is neither left
nor right continuous at the point x = 0.5. Formal application of the maximum principle leads
to √
incorrect conclusion (e.g., for µ = 1 it predicts that r̂ ≈ 1, which is wrong, the exact value
is 2 − 1). In [6] also the expressions for the limit distribution p̂∞ were given without a full
derivation. Here we show, using the method of generating functions, that the coordinates of the
selection–mutation equilibrium indeed can be found in an explicit form.
In the following it will be convenient to consider the generating functions in the form of the
Laurent series
∞
X
un sn .
U (s) =
n=−∞

In (2.4) we make the substitution PN (s) = P2A (s) = sA UA (s). Since the fitness landscape is
symmetric, then the coefficients of UA (s) are also symmetric:
UA (s) = uA,0 +

A
X

uA,n (sn + s−n ),

p̂A±n = uA,n ,

UA (1) = 1.

n=1

After dividing by 2A equation (2.4) becomes
µ
µ
(1 − s2 )UA′ (s) + (s−1 + s − 2)UA (s) + uA,0 = r̂2A UA (s).
2A
2
Similarly to H1—H3 we assume that, given that A → ∞, the first term in the last equality
vanishes, and UA (s) turns into
U∞ (s) = u0 +

∞
X

un (sn + s−n ),

U∞ (1) = 1 = u0 + 2

∞
X

n=1

n=1

Therefore, we have the limit equation
µ −1
(s + s − 2)U∞ (s) + u0 = r̂∞ U∞ (s),
2
or

U∞ (1) = 1,

!
∞


X
µ −1
n
−n
u0 = r̂ ∞ + µ − (s + s)
(s + s ) .
u0 +
2
n=1

Plugging in s = 1 we find

u0 = r̂ ∞ .
14

un .

Moreover, by equating the coefficients at s−n + sn , we obtain the system
µ
u0 = (r̂ ∞ + µ)u0 − µu1 , 0 = (r̂ ∞ + µ)un − (un−1 + un+1 ), n ≥ 1.
2
This system has the following solution, which can be directly checked,

n
p
1 − r̂∞
un = r̂ ∞
, r̂ ∞ = µ2 + 1 − µ, n = 0, 1, . . . .
1 + r̂∞

Therefore, the limit distribution p̂∞ is two-sided geometric, and for large N = 2A we have
approximately

n
1 − r̂∞
p̂A±n ≈ un = r̂ ∞
.
1 + r̂∞
Numerical computations confirm this conclusion (see Fig. 6).
1

1

(b)

r̂(µ)

p̂(µ)

(a)

0

0
0

4

4

µ

µ
1

1

(d)

r̂(µ)

p̂(µ)

(c)

0

0
0

4

4

µ

µ

Figure 6: Comparison of numerical calculations for the fitness landscape in Example 3.8 with
the theoretical predictions. The black solid lines are the exact solutions for the case N → ∞
and the grey dashed lines are numerical computations. (a) and (b) show the mean population
fitness and the quasispecies distribution respectively for N = 100 ; (c) and (d) show the same
for N = 200
Example 3.9 (General formulas). As a final example, consider now a general fitness landscape,
given by
r ∞ = (r0 , r1 , . . .), r0 > ri , i = 1, 2, . . . .
(3.4)
We can prove
15

Lemma 3.10. Suppose (dropping the subscript ∞ for notational convenience) that
P (s) =

∞
X

p̂n sn

n=0

gives a non-degenerate limit distribution
p̂∞ = (p̂0 , p̂1 , . . .)
such that p̂0 = P (0) > 0.
Then
r̂ ∞ = r0 − µ,

µn p̂0
,
j=1 (r0 − rj )

n > 0,

p̂n = Qn

p̂0 =

1
∞
X

µn
Qn
1+
j=1 (r0 − rj )
n=1

.

(3.5)

Expressions (3.5) generalize considered above Examples 3.1–3.3 and 3.5.
Proof. We rewrite (2.5) as follows:
µP (s) =

r̂∞ P (s) − r ∞ ◦ P (s)
r̂∞ (P (s) − 1) − (r ∞ ◦ P (s) − r̂∞ )
=
,
s−1
s−1

or, taking into account (2.6),
µ

∞
X

p̂n sn = r̂ ∞

n=0

or
µ

∞
X

p̂n sn = r̂ ∞

n=0

n=1

Substituting s = 0 yields
µp̂0 = r̂∞

∞
X

∞
X

n=1

p̂n −

∞
X

∞

p̂n

n=1

sn − 1
sn − 1 X
rn p̂n
−
,
s−1
s−1
n=1

p̂n (1 + s + . . . + sn−1 ) −

∞
X

n=1

∞
X

rn p̂n (1 + s + . . . + sn−1 ) .

(3.6)

n=1

rn p̂n = r̂ ∞ (1 − p̂0 ) − (r̂ ∞ − r0 p̂0 ) = (r0 − r̂∞ )p̂0 .

By assumption p̂0 > 0, and we get the first equality in (3.5).
Now consider the coefficient at s in (3.6). We have
µp̂1 = r̂∞ (1 − p̂0 − p̂1 ) − (r̂ ∞ − r0 p̂0 − r1 p̂1 ) = (r0 − r̂ ∞ )p̂0 − (r̂ ∞ − r1 )p̂1 ,
or, using the first inequality in (3.5),
p̂1 =

µp̂0
.
r0 − r1

Proceeding by induction on n and comparing the coefficients atPsn in (3.6), we prove the second
equality in (3.5). The last equality follows from the condition ∞

n=0 p̂n = 1.
16

Remark 3.11. The expressions for the limit distribution in Lemma 3.10 can be generalized to
the case
r ∞ = (r0 , r1 , . . .),

rk ≥ ri ,

i = 0, 1, . . . , k − 1,

rk > ri ,

i = k + 1, k + 2, . . .

If one assumes additionally (as the numerical evidence suggests, see also Remark 3.4) that
p̂0 = . . . = p̂k−1 = 0,

p̂k > 0,

then
r̂∞ = rk − µ,

µn p̂k
,
j=1 (rk − rk+j )

p̂k+n = Qn

n > 0,

p̂k =

1
∞
X

µn
Qn
1+
j=1 (rk − rk+j )
n=1

.

(3.7)

Corollary 3.12. Assume that the conditions of Lemma 3.10 hold. If, additionally, the limit
fitness landscape is such that rn = 0 for n > n0 then the generating function P (∞) is rational
and the limit distribution is asymptotically geometric.
Corollary 3.13. Assume that the conditions of Lemma 3.10 hold. Then formulas (3.7) provide
a solution for the non-degenerate limit distribution if and only if
v
uY
u n
∗
n
(rk − rk+j ) ≤ rk .
(3.8)
µ < µ = lim inf t
j=1

Proof. Indeed, from (3.7), the necessary and sufficient condition for the non-degenerate distribution to exist is the convergence of the series
∞
X

n=1

µn
,
j=1 (rk − rk+j )

Qn

which, by the Cauchy–Hadamard formula, converges if (3.8) holds and diverges if µ > µ∗ .



Remark 3.14. The critical value µ∗ of the mutation rate in (3.8) should be considered the
threshold value of the error threshold.
To illustrate how these general expressions work, consider the fitness landscape
r ∞ = (2, 0, 1, 0, 1, 0, 1, 0, . . .).
√
Equation (3.8) predicts that for µ < µ∗ = 2 we must have

(3.9)

r̂∞ = 2 − µ,
and, for several first coordinates of the equilibrium distribution
p̂0 =

2 − µ2
,
2+µ

p̂1 =

2 − µ2 µ
· ,
2+µ 2

p̂2 =

2 − µ2 µ2
·
,
2+µ 2

p̂3 =

2 − µ2 µ3
·
.
2+µ 4

Comparison of these exact theoretical predictions with numerical computations are given in
Fig. 7.
17

1

(b)

(a)
p̂(µ)

r̂(µ)

2

1

0

0
0

1

2

2

0

1

2

2

µ

µ

Figure 7: Comparison of numerical calculations for the fitness landscape (3.9) in Example 3.9
with the theoretical predictions. The black solid lines are the exact solutions for the case N → ∞
and the grey dashed lines are numerical computations for N = 200. (a) Mean population fitness.
(b) The quasispecies distribution

4

Concluding remarks

We presented an analytical approach to calculate the mutation–selection equilibrium in the
Crow–Kimura evolutionary model, which is based on the reformulation of the original eigenvalue
problem as a nonlinear functional–differential equation for the unknown probability generating
function and on taking a formal limit N → ∞ for the sequence length. This approach provides
closed analytical solutions for at least several special fitness landscapes, as we amply illustrated
in the previous section. We remark that, to the best of our knowledge, in the existing literature
only for two fitness landscapes these equilibrium distributions were written down explicitly,
and most attention was concentrated on finding analytical expressions for the mean population
fitness (the leading eigenvalue) and for some other population averages. With the advent of
sequencing technique, as everyone witnessed for the last two decades, it is now completely
feasible to sequence the whole population of quasispecies, and therefore our formulas can be
used to further relate theory and experiment in the evolutionary questions.
While the approach suggested in Section 2 clearly works for all the examples we considered,
the conditions are quite difficult to rigorously check and their proof constitutes an independent
and deep problem. Our experience tells us that it is quite unlikely to present general (necessary
and/or sufficient) conditions, which are easy to check, that would guarantee that our formal
limit yields the correct result for an arbitrary fitness landscape. As of now each special case has
to be tackled on its own, as we demonstrated for the single peaked landscape (Example 3.1) in
[6]. Probably a first realistic step in the search of the general conditions is to prove that the
formulas in Example 3.9 follow rigorously from the assumption on the unique fixed maximum
of the fitness landscape. We conclude our text with this open problem.

18

A

Parametric solutions to the basic eigenvalue problem

The suggested general approach of the generating functions is heuristic. Rigorous proofs can be
obtained using the parametric solution method introduced in [6]. In this appendix we give a
concise form for the method used in [6] (see Appendix A.1) and also introduce a new parametric
solution in Appendix A.2, which is used to prove the result from Example 3.8 on the limit form
of r̂∞ .
Recall that we are interested in finding the dominant eigenvalue and the corresponding
positive eigenvector of the problem
(M + µQ)p̂ = m̂ p̂,
where µ ≥ 0, M = diag(m0 , . . . , mN ), and the matrix Q has the form


−N
1
0
0
... ...
0
N
−N
2
0
... ...
0 


 0

N
−
1
−N
3
.
.
.
.
.
.
0



Q= 0
0
N − 2 −N . . . . . .
0 
.
 ...

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
0


 0
0
...
...
2 −N N 
0
0
...
...
0
1
−N

We introduce the notations

S=

1
Q,
N

R=

1
M,
N

r̂ =

1
m̂ .
N

Then the original eigenvalue problem takes the form
(R + µS)p̂ = r̂ p̂,
or, after introducing a new parameter u = µ/r̂,
1
Rp̂ + uS p̂ = p̂.
r̂

A.1

(A.1)

Approach A

In [6] it was shown that
C −1 QC = −2 diag(0, 1, 2, . . . , N ),
where C = (cka ) is the matrix composed (by columns) of the coefficients of the generating
polynomials
N
X
Pa (s) =
cka sk = (1 − s)a (1 + s)N −a ,
k=0

2

and possesses the property C =
we have

2N I,

where I is the identity matrix. Using this information,


1 2
−1
C SC = −2 diag 0, , , . . . , 1 .
N N
19

Equation (A.1) can be written as
r̂ p̂ = (I − uS)−1 Rp̂.
Using
1
1
1
= C −1 (I − uC −1 SC)−1 C = C −1 diag 1,
2u ,
4u , . . . ,
1+ N 1+ N
1 + 2uN
N

(I − uS)−1
we find

−1

(I − uS)


= F (u) = Fab (u) ,

Fab

!

C,

N
1 X cak ckb
.
= N
2
1 + 2ku
N
k=0

Therefore, r̂ is the dominant eigenvalue of the matrix F (u)R, and p̂ is the corresponding eigenvector, both of which can be represented in the parametric form, depending on parameter u. The
details how to write down the explicit formulas depending on the number of nonzero elements
of the vector m = (m0 , . . . , mN ) are given in [6].

A.2

Approach B

The equality
r̂ p̂ = (I − uS)−1 Rp̂
can be written as
Let

−1
r̂ p̂ = (1 + u)I − u(S + I) R p̂.

0
1/N
1
0

 0 1 − 1/N

B =S+I =
0
0
. . .
.
..

0
0
0
0


0
2/N
0
1 − 2/N
...
...
...

0
0
3/N
0
...
...
...

...
...
...
...
...
2/N
0

(A.2)
...
...
...
...
...
0
1/N

i.e., the matrix B is two diagonal, stochastic, and such that


4
2
−1
C BC = diag 1, 1 − , 1 − , . . . , −1 .
N
N


0
0

0

0
,
. . .

1
0

Direct observations yield that all natural powers of B also will be stochastic. For the even
(2k) 
(2k)
(2k−1) 
powers B 2k = bij
we have bij = 0 if i + j is odd, and for the odd powers B 2k−1 = bij
(2k−1)

we have bij

= 0 if i + j is even. Moreover, the properties of B and C imply

lim B

k→∞

2k

= C diag(1, 0, . . . , 0, 1)C

−1

lim B 2k−1 = C diag(1, 0, . . . , 0, −1)C −1

k→∞

20

 
N
(1 + (−1) )
,
i

 
1
N
= N (1 − (−1)i+j )
.
2
i

1
= N
2



i+j

Using the introduced notations equality (A.2) can be written as
−1

r̂ p̂ = (1 + u)



u
B
I−
1+u

−1

R p̂ =

∞
X
k=0

uk
B k R p̂,
(1 + u)k+1

(A.3)

where the application of the geometric series can be justified by noting that the 1-norm of the
u
B is less than 1 for any u > 0.
matrix 1+u
To illustrate how the parametric solution (A.3) works consider the case of the fitness landscape in Example 3.8. Let N = 2A be even,
r = (0, . . . , 0, 1, 0, . . . , 0),
where one is at the A-th position. In this case
r̂ = p̂A ,
and (A.3) takes the form

∞
X

r̂ p̂A =

k=0

Since

(k)
bA,A

uk
(k)
p̂A .
b
(1 + u)k+1 A,A

= 0 for odd k and r̂ = p̂A > 0 then
r̂ =

∞
X
k=0

u2k
(2k)
b .
(1 + u)2k+1 A,A

From the properties of B and C we have
(2k)
bA,A

=


Using the property that cij Nj = cji
coefficients of the polynomial

2A
1 X

22A
N
i

cAi ciA

i=0



i
1−
A

2k

.

(see [6] for an easy proof) and the fact that ciA are the

 
A
X
l A
(−1)
PA (s) =
s2l ,
l
l=0

we find

cAi ciA =
and therefore
(2k)
bA,A

(
0,

2l 2(A−l)
l
A−l ,

i = 2l + 1,
i = 2l,



A  
2l 2k
1 X 2l 2(A − l)
.
1−
= 2A
2
A
l
A−l
l=0

Using the approximation

 
1 2n
1
≈√ ,
2n
2
πn
n
21

we obtain
(2k)
bA,A

≈

2
22A



or, after taking the limit A → ∞,
(2k)
lim b
A→∞ A,A

1
=
π

Z

1
0

2k

A−1
2A
1 X 1 − 2l
A
p
+
,
π
A
l(A − l)
l=1

(1 − 2x)2k dx
2
p
=
π
x(1 − x)

Z

π/2

cos

2k

0

 
1 2k
z dz = 2k
.
2
k

Therefore, in the limit of the infinite sequence length
r̂ ∞ =

∞
X
k=0

 
u2k
1
1 2k
1
q
=
2k+1
2k
k
(1 + u)
2
1+u 1−

u2

(1+u)2

=√

1
,
2u + 1

where we used the fact that

 
∞
X
1 2k 2k
1
√
x ,
=
22k k
1 − x2
k=0
Finally, remembering that u =

from where

µ
r̂ ∞

|x| < 1.

gives
r̂∞ = q
r̂∞ =

p

1
2µ
r̂ ∞

,
+1

1 + µ2 − µ,

as it was stated in Example 3.8 and proved in [6] using, essentially, approach from Appendix A.1.
Acknowledgements:
#EPS-0814442.

ASN’s research is supported in part by ND EPSCoR and NSF grant

References
[1] E. Baake and W. Gabriel. Biological evolution through mutation, selection, and drift: An
introductory review. In D. Stauffer, editor, Annual Reviews of Computational Physics VII,
pages 203–264. World Scientific, 1999.
[2] E. Baake and H.-O. Georgii. Mutation, selection, and ancestry in branching models: a
variational approach. Journal of Mathematical Biology, 54(2):257–303, Feb 2007.
[3] E. Baake and H. Wagner. Mutation–selection models solved exactly with methods of statistical mechanics. Genetical research, 78(1):93–117, 2001.
[4] N. T. J. Bailey. The elements of stochastic processes with applications to the natural sciences,
volume 25. John Wiley & Sons, 1990.
22

[5] C. K. Biebricher and M. Eigen. The error threshold. Virus research, 107(2):117–127, 2005.
[6] A. S. Bratus, A. S. Novozhilov, and Y. S. Semenov. Linear algebra of the permutation
invariant Crow–Kimura model of prebiotic evolution. Mathematical Biosciences, 256:42–
57, 2014.
[7] R. Bürger. The mathematical theory of selection, mutation, and recombination. Wiley,
2000.
[8] J. F. Crow and M. Kimura. An introduction to population genetics theory. New York,
Evanston and London: Harper & Row, Publishers, 1970.
[9] M. Eigen. Selforganization of matter and the evolution of biological macromolecules. Naturwissenschaften, 58(10):465–523, 1971.
[10] M. Eigen, J. McCaskill, and P. Schuster. Molecular quasi-species. Journal of Physical
Chemistry, 92(24):6881–6891, 1988.
[11] M. Eigen and P. Schuster. The hypercycle. A principle of natural self-organization. Part A:
Emergence of the hypercycle. Naturwissenschaften, 64(11):541–565, Nov 1977.
[12] S. Galluccio. Exact solution of the quasispecies model in a sharply peaked fitness landscape.
Physical Review E, 56(4):4526, 1997.
[13] J. Hermisson, O. Redner, H. Wagner, and E. Baake. Mutation-selection balance: ancestry,
load, and maximum principle. Theoretical Population Biology, 62(1):9–46, Aug 2002.
[14] P. G. Higgs. Error thresholds and stationary mutant distributions in multi-locus diploid
genetics models. Genetical Research, 63(01):63–78, 1994.
[15] K. Jain and J. Krug. Adaptation in Simple and Complex Fitness Landscapes. In U. Bastolla, M. Porto, H. Eduardo Roman, and M. Vendruscolo, editors, Structural approaches to
sequence evolution, chapter 14, pages 299–339. Springer, 2007.
[16] D. S. Rumschitzki. Spectral properties of Eigen evolution matrices. Journal of Mathematical
Biology, 24(6):667–680, 1987.
[17] D. B. Saakian. A new method for the solution of models of biological evolution: Derivation
of exact steady-state distributions. Journal of Statistical Physics, 128(3):781–798, 2007.
[18] D. B. Saakian, C.-K. Hu, and H. Khachatryan. Solvable biological evolution models with
general fitness functions and multiple mutations in parallel mutation-selection scheme.
Physical Review E, 70(4):041908, 2004.
[19] Y. S. Semenov, A. S. Bratus, and A. S. Novozhilov. On the behavior of the leading eigenvalue
of the Eigen evolutionary matrices. Mathematical Biosciences, 258:134–147, 2014.
[20] J. Swetina and P. Schuster. Self-replication with errors: A model for polvnucleotide replication. Biophysical Chemistry, 16(4):329–345, 1982.

23

[21] C. J. Thompson and J. L. McBride. On Eigen’s theory of the self-organization of matter
and the evolution of biological macromolecules. Mathematical Biosciences, 21(1):127–142,
1974.
[22] G. P. Wagner and P. Krall. What is the difference between models of error thresholds and
Muller’s ratchet? Journal of Mathematical Biology, 32(1):33–44, 1993.
[23] T. Wiehe. Model dependency of error thresholds: the role of fitness functions and contrasts
between the finite and infinite sites models. Genetical research, 69(02):127–136, 1997.
[24] C. O. Wilke. Quasispecies theory in the context of population genetics. BMC Evolutionary
Biology, 5(1):44, 2005.

24

