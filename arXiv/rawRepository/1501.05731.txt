manuscript No.
(will be inserted by the editor)

Self-sustaining autocatalytic networks within open-ended
reaction systems

arXiv:1501.05731v1 [q-bio.MN] 23 Jan 2015

Mike Steel

Received: date / Accepted: date

Abstract Given any finite and closed chemical reaction system, it is possible to efficiently determine whether or not it contains a ‘self-sustaining and
collectively autocatalytic’ subset of reactions, and to find such subsets when
they exist. However, for systems that are potentially open-ended (for example,
when no prescribed upper bound is placed on the complexity or size/length
of molecules types), the theory developed for the finite case breaks down. We
investigate a number of subtleties that arise in such systems that are absent
in the finite setting, and present several new results.
Keywords chemical reaction system · autocatalytic network · ω-consistency
1 Introduction
Consider any system of chemical reactions, in which certain molecule types
catalyse reactions and where there is a pool of simple molecule types available
from the environment (a ‘food source’). One can then ask whether, within
this system, there is a subset of reactions that is both self-sustaining (each
molecule can be constructed starting just from the food source) and collectively
autocatalytic (every reaction is catalysed by some molecule produced by the
system or present in the food set) [8],[9]. This notion of ‘self-sustaining and
collectively autocatalytic’ needs to be carefully formalised (we do so below),
and is relevant to some basic questions such as how biochemical metabolism
began at the origin of life [2], [11], [14]. A simple mathematical framework
for formalising and studying such self-sustaining autocatalytic networks has
been developed – so-called ‘RAF (Reflexively-autocatalytic and F-generated)
M. Steel
Biomathematics Research Centre, University of Canterbury, Christchurch, New Zealand
Tel.: +64-3-364-2987 ext 7688
Fax: +64-3-364-2587
E-mail: mike.steel@canterbury.ac.nz

2

Mike Steel

theory’. This theory includes an algorithm to determine whether such networks
exists within a larger system, and for classifying these networks; moreover, the
theory allows us to calculate the probability of the formation of such systems
within networks based on the ligation and cleavage of polymers, and a random
pattern of catalysis.
However, this theory relies heavily on the system being closed and finite.
In certain settings, it is useful to consider polymers of arbitrary length being
formed (e.g. in generating the membrane for a protocell [4]). In these and other
unbounded chemical systems, interesting complications arise for RAF theory,
particularly where the catalysis of certain reactions is possible only by molecule
types that are of greater complexity/length than the reactants or product of
the reactions in question. In this paper, we extend earlier RAF theory to deal
with unbounded chemical reaction systems. As in some of our earlier work,
our analysis ignores the dynamical aspects, which are dealt with in other
frameworks, such as ‘chemical organisation theory’ [1]; here we concentrate
instead on just the pattern of catalysis and the availability of reactants.
1.1 Preliminaries and definitions
In this paper, a chemical reaction system (CRS) consists of (i) a set X of
molecule types, (ii) a set R of reactions, (iii) a pattern of catalysis C that
describes which molecule(s) catalyses which reactions, and (iv) a distinguished
subset F of X called the food set.
We will denote a CRS as a quadruple Q = (X, R, C, F ), and encode the
pattern of catalysis C by specifying a subset of X × R so that (x, r) ∈ C
precisely if molecule type x catalyses reaction r. See Fig. 1 for a simple example
(from [11]).
In certain applications, X often consist of – or at least contain – a set of
polymers (sequences) over some finite alphabet A (i.e. chains x1 x2 · · · xr , r ≥ 1,
where xi ∈ A), as in Fig. 1; such polymer systems are particularly relevant
to RNA or amino-acid sequence models of early life. Reactions involving such
polymers typically involve cleavage and ligation (i.e. cutting and/or joining
polymers), or adding or deleting a letter to an existing chain. Notice that if
no bound is put on the maximal length of the polymers, then both X and R
are infinite for such networks, even when |A| = 1.
In this paper we do not necessarily assume that X consists of polymers, or
that the reactions are of any particular type. Thus, a reaction can be viewed
formally as an ordered pair (A, B) consisting of a multi-set A of elements from
X (the reactants of r) and a multi-set B of elements of X (the products of
r); but we will mostly use the equivalent and more conventional notation of
writing a reaction in the form:
r = (a1 + a2 + · · · + ak → b1 + b2 + · · · + bl ),
where the ai ’s (reactants of r) and bj ’s (products of r) are elements of X, and
k, l ≥ 1 (e.g. x → y, x + x → y and y → x + x0 are reactions).

Self-sustaining autocatalytic networks within open-ended reaction systems

01100

001

1000011

01

0

0011

100

r1

101
r3

r2

1

0011101

r4

r5

r6

r7

3

00

11

Fig. 1 A simple CRS based on polymers over a two-letter alphabet (0,1), with a food set
F = {0, 1, 00, 11} and seven reactions. Dashed arrows indicate catalysis; solid arrows show
reactants entering a reaction and products leaving. In this CRS there are exactly four RAFs
(defined below), namely {r1 , r2 }, {r3 }, {r1 , r2 , r3 }, and {r1 , r2 , r3 , r5 }.

In this paper, we extend our earlier analysis of RAFs to the general (finite
or infinite) case and find that certain subtleties arise that are absent in the
finite case. We will mostly assume the following conditions (A1) and (A2), and
sometimes also (A3).
(A1) F is finite;
(A2) each reaction r ∈ R has a finite set of reactants, denoted ρ(r), and a finite
set of products, denoted π(r);
(A3) for any given finite set Y of molecule types, there are only finitely many
reactions r with ρ(r) = Y .
Given a subset R0 of R, we say that a subset W ⊆ X of molecule types is closed
relative to R0 if W satisfies the property r ∈ R0 and ρ(r) ⊆ W ⇒ π(r) ⊆ W.
In other words, a set of molecule types is closed relative to R0 if every molecule
that can be produced from W using reactions in R0 is already present in W .
Notice that the full set X is itself closed. The global closure of F relative to
R0 , denoted here as gclR0 (F ), is the intersection of all closed sets that contain
F (since X is closed, this intersection is well defined). Thus gclR0 (F ) is the
unique minimal set of molecule types containing F that is closed relative to
R0 .
We can also consider a constructive closure of F relative to R0 , denoted
here as cclR0 (F ), which is union of the set F and the set of molecule types x
that can be obtained from F by carrying out any finite sequence of reactions
from R0 where, for each reaction r in the sequence, each reactant of r is either
an elements of F or a product of a reaction occurring earlier in the sequence,
and x is a product of the last reaction in the sequence.

4

Mike Steel

Note that gclR0 (F ) always contains cclR0 (F ) (and these two sets coincide
when the CRS is finite) but, for an infinite CRS, cclR0 (F ) can be a strict
subset of gclR0 (F ), even when (A1) holds. To see this, consider the system
(X, R) where X = {x0 , x1 , x2 , . . .}, F = {f }, where R0 = {r0 , r1 , r2 , r3 , . . .} is
defined as follows:
r1 = (f → x1 );
rj = (f + xj → xj+1 ), for all j ≥ 1;
r0 = (x1 + x2 + · · · → x0 ).
Then x0 ∈ gclR0 (F ) − cclR0 (F ). In this example, notice that r0 has infinitely
many reactants, which violates (A2). By contrast, when (A2) holds, we have
the following result.
Lemma 1 Suppose that (A2) holds. Then cclR0 (F ) = gclR0 (F ). Moreover,
under (A1) and (A2), if R0 is countable, then this (common) closure of F
relative to R0 is countable also.
Proof Suppose the condition of Lemma 1 holds but that cclR0 (F ) is not closed;
we will derive a contradiction. Lack of closure means there is a molecule x
in X − cclR0 (F ) which is the product of some reaction r ∈ R0 that has all
its reactants in cclR0 (F ). By (A2), the set of reactants of r is finite, so we
may list them as x1 , x2 , . . . , xk , and, by the definition of cclR0 (F ), for each
i ∈ {1, . . . , k}, either xi ∈ F or there is a finite sequence Si of reactions
from R0 that generates xi starting from reactants entirely in F and using just
elements of F or products of reactions appearing earlier in the sequence Si . By
concatenating these sequences (in any order) and appending r at the end, we
obtain a finite sequence of reactions that generate x from F , which contradicts
the assumption that cclR0 (F ) is not closed. If follows that cclR0 (F ) is closed
relative to R0 , and since it is clearly a minimal set containing F that is closed
relative to R0 , it follows that cclR0 (F ) = gclR0 (F ). That cclR0 (F ) is countable
under (A1) and (A2) follows from the fact that any countable union of finite
sets is countable.
2
In view of Lemma 1, whenever (A2) holds, we will henceforth denote the
(common) closure of F relative to R0 as clR0 (F ).
Definition [RAF, and related concepts] Suppose we have a CRS Q =
(X, R, C, F ), which satisfies condition (A2). An RAF for Q is a non-empty
subset R0 of R for which

(i) for each r ∈ R0 , ρ(r) ⊆ clR0 (F ); and
(ii) for each r ∈ R0 , at least one molecule type in clR0 (F ) catalyses r.

In words, a non-empty set R0 of reactions forms an RAF for Q if, for every
reaction r in R0 , each reactant of r and at least one catalyst of r is either
present in F or able to be constructed from F by using just reactions from
within the set R0 .

Self-sustaining autocatalytic networks within open-ended reaction systems

5

An RAF R0 for Q is said to be a finite RAF or an infinite RAF depending on
whether or not |R0 | is finite or infinite. The concept of an RAF is a formalisation of a ‘collectively autocatalytic set’, pioneered by Stuart Kauffman [8] and
[9]. Since the union of any collection of RAFs is also an RAF, any CRS that
contains an RAF necessarily contains a unique maximal RAF. An irrRAF is
an (infinite or finite) RAF that is minimal – i.e. it contains no RAF as a strict
subset. In contrast to the uniqueness of the maximal RAF, a finite CRS can
have exponentially many irrRAFs [7].
The RAF concept needs to be distinguished from the stronger notion of
a constructively autocatalytic and F-generated (CAF) set [10] which requires
that R0 can be ordered r1 , r2 , . . . , rN so that all the reactants and at least
one catalyst of ri are present in cl{r1 ,...,ri−1 } (F ) for all i ∈ {1, . . . , N } (in the
initial case where i = 1, we take cl∅ (F ) = F ). This condition essentially means
that in a CAF, a reaction can only proceed if one of its catalysts is already
available, whereas an RAF could become established by allowing one or more
reactions r to proceed uncatalysed (presumably at a much slower rate) so that
later, in some chain of reactions, a catalyst for r is generated, allowing the
whole system to ‘speed up’. Notice that although the CRS in Fig. 1 has four
RAFs it has no CAF.

f4

f1
p4

f5
p1

p3

RAF

f2

f3

f1

p2

p4

f4

f1
p4

f5

p3

p1

p3

f2

f3
p2

CAF

p1

f2

f3
p2

pseudo-RAF

Fig. 2 Examples of a finite RAF (that is not a CAF), a finite CAF and a finite pseudo-RAF
(that is not an RAF). In these examples, the molecule types are round nodes (the food set
is denoted f1 , f2 , . . ., and p1 , p2 , . . . are products), reactions are hollow squares, and dashed
arrows indicate catalysis.

6

Mike Steel

The RAF concept also needs to be distinguished from the weaker notion of
a pseudo-RAF [12], which replaces condition (ii) with the relaxed condition:
(ii)0 : for all r ∈ R0 , there exists x ∈ F or x ∈ π(r) for some r ∈ R0 such
that (x, r) ∈ C.
In other words, a pseudo-RAF that fails to be an RAF is an autocatalytic
system that could continue to persist once it exists, but it can never form
from just the food set F , since it is not F -generated.
These two alternatives notions to RAFs are illustrated (in the finite setting)
in Fig. 2. Notice that every CAF is an RAF and every RAF is a pseudo-RAF,
but these containments are strict, as Fig. 2 shows.
While the notion of a CAF may seem reasonable, it is arguably too conservative in comparison to an RAF, since a reaction can still proceed if no
catalyst is present, albeit it at a much slower rate, allowing the required catalyst to eventually be produced. However relaxing the RAF definition further
to a pseudo-RAF is problematic (since a reaction cannot proceed at all, unless
all its reactants are present, and so such a system cannot arise spontaneously
just from F ). This, along with other desirable properties of RAFs (their formation requires only low levels of catalysis in contrast to CAFs [10]), suggests
that RAFs are a reasonable candidate for capturing the minimal necessary
condition for self-sustaining autocatalysis, particularly in models of the origin
of metabolism.

1.2 Properties of RAFs in an infinite CRS
As in the finite CRS setting, the union of all RAFs is an RAF, so any CRS
that contains an RAF has a unique maximal one. It is easily seen that an
infinite CRS that contains an RAF need not have a maximal finite RAF, even
under (A1)–(A3), but in this case, the CRS would necessarily also contain an
infinite RAF (the union of all the finite RAFs).
A natural question is the following: if an infinite CRS contains an infinite
RAF, does it also contain a finite one? It is easily seen that even under conditions (A1) and (A2), the answer to this last question is ‘no’. We provide three
examples to illustrate different ways in which this can occur. This is in contrast
to CAFs, for which exactly the opposite holds: if a CRS contains an infinite
CAF, then it necessarily contains a sequence of finite ones. Moreover, two of
the infinite RAFs in the following example contain no irrRAFs (in contrast to
the finite case, where every RAF contains at least one irrRAF).
Example 1: Let X = {f, x1 , . . . , xn , . . .}, F = {f } and R = {r1 , r2 , . . . , rn , . . .}.
Let r1 = (f → x1 ). We will specify particular CRS’s by describing r2 , r3 , . . .,
and the pattern of catalysis as follows.
– Q1 has a reaction ri = (f + xi−1 → xi ) for each i > 1 and ri is catalysed
by xi+1 for each i ≥ 1.

Self-sustaining autocatalytic networks within open-ended reaction systems

7

– Q2 has a reaction ri = (f + f + · · · + f [i times] → xi ) for each i > 1 and
ri is catalysed by xi+1 for each i ≥ 1.
– Q3 has the same reactions as Q2 but ri is now catalysed by every xj : j > i.
Fig. 3 illustrates the three CRS’s.
f

x1

f

x2
Q1

x3

x1

f

x2

x3

x1

Q2

x2
Q3

Fig. 3 Three simple examples of infinite CRSs that have infinite RAFs but no finite RAF.

Each of Q1 , Q2 , Q3 satisfy (A1) and (A2), but only Q1 satisfies (A3). All
three CRSs contain infinite RAFs, but no finite RAF, and no CAF. More
precisely:
– Q1 has R as its unique RAF (which is therefore an irrRAF).
– The RAFs of Q2 consist precisely of all subsets of {rj , rj+1 , . . . , } for some
j. Thus Q2 has a countably infinite number of RAFs but no irrRAF.
– The RAFs of Q3 consist precisely of all infinite subsets of R. Thus, the set
of RAFs for Q3 in uncountably infinite, and it contains no irrRAF.
2 Determining whether or not a CRS contains an RAF
In this section, we assume that both (A1) and (A2) hold. Given a CRS Q =
(X, R, C, F ), consider the following nested decreasing sequence of reactions:
R1 , R2 , . . . , defined by R1 = R and for each i > 1:
Ri+1 = {r ∈ Ri : ρ(r) ⊆ clRi (F ), and ∃x ∈ clRi (F ) : (x, r) ∈ C}.

(1)

Thus, Ri+1 is obtained from Ri by removing any reaction that fails to have
either all its reactants
or at least one catalyst in the closure of F relative to
T
Ri . Let µ(Q) = i≥1 Ri . It is easily shown that any RAF R0 present in Q is
necessarily a subset of µ(Q) (since R0 ⊆ Ri for all i ≥ 1 by induction on i).
Thus if µ(Q) = ∅ then Q does not have an RAF. In the finite case there is
a strong converse – if µ(Q) 6= ∅ then Q has an RAF, and µ(Q) is the unique
maximal RAF for Q (this is the basis for the ‘RAF algorithm’ [5] and [6]).
However, in contrast, this result can fail for an infinite CRS, as we now show
with a simple example, which also satisfies (A1)–(A3).

x3

8

Mike Steel

Example 2: Consider the following infinite CRS, Q4 = (X, R, C, F ), where
F = {f }, and X = {f, s, t, } ∪ {x1 , x2 , x3 , . . .} ∪ F, where
F = {f, f f, f f f, · · · , f (i) , · · ·}
(this set can be thought of as all polymers of f ). The reaction set is R =
{r1 , r2 , r3 , . . .} ∪ {r20 , r30 , . . .}, where, for all i ≥ 1 :
ri = (f + f (i) → f (i+1) );
ri0 = (f (i) → xi + s).
The pattern of catalysis is defined as follows: s catalyses r1 and t catalyses
0
r20 , and for all i > 1 f (i) catalyses ri and xi catalyses ri+1
. This CRS is
illustrated in Fig 4. Notice that Q4 satisfies (A1), (A2) and (A3). However, if
f

f

r1

ff

r2

r20

fff

r30

r3

ffff

r40

t
x2

x3

x4

s

Fig. 4 An infinite CRS Q4 which has no RAF even though µ(Q4 ) is non-empty (equal to
{r1 , r2 , . . .}). This CRS satisfies (A1)–(A3) and (A5), but not (A4).

we construct the sequence Ri described above, then as the sole catalyst (t) of
r20 is neither in the food set, nor generated by any other reaction, it follows
that r20 will be absent from R2 , and so r30 will also be absent from R3 (since
the only catalyst of r30 is produced by r20 ). Continuing in this way, we obtain
µ(Q4 ) = {r1 , r2 , r3 , . . .}, but this set is not an RAF, since the sole catalyst
s of r1 does not lie lie in the closure of F relative to {r1 , r2 , r3 , . . .} – it was
produced by the rj0 reactions and in these have all disappeared in the limit;
moreover it is clear that no subset of Q4 is an RAF.
2
Thus, we require slightly stronger hypotheses than just (A1)–(A3) in order
to ensure that Q has an RAF when µ(Q) 6= ∅. This, is provided by the following
result.

Self-sustaining autocatalytic networks within open-ended reaction systems

9

Proposition 1 Let Q = (X, R, C, F ) satisfy (A1) and (A2). The following
then hold:
(i) µ(Q) contains every RAF for Q; in particular, if µ(Q) = ∅, then Q has no
RAF.
(ii) Suppose
T that Q satisfies both of the following further conditions:
(A4) i≥1 clRi (F ) ⊆ clµ(Q) (F ), for the sequence Ri defined in (1).
(A5) Each reaction r ∈ R is catalysed by only finitely many molecule types.
Then Q contains an RAF if and only if µ(Q) is non-empty (in which case,
µ(Q) is the maximal RAF for Q).
Before proving this result, we pause to make some comments and observations concerning the new conditions (A4) and (A5). Regarding Condition
(A4), containment in the opposite direction is automatic (by virtue of the fact
that f (∩Yi ) ⊆ ∩i f (Yi ) for any function f and sets Yi ), so (A4) amounts to
saying that the two sets described are equal.
Notice also that Q4 in Example 2 (Fig. 4) satisfies (A5) but it violates
(A4), as it must, since Q4 does not have
T an RAF. To see how Q4 violates
(A4), notice that clµ(Q4 ) (F ) = F, while i≥1 clRi (F ) = F ∪ {s}.
Condition (A5) is quite strong, but Proposition 1 is no longer true if it is
removed. To see why, consider the following modification Q04 of Q4 in which
the only product of ri0 (for i > 1) is xi , and xi catalyses rT
1 for all i > 1 (in
0
addition to ri+1
), as shown in Fig. 5. Then clµ(Q04 ) (F ) = i≥1 clRi (F ) = F
so (A4) holds; however µ(Q04 ) = {r1 , r2 , . . .} which, as before, is not an RAF
for Q04 since there is no catalyst of r1 in cl{r1 ,r2 ,...} (F ). Notice that (A5) fails
for Q04 since r1 has infinitely many catalysts. Nevertheless, it is possible to
obtain a result that dispenses with (A5) at the expense of a strengthening
(A4), which we will do shortly in Proposition 2.

f

f

r1

ff

r20

r2

fff

r30

r3

ffff

r40

t
x2

x3

x4

Fig. 5 An infinite CRS Q04 which has no RAF even though µ(Q04 ) is non-empty (equal to
{r1 , r2 , . . .}). This CRS satisfies (A1)–(A3) and (A4), but not (A5), nor (A4)0 .

10

Mike Steel

Proof of Proposition 1: Suppose R0 is any RAF for Q. Induction on i ≥ 1
shows that R0 ⊆ Ri for all i, so that R0 ⊆ µ(Q); in particular, if µ(Q) = ∅,
then Q has no RAF. The proof of part (ii) of Proposition 1 relies on a simple
lemma.
Lemma 2 Suppose that (Ai , i ≥ 1) is any nested decreasing sequence of subsets and B is a finite set for which Ai ∩B 6= ∅ for all i ≥ 1. Then some element
of B is present in every set Ai .
Proof of lemma: Suppose, to the contrary, that for every element b ∈ B, there
is some set Ai(b) in the sequence that fails to contain b (we will show this is
not possible by deriving a contradiction). Let I = max{i(b) : b ∈ B}. Since
B is a finite set, I is a finite integer, and since the sequence (Ai , i ≥ 1) is a
nested decreasing sequence, it follows that AI ∩ B = ∅, a contradiction.
2
Returning to the proof of Part (ii), suppose that µ(Q) 6= ∅; we will show that
µ(Q) is an RAF for Q (and so, by Part (i), the unique maximal RAF for Q).
For r ∈ µ(Q), ρ(r) ⊆ clRi (F ) for each i (otherwise r would
not be an element of
T
Ri+1 and thereby fail to lie in µ(Q)). Thus ρ(r) ⊆ i≥1 clRi (F ) ⊆ clµ(Q) (F )
by (A4). It remains to show that r is catalysed by at least one element of
clµ(Q) (F ). Let Br = {x ∈ X : (x, r) ∈ C}. By (A5), Br is finite. Moreover,
for each i ≥ 1, Br ∩ clRi (F ) 6= ∅ (otherwise r would fail to be in Ri+1 and
therebyTnot lie in µ(Q)). By Lemma 2, there is a molecule type x ∈ Br that
lies in i≥1 clRi (F ) and this latter set is contained in clµ(Q) (F ) by (A4). In
summary, every reaction in µ(Q) has all its reactants and at least one catalyst
present in clµ(Q) (F ) and so µ(Q) is an RAF for Q, as claimed.
2
Suppose we now remove Condition (A5) in Proposition 1. In this case, by
a slight strengthening of (A4), we obtain a positive result (Proposition 2). To
describe this, we first require a further definition. Recall that C is the set of
pairs (x, r) where molecule type x catalyses reaction r. Given a subset C 0 of
C, let
R[C 0 ] = {r ∈ R : (x, r) ∈ C 0 for some x ∈ X}.
Define a nested decreasing sequence of subsets C1 , C2 , . . . , by C1 = C and for
each i ≥ 1,
Ci+1 = {(x, r) ∈ Ci : {x} ∪ ρ(r) ⊆ clR[Ci ] (F )},
(2)
T
and let C∞ = i≥1 Ci .
Proposition 2 Let Q satisfy (A1) and (A2), as well as the following property:
(A4)0

\
i≥1

clR[Ci ] (F ) ⊆ clR[C∞ ] (F ), for the sequence Ci defined in (2).

Then Q has an RAF if and only if C∞ 6= ∅, in which case R[C∞ ] is a maximal
RAF for Q.

Self-sustaining autocatalytic networks within open-ended reaction systems

11

Proof Suppose that C∞ 6= ∅. Then for any r ∈ R[C∞ ] there exists x ∈ X such
that (x, r) ∈ C∞ . It follows that (x, r) ∈ Ci for all i. By definition,
this means
T
that {x} ∪ ρ(r) ⊆ clR[Ci ] (F ) for all i, and so {x} ∪ ρ(r) ⊆ i≥1 clR[Ci ] (F ).
Now, by (A4)0 , this means that {x} ∪ ρ(r) ⊆ clR[C∞ ] (F ). In summary, every
reaction in the non-empty set R[C∞ ] has all its reactants and at least one
catalyst in the closure of F with respect to R[C∞ ] and so R[C∞ ] forms an
RAF for Q.
Conversely, suppose that Q contains an RAF R0 ; we will show that C∞ 6=
∅. For each r ∈ R0 , select a catalyst xr for r for which xr ∈ clR0 (F ). Let
A = {(xr , r) : r ∈ R0 }. We use induction on i to show that A ⊆ Ci for all
i ≥ 1. Clearly A ⊆ C = C1 , so suppose that A ⊆ Ci and select an element
(xr , r) ∈ A. By definition,
{x} ∪ ρ(r) ⊆ clR0 (F ) = clR[A] (F ) ⊆ clR[Ci ] (F ),
which means T
that (xr , r) ∈ Ci+1 , establishing the induction step. It follows
that ∅ =
6 A ⊆ i≥1 Ci = C∞ and so C∞ 6= ∅ as claimed.
2
Notice that, just as for condition (A4), the condition (A4)0 is equivalent to
requiring that the two sets described be identical. Notice also that, although
condition (A4) applies to the CRS Q04 , condition (A4)0 fails, since C∞ =
{(s, r1 ), (f f, r2 ), (f f f, r3 ), . . .} and so clR[C∞T
] (F ) = F = {f, f f, f f f, . . .},
while s ∈ clR[Ci ] (F ) for all i ≥ 1, and so i≥1 clR[Ci ] is not a subset of
clR[C∞ ] (F ).
In summary, a single application of µ allows us to determine when Q has
an RAF, provided the additional condition (A4)0 holds. Example 2 showed
that some additional assumption of this type is required, however one could
also consider other approaches for determining the existence RAFs that do
not assume a further condition like (A4)0 , but instead iterate the map µ. In
other words, consider the following ‘higher level’ sequence of subsets of R:
R, µ(Q), µ2 (R), · · · µk (R) · · ·
where µk (R) = µ(µk−1 (R)), for each k ≥ 2. Again, this forms a decreasing
nested sequence of subsets of R and so we can consider the set:
\
ν(Q) =
µi (R).
i≥1

In the example above for Q4 where µ(Q) 6= ∅, notice that µ2 (R) = ∅ (and
so ν(Q) = ∅). It follows from Proposition 1 that if µk (Q) = ∅ for any k ≥ 1
then Q has no RAF. However, just because ν(Q) 6= ∅, this does not imply that
Q contains an RAF as the next example shows.
Example 3: Consider the infinite CRS Q5 = (X, R, C, F ) which is obtained
by taking a countably infinite number of (reaction and molecule disjoint) copies
of Q4 (from Example 2) and letting the molecule type s in the i-th copy of Q4

12

Mike Steel

play the role of the molecule t in the (i + 1)−th copy of Q4 . In addition, let r0
be the reaction f + f + f → ω (where ω is an additional molecule) catalysed
by the s-products of all the copies of Q4 . Now µk (Q) contains all but the first
k copies of Q4 , plus r0 . Consequently, ν(Q) = {r0 } but, as before, this is not
an RAF. Notice, however that this example violates condition (A3).
2

3 Finite RAFs in systems satisfying (A1)–(A3)
We have seen from the last section that applying µ, even infinitely often,
does not seem to provide a way to determine whether a CRS possesses an
RAF. However, in most applications, the main interest will generally be in
finite RAFs. From the earlier theory it is clear that if µk (Q) is finite for some
integer k ≥ 1 then any RAFs that may exist for Q are necessarily finite, and
finite in number. Moreover, if
∅=
6 µk (Q) = µ(k+1) (Q), for some k ≥ 1,
and this set is finite, then µk (Q) is the unique (and necessarily finite) maximal
RAF for Q. However, it is also quite possible that a CRS might contain both
finite and infinite RAFs, and in this section we describe a characterisation of
when an RAF contains a finite RAF.
Given a CRS Q define a sequence R01 , R02 , · · · of subsets of R as follows:
R01 = {r ∈ R : ρ(r) ⊆ F }, and
[
R0i = {r ∈ R : ρ(r) ⊆ F ∪
π(R0j )}, for each i > 1.
1≤j<i

In words, R1 is the set of reactions that have all their reactants in F , and for
i > 1 Ri is the set of reactions for which each reactant is either an element of
F or products of some reaction in Rj for j < i.
Proposition 3 Suppose a CRS Q satisfies (A1)–(A3). Let Q0i = (X, R0i , C, F )
for all i ≥ 1, where R0i is as defined above. Then:
(i)
(ii)
(iii)
(iv)

(R0i : i ≥ 1) is a nested increasing sequence of finite sets.
Q has a finite RAF if and only if µ(Q0i ) 6= ∅ for some i ≥ 1.
If µ(Q0i ) 6= ∅ for some i, then µ(Q0j ) is a finite RAF for Q for all j ≥ i.
Every finite RAF for Q is contained in µ(Qj ) for some j ≥ 1.

Proof By (A1) and (A3), it follows that R01 is finite, and, by induction,
that
S
R0i is finite for all iS> 1. Moreover, if r ∈ R0i then ρ(r) ⊆ F ∪ 1≤j<i π(R0j )
and so ρ(r) ⊆ F ∪ 1≤j<i+1 π(R0j ) (i.e. r ∈ R0i+1 ) and so the sets R0i , i ≥ 1
form an increasing nested sequence. This establishes (i). For Parts (ii) and
(iii), suppose that Q contains a finite RAF R0 . Since (A1) and (A2) hold, we
can apply Lemma 1 to deduce that every reaction r ∈ R0 is an element of R0i
for some i. Thus, since R0 is finite, and the sequence R0i is a nested increasing

Self-sustaining autocatalytic networks within open-ended reaction systems

13

sequence of finite sets, it follows that R0 ⊆ R0k for some fixed k, in which case
µ(Q0k ) 6= ∅. Conversely, if µ(Q0i ) 6= ∅, then it is clear from the definitions that
µ(Q0i ) is an finite RAF for Q; moreover, so also is µ(Q0j ) for all j > i. Part
(iv) also follows easily from the definitions, since if R0 is a finite RAF for Q
then R0 ⊆ R0j for some j ≥ 1, and since R0 is finite we have µ(R0 ) = R0 and
so R0 = µ(R0 ) ⊆ µ(Qj ). This completes the proof.
2
Theorem 3 provides an algorithm to search for finite RAFs in any infinite CRS
that satisfies (A1)–(A3). Given Q, construct R01 and run the (standard) RAF
algorithm [5] and [6] on R01 . If it fails to find an RAF, then construct R02 and
run the algorithm on this set, and continue in the same manner. If Q contains
a finite RAF, then this process is guaranteed to find it, however, there is no
assurance in advance of how long this might take (if not constraint is placed
on the size of the how large the smallest finite RAF might be).

4 General setting
Finally, we show how Proposition 2 can be reformulated more abstractly in
order to makes clear the underlying mathematical principles; the added generality may also be useful for settings beyond chemical reaction systems. This
uses the notion of “gf -compatibility” from [3], which we now explain.
Suppose we have an arbitrary set Y and an arbitrary partially ordered set
W , together with some functions f : 2Y → W and g : Y → W. Consider the
function ψ : 2Y → 2Y , where
ψ(A) := {y ∈ A : g(y) ≤ f (A)}.
We are interested in the non-empty subsets of Y fixed points of ψ, particularly,
when f is monotonic (i.e., where A ⊆ B ⇒ f (A) ≤ f (B)). A subset A of Y is
said to be gf -compatible if A is non-empty and ψ(A) = A.
The notion of an RAF can be captured in this general setting as follows.
Given a CRS Q = (X, R, F, C) satisfying (A2), take Y = C and W = 2X
(partially ordered by set inclusion), and define f : 2Y → W and g : Y → W
as follows:
f (A) = clR[A] (F ) and g((x, r)) = {x} ∪ ρ(r),

(3)

where, as earlier, R[A] is the set of reactions r ∈ R for which there is some
x0 ∈ X with (x0 , r) ∈ C. Notice that f is monotonic and when Q is finite, the
set f (A) can be computed in polynomial time in the size of Q.
Lemma 3 Suppose we have a CRS Q satisfying (A2), and with f and g defined as in (3). If A is gf -compatible, then R[A] is an RAF for Q. Conversely,
if R0 is an RAF for Q, then a gf -compatible set A exists with R[A] = R0 . In
particular, Q has an RAF if and only if Y contains a gf -compatible set.

14

Mike Steel

Proof If A is gf -compatible subset of Y , then for R0 = R[A], each reaction r ∈
R has at least one molecule type x ∈ X for which (x, r) ∈ A. gf -compatibility
ensures that g((x, r)) ⊆ f (A), in other words, {x} ∪ ρ(r) ⊆ clR0 (F ) for some
catalyst x of r. This holds for every r ∈ R0 , so R0 is an RAF for Q. Conversely,
if R0 is an RAF, then for each reaction r ∈ R0 , we can choose an associated
catalyst xr so that {xr } ∪ ρ(r) ⊆ clR0 (F ). Then A = {(xr , r) : r ∈ R0 } is a
gf -compatible subset of Y , with R[A] = R0 .
2
The problem of finding a gf -compatible set (if one exists) in a general
setting (arbitrary Y , and W , not necessarily related to chemical reaction networks) can be solved in general polynomial time when Y is finite and f is
monotonic and computable in finite time. This provides a natural generalization of the classical RAF algorithm. In [5], we showed how other problems
(including a toy problem in economics) could by formulated within this more
general framework.
However, if we allow the set Y to be infinite, then monotonicity of f needs
to be supplemented with a further condition on f . We will consider a condition
(‘ω-continuity’), which generalizes (A4)0 , and that applies automatically when
Y is finite. We say that f : 2Y → W is (weakly) ω-continuous if, for any nested
descending chain Ai , i ≥ 1 of sets, we have:
\
f ( Ai ) is a greatest lower bound for {f (Ai ), i ≥ 1}.
(4)
i≥1

Recall that an element in a partially ordered set need not have a greatest lower
bound (glb); but if it does, it has a unique T
one. Notice that when Y is finite,
this property holds trivially, since then f ( i≥1 Ai ) = f (An ) for the last set
An in the (finite) nested chain.
For a subset A of Y and k ≥ 1, define ψ (k) (A) to be the result of applying
function ψ iteratively k times starting with A. Thus ψ (1) (A) = ψ(A) and for
k ≥ 1, ψ (k+1) (A) = ψ(ψ (k) (A)). Taking the particular interpretation of f and
g in (3), the sequence ψ (k) (Y ) is nothing more than the sequence Ck from (2).
Notice that the sequence (ψ (k) (A), k ≥ 1) is a nested decreasing sequence
of subsets of Y , and so we may define the set:
\
ψ(A) := lim ψ (k) (A) =
ψ (k) (A),
k→∞

k≥1

which is a (possibly empty) subset of Y (in the setting of Proposition 2, ψ(A) =
C∞ ).
Given (finite or infinite) sets Y, W , where W is partially ordered, together
with functions f : 2Y → W and g : Y → W , it is routine to verify that the
following properties hold:
(i) The gf -compatible subsets of Y are precisely the non-empty subsets of Y
that are fixed points of ψ;
(ii) If f is monotonic then ψ(Y ) contains all gf -compatible subsets of Y ; in
particular, if ψ(Y ) = ∅, then there is no gf –compatible subset of Y .

Self-sustaining autocatalytic networks within open-ended reaction systems

15

(iii) If f is ω-continuous then ψ(Y ) is gf -compatible, provided it is non-empty;
in particular, if f is monotonic and ω-continuous then (by (ii)) there a
gf -compatible subset of Y exists if and only if ψ(Y ) is nonempty.
(iv) Without the assumption that f is weakly ω-continuous in Part (iii), it is
possible for ψ(Y ) to fail to be gf -compatible when Y is infinite, even if f
is monotone.
The proof of Parts (i)–(iii) proceeds exactly as in [3], with the addition of
one extra step required to justify Part (iii), assuming ω-continuity. Namely,
Condition (4) ensures that ψ : 2Y → 2Y is also ω-continuous in the sense that
for any nested descending chain Ai , i ≥ 1 of sets, we have:
\
\
ψ(Ai ),
(5)
ψ( Ai ) =
i≥1

i≥1

and so ψ(ψ(Y )) = ψ(Y ). The proof of (5)
T from (4) is straightforward: firstly,
⊆ holds for any function ψ, while if y ∈ i≥1 ψ(Ai ), then,
T by definition of ψ,
y ∈ Ai for all i and g(y) ≤ f (Ai ) for all
i
≥
1
and
so
y
∈
i≥1 Ai , and g(y) ≤
T
f (Ai ) for all i ≥ 1. Now, since w = f (Ti≥1 Ai ) is a glb of {f (ATi ) : i ≥ 1}, we
have g(y) ≤ w for all i (i.e. g(y) ≤ f ( i≥1 Ai )) and so y ∈ ψ( i≥1 Ai ). Part
(iv) follows directly from Parts (ii) and (iii).
For Part (vi), consider the infinite CRS Q4 in Example 2. As above, take
Y = C, W = 2X and, for A ∈ 2Y , with f and g defined as in (3). Then
ψ(Y ) = A, where A = {(s, r1 ), (f f, r2 ), (f f f, r3 ), . . .} however, A is not gf compatible, since (s, r1 ) ∈ A and g((s, r1 )) = {s, f } but this is not a subset
of f (A) = clR[A] (F ) = F since s 6∈ F. In this example, f fails to be weakly
ω-continuous, and the argument is analogous to where we showed earlier that
Q04 fails to satisfy (A4)0 . More precisely, for each i ≥ 1, let Ai = {(cr , r) :
r ∈ Ri }, where Ri is defined in (1) and where, for each reaction r ∈ Q4 , cr
is
T the unique catalyst of r. ThenTf (Ai ) = F ∪ {s} ∪ {x
Ti+1 , xi+2 , . . .} and so
f ( i≥1 Ai ) = f (A) = F,
i≥1 f (Ai ) = F ∪ {s}. However,
i≥1 Ai = A and so T
which differs from the glb of {f (Ai ), i ≥ 1}, namely i≥1 f (Ai ) = F ∪ {s}. 2
5 Concluding comments
The examples in this paper are particularly simple – indeed mostly we took the
food set to consist of just a single molecule, and reactions often had only one
possible catalyst. In reality more ‘realistic’ examples can be constructed, based
on polymer models over an alphabet, however the details of those examples
tends to obscure the underlying principles so we have kept with our somewhat
‘toy’ examples in order that the reader can readily verify certain statements.
Section 3 describes a process for determining whether an arbitrary infinite
CRS (satisfying (A1)–(A3)) contains a finite RAF. However, from an algorithmic point of view, Proposition 3 is somewhat limited, since the process
described is not guaranteed to terminate in any given number of steps. If no
further restriction is placed on the (infinite) CRS, then it would seem difficult

16

Mike Steel

to hope for any sort of meaningful algorithm; however, if the CRS has a ‘finite
description’ (as do our main examples above), then the question of the algorithmic decidability of the existence of an RAF or of a finite RAF arises. More
precisely, suppose an infinite CRS Q = (X, R, C, F ) consists of (i) a countable
set of molecule types X = {x1 , x2 , . . .}, where we may assume (in line with
(A1)) that F = {xi : i < K}, for some finite value K, and (ii) a countable
set R = {r1 , r2 , . . .} of reactions, where ri has a finite set α(i) of reactants, a
finite set β(i) of products, and a finite or countable set γ(i) of catalysts, where
α, β and γ are computable (i.e. partial recursive) set-valued functions defined
on the positive integers. Given this setting, a possible question for further investigation is whether (and under what conditions) there exists an algorithm
to determine whether or not Q contains an RAF, or more specifically a finite
RAF (i.e. when is this question decidable?).
6 Acknowledgements
The author thanks the Allan Wilson Centre for funding support, and Wim
Hordijk for some useful comments on an earlier version of this manuscript.
I also thank Marco Stenico (personal communication) for pointing out that
ω-consistency is required for Part (iii) of the gf -compatibility result above
when Y is infinite, and for a reference to a related fixed-point result in domain
theory (Theorem 2.3 in [13]), from which this result can also be derived.
References
1. P. Dittrich, P. Speroni di Fenizio, Chemical organisation theory. Bull. Math. Biol. 69,
1199–1231 (2007)
2. P. G. Higgs, N. Lehman, The RNA World: molecular cooperation at the origins of life.
Nat. Rev. Genet. 16(1), 7–17 (2015)
3. W. Hordijk, M. Steel, Autocatalytic sets extended: dynamics, inhibition, and a generalization. J. Syst. Chem. 3:5 (2012)
4. W. Hordijk, M. Steel, Autocatalytic sets and boundaries. J. Syst. Chem. (in press) (2014)
5. W. Hordijk, M. Steel, Detecting autocatalyctic, self-sustaining sets in chemical reaction
systems. J. Theor. Biol. 227(4), 451–461 (2004)
6. W. Hordijk, S. Kauffman, M. Steel, Required levels of catalysis for the emergence of
autocatalytic sets in models of chemical reaction systems. Int. J. Mol. Sci. (Special issue:
Origin of Life 2011) 12, 3085–3101 (2011)
7. W. Hordijk, M. Steel, S. Kauffman, The structure of autocatalytic sets: evolvability,
enablement, and emergence. Acta Biotheor. 60, 379–392 (2012)
8. S. A. Kauffman, Autocatalytic sets of proteins. J. Theor. Biol. 119, 1–24 (1986)
9. S. A. Kauffman, The Origins of Order (Oxford University Press, Oxford 1993)
10. E. Mossel, M. Steel, Random biochemical networks and the probability of self-sustaining
autocatalysis. J. Theor. Biol. 233(3), 327–336 (2005)
11. J. Smith, M. Steel, W. Hordijk, Autocatalytic sets in a partitioned biochemical network.
J. Syst. Chem. 5:2 (2014)
12. M. Steel, W. Hordijk, J. Smith, Minimal autocatalytic networks. Journal of Theoretical
Biology 332: 96–107 (2013)
13. V. Stoltenberg-Hansen, I. Lindström, E. R. Griffor, Mathematical Theory of Domains.
Cambridge Tracts in Theoretical Computer Science 22 (Cambridge University Press, Cambridge 1994)

Self-sustaining autocatalytic networks within open-ended reaction systems

17

14. V. Vasas, C. Fernando, M. Santos, S. Kauffman, E. Szathmáry, Evolution before genes.
Biol. Dir. 7:1 (2012)
15. M. Villani, A. Filisetti, A. Graudenzi , C. Damiani, T. Carletti, R. Serra, Growth and
division in a dynamic protocell model. Life 4, 837–864 (2014)

