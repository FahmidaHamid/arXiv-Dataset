The role of packaging sites in efficient and specific virus assembly
Jason D Perlmutter and Michael F Hagan∗

arXiv:1502.05029v1 [q-bio.BM] 17 Feb 2015

Martin Fisher School of Physics, Brandeis University, Waltham, MA, USA.

I.

ABSTRACT

During the lifecycle of many single-stranded RNA viruses, including many human pathogens, a protein shell called
the capsid spontaneously assembles around the viral genome. Understanding the mechanisms by which capsid proteins selectively assemble around the viral RNA amidst diverse host RNAs is a key question in virology. In one
proposed mechanism, sequence elements (packaging sites) within the genomic RNA promote rapid and efficient assembly through specific interactions with the capsid proteins. In this work we develop a coarse-grained particle-based
computational model for capsid proteins and RNA which represents protein-RNA interactions arising both from nonspecific electrostatics and specific packaging sites interactions. Using Brownian dynamics simulations, we explore how
the efficiency and specificity of assembly depend on solution conditions (which control protein-protein and nonspecific
protein-RNA interactions) as well as the strength and number of packaging sites. We identify distinct regions in
parameter space in which packaging sites lead to highly specific assembly via different mechanisms, and others in
which packaging sites lead to kinetic traps. We relate these computational predictions to in vitro assays for specificity
in which cognate viral RNAs are compete against non-cognate RNAs for assembly by capsid proteins.

∗

hagan@brandeis.edu

2
II.

INTRODUCTION

In many single-stranded RNA virus families, the spontaneous assembly of a protein container (capsid) around the
viral RNA is an essential step in the viral life cycle [1]. Formation of an infectious virion requires that the assembling
proteins select the viral RNA out of the milieu of cellular RNA, and most viruses do so with high specificity (e.g.
99% [2]) in vivo. Understanding the mechanisms which enable such specific co-assembly could guide the design of
delivery vectors that assemble around specific drugs or genes, and could identify targets for antiviral agents that
interfere with genome packaging. In this work, we use dynamical computer simulations to investigate the ability of
sequence-specific RNA-protein interactions (packaging sites) to drive specific packaging of the viral genome, and how
specificity depends on the underlying sequence-independent interactions.
A key driving force for RNA-capsid protein co-assembly is provided by electrostatic interactions between RNA
phosphate groups and basic amino acids, often located in flexible tails known as arginine rich motifs (ARMs) (e.g.,
[3]). These nonspecific interactions are sufficient for assembly, as shown by the ability of capsid proteins to assemble
in vitro around heterologous RNA, synthetic polyelectrolytes, and other negatively charged substrates [4–17]. In
vitro assembly assays [18] and computational modeling [19, 20] indicate that the charge and structure arising from
base pairing of viral RNAs is optimal for assembly by their capsid proteins. However, these physical characteristics
alone cannot explain the remarkably specific packaging of the viral genome achieved by many RNA viruses in vivo.
Several factors have been proposed to explain specific packaging in vivo, including subcellular localization of viral
components [21], coordinated translation and assembly [22–24], and NA-sequence-specific interactions between capsid
proteins and sites within the genome called packaging sites (PSs). PSs have been identified for a number of unrelated
viruses infecting plant, animal, or bacterial hosts, suggesting this mechanism has widespread relevance [25–33].
The specificity conferred by PSs has been explored through in vitro experiments, either by comparing assembly
yields of capsid proteins around cognate and non-cognate RNAs in separate experiments or by competition assays,
in which two RNA species compete for packaging under limiting protein concentrations. Measured selectivities have
varied widely, ranging from high selectivity for the cognate [30, 31, 34], no selectivity [35], or selectivity for a noncognate RNA[18]. Two recent experiments observed that assembly around cognate RNAs proceeded via different,
faster assembly pathways than around non-cognate RNAs [36, 37]. The authors suggest that their experiments are
more selective for cognate RNAs because they use a lower protein concentration than previous experiments (1µM vs
10µM ).
Using chemical kinetics simulations (Gillespie algorithm [38–40]), Dykeman et al. [22, 41] predicted assembly under
dynamic subunit concentrations, i.e. the concentration increase (‘ramp’) that occurs during an infection cycle in E.
coli, could lead to 100% specificity for RNAs with PSs (represented by nonuniform protein binding affinities) even
under a large excess of non-cognate RNAs (represented by uniform binding affinities). In contrast, constant subunit
concentrations led to weak differences in yield (∼ 5%) and a significant portion of malformed capsids. However,
these simulation results do not entirely address the recent in vitro experiments [36, 37] in which PSs led to high
yield assembly while non-cognate assembly was unsuccessful using constant subunit concentrations. A limitation
of Gillespie algorithm simulations is that the state space (the set of allowed partial capsid geometries and RNA
configurations) and the transition rates (e.g. association rates among RNA-bound subunits) must be assumed a
priori [1]. It is therefore difficult to account for complex processes such as cooperative RNA-protein motions seen in
previous Brownian dynamics simulations [42, 43]. While these assumptions can be guided by experimental data in
certain cases, we seek here to determine the ensemble of possible assembly pathways and products.
We recently developed a particle-based computational model for RNA and capsid proteins [19, 44] with which
capsid assembly is simulated using Brownian dynamics. Although the model is coarse-grained, model predictions for
RNA lengths that optimize capsid thermostability quantitatively agreed with viral genome length for seven viruses
[19]. We previously examined how varying the nonspecific electrostatic RNA-protein subunit interactions, solution
conditions, and subunit-subunit interactions leads to a range of assembly outcomes and different classes of assembly
pathways [44].
Here, we explore how introducing specific PS interactions, in a simple form inspired by a recent structural investigation of STNV [37], alters these assembly pathways and products. By extensively comparing assembly around uniform
polyelectrolytes (representing non-cognate RNA) and PS-containing polyelectrolytes (cognate RNA), we identify solution conditions that lead to highly specific packaging of the cognate RNA. Depending on the relative strength of
protein-protein and protein-RNA interactions, we find that PSs can drive specific assembly via several mechanisms.
Consistent with recent single molecule experiments [36], the simulations indicate that PSs can trigger assembly via
pathways with more compact intermediates as compared to non-cognate RNAs. However, we also find solution conditions under which PSs are unable to drive specific packaging or even lead to kinetic traps. We then investigate how
assembly yields and specificity depend on the number and strength of PSs. In general, we find that a combination
of one high affinity PS and multiple weak PSs leads to the highest assembly yields, consistent with the identification
of multiple weak PSs in viral genomes [26] and with previous observations that productive self-assembly reactions

3
require reversible interactions [1, 45]. We conclude by discussing potential experimental predictions suggested by
these simulations.

III.

MODEL

To study the effect of PSs on assembly, we have extended a recently developed model [19, 44] for assembly around
linear polyelectrolytes and non-cognate RNAs to include a representation of PSs. The model is motivated by recent
experiments in which purified simian virus 40 (SV40) capsid proteins assemble in vitro around ssRNA molecules to
form virus-like particles composed of 12 homopentamer subunits [46, 47]. The model capsid is therefore a dodecahedron
comprising 12 pentagonal subunits, each of which represents a homopentamer of the capsid protein. It is assumed
that homopentamers are stable and form rapidly in solution, as is the case for for SV40. Although the structure of the
model capsid is motivated by these experiments [46, 47], in this article we use the model to study general relationships
between PSs and assembly which could apply to many viral species.
Capsid protein subunit-subunit interactions. Following Refs [19, 44, 48], model subunits are attracted to
each other via attractive pseudoatoms, ‘attractors’ (type ‘A’) at the vertices, which interact via a Morse potential (see
Fig. 1 and the Methods section). The subunit-subunit interaction strength is controlled by the model parameter εss ;
the free energy of subunit dimerization is gss /kB T =5.0 − 1.5εss . This does not include the effects due to repulsions
between ARMs (defined below), which we estimate to reduce gss by ∼ 0.5kB T at 100mM; see SI section SI C. These
attractions represent the interactions between capsid protein subunits that arise from hydrophobic, van der Waals, and
electrostatic interactions [1]), whose strength can be experimentally tuned by pH and salt concentration [1, 49, 50].
Pairs of subunits are driven toward a preferred subunit-subunit angle consistent with a dodecahedron (116 degrees)
by repulsive ‘Top’ pseudoatoms (type ‘T’), which interact via the repulsive term of the Lennard-Jones (LJ) potential.
The ‘Bottom’ pseudoatoms (type ‘B’) have a repulsive LJ interaction with ‘T’ pseudoatoms, intended to prevent
‘upside-down’ assembly. The ‘T’, ‘B’, and ‘A’ pseudoatoms form a rigid body [48, 51, 52]. See Refs. [40, 42, 52–67]
for related models.
Sequence-independent electrostatic interactions. Capsid assembly around nucleic acids and other polyelectrolytes is driven by electrostatic interactions between negative charges on the encapsulated polyelectrolyte and
positive charges on capsid protein-RNA binding domains [1, 3].To account for these interactions, we extend the model
as follows. First, we add positively charged bead-spring polymers affixed to the inner surface of the subunit, to represent the highly charged, flexible terminal tails known as arginine rich motifs (ARMs) that are typical of positive-sense
ssRNA protein-RNA binding domains (e.g., [3]). There are five ARMs per pentameric subunit. For each ARM, the
first segment is anchored at a fixed position on the subunit, midway between the subunit center and a vertex. Except
where stated otherwise, each ARM contains five segments of charge +e. To better represent the capsid shell, we
include a layer of ‘Excluder’ pseudoatoms, which have a repulsive LJ interaction with the RNA and the ARMs. The
‘Excluders’ and first ARM segment are part of the subunit rigid body. ARM beads interact through repulsive LJ
interactions and, if charged, electrostatic interactions.
To represent an RNA molecule, we consider a linear bead-spring polyelectrolyte, with a charge of -e per bead and
a persistence length comparable to that of ssRNA in the absence of base pairing. To focus on the effect of PSs, we
do not consider RNA base pairing in this work; the effect of base pairing on assembly was considered in Ref. [19].
We also previously determined how assembly depends on polyelectrolyte length [19]. In the present work, for each
simulated salt concentration and capsid structure, we use the polyelectrolyte length that optimizes assembly. The
values of optimal lengths as a function of salt concentration are shown in Fig. S8.
Electrostatics are modeled using Debye-Hückel (DH) interactions, where the Debye screening length (λD ) is given
1/2
by λD ≈ 0.3/Csalt with λD in nm Csalt the concentration of monovalent salt in molar units. Perlmutter et al. [19]
showed that DH interactions compare well to simulations with explicit counterions for the parameter values under
consideration; comparisons between simulations with DH interactions and those with explicit counterions are presented
in Refs. [19, 44] and Fig. S8.
Simulations and units. Simulations were performed with the Brownian Dynamics algorithm of HOOMD, which
uses the Langevin equation to evolve positions and rigid body orientations in time [68–70]. Simulations were run
using a set of fundamental units. The fundamental energy unit is selected to be Eu ≡ 1kB T . The unit of length
Du is set to the circumradius of a pentagonal subunit, which is taken to be 1Du ≡ 5 nm so that the dodecahedron
inradius of 1.46Du = 7.3 nm gives an interior volume consistent with that of the smallest T =1 capsids. To calculate
the thermodynamic optimal encapsidation length, we placed a very long polymer in or near a preassembled capsid,
with one of the capsid subunits made permeable to the polymer and performed unbiased Brownian dynamics. Once
the amount of packaged polymer reached equilibrium, the thermodynamic optimum length L∗eq was measured. We
previously [19] found that this strategy closely matched that produced using the Widom insertion method [71] as
applied to growing polymer chains [42, 72]. Assembly simulations were run at least 10 times for each set of parameters,

4
each of which were concluded at either completion, persistent malformation, or 2 × 108 time steps. This observation
time was chosen based on the time after which assembly yields and outcomes change only logarithmically with time
for most parameter values. For all dynamics simulations there were 60 subunits with box size=200 × 200 × 200 nm,
resulting in a concentration of 12µM.

A Subunit Side View

B

T

PS Interaction
A

R
PS

A

A
A

A

A

B

T

A

A

A

A

A

+

+

Top
Bottom
Attractor
PSR

T

A

A

PS

A

A

PS

R

+
B
+
PS

Subunit-Subunit
Interaction
A

R
PS

R
PS

+ PSR

R

APSA
A

PS

R

+
B

+

A PSR

+
PSR

A

B

PS

R

A

PS

A

+
+

R

+

+

PSR

A

+

A

PS

+ PSR

R

A

+
PSR

A

FIG. 1. (A) Model schematic showing components responsible for subunit-subunit interactions: subunits are bound together
by attractor pseudoatoms (‘A’), and the Top (‘T’) and Bottom (‘B’) pseudoatoms guide the subunits towards the correct
geometry (see SI). (B) Schematic with components responsible for attractive interaction with the RNA (drawn in red) and
packaging site (‘PS’): positively charged ARM (‘+’) and PS Receptor (‘PSR’). The ‘Excluder’ pseudoatoms, which represent the
excluded volume of the capsid shell, are located within the black pentagons; to aid visibility, they are not explicitly drawn here.
Snapshots here and throughout the article are colored as follows: blue=excluders, green=attractors, yellow=ARM, red=RNA,
orange=PS.

Packaging sites (PSs). Structures of PSs obtained for a number of viruses through x-ray crystal structures and/or
bioinformatics correspond to short stem loops [26]. For example, multiple short stem-loops with a single-stranded
loop motif of A.X.X.A-, where X corresponds to any nucleotide, were identified as PSs in the STNV genome [37].
An x-ray structure of STNV VLPs containing stem loop fragments revealed that they bind to well-defined sites on
the protein ARMs with the effect of bringing multiple subunits into proximity and favoring alignments conducive to
subunit-subunit interaction, thus enhancing subunit-subunit interactions as well as subunit-RNA interactions [37].
To account for the these effects, we have extended the model to include a generic representation of PS interactions
by adding new pseudoatoms (denoted as packaging site receptors, PSRs) to the model protein subunits (Fig. 1B).
The PSRs experience short-range interactions with particular RNA segments that correspond to PSs. For simplicity,
the PS-PSR interaction uses the same short-range Morse potential as the attractor-attractor interaction (Eq. 5,
section SI A). The strength of the PS-PSR attractive interaction is parameterized by the interaction well-depth εPS .
There are five PSRs per pentameric subunit. Except where noted otherwise, each PSR is located approximately
midway between an ARM anchor segment and a subunit vertex. This location allows for a PS to simultaneously bind
to 3 PSRs when three subunits form an optimal configuration. Thus, the PSs not only promote subunit-RNA binding,
but also generate RNA-mediated subunit-subunit interactions, as inferred from structural data [37].
Recent experiments have identified multiple PSs within several viral genomes (e.g. [32, 37, 73–76]) and that these
PSs bind capsid proteins with a range of affinities [32, 77]. Typically there are one or a few high affinity PSs (e.g. nM
KD ), with the remainder having weaker affinities (up to µM KD ) [77].
In our simulations, we explore how assembly depends on (A) the number of PS (NPS ), (B) the PS binding affinity
(εPS ), and (C) distribution of PS binding affinities along the polyelectrolye. (A) There are 60 PSRs in a complete
model capsid, located at 20 threefold axes. Thus, an RNA with 20 PSs can interact with every PSR, and we will refer
to NPS = 20 as the ‘stoichiometric’ number of PSs. (B) To limit the number of model parameters, we consider two
classes of model PSs: high affinity sites, with PS-PSR interaction well depth εPS = 20kB T (see Eq 12) and low affinity
sites, with εPS = 5kB T (see Section SI C for discussion of binding free energies). (C) To describe how assembly
depends on the distribution of affinities, we consider three forms of PS distributions along the model RNA: (i ) NPS
high affinity PSs, (ii ) NPS low affinity PSs, and (iii ) 1 high affinity PS along with NPS low affinity PSs. In each case
the PSs are placed at a uniform interval along the RNA. Unless otherwise noted, the strong PS in distribution iii is
placed at the center of the RNA as found for MS2 [31].

5
Comparison to existing models. Dykeman et al. [22, 41] extended the kinetic rate equation approach of Becker
and Doring [78] and Zlotnick [79] to include a representation of RNA and PSs. In this model the Gillespie algorithm
[38–40] is used to stochastically sample paths according to a predefined state space and matrix of inter-state transition
rates. They assume that each of the PSRs is bound by RNA once and that subunits adding to partial capsids are
bound to adjacent RNA segments, so that assembly must follow a Hamiltonian path. In the present model the
spatial positions and dynamics of subunits are explicitly tracked and thus there are no assumptions made about the
state space or assembly pathways. Consequently, there are no explicit restrictions on the sequence of RNA binding
sites, although steric hindrances disfavor binding of multiple PSs at the same threefold axis and RNA conformational
statistics favor returning to nearby binding sites.

IV.

RESULTS

In this section we describe how assembly depends on the specific (PS-PSR) and nonspecific (electrostatic) interactions. We refer to polyelectrolytes equipped with only nonspecific interactions as non-cognate RNAs, and
polyelectrolytes which contain one or more PSs as cognate RNAs. Note that since we neglect base pairing in this
work, the non-cognate RNA is a linear polyelectrolyte. However, since we also neglect base pairing in the cognate
RNA, our results are applicable to a comparison between cognate and non-cognate RNAs, except to the extent that
the tertiary structure of cognate RNAs is more favorable for assembly than that of non-cognate RNAs [19, 80].

9
8
7
6
5
4
3
2

500
300
100
Ionic Strength (mM)

E

Non-cognate Yield, fnc(tend)
10
9
8
7
6
5
4
3
2

1

0.5

0
500
300
100
Ionic Strength (mM)

C

Cognate Outcome
Subunit-Subunit Attraction (kBT)

Subunit-Subunit Attraction (kBT)
Subunit-Subunit Attraction (kBT)

D

B

Non-cognate Outcome
10

Subunit-Subunit Attraction (kBT)

A

10

Success

9
8
7

On Pathway

6
5
4
3
2

Unnucleated

500
300
100
Ionic Strength (mM)
Cognate Yield, fc(tend)

10
9
8
7
6
5
4
3
2

1

Disordered

0.5

Malformed
0
500
300
100
Ionic Strength (mM)

FIG. 2. The effect of PSs and solution conditions on assembly yields and products. (A,B)The most prevalent assembly
product is shown as a function of ionic strength Csalt and subunit-subunit attraction well-depth εss for assembly around (A)
a non-cognate RNA (polyelectrolyte without PS), and (B) a cognate RNA with 1 high affinity (HA, εPS = 20kB T ) PS and 25
low affinity (LA, εPS = 5kB T ) PSs (B). A legend showing the outcome and a representative simulation snapshot corresponding
to each symbol is presented in (C). (D,E) The yield of well-formed capsids assembled around (D) the non-cognate RNA or
(E) the cognate RNA with the PS sequence as in (B). In each simulation the RNA length corresponds to the thermodynamic
optimal length for the non-cognate at the simulated value of Csalt , and ranges from 350 to 575 RNA segments
(see Fig. S7).

6
A.

The yield and specificity conferred by PSs depends on subunit-subunit and nonspecific electrostatic
interactions

Yield without PSs. The assembly of non-cognate RNA (uniform polyelectrolytes) depends on the strength of
subunit-subunit interactions (controlled by εss in our model, eq. 3 in section SI A, and salt concentration or pH in vitro)
and sequence-independent electrostatic interactions (controlled by the salt concentration Csalt ). The dependence of
assembly outcomes on these parameters for a non-cognate RNA is summarized in Fig. 2. High yields of well-formed
VLPs are observed for Csalt ∈ [50 − 400] mM and moderate subunit-subunit interaction strengths, εss ∈ [4 − 6]kB T .
Outside of optimal parameter values, yields are suppressed by several failure modes: strong electrostatics lead to
disordered aggregates, strong subunit-subunit interactions lead to malformed capsids, and overly weak interactions
lead to unnucleated complexes [44]. The yield fnc (t) is defined as the fraction of simulations which, at time t, resulted
in formation of a complete capsid (defined as 12 subunits each strongly interacting with five neighbors) completely
encapsulating the non-cognate RNA. The yield fnc (tend ) at the simulation endpoint tend is shown in Fig. 2D. For each
case, at least 10 simulations are run, so the estimated error in the yield ranges from 0.07 − 0.13 [81].
Yield with PSs. Based on observations of multiple low affinity PSs [26] and simulations at varying numbers and
strengths of PSs (section IV B below), we performed simulations at varying εss and Csalt for an RNA with 1 high
affinity PS and NPS =25 low affinity PSs (see section SI A). With the addition of PSs, the range of parameters leading
to high assembly yields (fc ) broadens considerably (Fig. 2B,E), allowing assembly at much lower values of εss across
a wide range of Csalt and increasing the upper range of εss leading to assembly at low Csalt .
Notably, assembly around the non-cognate RNA fails in distinct ways in these parameter regions (Fig. 2C), indicating
that PSs can avoid multiple forms of thermodynamic or kinetic traps. At low εss , the predominant effect of PSs is to
enhance nucleation and growth rates by increasing effective interaction strengths. Increased subunit-RNA interactions
are most relevant at high salt while increased subunit-subunit interactions are most relevant at low salt (discussed in
section IV B). At high εss and low or moderate salt (e.g. Csalt =50mM and εss =7kB T ) assembly around non-cognate
RNA frequently leads to the nucleation of multiple partial capsids on the same RNA; typically these intermediates
have incompatible geometries and either fail to combine or form malformed capsids. In the cognate RNA simulations,
assembly rapidly nucleates around the HA PS; the LA PSs then enhance growth rates such that assembly is completed
before additional partial capsids can nucleate elsewhere on the RNA. The frequency of multiple nucleation events as
well as the structural heterogeneity of assembly intermediates are shown in SI Fig. S4.
Specificity. An estimate of the specificity conferred by PSs can be obtained by comparing the assembly dynamics
in the presence and absence of PSs. We calculated the probability that, for a given εss and Csalt , assembly of a
well-formed capsid occurs around the cognate RNA before the non-cognate RNA, normalized by the probability of
complete assembly around either substrate:
R tend

P1 =

dtPc (t)[1 − fnc (t)]rex
fc (tend ) + (1 − [1 − fnc (tend )]rex ) − fc (tend )(1 − [1 − fnc (tend )]rex )
0

(1)

where fnc (t) and fc (t) are the time-dependent yields around non-cognate and cognate RNAs (measured from the
c (t)
simulations whose final yields are shown in Figs. 2D,E), and Pc (t) = dfdt
is the assembly time probability distribution
function for cognate RNAs. The parameter rex = cnc /cc is the ratio of non-cognate to cognate RNAs. Eq. 1 for rex =1
is shown in Fig. 3A.
In a fairly wide range of parameter space, the assembly is 100% specific for assembly around the cognate RNA.
However, at parameters which are optimal for assembly around non-cognate RNA (i.e. where assembly without PSs
leads to high-yield, εss ∈ [4 − 6]kB T , Csalt ∈ [100 − 300]mM), there is essentially no selectivity. This result highlights
the importance of the solution conditions when assessing the role of PSs in vitro, and may suggest an explanation for
the varying levels of specificity for cognate RNAs observed in in vitro experiments (see the Introduction).
We next compare this competition estimate approach to explicit competition simulations which contain a cognate
RNA, rex non-cognate RNAs, and 60 pentamer subunits. In these simulations, we define specificity as the fraction of
simulations in which the first assembled capsid forms around a cognate RNA. Figure 3B presents results for rex = 1
at several subunit-subunit interaction strengths and salt concentrations. For several parameter sets in that figure,
assembly is not productive without PSs, and so as expected selectivity is 100%. At the other three parameter sets,
which result in incomplete selectivity, the predicted and measured values agree to within error. While in vitro assays
have typically focused on competition between equal concentrations of cognate and non-cognate RNAs, assembly in
vivo can occur under a large excess of cellular RNAs [82]. The estimated specificity for rex =10 is shown in Fig. 3C.
We have also considered competition under subunit limiting conditions — 1 cognate RNA, rex non-cognate RNAs,
and 18 protein subunits — so that at most one complete capsid can assemble, containing either a cognate or a noncognate RNA. As expected based on the independent assembly simulations, for parameters where assembly is not
productive without PS (Csalt = 500mM, εss = 6kB T ), we observe that assembly is 100% specific for the cognate RNA

7

10

1
0.8

8

0.6
6
0.4
4

0.2

2

0
500
300
100
Ionic Strength (mM)

1:1 Competition
Direction Simulation

Subunit-Subunit Attraction (kBT)

1:1 Competition

C
Cognate Selection Frequency

B

Subunit-Subunit Attraction (kBT)

A

1:10 Competition

10

Prediction

1

Result

0.5

0

30
30
30
50
50
10
εs 0mM εs 0mM εs 0mM εs 0mM εs 0mM εs 0mM
s =5
s =4
s =3
s =7
s =6
s =2
k
k
k
k
k
k
BT
BT
BT
BT
BT
BT

1
0.8

8

0.6
6
0.4
4

0.2

2

0
500
300
100
Ionic Strength (mM)

FIG. 3. Selectivity for RNA containing 1 HA PS + 25 LA PS competing against a non-cognate RNA at equal concentrations
rex = 1, (A) estimated from the data in Fig. 2 using Eq. 1 and (B) measured in direct competition simulations. (C) Selectivity
for RNA containing 1 HA PS + 25 LA PS competing against excess non-cognate RNA, rex = 10. As in Fig 2, in each simulation
the optimal RNA length is used based on the results in Fig. S7. In the explicit competition simulations of (B) the concentration
of subunits is the same as used in the assembly simulations (Fig. 2).

in all simulations for rex ∈ [1 − 50]. Interestingly, assembly is also 100% specific for the cognate RNA at a parameter
set for which assembly is productive without PS (Csalt = 500mM, εss = 7kB T, rex = 1). For these parameters,
nucleation occurs first around the PS, which reduces the number of free subunits and impedes nucleation around the
non-cognate. We are exploring whether this effect remains in larger systems.
We note that the relationship between P1 and specificity in direct competition assays could break down at low
salt, where subunits initially undergo nonspecific absorption onto cognate and non-cognate RNAs. Assembly under
limiting subunit concentrations in these conditions requires exchange of subunits between RNAs, which occurs slowly
relative to our simulation timescales.

B.

The effect of PSs depends on their number and strength

We now discuss the dependence of assembly and specificity on the number and affinities of PSs. We focus on
two interaction parameter sets: Csalt =100mM, εss =2kB T and Csalt =500 mM, εss =6kB T . These parameters lead to
100% specificity for the cognate sequence considered in Fig. 2 (1 high affinity PS and NPS =25 low affinity PSs),
but represent very different strengths of nonspecific electrostatic interactions and correspondingly different assembly
pathways around non-cognate RNAs. For each of these interaction parameter sets, we simulated three distributions
of PS affinities along the model RNA (see section SI A): (i ) NPS high affinity (HA) PSs, (ii ) NPS low affinity (LA)
PSs, and (iii ) a ‘Combo’ distribution with 1 HA PS and NPS LA PSs. Recall that the Combo sequence with NPS =25
is considered in Figs. 2 and 3.
As shown in Fig. 4, assembly yields for both interaction parameter sets are most robust under the Combo PS distribution. High yields are obtained for intermediate values of NPS , although the yield is optimal for sub-stoichiometric
NPS < 20 at moderate salt and super-stoichiometric NPS > 20 at high salt (recall that there are NPS = 20 PS binding
sites in a complete capsid).
However, the effect of PSs on assembly mechanisms, and hence the dependence on PS distribution, is markedly
different for the two parameter sets. At Csalt =100 mM, the subunits rapidly adsorb onto the RNA. Without PSs, the
weak subunit-subunit interactions (εss =2kB T ) are insufficient to drive subsequent assembly resulting in a disordered
aggregate (Fig. 2A). Nonetheless, even a sub-stoichiometric number of PSs is sufficient to promote complete assembly
(Fig. 4A). High yields are observed for 6-8 HA PSs, 10 LA PSs, and for NPS ∈ [10, 20] for the Combo case. For larger
than optimal NPS , multiple partial capsids nucleate on the same RNA, leading to long-lived malformed assemblies
that suppress yields. Snapshots illustrating typical assembly outcomes at low, stoichiometric, and excess NPS are
shown below the plots for each salt concentration in Fig. 4. For the Combo PS sequences, after several subunits have
adsorbed onto the RNA, the strong PS initiates assembly, with further growth mediated by the weak PS. When there
are multiple HA PSs, it is more likely for multiple small clusters to form, which may then merge into a single capsid,
with the final additions driven by electrostatic interactions.
We note that the effect of PSs under low salt and low εss derives not from their ability to drive subunit-RNA

8
interactions, which are already strong due to nonspecific electrostatics, but rather because the locations of packaging
site receptors (PSRs) at the capsid three-fold axes promotes subunit-subunit interactions (Fig. 1B). In support of
this conclusion, simulations in which PSRs were moved to the center of model subunits led to poor assembly (gold
diamond symbol in Fig. 4A).
At high salt concentration (Csalt =500 mM), different PS sequences promote assembly (Fig. 4B). Without PSs under
these conditions few subunits absorb on the RNA and nucleation does not occur on the timescales being simulated
(using Markov State modeling we determined that assembly eventually occurs around the non-cognate RNA on a
timescale which is two orders of magnitude longer [44]). With sub-stoichiometric NPS , a cluster of subunits assembles
in the vicinity of PSs, but subsequent growth into a capsid is slow on simulated timescales. In contrast, moderate
to high yields are observed for super-stoichiometric PSs (NPS ∈ [30 − 40]). For the Combo sequence, the HA PS
promotes rapid nucleation of a trimer after which the LA PSs facilitate adsorption and binding to the cluster by
additional subunits. In contrast to the low salt conditions, super-stoichiometric HA PSs also lead to moderate yields
of well-formed capsids; because of the weak nonspecific electrostatics malformed capsids are less prevalent.
With high salt and relatively strong subunit-subunit interactions (εss =6kB T ) the ability of PSs to drive subunitRNA interactions should be most relevant to promoting assembly. The effective subunit-subunit interactions promoted
by NPS =25 PSs are stronger than optimal, as can be seen by the fact that reducing εss increases yields (Fig. 2B).
Consistent with this reasoning, eliminating the contribution of PSs to subunit-subunit interactions by moving the
PSRs to subunit centers increased the yield (gold diamond symbol in Fig. 4B).
While the location of PSRs within the capsid structure can significantly affect assembly, we found that the location
of the strong PS along the RNA (in the Combo sequence) did not measurably alter the yield (open pentagon symbols
in Figs. 4A,B). This observation approximately agrees with Dykeman et al. [41] who predicted a very weak dependence
on HA PS location.

C.

PSs can alter assembly pathways

Modeling [44, 64, 83–86] and experiments [46, 87, 88] have shown that assembly pathways around non-cognate
RNAs can be classified according to two extremes. Systems in which protein-protein interactions dominate assemble
through nucleation-and growth pathways with ordered intermediates, whereas strong protein-RNA interactions (low
salt and/or high ARM charges) lead to the ‘en masse’ mechanism in which subunits rapidly adsorb on the RNA in a
disordered manner, followed by cooperative rearrangements to form a capsid. Assembly pathways can be classified by
the parameter nfree , defined as the number of subunits adsorbed to the RNA which are not part of the largest subunit
cluster, averaged over system configurations for which the largest partial capsid intermediate has 4–6 subunits [44].
For our model capsid with 12 subunits, nfree & 5 indicates the en masse mechanism, with smaller values indicating
the nucleation-and-growth mechanism. As shown in Fig. 5, assembly pathways around our model non-cognate RNA
range the gamut of nfree , with low salt and low εss leading to en masse pathways and high salt and high εss leading
to nucleation and growth pathways.
The addition of PSs has a striking effect on assembly pathways. As shown in Fig. 5, assembly pathways around the
Combo PS sequence with NPS = 25 correspond to the nucleation-and-growth mechanism over a broad range of εss and
Csalt . Under most conditions the PSs increase the order of assembly intermediates (lowering nfree , Fig. 5C) because
adsorbed subunits are co-localized and well-positioned for assembly. However, under high εss the most significant
effect of PSs is to increase subunit adsorption on the RNA and thus PSs slightly increase nfree . Snapshots from
representative trajectories for both of these cases are shown in Fig. 6. Consequently, nfree and correspondingly the
nature of assembly pathways are less sensitive to conditions (εss and Csalt ) than for the non-cognate RNA. This result
parallels the observation that PSs reduce the sensitivity of assembly yields to control parameters (Fig. 2).
Relationship between predicted assembly pathways and single molecule fluorescence correlation spectroscopy (smFCS) data. A means to test the predicted dependence of assembly pathways on solution conditions
and PSs is provided by the fact that pathways with different values of nfree can be distinguished by the hydrodynamic
radii (RH ) of their early intermediates [44]. Recent experiments have used smFCS to monitor the timecourses of RH
during assembly around cognate and non-cognate RNAs [36, 89, 90]. Under the experimental conditions, assembly
around cognate RNAs was rapid and characterized by either constant RH or a collapsed complex followed by gradual increase to the size of an assembled capsid. Assembly around non-cognate RNAs was slower, with RH initially
increasing before finally decreasing to the size of the capsid.
To relate the predicted effect of PS on assembly pathways (nfree ) discussed above to an experimentally observable
quantity, we estimated the hydrodynamic radii RH for polymer-subunit intermediates using the program HYDROPRO,
which has been shown to accurately predict RH for large protein and protein-NA complexes [91]. Fig. 7 shows
calculated RH for assembly around cognate and non-cognate RNAs for Csalt =100mM and several values of εss . For
weak subunit-subunit interactions (εss = 2kB T , Fig. 7A), assembly without PSs results in disordered aggregates

9

Yield, fc(tend)

A

εss=2kBT Csalt=100mM

1

LA PS
HA PS
Combo PS

0.5
0

0

10

Complete

Disordered

Yield, fc(tend)

B

30

40

Malformed

εss=6kBT Csalt=500mM

1

LA PS
HA PS
Combo PS

0.5
0

20
Number of PS

0

Unnucleated

10

20
Number of PS

Incomplete

30

40

Complete

FIG. 4. Yield as a function of number of PS, NPS , at low (A) and high (B) salt concentrations. Note that for these parameters
yield is zero in the absence of PSs. PSs are either all LA (), all high affinity (• symbols), or the Combo sequence with 1 HA
and NPS LA PSs(N symbols). For these cases, the HA PS is placed in the center of the RNA. Results from sets of simulations
with the HA PS placed in the terminal position are shown as D symbols. The result from simulations with the PS binding site
placed in the center of the subunits is shown as a  symbol. Note that there are 20 PS binding sites in a complete capsid, so
NPS = 20 is the stoichiometric value. Snapshots illustrate the trend in dominant outcomes with increasing PS number.

(Fig. 2), and the RH monotonically increases over time. With PSs, on the other hand, the RH initially increases as
subunits attach to the RNA, and then rapidly decreases as the capsid assembles. Upon increasing the subunit-subunit
interactions strength (εss = 3kB T , Fig. 7B), successful assembly occurs with and without PS; however, the increase
in RH is greater and of longer duration in the absence of PS. This difference occurs because the PSs enhance the
assembly rate and decrease nfree . Finally, under stronger subunit-subunit interactions (εss = 4kB T ) PSs have little
effect on nfree (Fig. 5) and correspondingly the time course of RH (Fig. 7C) is similar for cognate and non-cognate
RNAs.
The results at low subunit-subunit interaction strength resemble some key features of the experimental observations
of RH around cognate and non-cognate RNAs, while the lack of effect of PSs on assembly pathways under larger εss
emphasizes the fact that specificity depends on the underlying assembly driving forces. Importantly, the ability to
change RH time courses does not depend on specific geometric features of the PSs in our simulations, but only requires
that PSs promote rapid, ordered assembly pathways. Increasing the subunit-subunit interactions can achieve a similar
effect as adding PSs in this regard (Fig. 7C).
In the simulations discussed thus far (Fig. 2A-C), we used a relatively short RNA (575 segments at Csalt = 100mM ),
since this is the optimal length for our subunits with the small ARM charge (+5) [19, 44]. Therefore, the RH of the free
RNA (prior to encapsidation) is less than that of the assembled capsid and the measured RH increases substantially
upon adsorption of subunits, until assembly of ordered partial capsids reduces RH . To examine the applicability of

7

8
7
6
5
4
3
2
1
0

6
5
4
3
2
500
300
100
Ionic Strength (mM)

Cognate nfree

7

8
7
6
5
4
3
2
1
0

6
5
4
3
2
500
300
100
Ionic Strength (mM)

Subunit-Subunit Attraction (kBT)

Non-cognate nfree

Subunit-Subunit Attraction (kBT)

Subunit-Subunit Attraction (kBT)

10

nfree Difference

7

4
3
2
1
0
-1
-2
-3
-4

6
5
4
3
2
500
300
100
Ionic Strength (mM)

FIG. 5. The assembly pathway order parameter nfree measured from simulations for (left) the non-cognate RNA and (center)
the cognate RNA with the Combo PS sequence, NPS = 25. (Right) The change in nfree due to PSs.

εSS=3kBT, I=100mM
Non-cognate

Cognate

εSS=7kBT, I=500mM
Non-cognate

Cognate

FIG. 6. Snapshots from typical assembly trajectories without and with PSs (the cognate here is the combo sequence with 1
HA and 25 LA PSs) for low and high salt concentrations. PSs are depicted as large orange spheres.

our findings to the more typical case in which the free RNA RH is similar to or larger than the capsid size, we also
performed simulations on subunits with ARMs with charge (+10) and optimal RNA length 910 segments (Fig. 7D-F).
The behavior of this system is qualitatively similar to that of the +5 ARMs, except that the initial increase in RH
upon subunit absorption is less apparent for ordered assembly pathways. Note that in previous simulations [44] we
found that including base pairing did not qualitatively change RH time courses. However, we note that we do not
observe an increase in RH after the initial decrease, as observed in some of the experiments [36, 90]. This pattern
might reflect a global RNA conformation change triggered by subunit binding, which is not currently considered by
our model.

11

16
12
Non-cognate
Cognate

0

1

εss=3kBT, I=100mM

2

16
12
8

Timesteps (108)

G

Long ARM
εss=2kBT, I=100mM

E

16
12
Non-cognate
Cognate

8

0

Non-cognate
Cognate

0

1

εss=4kBT, I=100mM

2

16
12
8

Timesteps (108)

1

Timesteps (108)

Non-Cognate

16
12
8

Non-cognate
Cognate

0
Timesteps (108)

Non-cognate
Cognate

0

1

2

Timesteps (108)

Long ARM
εss=3kBT, I=100mM
Approximate RH (nm)

Approximate RH (nm)

D

C

1

F

Long ARM
εss=4kBT, I=100mM
Approximate RH (nm)

8

B

Approximate RH (nm)

εss=2kBT, I=100mM

Approximate RH (nm)

Approximate RH (nm)

A

16
12
8

Non-cognate
Cognate

0

1

Timesteps (108)

Cognate

FIG. 7. (A-F) Radius of hydration RH as a function of simulation time steps for assembly trajectories performed at indicated
parameter values, for non-cognate RNA ( symbols) and cognate RNA (• symbols). The RH values before subunits are
introduced are shown as N symbols. The subunit-subunit interaction energy εss increases from left to right. In the top row
(A-C), the subunit ARM charge is (+5), and the RNA length is 575 segments; in the second row (D-F), the subunit ARM
charge is (+10), and the RNA length is 910 segments. (G) Snapshots from simulations corresponding to panel (E), with
non-cognate RNA on the left and cognate RNA on the right.

D.

Restricted RNA Conformational Dynamics Inhibit Assembly

Although our simulations show that PSs can promote efficient assembly under conditions in which nonspecific
assembly fails, we also found that non-optimal numbers and affinities of PSs can lead to kinetic traps. In this
section we discuss mechanisms that can lead to these kinetic traps. As seen in Fig. 4, RNAs with 20 HA PSs (the
stoichiometric amount) fails to produce capsids at high or low salt. In part this outcome follows the well-known
rule that strong interactions hinder self-assembly into highly ordered low free energy configurations by preventing
‘local’ equilibration among partially assembled configurations and thus trapping the system in metastable disordered
states [1, 45, 49, 53, 63, 65, 92–94], as found for strong nonspecific electrostatics (Csalt ≤ 10 mM) or subunit-subunit
interactions (εss ≥ 8kB T , Fig. 1). However, a more nuanced explanation is required, since at high salt adding more
HA PSs (NPS = [30, 40], εPS = 20kB T ) does lead to moderate assembly yields (Fig. 4). Analysis of the high salt,
NPS = 20 simulation trajectories revealed ordered partially assembled capsid intermediates which, despite having
optimal subunit-subunit interaction geometries, failed to reach completion (Fig. 8).
We hypothesized that the stalled assemblies result from poorly equilibrated RNA conformational dynamics within
assembling capsids. To investigate the dependence of the RNA dynamics on PS sequences, we measured the fluctuations of the paths traced by RNAs within capsids (or capsid intermediates) over the course of dynamical trajectories.
To simplify the analysis we define an RNA path as the sequence of capsid threefold sites with which RNA segments

12

A

20

Path Duration
(Timeframes)

strongly interact (counting by the index of each strongly interacting RNA segment, Fig. 8B). Because the ARM
anchoring sites and the PSRs are located near threefold sites, these sites have enhanced non-cognate RNA densities
both in the presence and absence of PSs [19]. We note that these paths can be complex; for example, with strong
electrostatics (Csalt = 100mM ), ∼ 50% of paths re-visit one or more threefold sites (meaning segments which are
nonlocal in sequence interact with the same threefold site), compared with only ∼ 10% at (Csalt = 500mM ). Similarly,
jumps between non-neighboring vertices are also common, present in ∼ 1/3 of paths. Thus, the RNA usually does
not trace a Hamiltonian path within the capsid in our simulations.
In Figure 8 we quantify the RNA path persistence time (time required to change conformation) within assembled
capsids. In Fig. 8A, we see that non-cognate RNAs and RNAs with the Combo PS sequences (primarily LA PSs) are
highly dynamic; a new RNA path is observed at almost every observation time. In contrast, an RNA with 20 HA
PSs is far less dynamic, with existing paths persisting for far longer periods of time. To help visualize the differences
between these two classes of dynamics, schematics of pathways observed at five different observation times for different
RNA sequences are shown in Fig. 8B. While the paths for the 20 HA PS sequence are nearly identical, the paths
change significantly on this timescale for the other two PS sequences. We find that assembly stalls when the RNA
becomes frozen in a conformation whose geometry hinders recruitment of additional subunits to the assembling capsid.
Two examples of such conformations are shown in Fig. 8C. Under parameters which promote RNA dynamics, such
conformations are transient.
Notably, as the number of PSs is increased beyond the stoichiometric value NPS = 20 for any distribution, the
RNA dynamics increases (Fig. S6). This observation explains the increase in yield for the HA PS distribution at high
NPS . This facilitation arises because excess PSs can displace bound PSs from a given three-fold site without requiring
complete loss of interaction at that site, thus avoiding the activation barrier associated with PS-PSR unbinding (see
SI section SII B and Fig. S6). In contrast, for NPS ≤ 20 exchange requires dissolution of a PS-PSR interaction. In
effect, RNA with excess PSs can slide on capsid intermediates to sample different conformations and thus escape from
unproductive traps. Previous simulations [42, 43] and a theoretical model [95] have suggested the importance of RNA
rearrangements and subunit ‘sliding’ during assembly around non-cognate polyelectrolytes .

10

Non-Cognate

Combo
10 PS

Strong
20 PS

5
0

C

B

NC
HA PS
15 Combo PS

10

20
NPS

30

40

FIG. 8. (A) Rate of path discovery during a dynamic trajectory for RNAs within a preassembled capsid. (B) Schematic
representation of RNA path within the capsid at intervals of 5 × 107 timesteps. Line indicates path of RNA, with line color and
width changing gradually with contour length for clarity. (C) Snapshots and schematics indicating non-optimal RNA paths
which lead to stalled assemblies. PSs are shown with exaggerated size to improve visibility. Segments of interest are shown in
green.

V.

DISCUSSION

In this article, we have described simulations of capsid assembly around RNA, represented as a flexible polyelectrolyte with sequence-specific protein-RNA interactions, or packaging sites (PSs). By performing extensive simulations
over a range of ionic strengths, simulated protein-protein interaction strengths, and strength and number of PSs, we

13
have explored how PSs alter the pathways and products of capsid assembly reactions, and the extent to which they
induce specificity against polyelectrolytes without sequence-specific interactions (e.g. non-cognate RNAs). We find
that PSs can confer arbitrarily high specificity over RNAs with uniform nonspecific interactions, but that the degree
of specificity is sensitive to the underlying assembly driving forces, which can be tuned by solution conditions (ionic
strength, pH) as well as capsid protein charge (ARM sequence). The best specificity is conferred under conditions
where the nonspecific interactions alone are slightly too weak to promote effective assembly.
Assembly and specificity are also sensitive to the affinity and number of PSs, with the optimal distribution of
PSs depending on the solution conditions. Our simulations suggest that the PS sequences that confer the highest
specificity and are most robust to solution conditions contain one or a few high affinity PSs and a stoichiometric
or small excess of low affinity PSs. This observation is consistent with recent models [41], observation of multiple
weak PSs in viral genomes [77], and recent in vitro measurements [90]. Our simulations identify multiple mechanisms
by which PSs can confer specificity, depending on the protein sequence and solution conditions. Under conditions
where protein subunit-subunit or sequence-independent protein-RNA interactions are too weak to nucleate assembly,
PSs that enhance protein-RNA interactions and RNA-mediated protein-protein interactions can induce nucleation
and facilitate subsequent assembly. Under conditions where strong subunit-subunit and nonspecific subunit-RNA
interactions lead to multiple, geometrically incompatible partial capsids forming on individual RNAs, efficient and
specific assembly can be realized by PS sequences that favor nucleation and rapid assembly of a single partial capsid.
Finally, the simulations demonstrate that PSs can dramatically alter assembly pathways in comparison to non-cognate
RNAs (Fig. 7), as observed in recent experiments [36], but that the effect on assembly pathways is sensitive to solution
conditions.
Our simulation results suggest that rapid, specific assembly can proceed via a diverse ensemble of pathways, provided
that RNA conformations can anneal during assembly through reversible interactions and/or cooperative RNA-protein
rearrangements. This finding is consistent with the observation that proteins can fold by multiple, dissimilar pathways
[96]. In particular, the RNA does not trace a Hamiltonian path, as has been inferred from structures of T =3 MS2
capsids [33] and assumed in other models [22, 41]. However, the expectation of a Hamiltonian path relies on coupling
between PS binding and subunit conformation, which is not present in our model of a T =1 capsid.
Dykeman et al. [22] recently showed that the gradually increasing protein concentration characteristic of an MS2infected E. coli can increase specificity for a cognate RNA in comparison to assembly under a fixed protein concentration. Enhanced specificity arises in their model because during the initial stages of the reaction nucleation occurs
only around cognate RNAs, similar to the behavior in our simulations for high salt and low εss (Fig. 3). When the
protein concentration increases during later stages it is rapidly consumed by growth of the partial capsid-cognate
RNA complexes. While simulations with time-varying protein concentrations are beyond the scope of the present
work, we anticipate that similar specificity enhancements would arise in our model.
Implications for experiments. Our simulations predict that the specificity conferred by PSs is sensitive to
parameters that control the pathways and efficiency of sequence-independent assembly. While it has been previously
suggested that the degree of specificity observed in in vitro experiments is sensitive to subunit concentration, the
predicted phase diagrams reveal that varying ionic strength, pH, or protein-RNA binding sequences (through mutagenesis) could shift an experiment from selective to nonselective. This result may shed light on the varied degrees
of specificity observed in previous competition experiments [18, 30, 31, 34, 35]. However, note that the location of
boundaries within the predicted phase diagrams depend on the protein-RNA binding sequence[44]. Furthermore, experimentally measured specificity has been defined in different ways, depending on whether capsid protein is in excess
or limiting. Our simulations find that these two conditions and definitions can lead to similar or different observed
levels of specificity, depending on the location and parameter space (see section IV A). An intriguing prediction
from our simulations is that excess PSs (in comparison to the number of binding sites within a complete capsid) can
increase assembly under some conditions by promoting exchange of improperly bound PSs. This prediction, as well
as the general dependencies on the affinity and number of PSs, could be tested by constructing RNA fragments with
varying numbers of high- and low-affinity PSs.

VI.

ACKNOWLEDGMENTS

We gratefully acknowledge William Gelbart and Chuck Knobler for insightful discussions and critical reading of the
manuscript, as well as Reidun Twarock for a critical reading of the manuscript and helpful discussions, particularly
about the geometry of packaging site–capsid protein interactions. This work was supported by Award Number
R01GM108021 from the National Institute Of General Medical Sciences. Computational resources were provided by
the NSF through XSEDE computing resources (Maverick and Keeneland) and the Brandeis HPCC which is partially

14
supported by the Brandeis Center for Bioinspired Soft Materials, an NSF MRSEC, DMR-1420382.

[1] Michael F. Hagan. Modeling Viral Capsid Assembly. Adv Chem Phys, 155:1–68, 2014.
[2] Andrew Routh, Tatiana Domitrovic, and John E Johnson. Host RNAs, including transposons, are encapsidated by a
eukaryotic single-stranded RNA virus. Proc Natl Acad Sci U S A, 109(6):1907–1912, 2012.
[3] A. Schneemann. The structural and functional role of RNA in icosahedral virus assembly. Annu Rev Microbiol, 60:51–67,
2006.
[4] Jb Bancroft, Hiebert E, and Bracker Ce. Effects Of Various Polyanions On Shell Formation Of Some Spherical Viruses.
Virology, 39(4):924–930, 1969.
[5] Thomas Hohn. Role of RNA in the assembly process of bacteriophage fr. J Mol Biol, 43(1):191–200, 1969.
[6] C. Chen, E. S. Kwak, B. Stein, C. C. Kao, and B. Dragnea. Packaging of gold particles in viral capsids. J Nanosci
Nanotechno, 5(12):2029–2033, 2005.
[7] J. Sun, C. DuFort, M. C. Daniel, A. Murali, C. Chen, K. Gopinath, B. Stein, M. De, V. M. Rotello, A. Holzenburg, C. C.
Kao, and B. Dragnea. Core-controlled polymorphism in virus-like particles. Proc Natl Acad Sci U S A, 104(4):1354–1359,
2007.
[8] Yufang Hu, Roya Zandi, Adriana Anavitarte, Charles M. Knobler, and William M. Gelbart. Packaging of a polymer by a
viral capsid: The interplay between polymer length and capsid size. Biophys J, 94(4):1428–1436, FEB 15 2008.
[9] F. D. Sikkema, M. Comellas-Aragones, R. G. Fokkink, B. J. M. Verduin, Jjlm Cornelissen, and R. J. M. Nolte. Monodisperse
polymer-virus hybrid nanoparticles. Org Biomol Chem, 5(1):54–57, 2007.
[10] Melanie Brasch and Jeroen J. L. M. Cornelissen. Relative size selection of a conjugated polyelectrolyte in virus-like protein
structures. Chem Commun, 48(10):1446–1448, 2012.
[11] Mauri A. Kostiainen, Christian Pietsch, Richard Hoogenboom, Roeland J. M. Nolte, and Jeroen J. L. M. Cornelissen.
Temperature-Switchable Assembly of Supramolecular Virus-Polymer Complexes. Adv Funct Mater, 21(11):2012–2019,
2011.
[12] Nancy L. Goicochea, Mrinmoy De, Vincent M. Rotello, Suchetana Mukhopadhyay, and Bogdan Dragnea. Core-like particles
of an enveloped animal virus can self-assemble efficiently on artificial templates. Nano Lett, 7(8):2281–2290, 2007.
[13] LiNa Loo, Richard H. Guenther, Steven A. Lommel, and Stefan Franzen. Encapsidation of nanoparticles by Red Clover
Necrotic Mosaic Virus. J Am Chem Soc, 129(36):11111–11117, SEP 12 2007.
[14] Minseok Kwak, Inge J. Minten, Diana-Milena Anaya, Andrew J. Musser, Melanie Brasch, Roeland J. M. Nolte, Klaus
Muellen, Jeroen J. L. M. Cornelissen, and Andreas Herrmann. Virus-like Particles Templated by DNA Micelles: A General
Method for Loading Virus Nanocarriers. J Am Chem Soc, 132(23):7834–7835, 2010.
[15] Connie B. Chang, Charles M. Knobler, William M. Gelbart, and Thomas G. Mason. Curvature dependence of viral protein
structures on encapsidated nanoemulsion droplets. ACS Nano, 2(2):281–286, FEB 2008.
[16] Andrey G Malyutin and Bogdan Dragnea. Budding Pathway in the Templated Assembly of Viruslike Particles. J Phys
Chem B, September 2013.
[17] Fan Cheng, Irina B. Tsvetkova, Y-Lan Khuong, Alan W. Moore, Randy J. Arnold, Nancy L. Goicochea, Bogdan Dragnea,
and Suchetana Mukhopadhyay. The Packaging of Different Cargo into Enveloped Viral Nanoparticles. Mol Pharm,
10(1):51–58, 2013.
[18] Mauricio Comas-Garcia, Ruben D. Cadena-Nava, A. L. N. Rao, Charles M. Knobler, and William M. Gelbart. In vitro
quantification of the relative packaging efficiencies of single-stranded RNA molecules by viral capsid protein. J Virol,
86(22):12271–12282, 2012.
[19] Jason D. Perlmutter, Cong Qiao, and Michael F. Hagan. Viral genome structures are optimal for capsid assembly. eLife,
2:e00632, 2013.
[20] Gonca Erdemci-Tandogan, Jef Wagner, Paul van der Schoot, Rudolf Podgornik, and Roya Zandi. RNA topology remolds
electrostatic stabilization of viruses. Phys Rev E, 89:032707, Mar 2014.
[21] Devinka Bamunusinghe, Jang-Kyun Seo, and A. L. N. Rao. Subcellular Localization and Rearrangement of Endoplasmic
Reticulum by Brome Mosaic Virus Capsid Protein. J Virol, 85(6):2953–2963, 2011.
[22] Eric C. Dykeman, Peter G. Stockley, and Reidun Twarock. Solving a Levinthal’s paradox for virus assembly identifies a
unique antiviral strategy. Proc Natl Acad Sci U S A, 111(14):5361–5366, APR 8 2014.
[23] P. Annamalai, F. Rofail, D. A. DeMason, and A. L. N. Rao. Replication-coupled packaging mechanism in positive-strand
RNA viruses: Synchronized coexpression of functional multigenome RNA components of an animal and a plant virus in
Nicotiana benthamiana cells by agroinfiltration. J Virol, 82(3):1484–1495, 2008.
[24] C. C. Kao, P. Ni, M. Hema, X. L. Huang, and B. Dragnea. The coat protein leads the way: an update on basic and applied
studies with the Brome mosaic virus coat protein. Mol Plant Pathol, 12(4):403–412, 2011.
[25] ALN Rao. Genome packaging by spherical plant RNA viruses. Annu Rev Phytopathol, 44:61–87, 2006.
[26] Peter G Stockley, Reidun Twarock, Saskia E Bakker, Amy M Barker, Alexander Borodavka, Eric Dykeman, Robert J Ford,
Arwen R Pearson, Simon EV Phillips, Neil A Ranson, et al. Packaging signals in single-stranded RNA viruses: nature’s
alternative to a purely electrostatic assembly mechanism. J Biol Phys, 39(2):277–287, 2013.
[27] Lucia Pappalardo, Deborah J. Kerwood, Istvan Pelczer, and Philip N. Borer. Three-dimensional folding of an RNA hairpin
required for packaging HIV-1. J Mol Biol, 282(4):801–818, 1998.

15
[28] K. Lu, X. Heng, and M. F. Summers. Structural Determinants and Mechanism of HIV-1 Genome Packaging. J Mol Biol,
410(4):609–633, 2011.
[29] V. D’Souza and M. F. Summers. How retroviruses select their genomes. Nat Rev Microbiol, 3(8):643–655, 2005.
[30] P. K. Sorger, P. G. Stockley, and S. C. Harrison. Structure and Assembly of Turnip Crinkle Virus. 2. Mechanism of
Reassembly In vitro. J Mol Biol, 191(4):639–658, 1986.
[31] D Beckett, H N Wu, and O C Uhlenbeck. Roles of operator and non-operator RNA sequences in bacteriophage R17 capsid
assembly. J. Mol. Biol., 204(4):939–47, December 1988.
[32] D. H. J. Bunka, S. W. Lane, C. L. Lane, E. C. Dykeman, R. J. Ford, A. M. Barker, R. Twarock, S. E. V. Phillips, and
P. G. Stockley. Degenerate RNA Packaging Signals in the Genome of Satellite Tobacco Necrosis Virus: Implications for
the Assembly of a T=1 Capsid. J Mol Biol, 413(1):51–65, 2011.
[33] E. C. Dykeman, N. E. Grayson, K. Toropova, N. A. Ranson, P. G. Stockley, and R. Twarock. Simple Rules for Efficient
Assembly Predict the Layout of a Packaged Viral RNA. J Mol Biol, 408(3):399–407, 2011.
[34] C M Ling, P P Hung, and L R Overby. Independent assembly of Qbeta and MS2 phages in doubly infected Escherichia
coli. Virology, 40(4):920–9, April 1970.
[35] J. Zachary Porterfield, Mary Savari Dhason, Daniel D. Loeb, Michael Nassal, Stephen J. Stray, and Adam Zlotnick. FullLength Hepatitis B Virus Core Protein Packages Viral and Heterologous RNA with Similarly High Levels of Cooperativity.
J Virol, 84(14):7174–7184, 2010.
[36] Alexander Borodavka, Roman Tuma, and Peter G. Stockley. Evidence that viral RNAs have evolved for efficient, two-stage
packaging. Proc Natl Acad Sci U S A, 109(39):15769–15774, 2012.
[37] Robert J Ford, Amy M Barker, Saskia E Bakker, Robert H Coutts, Neil A Ranson, Simon EV Phillips, Arwen R Pearson,
and Peter G Stockley. Sequence-specific, RNA–protein interactions overcome electrostatic barriers preventing assembly of
satellite tobacco necrosis virus coat protein. Journal of molecular biology, 425(6):1050–1064, 2013.
[38] A. B. Bortz, M. H. Kalos, and J. L. Lebowitz. New Algorithm for Monte Carlo Simulation of Ising Spin Systems. J Comput
Phys, 17(1):10–18, 1975.
[39] D. T. Gillespie. Exact Stochastic Simulation of Coupled Chemical Reactions. J Phys Chem, 81(25):2340–2361, 1977.
[40] R. Schwartz, P. W. Shor, P. E. Prevelige, and B. Berger. Local rules simulation of the kinetics of virus capsid self-assembly.
Biophys J, 75(6):2626–2636, 1998.
[41] Eric C. Dykeman, Peter G. Stockley, and Reidun Twarock. Building a viral capsid in the presence of genomic RNA. Phys
Rev E, 87(2):022717, FEB 25 2013.
[42] O.M. Elrad and M. F. Hagan. Encapsulation of a polymer by an icosahedral virus. Phys Biol, 7:045003, 2010.
[43] A Kivenson and MF Hagan. Mechanisms of viral capsid assembly around a polymer. Biophys J, 99(2):619–628, 2010.
[44] J. D. Perlmutter, M. R. Perkett, and Michael F Hagan. Pathways for virus assembly around nucleic acids. Journal of
Molecular Biology, 2014.
[45] S. Whitelam and R. L. Jack. The Statistical Mechanics of Dynamic Pathways to Self-assembly. Ann Rev Phys Chem,
2015.
[46] Stanislav Kler, Roi Asor, Chenglei Li, Avi Ginsburg, Daniel Harries, Ariella Oppenheim, Adam Zlotnick, and Uri Raviv. RNA Encapsidation by SV40-Derived Nanoparticles Follows a Rapid Two-State Mechanism. J Am Chem Soc,
134(21):8823–8830, 2012.
[47] Stanislav Kler, Joseph Che-Yen Wang, Mary Dhason, Ariella Oppenheim, and Adam Zlotnick. Scaffold properties are a
key determinant of the size and shape of self-assembled virus-derived particles. ACS Chem. Biol., 8(12):2753–61, December
2013.
[48] D. J. Wales. The energy landscape as a unifying theme in molecular science. Phil Trans R Soc A, 363(1827):357–375,
2005.
[49] P. Ceres and A. Zlotnick. Weak protein-protein interactions are sufficient to drive assembly of hepatitis B virus capsids.
Biochemistry, 41(39):11525–11531, 2002.
[50] W. K. Kegel and P. van der Schoot. Competing hydrophobic and screened-Coulomb interactions in hepatitis B virus capsid
assembly. Biophys J, 86(6):3905–3913, 2004.
[51] Szilard N. Fejer, Tim R. James, Javier Hernandez-Rojas, and David J. Wales. Energy landscapes for shells assembled from
pentagonal and hexagonal pyramids. Phys Chem Chem Phys, 11(12):2098–2104, 2009.
[52] I. G. Johnston, A. A. Louis, and J. P. K. Doye. Modelling the self-assembly of virus capsids. J Phys : Condens Matter,
22(10):104101, 2010.
[53] M. F. Hagan and D. Chandler. Dynamic pathways for viral capsid assembly. Biophys J, 91(1):42–54, 2006.
[54] S. D. Hicks and C. L. Henley. Irreversible growth model for virus capsid assembly. Phys Rev E, 74(3):031912, 2006.
[55] H. D. Nguyen, V. S. Reddy, and C. L. Brooks. Deciphering the kinetic mechanism of spontaneous self-assembly of
icosahedral capsids. Nano Lett, 7(2):338–344, 2007.
[56] A. W. Wilber, J. P. K. Doye, A. A. Louis, E. G. Noya, M. A. Miller, and P. Wong. Reversible self-assembly of patchy
particles into monodisperse icosahedral clusters. J Chem Phys, 127(8):085106, 2007.
[57] HD Nguyen and CL Brooks. Generalized structural polymorphism in self-assembled viral particles. Nano Lett, 8:4574,
2008.
[58] Hung D. Nguyen, Vijay S. Reddy, and Charles L. Brooks. Invariant polymorphism in virus capsid assembly. J Am Chem
Soc, 131(7):2606–14, 2009.
[59] A. W. Wilber, J. P. K. Doye, and A. A. Louis. Self-assembly of monodisperse clusters: Dependence on target geometry.
J Chem Phys, 131(17), 2009.

16
[60] Alex W. Wilber, Jonathan P. K. Doye, Ard A. Louis, and Anna C. F. Lewis. Monodisperse self-assembly in a model with
protein-like interactions. J Chem Phys, 131(17):175102, 2009.
[61] D. C. Rapaport, J. E. Johnson, and J. Skolnick. Supramolecular self-assembly: molecular dynamics modeling of polyhedral
shell formation. Comput Phys Commun, 122:231–235, 1999.
[62] D.C. Rapaport. Self-assembly of polyhedral shells: a molecular dynamics study. Phys. Rev. E., 70:051905, 2004.
[63] D.C. Rapaport. The role of reversibility in viral capsid growth: A paradigm for self-assembly. Phys Rev Lett, 101:186101,
2008.
[64] M. F. Hagan. Controlling viral capsid assembly with templating. Phys Rev E, 77:051904, 2008.
[65] M. F. Hagan, O. M. Elrad, and R. L. Jack. Mechanisms of kinetic trapping in self-assembly and phase transformation. J
Chem Phys, 135:104115, 2011.
[66] J. P. Mahalik and M. Muthukumar. Langevin dynamics simulation of polymer-assisted virus-like assembly. J Chem Phys,
136(13):135101, 2012.
[67] Artem Levandovsky and Roya Zandi. Nonequilibirum assembly, retroviruses, and conical structures. Phys Rev Lett,
102(19):198102–198102, 2009.
[68] Joshua A. Anderson, Chris D. Lorenz, and A. Travesset. General purpose molecular dynamics simulations fully implemented
on graphics processing units. J Comput Phys, 227(10):5342–5359, 2008.
[69] Trung Dac Nguyen, Carolyn L. Phillips, Joshua A. Anderson, and Sharon C. Glotzer. Rigid body constraints realized in
massively-parallel molecular dynamics on graphics processing units. Comput Phys Commun, 182(11):2307–2313, 2011.
[70] David N. LeBard, Benjamin G. Levine, Philipp Mertmann, Stephen A. Barr, Arben Jusufi, Samantha Sanders, Michael L.
Klein, and Athanassios Z. Panagiotopoulos. Self-assembly of coarse-grained ionic surfactants accelerated by graphics
processing units. Soft Matter, 8(8):2385–2397, 2012.
[71] B. Widom. Some topics in the theory of fluids. J Chem Phys, 39(11):2808–2812, 1963.
[72] SK Kumar, Szleifer I, and Panagiotopoulos AZ. Determination Of The Chemical-potentials Of Polymeric Systems From
Monte-carlo Simulations. Phys Rev Lett, 66(22):2935–2938, JUN 3 1991.
[73] Eva J Archer, Mark A Simpson, Nicholas J Watts, Rory O’Kane, Bangchen Wang, Dorothy A Erie, Alex McPherson, and
Kevin M Weeks. Long-Range Architecture in a Viral RNA Genome. Biochemistry, 52(18):3182–3190, 2013.
[74] Shreyas S Athavale, J Jared Gossett, Jessica C Bowman, Nicholas V Hud, Loren Dean Williams, and Stephen C Harvey.
In vitro secondary structure of the genomic RNA of satellite tobacco mosaic virus. PloS one, 8(1):e54384, 2013.
[75] Susan J Schroeder, Jonathan W Stone, Samuel Bleckley, Theodore Gibbons, and Deborah M Mathews. Ensemble of
secondary structures for encapsidated satellite tobacco mosaic virus RNA consistent with chemical probing and crystallography constraints. Biophys J, 101(1):167–75, July 2011.
[76] Y. Zeng, S.B. Larson, C.E. Heitsch, A. McPherson, and S.C. Harvey. A Model for the Structure of Satellite Tobacco
Mosaic Virus. J Struct Biol, 180(1):110–116, 2012.
[77] Eric C Dykeman, Peter G Stockley, and Reidun Twarock. Packaging signals in two single-stranded RNA viruses imply a
conserved assembly mechanism and geometry of the packaged genome. J Mol Biol, 425(17):3235–49, September 2013.
[78] R Becker and W Döring. Ann. Phys. (Leipzig), 416:719, 1935.
[79] D. Endres and A. Zlotnick. Model-based analysis of assembly kinetics for virus capsids or other spherical polymers. Biophys
J, 83(2):1217–1230, 2002.
[80] A. M. Yoffe, P. Prinsen, A. Gopal, C. M. Knobler, W. M. Gelbart, and A. Ben-Shaul. Predicting the sizes of large RNA
molecules. Proc Natl Acad Sci U S A, 105(42):16153–16158, 2008.
[81] A Agresti and BA Coull. Approximate is better than “exact” for interval estimation of binomial proportions. AMERICAN
STATISTICIAN, 52(2):119–126, MAY 1998.
[82] M. Eigen, CK Biebricher, M Gebinoga, and WC Gardiner. The hypercycle coupling of RNA and protein biosynthesis in
the infection cycle of an RNA bacteriophage. Biochemistry, 30(46):11005–11018, NOV 19 1991.
[83] O. M. Elrad and M. F. Hagan. Nano Lett, 8(11):3850–3857, 2008.
[84] A. McPherson. Micelle formation and crystallization as paradigms for virus assembly. Bioessays, 27(4):447–458, 2005.
[85] B. Devkota, A. S. Petrov, S. Lemieux, M. B. Boz, L. Tang, A. Schneemann, J. E. Johnson, and S. C. Harvey. Structural
and Electrostatic Characterization of Pariacoto Virus: Implications for Viral Assembly. Biopolymers, 91(7):530–538, 2009.
[86] M. F. Hagan. A theory for viral capsid assembly around electrostatic cores. J Chem Phys, 130:114902, 2009.
[87] Ruben D. Cadena-Nava, Mauricio Comas-Garcia, Rees F. Garmann, A. L. N. Rao, Charles M. Knobler, and William M.
Gelbart. Self-Assembly of Viral Capsid Protein and RNA Molecules of Different Sizes: Requirement for a Specific High
Protein/RNA Mass Ratio. J Virol, 86(6):3318–3326, 2012.
[88] Rees F. Garmann, Mauricio Comas-Garcia, Ajaykumar Gopal, Charles M. Knobler, and William M. Gelbart. The Assembly
Pathway of an Icosahedral Single-Stranded RNA Virus Depends on the Strength of Inter-Subunit Attractions. J Mol Biol,
426(5, SI):1050–1060, MAR 6 2014.
[89] Mauricio Comas-Garcia, Rees F. Garmann, Surendra W. Singaram, Avinoam Ben-Shaul, Charles M. Knobler, and
William M. Gelbart. Characterization of Viral Capsid Protein Self-Assembly around Short Single-Stranded RNA. J.
Phys. Chem. B, 2014.
[90] Nikesh Patel, Eric C Dykeman, Robert H A Coutts, George P Lomonossoff, David J Rowlands, Simon E V Phillips, Neil
Ranson, Reidun Twarock, Roman Tuma, and Peter G Stockley. Revealing the density of encoded functions in a viral RNA.
Proc. Natl. Acad. Sci. U.S.A., February 2015.
[91] A Ortega, D Amorós, and J Garcı́a de La Torre. Prediction of hydrodynamic and other solution properties of rigid proteins
from atomic-and residue-level models. Biophysical journal, 101(4):892–898, 2011.
[92] A Zlotnick. Are weak protein-protein interactions the general rule in capsid assembly? Virology, 315:269–274, 2003.

17
[93] R. L. Jack, M. F. Hagan, and D. Chandler. Fluctuation-dissipation ratios in the dynamics of self-assembly. Phys Rev E,
76:021119, 2007.
[94] James Grant, Robert L. Jack, and Stephen Whitelam. Analyzing mechanisms and microscopic reversibility of self-assembly.
J Chem Phys, 135(21), 2011.
[95] Tao Hu and B. I. Shklovskii. Kinetics of viral self-assembly: Role of the single-stranded RNA antenna. Phys Rev E,
75:051901, 2007.
[96] Gregory R. Bowman and Vijay S. Pande. Protein folded states are kinetic hubs. Proceedings of the National Academy of
Sciences, 107(24):10890–10895, 2010.
[97] W. Humphrey, A. Dalke, and K. Schulten. VMD: Visual molecular dynamics. J Mol Graph, 14(1):33–38, 1996.

18

Supporting Information

SI.

MODEL AND SIMULATION DETAILS
A.

Model details

In our model, all potentials can be decomposed into pairwise interactions. Potentials involving capsid subunits
further decompose into pairwise interactions between their constituent building blocks – the excluders, attractors,
‘Top’ and ‘Bottom’, and ARM pseudoatoms. It is convenient to state total energy of the system as the sum of 6 terms:
a capsid subunit - subunit Uss part (which does not include interactions between ARM pseudoatoms), subunit-ARM
Usa , polymer-polymer (i.e. RNA-RNA) Upp , ARM-ARM Uaa , polymer-ARM Upa , and subunit-polymer Usp (which
includes the PS-PSR interactions), each summed over all pairs of the appropriate type:
X X
X X
X X
X
X
U=
Uss +
Usa +
Upp +
Uaa
sub i ARM j

sub i sub j<i

+

X

X

Upa +

poly i ARM j

X X

poly i poly j<i

ARM i ARM j<i

Usp

(2)

sub i poly j

P
P
P
P
where sub i sub j<i is the sum over all distinct pairs of capsid subunits in the system, sub i poly j is the sum
over all subunit-polymer pairs, etc. Note that unless otherwise stated, polyelectrolyte segments and polymer segments
designated as PS have the same interactions and parameters. This rule is excepted for PS-PS interactions and PS-PSR
interactions, as described below.
The capsid subunit-subunit potential Uss is the sum of the attractive interactions between complementary attractors,
and geometry guiding repulsive interactions between ‘Top’ - ‘Top’ pairs and ‘Top’ - ‘Bottom’ pairs. There are no
interactions between members of the same rigid body, but ARMs are not rigid and thus there are intra-subunit ARMARM interactions. Thus, for notational clarity, we index rigid bodies and non-rigid pseudoatoms in Roman, while the
pseudoatoms comprising a particular rigid body are indexed in Greek. For subunit i we denote its attractor positions
as {aiα } with the set comprising all attractors α, its ‘Top’ positions {tiα }, and its ‘Bottom’ positions {biα }. The
capsid subunit-subunit interaction potential between two subunits i and j is then defined as:

Ucc ({aiα }, {tiα }, {biα }, {ajβ }, {tjβ }, {bjβ }) =

Nt
X

εL (|tiα − tjβ | , σt )

α,β

+

NX
b ,Nt

εL (|biα − tjβ | , σb )

α,β

+

Na
X

εM (|aiα − ajβ | , r0 , %, rcut )

α,β

(3)
where ε is an adjustable parameter which both sets the strength of the capsid subunit-subunit attraction at each
attractor site and scales the repulsive interactions which enforce the dodecahedral geometry, Nt , Nb , and Na are
the number of ‘Top’, ‘Bottom’, and attractors pseudoatoms respectively in one subunit, σt and σb are the effective
diameters of the ‘Top’ - ‘Top’ interaction and ‘Bottom’ - ‘Top’ interaction, which are set to 10.5 nm and 9 nm,
respectively. r0 is the minimum energy attractor distance, set to 1 nm, % is a parameter determining the width of the
attractive interaction, set to 2.5, and rcut is the cutoff distance for the attractor potential set to 10 nm.
The function L is defined as the repulsive component of the Lennard-Jones potential shifted to zero at the interaction
diameter:
 12
σ
−1 :x<σ
x
(4)
L(x, σ) ≡
0
: otherwise
The function M is a Morse potential:
M(x, r0 , %) ≡





0

e



% 1− rx
0


−2 e



% 1− rx
0

− Vshift (rcut ) : x < rcut
: otherwise

(5)

19
with Vshift (rcut ) the value of the unshifted potential at rcut .
The capsid subunit-ARM interaction is composed of a short-range repulsion representing the excluded volume. For
subunit i with excluder positions {xiα } and ARM segment j with position Rj , the potential is:
Usa ({xiα }, Rj ) =

Nx
X

L (|xiα − Rj |, σxA )

(6)

α

σxa = 0.5(σx + σa ) is the effective diameter of the excluder-ARM repulsion with σa = 0.5 nm the diameter of an ARM
bead.
The interactions between polymer segments are defined as follows. Polymer segments which occupy adjacent
positions within a polymer chain experience only a harmonic potential Kbond which depends on bond distance. The
polymer-polymer non-bonded interaction is composed of electrostatic repulsion and short-ranged excluded volume
interactions, as well as an additional longer-range repulsion between PS segments added to prevent multiple PS
segments from occupying a single binding site. The potential between two polymer segments i and j is given by

Kbond (Rij , σp , kbond )
: {i, j} bonded
Upp (Ri , Rj , Rk ) =
(7)
L(Rij , σp ) + Ips (i)Ips (j)L(Rij , σps ) + UDH (Rij , qp , qp , σp ) : {i, j} nonbonded
where Rij ≡ |Ri − Rj | is the center-to-center distance between the polymer segments and σp = 0.5nm is the diameter
of a polymer segment. The harmonic bond pontential between sequential segments given by
Kbond (Rij , σ, kbond ) ≡

kbond
(Rij − σ)2 .
2

(8)

The function Ips (k) = 1 if segment i is a packaging site and 0 otherwise. This interaction term accounts for steric
interactions which inhibit multiple packaging sites from interacting with the same site on a capsid protein by adding
an additional repulsive interaction with effective diameter σps = 3nm. The final term in Eq. 7 is a Debye-Hückel
potential accounting for screened electrostatic interactions between polymer segments with valence charge qp = −1,
given by

 −r/λ 
D
q1 q2 lb λD eσ/λD
e

: r < 2λD


λD +σ
r
 −r/λ 
2
2
2
D
(rcut
−r 2 )2 (rcut
+2r 2 −3ron
)) q1 q2 lb λD eσ/λD
e
(9)
UDH (r, q1 , q2 , σ)/kB T ≡
: 2λD < r < 3λD
2 −2r 2 )3

λD +σ
r
(rcut
on


0
: otherwise
with λD as the Debye length, lb as the Bjerrum length, q1 and q2 as the valences of the interacting charges, and the
potential is smoothly switched to zero at the cutoff distance r=3λD .
The ARM-ARM interaction is similar to the polymer-polymer interaction, consisting of non-bonded interactions
composed of electrostatic repulsions and short-ranged excluded volume interactions, as well as bonded interactions
between sequential monomers in the ARM chain:

Uaa (Ri , Rj ) =

Kbond (Rij , σa , kbond )
: {i, j} bonded
L(Rij , σa ) + UDH (Rij , qi , qj , σa ) : {i, j} nonbonded

(10)

where Rij ≡ |Ri − Rj | is the center-to-center distance between the ARM subunits and qi is the valence of charge on
ARM segment i. For the simulations described in this work, qi = −1 for all ARM subunits.
The ARM-Polymer interaction is the sum of repulsive, short-ranged excluded volume interactions and electrostatic
interactions:
Upa (Ri , Rj ) = L(Rij , σap ) + UDH (Rij , qi , qj , σap )

(11)

with σap = 0.5nm.
The capsid subunit-polymer interaction is a short-ranged repulsion representing the excluded volume, with an
additional attractive interaction between the packaging site receptor (PSR) on the subunit and polymer segments
which are packaging sites (PS). For capsid subunit i with excluder positions {xiα } and PSR {ciα } and polymer
segment j with position Rj , the potential is:
Usp ({xiα }, Rj ) =

Nx
X
α

L (|xiα − Rj |, σxp ) + Ips (j)

Nc
X
α

εPS M (|ciα − Rj | , r0 , %, rcut )

(12)

20
where Nx is the number of excluders on a capsid subunit, Nc is the number of PSRs on a subunit, σxp = 0.5(σx + σp )
is the effective diameter of the excluder-polymer repulsion with σx = 3 nm and σp = 0.5 nm the respective diameters
of excluder and polymer beads. The Morse parameters used for the PS-PSR interaction are the same as used in the
the attractor-attractor interaction, except for εPS which is set at 5 or 20kB T , as discussed in the main text. Note
that the second term of equation 12 only applies to the polymer segments (j) which are PSs.

B.

Simulations

Trajectories are simulated using the Brownian Dynamics algorithm of HOOMD, which uses the Langevin equation
to calculate the time evolution of positions and rigid body orientations [68]. For each of our dynamical assembly
simulations, the box size = 200 × 200 × 200 nm. Except where mentioned otherwise, the box contained 60 subunits,
resulting in subunit concentration = 12µM. Assembly simulations were run at least 10 times for each parameter set,
and each were concluded at tend = 2 × 108 time steps. For each pseudoatom, γ was assigned as its effective interaction
diameter. VMD was used to visualize the model conformations [97]. We calculated the hydrodynamic radius RH
using HYDROPRO [91] as discussed in our previous work [44].

21
C.

Binding free energy estimates

B

0

-5

-10

-15
0

2
εps (kBT)

4

Frequency PS in Binding Site

A

PS Binding Free Energy (kBT)

We have previously calculated the free energy of subunit dimerization to be gss /kB T =5.0 − 1.5εss [19, 44]. Briefly,
simulations were set up with subunits which were limited to dimer formation, and the concentration of dimers was
measured for varying εss . The free energy of binding along that interface is then gss /kB T = − ln(css /Kd ) with standard
state concentration css = 1 M and Kd in molar units, and adjusted for the multiplicity of dimer conformations. The
reduction in gss due to electrostatic repulsion between ARMs is ∼ 0.5kB T at Csalt = 100mM.
We follow a similar strategy to calculate the binding free energy of the PS-PSR interaction. Here, we set up a
simplified system containing a single trimeric PSR, composed of the PSR from three subunits, as well as the ARM
and excluder pseudoatoms. The subunits (excepting the ARMs) are immobilized to prevent dissassembly. We then
measured the relative concentration of PS bound and unbound states for a range of attraction strengths (εPS ). The free
energy of binding along that interface is then gPS /kB T = − ln(css /Kd ) with standard state concentration css = 1 M
and Kd in molar units. At Csalt = 100mM, the free energy is well fit by the linear expression gss /kB T = −1.3εss − T sb
where T sb = 2.3kB T (Fig. S1A). By this estimate our LA PS (εPS = 5kB T ) has KD ∼ µM. Note that this is the
free energy of the PS binding to a complete, trimeric binding site; however, in many of our assembly simulations, the
subunits do not form stable trimers without the PS. Therefore the PS-PSR interactions that occur during assembly
often involve only one or two PSRs and non-optimal geometries.
Fig. S1B shows data from two related sets of simulations in which we measure the fraction of time a PS binds to
PSRs in systems which contain a full length polyelectrolyte (575 segments at Csalt = 100mM) and 12 subunits. In
one case the 12 subunits are assembled into a complete capsid while in the other the subunits are adsorbed onto the
polyelectrolyte but unassembled (εss was set to zero)., either as a completed capsid or unassembled, adsorbed subunits.
Interestingly, while both curves are sigmoidal in shape, at binding strengths comparable to our LA PS (εPS = 5kB T )
PSs within complete capsids are nearly always bound to PSRs whereas they spend less than half their time bound to
unassembled subunits. This difference arises because PSRs have ideal geometries within a capsid but are disordered
in the unassembled subunits. Note that the binding probabilities measured in these simulations reflect a partitioning
of PSs between specific binding to PSRs and nonspecific binding to subunit ARMs through electrostatics, whereas
the free energies calculated in Fig. S1A reflect the partitioning between PSRs and solution.

1

0.5

Assembled Capsid
Unassembled Subunits

0
0

5

10
15
εps (kBT)

20

FIG. S1. (A) Free energy of PS binding to a single complete, trimeric PSR binding site, as a function of PS-PRS interaction
well depth εPS . The symbols indicate measured data points and the line shows a linear fit. (B) Fraction of time a PS is
bound to PSRs as a function of εPS , measured within an assembled capsid ( symbols) and in the presence of 12 adsorbed but
unassembled subunits (• symbols). The polymer has 575 segments with one PS and Csalt = 100mM.

22
SII.
A.

ADDITIONAL RESULTS AND ANALYSIS

Effect of a single PS on assembly dynamics and specificity

The fact that a single high affinity PS within a viral genome could promote specificity by functioning as a nucleation
site has been considered for several decades (e.g. [31])and the specificity conferred by a single PS was examined by in
vitro experiments in which two species of heterologous RNA competed, one of which contained a single high affinity
PS [31]. These experiments identified modest selectivity (∼ 2/3) for the RNA with one PS. To evaluate our results
in the context of that experiment and to more broadly understand the limits of selectivity conferred by a single PS,
we present simulations comparing non-cognate assembly with RNA containing a single HA PS located in the center
of the polymer (as is the case for r17/MS2 [31]). We consider assembly at two salt concentrations (I = 100, 500mM )
in order to describe the effect of a PS under strong and weak electrostatic interactions respectively. For each salt
concentration, we consider a range of subunit-subunit attraction strengths (εss /kB T ∈ [2, 5] for Csalt = 100mM and
(εss /kB T = 6, 7 for Csalt = 500mM) over which assembly yields in the presence of the non-cognate RNA alone vary
from zero to high (see Fig. 2). In the limit of low εss we observe disordered aggregates (Csalt = 100mM, εss = 2kB T )
or failure to nucleate (Csalt = 500mM, εss = 6kB T ) around the non-cognate RNA. The setup for these simulations is
the same as for simulations presented in the main text.
In Fig. S2 the average size of the largest cluster of subunits is plotted as a function of time. For the parameters
in which the non-cognate RNA triggers rapid assembly (Csalt = 100mM, εss = 4, 5kB T ) incorporation of the PS does
not substantially alter the time course of assembly. For cases in which assembly around the non-cognate RNA is slow
(Csalt = 100mM, εss = 3kB T and Csalt = 500mM, εss = 7kB T ), the PS increases the assembly rate although longtime yields are similar. For cases in which the non-cognate RNA leads to no assembly on the investigated timescale
(Csalt = 100mM, εss = 2kB T and Csalt = 500mM, εss = 6kB T ), the presence of a single PS increases the extent of
assembly, but complete capsids do not form in the timescale considered here. As seen in Fig. 4, additional PS are
needed to induce efficient assembly at these parameters.
Figure S2G shows the assembly yields around a single RNA with and without the PS for Csalt = 100mM . 20
simulations were run for each parameter value. As discussed above, for Csalt = 100mM, εss = 5kB T assembly is
robust without PS, and the effect of the PS on assembly is slight, while at εss = 3, 4kB T the increase in yield due
to the PS is moderate. At εss = 2kB T the presence of a single PS is not enough to allow for successful assembly
and disordered aggregates are observed. In Figure S2H we compare the selectivity predicted by Eq. 1 (using the
data from Fig. S2A-G) against the results of explicit competition simulations. In these competition simulations,
there are 60 subunits, one RNA containing a HA PS and one non-cognate RNA (thus rex = 1). We find that the
predicted selectivities match those from the explicit competition simulations quite closely, especially considering the
limited number of independent simulations. Moreover, the finding that about 2/3 of the assembled capsids contain the
PS-RNA roughly agrees with the experimental observations of Beckett et al. [31], in which incorporation of a single
high affinity PS led to ∼ 2/3 selectivity under conditions where assembly around heterologous RNA was efficient.

23

8
4
PS
No PS

0
0

C
Average Cluster Size

B

1e+08
Timesteps

8
4
0
1e+08
Timesteps

E

8
4
PS
No PS

0
0

D

PS
No PS

0

12

2e+08

εss=3kBT, Csalt=100mM
12

εss=4kBT, Csalt=100mM
Average Cluster Size

εss=5kBT, Csalt=100mM
12

12
8
4
0

2e+08

0

3e+08

PS
No PS

0.5

0
2

3
4
εss (kBT)

5

12

PS
No PS

8
4
0
0

H

Csalt=100mM
1

Yield

Average Cluster Size

0

PS Selection Frequency

Average Cluster Size

4

G

2e+08

εss=6kBT, Csalt=500mM

8

1e+08 2e+08
Timesteps

1e+08
Timesteps

F

PS
No PS

0

2e+08

PS
No PS

εss=7kBT, Csalt=500mM
12

1e+08
Timesteps

εss=2kBT, Csalt=100mM
Average Cluster Size

Average Cluster Size

A

1e+08 2e+08
Timesteps

3e+08

Csalt=100mM, 1:1 Competition
Prediction
Result

1
0.75
0.5
0.25
0
3

4
εss (kBT)

5

FIG. S2. (A-F) Average cluster size as a function of simulation timestep with and without a single HA PS for varying salt
concentration and subunit-subunit attraction. These results are the average of ten independent assembly simulations, each run
using a single substrate and subunits at a concentration of 12 µM. (G) Yield of complete capsids from assembly simulations
around a single non-cognate RNA or an RNA containing one HA PS, at several values of εss and Csalt = 100mM . (H)
Comparison between specificity observed in explicit competition simulations and predicted by Eq. eq:P1. The competition
simulations each contained one non-cognate RNA, one cognate RNA containing one HA PS, and 60 subunits. The predictions
use data from (A-G).

B.

Capsid and RNA subunit paths and conformational dynamics

It has been proposed that PSs increase assembly rates by reducing the diversity of assembly pathways; essentially
eliminating ‘dead end’ pathways. To characterize the relationship between PSs and the ensemble of assembly pathways
generated by our model, we evaluated the effects of PSs on the diversity of assembly intermediates, both from the
perspective of arrangements of subunits in interacting clusters and RNA conformations.

24
1.

Partial capsid intermediate geometries

We used two approaches to characterize the diversity of capsid intermediate geometries generated during assembly
trajectories. In the first, we calculated the fraction of lowest-energy intermediates (a lowest energy intermediate
contains the maximum possible number of subunit-subunit interactions for its size) for clusters with 3 − 11 subunits.
In the second, we categorized system configurations according to: the number of clusters, the number of subunits in
each cluster,
P and the number of bonds in each cluster. We then calculated the entropy S of the distribution according
to S = − ν ρν log ρν with ρν the relative probability of configuration ν.

0.2
2

0
300

400

8

D

0.8
6
0.6
0.4
4
0.2
2

0
200

300

400

2.5
4

2

0
100

1

100

6

500

Salt Concentration

Fraction of Optimal Clusters

Subunit-Subunit Interactions (kT)

200

5

400

500
5

6
2.5
4

2

0
100

200

300

400

500

Salt Concentration

εss=2kBT Csalt=100mM

F
Distributional Entropy

Fraction of Optimal Clusters

0.8
0.6
0.4
0.2
0

εss=2kBT Csalt=100mM
5
4
3
2
1
0

10
20
30
Number of PS, NPS

40

εss=6kBT Csalt=500mM

0

H

1

Distributional Entropy

Fraction of Optimal Clusters

300

8

500

1

0

G

200

Salt Concentration

Salt Concentration

E

Distributional Entropy

0.4
4

8

Distributional Entropy

0.6

Fraction of Optimal Clusters

0.8
6

100

C

B

1

Subunit-Subunit Interactions (kT)

8

Subunit-Subunit Interactions (kT)

Subunit-Subunit Interactions (kT)

A

0.8
0.6
0.4
0.2
0

10
20
30
Number of PS, NPS

40

εss=6kBT Csalt=500mM
5
4
3
2
1
0

0

10
20
30
Number of PS, NPS

40

0

10
20
30
Number of PS, NPS

40

FIG. S3. The fraction of assembly intermediates which contain the maximum number of subunit-subunit bonds ((A,C,E,G)
) and the entropy of the distribution of intermediate configurations ((B,D,F,H) ). Results are shown as a function of εss and
Csalt for a non-cognate RNA (A,B) and the Combo PS sequence (C,D) . Results are shown as a function of the number of PSs
NPS , with εss = 2kB T and Csalt = 100mM (E,F) and εss = 6kB T and Csalt = 500mM (G,H) . In (E-H) the RNA contained
either NPS HA PSs (• symbols) or 1 HA PS and NPS LA PSs (N symbols). Results for the non-cognate RNA (no PSs) are
indicated by  symbols.

Fig. S3A,B shows the results for non-cognate RNA assembly, as a function of salt concentration and subunit-subunit
interaction. We see that weak subunit-subunit interactions and high salt concentrations lead to a high fraction of
optimal intermediate geometries and consequently a low entropy of the distribution of intermediate configurations.
As εss increases or Csalt decreases the distribution of intermediate configurations widens, indicating more diverse

25
assembly pathways. The results are consistent with a previous study of uniform polyelectrolytes [44], in which we
found that high salt and moderate subunit-subunit interactions lead to an ‘ordered’ nucleation-and-growth assembly
which proceeds through a series of well-formed intermediates. Stronger interactions (either electrostatic or subunitsubunit) tend to promote the formation of multiple clusters and stabilize non-optimal configurations.
The results with the Combo PS sequence (Fig. S3C,D) show that PSs tend to increase the diversity of intermediate
configurations and prevalence of non-optimal cluster geometries. The effect is particularly noticeable under conditions
where the underlying interactions are weak (high salt, low εss ). Although the results as a function of varying NPS
(Fig. S3E-H) are noisy, we generally observe an increase in the width of the distribution and more non-optimal clusters
as more PSs are added, and the HA PSs have a stronger effect than the LA PSs.
In contrast to the general observation that adding PSs leads to a wider diversity of intermediate geometries, we
find that PSs narrow the distribution of intermediate geometries under parameters where electrostatics and subunitsubunit interactions are both strong (e.g. Csalt = 50mM, εss = 7kB T ). This effect is significant; as discussed in
the main text (section IV), PSs increase assembly yields in this regime even though the nonspecific interactions are
sufficiently strong to promote assembly (Fig. 2). To clarify the mechanism by which PSs influence pathways in this
regime, we separately characterized their effect on intermediate geometries and distribution of intermediates. In
particular, we calculate the average deviation from the ground state for clusters with n subunits, given by [65]
h∆B(n)i(n) = hδn(c),n [B gs (n) − B(c)]ic .

(13)

where B(c) is the number of subunit-subunit interactions for configuration c, n(c) is the number of subunits in
configuration c, B gs (n) is the number of bonds in the minimum-energy configuration of n subunits, and the average
is taken over all configurations weighted by their frequency of appearance in assembly trajectories. The quantity
h∆B(n)i is shown as a function of intermediate size in Fig. S4A for a non-cognate RNA and the Combo PS sequence.
We see that the PSs increase the frequency of deviations from the ground state cluster, consistent with other regions
of parameter space. However, the average number of clusters (Fig. S4B) significantly decreases in the presence of
PSs. We find that the HA PS in the Combo sequence promotes rapid nucleation of a partial capsid, which tends to
complete assembly before other nucleation events occur. In contrast, multiple nucleation events are common on the
uniform polyelectrolytes. As noted in the main text, avoiding multiple nucleation events appears to be the mechanism
by which PSs increase yields and confer specificity in this regime of relatively strong nonspecific interactions.
No PS
PS

2
Average Number of Clusters

3

<∆B(n)>

2

1

0

No PS
PS

1.5

1
4
6
8
10
Intermediate Size, n

4
6
8
10
Intermediate Size, n

FIG. S4. bf (A) Average deviation in number of interactions h∆B(n)i from the ground state configuration as a function of
intermediate size n, averaged over assembly trajectories with a uniform polyelectrolyte (• symbols) or the Combo PS sequence
( symbols). (B) Number of clusters as a function of intermediate size n averaged over assembly trajectories. Simulation
parameters were Csalt = 50mM, εss = 7kB T , with the cognate RNA containing the Combo PS sequence 1 HA PS + 25 LA PS.

2.

RNA conformational statistics and dynamics

To simplify characterization of the ensemble of RNA conformations and its dynamics, we categorize RNA conformations according to the sequence of capsid vertices with which the substrate interacts. This definition neglects
fluctuations of RNA segments between vertices, and thus most closely reflects RNA conformations in simulations with
high salt, large εPS , and NPS ≈ 20, for which the PS-PSR binding is the dominant interaction. Under parameters
with fewer PSs and stronger electrostatics, although we observe enhanced polyelectrolyte density in the vicinity of
capsid vertices [19], this definition does not completely reflect the diversity of RNA configurations.

26

A

Preassembled Capsid Examples

Unique Paths

Non-cognate

2000 1 HA + 10 LA PS

20 HA PS

1000
0

Unique Paths

Clustersize

B

0

1000
2000
Timeframes (105 Timesteps)
Capsid Assembly Examples

12
8
Non-cognate
1 HA + 10 LA PS
20 HA PS

4
0
1000

Non-cognate
1 HA + 10 LA PS
20 HA PS

500
0

0

1000
Timeframes (105 Timesteps)

2000

FIG. S5. Examples showing RNA path exploration within preassembled capsids (A) and for assembly simulations (B). At each
step we determine the polymer path, and if unique assign it a new index. For the Non-cognate and ‘1 HA + 10 LA PS’ cases,
a unique path occurs at nearly every frame, whereas the ‘20 HA PS’ case is limited to a very small set of paths. We observe
that this restriction in RNA dynamics corresponds with stalled assembly. These simulations are run at Csalt = 100mM , and
εss = 5kB T for the non-cognate or εss = 2kB T for the PS containing polymers.

Fig. S5 shows the frequency with which new RNA conformations (according to the above definition) are generated during simulations of RNA within a completely assembled capsid (Fig. S5A) and within an assembling capsid
(Fig. S5B). For the non-cognate and LA PS cognate sequences, the RNA adopts a new path at almost every window,
while the RNA with 20 HA PSs undergoes restricted dynamics, rarely transitioning to a new conformation. Comparison of Fig. S5 and Fig. 4 suggests that frozen RNA dynamics tend to give rise to stalled assembly trajectories;
indeed, assembly stalls at 10 subunits for the 20 HA PS sequence (Fig. S5B upper frame). These simulations are run
at Csalt = 100mM.
Previous simulations suggested that polymer-mediated capsid assembly is enhanced by cooperative polymer-subunit
motions and by ‘sliding’ of adsorbed subunits along the polymer [42, 43, 95]. To evaluate the extent to which adsorbed
subunits can rearrange, in Figure S6 we quantify the average residence time for the PS-PSR interaction (PS) and the
Polyelectrolyte-ARM interaction (PE) within a completed capsid for a polymer with a varying number of HA or LA
PS (εPS = 20, 5kB T ). As expected, PS exchange is slow in comparison to exchange of PE interactions, with exchange
of HA PSs significantly slower than exchange of LA PSs. (For HA PSs, exchange often occurs on longer timescales
than our simulation times.) However, excess PSs (NPS > 20) appear to facilitate exchange.
In the second row of Figure S6 we quantify the root mean squared fluctuations (RMSF) of the RNA within the
capsid. We observe that increasing the number of PSs reduces the overall RNA dynamics. However, introduction of
excess LA PSs leads to a rebound in the dynamics, further emphasizing the relationship between excess PSs and RNA
rearrangements. In the third row, we quantify the average duration of paths within the capsid, which emphasizes the
restriction of dynamics at NPS = 20 HA PS.
It is interesting to compare these different measures of dynamics in Figure S6. For example, the first and third
rows indicate an increase in dynamics for NPS > 20, however this is not captured by the RMSF. We infer that the
exchange of HA PS, even at excess NPS , is a slower process, and thus their effect is obscured by other measures of
RNA dynamics. However, this slow motion is still functionally relevant, as observed in the increase in yield with
increasing HA NPS .

Residence Time (Timesteps)

27
Csalt=100mM, HA PS
1e8

Csalt=500mM, HA PS

PS
PE

RMSF

Csalt=500mM, LA PS

PS
PE

PS
PE

1e7
1e6
1e5
0

10

20
NPS

30

40 0

Csalt=100mM, HA PS

10

20
NPS

30

40

0

Csalt=500mM, HA PS

10

20
NPS

30

40 0

Csalt=100mM, LA PS

10

20
NPS

30

40

Csalt=500mM, LA PS

30
25
20
15
10
5
0
0

Path Duration (Timeframes)

Csalt=100mM, LA PS

PS
PE

10

20
NPS

30

40 0

Csalt=100mM, HA PS

10

20
NPS

30

40

0

Csalt=500mM, HA PS

10

20
NPS

30

40 0

Csalt=100mM, LA PS

10

20
NPS

30

40

Csalt=500mM, LA PS

20
15
10
5
0
0

10

20
NPS

30

40 0

10

20
NPS

30

40

0

10

20
NPS

30

40 0

10

20
NPS

30

40

FIG. S6. Different measures of RNA dynamics within an assembled capsid. The first row presents the average residence time
for PS-binding site interactions and Polyelectrolyte-ARM interactions. The second row presents the average root mean squared
fluctuations (averaged over time and RNA segments). The third row presents the average duration of RNA paths. These
simulations are performed for a preassembled capsid containing a single RNA of optimal length with the specified NPS , with
εPS = 20kB T for HA PS and εPS = 50kB T for LA PS.

C.

Effect of PS on equilibrium encapsidation and substrate length

In this section we describe the effect of PSs on the thermodynamically optimal RNA length for encapsidation L∗eq ,
defined as the length which minimizes the free energy of the RNA-capsid complex [19]. We found previously that L∗eq
corresponds to the length which optimizes finite-time assembly yields, at least within measured parameter ranges [19].
We also found that, when the model was adapted to match features of specific viruses, namely the interior volume
of the capsid and the length and charge of the ARM amino acids, the calculated values of L∗eq closely agree with the
genome length for those viruses when effects of base pairing were included in the model [19].
Here, we present the effect of PSs on L∗eq . We calculate L∗eq using the same protocol as in [19, 44]; a very long RNA
strand is placed in a preassembled capsid, with a small section of the capsid rendered permeable to the RNA. We then
perform dynamics during which the RNA rearranges within the capsid and partially extrudes from the permeable
section of the capsid. Once the system has equilibrated, L∗eq is calculated as the average number of RNA segments
remaining within the capsid, measured over a period of (5 ∗ 107 timesteps). Values of L∗eq measured by this protocol
were found to closely agree with the values which minimized the free energy calculated using the Widom test-particle
method [71] as extended to calculate polymer residual chemical potentials [19, 42, 72].
The dependence of L∗eq on the PS-PSR binding strength εPS is shown in Fig. S7 for RNA with varying numbers
of PSs. We report the frequency of PSs, defined as the number of polyelectrolyte segments between each PS (which
are uniformly spaced), since the number of encapsidated PSs can depend on L∗eq . We see that, while a single PS has
essentially no effect on L∗eq , increasing the PS strength and frequency can significantly increase L∗eq . Note that since
the single PS has essentially no effect on L∗eq , the optimal length for the Combo sequence with 1 HA PS and 25 LA
PSs is approximately 628 (relative to 575 for the noncognate).
We previously found that dynamical assembly of complete capsids around uniform polyelectrolytes occurs only for
polyelectrolyte lengths within about 10% of L∗eq . In Fig. S8 we show the yield of well-formed capsids at the end of
long but finite-time dynamical simulations for uniform polyelectrolyte and the Combo PS sequence. We see that the
PSs slightly increase the optimal length, to approximately the same value as the thermodynamic L∗eq . While the
distribution of yields as a function of polyelectrolyte lengths is slightly broader for the PS sequence than the uniform
polyelectrolyte, variations are still limited to ∼ 10%. This result corroborates the observation of Fig. S7, that the
increase in L∗eq for the LA PSs is relatively small, suggesting that the optimal RNA length does not differ significantly
between non-cognate and cognate RNAs. This result is consistent with the observation values of L∗eq from a model

28

B

1.8

540

1.4

420

3.0

*

Debye-Huckel
Explicit Ions
Explicit, 5mM Divalent

1

Optimal Charge Ratio

660

2.5

750

2.0

600

300
500

100
300
Ionic Strength (mM)

900

PS Spacing=25
PS Spacing=50
PS Spacing=100
PS Spacing=250
Single PS
No PS

Optimal Length (L*eq)

2.2

Optimal Length (L eq)

Optimal Charge Ratio

A

5
10
15
PS Strength (kBT)

20

FIG. S7. (A) The thermodynamic optimal RNA length L∗eq is shown as a function of Csalt with monovalent salt for a uniform
polyelectrolyte (the non-cognate RNA). (B) Dependence of L∗eq on PS-PSR binding strength εPS , for RNAs with uniformly
spaced PSs, with indicated numbers of RNA segments between each PS. The salt concentration is Csalt = 100mM.

which did not account for PSs agreed with actual genome lengths.
1

0.8

Yield

0.6

0.4

0.2

0
500

550

600

650

700

Polymer Length

FIG. S8. Yield of well-formed capsids in dynamical assembly simulations as a function of length of a polyelectrolyte with no
PSs (• symbols) or 1 HA + 20 LA PSs ( symbols). Parameters are εss = 5kB T for the uniform polyelectrolyte, εss = 2kB T
for the PS sequence, and Csalt = 100mM in both cases.

D.

Dependence of RNA path properties on ARM length

Previous simulations showed that L∗eq depends on charge and excluded volume of the capsid, as determined by the
ARM charge, ARM length and capsid interior volume [19]. Here we present results from simulations of complete
capsids with varying ARM charge, encapsidating RNA with NPS = 20 LA PS. The ARM charge determines the
optimal length of the substrate [19], which determines the spacing between the PS and the geometry of the path
within the capsid. Figure S9 is a histogram showing the distribution of step lengths for the polymer path (sec SII B);
i.e. a step length of 1 corresponds to stepping to a nearest neighbor vertex, while a step of length 2 corresponds to
skipping one vertex. Interestingly, this distribution behaves non-monotonically; for short ARMs (2, 3) stepping to
the nearest neighbor is strongly favored, for ARM = 4 there is a clear shift towards a separation of 2, which then is
reversed for ARM = 5. Our analysis here suggests that the structure of the capsid protein-substrate complex and
the ability of the substrate to promote assembly is determined by many factors, including the capsid geometry and
charge, substrate length and charge, and PS number, strength, and spacing.

29

Frequency

1

ARM=2
ARM=3
ARM=4
ARM=5

0.5

0
1

2
3
Path Step Length

4

FIG. S9. Histogram describing the conformation of encapsidated RNA with NPS = 20 PSs for varying ARM lengths. Here
the X-axis is distance between vertices traced in the polymer path; a step length of 1 indicates a step to a nearest-neighbor
vertex, while a step length of 2 indicates a step which skips a vertex. For each ARM length, the optimal RNA length was
used: ARM=2: 350 segments, ARM=3: 428 segments, ARM=4: 504 segments, ARM=5: 575 segments. This changes the PS
spacing, and the frequency of step length.

E.

Simulation Movies

Movie 1 - Direct competition simulation between a noncognate (red) and cognate (magenta) with one HA PS.
Simulation conditions: Csalt = 100mM, εss = 5kB T, rex = 1, excess subunits.
Movie 2 - Direct competition simulation between a noncognate (red) and cognate (magenta) using the ‘Combo’ PS
sequence NPS = 20. Simulation conditions: Csalt = 100mM, εss = 2kB T, rex = 1, excess subunits.
Movie 3 - Direct competition simulation between a noncognate (red) and cognate (magenta) using the ‘Combo’ PS
sequence NPS = 30. Simulation conditions: Csalt = 500mM, εss = 6kB T, rex = 1, limiting subunits.

