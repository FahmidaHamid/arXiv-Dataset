Control of the repetitive firing in the squid giant
axon using electrical fields

arXiv:1103.3886v1 [q-bio.NC] 20 Mar 2011

R. Ozgur Doruk
March 22, 2011
Middle East Technical University – North Cyprus Campus, Kalkanlı, Güzelyurt,
Mersin 10, TURKEY (TR) e – mail: rdoruk@metu.edu.tr
Abstract
In this research, the aim is to develop a repetitive firing stopper mechanism
using electrical fields exerted on the fiber. The Hodgkin – Huxley nerve
fiber model is used for modeling the membrane potential behavior. The
repetitive firing of the nerve fiber can be stopped using approaches based
on the control theory where the nonlinear Hodgkin – Huxley model is used
to achieve this goal. The effects of the electrical field are considered as
an additive quantity over the equilibrium potentials of the cell membrane
channels
Keywords: Squid Giant Axon, Hodgkin - Huxley Model, Electrical Field
Stimulation, Bifurcation, Washout Filter, Projective Control

1

Introduction

The repetitive firing of the nerve fibers in the living beings is an important
subject of the biophysical research since the phenomenon has various meanings.
It may have a role in several diseases like epilepsy [Pellock et.al (2001)] but
have also a role in the formation of heart beats where the oscillation frequency
is in fact represents the heart rate. The Hodgkin – Huxley nerve fiber model
[Hodgkin et.al (1952)] provides a very useful framework for simulation based
neurophysiologic studies where the variation of the membrane potential is modeled basically as a fourth order nonlinear differential equation. The basic model
in [Hodgkin et.al (1952)] allows the external current injection as the system input whereas an additional cell membrane potential can also be considered as an
input which is the case in [Wang et.al. (2004)]. The electrical fields around the
nerve cell membranes can induce small electric potentials which may lead to different behaviors as stated in [Wang et.al. (2004), Kotnik et.al (1998)] however
the potential induction mechanism can also be used as a repetitive firing control
mechanism which is the main point of this research. The repetitive firing condition on the Hodgkin – Huxley nerve fiber model is detected using a bifurcation
discovery tool like MATCONT [Dhooge et.al. (2003)] and the washout filter
[Hassouneh et.al. (2004), Wang et.al. (2000)] and projective control [Medanic
1

(1978)] is integrated to derive a membrane additive voltage profile. This voltage
profile is converted into an electrical field requirement profile using an approach
derived from [Kotnik et.al. (1998)]. Using electrical energy in treatment of neurological disorders is a wide part of neurophysiology research where one of the
most prominent applications is the deep brain stimulation which is used in the
treatment of Parkinson’s disease [Moro et.al. (2006)] and depression [Mayberg
et.al. (2005)]. The mechanism is that a device implanted in the brain tissue
sending electrical pulses to the brain. This can be taught as a current injection
system whereas in this research the mechanism of electric field induction is used
to obtain a response from the neurological tissue. The research can be a base
point for further advancements in electrical field stimulation of the central nervous system. Using electrical energy in treatment of neurological disorders is a
wide part of neurophysiology research where one of the most prominent applications is the deep brain stimulation which is used in the treatment of Parkinson’s
disease [Moro et.al. (2006)] and depression [Mayberg et.al. (2005)]. The mechanism is that a device implanted in the brain tissue sending electrical pulses
to the brain. This can be taught as a current injection system whereas in this
research the mechanism of electric field induction is used to obtain a response
from the neurological tissue. The research can be a base point for further advancements in electrical field stimulation of the central nervous system. In this
paper, first of all the Hodgkin – Huxley model of nerve fibers together with the
electrical field effects are reviewed and then the methods of projective control
theory and washout filters are presented. Next the approach of this research is
described in detail.

2

Materials and Methods

2.1

Hodgkin Huxley Model and Electrical Field Interaction

Hodgkin – Huxley model nerve fiber dynamics [Hodgkin et.al. (1952)] is a fourth
order differential equation derived for modeling the behavior of the membrane
potential as shown below:
Cm

dV
dt

=

−gN a m3 h (V − VN a ) − gK n4 (V − VK ) − gL (V − VL ) + Iext
(2.1)
dn
= αn (1 − n) − βn n
dt
dm
= αm (1 − m) − βm m
dt
dh
= αh (1 − h) − βh h
dt


0.1 − 0.01V
V
αn =
, βn = 0.125exp −
exp (1 − 0.1V ) − 1
80
2

αm



2.5 − 0.1V
V
=
, βm = 4exp −
exp (2.5 − 0.1V ) − 1
18



V
1
αh = 0.07exp −
, βh =
20
exp (3 − 0.1V ) − 1
The definitions of the parameters are:
V: the displacement of the cell membrane potential from its resting value in mV
n : is a dimensional variable which can vary between 0 and 1 representing the
proportion of activating molecules of the potassium channel
m : same type of variable as n which represents the proportion of the activating
molecules of the sodium channel
h : same type of variable as n which represents the proportion of the inactivating
molecules of the sodium channel
Iext : external current injection in

µA
cm2

gN a : sodium channel conductance in

mS
cm2

gK : potassium channel conductance in

mS
cm2

mS
gL : leakage conductance in cm
2 due to the chloride and other ions which leads
to a leaking current flow. Because of that the behaviour is modeled as a conductance.

Cm : membrane capacitance in

µF
cm2

VN a : sodium channel resting potential in mV
VK : potassium channel resting potential in mV
VL : the level of potential where the leakage current reduces to zero
In the experimentation performed by Alan Hodgkin and his colleagues the nominal values determined are:
mS
gN a = 36 2
(2.2)
cm
gK = 120
gL = 0.3

mS
cm2

mS
cm2

VK = −12mV
VN a = 115mV
VL = 10.613mV
Cm = 0.91

3

µF
cm2

In this work the external current injection is set to zero by default. It is to
be used as an external stimulus for stabilizing the neuron with the washout
filter. The external effect input to the model in our case is the external voltage
induction on the cell membrane by the electric fields which is added to (2.1) as:
Cm

dV
dt

= −gN a m3 h (V + VE − VN a ) − gK n4 (V + VE − VK ) − gL (V + VE − VL ) +(2.3)
Iext
dn
= αn (1 − n) − βn n
dt
dm
= αm (1 − m) − βm m
dt
dh
= αh (1 − h) − βh h
dt


V
0.1 − 0.01V
, βn = 0.125exp −
exp (1 − 0.1V ) − 1
80


2.5 − 0.1V
V
αm =
, βm = 4exp −
exp (2.5 − 0.1V ) − 1
18


1
V
, βh =
αh = 0.07exp −
20
exp (3 − 0.1V ) − 1

αn =

The term VE is the potential induced on the cell membrane by any external effect
which is the electrical field in this case. If this is due to a time varying electrical
field relationship between VE and the exerting electrical field E is obtained from
the solution of Laplace’s partial differential equation which is used by [Kotnik,
1998] to obtain the following:
VE = F (s) E (s) Rcos (θ)

(2.4)

where E (s) is the electrical field time course defined in the Laplace domain, R
is the radius of the cell soma and θ is the directional angle of the electrical field
exerted upon the nerve fibers. Finally F (s) is the transfer function defined as:
F (s) =

a1 s2 + a2 s + a3
b1 s2 + b2 s + b3

(2.5)

with its coefficients:


a1 = 3dλo λi 3R2 − 3dR + d2 + λm 3dR
− d2


2
a2 = 3d (λi εo + λo εi ) 3R2 − 3dR
+ d2 + (λm ε
o + λo εm ) 3dR − d

a3 = 3dεo εi 3R2 − 3dR + d2 + εm 3dR − d2

3
b1 = 2R3 (λm + 2λo ) λm + 12 λi + 2 (R − d) (λm − λo ) (λi − λm )



3
b2 = 2R3 λi 12 εm + εo + λm 12 εi + 2εm + 2εo + λo (εi + 2εm ) + 2 (R − d)
× (λi (εm − εo ) + λm (εi − 2εm + εo ) − λo (εi − εm ))

3
b3 = 2R3 (εm + 2εo ) εm + 21 εi + 2 (R − d) (εm − εo ) (εi − εm )
(2.6)
4

The parameters of (2.6) are defined in the following table in reference to [Kotnik,
1998]:
Table 1: The values of electrical parameters for the considered cell membrane
(values are from Kotnik et.al)
Parameter
Definition
Value
λi
Cytoplasmic conductivity
0.3 S · m−1
εi
Cytoplasmic permittivity
7.1 · 10−10 A · s · V −1 · m−1
λm
Membrane conductivity
3 · 10−7 S · m−1
εm
Membrane permittivity
4.4 · 10−11 A · s · V −1 · m−1
λo
Extracellular medium conductivity
3 · 10−1 S · m−1
εo
Extracellular medium permittivity 7.1 · 10−10 A · s · V −1 · m−1
R
Cell soma radius
10 µm
d
Membrane thickness
5 nm
The relation in (2.4) is derived using admittivity operators. The details of
derivations are given in the relevant research [Kotnik et.al. (1998)]. In order to
obtain the level of electric field required for the intended operation the following
can be derived:
E (s) =

1
Φ (s) VE
R cos (θ)

(2.7)

Φ (s) =

b1 s2 + b2 s + b3
a1 s2 + a2 s + a3

(2.8)

where,

The above can be written since the order of the numerator and denominator in
(2.5) is same where the inversion does not change the properness of the function.
For maximum efficiency the directional angle of the field θ should be zero.

2.2

Projective Control Theory

The projective control approach is a linear control methodology that derives an
output feedback controller from a full state feedback design. The transformation from the full state feedback to the output feedback is performed through
the orthogonal projection which operates on the closed loop eigenspectrum of
the full state feedback design. Before going into the detail of the projective
control approach a review of full state feedback control approach is given for
convenience. Consider a linear system depicted by:
ẋ = Ax + Bu
where

x ∈ Rn , u ∈ Rm , A ∈ Rn×n , B ∈ Rn×m
5

(2.9)

If one designs a full state feedback controller as
u = −Kx
the closed loop dynamics is now
ẋ = (A − BK) x
The eigenspectrum of this closed loop dynamics is defined by the equation shown
below:
(A − BK) V = VΛ

(2.10)

whereΛ is the diagonal matrix with the entries of eigenvalues of the closed loop
dynamics ( or the eigenvalues of A−BK ) and is the matrix of the corresponding
eigenvectors. If one is thinking of making a static output feedback from y = Cx
(C ∈ Rq×n , y ∈ Rq ) as u = −Ko y = −Ko Cx . If this feedback is assumed to
retain q eigenvalues out of Λ (denote this as Λq and corresponding eigenvectors
from V as Vq ) the following should also be written:
(A − BKC) Vq = Vq Λq

(2.11)

Combining (2.10) and (2.11) the following can be written:
(A − BK) V = (A − BKo C) Vq
This allows one to solve for
Ko
as:
−1

Ko = KVq (CVq )

(2.12)

For the nonlinear systems the model should be linearized using the Jacobian (or
the Taylor series).

2.3

Linearization and Bifurcation

As it is just stated the projective control approach requires linearization of the
nonlinear model. For the case of a standard nonlinear system representation
like ẋ = f (x, u) the following equations are written:
ẋ = Ax + Bu + H (x, u)

∂f 
A=
∂x x=x0

∂f 
B=
∂u u=u0
6

(2.13)

where x ∈ Rn is the state of the system, u ∈ Rm is the input and H (x, u) is the
higher order nonlinear terms and x0 is the equilibrium point. The eigenvalues
of the matrix characterizes the stability of x0 . If the instability of the system
(2.13) is due to a single pair of complex conjugate eigenvalues the resultant event
is called as Hopf bifurcation. On the other hand if there is a pair of eigenvalues
with the same values and opposite signs the resultant issue is called as the saddle
node bifurcation. For the Hodgkin – Huxley model the repetitive firing in non
– stimulated (current or other external effects) is a result of the bifurcation
phenomenon. The bifurcation characteristics of the system can be changed by
using specially designed controllers. However, many of the controllers lead to a
change in the position of the equilibrium point. This is not a problem in general
but if the equilibrium point should not be changed one has to incorporate a
washout filter which blocks the steady state (DC) inputs to the system. The
washout filter itself is a linear high – pass filter which can be mathematically
defined as shown below:
ż = Aw z + Bw ξ

(2.14)

ψ = Aw z + Bw ξ
where z ∈ Rp , ψ ∈ Rp , ξ ∈ Rp , Aw ∈ Rp×p and Bw ∈ Rp×p

If the above dynamics is expressed in the Laplace domain the following result
can be obtained:
G (s) =

ψ (s)
−1
= Aw [sIp×p − Aw ] Bw + Bw
ξ (s)

(2.15)

where G (s) is the multi – input and multi – output transfer function from the
input ξ to output ψ . It is clearly noted that the following limit tends to zero.
(2.16)

lim G (s) → 0

s→0

The above result means that the system in (2.14) blocks the steady state inputs.
This property is the core part of the control mechanisms aided with a washout
filter.

2.4

Hodgkin – Huxley Model and application

For the Hodgkin – Huxley model in consideration first of all a linearization
should be done. So the linearization will lead to the linearized model in (2.9)
with the matrixA as:


A= 


∂ V̇
∂V
∂ ṅ
∂V
∂ ṁ
∂V
∂ ḣ
∂V

∂ V̇
∂n
∂ ṅ
∂n

0
0

∂ V̇
∂m

0
∂ ṁ
∂m

0

∂ V̇
∂h





0 



0


∂ ḣ
∂h

7



VE =0


V
 n 

,x=
 m 
h

(2.17)

∂ V̇
∂V
∂ V̇
∂n
∂ V̇
∂m
∂ V̇
∂h


1
−gN a m3 h − gK n4 − gL
Cm
4
=−
gK n3 (V − VK )
Cm
3
=−
gN a m2 h (V − VN a )
Cm
1
=−
gN a m3 (V − VN a )
Cm
=

(2.18)

∂ ṅ
= −1/100/(exp(1 − 1/10V ) − 1)(1 − n)+
∂V
1/10 × (1/10 − 1/100V )/(exp(1 − 1/10V ) − 1)2 × (1 − n) exp(1 − 1/10V ) + 1/640 × exp(−1/80V )n
∂ ṁ
= −1/10/(exp(5/2 − 1/10V ) − 1)(1 − m)+
∂V
1/10(5/2 − 1/10V )/(exp(5/2 − 1/10V ) − 1)2 (1 − m) × exp(5/2 − 1/10V ) + 2/9 exp(−1/18V )m
∂ ḣ
= −7/2000 exp(−1/20V )(1 − h) − 1/10/(exp(3 − 1/10V ) + 1)2 h × exp(3 − 1/10V )
∂V
∂ ṅ
= − (αn + βn )
∂n
∂ ṁ
= − (αm + βm )
∂m
∂ ḣ
= − (αh + βh )
∂h
(2.19)
The terms are given in Section 2.1. The input u and the matrix B is:


B=


1
Cm

−gN a m3 h − gK n4 − gL
0
0
0

 

 , u = VE


(2.20)

In the next, the repetitive firing condition should be found which is done through
bifurcation analysis using the MATCONT toolbox of MATLAB ®. For this
purpose, we will analyze the case where there is a physiological condition on the
sodium channel. That is the deviation in the equilibrium (rest) potential of the
channel in which MATCONT provides the following data:
In order to continue the application, a washout filter should be proposed. The
input of the washout filter should be a measurable variable which is in this case
the membrane potential of the nerve fiber. So the washout filter will be of the
following form:
ż = aw z + bw V
y = aw z + bw V

8

(2.21)

Table 2: The repetitive firing condition as a result of deviation in the sodium
channel
Parameter & Prop
VN a = 199.134
λ1 = −5.04011
λ2 = −0.1257

Eigenvalues

λ3 = j0.3958
λ4 = −j0.3958
V = 0.93404938
n = 0.33208269

Equilibrium Points

m = 0.059059
h = 0.5631245
Hopf

Type of Bifurcation

In order to have a stable filter the condition
aw < 0
should be satisfied. For a practical case one can choose aw = −0.01 and bw = 1
. The resultant filter is augmented into the linearized nerve model in (2.17) (2.21) to obtain:

ẋf = Af xf + Bf VE
 ∂ V̇ ∂ V̇ ∂ V̇


Af = 



∂V
∂ ṅ
∂V
∂ ṁ
∂V
∂ ḣ
∂V
bw

∂n
∂ ṅ
∂n

0
0
0

∂m

0
∂ ṁ
∂m

0
0

∂ V̇
∂h

0
0
∂ ḣ
∂h

0

0
0
0
0
aw














, Bf =

B
0





, xf = 



VE

V
n
m
h
z



 (2.22)




Numerical representation of the above matrix for the values given in the Table
2 is now:







V̇
ṅ
ṁ
ḣ
ż





 
 
=
 
 

- 0.8261
0.0029
0.0278
- 0.0042
1

- 74.9539
- 0.1850
0
0
0

154.0073
0
- 4.0361
0
0

5.3840
0
0
- 0.1186
0

0
0
0
0
−0.01








V
n
m
h
z

 
 
 
+
 
 
(2.23)

The output feedback will be taken
 from the output of the
 washout filter so the
output feedback matrix is C = 1 0 0 0 −0.01 . In order to proceed,
a full state feedback controller is necessary for the linear system presented in
(2.23). This can be obtained using the linear quadratic theory (LQR) and
the MATLAB’s lqr(A, B, Q, R) command directly results a full state feedback
coefficient matrix Kf where VE = −Kf x . The obtained gain matrix Kf
minimizes the infinite horizon quadratic gain index shown below:
9

- 0.8261
0
0
0
0




 VE



Z∞
J=

(2.24)


xT Qx + uT Ru dt

0

Taking Q = qI4×4 and R = 1 considering the problem of this research the above
index is rewritten as:
Z∞
J=

(2.25)




q V 2 + n2 + m2 + h2 + VE2 dt

0

Substituting q = 100 and invoking the necessary command the full state feedback gain coefficient yields:
Kf = [ - 10.5426 89.5670 - 133.4628 - 6.4330 - 9.8885]

(2.26)

The closed loop spectrum (Af − Bf Kf ) for the new case is:



Λf = 



- 8.8641
0
0
0
0

0
- 3.7002
0
0
0

0
0
- 1.0170
0
0

0
0
0
- 0.1849
0

0
0
0
0
- 0.1186








(2.27)

And the corresponding eigenvectors are:


0.9937 - 0.9621 0.7096 0.0253 0.0011





 - 0.0003 0.0008 - 0.0024 0.9891 0.0000 



Vf = 
 - 0.0057 - 0.0796 0.0065 0.0002 0.0000 


 0.0005 - 0.0011 0.0033 0.0016 - 1.0000 
- 0.1122 0.2607 - 0.7046 - 0.1448 - 0.0097

(2.28)

The projective control law will make feedback only from the washout filter thus
the dimension of the feedback is one and the number of guaranteed retainable
eigenvalues is also equal to one. So it is best to retain the eigenvalue farthest
from the imaginary axis which is the one at -8.8641 so the matrix
Vq
is only a single column vector and found as:


0.99367





 - 0.00032859



Vq = 
 - 0.0057199 


 0.00048023 
- 0.11223
10

(2.29)

Figure 3.1: The repetitive firing response of the bifurcating nerve fiber
Applying the projection equation in (2.12) gives the feedback gain from the
washout filter output:
Ko = KVq (CVq )

−1

= - 8.6805

(2.30)

And applying the feedback as Af − Bf Ko C yields the output feedback closed
loop eigenvalues:


- 8.8641





 - 3.1436 


 - 0.0013609




 - 0.21673 
- 0.12075

(2.31)

So the resultant closed loop is a stable system with the expected eigenvalue at
-8.8641 in the right place. The control law together with the washout filter is:
ż = −0.01z + V
VE = −Ko (−0.01z + V )

3

(2.32)

Results and Discussion

The uncontrolled nerve fiber model in (2.1) with the parameters in (2.2) except
the deviated parameter which is given in Table 2 will yield a repetitive firing
action potential as shown in Figure 1:
When the control law of (2.32) is applied through the external voltage input of
the model in (2.3) the response of the nerve fiber becomes that of the Figure 2.
11

Figure 3.2: The stabilized response of the nerve fiber
The required level of electrical field can be obtained using the inversion system
presented in (2.7) with the parameters given in Table 1. Required level of electric
field is presented in Figure 3.
As it is expected the level of electric field goes to zero since it stabilized the
equilibrium condition on the nerve fiber. The steady state portion of the electric
field is not allowed to pass from the washout filter and thus it stays at zero
forever after the stabilization. This makes the electric field stimulation of the
nerve fiber very short. This is a good advantage because of the fact that the level
of electric field required is quite high as seen from Figure 3. In this research,
we have presented a stabilization scheme for stopping the repetitive firing of
the nerve fiber. In order to achieve the goal, the Hodgkin – Huxley model
of the squid giant axon is taken into consideration. A condition on the sodium
channel is found where the fiber starts to produce repetitive firing and membrane
potential is oscillating. After that, the model is linearized and augmented with
a washout filter to obtain a high pass filtered structure. Finally the projective
control approach is utilized to produce a static output negative feedback on
the washout filter output to finish the application. The simulation results show
that the control laws successfully stabilized the bifurcating nerve fibers with
a short lasting electric field exertion on the fiber. The disadvantage of the
method itself is that it requires the bifurcating conditions to be known. If a
parameter identification method is proposed for the Hodgkin – Huxley model
by the measurement of the membrane potential for various types of nerve fibers.
So if the model is properly identified, the research can be beginning point in the
treatment of diseases based on repetitive firing. In the reverse direction, a stable
fiber can be forced to repetitive firing condition by using approaches like this.
For example, if the dendrite and soma membrane potentials can be separately
measured a pair of pure complex conjugate eigenvalues can be placed so that the
12

Figure 3.3: The required level of electric field for stabilizing the nerve fiber (only
the first 100 seconds are shown where it stays at zero level after all)
system is forced into a Hopf bifurcation condition. This will be required since
in both Hopf and saddle node bifurcations a pair of eigenvalue at the specified
properties are required.

References
[1] Dhooge A., Kovaerts W., Kuznetsov Y.A., MATCONT: A MATLAB package for numerical bifurcation analysis of ODEs. ACM Transactions on
Mathematical Software, 29, 2003, pp. 141-164
[2] Hassouneh M.A., Lee H. and Abed E.H., Washout filters in feedback control: Benefits, limitations and extensions, American Control Conference,
2004, pp 3950-3955
[3] Hodgkin A.L., Huxley A.F., A Quantitative Description Of Membrane Current And Its Application To Conduction And Excitation In Nerve, Journal
Of Physiology-London, 117, 1952
[4] Kotnik T., Miklavcic D., Slivnik T., Time course of transmembrane voltage
induced by time-varying electric fields—a method for theoretical analysis
and its application, Bioelectrochemistry and Bioenergetics, 45, 1998, p.p
3-16
[5] Mayberg H.S., Mayberg A.M., Voon V., McNeely H.E., Seminowicz D.,
Hamani C., Schwalb J.M., Kennedy S.H., Deep brain stimulation for
treatment-resistant depression, Neuron. 45, 2005, pp. 651–660

13

[6] MEDANIC J., On stabilization and optimization by output feedback, Proc.
12th Asilomar Conf. Circ., Sys. Comp.,1978, pp. 412-416
[7] Moro E., Lang A.E., Criteria for deep-brain stimulation in Parkinson’s disease: review and analysis, Expert Review of Neurotherapeutics, 11, 2006,
pp. 1695–1705
[8] Pellock J.M., Dodson W.E., Bourgeois B.F.D., Pediatric Epilepsy, Second
Edition, Demos Medical Publishing, 2001
[9] Wang H.O., Chen D.S., Bushnell L.G., Dynamic feedback control of bifurcations, 39th IEEE Conference on Decision and Control, 2000,pp. 1619-1624
[10] Wang J., Kai T.M., Zhang H., Hopf bifurcation in the Hodgkin–Huxley
model exposed to ELF electrical field, Chaos, Solitons & Fractals 20, 2004,
pp. 759-764

14

