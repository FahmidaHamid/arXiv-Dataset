Step selection techniques uncover the
arXiv:1403.6869v3 [q-bio.PE] 13 May 2014

environmental predictors of space use patterns in
flocks of Amazonian birds
Jonathan R. Potts∗a , Karl Mokrossb,c , Philip C Stoufferb,c and Mark
A. Lewisa,d
a

Centre for Mathematical Biology, Department of Mathematical and
Statistical Sciences, University of Alberta, Canada

b

School of Renewable Natural Resources, Louisiana State University
Agricultural Center, Baton Rouge, Louisiana, 70803
c

Projeto Dinâmica Biológica de Fragmentos Florestais. INPA. Av.
André Araújo 2936. Petrópolis. Manaus. Brazil. 69083-000

d

Department of Biological Sciences, University of Alberta, Edmonton,
Canada
*Corresponding author: jrpotts@ualberta.ca

∗

jrpotts@ualberta.ca

1

Summary
1. Anthropogenic actions cause rapid ecological changes, meaning that animals
have to respond before they have time to adapt. Tools to quantify emergent
spatial patterns from animal-habitat interaction mechanisms are vital for
predicting the population-level eﬀects of such changes.
2. Environmental perturbations are particularly prevalent in the Amazon rainforest, and have a profound eﬀect on fragmentation-sensitive insectivorous
bird ﬂocks. Therefore it is important to be able to predict the eﬀects of such
changes on the ﬂocks’ space-use patterns.
3. We use a step selection function (SSF) approach to uncover environmental
drivers behind movement choices. This is used to construct a mechanistic model, from which we derive predicted utilization distributions (home
ranges) of ﬂocks.
4. We show that movement decisions are signiﬁcantly inﬂuenced by canopy
height and topography, but not resource depletion and renewal. We quantify
the magnitude of these eﬀects and demonstrate that they are helpful for
understanding various heterogeneous aspects of space use. We compare our
results to recent analytic derivations of space use, demonstrating that they
are only accurate when assuming that there is no persistence in the animals’
movement.
5. Our model can be translated into other environments or hypothetical scenarios, such as those given by proposed future anthropogenic actions, to make
predictions of spatial patterns in bird ﬂocks. Furthermore, our approach is
2

quite general, so could be used to predict the eﬀects of habitat changes on
spatial patterns for a wide variety of animal communities.

Keywords
Amazon rainforest; Animal movement; Deforestation; Forest fragmentation; Home
range; Insectivorous birds; Resource selection; Space use; Step selection; Theoretical ecology

Introduction
Today’s rapid and extensive changes to the environment highlight the need for
accurate models that can predict the eﬀect of these perturbations on animal and
plant populations (Thomas et al., 2004). The Amazon rainforest is a prime example of such a disturbed ecosystem, with recent large-scale deforestation causing
a wide range of ecological changes (Laurance et al., 2011; Fearnside, 2005). In
particular, insectivore bird communities living in the rainforest ﬁnd it diﬃcult or
impossible to survive in deforested areas (Şekercioḡlu et al., 2002), even after years
of second growth regeneration (Sodhi et al., 2008). This fragmentation sensitivity
ultimately forces many bird species into local extinction (Stouﬀer et al., 2011),
reducing the biodiversity and consequently ecosystem functioning (Chapin et al.,
2000; Mäntylä et al., 2011).
Mixed-species ﬂocks are an important element of the understory avifauna found
in practically all terra firme forests in the Amazon basin. The ﬂocks tend to comprise of around 20 to 60 insectivore species that actively forage in the vegetation

3

(Munn, 1984; Powell, 1989; Mokross et al., 2014), searching the diﬀerent strata
and substrates in the vegetation for practically the whole duration of the day with
high consumption rates (K. Mokross pers. obs.). This makes them not only important contributors to the species richness of the Neotropical avifauna (Powell,
1989), but also potential key players in trophic cascades with herbivorous insects
and plants (Mäntylä et al., 2011).
The core of each ﬂock is composed of 5-10 species which are consistently present,
and share the same overlapping territory (Munn & Terborgh, 1979), each pair
defending its territory from conspeciﬁcs. In the ﬂocks studied here, the Cinerous
Antshrike (Thamnomanes caesius) plays a nuclear role by giving alarm and rally
calls that maintain ﬂock cohesiveness (Munn, 1986). Other species will be frequent
ﬂock attendants but leave occasionally, either by switching between ﬂocks, or by
having smaller territories than the core species (Jullien & Thiollay, 1998).
Space use for these ﬂocks is very stable: territories’ shapes change little in two
decades (Martinez & Gomez, 2013). The core species gather in the same location
at dawn every day, usually in a central position within its territory, and will begin
foraging from there in an apparently random fashion (Powell, 1985) until sunset
where they roost in the approximate vicinity to each other (Jullien & Thiollay,
1998; Martinez & Gomez, 2013). The purpose of this paper is to disentangle the
purposeful drivers behind the movement processes from this apparently random
behavior, then to use this understanding to build a predictive model of space use
patterns in insectivore bird ﬂocks.
Linking animal movement to space use in a quantitative, analytic fashion is
vital for predicting the eﬀects of environmental changes on animal populations
(Morales et al., 2008). The factors driving the animals’ movement ultimately de4

termine the size and structure of the space that they use in order to meet their
everyday needs. By uncovering how these movement processes give rise to spatial
patterns, it would be possible to predict the types and amounts of terrain that
would be used were the environment to be perturbed, by anthropogenic eﬀects or
otherwise (Nathan et al., 2008).
In this paper, we make an important step towards this end, by identifying and
quantifying some of the key environmental factors that inﬂuence Amazonian bird
ﬂock movement, then using them to construct a predictive model of space use.
Our approach begins by using a step-selection function (Fortin et al., 2005) to
test three hypotheses regarding the drivers behind the ﬂocks’ movement decisions.
Then we derive from this a master equation to link these processes to the emergent
space use patterns. The hypotheses we test are that (1) ﬂocks are more likely to
move into areas with taller canopies than shorter, (2) ﬂocks tend to move away
from higher ground and towards lower, (3) ﬂocks leave some time for the resources
to renew before re-visiting a tree they have recently visited.
Taller canopies are expected to be preferable for birds since they tend to contain
a larger mass of resources (Basset et al., 1992). On the other hand, lower ground
can be support more buﬀered conditions from wind turbulence and sunlight from
outside the forest cover (Ewers & Banks-Leite, 2013), and naturally hold higher
air and soil moisture levels (Baraloto & Couteron, 2010) which could potentially
increase arthropod loads per vegetation volume (Williams-Linera & Herrera, 2003;
Chan et al., 2008).
We begin with these two in order to develop a basic methodological framework that we can easily extend to build more complicated models that could
include other factors driving the birds’ movement decisions, such as memory
5

(Smouse et al., 2010), territoriality (Potts et al., 2013), or tighter movement patterns in dense foliage (Jullien & Thiollay, 1998). Proceeding in this way is advantageous since we gain a clear understanding of exactly how, and to what extent,
each environmental factor inﬂuences ﬂock movement. Though starting with a more
complex model may lead to more accurate predictions, it would make it harder
to disentangle the relative eﬀects of each model parameter on the resulting space
use, so we would ultimately learn less about the underlying causes of space-use
phenomena.
Recently, Moorcroft & Barnett (2008) derived an approximate analytic formula
relating an animal’s utilization distributions to its step selection mechanism, in a
particular 1-dimensional scenario. This was then extended into arbitrary dimensions by Barnett & Moorcroft (2008). We examine to what extent this prediction
is accurate for our more complicated scenario, by examining where the analysis
breaks down as models become more complex. We compare their predictions with
numerical solutions of our model to demonstrate where their results hold to a good
degree of accuracy, so can be usefully applied to empirical data, and where they
fail.

Materials and methods
The step selection function model
Our model for bird-ﬂock movement is based on a step selection function (SSF)
approach (Fortin et al., 2005). Following the formalism initiated by Rhodes et al.
(2005), but extended here to take into account correlations in the movement, we

6

write the probability f (x|y, θ0 ) of ﬁnding an animal at position x, having traveled
from y in the previous step, given that it arrived at y on a bearing of θ0 , as follows
Φ(x|y, θ0 )w(x, E)
.
dx′ Φ(x′ |y, θ0 )w(x′ , E)
Ω

f (x|y, θ0 ) = R

(1)

Here, w(x, E) is a weighting function that depends upon the animal’s position
x and some environmental covariates E (Forester et al., 2009), Φ(x|y, θ0 ) is the
probability of being at x in the absence of habitat selection, given that the animal
was previously at y and had arrived there on a bearing of θ0 , Ω is the study area,
and bearings are measured in an anti-clockwise direction from the right-hand half
of the horizontal axis. Each step takes a ﬁxed amount of time τ . The function
Φ(x|y, θ0 ) allows us to take into account the fact that animals may be more likely
to take steps of a particular length, and the distribution of such lengths can be
derived from empirical data. For computational purposes, we truncated the step
length distribution at steps of greater than 100m, since these never occur in our
data. We include the angle θ0 into this formulation to allow for the possibility of
correlations between successive movement bearings.
For the purpose of testing hypotheses (1) and (2), w(x, E) is a function of the
canopy height C(x) and the topography (i.e. elevation above sea level) T (x), both
measured in meters (m). We test two candidate formulations for w(x, E)

wa (x, α, β) = exp[αC(x) − βT (x)],

(2)

wb (x, α, β) = C(x)α T (x)−β .

(3)

Notice that Eq. 3 can also be written as wp (x) = exp{α ln[C(x)] − β ln[T (x)]}, in
7

keeping with the original formulation of the step selection function from Fortin et al.
(2005). Since we would expect the birds to be more likely to move towards lower
ground than higher, we place a minus sign before the β in each equation, so that
β is expected to be positive.
To test hypothesis (3), we assume that the resource amount at the start of
the day (t = 0), is proportional to the canopy height (Campos et al., 2006). As
the birds move through an area, they deplete the resources, which take a time
Gτ to renew. The resource amount present at a site at time gτ after having
been visited is assumed to be R(x, t, G) = gC(x)/G as long as g < G, otherwise
R(x, t, G) = C(x). Here, t is the time since start-of-day and a unit of resources is
implicitly deﬁned to be the maximum amount of usable resources sustainable by
a tree per meter of tree height. At time t = 0, we assume R(x, 0, G) = C(x). As
with hypotheses (1) and (2), we test two candidate formulations for w(x, E)

wc (x, t, α, β, G) = exp[αR(x, G, t) − βT (x)],

(4)

wd (x, t, α, β, G) = R(x, t, G)α T (x)−β .

(5)

Notice that when G = 1, we have wa (x, α, β) = wc (x, t, α, β, 1) and wb (x, α, β) =
wd (x, t, α, β, 1).

Data collection methods
Flock activity is conspicuous, allowing birds to be followed on foot. As ﬂocks
moved, geolocations were recorded at 30 second intervals with a hand-held GPS
unit (Garmin Vista HCX). The observer maintained a distance of 10-20m from the

8

ﬂocks to ensure no alarm or avoidance behavior was induced in the birds. Observer
distance is not in perfect lockstep with the ﬂock, yet the average distance to the
approximate center of the ﬂock could be maintained to an accuracy of a few meters.
Where possible, we used the location of a Cinereous Antshrike as the ﬂock location.
This species was usually conspicuous in the center of the ﬂock. Other more active
species typically spread out over a radius of 5-10 m, depending on the size and
speed of the ﬂock.
Though GPS error can be around 10m, it is mainly caused by the relatively slow
movement of the ionosphere (Parkinson & Spilker, 1996) which only changes by a
few centimeters during 30 second intervals. Indeed, evidence from using hand-held
GPS for tracking butterﬂies suggests that the median drift (i.e. absolute error)
between consecutive 15 second relocations is only 8cm (Severns & Breed, 2014).
Therefore it is reasonable to assume that the measured step lengths and turning
angles accurately reﬂect reality.
Compared to other available methods, this data reﬂects well the movement
of ﬂocks on a small spatio-temporal scale. It provides a high resolution of time
sequence that is not possible in radio-telemetry studies, and presently no other
techniques allow the gathering of detailed spatial data for passerines of this size.
Unlike remote telemetry, this method also allows the direct observation of behavior, so the observer can directly verify whether the recorded spatial locations are
corresponding well with the canopy height and topographical maps.
For measuring canopy heights, we used a LIDAR (Light Detection and Ranging) canopy height model (CHM). Similarly, topography (Digital Elevation Models
DEM) was acquired using small footprint airborne LIDAR. The derived (postprocessed) images from the LIDAR data are 1m/pixel resolution, which we trans9

formed into 10m lattices by bilinear interpolation. LIDAR data were collected by
airborne laser scanning using a Hexagon-LEICA ALS50 PHASE II MPiA sensor
of 150 kHz, at 800 m altitude, with 24 degrees opening, 118 MHz pulse rate, 58
Hz scan rate, 3,7 points/m2 density. Swaths were of 340 meters wide, spaced at
240 meters. Post-processing used a Forest Service methodology to generate DEM
and CHM at 1 m2 /pixel [see Stark et al. (2012) for more details on LIDAR data
collection and analysis].
We analyzed movement of 6 diﬀerent ﬂocks in terra firme forest, during the dry
seasons between June and November during 2009-2011, at the Biological Dynamics
of Forest Fragments Project (BDFFP), about 70 km north of Manaus, Brazil (see
http://pdbﬀ.inpa.gov.br/ for maps). The study area is a rectangle of size 2.8km
by 1.5km. Flocks were each tracked for between 5 and 11 days. Each ﬂock gathers
in one particular place each day, then moves around the forest for a total of about
eleven-and-a-half hours during the day, before each bird goes back to its roost for
the night.

Parametrizing the models from the data
The ﬁrst step in parametrizing the models is to calculate the step length and
turning angle distributions, i.e. the distance between successive positions and
the angle an animal turns through from one move to another, respectively [see
e.g. Crist et al. (1992)]. Since these depend upon the temporal resolution τ (i.e.
the time between successive position ﬁxes), we use both τ = 1 minute and τ =
5 minutes, deriving two diﬀerent sets of step length and turning angle distribution
for the diﬀerent values of τ . The value τ = 1 minute is chosen because bird

10

ﬂocks tend to move from one tree to another at an average of approximately
every 1 or 2 minutes. Though their movement is a continuous rather than discrete
process, the model is formulated so this timescale roughly represents the small-scale
decisions that the birds make regarding whether they stay in a tree or choose to
move to another. We also examine the case τ = 5 minutes to determine whether
the decisions about where to move can instead be viewed as taking place on a
timescale longer than a single jump between trees. In other words, the birds
might only be considering the next tree they move to when deciding where to go
(τ = 1 minute), or they might be thinking a few trees ahead when they make this
decision (τ = 5 minutes).
The step length distributions are ﬁtted to both a Weibull distribution (Forester et al.,
2009) and an Exponentiated Weibull (EW) distribution (Nassar & Eissa, 2003),
using the Akaike Information Criterion (AIC) to determine the best model, whereas
we ﬁt the turning angles to a von-Mises distribution (Marsh & Jones, 1988). The
Weibull, EW and von Mises distributions have the following forms, respectively
h  x a i
a  x a−1
,
exp −
b b
b
h  x a ioc−1
h  x a i n
ac  x a−1
1 − exp −
,
exp −
ρ2 (x|a, b, c) =
b b
b
b
ρ1 (x|a, b) =

V (φ|k) =

exp[k cos(φ)]
.
2πI0 (k)

(6)
(7)
(8)

Since the rainforest canopy consists of distinct treetops whose widths are each
roughly 10m across, we split the terrain Ω into a grid S of 10m by 10m squares.
This allows us to associate a value of C(s) and T (s) to each square s in S, respectively the mean canopy height and mean topography of the square. Parametrizing

11

Eq. 1 from the data therefore requires maximizing the following likelihood function
N
Y
Φ(x |x , θ )w(xn , E)
P n n−1 n−1
,
L(X|E) =
s∈S Φ(s|xn−1 , θn−1 )w(s, E)
n=2

(9)

where X = {x0 , x1 , . . . , xN } are the consecutive positions of a ﬂock, θn is the
bearing from xn−1 to xn , Φ is the product of the best-ﬁt step length and turning
angle distributions, and w is either wa , wb , wc or wd , depending on which model
we are ﬁtting.
To test hypothesis (1), we ﬁx β = 0 and ﬁnd the value of α that maximizes
L(X|E), which we call αm . We then use the likelihood ratio test to compare the
resulting value of L(X|E) with the value of L(X|E) when both α and β set to zero.
For hypothesis (2), we ﬁx α = αm and ﬁnd the value of β that maximizes L(X|E),
again using the likelihood ratio test to compare this value of L(X|E) with the one
where α = αm and β = 0. We then ﬁnd the values of α and β that maximize
L(X|E) by varying both parameters simultaneously, giving best ﬁt values denoted
by αbf and βbf . We use a Markov bootstrap method with 100 bootstraps to ﬁnd
standard errors for α and β (Horowitz, 2003).
Hypothesis (3) is tested by ﬁxing α = αbf and β = βbf and ﬁnding the value
of G that maximizes L(X|E), then using the likelihood ratio test to compare the
resulting value of L(X|E) with the value of L(X|E) when G = 1. For each maximization calculation, we use the Nelder-Mead simplex algorithm (Lagarias et al.,
1998), as implemented in the Python maximize() function from the SciPy library
(Jones et al., 2001).

12

Constructing the space use distribution
We use two methods for constructing the space use distribution from the parametrized
SSF (Eq. 1), via simulation analysis and through constructing the master equation
and numerically deriving its steady-state solution. For the former approach, we
simulate one particular ﬂock’s movement on the grid S using the jump probabilities given by SSF. Since the ﬂock gathers in one particular place each day, and
moves around the terrain for a total of about eleven-and-a-half hours during the
day, we start the simulated birds at the gathering point and run the simulation for
138 time steps, each step representing τ = 5 minutes (giving 11 hours 30 minutes
in total), taking a note of all the positions at which the ﬂock landed after each
step. We repeat this 100 times, representing 100 days, giving 13,800 simulated positions in total. In the data, we tend to have around 10 days per ﬂock. However,
we use 100 here to average out some of the stochasticity. From these simulated
positions, we calculate the 50%, 60%, 70%, 80%, and 90% Kernel Density Estimators (KDEs), using a ﬁxed kernel method with smoothing parameter h = σn−1/6
p
where σ = (1/2) σx2 + σy2 and σx , σy are the standard deviations of the simulated

data in the x- and y-directions respectively (Worton, 1989). KDE calculations are
performed using Python.
In addition to simulation analysis, we also construct the master equation for

the probability density function u(x, θ, t) of the animal being at x at time t having
traveled there on a bearing of θ. This allows us to compare our results with the
predictions of Barnett & Moorcroft (2008), who mathematically analyzed the step
selection function (Eq. 1) in the simpler case where the turning angle distribution is
uniform. They proved that u(x) is proportional to w(x, E)z(x, E), where z(x, E) =

13

R

Ω

dx′ Φ(x′ |x, θ0 )w(x′, E) is a local averaging of w(x, E). We examine to what

extent this result extends to our more complicated situation of a correlated random
walker. We use Eq. 1 to construct the following master equation

u(x, θ, t + τ ) =

Z

π

−π

dθ0

Z

0

rmax

Φ(x|yθ (r), θ0 )w(x, E)
u(yθ (r), θ0 , t), (10)
dx′ Φ(x′ |yθ (r), θ0 )w(x, E)
Ω

dr R

where yθ (r) describes the locus of points y upon which the animal could approach
x = (x1 , x2 ) at bearing θ, i.e. yθ (r) = (x1 + cos(θ + π)r, x2 + sin(θ + π)r), with
r denoting the distance between yθ (r) and x (Potts et al., 2014). Here rmax is
the distance along this line from x to the boundary of Ω and so gives the upper
endpoint of integration. To calculate the steady-state distribution, we solve Eq.
10 iteratively until |u(x, θ, t + τ ) − u(x, θ, t)| < 10−8 for every value of x and θ.
The area Ω for this calculation is deﬁned to be the 95% KDE of the ﬂock used for
the simulations. We used zero-ﬂux boundary conditions, which models the fact
that the birds are conﬁned within their territory. Calculations were coded in C
and it took approximately 2 hours to ﬁnd a single steady state distribution.
Note that in these methods, we are separating the ﬁtting of the turning angle
and step length distributions from the ﬁtting of the weighting functions. This
makes the maximization procedure far faster and means the algorithms are more
likely to converge to the global maximum. However, if the weighting function w
gives a particularly strong selection for an environmental covariate and/or the step
length distributions are fat-tailed, then this separation may cause inaccuracies in
the resulting model. To test that this is not the case, we calculated the mean
and standard deviation of the step length and turning angle distributions from
the above simulations to verify that the weighting function had not signiﬁcantly
14

altered them.

Results
Step length and turning angle distributions
For both cases τ = 1 minute and τ = 5 minutes, the best ﬁt step length distribution is an Exponentiated Weibull (EW) distribution (Fig. 1). For τ = 1 minute,
∆AIC = 126.9 between EW and Weibull. For τ = 5 minutes, ∆AIC = 14.6.
The step length distributions both increase from 0m initially, before decaying
(Fig. 1). However, this is not an indicator that birds are more likely to move
a medium length distance than a very short distance, but is simply due to there
being less area in the annulus of radius between r and r + δr when r is smaller.
If δr is small then the total amount of area into which a ﬂock can move, given
that it moves a distance between r and r + δr, is approximately δr × 2πr, which is
proportional to r. To ﬁnd the relative preferences of the birds to move a particular
distance, it is therefore necessary to divide the probability density, P (r), by the
distance moved, r. If we do this for our data on the 1 minute temporal resolution,
we ﬁnd that P (r)/r is approximately 0.044 exp(−r/4.75) and for the 5 minute
time-scale P (r)/r ≈ 0.0080 exp(−r/11.3), both of which decay monotonically as r
increases.

Hypothesis testing
The tests indicate that there is a signiﬁcant eﬀect of both canopy height (hypothesis
1) and topography (hypothesis 2) on the ﬂocks’ movement. However, accounting

15

for resource renewal, so that birds are less likely to re-visit trees that they have
recently visited, does not improve the model ﬁt (hypothesis 3). The conclusions
are the same both for τ = 1 minute and τ = 5 minutes, so we cannot conclude
anything about the temporal resolution on which decisions are made. Table 1 gives
a summary of the results.
To put these in a biological context, consider two trees, equally accessible over
a 5 minute interval and on ground of equal elevation, but one A% taller than the
other, e.g. if one is 30m high and the other 20m high then A = 50. Then the
birds are (1 + A/100)0.277 = 1.50.277 ≈ 1.096 times more likely to move to the taller
tree than the shorter, i.e. about 10% more likely. Conversely, suppose that both
trees are of equal height but one tree is ground B% higher above sea-level than
the other. Then the birds are (1 + B/100)1.697 times more likely to move to the
tree on lower ground. For example, an decrease from 50m to 40m elevation leads
to a 1.251.697 ≈ 1.460 increase in probability of moving there, i.e. they are 46%
more likely to move to the 40m elevation.
The weighting function wb (Eq. 3) provides a better ﬁt to the data than wa (Eq.
2) for τ = 5 minutes. The AIC for wb is lower than that for wa (∆AIC = 3.8).
Though the AIC for wb for τ = 1 minutes is slightly lower than for wa (∆AIC =
0.1), the change in AIC is not large enough to be considered good evidence that
wb is better than wa . In Table 1 we detail the results for the function wb and its
generalization wd (Eq. 5). Results for wa and wc (Eq. 4) are qualitatively similar.

16

Space use distributions
Figure 2 compares the simulated space use with the empirical data on ﬂock positions. The KDE contour lines for the simulated data are quite tightly packed
around the edge of the empirical data points, suggesting that the model is giving a
reasonable prediction of space use patterns. However, the extent of the simulated
home range is clearly larger than the empirical home range.
Though separating the ﬁtting of the step length and turning angle distributions from the environmental interactions may mean that the ﬁt is less accurate
than if all parameters were ﬁtted together, it turns out that the mean of the simulated data’s step length distribution is 20.05 ± 0.95m (95% conﬁdence intervals),
compared with 20.09m from the data. The standard deviation of the simulated
step lengths is 13.55 ± 2.01m as compared with 13.23m from the data. Similarly,
the standard deviation of the turning angles from simulation output is 82.1 ± 8.7
degrees as compared with 82.7 degrees from the data, and the mean is −0.2 ± 6.9
degrees, as compared with −1.7 degrees from the data. Therefore including the
weighting function does not signiﬁcantly change the step length or turning angle
distributions.

Comparison with analytic results
Previous work showed that if there is no correlation in an animal’s movement, the
steady-state space-use distribution is proportional to w(x, E)z(x, E) as long as the
turning angle distribution is uniform (Barnett & Moorcroft, 2008, Eq. 13), where
R
z(x, E) = Ω dx′ Φ(x′ |x, θ0 )w(x′, E). By numerically deriving the steady space-use
distribution for our model, we show that this result breaks down when we include

17

correlation in the movement process. Figs. 3a and 3b compare the analytic result
to the numerical one in the speciﬁc example of our Amazonian bird ﬂock model, in
the case w(x, E) = wb (x, α, β) (see Eq. 3). However, if we assume that the turning
angle distribution is uniform, then the analytic solution is very similar (Figs. 3b
and 3c).

Discussion
We have constructed a step selection function (SSF) to test three hypotheses about
the drivers behind Amazonian bird ﬂock movement decisions. We have shown that
these ﬂocks have a tendency to move towards areas covered by higher canopies,
but move away from areas of higher ground. The preference for higher canopies is
likely to be due to the greater abundance of resources, through enhanced microclimatic conditions in the understory and more foraging substrate (Basset et al.,
1992). Lower ground is likely to be preferred because it has a moister environment
that can hold a higher insect biomass (Chan et al., 2008).
However, the ﬂocks are just as likely to move back to a place that they have
recently visited than one that they have not visited for a while. This suggests that
when they visit a tree, they do not deplete the resources as much as they can, but
leave the tree in the knowledge that there is still plenty of food to be found there.
Whilst it may seem advantageous to stay at a tree as long as it is proﬁtable to
do so, in order to conserve energy (Houston et al., 1993), this frequent movement
from tree to tree might be a tactic to avoid predators. Alternatively, insects may
temporarily be adopting cryptic behavior on the presence of birds, thus forcing
the birds to move on quickly as insects become rapidly harder to ﬁnd.
18

We tested diﬀerent functional forms for the selection weighting, something
that is rarely done in literature on step selection functions but could be important
(Lele et al., 2013). Although we would be surprised if the functional form were to
change the outcome of hypothesis testing, it could very much aﬀect the resulting
parameters that are used to build the mechanistic model. For example, an exponential eﬀect of the canopy height vastly increases the relative attraction to very
high canopies as compared with a power law eﬀect, since this is eﬀectively the difference between a linear and a logarithmic scaling (see the note after Eq. 3). This
has the potential to vastly change the predicted space use patterns. Therefore it
is vital to consider functional form when using step selection techniques to build
mechanistic models.
Our SSF approach enabled us to run simulations that were used to predict the
utilization distribution (UD) of a ﬂock, thereby relating the small-scale movement
decisions to the large-scale space use patterns. While the resulting simulated UD
captured certain qualitative aspects of the empirical data (Fig. 2), it overestimated
the home range size. In comparison, a straightforward random walk model, based
on the empirical mean step length distribution, would give a normal distribution
with the 90% contour approximately 395m from the gathering point. This contour would overlap the corresponding (outer) contour from Fig. 2, but would be
circular, whereas the simulation contour is far from symmetric. Therefore, though
certain features of space use are being predicted by our model, there must be some
other aspect of the birds’ movement decisions keeping them far more spatially
conﬁned than our current model predicts.
We propose two plausible mechanisms that might explain this conﬁnement.
First, these ﬂocks are highly territorial (Develey & Stouﬀer, 2001), so interac19

tions with neighboring ﬂocks may cause each ﬂock to use less space than they
would otherwise. The mechanism of conspeciﬁc avoidance has been shown to
give rise to spatial conﬁnement in various species of canid (Lewis & Murray, 1993;
Moorcroft et al., 2006; Potts et al., 2013). These all deal with avoidance via scent
marking, whereas territories in birds are defended via vocalizations and direct interactions (Munn & Terborgh, 1979). However, the generic modeling framework
from Potts et al. (2013) could be used to constructed coupled SSFs, whose weighting functions w depend both upon the position of the individual and on interactions with neighbors. These interactions may either be direct or mediated by
vocal, visual or olfactory cues.
Second, memory eﬀects, with birds having a preference to move back towards
places they have frequently visited, can cause spatial conﬁnement. Theoretical
studies by Briscoe et al. (2002) have described such a mechanism in wolf (Canis
lupus) populations, and the general results of Tan et al. (2001) show that memory
can severely constrain the amount of area used in a given time period. Though it
is tricky to determine empirically what constitutes a bird’s cognitive map of the
environment, it is generally considered that memory is an important factor in the
spatial conﬁnement and site-ﬁdelity of many animals (Smouse et al., 2010).
By turning our SSF into a master equation for the spatio-temporal probability distribution of the ﬂock’s position, we compared our results to a recent approximate analytic prediction by Barnett & Moorcroft (2008) that applies when
the turning angle distribution is uniform. However, their results fail whenever
there is correlation in the animal’s movement at any time-scale, a fact noted in
Barnett & Moorcroft (2008) but may not be clear to those only familiar with the
more ecologically-motivated paper of Moorcroft & Barnett (2008). The more the
20

correlation, the worse the prediction is likely to be, so it is necessary to take care
when applying these results to empirical data. Though the correlation in the birds’
movement greatly aﬀected the movement pattens, when we removed any intrinsic correlation from our movement model, the predictions of Barnett & Moorcroft
(2008) were visually very good (Fig. 3).
The application of these models could provide basis for informed management
decisions for a subset of the avian community that is known to be very sensitive
to forest disturbances. By providing information on how a combination of two
important habitat features inﬂuences habitat use and how these ﬂocks anchor their
home ranges, this would allow for more realistic estimations of areas that are more
important to these species. Also, the drivers related to resource abundance and
renewal provide important insights on the nature of the relationship of cursorial
insectivorous birds and their resource, a topic that has challenged researchers for
years (Sherry, 1984; Şekercioḡlu et al., 2002).

Acknowledgements
This study was partly funded by NSERC Discovery and Acceleration grants (MAL,
JRP). MAL also gratefully acknowledges a Canada Research Chair and a Killam
Research Fellowship. JRP also acknowledges a Worldwide Universities Network
Research Mobility Award. KM would like to acknowledge the Biological Dynamics of Forest Fragments Project (BDFFP) staﬀ for providing logistic support; J.
Lopes, E.L. Retroz, P. Hendrigo, A. C. Vilela, A. Nunes, B. Souza, M. Campos
for ﬁeld assistance; M. Cohn-Haft for valuable discussions. Funding for the research was provided by US National Science Foundation grant LTREB 0545491
21

to PCS and by the AOU 2010 research award to KM. This article represents publication no. xxx in the BDFFP Technical Series. This is contribution no. xx in
the Amazonian Ornithology Technical Series of the INPA Zoological Collections
Program. This manuscript was approved for publication by the Director of the
Louisiana Agricultural Experiment Station as manuscript 2014-xxx-xxxx. LIDAR
images for canopy height models and digital elevation models were provided by
Scott Saleska (University of Arizona) and Michael Lefsky (Colorado State University). We are grateful to Greg Breed, the Lewis Lab, and various other colleagues
for helpful discussions and comments.

Data accessibility
Data can be found in Dryad doi:10.5061/dryad.47jh1

References
Baraloto C. and P. Couteron. 2010. Fine-scale microhabitat heterogeneity in a
French Guianan forest. Biotropica 42:420-428.
Barnett, A. H. and P. R. Moorcroft. 2008. Analytic steady-state space use patterns
and rapid computations in mechanistic home range analysis. J. Math. Biol.
57:139-159.
Basset, Y., H. P. Aberlenc and G. Delvare. 1992. Abundance and stratiﬁcation of
foliage arthropods in a lowland rainforest in Cameroon. Ecol. Entomol. 17:310318.

22

Breed, G. A., Stichter, S., Crone, E. E. 2013. Climate-driven changes in northeastern US butterﬂy communities. Nature Climate Change. 3:142-145.
Briscoe, B. K., M. A. Lewis, and S. E. Parrish. 2002. Home range formation in
wolves due to scent marking. Bull. Math. Biol. 64:261-284.
Campos, R. I., H. L. Vasconcelos, S. P. Ribeiro, F. S. Neves and J. P. Soares.
2006. Relationship between tree size and insect assemblages associated with
Anadenanthera macrocarpa. Ecography 29:442-450.
Chan, E. K. W., Y. T. Yu, Y. Zhang and D. Dudgeon. 2008. Distribution patterns
of birds and insect prey in a tropical riparian forest. Biotropica 40:623-629.
Chapin III, F. S., E. S. Zavaleta, V. T. Eviner, R. L. Naylor, P. M. Vitousek, H.
L. Reynolds, D. U. Hooper, S. Lavorel, O. E. Sala, S. E. Hobbie, M. C. Mack
and S. Diaz. 2000. Consequences of changing biodiversity. Nature 405:234-242.
Crist, T. O., D. S. Guertin, J. A. Wiens and B. T. Milne. 1992. Animal movement
in heterogeneous landscapes: An experiment with Eleodes beetles in shortgrass
prairie. Funct. Ecol. 6:536-544.
Develey P. and P. C. Stouﬀer. 2001. Eﬀects of roads on movements by understory
birds in mixed-species ﬂocks in central Amazonian Brazil. Cons. Biol. 15:14161422.
Ewers R. M. and C. Banks-Leite. 2013. Fragmentation impairs the microclimate
buﬀering eﬀect of tropical forests. PLoS One 8:e58093.
Fearnside, P. M. 2005. Deforestation in Brazilian Amazonia: History, rates, and
consequences. Cons. Biol. 19:680-688.
23

Forester, J.D., H.K. Im, and P. J. Rathouz. 2009. Accounting for animal movement in estimation of resource selection functions: sampling and data analysis.
Ecology 90:3554-3565.
Fortin, D., H. L. Beyer, M. S. Boyce, D. W. Smith, T. Duchesne, and J. S. Mao.
2005. Wolves inﬂuence elk movements: Behavior shapes a trophic cascade in
Yellowstone National Park. Ecology 86:1320-1330.
Horowitz, J. L. 2003. Bootstrap methods for markov processes. Econometrica 71:
1049-1082.
Houston, A. I., J. M. McNamara and J. M. C. Hutchinson. 1993. General results
concerning the trade-oﬀ between gaining energy and avoiding predation. Phil.
Trans. R. Soc. Lond. B 341:375-397.
Jones, E., T. Oliphant, P. Peterson, et al. 2001. SciPy: Open source scientific tools
for Python. URL http://www.scipy.org/
Jullien M. and J. M. Thiollay. 1998. Multi-species territoriality and dynamic of
Neotropical forest understory bird ﬂocks. J. Anim. Ecol. 67:227-252
Lagarias, J. C., J. A. Reeds, M. H. Wright and P. E. Wright. 1998. Convergence
properties of the Nelder-Mead simplex method in low dimensions. SIAM J. Optimiz. 9:112-147.
Laurance, W. F., J. L. C. Camargo, R. C. C. Luizõ, S. G. Laurance, S. L. Pimm,
E. M. Bruna, P. C. Stouﬀer, G. B. Williamson, J. Benitez-Malvido, H. L. Vasconcelos, K. S. Van Houtan, C. E. Zartman, S. A. Boyle, R. K. Didham, A.

24

Andrade and T. E. Lovejoy. 2011. The fate of Amazonian forest fragments: A
32-year investigation. Biol. Cons. 144:56-67.
Lele, S. R., E. H. Merrill, J. Keim, M. S. Boyce. 2013. Selection, use, choice and
occupancy: clarifying concepts in resource selection studies. Journal of Animal
Ecology, 82: 1183-1191. doi: 10.1111/1365-2656.12141
Lewis M. A. and J. D. Murray. 1993. Modelling territoriality and wolf-deer interactions. Nature 366:738-740.
Mäntylä E., T. Klemola, and T. Laaksonen. 2011. Birds help plants: a metaanalysis of top-down trophic cascades caused by avian predators. Oecologia
165:143-151.
Marsh, L. M. and R. E. Jones. 1988. The form and consequences of random walk
movement models. J. Theor. Biol. 133:113-131.
Martinez A. E. and J. P. Gomez. 2013. Are mixed-species bird ﬂocks stable through
two decades? Am. Nat. 181:E53-59.
Mokross, K., T. B. Ryder, M. Corrêa Côrtes, J. D. Wolfe, P. C Stouﬀer. 2014.
Decay of interspeciﬁc avian ﬂock networks along a disturbance gradient in Amazonia. Proc. R. Soc. B 281:1776 20132599; doi:10.1098/rspb.2013.2599
Moorcroft, P. R. and A. Barnett. 2008. Mechanistic home range models and resource selection analysis: a reconciliation and uniﬁcation. Ecology 89:1112-1119.
Moorcroft, P. R., M. A. Lewis, and R. L. Crabtree. 2006. Mechanistic home range
models capture spatial patterns and dynamics of coyote territories in Yellowstone. Proc. Roy. Soc. B. 273:1651-1659.
25

Morales, J. M., P. R. Moorcroft, J. Matthiopoulos, J. L. Frair, J. G. Kie, R. A.
Powell, E. H. Merrill and D. T. Haydon. 2010. Building the bridge between
animal movement and population dynamics. Phil. Trans. R. Soc. B 365:22892301.
Munn, C. A. and J. W. Terborgh. 1979. Multi-species territoriality in Neotropical
foraging ﬂocks. Condor 81: 338-347.
Munn, C. A. 1984. Birds of a diﬀerent feather also ﬂock together. Nat. Hist. 93:34.
Munn, C. A. 1986. Birds that cry wolf. Nature 319:143-145.
Nassar, M. M. and F. H. Eissa. 2003. On the exponentiated Weibull distribution.
Commun. Stat. A-Theor. 32:1317-1336.
Nathan, R., W. M. Getz, E. Revilla, M. Holyoak, R. Kadmon, D. Saltz and P. E.
Smouse. 2008. A movement ecology paradigm for unifying organismal movement
research. Proc. Nat. Acad. Sci. 105:19052-19059.
Parkinson, B. W., Spilker, J. J. 1996. Global Positioning System: Theory and
Applications, Volume 1, AIAA.
Potts J. R., Bastille-Rousseau G., Murray D. L., Schaefer J. A. & Lewis M. A.
2014. Predicting local and non-local eﬀects of resources on animal space use
using a mechanistic step-selection model. Methods Ecol. Evol. 5:253–262.
Potts, J.R., S. Harris and L. Giuggioli. 2013. Quantifying behavioral changes in
territorial animals caused by sudden population declines. Am. Nat. 182:E73-E82
Powell, G. V. N. 1985. Sociobiology and adaptive signiﬁcance of interspeciﬁc foraging ﬂocks in the Neotropics. Ornithological Monographs 36:713-732.
26

Powell, G. V. N. 1989. On the possible contribution of mixed species ﬂocks to
species richness in Neotropical avifaunas. Behav. Ecol. Sociobiol. 24:387-393.
Rhodes, J. R., C. A. McAlpine, D. Lunney, and H. P. Possingham. 2005. A spatially
explicit habitat selection model incorporating home range behavior. Ecology
86:1199-1205.
Şekercioḡlu, Ç. H., P. R. Ehrlich, G. C. Daily, D. Aygen, D. Goehring and R. F.
Sandì. 2002. Disappearance of insectivorous birds from tropical forest fragments.
Proc. Nat. Acad. Sci. 99:263-267
Severns, P. M. & G. A. Breed. (2014). Behavioral consequences of exotic host plant
adoption and the diﬀering roles of male harassment on female movement in two
checkerspot butterﬂies. Behav. Ecol. Sociobiol. DOI:10.1007/s00265-014-1693-z
Sherry, T. W. 1984. Comparative dietary ecology of sympatric, insectivorous
Neotropical ﬂycatchers ( Tyrannidae). Ecol. Mono. 54: 313-338
Smouse, P. E., S. Focardi, P. R. Moorcroft, J. G. Kie, J. D. Forester and J. M.
Morales. 2010. Stochastic modeling of animal movement. Phil. Trans. R. Soc. B
365:1471-2970.
Sodhi, N. S., M. R. C. Posa, T. M. Lee and I. G. Warkentin. 2008. Eﬀects of
disturbance or loss of tropical rainforest on birds. The Auk. 125:511-519.
Stark, S. C., V. Leitold, J. L. Wu, M. O. Hunter, C. V. de Castilho, F. R. C. Costa
et al. 2012. Amazon forest carbon dynamics predicted by proﬁles of canopy leaf
area and light environment. Ecol. Lett. 15: 1406-1414

27

Stouﬀer, P. C, E. I. Johnson, R. O. Bierregaard Jr., T. E. Lovejoy. 2011. Understory
bird communities in Amazonian rainforest fragments: species turnover through
25 years post-isolation in recovering landscapes. PLoS One 6:e20543.
Tan, Z.-J, X.-W. Zou, W. Zhang, Z.-Z. Jin. 2001. ‘True’ self-attracting walk. Phys.
Lett. A 289:251-254.
Thomas, C. D., A. Cameron, R.E Green, M. Bakkenes, L. J. Beaumont, Y. C.
Collingham, B. F. N. Erasmus, M. Ferreira de Siqueira, A. Grainger, L. Hannah, L. Hughes, B. Huntley, A. S. van Jaarsveld, G. F. Midgley, L. Miles, M.
A. Ortega-Huerta, A. T. Peterson, O. L. Phillips and S. E. Williams. 2004.
Extinction risk from climate change. Nature 427:145-148.
Williams-Linera, G. and F. Herrera. 2003. Folivory, herbivores, and environment
in the understory of a tropical montane cloud forest. Biotropica 35:67-73.
Worton, B. J. 1989. Kernel methods for estimating the utilization distribution in
home-range studies. Ecology 70:164-168.

28

Table captions
Table 1. Results of hypothesis testing. The ﬁrst column is number of the test,
as given in the introduction. This test ﬁnds the best ﬁt parameter given in the
second column. The third column denotes the weighting function used for the test
(see Eqs. 2, 3, 4 and 5) and the fourth gives the value of the time τ between
successive position measurements in the data. The ﬁfth column shows the value of
the parameter that ﬁts the data best (±standard error), with a p-value from the
likelihood ratio test (see Methods) given in the sixth column and the results of a
1% signiﬁcance test in the ﬁnal column (note that a 5% test would give identical
results).

29

Table 1: Results of hypothesis testing. The first column is number of the test, as given
in the introduction. This test finds the best fit parameter given in the second column.
The third column denotes the weighting function used for the test (see Eqs. 2, 3, 4 and
5) and the fourth gives the value of the time τ between successive position measurements
in the data. The fifth column shows the value of the parameter that fits the data best
(±standard error), with a p-value from the likelihood ratio test (see Methods) given in
the sixth column and the results of a 1% significance test in the final column (note that
a 5% test would give identical results).

Test

Parameter

w-function τ (mins)

1

α

wb

1

0.095±0.037 0.0038

2

β

wb

1

1.658±0.345 < 0.001

3

G

wd

1

1.00

1

α

wb

5

0.227±0.065 < 0.001

2

β

wb

5

1.697±0.436 < 0.001

3

G

wd

5

1.00

30

Best ﬁt

p-value

N/A

N/A

Figure captions
Figure 1. Step length and turning angle distributions. Panel (a) shows the
empirical step length distribution (bars) for data where the temporal resolution
is τ = 1 minute, together with the best ﬁt Exponentiated Weibull distribution
(solid curve). The latter is given in Eq. 7, with a = 1.06, b = 6.90 and c = 1.82.
The bars in panel (b) denote the empirical turning angle distribution for the same
data, whereas the curve denotes the best ﬁt von Mises distribution, given in Eq.
8 with k = 0.336. Panels (c) and (d) are analogous to (a) and (b) respectively,
except they use the data set where τ = 5 minutes, rather than τ = 1 minute.
Here, a = 1.26, b = 17.2, c = 1.55 and k = 0.637.
Figure 2. Plots of simulated and real data. Both panels shows the empirical
data for one ﬂock (dots) together with the 50%, 60%, 70%, 80% and 90% kernel
density estimation curves for the simulated data (black curves). See the Methods
section for details on how the simulations were performed. The colors underlying
panel (a) denote the canopy height, whereas in panel (b) they give the topography,
i.e. height of the ground above sea level.
Figure 3. Exact and approximate steady state solutions of the master
equation. Panel (a) shows the numerical steady state solution of our master
equation (Eq. 10) with w = wb (Eq. 3) and the parameters that best ﬁt the data
(see Fig. 1 and Table 1). The numbers on the axes correspond to those in Fig. 2
for ease of comparison. The analytic solution, given in Barnett & Moorcroft (2008,
Eq. 13), is given in panel (b). Though there are some similarities between panels
(a) and (b), the approximation is evidently not particularly good. However, when
we replace the von-Mises turning angle distribution with a uniform distribution,

31

the numerical steady state solution of Eq. 10 (panel c) is visually very close to
that of panel (b), as expected.

32

Figure 1:

0.09

Probability density

0.08

0.30 b)

a)

0.25

0.07
0.06

0.20

0.05
0.04

0.15

0.03

0.10

0.02

0.05

0.01
0.00
0
0.040

Probability density

0.035

10

20

30

40

50

60

70

0.00

0

50

100

150

0

50

100

150

0.30 d)

c)

0.030

0.25

0.025

0.20

0.020

0.15

0.015

0.10

0.010

0.05

0.005
0.000
0

−150 −100 −50

10

20

30

40

50

60

Step length (m)

70

80

90

0.00

33

−150 −100 −50

Turning angle (degrees)

Figure 2:

1.5

45

a)

1.5

40

120

b)

100

Canopy height
Y (km)

35

Y (km)

80

Topography

30

1.0

1.0

25

60

20
15

0.5

40

0.5

10
0.0

20

5
0.0

0.2

0.4

0.6

0.8

X (km)

1.0

1.2

0.0

0

34

0.0

0.2

0.4

0.6

0.8

X (km)

1.0

1.2

0

Figure 3:
b)

24

c)

1.0

1.0

0.9

0.9

0.9

21

Probability density

a)
1.0

0.8

15

Y (km)

Y (km)

Y (km)

18

0.8

12
9

0.8

6
0.7

0.7
0.3

0.4

0.5

X (km)

0.6

0.7

0.7
0.3

0.4

0.5

X (km)

0.6

35

0.7

3
0.3

0.4

0.5

X (km)

0.6

0.7

0

