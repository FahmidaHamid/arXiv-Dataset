Trophic coherence determines food-web stability
Samuel Johnson,1∗ Virginia Domı́nguez-Garcı́a,2 Luca Donetti,3 and
Miguel A. Muñoz2

arXiv:1404.7728v3 [q-bio.PE] 24 Nov 2014

1

Warwick Mathematics Institute, and Centre for Complexity Science,
University of Warwick, Coventry CV4 7AL, United Kingdom.
3

Departamento de Electromagnetismo y Fı́sica de la Materia, and
Instituto Carlos I de Fı́sica Teórica y Computacional,
Universidad de Granada, 18071 Granada, Spain.

4

Departamento de Electrónica y Tecnologı́a de Computadores, and CITIC-UGR,
Universidad de Granada, 18071 Granada, Spain.
∗

E-mail: S.Johnson.2@warwick.ac.uk

Abstract
Why are large, complex ecosystems stable? Both theory and simulations of current models predict the onset of instability with growing size
and complexity, so for decades it has been conjectured that ecosystems
must have some unidentified structural property exempting them from
this outcome. We show that trophic coherence – a hitherto ignored feature of food webs which current structural models fail to reproduce – is
a better statistical predictor of linear stability than size or complexity.
Furthermore, we prove that a maximally coherent network with constant
interaction strengths will always be linearly stable. We also propose a
simple model which, by correctly capturing the trophic coherence of food
webs, accurately reproduces their stability and other basic structural features. Most remarkably, our model shows that stability can increase with
size and complexity. This suggests a key to May’s Paradox, and a range
of opportunities and concerns for biodiversity conservation.

Keywords: Food webs, dynamical stability, May’s Paradox, diversity-stability
debate, complex networks.

Significance statement
The fact that large, complex ecosystems are particularly robust is mysterious
in the light of mathematical arguments which suggest they should be unstable
– i.e. susceptible to runaway fluctuations in species’ abundances. Here we show
that food webs (networks describing who eats whom in an ecosystem) exhibit a
property we call trophic coherence, a measure of how neatly the species fall into
distinct levels. We find that this property makes networks far more linearly stable than if the links (predator-prey interactions) were placed randomly between
species, or according to existing structural models. A simple model we propose
to capture this feature shows that networks can, in fact, become more stable
with size and complexity, suggesting a possible solution to the paradox.
1

Introduction
In the early seventies, Robert May addressed the question of whether a generic
system of coupled dynamical elements randomly connected to each other would
be stable. He found that the larger and more interconnected the system, the
more difficult it would be to stabilise [1, 2]. His deduction followed from the behaviour of the leading eigenvalue of the interaction matrix, which, in a randomly
wired system, grows with the square root of the mean number of links per element. This result clashed with the received wisdom in ecology – that large, complex ecosystems were particularly stable – and initiated the “diversity-stability
debate” [3, 4, 5, 6]. Indeed, Charles Elton had expressed the prevailing view
in 1958: “the balance of relatively simple communities of plants and animals
is more easily upset than that of richer ones; that is, more subject to destructive oscillations in populations, especially of animals, and more vulnerable to
invasions” [7]. Even if this description were not accurate, the mere existence
of rainforests and coral reefs seems incongruous with a general mathematical
principle that “complexity begets instability”, and has become known as May’s
Paradox.
One solution might be that the linear stability analysis used by May and
many subsequent studies does not capture essential characteristics of ecosystem
dynamics, and much work has gone into exploring how more accurate dynamical
descriptions might enhance stability [8, 5, 9]. But as ever better ecological data
are gathered, it is becoming apparent that the leading eigenvalues of matrices
related to food webs (networks in which the species are nodes and the links
represent predation) do not exhibit the expected dependence on size or link
density [10]. Food webs must, therefore, have some unknown structural feature
which accounts for this deviation from randomness – irrespectively of other
stabilising factors.
We show here that a network feature we call trophic coherence accounts for
much of the variance in linear stability observed in a dataset of 46 food webs,
and we prove that a perfectly coherent network with constant link strengths
will always be stable. Furthermore, a simple model that we propose to capture
this property suggests that networks can become more stable with size and
complexity if they are sufficiently coherent.

Results
Trophic coherence and stability
Each species in an ecosystem is generally influenced by others, via processes
such as predation, parasitism, mutualism or competition for various resources
[11, 12, 13, 14]. A food web is a network of species which represents the first kind
of influence with directed links (arrows) from each prey node to its predators [15,
16, 17, 18]. Such representations can therefore be seen as transport networks,
where biomass originates in the basal species (the sources) and flows through
the ecosystem, some of it reaching the apex predators (the sinks).
The trophic level of a species can be defined as the average trophic level of
its prey, plus one [19, 20]. Thus, plants and other basal species are assigned
level one, pure herbivores have level two, but many species will have fractional

2

values.1 A species’ trophic level provides a useful measure of how far it is from
the sources of biomass in its ecosystem. We can characterise each link in a
network with a trophic distance, defined as the difference between the trophic
levels of the predator and prey species involved (it is not a true “distance”
in the mathematical sense, since it can be negative). We then look at the
distribution of trophic distances over all links in a given network. The mean
of this distribution will always be equal to one, while we refer to its degree of
homogeneity as the network’s trophic coherence. We shall measure this degree
of order with the standard deviation of the distribution of trophic distances, q
(we avoid using the symbol σ since it is often assigned to the standard deviation
in link strengths). A perfectly coherent network, in which all distances are equal
to one (implying that each species occupies an integer trophic level), has q = 0,
while less coherent networks have q > 0. We therefore refer to this q as an
“incoherence parameter”. (For a technical description of these measures, see
Methods.)
A fundamental property of ecosystems is their ability to endure over time
[13, 18]. “Stability” is often used as a generic term for any measure of this characteristic, including for concepts such as robustness and resilience [21]. When
the analysis regards the possibility that a small perturbation in population densities could amplify into runaway fluctuations, stability is usually understood in
the sense of Lyapunov stability – which in practice tends to mean linear stability
[22]. This is the sense we shall be interested in here, and henceforth “stability”
will mean “linear stability”. Given the equations for the dynamics of the system, a fixed (or equilibrium) point will be linearly stable if all the eigenvalues
of the Jacobian matrix evaluated at this point have negative real part. Even
without precise knowledge of the dynamics, one can still apply this reasoning
to learn about the stability of a system just from the network structure of interactions between elements (in this case, species whose trophic interactions are
described by a food web) [2, 23, 24, 25]. In Methods (and, more extensively, in
Section 3.2 of Supporting Information), we describe how an interaction matrix
W can be derived from the adjacency (or predation) matrix A representing a
food web, such that the real part of W ’s leading eigenvalue, R = Re(λ1 ), is a
measure of the degree of self-regulation each species would require in order for
the system to be linearly stable. In other words, the larger R, the more unstable the food web. For the simple yet ecologically unrealistic case in which the
extent to which a predator consumes a prey species is proportional to the sum
of their (biomass) densities, the Jacobian coincides with W , and R describes the
stability for any configuration of densities (global stability). For more realistic
dynamics – such as Lotka-Volterra, type II or type III – the Jacobian must
be evaluated at a given point, but we show that the general form can still be
related to W (see Methods). Furthermore, by making assumptions about the
biomass distribution, it is possible to check our results for such dynamics (see
Section 3.2.1 of Supporting Information). In the main text, however, we shall
focus simply on the matrix W without making any further assumptions about
dynamics or biomass distributions.
1 In computing the mean trophic level, it is customary to weight the contribution of each
prey species by the fraction of the predator’s diet that it makes up. Since we are here only
considering binary networks, we do not perform this weighting. We also use the words predator
and prey as synonyms of consumer and resource, respectively, even in referring, say, to plants
and herbivores.

3

May considered a generic Jacobian in which link strengths were drawn from
a random distribution, representing all kinds of ecological interactions [1, 2].
Because, in this setting, the expected
value of the real part of the leading eigen√
value (R) should grow with SC, where S is the number of species and C the
probability that a pair of them be connected, larger and more interconnected
ecosystems should be less stable than small, sparse ones [26]. (Allesina and
Tang have recently obtained stability criteria for random networks with specific
kinds of interactions: although predator-prey relationships are more conducive
to stability than competition or mutualism, even a network consisting only of
predator-prey interactions should become more unstable with increasing size
and link density [27].)
We analyse the stability for each of a set of 46 empirical food webs from
several kinds of ecosystem (the details and references for these can be found in
Section √
2 of Supporting Information). In Fig. 1A we plot the R of each web
S, observing no significant correlation. Figure 1B shows R against
against
√
K, where K = SC is a network’s mean degree (often referred to as “complexity”). In contrast to a recent study by Jacquet et al. [10], who in their set of
food webs found no significant complexity-stability
relationship, we observe a
√
positive correlation between R and K. However, less than half the variance
in stability can be accounted for in this way. In Section 3.2.5 of Supporting
Information we also compare the empirical R values to the estimate derived by
Allesina and Tang for random networks in which
all links are predator-prey.
√
Surprisingly, the correlation is lower than for K (r2 = 0.230). The conclusion
of Jacquet and colleagues – namely, that food webs must have some non-trivial
structural feature which explains their departure from predictions for random
graphs – therefore seems robust.
Might this feature be trophic coherence? In Fig. 1C we plot R for the same
food webs against the incoherence parameter q. The correlation is significantly
stronger than with complexity – stability increases with coherence. However,
there are still outliers, such as the food web of Coachella Valley. We note that
although most forms of intra-species competition are not described by the interaction matrix, there is one form which is: cannibalism. This fairly common
practice is a well-known kind of self-regulation which contributes to the stability
of a food web (mathematically, negative elements in the diagonal of the interaction matrix shift its eigenvalues leftwards along the real axis). In Fig. 1D we
therefore plot the R and q we obtain after removing all self-links. Now Pearson’s
correlation coefficient is r2 = 0.804. In other words, cannibalism and trophic
coherence together account for over 80% of the variation in stability observed
in this dataset. In contrast, when√we compare stability without self-links to the
other measures, we
√ find that for S the correlation becomes negative (though
insignificant), for K it rises very slightly to r2 = 0.508, and for Allesina and
Tang’s estimate it drops below significance (see Section 3.2.5 of Supporting Information). In Section 3.2.1 of Supporting Information, we measure stability
according to Lotka-Volterra, type II and type III dynamics, and show that in
every case trophic coherence is the best predictor of stability.

Modelling food-web structure
Many mathematical models have been put forward to simulate various aspects
of food webs [28, 26, 29, 30, 31, 32, 33, 34, 18]. We shall focus here on so-called
4

1

1

Lakes
Estuaries
Marine
Rivers
Terrestrial

R

1

r2 = 0.461

1

2

r = 0.596

Rnc
2

2

r =0.804

r = 0.064
0

A

0
5

10

S

15
1/2

20

B

0
1

2

3

K

4

C

1/2

0
0

0.4

0.8

q

1.2

D

0

0.4

0.8

1.2

q (no cannibalism)

Figure 1. Scatter plots of stability (as measured by R, the real part of the
leading eigenvalue of the interaction matrix) against several network
properties in a dataset of 46 food webs; Pearson’s
correlation coefficient is
√
S,
where
S is the number of species
shown in each case. A: Stability against
√
(r2 = 0.064). B Stability against K, where K is the mean degree
(r2 = 0.461). C Stability against incoherence parameter q (r2 = 0.596). B
Stability after all self-links (representing cannibalism) have been removed
(Rnc ) against incoherence parameter q (r2 = 0.804).
structural, or static, models: those which attempt to reproduce properties of
food-web structure with a few simple rules. The best known is Williams and
Martinez’s Niche Model [35, 36]. This is an elegant way of generating non-trivial
networks by randomly assigning each species to a position on a “niche axis”,
together with a range of axis centred at some lower niche value. Each species
then consumes all other species lying within its range of axis, and none without.
The idea is that the axis represents some intrinsic hierarchy among species which
determines who can prey on whom. The Niche Model is itself based on Cohen
and Newman’s Cascade Model, which also has an axis, but species are randomly
assigned prey from amongst all those with lower niche values than themselves
[37]. Stouffer and colleagues proposed the Generalized Niche Model, in which
some of a species’ prey are set according to the Niche Model while the rest ensue
from a slightly refined version of the Cascade Model,2 the proportion of each
being determined by a contiguity parameter [39]. The Minimum Potential Niche
Model of Allesina and co-workers is similar, but includes (random) forbidden
links within species’ ranges, instead of extra ones, as a way of emulating the
effects of more than one axis – with the advantage that all the links of real
food webs have a non-zero probability of being generated by this model [40].
Meanwhile, the Nested Hierarchy Model of Cattin et al. takes into account that
phylogenetically close species are more likely to share prey than unrelated ones
[41]. (For details of the models, see Section 1 of Supporting Information.)
These models produce networks with many of the statistical properties of
food webs [36, 38, 40]. However, as we go on to show below, they tend to predict
significantly less trophic coherence (larger q) than we observe in our dataset. We
therefore propose the Preferential Preying Model (PPM) as a way of capturing
this feature. We begin with B nodes (basal species) and no links. We then
add new nodes (consumer species) sequentially to the system until we have a
total of S species, assigning each their prey from amongst available nodes in
2 The

Generalized Cascade Model is like the original Cascade Model except that the numbers of prey species are drawn from the Beta distribution used in the Niche Model and subsequent niche-based models [38]. This is the version of the model used throughout this paper,
as explained in Section 1.1 of Supporting Information.

5

the following way. The first prey species is chosen randomly, and the rest are
chosen with a probability that decays exponentially with their absolute trophic
distance to that initial prey species (i.e. with the absolute difference of trophic
levels). This probability is set by a parameter T that determines the degree of
trophic specialization of consumers. The number of prey is drawn from a Beta
distribution with a mean value proportional to the number of available species,
just as the other structural models described use a mean value proportional to
the niche value. (For a more detailed description, see Methods.)
The PPM is reminiscent of Barabási and Albert’s model of evolving networks
[42], but it is also akin to a highly simplified version of an “assembly model” in
which species enter via immigration [29, 32]. It assumes that if a given species
has adapted to prey off species A, it is more likely to be able to consume species
B as well if A and B have similar trophic levels than if not. It may seem that this
scheme is similar in essence to the Niche Model, with the role of niche-axis being
played by the trophic levels. However, whereas the niche values given to species
in niche-based models are hidden variables, meant to represent some kind of
biological magnitude, the trophic level of a node is defined by the emerging
network architecture itself. We shall see that this difference has a crucial effect
on the networks generated by each model.

The origins of stability
Figure 2A shows three networks with varying degrees of trophic coherence. The
one on the left was generated with the PPM and T = 0.01, and since it falls into
perfectly ordered, integer trophic levels, it is maximally coherent, with q = 0.
For the one on the right we have used T = 10, yielding a highly incoherent
structure, with q = 0.5. Between these two extremes we show the empirical food
web of a stream in Troy, Maine [43], which has the same number of basal species,
consumers and links as the two artificial networks, and an intermediate trophic
coherence of q = 0.18. Figure 2B shows how trophic coherence varies with T in
PPM networks. At about T = 0.25 we obtain the empirical trophic coherence of
the Troy food web (indicated with a dashed line). We also plot q for networks
generated with the Generalized Niche Model against “diet contiguity”, c, its
only free parameter [39]. At c = 0 and c = 1 we recover the Cascade and Niche
Models, respectively (see Section 1.4 of Supporting Information). However, diet
contiguity has little effect on trophic coherence.
Figure 2C shows the stability – as measured by R, the leading eigenvalue
of the interaction matrix – for the networks of Fig. 2B. For the PPM networks, stability closely mirrors trophic coherence: as T decreases, the networks
become more stable (smaller R) as well as more coherent (smaller q). The empirical value of R is obtained at about the same T which best approximates the
empirical q. The Generalized Niche Model also generates more stable networks
as diet contiguity is increased, but this effect cannot be due to trophic coherence, which remains nearly constant. The origin of increasing stability in this
model is revealed when we measure Rnc (R after removing all self-links from
the networks): the Generalized Niche Model now displays only a very small
dependence of stability on diet contiguity. In contrast, the behaviour of Rnc
with T in the PPM networks remains qualitatively the same as in the previous
case, and the empirical stability continues to be obtained at T ≃ 0.25 (in this
case, the empirical stabilities R and Rnc coincide, since the Troy food web has
6

Trophic Level

A

c

B

0

0.2

0.4

c
0.6

0.8

C

1

0

0.2

0.4

0.6

1
0.8

0.8

1

PPM
PPM no cannibals
GNM
GNM no cannibals

0.4

0.6

q

R

0.4

0.2

0.2
0

0
0

0.5

1

1.5

2

2.5

0

T

0.5

1

1.5

2

2.5

T

Figure 2. A: Three networks with differing trophic coherence, the height of
each node representing its trophic level. The networks on the left and right
were generated with the Preferential Preying Model (PPM), with T = 0.01
and T = 10, respectively, yielding a maximally coherent structure (q = 0) and
a highly incoherent one (q = 0.5). The network in the middle is the food web
of a stream in Troy, Maine, which has q = 0.18 [43]. All three have the same
numbers of species, basal species and links. B: Incoherence parameter, q,
against T for PPM networks with the parameters of the Troy food web
(green); and against c for Generalized Niche Model networks with the same
parameters (blue). The dashed line indicates the empirical value of q. C:
Stability (as given by R, the real part of the leading eigenvalue of the
interaction matrix) for the networks of panel B. Also shown is the stability of
networks generated with the same models and parameters, but after removing
self-links (empty circles). In panels B and C, the dashed line represents the
empirical value of R, while bars on the symbols are for one standard deviation.
no cannibals).
We perform this analysis for each of the 46 food webs in our dataset, obtaining the value of T which best captures the empirical trophic coherence according
to the PPM. We then compute the ensemble averages of R and Rnc generated
at this T , for comparison with the empirical values. Similarly, we compute the
average values of these measures predicted by each of the niche-based models
described above – the Cascade, Niche, Nested Hierarchy, Generalized Niche and
Minimum Potential Niche Models. The last two models have free parameters,
but as these do not have a significant effect on trophic coherence, we use the
values published as optimal in Refs. [38] and [40], respectively (or the mean
optimal values for those food webs which were not analysed in these papers).
Figures 3A-C show the average absolute deviations from the empirical values
for trophic coherence and stability, before and after removing self-links, for each
model. In Fig. 3A we observe that, as mentioned above, the niche-based models

7

fail to capture the trophic coherence of these food webs. Stability, whether with
or without considering self-links, is predicted by the PPM significantly better
than by any of the other models, as shown in Fig. 3B and Fig. 3C. This is
in keeping with Alessina and Tang’s observation that current structural models
cannot account for food-web stability [27]. In Section 3 of Supporting Information we show the results of similar model comparisons for several other network
measures: modularity, mean chain length, mean trophic level, and numbers of
cannibals and of apex predators. The PPM does as well as any of the other
models as regards numbers of cannibals and apex predators, and is significantly
better at predicting the other measures.3
Why does the trophic coherence of networks determine their stability? The
case of a maximally coherent structure, with q = 0 (such as the one on the left
in Fig. 2A), is amenable to mathematical analysis. In Section 4 of Supporting
Information we consider the undirected network that results from replacing
each directed link of the predation matrix with a symmetric link, the non-zero
eigenvalues of which always come in pairs of real numbers ±µj . We use this to
prove that the eigenvalues of the interaction matrix we are actually interested
√
in, if q = 0, will in turn come in pairs λj = ± −ηµj , where η is a parameter
related to the efficiency of predation (considered, for the proof, constant for all
pairs of species). All the eigenvalues will therefore be real if η < 0, zero if η = 0,
and imaginary if η > 0. A positive η is the situation which corresponds to a food
web – or any system in which the gain in a “predator” is accompanied by some
degree of loss in its “prey”. Therefore, a perfectly coherent network is a limiting
case which can be stabilised by an infinitesimal degree of self-regulation (such as
cannibalism or other intra-species competition). Any realistic situation would
involve some degree of self-regulation, so we can conclude that a maximally
coherent food web with constant link strengths would be stable.
Although a general, analytical relationship between trophic coherence and
stability remains elusive, it is intuitive to expect that a deviation from maximal coherence will drive the real part of the leading eigenvalue towards the
positive values established for random structures, as is indeed observed in our
simulations.

May’s Paradox
As we have seen, the PPM can predict the stability of a food web quite accurately
just with information regarding numbers of species, basal species and links, and
trophic coherence. But what does this tell us about May’s Paradox – the fact
that large, complex ecosystems seem to be particularly stable despite theoretical
predictions to the contrary? To ascertain how stability scales with size, S,
and complexity, K, in networks generated by different models, we must first
determine how K scales with S – i.e. if K ∼ S α , what value should we use
for α? Data in the real world are noisy in this regard, and both the “linkspecies law” (α = 0) and the “constant connectance hypothesis” (α = 1) have
been defended in the past, although the most common view seems to be that
3 Allesina and co-workers have developed a likelihood-based approach for comparing foodweb models [40]. We have not yet been able to obtain the corresponding likelihoods for the
PPM, but if this is done in the future it would provide a firmer basis from which to gauge the
models’ relative merits, and perhaps to build a more realistic model drawing on each one’s
strengths.

8

MAD(q)

A

MAD(R)

B

0.75

MAD(Rnc)

C

0.2

0.2

0.1

0.1

0

0

0.5

0.25

0

R

0

R

0.1

 =0.55
 =0.50
 =0.40

-0.5

PPM

1

MPNM

PPM T=10.0
PPM T=0.50
PPM T=0.30
PPM T=0.20
PPM T=0.01



1

NHM

0.5

NM

GNM

E

MPNM
CM
NHM
GNM
NM

CM

PPM

MPNM

NHM

NM

GNM

CM

PPM

MPNM

NHM

NM

GNM

CM

D

0.3

T

0.1
100

1000

100

S

1000
S

Figure 3. A: Mean Absolute Deviations (MAD) from empirical values of the
incoherence parameter, q, for each food-web model – Cascade (CM),
Generalized Niche (GNM), Niche (NM), Nested Hierarchy (NHM), Minimum
Potential Niche (MPNM) and Preferential Preying (PPM) – as compared to a
dataset of 46 food webs. B: MAD from empirical values of stability, R, for the
same models and food webs as in panel A. C: MAD from empirical values of
stability, R, after removing self-links, for the same models and food webs as in
panels A and B. D: Scaling of stability, R, with size, S, in networks generated
with √
each of the models of previous panels except for the PPM. Mean degree is
K = S. The dashed line indicates the slope predicted for random matrices
by May [1], while the dotted curve is from Allesina and Tang [27]. E: Scaling
of stability, R, with size, S, in PPM networks generated with different values
of T . In descending order, T = 10, 0.5, 0.3, 0.2 and 0.01. B = 0.25S. Inset:
Slope, γ, of the stability-size line against T for α = 0.55, 0.5 and 0.4, where
the mean degree is K = S α . In panels D and E, bars on the symbols are for
one standard deviation.
α lies somewhere between zero and 1/2 [12, 26, 44]. The most recent empirical
estimate we are aware of is close to α ≃ 0.5, depending slightly on whether
predation weights are considered [45]. In our dataset, the best fit is achieved
with a slightly lower exponent, α = 0.41.
In Fig. 3D we show how stability scales with S in each of the niche-based
models when complexity increases with size according to α = 0.5.√The dashed
line shows the slope that May predicted for random networks (R ∼ K = S 0.25 )
[1]. We also plot the curve recently shown by Allesina and Tang to correspond
to random networks in which all interactions are predator-prey [27], which has
a similar slope to May’s at large S. This scaling is indeed closely matched by
the Cascade Model. The behaviour of the other models is similar (except for

9

the Nested Hierarchy Model, in which R increases more rapidly at high S),
and, as expected, networks always become less stable with increasing size and
complexity. In Fig. 3E we show how the stability of PPM networks scales in
the same scenario. For high T , their behaviour is similar to that of the Cascade
Model: R ∼ S γ , with γ ≃ 0.25. However, the exponent γ decreases as T is
lowered, until, for sufficiently large and coherent networks, it becomes negative
– in other words, stability increases with size and complexity. The inset in Fig.
3E shows the exponent γ obtained against T , for different values of α. The
smaller α, the larger the range of T which yields a positive complexity-stability
relationship.4
In Section 3.2.1 of Supporting Information we extend this analysis to specific
dynamics – Lotka-Volterra, type II and type III – by assuming an exponential
relationship between biomass and trophic level which can be described as a
pyramid. The positive complexity-stability relationship does not appear to depend on the details of dynamics. However, the slope of the R − S curve varies
with both the squatness of the biomass pyramid and the extent to which the
pyramid is corrupted by noise. A squat pyramid (more biomass at low trophic
levels than at high ones) has the strongest relationship, while for an inverted
pyramid (more biomass at high trophic levels than at low ones) the slope can
flatten out or change sign. Noise in the biomass pyramid tends always to weaken
the positive complexity-stability relationship, and can also change its sign.

Discussion
The predation matrices corresponding to real ecosystems are clearly peculiar
in some way, since their largest eigenvalues do not depend solely on their size
or complexity, as we would expect both from random graph theory and structural food-web models. This is in keeping with the empirical observation that
large, complex ecosystems are particularly stable, but challenges current thinking on food-web architecture. We have shown that the structural property we
call trophic coherence is significantly correlated with food-web stability, despite
other differences between the ecosystems and the variety of empirical methods
used in gathering the data. In fact, cannibalism and trophic coherence together
account for most of the variance in stability observed in our dataset. Furthermore, we have proved that a maximally coherent food web with constant
interaction strengths will always be stable.
We have suggested the Preferential Preying Model as a simple algorithm for
generating networks with tunable trophic coherence. Although this model does
not attempt to replicate other characteristic features of food webs – such as a
phylogenetic signal or body-size effects – it reproduces the empirical stability
of the 46 webs analysed quite accurately once its only free parameter has been
adjusted to the empirical degree of trophic coherence. Most remarkably, the
model predicts that networks should become more stable with increasing size
and complexity, as long as they are sufficiently coherent and the number of
4 Plitzko and colleagues recently showed that there exists a range of parameters (in a
Generalized Modeling framework [46]) for which Niche Model networks can increase in stability
with complexity [47]. However, for this study networks were rejected unless they were stable
and had exactly four trophic levels. This selection may have screened for trophic coherence,
cannibalism or other structural features.

10

links does not grow too fast with size. Although this result should be followed
up with further analytical and empirical research, it suggests that we need no
longer be surprised at the high stability of large, complex ecosystems.
We must caution that these findings do not imply that trophic coherence
was somehow selected for by the forces of nature in order to improve foodweb function. It seems unlikely that there should be any selective pressure on
the individuals making up a species to do what is best for their ecosystem.
Rather, many biological features of a species are associated with its trophic
level. Therefore, adaptations which allow a given predator to prey on species
A are likely to be useful also in preying on species B if A and B have similar
trophic levels. This leads to trophic coherence, which results in high stability.
If stability decreased with size and complexity, as previous theoretical studies
have assumed, ecosystems could not grow indefinitely, for they would face a cutoff point beyond which they would become unstable [26]. On the other hand,
if real ecosystems are coherent enough that they become more stable with size
and complexity, as our model predicts, then the reverse might be true. We must
also bear in mind, however, that our results are only for linear stability, whereas
structural stability, for instance, may depend differently on size and coherence,
and could become the limiting factor [18]. In any case, ascertaining whether
the loss of a few species would stabilise or destabilise a given community could
be important for conservation efforts, particularly for averting “tipping points”
[14].
The findings we report here came about by studying food webs. However,
directed networks of many kinds transport energy, matter, information, capital
or other entities in a similar way to how food webs carry biomass from producers
to apex predators. It seems likely that the relation between a network’s trophic
coherence and its leading eigenvalue will be of consequence to other disciplines,
and perhaps the Preferential Preying Model, though overly simplistic for many
scenarios, may serve as a first approximation for looking into these effects in a
variety of systems.

Methods
Measuring stability
Let us assume that the populations of species making up an ecosystem (each
characterised by its total biomass) change through time according to some set
of nonlinear differential equations, the interactions determined by the predation
matrix, A (whose elements aij take the value one if species i preys on species
j, and zero otherwise). If the system persists without suffering large changes
it must, one assumes, find itself in the neighbourhood of a fixed point of the
dynamics. We can study how the system would react to a small perturbation
by expanding the equations of motion around this fixed point and keeping only
linear terms. The subsequent effect of the perturbation is then determined by
the corresponding Jacobian matrix, and the system will tend to return to the
fixed point only if the real parts of all its eigenvalues are negative [22].
Even without knowledge of the details of the dynamics, it is possible to draw
some conclusions about the stability of a food web solely from its predation
matrix [23]. Independently of the exact interaction strengths, we know that

11

not all the biomass lost by a prey species when consumed goes to form part
of the predator – in fact, this efficiency is relatively low [48]. It is therefore
natural to assume that the effect of species j on species i will be mediated
by wij = ηaij − aji , where η is an efficiency parameter which, without further
information, we can consider equal for all pairs of species. We can thus treat the
interaction matrix W = ηA − AT as the Jacobian of some unspecified dynamics.
However, we have ignored the stabilising effect of intra-species competition –
the fact that individuals within a species compete with each other in ways
which are not specified by the predation matrix. This would correspond to
real values to be subtracted from the diagonal elements of W , thereby shifting
its set of eigenvalues (or spectrum) leftwards along the real axis. Therefore,
the eigenvalue with largest real part of W , as defined above, can be seen as a
measure of the minimum intra-species competition required for the system to
be stable. Thus, the lower this value, R = Re(λ1 ), the higher the stability.
In Section 3.2 of Supporting Information, we describe this analysis in more
detail. Beginning with a general consumer-resource differential equation for
the biomass of each species, we obtain the Jacobian in terms of the function
F (xi , xj ) which describes the extent to which species i consumes species j. For
the simple (and unrealistic) case F = xi +xj , the Jacobian reduces to the matrix
W as given above, independently of the fixed point. For more realistic dynamics,
the Jacobian depends on the fixed point. For instance, for the Lotka-Volterra
function F = xi xj , the off-diagonal elements of the Jacobian are Jij = wij xi . If
we set F = xi H(xj ) (with H(x) = xh /(xh + xh0 ), x0 the half-saturation density
and h the Hill coefficient), we have either type II (h = 1) or type III (h = 2)
dynamics [49]. Then the off-diagonal elements are Jij = [η̃(xi , xj )aij −aji ]H(xi ),
−(h+1)
where the effective efficiency is η̃(xi , xj ) = ηhxh0 xi xj
H(xj )2 /H(xi ).
The Jacobians for Lotka-Volterra, type II and type III dynamics are all
similar in form to the matrix W , although for an exact solution we require
the fixed point. In the main text we therefore use the leading eigenvalue of
W as a generic measure of stability. However, in Section 3.2.1 of Supporting
Information we consider the effects that different kinds of biomass distribution
have on each of these more realistic dynamics. The results are qualitatively the
same as those for the matrix W , although we find that both the squatness of a
biomass pyramid and the level of noise in this structure affect the strength of
the diversity-stability relationship described in the main text.
This measure of stability depends on the parameter η. In Section 3.2.2 of
Supporting Information we show that the results reported here remain qualitatively unchanged for any η ∈ (0, 1), and discuss how stability is affected when
we consider η > 1 or η < 0. We also look into the effects of including a noise
term so that η does not have the same value for each pair of species, and find
that our results are robust to this change too. For the results in the main text,
however, we use the fixed value η = 0.2.

Trophic levels and coherence
The trophic level si of species i is defined as the average trophic level of its prey,
plus one [19]. That is,
1 X
aij sj ,
(1)
si = 1 + in
ki j

12

P
where kiin = j aij is the number of prey of species i (or i’s in-degree), and aij
are elements of the predation matrix A. Basal species (those with k in = 0) are
assigned s = 1. The trophic level of each species is therefore a purely structural
(i.e. topological) property which can be determined by solving a system of linear
equations. Since we only consider unweighted networks here (the elements of A
are ones and zeros), we omit the link strength term usually included in Eq. (1)
[19].
We can write Eq. (1) in terms of a modified graph Laplacian matrix, Λs = v,
where s is the vector of trophic levels, v is the vector with elements vi =
max(kiin , 1), and Λ = diag(v)− A. Thus, every species can be assigned a trophic
level if and only if Λ is invertible. This requires at least one basal species (else
zero would be an eigenvalue of Λ). However, note that cycles are not, in general,
a problem, despite the apparent recursivity of Eq. (1)
We define the “trophic distance” spanned by each link (aij = 1) as xij =
si − sj (which is not a distance in the mathematical sense since it can take
negative values). The distribution of trophic distances over the network is p(x),
which will
P have mean hxi = 1 (since for any node i the average over its incoming
links is j aij (si −sj )/kiin = 1 by definition). We define the “trophic coherence”
of the network as the homogeneity of p(x): the more similar the trophic distances
of all the links, the more coherent. As a measure of coherence, we therefore use
the standard deviation
of the distribution, which
we refer to as an incoherence
p
P
parameter: q P
= hx2 i − 1, where h·i = L−1 ij (·)aij , and L is the total number
of links, L = ij aij .
Trophic coherence bears a close resemblance to Levine’s measures of “trophic
specialization” [19]. However, our average is computed over links instead of
species, with the consequence that we need not consider the distinction between resource and consumer specializations. It is also related to measures of
omnivory: in general, the more omnivores one finds in a community, the less
coherent the food web.

The Preferential Preying Model
We begin with B nodes (basal species) and no links. We then add, sequentially,
S − B new nodes (consumer species) to the system according to the following
rule. A new node i is first awarded a random node j from among all those
available when it arrives. Then another κi nodes l are chosen with a probability
Pil that decays with the trophic distance between j and l. Specifically, we use
the exponential form


|sj − sl |
,
Pil ∝ exp −
T
where j is the first node chosen by i, and T is a parameter that sets the degree
of trophic specialization of consumers.
The number of extra prey, κi , is obtained in a similar manner to the Niche
Model prescription, since this has been shown to provide the best approximation
to the in-degree distributions of food webs [38]. We set κi = xi ni , where ni is
the number of nodes already in the network when i arrives, and xi is a random
variable drawn from a Beta distribution with parameters
β=

S2 − B2
− 1,
2L
13

where L is the expected number of links. In this work, we only consider networks
with a number of links within an error margin of 5% of the desired L; thus, for
all the results reported, we have imposed this filter on the PPM networks and
those generated with the other models.
To allow for cannibalism, the new node i is initially considered to have a
trophic level si = sj + 1 according to which it might then choose itself as prey.
Once i has been assigned all its prey, si is updated to its correct value.

Acknowledgements
We are grateful to J. Dunne and U. Jacob for providing food-web data and to J.
Hidalgo for technical help. Many thanks also to N.S. Jones, D.C. Reuman, D.B.
Stouffer, J. Bascompte, I. Mendoza, J.A. Bonachela, S.A. Levin, O. Al Hammal, A. Thierry, A. Maritan, N. Guisoni, G. Baglietto, E. Albano, B. Moglia,
J.J. Torres, and J.A. Johnson for conversations and comments on versions of
the manuscript. We acknowledge financial support from the Spanish MICINNFEDER under project FIS2009-08451 and from Junta de Andalucı́a Proyecto
de Excelencia P09FQM-4682. S.J. is grateful for support from the Oxford Centre for Integrative Systems Biology, University of Oxford; and from the European Commission under the Marie Curie Intra-European Fellowship Programme
PIEF-GA-2010-276454.

14

References
[1] R. M. May, “Will a large complex system be stable,” Nature, vol. 238,
pp. 413–14, 1972.
[2] R. M. May, Stability and complexity in model ecosystems. Princeton, USA:
Princeton University Press, 1973.
[3] R. MacArthur, “Fluctuations of animal populations, and a measure of
community stability,” Ecology, vol. 36, pp. 533–5, 1955.
[4] R. Paine, “Food web complexity and species diversity,” Am. Nat., vol. 100,
pp. 65–75, 1966.
[5] K. S. McCann, “The diversity-stability debate,” Nature, vol. 405, pp. 228–
33, 2000.
[6] J. A. Dunne, U. Brose, R. J. Williams, and N. D. Martinez, “Modeling food-web dynamics: complexity-stability implications,” Aquatic Food
Webs: An Ecosystem Approach, pp. 117–129, 2005.
[7] C. S. Elton, Ecology of Invasions by Animals and Plants. London: Chapman and Hall, 1958.
[8] D. L. DeAngelis and J. C. Waterhouse, “Equilibrium and nonequilibrium
concepts in ecological models,” Ecol. Monogr., vol. 57, pp. 1–21, 1987.
[9] U. Brose, R. J. Williams, and N. D. Martinez, “Allometric scaling enhances stability in complex food webs,” Ecology Letters, vol. 9,
p. 1228–1236, 2006.
[10] C. Jacquet, C. Moritz, L. Morissette, P. Legagneux, F. Massol, P. Archambault, and D. Gravel, “No complexity-stability relationship in natural communities,” arXiv:1307.5364, 2013.
[11] C. S. Elton, Animal Ecology. London: Sidgwick and Jackson, 1927.
[12] S. L. Pimm, The Balance of Nature? Ecological Issues in the Conservation
of Species and Communities. Chicago: The University of Chicago Press,
1991.
[13] R. V. Solé and J. Bascompte, Self-Organization in Complex Ecosystems.
Princeton, USA: Princeton University Press, 2006.
[14] W. J. Sutherland, R. P. Freckleton, H. C. J. Godfray, S. R. Beissinger,
T. Benton, D. D. Cameron, Y. Carmel, D. A. Coomes, T. Coulson, M. C.
Emmerson, R. S. Hails, and G. C. Hays, “Identification of 100 fundamental
ecological questions,” Journal of Ecology, vol. 101, pp. 58–67, 2013.
[15] S. L. Pimm, Food Webs. London: Chapman and Hall, 1982.
[16] J. A. Dunne, R. J. Williams, and N. D. Martinez, “Network structure
and robustness of marine food webs,” Mar. Ecol. Prog. Ser., vol. 273,
pp. 291–302, 2004.

15

[17] B. Drossel and A. J. McKane, “Modelling Food Webs”, in A Handbook of
Graphs and Networks: From the Genome to the Internet. Berlin: WileyVCH, 2003.
[18] A. G. Rossberg, Food Webs and Biodiversity: Foundations, Models, Data.
Wiley, 2013.
[19] S. Levine, “Several measures of trophic structure applicable to complex
food webs,” J. Theor. Biol., vol. 83, pp. 195–207, 1980.
[20] D. Pauly, V. Christensen, J. Dalsgaard, R. Froese, and F. Torres, “Fishing
down marine food webs,” Science, vol. 279, pp. 860–3, 1998.
[21] V. Grimm and C. Wissel, “Babel, or the ecological stability discussions:
An inventory and analysis of terminology and a guide for avoiding confusion,” Oecologia, vol. 109, pp. 323–334, 1997.
[22] P. Holmes and E. T. Shea-Brown, “Stability,” Scholarpedia, vol. 1, p. 1838,
2006.
[23] R. M. May, “Qualitative stability in model ecosystems,” Ecology, vol. 54,
pp. 638–41, 1973.
[24] D. O. Logofet, “Stronger-than-Lyapunov notions of matrix stability, or
how “flowers” help solve problems in mathematical ecology,” Linear Algebra and its Applications, vol. 398, pp. 75–100, 2005.
[25] D. O. Logofet, Matrices and Graphs: Stability Problems in Mathematical
Ecology. Boca Raton: CRC Press, 1993.
[26] R. Solé, D. Alonso, and A. McKane, “Scaling in a network model of a
multispecies ecosystem,” Physica A, vol. 286, pp. 337–44, 2000.
[27] S. Allesina and S. Tang, “Stability criteria for complex ecosystems,” Nature, vol. 483, pp. 205–8, 2012.
[28] G. Caldarelli, P. G. Higgs, and A. J. McKane, “Modelling coevolution in
multispecies communities,” J. Theor. Biol., vol. 193, pp. 345–58, 1998.
[29] U. Bastolla, M. Laessig, S. Manrubia, and A. Valleriani, “Diversity patterns from ecological models at dynamical equilibrium,” J. Theor. Biol.,
vol. 212, pp. 11–34, 2001.
[30] N. Loeuille and M. Loreau, “Evolutionary emergence of size-structured
food webs,” Proc. Natl. Acad. Sci. USA, vol. 102, p. 5761, 2005.
[31] A. G. Rossberg, H. Matsuda, T. Amemiya, and K. Itoh, “Food webs:
experts consuming families of experts,” J. Theor. Biol., vol. 241, pp. 552–
63, 2006.
[32] A. J. McKane and B. Drossel, Models of food web evolution, in Ecological
Networks: Linking Structure to Dynamics in Food Webs. M. Pascual and
J.A. Dunne, eds. Oxford, UK: Oxford University Press, 2006.
[33] S. Allesina and M. Pascual, “Food web models: a plea for groups,” Ecol.
Lett., vol. 12, pp. 652–62, 2009.
16

[34] A. G. Rossberg, A. Brännström, and U. Dieckmann, “Food-web structure
in low- and high-dimensional trophic niche spaces,” Journal of The Royal
Society Interface, 2010.
[35] R. J. Williams and N. D. Martinez, “Simple rules yield complex food
webs,” Nature, vol. 404, pp. 180–183, 2000.
[36] R. J. Williams and N. D. Martinez, “Success and its limits among structural models of complex food webs,” Journal of Animal Ecology, vol. 77,
pp. 512–519, 2008.
[37] J. E. Cohen and C. M. Newman, “A stochastic theory of community
food webs I. models and aggregated data,” Proc. R. Soc. London Ser. B.,
vol. 224, pp. 421–448, 1985.
[38] D. B. Stouffer, J. Camacho, R. Guimerà, C. A. Ng, and L. A. N. Amaral,
“Quantitative patterns in the structure of model and empirical food webs,”
Ecology, vol. 86, p. 1301–1311, 2005.
[39] D. B. Stouffer, J. Camacho, and L. A. N. Amaral, “A robust measure of
food web intervality,” Proc. Natl. Acad. Sci. USA, vol. 103, pp. 19015–
19020, 2006.
[40] S. Allesina, D. Alonso, and M. Pascual, “A general model for food web
structure,” Science, vol. 320, pp. 658–661, 2008.
[41] M. F. Cattin, L. F. Bersier, C. Banasek-Richter, R. Baltensperger, and
J. P. Gabriel, “Phylogenetic constraints and adaptation explain food-web
structure,” Nature, vol. 427, pp. 835–9, 2004.
[42] A. L. Barabási and R. Albert, “Emergence of scaling in random networks,”
Science, vol. 286, pp. 509–512, 1999.
[43] R. Thompson and C. Townsend, “Impacts on stream food webs of native and exotic forest: an intercontinental comparison,” Ecology, vol. 84,
pp. 145–61, 2003.
[44] A. G. Rossberg, K. D. Farnsworth, K. Satoh, and J. K. Pinnegar, “Universal power-law diet partitioning by marine fish and squid with surprising
stability-diversity implications,” Proc. R. Soc. B, vol. 278, pp. 1617–25,
2011.
[45] C. Banašek-Richter, L. Bersier, M. Cattin, R. Baltensperger, J. Gabriel,
and J. Merz, et al., “Complexity in quantitative food webs,” Ecology,
vol. 90, pp. 1470–7, 2009.
[46] T. Gross, L. Rudolf, S. Levin, and U. Dieckmann, “Generalized models
reveal stabilizing factors in food webs,” Science, vol. 325, pp. 747–50,
2009.
[47] S. Plitzko, B. Drossel, and C. Guill, “Complexity–stability relations in
generalized food-web models with realistic parameters,” J. Theor. Biol.,
vol. 306, pp. 7–14, 2012.

17

[48] R. L. Lindeman, “The trophic-dynamic aspect of ecology,” Ecology,
vol. 23, pp. 399–418, 1942.
[49] L. Real, “Kinetics of functional response,” Am. Nat., vol. 111, pp. 289–
300, 1977.

18

arXiv:1404.7728v3 [q-bio.PE] 24 Nov 2014

Trophic coherence determines food-web stability
Supporting Information
Samuel Johnson,1∗ Virginia Domı́nguez-Garcı́a,2 Luca Donetti,3 and
Miguel A. Muñoz2
1

Warwick Mathematics Institute, and Centre for Complexity Science,
University of Warwick, Coventry CV4 7AL, United Kingdom.
3

Departamento de Electromagnetismo y Fı́sica de la Materia, and
Instituto Carlos I de Fı́sica Teórica y Computacional,
Universidad de Granada, 18071 Granada, Spain.

4

Departamento de Electrónica y Tecnologı́a de Computadores, and

Centro de Investigación en Tecnologı́as de la Información y de las Comunicaciones,
Universidad de Granada, 18071 Granada, Spain.
∗

E-mail: S.Johnson.2@warwick.ac.uk

1

Contents
1 Food-web models
1.1 The Cascade Model . . . . . . . . . . . .
1.2 The Niche Model . . . . . . . . . . . . . .
1.3 The Nested Hierarchy Model . . . . . . .
1.4 The Generalized Niche Model . . . . . . .
1.5 The Minimum Potential Niche Model . . .
1.6 The Preferential Preying Model . . . . . .
1.6.1 Possible amendments to the PPM
1.6.2 Negative temperatures . . . . . . .

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

2 Food-web data

3
3
3
4
4
5
5
5
7
8

3 Network measures
3.1 Trophic coherence . . . . . . . . . . . .
3.2 Stability . . . . . . . . . . . . . . . . . .
3.2.1 Biomass distribution . . . . . . .
3.2.2 Efficiency . . . . . . . . . . . . .
3.2.3 Herbivory . . . . . . . . . . . . .
3.2.4 Weighted networks . . . . . . . .
3.2.5 Feasibility . . . . . . . . . . . . .
3.2.6 Stability criteria . . . . . . . . .
3.2.7 Missing links and trophic species
3.3 Mean chain length . . . . . . . . . . . .
3.4 Modularity . . . . . . . . . . . . . . . .
3.5 Cannibals and apex predators . . . . . .
3.6 Mean trophic level . . . . . . . . . . . .
3.7 Comparison of network measures . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.

10
10
10
13
17
20
20
22
22
23
24
25
26
26
27

4 Analytical theory for maximally coherent
networks

31

5 References

35

2

1

Food-web models

We describe here the main structural (also called static) models found in the
literature for generating networks with some of the statistical features of food
webs. We then discuss some aspects of the Preferential Preying Model (PPM)
which we put forward in the main text (described in Methods). In all these
models, the number of links L can only be set in expected value. As is often
done, throughout this work we discard all generated networks which have a
number of links greater or smaller than this target L by more than five percent.
In Section 3 we describe several network measures and compare the performance
of the models using the food-web data listed in Section 2.

1.1

The Cascade Model

In the Cascade Model, each species i is assigned a random number ni drawn
from a uniform distribution between 0 and 1 [1]. For any pair (i, j), we set i to
be a consumer of j with a constant probability p if ni > nj , and with probability
zero if ni ≤ nj . With S species, we obtain an expected number of links L if we
set
2L
p=
.
S(S − 1)

This was the first attempt to show how networks with a structure in some senses
similar to real food webs could come about via simple rules.
Stouffer and co-workers later modified this model so that the number of
prey would be drawn from the Beta distribution used by the Niche Model (see
below), and called the new version the Generalized Cascade Model [2]. Since this
amendment improves the model’s predictions as regards distributions of prey
and predators (without, to the best of our knowledge, involving any drawbacks),
throughout this paper we use the Generalized Cascade Model.

1.2

The Niche Model

In the Niche Model, each species i is awarded a niche value ni as in the Cascade Model [3]. However, instead of choosing species with lower niche values
randomly for prey, i is constrained to consume the subset of species j such that
ci − ri /2 ≤ nj < ci + ri /2 – i.e., all those lying on an interval of the niche
axis of size ri and centred at ci , and none without. The range is defined as
ri = xi ni , where xi is drawn from a Beta distribution with parameters (1, β).
For S species and a desired number of links L, we must set
β=

S(S − 1)
− 1.
2L

The centre of the interval ci is drawn from a uniform distribution between ri /2
and min(ni , 1 − ri /2).
The rationale behind this model was that food webs were thought to be
interval – i.e., the species could be arranged in an ordering such that the prey
of any given predator were contiguous [4]. The Niche Model achieves this by
construction. More recent analysis has shown that food webs are not generally
perfectly interval, although they do usually exhibit a certain degree of intervality
[5, 6]. Nevertheless, the Niche Model has been tremendously successful, since it
3

outperforms the Cascade Model in approximating measurable features of food
webs, and even compares well to more elaborate models which take the Niche
Model as a basis [7]. It is still the model most commonly used whenever synthetic
networks similar to food webs are required.

1.3

The Nested Hierarchy Model

The Nested Hierarchy Model provides a way to take into account that phylogenetically similar species should have prey in common [8]. It gives each species
a niche value and a range, exactly as in the Niche Model. However, instead
of establishing links directly to species within the range, first the number of
prey to be consumed by each species is determined, in proportion to the range,
kiin ∝ ri , so as to generate an expected number of links L. These links are
then attributed in the following way. The species with lowest niche value has
no prey, while the one with the highest has no predators (so there is always at
least one basal species and one apex predator). Starting from the species with
second smallest niche value and going up in order of n, we take each species i
and apply the following rules to determine its kiin prey:
1. We choose a random species j already in the network (so nj ≤ ni ) and set it
as the first prey species of i.
2. If j has no predators other than i, we repeat 1 until either the chosen prey
does have other predators, or we reach kiin . Else we go to 3.
3. We determine the set of species which are prey to the predators of j. We
select, randomly, species from this set to become also prey of i until we either
complete kiin , or we go to 4.
4. We continue choosing prey species randomly from among those with lower
niche values. If we still have not reached kiin when these run out, we continue
choosing them randomly from those with higher niche values.
In this model, two consumers that share prey are assumed to be phylogenetically related, while the extra links that must at times be sought mimic the
effects of independent adaptation. We find it a particularly interesting model
because phylogenetic constraints should indeed be taken into account, and as
it stands our Preferential Preying Model (described below) does not do this.
One problem we find with the Nested Hierarchy Model, however, is that a given
species i is assumed to be related to a certain set A of species which share
common prey with i; but i will also belong to the set B of common prey of a
different set of consumers, and nothing constrains A and B to overlap. In other
words, the species related to i due to its prey are not the ones related to i due
to its predators, whereas in nature it is to be expected that phylogenetically
similar species should have both prey and predators in common. In fact, it has
recently been reported that common predators are statistically more significant
than common prey [9].

1.4

The Generalized Niche Model

The Generalized Niche Model was proposed to account for the fact that empirical food webs turned out not to be maximally interval, as predicted by the
Niche Model [5]. A contiguity parameter c was introduced, which would determine the proportion of prey to be allocated according to the Niche Model, the
rest ensuing from the Generalized Cascade Model. In other words, the Niche
4

Model would be implemented as before but with reduced ranges ri = cxi ni .
Then, for each species, the number of extra prey kicascade = (1 − c)xi ni S is
drawn randomly from among the available species with niche values lower than
ni , as in the Generalized Cascade Model. For c = 1 we have the Niche Model,
while c = 0 results in the Generalized Cascade Model.
The Generalized Niche Model has been shown to emulate real food webs very
successfully, at least as regards certain features, such as community structure
[10]. It is also often used as a convenient model for generating synthetic networks
with a view to studying food webs in silico [11].

1.5

The Minimum Potential Niche Model

The Minimum Potential Niche Model is similar to the Generalized Niche Model
in that it is a modification of the Niche Model which breaks up complete intervality by means of a parameter, f [12]. However, the motivation is slightly
different. The idea is that in reality there is more than one niche dimension constraining possible predation links (hence the lack of complete, one-dimensional
intervality), which implies that some of the links determined by the Niche Model
are actually “forbidden links”. The species are all allocated niche values ni and
ranges ri = xi ni as in the Niche Model. The species at the extremes of this
range are always consumed. However, the rest is considered a potential range
and the β parameter used in the Beta distribution from which xi is drawn is
now
S(S − 1)
− 1,
β=
2(L + F )
where F = f P , P being the total number of potential links given the ranges,
minus the species at the extremes. Once all the species have their ranges, each
species within will be consumed with a probability 1−f . Therefore, f = 0 results
in the original Niche Model, but f > 0 produces a proportion of forbidden links.
Allesina et al. suggested a framework for comparing niche-based models [12];
they computed the likelihood that the Cascade, Niche and Nested Hierarchy
models have of generating the links in a set of ten real food webs, and found
theirs (the Minimum Potential Niche Model) to be superior – and, in fact, the
only one capable of generating all the observed links.

1.6

The Preferential Preying Model

In the main text we propose the Preferential Preying Model (PPM) in order to
capture the trophic coherence of empirical food webs. The details are given in
Methods, so here we confine ourselves to displaying the scheme diagrammatically
in Fig. S1. We go on to list several possible amendments which could be made
to this basic version of the model and which may be of use to researchers wishing
to use the PPM for purposes other than our main one here – namely, to highlight
the importance of trophic coherence and its relevance to food-web stability.
1.6.1

Possible amendments to the PPM

• Basal species. All the niche-based models discussed allow the number
of producers, B, to emerge freely (although they are not, generally, particularly successful in predicting B [7]). We chose here to begin with a
5

Figure S 1. Diagram showing how networks are assembled in the Preferential
Preying Model (PPM), as described in Methods in the main text. In Panel A
a new node, labelled i, is introduced to the networks, and is randomly assigned
node 4 as its first prey species. In Panel B, the probabilities of next choosing
node 5 or node 6 are calculated, as functions of their trophic distance to node
4 (β = 1/T ). Node 5 is the closest, and in this case is taken as the second prey
species, as shown in Panel C.
set number of basal species, as in the Preferential Attachment Model [13].
We imagine that for most applications where synthetic networks are required it would be useful to have control over this parameter (which is
itself related to trophic coherence, as we show in Section 3.2.3). However,
if a freely emerging B were preferred – for instance, for a rigorous comparison against models which do not allow this value to be set easily –
it is straightforward to take the minimum κi equal to zero for incoming
species, thereby allowing a proportion of them to become producers.
• Numbers of prey. We have drawn the number of prey for each incoming
species from a Beta distribution, as in all the niche-based models, because
Stouffer et al. [2] have shown that this method yields a particularly good
fit to food-web data (we have also verified that this holds true for our
46 food-web dataset). However, were the model to be applied to systems
other than food webs, it may be preferable to use, for instance, a Poisson
or a Pareto distribution, depending on the in-degree distributions of the
networks to be emulated.
• Boltzmann factor. The functional form we have used to determine the
second and subsequent prey of an incoming species (an exponential in the
trophic distance divided by the parameter T ) is arbitrary; careful fitting
to data may suggest a better function. There is also no reason other
than simplicity to use the same value of T for each incoming species: one
could also draw a different value Ti for each incoming species form some
distribution, perhaps dependent on the trophic level of its first prey.
• Cycles. Directed loops in food webs are relatively rare, yet often present.
The PPM as described does not generate any of these cycles, but it could
easily be amended to do so by assigning each incoming species a small
number of predators as well as prey from amongst the species already in
the network. However, directed loops require some predators to consume
prey at higher trophic levels than theirs, so the more coherent a network,
the fewer directed loops are to be expected.

6

• Phylogeny and body size. In this simple incarnation, the PPM ignores
the main effects that most of the other models are based on, but these
could be taken into account in a “Generalized Preferential Preying Model”.
Something akin to a phylogenetic signal could be induced by introducing
a bias in the Boltzmann factor such that an incoming node tended to copy
the prey and predators of a randomly chosen species already in the network
– perhaps limiting in the Nested Hierarchy Model in the case where only
prey are copied. The Niche, Generalized Niche and Minimum Potential
Niche models assume that the niche ordering (usually thought to represent
body size, possibly in combination with other biological features) to some
extent constrains species to find prey within closed intervals thereof. A
bias could likewise be introduced in the Boltzmann factor of the PPM such
that intervals of the sequence of entry were preferred, if this constraint in
empirical networks turned out to be more than a spurious effect of trophic
coherence.
1.6.2

Negative temperatures

As discussed in the main text, the PPM can generate any level of trophic coherence between that of a maximally coherent structure (with T → 0) and one as
incoherent as would be obtained if attachment were random (at T → ∞). However, as shown in Table S1, some food webs (five out of the 46 in our dataset)
exhibit higher values of q even than this latter case. The PPM can also generate
greater incoherence than obtained at high positive T with negative values of this
parameter, as illustrated in Fig. S2. The curves of q and R would be continuous
if instead of T we used its inverse, β = 1/T . With this parameter, β = 0 corresponds to random attachment, with q falling monotonically from maximum
incoherence at β → −∞ to maximum coherence at β → +∞. A comparison of
the two panels in Fig. S2 shows that the effect of trophic coherence on stability
seems to saturate at about the q obtained with random attachment: greater
incoherence has little effect on R.

0.5
1
0.4
0.3

0.6

R

q

0.8

0.4

0.2

0.2

0.1

0

0
-2

-1

0
T

1

2

-2

-1

0
T

1

2

Figure S 2. Left: Trophic coherence, as measured by q, of networks
generated with the PPM with the parameters of Chesapeake Bay [14, 15],
against T , for a range which includes T < 0. Right: Stability, as measured by
R, for the networks of the panel on the left.

7

2

Food-web data

We have compiled a dataset of 46 food webs available in the literature, pertaining
to several ecosystem types. The methods used by the researchers to establish
the links between species vary from gut content analysis to inferences about the
behaviour of similar creatures. In Table S1 we list the food webs used along
with references to the relevant work. We also list, for each case, the number
of species S, of basal species B, the mean degree K, the ecosystem type, the
trophic coherence q, the value of the parameter T found to yield (on average)
the empirical q with the Preferential Preying Model, and the numerical label
used to represent the food web in several figures below.
Food web
Akatore Stream
Benguela Current
Berwick Stream
Blackrock Stream
Bridge Brook Lake
Broad Stream
Canton Creek
Caribbean (2005)
Caribbean Reef
Carpinteria Salt Marsh Reserve
Catlins Stream
Chesapeake Bay
Coachella Valley
Crystal Lake (Delta)
Cypress (Wet Season)
Dempsters Stream (Autumn)
El Verde Rainforest
Everglades Graminoid Marshes
Florida Bay
German Stream
Grassland (U.K)
Healy Stream
Kyeburn Stream
LilKyeburn Stream
Little Rock Lake
Lough Hyne
Mangrove Estuary (Wet Season)
Martins Stream
Maspalomas pond
Michigan Lake
Mondego Estuary
Narragansett Bay
Narrowdale Stream
N.E. Shelf
North Col Stream
Powder Stream

S
84
29
77
86
25
94
102
249
50
126
48
31
29
19
64
83
155
63
121
84
61
96
98
78
92
349
90
105
18
33
42
31
71
79
78
78

B
43
2
35
49
8
53
54
5
3
50
14
5
3
3
12
46
28
5
14
48
8
47
58
42
12
49
6
48
8
5
12
5
28
2
25
32
8

K
2.70
7.00
3.12
4.36
4.28
6.01
6.83
13.31
11.12
4.29
2.29
2.19
9.03
1.74
6.86
5.00
9.74
9.79
14.60
4.20
1.59
6.60
6.42
4.81
10.84
14.66
12.79
3.27
1.33
3.91
6.64
3.65
2.18
17.76
3.09
3.44

Type
River
Marine
River
River
Lake
River
River
Marine
Marine
Marine
River
Marine
Terrestrial
Lake
Terrestrial
River
Terrestrial
Terrestrial
Marine
River
River
River
River
River
Lake
Lake
Marine
River
Lake
Lake
Marine
Marine
River
Marine
River
River

q
0.16
0.76
0.18
0.19
0.59
0.16
0.16
0.75
0.99
0.65
0.20
0.47
1.34
0.28
0.63
0.23
1.02
0.66
0.59
0.21
0.40
0.22
0.18
0.23
0.69
0.62
0.67
0.32
0.48
0.38
0.74
0.66
0.25
0.82
0.28
0.22

T
0.26
0.87
0.25
0.25
1.15
0.16
0.18
0.70
-0.24
-8.27
0.27
0.67
-0.02
0.33
0.73
0.30
-0.82
0.47
0.48
0.29
0.72
0.24
0.18
0.29
0.75
0.66
0.47
0.49
-9.22
0.21
10.07
1.18
0.38
0.67
0.34
0.28

Reference
[16, 17, 18]
[19]
[16, 17, 18]
[16, 17, 18]
[20]
[16, 17, 18]
[21]
[22]
[23]
[24]
[16, 17, 18]
[14, 15]
[25]
[26]
[27]
[16, 17, 18]
[28]
[29]
[27]
[16, 17, 18]
[30]
[16, 17, 18]
[16, 17, 18]
[16, 17, 18]
[31]
[32, 33]
[27]
[16, 17, 18]
[34]
[35]
[36]
[37]
[16, 17, 18]
[38]
[16, 17, 18]
[16, 17, 18]

Label
18
11
34
27
14
35
2
17
13
33
19
5
12
37
42
36
15
44
26
28
4
29
30
31
8
46
43
20
39
40
41
38
21
10
22
23

Scotch Broom
Skipwith Pond
St. Marks Estuary
St. Martin Island
Stony Stream
Sutton Stream (Autum)
Troy Stream
Venlaw Stream
Weddell Sea
Ythan Estuary

85
25
48
42
109
80
77
66
483
82

1
1
6
6
61
49
40
30
61
5

2.62
7.88
4.60
4.88
7.61
4.19
2.35
2.83
31.81
4.82

Terrestrial
Lake
Marine
Terrestrial
River
River
River
River
Marine
Marine

0.45
0.68
0.69
0.59
0.17
0.15
0.18
0.23
0.75
0.46

0.49
0.23
1.02
0.60
0.18
0.19
0.30
0.33
1.01
0.38

[39]
[40]
[41]
[42]
[43]
[16, 17, 18]
[16, 17, 18]
[16, 17, 18]
[44]
[45]

Table S 1. Details of the 46 food webs used throughout the paper. From left
to right, the columns are for: name, number of species S, number of basal
species B, mean degree K, ecosystem type, trophic coherence q, value of the
parameter T found to yield (on average) the empirical q with the Preferential
Preying Model, references to original work, and the numerical label.

9

16
6
9
7
3
32
24
25
45
1

3
3.1

Network measures
Trophic coherence

In the Methods section of the main text we define the network structural property of trophic coherence. Here we simply illustrate the difference between a
maximally coherent network and a highly incoherent one in Fig. S3.

Figure S 3. Two example networks generated with the Preferential Preying
Model, illustrating the extremes of trophic coherence: the network on the left
was generated with T = 0.001 and has q = 0 (all links are between species
exactly one trophic level apart) while the one on the right is for T = 10
(almost random attachment) and has q = 0.7.
In Fig. S4 we show the empirical values of q observed in each of the 46
food webs (also displayed in Table S1) along with the predictions of each of the
food-web models discussed above and in the main text.

3.2

Stability

Let us assume that we have a set of ordinary differential equations governing
the evolution of the population of each species in an ecosystem, as measured,
for instance, by its total biomass xi . In vector form, we can write this as
d
x = f (x).
dt
The dynamics will have a fixed point at any configuration x∗ such that f (x∗ ) =
0. Let us suppose that the system is placed at this fixed point but suffers a
small perturbation ζ (t):
x(t) = x∗ + ζ (t).
For small enough |ζζ (t)|, its dynamics will be given by the linearised equation:
d
ζ (t) = J(x∗ )ζζ (t),
dt

10

q
q
q

1.8
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
2

4

6

8

10

12

14

16

18

20

22

24

26

28

30

32

34

36

1.4
1.2
1
0.8
0.6
0.4
0.2
0
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0

CM
ONM
NHM
GNM
MPNM
PPM
real
38

40

42

44

46

48

50

52

54

Figure S 4. Trophic coherence, as measured by q, for each of the food webs
listed in Table S1. The corresponding predictions of each food-web model
discussed in Section S1 – Cascade, Niche, Nested Hierarchy, Generalized
Niche, Minimum Potential Niche and Preferential Preying – are displayed with
bars representing one standard deviation about the mean. Empirical values
are black squares. The labelling of the food webs is indicated in the rightmost
column of Table S1.
x∗ ) is the Jacobian matrix [∂fi /∂xj ] evaluated at x ∗ . The fixed point
where J(x
x ∗ ) have negative real part [46].
will be locally stable if all the eigenvalues of J(x
Let us consider a fairly general dynamics for x ∗ given by a consumer-resource
model:
X
X
d
aji F (xj , xi ) + G(xi ).
(1)
aij F (xi , xj ) −
xi = ηij
dt
j
j
The first term on the right accounts for the increment in species i’s biomass
through consumption of its resources, the second term is the biomass lost to
its consumers, and the function G represents any factors which are not due to
interaction with other species. Since we are interested here in effects of interactions between species, we shall simply assume G(x) = γx with γ a constant.
The function F describes how the interaction between a consumer and a resource species depends on their respective biomasses. The parameter η is the
efficiency of predation – the proportion of biomass lost by a resource which goes
on to form part of the consumer. We shall in general consider this parameter
to be constant for all pairs of species (ηij = η, ∀i, j), but in Sections S3.2.2 and
S3.2.4 we look into the effects of varying its value. In the main text, we set this
11

parameter to η = 0.2.
The Jacobian, J, will be obtained by taking the partial derivatives of Eq.
(1), for each i, with respect to each xj .
In the simple case where the interaction between species is given by a sum,
F (xi , xj ) = xi + xj ,
we have
Jij = (ηaij − aji )(1 + δij ) + γδij ,

where δij is the Kronecker delta (equal to one when i = j, or else zero). Positive
terms added to or subtracted from the main diagonal of J simply shift its spectrum of eigenvalues to the right or left, respectively. Therefore, we concentrate
on the matrix
W = ηA − AT ,
(2)

where AT is the transpose of A, and consider λ1 , the eigenvalue of W with
the largest real part. Then, R = Re(λ1 ) can be regarded as a measure of
the minimum degree of self-regulation at each node which this dynamics would
require in order for the system to be stable. In other words, the smaller R, the
more stable we shall say the system is.
In this simple case defined by F (xi , xj ) = xi + xj the Jacobian is independent of the point x ∗ where it is evaluated. However, this will not, in general,
be the case and for other dynamics we would need to specify this point in order to characterise the stability of the system. For instance, in a generalised
Lotka-Volterra dynamics, the interaction is proportional to the biomass of both
consumer and resource,
F (xi , xj ) = xi xj ,
and the Jacobian becomes
Jij = (1 + δij )wij xi + γδij ,

(3)

where wij are the elements of the matrix W as given by Eq. (2). Note that this
expression depends on the biomass of species i (though not on j’s) at the point
of interest.
To capture the nonlinearities expected in a prey species’ functional response,
consumer-resource models often describe the interaction as
F (xi , xj ) = xi H(xj ),
where H is the Hill equation,
H(x) =

xh
,
xh0 + xh

with x0 the half-saturation density. The Hill coefficient h determines whether
the functional response is of type II (h = 1) or type III (h = 2) [47]. Now we
find that the Jacobian is
Jij = [η̃(xi , xj )aij − aji ]H(xi )
if i 6= j, where the effective efficiency of predation is
η̃(xi , xj ) =

xi ∂H(xj )
hxh0 xi H(xj )2
η = h+1
η,
H(xi ) ∂xj
H(xi )
xj
12

(4)

and, for the main diagonal elements,
Jii = {h[1 − H(xi )] + 1}H(xi )wii + γ.
In each of these kinds of dynamics it is necessary to evaluate the Jacobian at
a particular point: Equations (3) (Lotka-Volterra) and (4) (types II and III)
are similar in form to the matrix W of Eq. (2), but their terms are modified
by the biomass of the predator, or the biomasses of both prey and predator,
respectively. One might suggest that we only need identify a fixed point and
evaluate the equations there. But, in general, a feasible fixed point (in which
xi > 0 for all i) will not exist. Feasible fixed points could be defined by attributing weights to the elements of the interaction matrix A, but this would
involve decisions on how to do this in a realistic way which might render the
results somewhat arbitrary. (For a discussion on the feasibility of fixed points,
see Section S3.2.5.)
Throughout most of the paper we focus simply on the matrix W as given
by Eq. (2), for although the dynamics it describes exactly is not very realistic
(corresponding to the interaction term F (xi , xj ) = xi +xj in Eq. (1)), it captures
the essential behaviour of better motivated dynamics without requiring any
assumptions about the fixed point. In fact, if all species had the same biomass
at the fixed-point, then Eqs. (3) (Lotka-Volterra) and (4) (types II and III)
would also reduce to the matrix W as given by Eq. (2), for an appropriate
choice of the parameter η. However, so as to test the robustness of our results
to details of the dynamics, in Section S3.2.1 we look into the effects of different
distributions of biomass according together with Lotka-Volterra, type II or type
III dynamics. We find that the relationship between trophic coherence and
stability reported in the main text is robust to these considerations, although
the dependence of biomass on trophic level introduces interesting effects, in
particular for the complexity-stability scaling.
In the main text we describe how stability in directed networks (and food
webs in particular) is determined to a large extent by their trophic coherence.
In Fig. S5 we compare the predictions of each of the food-web models described
in Section 1 for each of the food webs listed in Table 1. Another network
feature which influences stability, as mentioned above, is the existence of selflinks (representing cannibalism, in the case of food webs), since this is a form
of self-regulation. We disentangle this effect from that of trophic coherence, we
remove all self-links from the food webs and again measure the real part of the
leading eigenvalue, Rnc . The predictions of each model are shown in Fig. S6.
In Section 4 we give a proof that a maximally coherent network (q = 0) with
constant interaction strengths can always be stabilised with an infinitesimal
degree of self-regulation.
3.2.1

Biomass distribution

As discussed in Section S3.2, the Jacobian corresponding to most kinds of biologically plausible dynamics will depend on details of the fixed point. In other
words, we need to know the biomass of each species in order to evaluate the Jacobian. Since only a fraction of the energy produced by a species can be used by
its consumers, ecosystems can often be regarded as pyramids in which biomass
is a decreasing function of trophic level [48]. More specifically, if we assume that
the biomass of a species is a constant fraction of the combined biomass of its
13

R

1.2
1
0.8
0.6
0.4
0.2
0
2

4

6

8

10

12

14

16

18

20

22

24

26

28

30

32

34

36

0.8

R

0.6
0.4
0.2

R

0
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0

CM
ONM
NHM
GNM
MPNM
PPM
real
38

40

42

44

46

48

50

52

54

Figure S 5. Stability, as measured by R, for each of the food webs listed in
Table S1. The corresponding predictions of each food-web model discussed in
Section S1 – Cascade, Niche, Nested Hierarchy, Generalized Niche, Minimum
Potential Niche and Preferential Preying – are displayed with bars
representing one standard deviation about the mean. Empirical values are
black squares. The labelling of the food webs is indicated in the rightmost
column of Table S1.
resources, biomass will be exponentially related to trophic level. We can thus
write
xi = ea(si −1) ,
(5)
with a a parameter determining the difference in biomass between predator and
prey species (for a = 0 there is no dependence of biomass on trophic level), and
set the basal species to unity biomass. A negative value of a then corresponds
to a pyramid in which biomass decreases with trophic level (note that a graphical representation of this situation will look like a pyramid if the size of each
echelon corresponds to the logarithm of its biomass). Although terrestrial food
webs have this distribution, in certain aquatic environments inverted pyramids
can arise, corresponding to a positive a. This is due to the effect of increasing longevity with trophic level, which can compensate to some extent for the
inefficiency of predation [48].
In order to examine the robustness of results to fluctuations in this exponential law, we can consider instead a biomass given by
xi = (1 + ξi )ea(si −1) ,
14

(6)

Rnc

1.4
1.2
1
0.8
0.6
0.4
0.2
0
2

4

6

8

10

12

14

16

18

20

22

24

26

28

30

32

34

36

1

Rnc

0.8
0.6
0.4
0.2

Rnc

0
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0

CM
ONM
NHM
GNM
MPNM
PPM
real
38

40

42

44

46

48

50

52

54

Figure S 6. Stability after removal of all self-links, Rnc , as measured by R,
for each of the food webs listed in Table S1. The corresponding predictions of
each food-web model discussed in Section S1 – Cascade, Niche, Nested
Hierarchy, Generalized Niche, Minimum Potential Niche and Preferential
Preying – are displayed with bars representing one standard deviation about
the mean. Empirical values are black squares. The labelling of the food webs
is indicated in the rightmost column of Table S1.
where the variables ξi are randomly drawn from a normal distribution with
mean zero and standard deviation σx . We can then use these values of x to
evaluate the Jacobian for each kind of dynamics and study the behaviour of its
leading eigenvalue, R.
Jacobian
W
WI
WII
WIII

√
S
0.064
0.045
0.088
0.107

√
K
0.461
0.219
0.359
0.426

q
0.596
0.431
0.456
0.608

15

q (no self-links)
0.804
0.730
0.658
0.582

Table S 2. First column: Jacobian used to compute stability of the empirical
food webs of Table S1. W is simply the interaction matrix, as used throughout
the main text; WI , WII and WIII correspond to types I, II and III,
respectively (where Lotka-Volterra is type I). For these cases, we assume an
uncorrupted biomass pyramid, as given by a = −0.2 in Eq. (5). Second, third
2
and fourth column, respectively: value
√ of the correlation coefficient r
√
obtained for R (stability) against S (where S is the number of species), K
(where K is the mean degree), and q (incoherence parameter). Fourth column:
as the third column, after removing all self-links. Compare with Fig. 1 of the
main text.

Table S2 shows the correlations between stability and the various network
measures shown in Fig. 1 of the main text over the 46 food webs in the dataset.
The first row displays the values for the simple case where the Jacobian is
considered equal to the interaction matrix W . The second, third and fourth
rows are for the cases of Lotka-Volterra, type II and type III dynamics, with
biomass distributed according to Eq. (5) and a = −0.2. The general pattern
shown in Fig. 1 of the main text is conserved for these more realistic dynamics.
In Fig. 7 we show the values of R obtained from the Lotka-Volterra Jacobian
given by Eq. (5) with different values of a, corresponding to pyramid, flat and
inverted pyramid distributions of biomass. The empirical values found for the
Chesapeake Bay food web [14, 15] with each distribution are compared to the
predictions of the Preferential Preying Model against T (left panel), and the
Generalized Niche Model against contiguity c (right panel). The effect of the
parameter T on stability in the PPM networks remains qualitatively the same
as the results reported in the main text for the matrix W given by Eq. (2).
The more squat the biomass pyramid (the more negative the parameter a),
the more stable are both the empirical and PPM networks. This is in keeping
with observations of ecosystems [48]. In the Generalized Niche Model networks,
however, the effect is opposite: it is the inverted pyramid (positive a), which is
most stable. We do not have an explanation for such an effect, but note that it
marks a qualitative difference between the networks generated with this model
and real food webs.
In Fig. 8 we look into how the biomass distribution affects the diversitystability relationship. All networks are generated with the Preferential Preying
Model and T = 0.01. The first row of panels is for the case where biomass decays
with trophic level as an uncorrupted exponential (σx = 0), for Lotka-Volterra,
type II and type III dynamics (top panels from left to right). As compared with
the constant biomass case (a = 0), a decaying distribution is seen to increase
the slope whereby R falls with S. In other words, placing more biomass at the
bottom of the food web than at the top not only increases stability, but also
strengthens the positive diversity-stability relationship exhibited by trophically
coherent networks. This occurs for all three kinds of dynamics, although the
effect is strongest for type III and weakest for type II. For an inverted pyramid
(positive a), R is approximately constant with S.
We go on to analyse the effect of corrupting the exponential distribution of
biomass with a noise of standard deviation σx . The second row of panels is for
16

0.6
a=0.2
a=0.0
a=-0.2

R

0.4

0.2

0
0

0.5

1
T

1.5

2

2.5

0

0.2

0.4
c

0.6

0.8

1

Figure S 7. Value of R obtained for the Lotka-Volterra Jacobian given by Eq.
(3), with biomass distributed according to Eq. (5) for a = −0.2 (pyramid), 0
(flat), and 0.2 (inverted pyramid). In each panel, the diamonds represent the
values for the empirical food web of Chesapeake Bay [14, 15]. Circles in the
panel on the left show the corresponding results for PPM networks against T
using the same parameters; triangles in the panel on the right are for networks
generated with the Generalized Niche Model against contiguity, c.
σx = 0.1. Although the slope is now less pronounced in all cases, this degree of
noise does not undermine the positive diversity-stability relationship for any of
the dynamics considered. Finally, in the bottom row we apply a higher noise,
σx = 0.4. Now the relationship is inverted and diversity decreases stability. It
is not, perhaps, surprising that noise in the distribution of biomass (large σx )
should have a similar effect on scaling as incoherence in the trophic structure
(large T ). However, it is interesting that the noise level at which the transition
from a positive to a negative diversity-stability relationship occurs does not
seem to depend on a or on the kind of dynamics.
3.2.2

Efficiency

According to the definition of R above, we must give a value to the parameter
η in order to measure stability. The value of this parameter affects the kind
of interaction we intend to model with the interaction matrix, W = ηA − AT ,
and has a strong bearing on the values of R measured. The definition of W
captures the fact that the effect of a prey species on one of its predators is a
proportion η of the effect of the predator on the prey. If we are considering the
flow of biomass from prey to predator, this should be a relatively small fraction
– for instance, the “ten percent law” is often used as a rough estimate of the
efficiency of predation [49]. On the other hand, our definition of stability is only
strictly independent of the fixed point for a dynamics such as the one described
above. For a more realistic dynamics, we might expect a multiplicative factor
to appear relating the fixed-point biomass of a prey species to that of one of its
predators. The parameter η might therefore be increased (or decreased) by this
effect.
As mentioned above, throughout the paper we use the value η = 0.2. However, simulations of the PPM show that using the value of the parameter T
which best approximates the empirical degree of trophic coherence is enough to

17

Lotka-Volterra

R

σx = 0

1

a=0.2
a=0.0

Type II

Type III

a=-0.2
a=-0.4

0.1

0.01

R

σx = 0.1

1

0.1

0.01

R

σx = 0.4

1

0.1

0.01
32

64

128 256

32

S

64

128 256
S

32

64

128 256
S

Figure S 8. Scaling of R with S in PPM networks generated with T = 0.01,
K = S 0.4 , and B = 0.25S. In each panel, from top to bottom, lines are for
a = 0.2, 0, −0.2 and −0.4. From left to right, columns of panels are for
Lotka-Volterra, type II and type III dynamics, as given by Eqs. (3) and (4).
From top to bottom, rows of panels are for levels of biomass noise σx = 0, 0.1
and 0.4 in Eq. (6). In types II and III, the half-saturation is set at x0 = 1/2.
predict the empirical R for a wide range of η. In Fig. S9 we show R against
T for PPM networks constructed with the parameters of the Chesapeake Bay
food web [14, 15] for four cases. We also plot, with an asterisk, the empirical
value of R observed in each case, always at the value T = 0.67 found to adjust
the empirical trophic coherence, q = 0.47 (see Table S1). The top left panel is
for the case of η = 0, which represents a situation in which the biomass of prey
species is completely unaffected by the biomass of their predators. We show in
the proof we include in Methods that a perfectly coherent network with η = 0
would have only zero eigenvalues. As incoherence increases, R grows somewhat,
though it remains small compared to most cases in which the parameter η simulates a measure of feedback from predators to prey. The top right panel is
for η = 0.7, implying a relatively high efficiency and a strong negative feedback
acting on prey species. At η = 1, all the eigenvalues of W would have zero real
part because it would be an antisymmetric matrix (intuitively, any increase in
one node’s biomass will be compensated by a decrease in another, so perturbations will be maintained and neither dampened nor amplified). At η > 1 we
simulate a situation such that a predator extracts more biomass form its prey

18

0.02

0.08

η=0.7

R

η=0.0

0
6

η=-1.0

R

0
1

η=2.0
0

3
0

2.5

0

2.5
T

T

Figure S 9. Real part of the leading eigenvalue, R, of the interaction matrix
W = ηA − AT against the parameter T , from averages over networks
generated with the PPM for the parameters of the Chesapeake Bay food web
[14, 15]. In each panel a different value of the parameter η is used, and the
corresponding empirical value of R is represented with a blue asterisk at the
value T = 0.67, found to predict the empirical trophic coherence q = 0.47 (as
shown in Table S1). Top left: η = 0; top right: η = 0.7; bottom left η = 2;
bottom right η = −1.
than the latter loses. As we would expect intuitively, this scenario of runaway
growth is significantly more unstable than the ones described above. However,
the behaviour of R with T is qualitatively similar to that observed for 0 < η < 1.
Finally, the bottom right panel corresponds to the case η = −1, implying that
predation reduces the biomass of a predator as well as that of its prey. We know
from the proof described in Methods that at q = 0 all the eigenvalues of W are
purely real for any η < 0. Similarly, the behaviour of R with T is now inverted:
the most coherent networks are now the most unstable.
In the panels corresponding to η = 0, 0.7 and −1, the value of T which
adjusts the empirical trophic coherence also predicts the empirical R very accurately (as we have found for all the food webs in our dataset when using η = 0.2;
see main text). The case of η = 2 is slightly out: the PPM predicts a slightly
higher value of R at T = 0.67, although it is not out by much more than a
standard deviation. This case of η > 1 is unlikely to be relevant for ecology;
but the small discrepancy serves to remind us that the PPM does not capture
all the structural features of real food webs.

19

3.2.3

Herbivory

Links from basal species (producers) to species which only consume basal species
(herbivores) will necessarily have a trophic distance equal to one (see Methods in
the main text). Since the proportion of basal species, B/S, varies considerably
among food webs, we can expect this measure to have a strong bearing on trophic
coherence. On the other hand, a large number of basal species may provide a
more stable configuration than a network in which many species depend on just
a few producers. Might this be the underlying reason for the relation between
trophic coherence and stability?
Figure S10A is a scatter plot of q against B/S for the food webs listed in
Table S1. There is indeed a significant negative correlation (r2 = 0.559). Figures
S10B and S10C show how stability, as measured both before and after removing
self-links, varies with the proportion of basal species in the same dataset. The
correlations are also significant (r2 = 0.475 for R and r2 = 0.505 for Rnc ),
but slightly lower than we observe in Fig. S10A. In any case, they are much
weaker than the correlations shown in Fig. 1 of the main text between trophic
coherence and stability. We can therefore conclude that trophic coherence is the
most powerful explanatory variable of stability, while the effect of the proportion
of basal species is either less important, or simply an artefact of its correlation
with trophic coherence.
A

C

B

1.5

1

q

1

Rnc

R

0

0
0

0.7
B/S

0
0

0.7
B/S

0

0.7
B/S

Figure S 10. Scatter plots, for the food webs listed in Table S1, of three
network measures against the proportion of basal species, B/S, with Pearson’s
correlation coefficient in brackets. A: Trophic coherence, q, against B/S
(r2 = 0.559). B: R (real part of the leading eigenvalue of W ) against B/S
(r2 = 0.475). C: Rnc (real part of the leading eigenvalue of W after self-links
have been removed) against B/S (r2 = 0.505).

3.2.4

Weighted networks

Although we have been considering the food webs as unweighted networks (the
elements in A are either zero or one), in reality certain interactions will be
more important than others, and the efficiency η need not be the same for
all links. A simple way to look into how these considerations might affect
our results is as follows. We make the change Wij → (1 + ξij )Wij , with ξij
drawn from a Gaussian distribution of mean zero, standard deviation σ and
no correlation between ξij and ξji . For a given network we then obtain the
value of R for many different realizations of the noise {ξ}. In the left panel
20

of Fig. S11 we show the average and standard deviations of R thus defined
for three different levels of noise – σ = 0.0, 0.2 and 0.4 – for PPM networks
with the parameters of the Chesapeake Bay food web [14, 15]. We also show
(with diamonds) the corresponding averages and standard deviations obtained
by performing the same test on the empirical food web. As is to be expected,
increased noise leads to a higher average R (lower stability) and a wider standard
deviation. However, the behaviour of the average R against the parameter T
remains similar with increasing noise, and the value T = 0.67 which best adjusts
the empirical trophic coherence (as given by Table S1) continues to predict the
empirical average R at each σ. This is not, however, the case for the Generalized
Niche Model. We show the mean and standard deviation of R generated with
this model against its contiguity parameter c for the same food web. Whereas
the empirical and simulated average values of R correspond at c . 1 when there
is little noise, as σ increases the model average R grows faster than the empirical
value. This suggests that trophically coherent networks, such as the Chesapeake
Bay food web or those generated by the PPM, are more robust to fluctuations
in interaction strengths than those generated with niche-based models.
The allometric relationship according to which metabolic rates decline with
increasing body size has been shown to reduce predation strength per unit
biomass, thereby contributing to stability [50]. Since body size tends to augment (exponentially) with trophic level, this would mean that a more coherent
structure would also involve a more homogeneous distribution of link strengths
(for a given predator). Therefore, in a more realistic setting in which body sizes
and link strengths are considered, we expect the stabilising effect of trophic
coherence to be greater than we have shown here for binary networks.
0.6

σ=0.4
σ=0.2
σ=0.0

R

0.4

0.2

0
0

0.5

1
T

1.5

2

2.5

0

0.2

0.4
c

0.6

0.8

1

Figure S 11. Value of R obtained after defining the modified interaction
matrix W̃ij = (1 + ξij )Wij , where ξij is drawn from a Gaussian distribution of
mean zero and standard deviation σ, and averaging over realizations of the
noise {ξ}. In each panel, the diamonds represent the average values for the
empirical food web of Chesapeake Bay [14, 15], with standard deviations as
error bars, for noise levels σ = 0, 0.2 and 0.4. The panel on the left shows the
corresponding results for PPM networks against T using the same parameters,
while the panel on the right is for those generated by the Generalized Niche
Model against contiguity, c.

21

3.2.5

Feasibility

We have been discussing the potential stability of fixed points of ecosystem
dynamics, but for this to be relevant such a fixed point has to be feasible. That
is, there must exist a fixed point such that every species has a positive biomass.
To determine a potential fixed point one must, in general, know the details of
the dynamics (as mentioned above). However, even with these specifications,
given an unweighted network is is highly unlikely that the fixed point will involve
only positive biomasses. However, nature does not have this problem, among
other reasons because species’ biomasses co-evolve with the interaction weights.
If we are granted a certain freedom to set these weights, even if other details of
dynamics are set, the problem of finding a fixed point becomes under-specified,
and configurations allowing for feasible fixed points might be located. We saw
above that the stability of real food webs and those generated by the PPM
seem to be more robust to random changes in interaction strengths than their
niche-based model counterparts. This suggests that, given a prescription to
modify interaction weights, trophic coherence might enhance the feasibility of
fixed points as well as their stability. Such an exercise lies beyond the scope of
this paper, but we believe it is a promising avenue of research to be undertaken
in the future.
3.2.6

Stability criteria

In the main text we discuss May’s result for random networks, √
according
√ to
which the real part of the leading eigenvalue should scale as R ∼ √ SC = K.
We also show that R does not exhibit a significant correlation√with S, although
we do observe a modest positive correlation (r= 0.480) with K. In Figs. S12A
and S12B we show scatter plots, for the food webs listed in Table
√ S1, of√the
leading eigenvalue after self-links have been removed, Rnc , against S and K.
In the former case the correlation is now negative but still insignificant, while
in the latter the correlation increases slightly to r2 = 0.508. However, food
webs are network in which all the links stand for predation (as opposed to other
ecological relationships, such as competition or mutualism). Allesina and Tang
have recently derived stability criteria for specific kinds of interactions [51]. In
particular, when the links stand for predation but are randomly placed among
the species, they find that the real part of the leading eigenvalue should scale
as
√
R ∼ (1 + ρ) SV ,
(7)
where V is the variance of the off-diagonal elements of the interaction matrix
W , and ρ is Pearson’s correlation coefficient between the elements Wij and Wji .
Figure 12C is a scatter plot of Rnc against the prediction of Eq. (7). Somewhat
surprisingly, the correlation is very weak (r2 = 0.083). In Fig. 12D we swap
Rnc for R (the leading eigenvalue when cannibalism is included) and now the
correlation becomes significant (r2 = 0.230), although still relatively low. These
results provide further evidence that the structure of food web is non-random
in a way which is particularly relevant for their stability.

22

B

A

C

D

1

1

Rnc

R

0

0
1

√S


20 1


√K

5 0.5

(1+ρ)
√SV

2.5

0.5

(1+ρ)
√SV

2.5

Figure S 12. Scatter plots, for the food webs listed in Table S1, of stability
measures against various network values, with Pearson’s correlation coefficient
in brackets. A: Rnc (real
√ part of the leading eigenvalue after
√ self-links have
been removed) against S (r2 = 0.008). B: Rnc against K (r2 = 0.508). C:
Rnc against Allesina and Tang’s prediction, given by Eq. (7) (r2 = 0.083). D:
R (real part of the leading eigenvalue without removing self-links) against
Allesina and Tang’s prediction (r2 = 0.230).
3.2.7

Missing links and trophic species

Despite important recent developments in food-web inference techniques, it is
often hard to ascertain from observation whether a given species consumes another (and even more difficult to quantify the extent of predation). Furthermore,
the food webs we have used here for our analysis (described in Section 2) were
obtained with a variety of different techniques. To assess whether the patterns
we have observed in this dataset, shown in Fig. 1 of the main text, are robust
to possible experimental errors, we remove from each food web a percentage
of links, chosen randomly, and recompute each of the magnitudes of interest.
After averaging over 100 such tests for each food web, we then recalculate each
of the correlation coefficients shown in Fig. 1. These are shown in Table S3 for
different percentages of links removed. As we can see, the dependency of stability on the other magnitudes is barely affected by the random deletion of links:
the correlation of R with size is never significant, while the correlation with
both complexity and coherence actually increases slightly with the percentage
of deleted links.
Missing links
0%
1%
5%
10%
20%

√
S
0.064
0.061
0.064
0.014
0.002

√
K
0.461
0.484
0.497
0.545
0.582

q
0.596
0.598
0.635
0.752
0.783

q (no self-links)
0.804
0.814
0.831
0.857
0.845

Table S 3. First column: percentage of links randomly deleted from the
empirical food webs of Table S1. Second, third and fourth column,
respectively:
value of the correlation coefficient r√2 obtained for R (stability)
√
against S (where S is the number of species), K (where K is the mean
degree), and q (incoherence parameter). Fourth column: as the third column,
after removing all self-links. Compare with Fig. 1 of the main text.
23
The nodes in the food webs found in the literature often represent “trophic
species”. This means that if two or more species in the community share their
full sets of prey and predators, they are coalesced into a single node, even if
they are in fact taxonomically distinct. However, with recent advances in empirical techniques of food-web inference, larger networks are now being obtained
in which nodes represent taxonomic, rather than trophic, species. To find out
whether our empirical findings are affected by the degree of taxonomic resolu-

Species duplicated
0%
20%
50%

√

S
0.064
0.002
0.122

√
K
0.461
0.582
0.406

q
0.596
0.783
0.713

q (no self-links)
0.804
0.845
0.797

Table S 4. First column: percentage of species duplicated (as described in
Section 3.2.7) in the empirical food webs of Table S1. Second, third and fourth
2
column, respectively:
√ value of the correlation coefficient r √obtained for R
(stability) against S (where S is the number of species), K (where K is the
mean degree), and q (incoherence parameter). Fourth column: as the third
column, after removing all self-links. Compare with Fig. 1 of the main text.

3.3

Mean chain length

A food chain is a directed path beginning at at basal species (one with no incoming links) and ending at an apex predator (one with no out-going links)
[52]. In other words, it is any one of the possible paths that biomass entering
the system through a basal species can follow until it is entirely dissipated. A
food web generally has a very large number of such chains; but a low mean
chain length (MCL) – an average over all of them, the length of a chain being
the number of links it comprises – has been associated with a high stability [53].
All food webs representing a more or less autonomous ecosystem necessarily
have at least one basal species; however, it can occur that there are in fact no
apex predators. This is because the top predators can eat each other. To get
round this we define an apex set as a group of predators such that no directed
paths leave the group, while they would if any member of the set were removed.
For instance, say predator A and predator B would both be apex in the usual
sense if it weren’t because they ate each other. With this definition they form,
together, an apex set. Thus, we define a food chain as a directed path beginning
at a basal species and ending in any species belonging to an apex set. In this
section, we shall use the term “apex predator” to refer to any member of an
apex set.
To find the apex sets in a given food web, we make use of random walkers:
imaginary beings that move through the network hopping from one node to
another along links (in the direction allowed). The walkers are called random
because at each hop they choose randomly between the different nodes they
can access. Random walkers are often used to study diffusion processes, and
here they can be thought of as representing the diffusion of biomass through the
food web. Given a network, we simulate many such random walkers beginning
at basal species, and for each node we keep a register of how many times it has
been visited. When the walkers reach an apex set, they cannot leave it, and
will forever continue to hop around among the members of the group (or they
might stay at a single species if it is apex in the original sense, since there is
nowhere to hop). Therefore, whereas most nodes will be visited a small number
of times which is independent of how long we allow each walker to “live”, the
number of times the apex predators are visited increases with walker longevity.
This provides a simple computational way of finding the apex predators which,
though stochastic, will always determine the sets exactly.
24

Once we know the basal and apex species, we can proceed to find all the
chains and obtain the mean value of their length. At least this is possible in
principle – in practice, the number is often prohibitively large to be calculated
exhaustively. We therefore make use again of the random walkers. We just have
to simulate many walkers beginning at basal species and remove them when they
arrive at an apex predator, counting how many steps it took them to get there.
There is, however, a caveat. The chains actually used provide a biased sample
of all the chains in the food web: a long chain is more likely to be abandoned
somewhere along its length than a short one. More precisely, the probability
that a particular chain, µ, has of being used is inversely proportional to
Y
kiout ,
πµ =
i∈µ

the product extending over all the species i in µ (except the apex predator),
and where kiout is the number of predators of species i. So to take this bias into
account we calculate, for each walker w, not only the length of the path it uses,
λw , but the value πµ(w) , where µ(w) is the path taken by w. After doing this for
N walkers, an estimate of the mean chain length (which will be more accurate
the larger N ), is
PN
−1
w=1 πµ(w) λµ
MCL ≃ PN
.
−1
w=1 πµ(w)
We made sure that this stochastic method converges to the right MCL by comparing the values returned with the results from exhaustive searches for those
networks where this was possible.
Figure S13 shows the predictions of MCL made by each food-web model for
the food webs listed in Table S1.

3.4

Modularity

Much attention has been paid in recent years to the community structure of
complex networks: how the nodes can be classified in groups – or modules –
such that a high proportion of links fall within groups. For a network with
S nodes and mean degree K = L/S, the configuration model holds that the
probability of there being a link from j to i is kiin kjout /(KS) (where kiin and
kiout are the numbers of i’s prey and predators, respectively) [54]. Using this,
and given a particular partition (i.e., a classification of nodes into groups) of
the network, one can define
!
kiin kjout
1 X
Aij −
δ(µi , µj ),
Q=
KS ij
KS

where µi is a label corresponding to the partition that node i finds itself in, and
δ(x, y) is the Kronecker delta [54]. The modularity of the network is taken to
be the maximum value of Q obtainable with any partition. Since searching exhaustively is prohibitive for all but very small and sparse networks, a stochastic
optimization method is usually called for. We use the algorithm of Arenas et
al. [55], although there are many in the literature and the most appropriate can
depend on the kind of network at hand [56].
Figure S14 shows the predictions of modularity made by each food-web
model for the food webs listed in Table S1.
25

20
MCL

15
10
5
0
2

4

6

8

10

12

14

16

18

20

22

24

26

28

30

32

34

36

20
MCL

15
10
5
0
20

CM
ONM
NHM
GNM
MPNM
PPM
real

MCL

15
10
5
0
38

40

42

44

46

48

50

52

54

Figure S 13. Mean chain length of each of the food webs listed in Table S1.
The corresponding predictions of each food-web model discussed in Section S1
– Cascade, Niche, Nested Hierarchy, Generalized Niche, Minimum Potential
Niche and Preferential Preying – are displayed with bars representing one
standard deviation about the mean. Empirical values are black squares. The
labelling of the food webs is indicated in the rightmost column of Table S1.

3.5

Cannibals and apex predators

As we have discussed above, cannibalism contributes significantly to stability.
We show the number of species with self-links predicted by each food-web model
for the food webs listed in Table S1 in Fig. S15. We also measure the number
of apex predators – in the conventional sense of those with no consumers – and
display the model predictions in Fig. S16.

3.6

Mean trophic level

The last network feature we analyse is the mean trophic level, which is simply
an average
over all the species in a food web of their trophic levels (i.e., s =
P
S −1 i si ). Thanks to Pauly and colleagues’ seminal paper “Fishing down
marine food webs” [57], the mean trophic level has come to be regarded as
an indicator of an ecosystem’s health, to the extent that the Convention on
Biological Diversity has mandated that signatory states report changes in this
measure (renamed the Mean Trophic Index) for marine ecosystems. The model
predictions for the mean trophic level are displayed Fig. S17.

26

Mod
Mod
Mod

0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
2

4

6

8

10

12

14

16

18

20

22

24

26

28

30

32

34

36

0.6
0.5
0.4
0.3
0.2
0.1
0
0.6
0.5
0.4
0.3
0.2
0.1
0

CM
ONM
NHM
GNM
MPNM
PPM
real
38

40

42

44

46

48

50

52

54

Figure S 14. Modularity of each of the food webs listed in Table S1. The
corresponding predictions of each food-web model discussed in Section S1 –
Cascade, Niche, Nested Hierarchy, Generalized Niche, Minimum Potential
Niche and Preferential Preying – are displayed with bars representing one
standard deviation about the mean. Empirical values are black squares. The
labelling of the food webs is indicated in the rightmost column of Table S1.

3.7

Comparison of network measures

For each of the food-web models and each network measure, we can compute the
Mean Average Deviation (MAD) of the theoretical prediction, Xtheo from the
empirical value, Xempi , simply as M AD = h|Xtheo − Xempi |i, where h·i stands
for an average over the 46 food web listed in Table S1. The results for each
of the eight network measures are shown in the panels of Fig. S18. The first
panel sums up what we can observe in Fig. S4 – that the niche-based models
tend to overestimate the value of q significantly. The fact that none of these
models differs substantially as regards q from the predictions of the Cascade
Model implies that the various features which they are designed to capture –
such as intervality, multiple niche dimensions or phylogenetic constraints – have
very little bearing on trophic coherence. The Preferential Preying Model, on the
other hand, can reproduce the correct value of q in 45 out of 46 food webs by
adjusting its parameter T . The odd web out is that of Coachella Valley, which
is slightly more incoherent even than the PPM achieves with low, negative T .
This food web is also the only one in our dataset in which more than half the
species indulge in cannibalism. As can be seen from a comparison of Figs. S5
and S6, this allows the Coachella Valley food web to exhibit a relatively low R,
27

N Cannibals
N Cannibals
N Cannibals

40
35
30
25
20
15
10
5
0
2

4

6

8

10

12

14

16

18

20

22

24

26

28

30

32

34

36

30
25
20
15
10
5
0
70
60
50
40
30
20
10
0

CM
ONM
NHM
GNM
MPNM
PPM
real
38

40

42

44

46

48

50

52

54

Figure S 15. Number of cannibal species in each of the food webs listed in
Table S1. The corresponding predictions of each food-web model discussed in
Section S1 – Cascade, Niche, Nested Hierarchy, Generalized Niche, Minimum
Potential Niche and Preferential Preying – are displayed with bars
representing one standard deviation about the mean. Empirical values are
black squares. The labelling of the food webs is indicated in the rightmost
column of Table S1.
which it loses when we remove self-links.
The second and third panels show how the models fare as regards stability, both with and without self-links. As discussed in the main text, the PPM
achieves significantly better results than the other models in both cases, something we attribute to its reproducing the correct level of trophic coherence.
Furthermore, in Figs. S5 and S6 we observe that the niche-based models tend
to predict less stability than the food webs exhibit, especially in the case without cannibals. This is in keeping with the observation by Allesina and Tang [51]
that “realistic” food web structure (i.e., that generated with current structural
models) is not conducive to stability.
Next we look at mean chain length and modularity, two measures which
have been associated with ecosystem robustness. In particular, a low mean chain
length is thought to increase stability [53], while a high modularity might contain
cascades of extinctions [10]. In keeping with the first observation, the nichebased models tend to predict longer chains than found in nature; however, they
also somewhat overestimate modularity. In any case, the PPM also outperforms
the other models on these two measures.

28

50
N Apex

40
30
20
10
0
2

4

6

8

10

12

14

16

18

20

22

24

26

28

30

32

34

36

50
N Apex

40
30
20
10
0

CM
ONM
NHM
GNM
MPNM
PPM
real

N Apex

60
40
20
0
38

40

42

44

46

48

50

52

54

Figure S 16. Number of apex predators in each of the food webs listed in
Table S1. The corresponding predictions of each food-web model discussed in
Section S1 – Cascade, Niche, Nested Hierarchy, Generalized Niche, Minimum
Potential Niche and Preferential Preying – are displayed with bars
representing one standard deviation about the mean. Empirical values are
black squares. The labelling of the food webs is indicated in the rightmost
column of Table S1.
The numbers of cannibals and of apex predators are not very well predicted
by any of the models. All but the Nested Hierarchy Model tend to overestimate
the cannibals and underestimate the apex predators. Finally, we look at the
mean trophic level – a measure which, as mentioned above, is used nowadays to
assess the health of marine ecosystems and to monitor the effects of overfishing
[57]. As we might expect from this measure’s relationship to trophic structure, the PPM does significantly better than the other models at predicting the
mean trophic level of food webs. In general, the niche-based models tend to
overestimate the mean trophic level, as shown in Fig. S17.
The standard deviations around the Mean Absolute Deviation measures of
Fig. S18, relative to each mean value, are displayed in Fig. S19. In Fig. S20,
we show the absolute values of the mean z-score obtained for each of the models
on the same measures.
The comparison we have made here is not as rigorous as one might wish to
establish the best food-web model, and this was not our intention. For instance,
we have not controlled for the number of parameters, nor attempted to derive
likelihoods for each model, as Allesina et al. have done [12]. There are also,

29

mean trophic level

10

5

0

mean trophic level

2

6

8

10

12

14

16

18

32

34

36

5

0
20

mean trophic level

4

22

24

26

28

30

10

CM
ONM
NHM
GNM
MPNM
PPM
real

5

0
38

40

42

44

46

48

50

52

54

Figure S 17. Mean trophic level of each of the food webs listed in Table S1.
The corresponding predictions of each food-web model discussed in Section S1
– Cascade, Niche, Nested Hierarchy, Generalized Niche, Minimum Potential
Niche and Preferential Preying – are displayed with bars representing one
standard deviation about the mean. Empirical values are black squares. The
labelling of the food webs is indicated in the rightmost column of Table S1.
of course, many other network measures of interest in ecology which could be
analysed [6, 58]. However, we believe it is sufficient to show that a) the failure
of current structural models to capture trophic coherence is an important shortcoming; and b) the Preferential Preying Model, which overcomes this problem,
generates networks at least as realistic as any of the other structural models. In
fact, the PPM significantly outperforms the others on six out of the eight measures we have analysed, and fares no worse on the remaining two. However, the
PPM does not capture some of the features known to be relevant in food webs,
in particular a phylogenetic signal [9]. The high degree of intervality exhibited
by many food webs [5] might be a spurious effect of phylogeny and trophic coherence (both of which we know, from preliminary simulations, to contribute
to intervality) or may need to be modelled explicitly, as in the Niche Model.
In any case, we hope to have shown that any attempt to build a model which
generates networks as similar as possible to real food webs must take account
of trophic coherence.

30

0.75

MAD(q)
0.3

MAD(R)

MAD(R (no cannibalism))
0.3

0.5

0.2

0.2

0.25

0.1

0.1

MAD(MCL)
5
4
3
2
1

0

0

0

MAD(Canni)

MAD(Apex)

7

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM
MAD(Mod)
0.2

0

20

MAD(Mean Trophic Level)
1

10

0.5

0

0

6
5
4

0.1

3
2
1

0

0

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

Figure S 18. Mean Average Deviation (MAD) form the empirical values
returned by each of the food web models discussed in Section S1 – Cascade,
Niche, Nested Hierarchy, Generalized Niche, Minimum Potential Niche and
Preferential Preying – for the network measures described in Section S1:
trophic coherence q, stability R, stability after removing self-links Rnc , mean
chain length, modularity, and numbers of cannibals and of apex predators.

4

Analytical theory for maximally coherent
networks

Let us consider a maximally coherent network, with q = 0. The S species will
thus fall into M discrete trophic levels, with mi species
P in each level i, so that
the number of basal species is B = m1 , and S = M
i=1 mi . Each link of the
predation (or adjacency) matrix A will lead from a prey node at some level i to
a predator node a level i + 1. The interaction matrix W = ηA − AT (where the
efficiency η is assumed equal for all pairs of species) will therefore be an S × S
block matrix where the only nonzero blocks are those above and below the main
diagonal:


0
ηA1
0
...
0
0
 −At1

0
ηA2 . . .
0
0


t
 0

−A2
0
...
0
0

.
W =
(8)

 ........................................ 
 0
0
0
...
0
ηAS−1 
0
0
0
. . . −AtS−1
0
31

SIGMA(q)

SIGMA(R)

0.5

0.5

0

0

0

SIGMA(MCL)
0.5

0

SIGMA(Canni)

SIGMA(Apex)

3

2

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM
SIGMA(Mod)
0.1

SIGMA(R (no cannibalism))
0.5

SIGMA(Mean Trophic Level)
0.5

2
0.05

1
1

0

0

0

0
PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

Figure S 19. Standard deviation relative to mean, for the Mean Average
Deviation (MAD) measures displayed in Fig. S18.
Blocks Ai are mi × mi+1 matrices representing the links between the species at
level i and those at level i + 1.
Let us now consider the adjacency matrix Ã of the undirected network we
obtain by replacing each directed link (or arrow) in A with an undirected (symmetric) one:


0 A1 0 . . .
0
0
 At1 0 A2 . . .
0
0 


 0 At2 0 . . .
0
0 

.
Ã = 
(9)

 ................................ 
 0
0
0 ...
0
AS−1 
0
0
0 . . . AtS−1
0

The eigenvalues {µi } of Ã are all real since the matrix is symmetric. Furthermore, for every non-negative eigenvalue µj ≥ 0 there is another eigenvalue
µl = −µj since the network is bipartite (species can be partitioned into two
groups with no links within each of them: species in even trophic levels and
species in odd levels). Therefore, the eigenvalues of Ã2 are either positive and

32

|Zscore(q)|

|Zscore(R)|

|Zscore(R (no cannibalism))|
5

|Zscore(MCL)|

5

5

4

4

4

4

3

3

3

3

2

2

2

2

1

1

1

1

0

0

0

0
PPMc
MPNM
NHM
NM
GNM
CM

|Zscore(Canni)|

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM
|Zscore(Mod)|

5

|Zscore(Apex)|

|Zscore(Mean Trophic Level)|
5

5

5

5

4

4

4

4

3

3

3

3

2

2

2

2

1

1

1

1

0

0

0

0
PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

PPMc
MPNM
NHM
NM
GNM
CM

Figure S 20. Absolute value of the mean z-score returned by each of the food
web models discussed in Section S1 – Cascade, Niche, Nested Hierarchy,
Generalized Niche, Minimum Potential Niche and Preferential Preying – for
the network measures described in Section S1: trophic coherence q, stability
R, stability after removing self-links Rnc , mean chain length, modularity, and
numbers of cannibals and of apex predators.
doubly degenerate or zero. Moreover, the matrix Ã2 can be written as:


D 1 0 B1 0 . . .
 0 D 2 0 B2 . . . 
 t

2

Ã = 
 B1 0t D3 0 . . .  .
 0 B2 0 D 4 . . . 
.......................
where


t

A1 A1
t
Di = Ai−1 Ai−1 + Ai Ati

 t
AM−1 AM−1
Bi = Ai Ai+1 .

33

for i = 1
for 1 < i < M
for i = M ,

(10)

(11)

Now, the square of matrix W reads:

−ηD1
0
η 2 B1
0
...
2

0
−ηD
0
η
B
.
..
2
2

t
B
0
−ηD
0
.
..
W2 = 
3
1


0
B2t
0
−ηD4 . . .
...................................

We introduce a diagonal matrix U with diagonal blocks
i−1
Uii = (−η)⌊ 2 ⌋ Ii ,





.



(12)

(13)

where Ii is the identity matrix of size mi , and ⌊x⌋ denotes the floor function of
x:


I1 0
0
0
0
...
 0 I2
0
0
0
... 


 0 0 −ηI3
0
0
... 
.
U =
(14)
 0 0
0
−ηI4
0
... 


 0 0
0
0
η 2 I5 . . . 
................................
We can write

W 2 = −ηU −1 Ã2 U.

(15)

λ2j = −ηµ2j .

(16)

Therefore, the eigenvalues of W 2 can be obtained by multiplying those of Ã2
by −η: they are either negative and doubly degenerate or zero. Denoting by λj
the eigenvalues of W , we can write

This means that for every µj = 0 we have λj = 0, and for every pair of
√
real eigenvalues ±µj of Ã there is a pair of imaginary eigenvalues λj = ±i ηµj
of W . In any case, for η > 0, all the eigenvalues of the interaction matrix W
have zero real part. If η = 0 all its eigenvalues would be zero, while for η < 0,
the imaginary parts would vanish andpall the eigenvalues would be real, all the
nonzero ones coming in pairs λj = ± |η|µj .

34

5

References

[1] J. E. Cohen and C. M. Newman, “A stochastic theory of community
food webs I. models and aggregated data,” Proc. R. Soc. London Ser. B.,
vol. 224, pp. 421–448, 1985.
[2] D. B. Stouffer, J. Camacho, R. Guimerà, C. A. Ng, and L. A. N. Amaral,
“Quantitative patterns in the structure of model and empirical food webs,”
Ecology, vol. 86, p. 1301–1311, 2005.
[3] R. J. Williams and N. D. Martinez, “Simple rules yield complex food webs,”
Nature, vol. 404, pp. 180–183, 2000.
[4] J. E. Cohen, Food Webs and Niche Space. Princeton, New Jersey: Princeton
Univ. Press, 1978.
[5] D. B. Stouffer, J. Camacho, and L. A. N. Amaral, “A robust measure of
food web intervality,” Proc. Natl. Acad. Sci. USA, vol. 103, pp. 19015–
19020, 2006.
[6] J. Capitán, A. Arenas, and R. Guimerà, “Degree of intervality of food webs:
From body-size data to models,” J. Theor. Bio., vol. 334, pp. 35–44, 2013.
[7] R. J. Williams and N. D. Martinez, “Success and its limits among structural
models of complex food webs,” Journal of Animal Ecology, vol. 77, pp. 512–
519, 2008.
[8] M. F. Cattin, L. F. Bersier, C. Banasek-Richter, R. Baltensperger, and
J. P. Gabriel, “Phylogenetic constraints and adaptation explain food-web
structure,” Nature, vol. 427, pp. 835–9, 2004.
[9] R. E. Naisbit, R. P. Rohr, A. G. Rossberg, P. Kehrli, and L.-F. Bersier,
“Phylogeny versus body size as determinants of food web structure,” Proc.
R. Soc. B, vol. 279, pp. 3291–7, 2012.
[10] R. Guimerà, D. B. Stouffer, M. Sales-Pardo, E. A. Leicht, M. E. J. Newman, and L. A. N. Amaral, “Origin of compartmentalization in food webs,”
Ecology, vol. 91, no. 10, pp. 2941–51, 2010.
[11] T. Gross, L. Rudolf, S. Levin, and U. Dieckmann, “Generalized models
reveal stabilizing factors in food webs,” Science, vol. 325, pp. 747–50, 2009.
[12] S. Allesina, D. Alonso, and M. Pascual, “A general model for food web
structure,” Science, vol. 320, pp. 658–661, 2008.
[13] A. L. Barabási and R. Albert, “Emergence of scaling in random networks,”
Science, vol. 286, pp. 509–512, 1999.
[14] R. E. Ulanowicz and D. Baird, “Nutrient controls on ecosystem dynamics: the chesapeake mesohaline community,” Journal of Marine Systems,
vol. 19, no. 1–3, pp. 159 – 172, 1999.
[15] L. G. Abarca-Arenas and R. E. Ulanowicz, “The effects of taxonomic aggregation on network analysis,” Ecological Modelling, vol. 149, no. 3, pp. 285
– 296, 2002.
35

[16] R. M. Thompson and C. R. Townsend, “Impacts on stream food webs of
native and exotic forest: An intercontinental comparison,” Ecology, vol. 84,
pp. 145–161, 2003.
[17] R. M. T. andC. R. Townsend, “Energy availability, spatial heterogeneity
and ecosystem size predict food-web structure in stream,” Oikos, vol. 108,
p. 137–148, 2005.
[18] Townsend, Thompson, McIntosh, Kilroy, Edwards, and Scarsbrook, “Disturbance, resource supply, and food-web architecture in streams,” Ecology
Letters, vol. 1, no. 3, pp. 200–209, 1998.
[19] P. Yodzis, “Local trophodynamics and the interaction of marine mammals and fisheries in the benguela ecosystem,” Journal of Animal Ecology,
vol. 67, no. 4, pp. 635–658, 1998.
[20] K. Havens, “Scale and structure in natural food webs,” Science, vol. 257,
no. 5073, pp. 1107–1109, 1992.
[21] Townsend, Thompson, McIntosh, Kilroy, Edwards, and Scarsbrook, “Disturbance, resource supply, and food-web architecture in streams,” Ecology
Letters, vol. 1, no. 3, pp. 200–209, 1998.
[22] J. Bascompte, C. Melián, and E. Sala, “Interaction strength combinations
and the overfishing of a marine food web,” Proceedings of the National
Academy of Sciences of the United States of America, vol. 102, no. 15,
pp. 5443–5447, 2005.
[23] S. Opitz, “Trophic interactions in Caribbean coral reefs,” ICLARM Tech.
Rep., vol. 43, p. 341, 1996.
[24] K. D. Lafferty, R. F. Hechinger, J. C. Shaw, K. L. Whitney, and A. M.
Kuris, “Food webs and parasites in a salt marsh ecosystem,” Disease ecology: community structure and pathogen dynamics (ed. S. Collinge & C.
Ray), pp. 119–134, 2006.
[25] G. Polis, “Complex trophic interactions in deserts: an empirical critique of
food-web theory,” Am. Nat., vol. 138, pp. 123–125, 1991.
[26] R. Ulanowicz, “Growth and development: Ecosystems phenomenology.
springer, new york. pp 69-79.,” Network Analysis of Trophic Dynamics
in South Florida Ecosystem, FY 97: The Florida Bay Ecosystem., 1986.
[27] R. Ulanowicz, C. Bondavalli, and M. Egnotovich., “Spatial and temporal
variation in the structure of a freshwater food web,” Network Analysis of
Trophic Dynamics in South Florida Ecosystem, FY 97: The Florida Bay
Ecosystem., 1998.
[28] R. B. Waide and W. B. R. (eds.), The Food Web of a Tropical Rainforest.
Chicago: University of Chicago Press, 1996.
[29] R. Ulanowicz, J. Heymans, and M. Egnotovich, “Network analysis of
trophic dynamics in south florida ecosystems,” Network Analysis of Trophic
Dynamics in South Florida Ecosystems FY 99: The Graminoid Ecosystem.,
2000.
36

[30] N. D. Martinez, B. A. Hawkins, H. A. Dawah, and B. P. Feifarek, “Effects of
sampling effort on characterization of food-web structure,” Ecology, vol. 80,
p. 1044–1055, 1999.
[31] N. D. Martinez, “Artifacts or attributes? Effects of resolution on the Little
Rock Lake food web,” Ecol. Monogr., vol. 61, pp. 367–392, 1991.
[32] J. Riede, U. Brose, B. Ebenman, U. Jacob, R. Thompson, C. Townsend,
and T. Jonsson, “Stepping in Elton’s footprints: a general scaling model for
body masses and trophic levels across ecosystems,” Ecology Letters, vol. 14,
pp. 169–178, 2011.
[33] A. Eklöf, U. Jacob, J. Kopp, J. Bosch, R. Castro-Urgal, B. Dalsgaard, N. Chacoff, C. deSassi, M. Galetti, P. Guimaraes, S. Lomáscolo,
A. Martı́n González, M. Pizo, R. Rader, A. Rodrigo, J. Tylianakis,
D. Vazquez, and S. Allesina, “The dimensionality of ecological networks,”
Ecology Letters, vol. 16, pp. 577–583, 2013.
[34] J. Almunia, G. Basterretxea, J. Arısteguia, and R. Ulanowicz, “Benthicpelagic switching in a coastal subtropical lagoon,” Estuarine, Coastal and
Shelf Science, vol. 49, no. 3, pp. 363 – 384, 1999.
[35] D. Mason, “Quantifying the impact of exotic invertebrate invaders on food
web structure and function in the great lakes: A network analysis approach,” Interim Progress Report to the Great Lakes Fisheries Commissionyr 1, 2003.
[36] J. Patricio, “Network analysis of trophic dynamics in south florida ecosystems, fy 99: The graminoid ecosystem.,” Master’s Thesis. University of
Coimbra, Coimbra, Portugal, 2000.
[37] M. E. Monaco and R. E. Ulanowicz, “Comparative ecosystem trophic structure of three u.s mid-atlantic estuaries,” Marine Ecology Progress Series,
vol. 161, pp. 239–254, 1997.
[38] J. Link, “Does food web theory work for marine ecosystems?,” Mar. Ecol.
Prog. Ser., vol. 230, pp. 1–9, 2002.
[39] J. Memmott, N. D. Martinez, and J. E. Cohen, “Predators, parasitoids and
pathogens: species richness, trophic generality and body sizes in a natural
food web,” J. Anim. Ecol., vol. 69, pp. 1–15, 2000.
[40] P. H. Warren, “Spatial and temporal variation in the structure of a freshwater food web,” Oikos, vol. 55, pp. 299–311, 1989.
[41] R. R. Christian and J. J. Luczkovich, “Organizing and understanding a
winter’s Seagrass foodweb network through effective trophic levels,” Ecol.
Model., vol. 117, pp. 99–124, 1999.
[42] L. Goldwasser and J. A. Roughgarden, “Construction of a large Caribbean
food web,” Ecology, vol. 74, pp. 1216–1233, 1993.
[43] Townsend, Thompson, McIntosh, Kilroy, Edwards, and Scarsbrook, “Disturbance, resource supply, and food-web architecture in streams,” Ecology
Letters, vol. 1, no. 3, pp. 200–209, 1998.
37

[44] U. Jacob, A. Thierry, U. Brose, W. Arntz, S. Berg, T. Brey, I. Fetzer,
T. Jonsson, K. Mintenbeck, C. Möllmann, O. Petchey, J. Riede, and
J. Dunne, “The role of body size in complex food webs,” Advances in
Ecological Research, vol. 45, pp. 181–223, 2011.
[45] M. Huxham, S. Beaney, and D. Raffaelli, “Do parasites reduce the chances
of triangulation in a real food web?,” Oikos, vol. 76, pp. 284–300, 1996.
[46] P. Holmes and E. T. Shea-Brown, “Stability,” Scholarpedia, vol. 1, p. 1838,
2006.
[47] L. Real, “Kinetics of functional response,” Am. Nat., vol. 111, pp. 289–300,
1977.
[48] A. Agrawal and K. Gopal, Biomonitoring of Water and Waste Water.
Springer India, 2013.
[49] R. L. Lindeman, “The trophic-dynamic aspect of ecology,” Ecology, vol. 23,
pp. 399–418, 1942.
[50] U. Brose, R. J. Williams, and N. D. Martinez, “Allometric scaling enhances
stability in complex food webs,” Ecology Letters, vol. 9, p. 1228–1236, 2006.
[51] S. Allesina and S. Tang, “Stability criteria for complex ecosystems,” Nature,
vol. 483, pp. 205–8, 2012.
[52] C. S. Elton, Animal Ecology. London: Sidgwick and Jackson, 1927.
[53] S. L. Pimm, The Balance of Nature? Ecological Issues in the Conservation
of Species and Communities. Chicago: The University of Chicago Press,
1991.
[54] M. E. J. Newman, “The structure and function of complex networks,”
SIAM Review, vol. 45, pp. 167–256, 2003.
[55] A. Arenas, A. Fernández, and M. Pascual, “Analysis of the structure of
complex networks at different resolution levels,” New Journal of Physics,
vol. 10, p. 053039, 2008.
[56] L. Danon, A. Dı́az-Guilera, J. Duch, and A. Arenas, “Comparing community structure identification,” J. Stat. Mech., p. P09008, 2005.
[57] D. Pauly, V. Christensen, J. Dalsgaard, R. Froese, and F. Torres, “Fishing
down marine food webs,” Science, vol. 279, pp. 860–3, 1998.
[58] S. Johnson, V. Domı́nguez-Garcı́a, and M. A. Muñoz, “Factors determining
nestedness in complex networks,” PLoS ONE, vol. 8(9), p. e74025, 2013.

38

