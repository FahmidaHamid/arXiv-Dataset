A CONSISTENCY LEMMA IN STATISTICAL PHYLOGENETICS
MIKE STEEL

arXiv:1501.06623v1 [q-bio.PE] 26 Jan 2015

Abstract. This short note provides a simple formal proof of a folklore result in statistical
phylogenetics concerning the convergence of bootstrap support for a tree and its edges.

1. Definitions and preliminaries
In this note T will refer to any rooted or unrooted phylogenetic tree, and T −ρ will refer to the
unrooted tree obtained from T by suppressing the root vertex ρ if it has one (i.e. if T is unrooted
then T −ρ = T ). Let θ be a vector of continuous parameters – including the branch lengths
of T , along with possibly other continuous parameters required to specify a model of character
evolution on T . Let Θ denote the set of values θ may take. Branch lengths, in particular,
are assumed to be strictly positive and finite; and in general Θ will be some open subset of
Euclidean space. Consider any stochastic process (e.g. Markov process, or mixture of Markov
processes) which assigns to each pair (T, θ) a probability distribution s = s(T, θ) on discrete,
finite-state characters at the tips of the tree. We assume throughout that the map θ 7→ s(T, θ) is
continuous. Such models are central to statistical phylogenetics and methods for reconstructing
phylogenetic trees from aligned genetic (e.g. DNA) sequences. A tree reconstruction method ψ is
any method that reconstructs a set of one or more unrooted phylogenetic trees from any given
distribution f̂ of site pattern frequencies. Suppose we generate k sites i.i.d. from (T, θ), and let ŝ
be the random variable equal to the resulting proportion of site patterns (character types). The
method ψ is a statistically consistent estimator of the unrooted topology of T if the probability
that ψ(ŝ) = {T −ρ } converges to 1 as k → ∞1. Suppose that ψ satisfies the following condition:
(*) For every tree T for which T −ρ is fully-resolved (i.e. binary), and each θ ∈ Θ(T ) a
value ǫ = ǫ(T,θ) > 0 exists for which the following inequality holds for every probability
distribution f̂ on site patterns: kf̂ − s(T, θ)k < ǫ ⇒ ψ(f̂ ) = {T −ρ }.
Here k · k denotes any of the usual norms in Euclidean space. Condition (*) implies the statistical consistency of ψ for inferring T −ρ since the i.i.d. assumption ensures that ŝ converges in
probability to s(T, θ) as k grows, and so:
P(ψ(ŝ) = {T −ρ }) ≥ P(kŝ − s(T, θ))k < ǫ(T,θ) ) → 1, as k → ∞.
Not only does condition (*) imply that ψ(s(T, θ)) = {T −ρ } whenever T −ρ is fully-resolved but
(*) also implies the stronger condition that for any tree T ′ that has a different unrooted topology
(fully-resolved or non-fully-resolved) from the fully-resolved tree T we have:
(1)

inf

θ ′ ∈Θ(T ′ )

ks(T, θ) − s(T ′ , θ′ )k > 0,

a strong ‘identifiablity’ condition, referred to as ‘no touching’ in [3].
Condition (*) is a type of local stability condition. It applies, for example, to distance-based
tree reconstruction applied to (statistically consistent) ‘corrected distances’ derived from the
Date: January 26, 2015.
1There is a slightly stronger definition involving almost sure convergence rather than convergence in probability,
and the results here can be extended to that setting also.
1

2

MIKE STEEL

characters, provided that the distance-reconstruction method has a positive ‘safety radius’, which
holds for many (but not all) distance-based methods, including the popular Neighbor-Joining
method [1]. Condition (*) also applies to MLE (maximum likelihood estimation) for models
which satisfy (1) – such models include the general time-reversible (GTR) Markov processes and
its submodels (e.g. Jukes-Cantor type models) and certain extensions of these models. Here
MLE treats θ as ‘nuisance parameters’ to be optimized as part of the search for the MLE tree;
given a vector f̂ as input, MLE selects the tree(s) T ′ maximizing supθ∈Θ(T ′ ) P(f̂ |s(T ′ , θ)). The
proof that Condition (*) holds for models satisfying (1) follows from standard analytic arguments
based on the continuity of the map θ 7→ P(f̂ |s(T ′ , θ)) (see e.g. [2] or [3]).
2. Result
Given ŝ derived from k i.i.d. site patterns, let ŝ∗ denote the frequency of site patterns obtained
by taking an i.i.d. sample of k site patterns using probability distribution ŝ. Thus ŝ∗ is the
distribution of site patterns in a bootstrap sample from the original data. The bootstrap support
of an edge e of an unrooted phylogenetic tree T ′ , is the expected proportion of such bootstrap
samples for which a tree, sampled uniformly at random from ψ(ŝ∗ ), has an edge that induces
the same split of the leaf taxa as e does in T ′ (it is a random variable by its dependence on ŝ,
and since ψ can return more than one tree). The bootstrap support for T ′ is the random variable
P(ψ(ŝ∗ ) = {T ′ }|ŝ), the expected proportion of bootstrap samples for which ψ returns the single
tree T ′ . The following result was motivated by a question from T. Warnow (pers. comm.).
Lemma 1. Suppose k sites are generated i.i.d. by s(T, θ). Under the sufficient condition (*) for
statistical consistency, the bootstrap support of every edge e of T −ρ converges in probability to 1
as k → ∞. Moreover, the bootstrap support for T −ρ converges in probability to 1 as k → ∞.
Proof. Clearly it suffices to prove the second assertion in the lemma, since, by definition, the
bootstrap support for any edge e of T −ρ is at least P(ψ(ŝ∗ ) = {T −ρ }|ŝ). Let X = X(ŝ) be the 0/1
random variable which takes the value 1 precisely if ψ(ŝ∗ ) = {T −ρ }, and which is 0 otherwise.
Let Y denote the expected bootstrap support for T −ρ given ŝ; thus Y = P(ψ(ŝ∗ ) = {T −ρ }|ŝ) =
E[X|ŝ] (i.e. the conditional expectation of X given ŝ). Notice that:
E[Y ] = E[E[X|ŝ]] = E[X] = P(ψ(ŝ∗ ) = {T −ρ }).

(2)
p

p

p

→ s. Consequently, by Condition (*),
Now, as k grows, ŝ −
→ s, and ŝ∗ − ŝ −
→ 0; thus ŝ∗ −
∗
−ρ
P(ψ(ŝ ) = {T }) converges to 1 as k → ∞, and so, by (2), limk→∞ E[Y ] = 1. Finally, since
Y takes values in the interval [0, 1], and the expected value of Y converges to 1 as k → ∞, it
p
follows that (for the bootstrap support for T −ρ ) we have Y −
→ 1 as k → ∞, as required.

Note that the empirical bootstrap support for an edge (or for a tree) given ŝ, converges
in probability to the (expected) bootstrap support value defined here, as the number N of
independent bootstrap replicates becomes large; hence our results are also relevant for empirical
bootstrap support for large N .
References
[1] Atteson, K. (1999). The performance of neighbor-joining methods of phylogeny reconstruction. Algorithmica
25(2–3): 251–278.
[2] Chang, J.T. (1996). Full reconstruction of Markov models on evolutionary trees: identifiability and consistency. Math. Biosci. 137: 51–73.
[3] Steel, M. (2011). Can we avoid ‘SIN’ in the House of ‘No Common Mechanism’ ? Systematic Biology 60(1):
96–109.
Biomathematics Research Centre, University of Canterbury, Christchurch, New Zealand.
E-mail address: mike.steel@canterbury.ac.nz

