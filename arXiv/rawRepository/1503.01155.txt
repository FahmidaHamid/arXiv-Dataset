arXiv:1503.01155v1 [q-bio.MN] 3 Mar 2015

Genetic Recombination
as a Chemical Reaction Network
Stefan Müller∗ and Josef Hofbauer
March 5, 2015
Dedicated to the memory of the Viennese chemists and mathematicians
Rudolf Wegscheider (1859–1935), Hilda Geiringer (1893–1973),
and Friedrich J. M. Horn (1927–1978)
Abstract
The process of genetic recombination can be seen as a chemical reaction
network with mass-action kinetics. We review the known results on
existence, uniqueness, and global stability of an equilibrium in every
compatibility class and for all rate constants, from both the population
genetics and the reaction networks point of view.

1

Introduction

Recombination, or chromosomal crossover, is the exchange of genetic material between a pair of homologous chromosomes. It occurs when matching
regions on matching chromosomes break and then reconnect to the other
chromosome. Recombination is the major evolutionary force to produce
and maintain variation in a (sexual) population.
The process of recombination
   
   
0 1 k 0 1
 + ! + 
1 0
0 1

involves two loci, two alleles per locus, and hence four gametes. It can be
written as a reversible chemical reaction
k

g1 + g4 ⇔ g2 + g3 .
S. Müller (stefan.mueller@ricam.oeaw.ac.at). Johann Radon Institute for Computational and
Applied Mathematics, Austrian Academy of Sciences, Altenbergerstraße 69, 4040 Linz, Austria
J. Hofbauer (josef.hofbauer@univie.ac.at). Department of Mathematics, University of Vienna,
Oskar-Morgenstern-Platz 1, 1090 Wien, Austria
∗ Corresponding author

1

Müller and Hofbauer, 2015

2

This is a very simple reaction network with deficiency zero. The recombination g1 + g4 → g2 + g3 occurs at the rate k p1 p4 determined by the
rate constant times the frequencies of the reacting gametes. In the chemical
setting, this corresponds to the assumption of mass-action kinetics. The
dynamical system for the gamete frequencies amounts to
ṗ1 = ṗ4 = k (−p1 p4 + p2 p3 ) = −ṗ2 = −ṗ3 .
There are conservation laws
(p1 + p2 )· = (p1 + p3 )· = (p4 + p2 )· = (p4 + p3 )· = 0
of which three are linearly independent. The equilibrium manifold is given
by the conic
p1 p4 = p2 p3 .
In each stoichiometric compatibility class, solutions converge to a unique
detailed-balancing equilibrium. This is usually proved by considering the
so-called linkage disequilibrium function D = p1 p4 − p2 p3 , which satisfies
Ḋ = −k D (p1 + p2 + p3 + p4 ) .
Hence, D converges to 0.
Alternatively,
P4 one can try an ansatz for a Lyapunov function in the form
V (p) = i=1 F (pi ). Then,
V̇ (p) =

4
X
i=1


F ′ (pi ) ṗi = −k D F ′ (p1 ) + F ′ (p4 ) − F ′ (p2 ) − F ′ (p3 ) .

For the choice F ′ (p) = ln p, we obtain

V̇ (p) = −k D (ln p1 + ln p4 − ln p2 − ln p3 )
= −k (p1 p4 − p2 p3 ) (ln(p1 p4 ) − ln(p2 p3 )) ≤ 0
due to the monotonicity of the logarithm. This shows that V (p), with the
convex function F (p) = p ln p − p, is a global Lyapunov function.
The main object of this paper is to study the general recombination model in
continuous time, with an arbitrary number of genetic loci and arbitrary numbers of alleles at each locus. We will see that this leads to a chemical reaction
network which is reversible, satisfies the Wegscheider conditions [22] (since
the rate constants of a reaction and its reverse coincide), and is detailedbalancing. A generalization of the above entropy-like Lyapunov function
allows us to prove global stability.
In population genetics, this general recombination model was studied (in
discrete time) by Geiringer [6], and further by [2, 16–18]. Their proofs use
linkage disequilibrium functions, induction on the number of loci, cumulants,
etc., and are far from easy. Simpler proofs based on the entropy as Lyapunov
function were independently given by Akin [1] (in continuous time) and
Lyubich [12] (in discrete time).

3

Müller and Hofbauer, 2015

2

Mathematical model

Notation: We denote the positive real numbers by R>0 and the nonI
negative real numbers by R≥0 . For a finite
P index set I, we write R for
the real vector space of formal sums x = i∈I xi i with xi ∈ R. Viewing
the elements of I as indicator functions, a vector x ∈ RI can be seen as a
function x : I → R, and x(i) = xi . For x, y ∈ RI≥0 , we define xy ∈ R≥0 as
Q
yi
0
I×J , we denote by
i∈I xi , where we set 0 = 1. Given a matrix Y ∈ R
j
I
Y ∈ R the column vector indexed by j ∈ J. For x ∈ RI≥0 and Y ∈ RI×J
≥0 ,
Q
j
Yij
Y
J
Y
Y
we define x ∈ R≥0 as (x )j = x = i∈I xi for j ∈ J.

2.1

Genetic recombination

We consider a finite set of loci L with L = |L| ≥ 1, finite sets of alleles Ai
with Ai = |Ai | ≥ 2 for i ∈ L, the resulting set of gametes
G = A1 × . . . × AL ,
and the set of recombination patterns
P = {{I, J} | I ⊆ L, J = L \ I}.
In a recombination following pattern {I,Q
J}, alleles at loci I get separated
from alleles at loci J. There are |G| = i∈L Ai gametes and |P| = 2L−1
recombination patterns, including the trivial recombination {∅, L}.
Further, we introduce the distribution of gamete frequencies
p : G → R≥0
and the distribution of recombination rate constants
c : P → R≥0 .
We identify
the function p : G → R≥0 with the vector p ∈ RG≥0 and write
P
p = g∈G p(g) g. Usually, we are interested in elements of the simplex
SG = {p ∈ RG≥0 |

P

g∈G

p(g) = 1}.

For gametes g, h ∈ G and a recombination pattern {I, J} ∈ P, we define
gI hJ ∈ G as
(
gi , if i ∈ I,
(gI hJ )i =
hi , if i ∈ J
and the resulting recombination as
{g, h}

c({I,J})

{gI hJ , gJ hI }

(1)

4

Müller and Hofbauer, 2015
with rate constant c({I, J}). For gI hJ , gJ hI ∈ G and {I, J} ∈ P, we find
(gI hJ )I (gJ hI )J = g

and

(gI hJ )J (gJ hI )I = h

and obtain the reverse recombination
{gI hJ , gJ hI }

c({I,J})

{g, h}

which occurs with the same rate constant.
Clearly, recombination (1) causes a change in gamete frequencies only if
{g, h} =
6 {gI hJ , gJ hI } and c({I, J}) > 0. Further, different recombination
patterns may give rise to the same recombination (with different rate constants, in general). In order to view recombination as a chemical reaction,
we have to ensure inequality of left- and right-hand sides and positivity of
rate constants. Moreover, we have to sum over the rate constants of all contributing recombination patterns which can be seen as reaction mechanisms.

2.2

Chemical reactions

Let K ⊆ L be a subset of loci. The recombination pattern {I, J} ∈ P
induces the subpattern {I, J}K ∈ PK where {I, J}K = {I ∩ K, J ∩ K} and
PK = {{I, J} | I ⊆ K, J = K \ I}.
∗ = P \ {{∅, K}}. The
We write {I, J} ≥ {I, J}K and, for simplicity, PK
K
set of all recombination subpatterns amounts to
[
PK ,
P̆ =
K⊆L

and we introduce the distribution of cumulative recombination rate constants
c̆ : P̆ → R≥0 ,
{I, J} 7→

X

c({I ′ , J ′ }).

{I ′ ,J ′ }∈P:
{I ′ ,J ′ }≥{I,J}

For a subpattern {I, J} with J = K \ I and K ⊆ L, the cumulative rate
constant c̆({I, J}) sums over all patterns which agree with {I, J} on K.
An important parameter is the cumulative rate constant for the recombination subpattern {{i}, {j}}, that is, for the case that an allele at locus i gets
separated from an allele at locus j. We assume that c̆({{i}, {j}}) > 0 for
all pairs of loci i, j. Otherwise, the two loci can be identified.

5

Müller and Hofbauer, 2015

To explicitly state a chemical reaction arising from a recombination pattern
and a pair of gametes, we introduce the set ∆(g, h) = {i ∈ L | gi 6= hi } for
gametes g, h ∈ G. In genetic terms, g and h are heterozygous at the subset
of loci ∆(g, h) and homozygous otherwise.
Now, gametes g, h ∈ G and a recombination pattern {I, J} ∈ P give rise
to a reaction mechanism, only if |∆(g, h)| ≥ 2, {I, J}∆(g,h) 6= {∅, ∆(g, h)},
and c({I, J}) > 0. In other words, only if the gametes are heterozygous at
two or more loci, if the subpattern induced on these loci is non-trivial, and
if the recombination rate constant is non-zero. Every pattern {I ′ , J ′ } ∈ P
with {I ′ , J ′ } ≥ {I, J}∆(g,h) and c({I ′ , J ′ }) > 0 gives rise to a mechanism for
the same reaction, that is, to the same recombination (with different rate
constant, in general). The effect of all such patterns is summarized in the
chemical reaction
k
g + h → gI hJ + gJ hI
(2)
with rate constant k ≡ k(g + h → gI hJ + gJ hI ) = c̆({I, J}∆(g,h) ) > 0. Note
that g + h stands for {g, h} such that g + h equals h+ g. The reverse reaction
k

gI hJ + gJ hI → g + h
occurs with the same rate constant.

2.3

Reaction networks

A chemical reaction network (S, C, R) consists of three finite sets: a set S
of species, a set C ⊂ RS≥0 of complexes, and a set R ⊂ C × C of reactions.
Complexes are the left- and right-hand sides of P
reactions. A complex y ∈ C
can be seen as a formal sum of species y =
s∈S ys s, where ys is the
stoichiometric coefficient of species s. For a reaction (y, y ′ ) ∈ R, we write
y → y ′ . It is required that each complex appears in at least one reaction
and that there are no reactions of the form y → y.
A chemical reaction network (S, C, R) together with a vector of rate constants k ∈ RR
>0 gives rise to a weighted directed graph with complexes as
nodes, reactions as edges, and rate constants as labels. The connected components of this graph are called linkage classes. (Note that linkage classes
have nothing to do with genetic linkage.) A network is called weakly reversible if every component is strongly connected, that is, if there exists a
directed path from each node to every other node in the component.
In the process of genetic recombination, the reacting species are the gametes,
that is, S = G. Every complex g + h is a formal sum (with stoichiometric
coefficients equal to one) of two gametes g and h, which differ at two or more
loci, and every reaction g + h → gI hJ + gJ hI arises from a pair of gametes
and a recombination pattern {I, J}, under the conditions specified in the

6

Müller and Hofbauer, 2015

previous subsection. The set of all chemical reactions (with corresponding
rate constants) amounts to

n
k

R = g + h → gI hJ + gJ hI  g, h ∈ G, {I, J} ∈ P with |∆(g, h)| ≥ 2, (3)
{I, J}∆(g,h) 6= {∅, ∆(g, h)}, and
o
k ≡ c̆({I, J}∆(g,h) ) > 0 .

For each reaction y → y ′ we have its reverse y ′ → y, and both occur with
the same rate constant. Hence, we can combine them in the reversible
reaction y ⇔ y ′ , which we identify with y ′ ⇔ y, and write k(y ⇔ y ′ ) for
k(y → y ′ ) = k(y ′ → y). From (3), we obtain the set of all reversible reactions
k

k

R⇔ = {y ⇔ y ′ | (y → y ′ ) ∈ R}

(4)

and the set of all complexes
C = {y | (y → y ′ ) ∈ R}.

(5)

In the examples and schemes below, we determine the set of all (reversible)
reactions in another way. We first iterate over subsets of two or more loci
and then over non-trivial subpatterns on these loci:

n
k

R⇔ = g + h ⇔ gI hJ + gJ hI  K ⊆ L with |K| ≥ 2,
g, h ∈ G with |∆(g, h)| = K,

o
∗
{I, J} ∈ P∆(g,h)
with k ≡ c̆({I, J}) > 0 .

Thereby, we extend the definition of gI hJ to the subpattern {I, J} ∈ P∆(g,h)
in the obvious way: (gI hJ )i = gi for i ∈ I, (gI hJ )i = hi for i ∈ J, and
(gI hJ )i = gi = hi for i ∈ L \ (I ∪ J).
Finally, we consider the graph arising from the reaction network (S, C, R),
in particular, its linkage classes. We observe that species (gametes) consist
of alleles and complexes (pairs of gametes) contain two alleles at each locus. Since reactions separate alleles, but do not consume or produce them,
only complexes which contain the same alleles are connected by a reaction.
Moreover, if complexes g + h and g ′ + h′ are connected by a reaction then
∗
which gives rise
∆(g, h) = ∆(g ′ , h′ ), and every subpattern {I, J} ∈ P∆(g,h)
to a reaction involving g + h gives rise to a reaction involving g′ + h′ , and
vice versa. Hence every linkage class is a symmetric graph. If no reaction
is precluded by a zero rate constant, then every linkage class is a complete
graph, characterized by two (possibly identical) alleles at each locus.

7

Müller and Hofbauer, 2015

2.4

Examples and schemes

We consider examples of genetic recombination for small numbers of loci and
alleles and depict the corresponding chemical reaction networks as graphs.
Further, we present schemes for arbitrary numbers of loci and compute the
resulting numbers of linkage classes, complexes, and reversible reactions. For
simplicity, we assume that no reaction is precluded by a zero rate constant.
In this case, all linkage classes are complete graphs.
Instead of c({I, J}) we write c(I) and further omit the set brackets, e.g.,
c({{1}, L \ {1}}) ≡ c({1}) ≡ c(1).
Example 1 (L = 2 loci with A1 = A2 = 2 alleles).
   
0 1
  +   ks
0 1

c(1)

 

 

   
+3 1 + 0
0 1

The graph has l = 1 linkage class, m = 2 complexes, and r = 1 reversible
reaction.
Example 2 (L = 3 loci with A1 = A2 = A3 = 2 alleles).
   
0 1
   
0 + 1 ks
   
0 0

   
0 1
   
0 + 0 ks
   
0 1
   
0 0
   
0 + 1 ks
   
0 1

c(1)+c(2)

c(1)+c(3)

c(2)+c(3)

   
1 0
   
+3 0 + 1
   
0 0
   
1 0
   
+3 0 + 0
   
0 1
   
0 0
   
+3 1 + 0
   
0 1

   
0 1
   
1 + 0 ks
   
0 1

,

,

,

c(1)

   
0 1
   
0 + 1 ks
   
1 1
   
0 1
   
1 + 1 ks
   
0 1
   
1 1
   
0 + 1 ks
   
0 1

   
1 0
   
+3 1 + 0
   
0 1

c(1)+c(2)

c(1)+c(3)

c(2)+c(3)

   
1 0
   
+3 0 + 1
   
1 1
   
1 0
   
+3 1 + 1
   
0 1
   
1 1
   
+3 0 + 1
   
1 0

[c ❃❃c(3)
;C
SK
❃❃❃❃
❃
❃
c(2)
c(2)
❃❃❃❃
     { c(3) #     
KS

0 1
   
0 + 1 ks
   
0 1

c(1)

1
 
 
0

0
 
 
1

+3 0 + 1

The graph has l = 7 linkage classes, m = 16 complexes, and r = 12 reversible

L−1 
= 42 = 6
reactions. The last class has 2L−1 = 4 complexes and 2 2
reactions.

8

Müller and Hofbauer, 2015
Scheme 3 (L ≥ 2 loci with Ai = 2 alleles, i = 1, . . . , L).
L  
X
L L−k
2
l=
k
k=2
L

= 3 − (2L + L 2L−1 )

= 3L − 2L−1 (2 + L)
L  
X
L

2L−k 2k−1
k
k=2

P
L
= 2L−1 L
k=2 k

m=

= 2L−1 (2L − (1 + L))

r=
=
=

L  
X
L

k

k=2
PL
k=2
PL
k=2
L−3

2



2k−1
2



L L−k k−1 k−1
2 (2
− 1) 2−1
k 2

L
L−3 2k − 2L−2 )
k (2
L
L−2 L

(3 − (1 + L 2)) − 2

=2

L−3

=2

L−k

L

L−2

(3 − 1) − 2

(2 − (1 + L))

L

(2 − 1)

Example 4 (L = 2 loci with A1 = 2 and A2 = 3 alleles, respectively).
   
   
0 1 c(1) 1 0
  +   ks
+3   +  
0 1
0 1
   
0 1
  +   ks
0 2
   
0 1
  +   ks
1 2

c(1)

c(1)

 

 

 

 

   
+3 1 + 0
0 2
   
+3 1 + 0
1 2

The graph has l = 3 linkage classes, m = 6 complexes, and r = 3 reversible
reactions.
Scheme 5 (L ≥ 2 loci with Ai ≥ 2 alleles, i = 1, . . . , L).
X
Y Ai  Y
Ai
l=
2
i∈L\K
K⊆L:|K|≥2 i∈K
X
Y Ai  Y
Ai 2|K|−1
m=
2
i∈L\K
K⊆L:|K|≥2 i∈K


 |K|−1 
Y
X
Y Ai
2
Ai
r=
2
2
K⊆L:|K|≥2 i∈K

i∈L\K

9

Müller and Hofbauer, 2015

2.5

Dynamics

Recombination (1) causes a change in gamete frequencies proportional to
gI hJ + gJ hI − g − h at the rate c({I, J}) p(g) p(h) determined by the recombination rate constant times the frequencies of the “reacting” gametes.
G
We formulate the dynamical
Psystem for the vector p ∈ R≥0 of all gamete
frequencies, that is, for p = g∈G p(g) g, by summing over all recombination
partners and patterns:
dp
1 X
=
dt
2

X

c({I, J}) p(g) p(h) (gI hJ + gJ hI − g − h) .

(6)

g,h∈G {I,J}∈P

The contribution of a particular recombination (1) is identically zero if
{g, h} = {gI hJ , gJ hI } or c({I, J}) = 0. On the other hand, different recombination patterns may yield the same recombination (except for the rate
constants). As detailed in Subsection 2.2, the effect of all patterns causing
recombination (1) can be summarized in the chemical reaction (2), provided
that the recombination is effective and the cumulative rate constant is positive. Reaction (2) occurs at the rate c̆({I, J}∆(g,h) ) p(g) p(h). In chemical
terms, it follows mass-action-kinetics.
Mass-action kinetics
Let (S, C, R) be a chemical reaction network and k ∈ RR
>0 a vector of rate
constants. Under the assumption of mass-action kinetics, the rate of a reaction (y → y ′ ) ∈ R, which depends on the species concentrations x ∈ RS≥0 , is
given by k(y → y ′ ) xy , that is, by a monomial in the reactant concentrations
with the corresponding stoichiometric coefficients as exponents.
Hence, we obtain a dynamical system equivalent to (6), by summing over
all reactions (3) and assuming mass-action kinetics:
dp
=
dt

X

(g+h→g ′ +h′ )∈R


k(g + h → g ′ + h′ ) p(g) p(h) g′ + h′ − g − h .

(7)

The right-hand side of (7) can be written as a product of the stoichiometric
matrix N ∈ RG×R and the rate vector vk (p) ∈ RR
≥0 . Thereby, the column
vector of N indexed by (g +h → g′ +h′ ) ∈ R is given by (g ′ +h′ −g −h) ∈ RG
and the component of vk (p) indexed by g + h → g′ + h′ is given by k(g + h →
g ′ + h′ ) p(g) p(h). Hence,
dp
= N vk (p).
(8)
dt

10

Müller and Hofbauer, 2015
Complex balancing

The right-hand side of the dynamical system (7) can also be written as a
product of the complex matrix Y ∈ RG×C , the Laplacian matrix Ak ∈ RC×C
of the weighted directed graph, and the vector of monomials pY ∈ RC . The
column vector of Y indexed by y ∈ C is given by y ∈ RG≥0 itself, that is,
′
′
′
Y y = y, and
PAk is defined as follows: (Ak )y y = ky→y if (y → y ) ∈ R,
(Ak )yy = − (y→y′ )∈R ky→y′ , and (Ak )y′ y = 0 otherwise. We obtain
dp
= Y Ak pY
dt

(9)

y

Recall that (pY )y = pY = py for y ∈ C. For a particular complex y = g + h,
we have py = pg+h = p(g) p(h).
An equilibrium of (9) is called complex-balancing if Ak pY = 0. That is, if
at each complex the rates of all reactions sum up to zero.
Detailed balancing
In the process of genetic recombination, all reactions are reversible. Moreover, the rate constants of a reaction and its reverse coincide. Hence, we
obtain a dynamical system equivalent to (7), by summing over all reversible
reactions (4):
dp
=
dt

X

k(g + h ⇔ g ′ + h′ ) (p(g) p(h) − p(g ′ ) p(h′ )) (g ′ + h′ − g − h) .

(g+h⇔g′ +h′ )∈R⇔

(10)

An equilibrium of (10) is called detailed-balancing if p(g) p(h) = p(g ′ ) p(h′ )
for all (g + h ⇔ g ′ + h′ ) ∈ R⇔ . In general, an equilibrium of a reversible
reaction network is called detailed-balancing if the rates of each reaction
and its reverse coincide. Clearly, every detailed-balancing equilibrium is
complex-balancing.

2.6

Conserved quantities

The change over time (8) lies in a subspace of RG , and every trajectory in RG≥0
lies in a coset of this subspace. We define the stoichiometric subspace
S = im N
and the stoichiometric compatibility classes
S(p) = (p + S) ∩ RG≥0
for p ∈ RG≥0 . Every stoichiometric class is characterized by its orthogonal
projection on S ⊥ = (im N )⊥ = ker N T , that is, by a vector of conserved

11

Müller and Hofbauer, 2015
quantities. For u ∈ S ⊥ , that is, uT N = 0, we have
d(uT p)
= 0,
dt
that is, uT p = const.

P
We observe that the vector 1 ≡ 1G = g∈G g is orthogonal to all columns
of N : 1T (g′ +P
h′ − g − h) = 0 for all (g + h → g ′ + h′ ) ∈ R, that is, 1T N = 0.
Since 1T p = g∈G p(g), we have
P
d( g∈G p(g))
dt

= 0,

and, as one consequence, the simplex SG is invariant.
Further, we consider for each locus and each allele at this locus the subset of
gametes which contain this allele and define the corresponding formal sum
of gametes
X
ui (a) =
g for i ∈ L and a ∈ Ai ,
g∈G:gi =a

where ui (a) ∈ {0, 1}G . As already mentioned, only complexes which contain
the same alleles are connected by a reaction. Hence, ui (a)T (g′ +h′ −g−h) = 0
for all (g + h → g ′ + h′ ) ∈ R, that is, ui (a)T N = 0, and the marginal
frequencies
X
pi (a) = ui (a)T p =
p(g)
g∈G:gi =a

are conserved quantities, that is,
dpi (a)
= 0.
dt
For each i ∈ L, we have
X

ui (a) =

a∈Ai

and

X

pi (a) =

a∈Ai

X

g

g∈G

X

p(g).

g∈G

P
Hence, there are at least 1+ i∈L (Ai −1) linearly independent vectors in S ⊥
and as many independent marginals.
We define the marginal compatibility classes

M (p) = {p′ ∈ RG≥0 | p′i (a) = pi (a) for i ∈ L and a ∈ Ai }
for p ∈ RG≥0 . Clearly, S(p) ⊆ M (p).

12

Müller and Hofbauer, 2015

3

Results

We determine the equilibria for the process of genetic recombination and
prove convergence to a unique equilibrium.
First, we rewrite the dynamical system (6). Using the symmetry in the
double sum over recombination partners, we obtain
X
dp
=
dt

X

c({I, J}) p(g) p(h) (gI hJ − g)

g,h∈G {I,J}∈P

=

X

{I,J}∈P

P



c({I, J}) 

X

g,h∈G



p(g) p(h) gI hJ − p .

p(g) = 1, that is, p ∈ SG .
Q
For K ⊆ L, we define the set of subgametes GK = i∈K Ai , the projection
G → GK , g 7→ gK , where (gK )i = gi for i ∈ K, and its linear extension
GK
G
to the corresponding vector spaces:
P
P R≥0 → R≥0 , p 7→ pK , where pK =
p(h). If K = {i} with i ∈ L,
g∈G p(g) gK , that is, pK (gK ) =
h∈G:hK =gP
K
we
recover
the
marginal
frequencies
p
=
i
g∈G p(g) gi , that is, pi (gi ) =
P
p(h).
h∈G:hi =gi
Thereby, we assumed

g∈G

Let {I, J} ∈ P. For g ∈ GI and h ∈ GJ , we define gh ∈ G as (gh)i = gi for
i ∈ I and (gh)i = hi for i ∈ J and extend the multiplication GI × GJ → G
I
J
linearly to RG≥0
× RG≥0
→ RG≥0 . Hence, we write
dp
=
dt
=

X

{I,J}∈P

X



c({I, J}) 

X

p(g) gI

X

h∈G

g∈G

c({I, J}) (pI pJ − p) .



p(h) hJ − p

(11)

{I,J}∈P

In fact, we may sum over {I, J} ∈ P ∗ since the contribution of {∅, L} is
identically zero.
The projection of a trajectory of the dynamical system is the trajectory of
a projected dynamical system with the same structure: For K ⊆ L and
{I ′ , J ′ } = {I, J}K ∈ PK , we find
X
X
(pI pJ )K =
p(g) p(g) (gI hJ )K =
p(g) p(g) gI ′ hJ ′ = pI ′ pJ ′
g,h∈G

g,h∈G

13

Müller and Hofbauer, 2015
and hence
dpK
=
dt

X

{I ′ ,J ′ }∈PK

=

X

X

c({I, J}) ((pI pJ )K − pK )

{I,J}∈P:
{I,J}≥{I ′ ,J ′ }

c̆({I ′ , J ′ }) (pI ′ pJ ′ − pK ) .

{I ′ ,J ′ }∈PK

3.1

Equilibria

Now, we are in a position to characterize the equilibria on the simplex.
Lemma 1. For all recombination rate constants, p ∈ SG is an equilibrium
of the dynamical system (6) if and only if
Y
Y
p=
pi , that is, p(g) =
pi (gi ).
(12)
i∈L

i∈L

Proof. We show that, if (12), then
pI =

Y

pi .

i∈I

Indeed, for {I, J} ∈ P and J = {1, . . . , |J|}, we find
X
pI (gI ) =
p(gI hJ )
hJ ∈GJ

=

X

X Y

...

h1 ∈G1

pi (gi )

h|J| ∈G|J| i∈I

=

Y

pi (gi )

=

Y

pi (gi ).

X

Y

p1 (h1 ) . . .

h1 ∈G1

i∈I

pi (hi )

i∈J

X

p|J| (h|J| )

h|J| ∈G|J|

i∈I

Hence,
pI pJ =

Y
i∈I

pi

Y
i∈J

pi =

Y

pi = p

i∈L

for all {I, J} ∈ P, and p ∈ SG is an equilibrium of the dynamical system (11)
equivalent to (6).
It remains to show that p ∈ SG is an equilibrium only if (12). We proceed
by induction on the number of loci:
For L = {1}, there is no non-trivial recombination. Every p ∈ SG is an
equilibrium which coincides with its marginals: p(g) = p1 (g) for g ∈ G, that
is, p = p1 .

14

Müller and Hofbauer, 2015

For L ≥ 2, we consider subsets of loci K ⊂ L with |K| < L. The projection
of an equilibrium p ∈ SG of the dynamical system (with loci L) is an equilibrium of the projected
dynamical system (with loci K). By the induction
Q
hypothesis, pK = i∈K pi and hence
pI pJ =

Y
i∈I

pi

Y

pi =

i∈J

Y

pi

i∈L

for all {I, J} ∈ P ∗ . Summing over {I, J} ∈ P ∗ in (11), we obtain
!
X
Y
0=
pi − p
c({I, J})
{I,J}∈P ∗

i∈L

Q
and hence p = i∈L pi . (There always exists a non-zero rate constant for
some non-trivial recombination pattern.)
If the dynamics is not restricted to the simplex, then p ∈ RG≥0 is an equilibrium if and only if
P
1−L Y
p=
pi .
p(g)
g∈G
i∈L

Clearly, every equilibrium is determined by its marginals, and we have the
following result.
Proposition 2. Every marginal compatibility class contains a unique equilibrium.
In chemical terms, every equilibrium is detailed-balancing since
Y
Y
p(g) p(h) =
pi (gi ) pi (hi ) =
pi (gi′ ) pi (h′i ) = p(g ′ ) p(h′ )
i∈L

i∈L

for all (g + h ⇔ g′ + h′ ) ∈ R⇔ , cf. Equation (10). Recall that only complexes
which contain the same alleles are connected by a reaction. In fact, we can
derive the following result entirely in the chemical setting.
Proposition 3. Every stoichiometric compatibility class contains a unique
positive equilibrium, which is detailed-balancing, and no boundary equilibria.
Proof. First, we determine the set of positive detailed-balancing equilibria.
Using positivity, we write the condition for detailed balancing,
p(g) p(h) = p(g ′ ) p(h′ ) for all (g + h ⇔ g ′ + h′ ) ∈ R⇔ ,
as

′

′

pg +h −g−h = 1 for all (g + h → g ′ + h′ ) ∈ R

15

Müller and Hofbauer, 2015
and even more abstractly as
pN = 1,

where N ∈ RG×R is the stoichiometric matrix and 1 ≡ 1R . Clearly, the
trivial solution is given by p∗ = 1 ≡ 1G . To determine all solutions, we take
the logarithm,
N T ln p = 0,
and note that ker N T = (im N )⊥ = S ⊥ and dim(S ⊥ ) ≥ 1. Hence, we can
write the set of positive detailed-balancing equilibria as
Z = {p ∈ RG>0 | ln p − ln p∗ ∈ S ⊥ }.
Clearly, every detailed-balancing equilibrium is complex-balancing. Now,
if there exists a positive complex-balancing equilibrium p∗ , then the set of
positive complex-balancing equilibria is given by Z and there are no other
positive equilibria [10, Theorem 6A]. Moreover, every stoichiometric compatibility class contains a unique positive equilibrium [10, Lemma 4B]. Hence,
the sets of positive detailed- and complex-balancing equilibria coincide, and
every stoichiometric compatibility class contains a unique positive equilibrium, which is detailed-balancing.
It remains to preclude boundary equilibria. We consider an arbitrary initial
value p ∈ RG≥0 on the boundary, that is, p(g) = 0 for some g ∈ G, and
define the set of gametes G0 = {g ∈ G | p(g) > 0}. Note that for each locus
and each allele at this locus there is a gamete which contains this allele and
occurs with a positive frequency. Further, recall that each pair of loci gets
separated by some recombination pattern with positive rate constant. By
Lemma 4 below, the set of all gametes G is reachable from G0 . Now, let p(t)
be the solution of the dynamical system with p(0) = p. By [21, Theorem 2,
p. 618], p(t) ∈ RG>0 for t > 0, and hence p is not an equilibrium.
In the proof, we have used fundamental results about complex balancing
by Horn and Jackson [10]. Necessary and sufficient conditions for complex
balancing are given by Horn [9] and for detailed balancing by Vol’pert and
Hudjaev [21] and Feinberg [4]. For the relation between complex and detailed
balancing, see [3].
In the proof of Proposition 3, we have also used the purely graph-theoretical
concept of reachability. Let S and R be the species and reactions of a
chemical reaction network, and let S0 ⊆ S be a set of species. Iteratively,
we define
Si = Si−1 ∪ {g′ | g, h ∈ Si−1 and (g + h → g ′ + h′ ) ∈ R}
for i ≥ 1. Since the graph is finite, we find Si = Si∗ for some i∗ ≥ 0 and all
i ≥ i∗ , and the set of species reachable from S0 is given by Si∗ .

Müller and Hofbauer, 2015

16

For chemical reaction networks arising from genetic recombination, we have
the following result.
Lemma 4. In a process of recombination, assume that every pair of loci
gets separated by some pattern with positive rate constant. In the resulting
chemical reaction network, every gamete is reachable from a given set of
gametes, provided that every allele is contained in some gamete in this set.
Proof. We use induction on the number of loci:
For L = 1, the gametes coincide with the alleles.
For L ≥ 2, we consider subsets of loci K ⊂ L with |K| < L and project the
network and the given set of gametes on the loci K. In the projected network, every pair of loci gets separated by some pattern, and in the projected
set, every allele (at loci K) is contained in some gamete. By the induction
hypothesis, every gamete gK ∈ GK is reachable in the projected network,
and hence some gamete h ∈ G with hK = gK is reachable.
It remains to show that every gamete g′ ∈ G is reachable. Let L = {1, . . . , L}
and G = L\{1}, H = L\{2}. By the argument above, some gametes g, h ∈ G
′ , h = g ′ are reachable. If g ′ equals either g or h, then it is
with gG = gG
H
H
reachable. Otherwise, since loci 1 and 2 get separated by some pattern, we
find the reaction g + h → g ′ + h′ , and hence g ′ is reachable.
On the one hand, by Proposition 2, every marginal compatibility class contains a unique P
equilibrium. Hence, the set of all equilibria can be parametrized by 1 + i∈L (Ai − 1) independent marginals. On the other hand,
by Proposition 3, every stoichiometric compatibility class contains a unique
equilibrium. Since stoichiometric classes are contained in marginal classes,
we have the following result.
Corollary 5. The stoichiometric compatibility classes
coincide with the
P
marginal compatibility classes, and dim(S ⊥ ) = 1 + i∈L (Ai − 1).

3.2

Convergence

Our main results concern the convergence of the dynamics to a unique equilibrium. For the first theorem, we provide two proofs: one by induction (as
in the original literature) and one using the entropy as a Lyapunov function. For the second theorem, formulated in the chemical setting, we rely on
results from chemical reaction network theory which are based on the same
Lyapunov function.
Theorem 6. In every marginal compatibility class and for all recombination
rate constants, a process of genetic recombination converges to the unique
equilibrium given by (12).

17

Müller and Hofbauer, 2015

First Proof (Induction). Every marginal compatibility class is characterized
Q
by a unique equilibrium. Given an equilibrium p ∈ SG , that is, p = i∈L pi ,
we consider trajectories in the class M (p). We proceed by induction on the
number of loci:
For L = 1, we have M (p) = p.
For L ≥ 2, we consider subsets of loci K ⊂ L with |K| < L. The projection
of a trajectory φ : R≥0 → M (p) of the dynamical system (with loci L)
is a trajectory of the projectedQdynamical system (with loci K). By the
induction hypothesis, φ(t)K → i∈K pi as t → ∞ and hence
φ(t)I φ(t)J →

Y

Y

pi

i∈J

i∈I

pi =

Y

pi = p

i∈L

for all {I, J} ∈ P ∗ . Summing over {I, J} ∈ P ∗ in the dynamical system (11)
equivalent to (6), we obtain the non-autonomous differential equation
dφ
=
dt

X

c({I, J}) (φI φJ − φ)

{I,J}∈P ∗

X

= f (t) −

c({I, J}) φ

{I,J}∈P ∗

with

X

f (t) =

c({I, J}) φI φJ

{I,J}∈P ∗

and
f (t) →

X

c({I, J}) p

{I,J}∈P ∗

as t → ∞. In other words, the differential equation is asymptotically autonomous. The limiting equation
dφ
=
dt

X

c({I, J}) (p − φ)

{I,J}∈P ∗

is linear, and hence φ(t) → p in the limiting equation. Moreover, {p} is
the maximal compact invariant set in the limiting system, and therefore
φ(t) → p holds also for all solutions of the original dynamical system, see
e.g. [13, 14].
Second Proof (Lyapunov function). We consider the classical entropy function
X
H(p) = −
p(g) ln p(g) = − pT ln p ≥ 0
g∈G

18

Müller and Hofbauer, 2015

which defines a continuous function on the simplex SG . If p(g) > 0 for all
g ∈ G, then H is smooth and
X
X
Ḣ(p) = −
ṗ(g) ln p(g) −
ṗ(g) = − ṗT ln p,
g∈G

P

since
obtain

g∈G

Ḣ(p) =

g∈G

p(g) = 1. Using the dynamical system (10) equivalent to (6), we
X

(g+h⇔g ′ +h′ )∈R⇔


k(g + h ⇔ g ′ + h′ ) p(g) p(h) − p(g ′ ) p(h′ ) ·

· ln(p(g) p(h)) − ln(p(g ′ ) p(h′ )) ≥ 0.

Equality Ḣ(p) = 0 holds if and only if p is a detailed-balancing equilibrium,
that is, if and only if (12) holds.
Given an initial point p(0) ∈ RG>0 in the interior, the entropy H(p(t)) increases strictly towards its maximum on M (p(0)), and p(t) converges to the
unique equilibrium p in the class M (p(0)).
Given an initial point p(0) ∈ RG≥0 on the boundary, we have p(t) ∈ RG>0
for t > 0, cf. the proof of Proposition 3. In genetic terms, recombination
immediately produces all gametes, as long as all alleles are present in the
population.
The entropy as Lyapunov function was used by Akin [1] and Lyubich [12]
(referring to a paper by Kun and Lyubich [11]) to prove global stability for
recombination. For chemical reaction networks with detailed balancing, see
Vol’pert and Hudjaev [20, 21] (who acknowledge previous use of the entropy
function by Zel’dovich [23]). For complex balancing, see [7, 8, 10, 19].
Theorem 7. A process of genetic recombination gives rise to a reversible
chemical reaction network with mass-action kinetics. In every stoichiometric compatibility class and for all reaction rate constants, the dynamics converges to a unique positive detailed-balancing equilibrium.
Proof. By [21, Theorem, pp. 642–643], the ω-limit set of every solution consists either of a unique positive detailed-balancing equilibrium or boundary
detailed-balancing equilibria. By Proposition 3, there are no boundary equilibria, and every solution converges to a unique positive detailed-balancing
equilibrium.

4

Final remarks

Note that we have not used a central concept of chemical reaction network
theory, the deficiency
δ = m − l − s,

Müller and Hofbauer, 2015

19

where m is the number of complexes, l the number of linkage classes, and s
the dimension of the stoichiometric subspace.
The deficiency zero and one theorems state that there exists a unique (asymptotically stable) positive complex-balancing equilibrium, for all reaction rate
constants and all stoichiometric compatibility classes, if the network is weakly
reversible and either (0) its deficiency is zero or (1a) the deficiencies of the
individual linkage classes are zero or one and (1b) the individual deficiencies
add up to the total deficiency, see [5].
In Example 1 (L = 2, A1 = A2 = 2), we find δ = 2 − 1 − 1 = 0. However,
already in Example 2 (L = 3, A1 = A2 = A3 = 2), the deficiencies of the
individual linkage classes are zero, but δ = 16 − 7 − 4 = 5.
In fact, the individual deficiencies are zero in the entire Scheme 3 (L ≥ 2,
Ai = 2 for i = 1, . . . , L): Every linkage class is characterized by two different
alleles at some loci K ∈ L with |K| ≥ 2 and two identical alleles at other
loci. Hence 2|K|−1 − 1 − (2|K|−1 − 1) = 0, whereas
δ =m−l−s
= 2L−1 (2L − (1 + L)) − (3L − 2L−1 (2 + L)) − (2L − (1 + L))
= 2L−1 (2L − 1) − 3L + 1 + L,
using s = dim(S) = |G|−dim(S ⊥ ) = 2L −(1+L). For L = 3, 4, 5, ... , we find
δ = 5, 44, 259, ... , and the deficiency zero and one theorems do not apply.
More importantly, there exist δ necessary and sufficient conditions on the
rate constants for the existence of complex-balancing equilibria, see Horn [9].
The conditions involve the Laplacian matrix of the weighted directed graph
of complexes and reactions, in particular, the quotients of so-called tree
constants, see [15]. For the existence of detailed-balancing equilibria, additionally the Wegscheider conditions have to be fulfilled, that is, the products
of rate constants in a cycle and its reverse must coincide, see [4, 21, 22]. In
the process of genetic recombination, the rate constants of a reaction and
its reverse coincide, and all conditions for the existence of complex- and
detailed-balancing equilibria are fulfilled.

References
[1] E. Akin, The Geometry of Population Genetics, vol. 31 of Lect. Notes
in Biomath., Springer, New York, 1979.
[2] R. Bürger, The Mathematical Theory of Selection, Recombination,
and Mutation, John Wiley & Sons, 2000.
[3] A. Dickenstein and M. Pérez Millán, How far is complex balancing from detailed balancing?, Bull. Math. Biol., 73 (2011), pp. 811–828.

Müller and Hofbauer, 2015

20

[4] M. Feinberg, Necessary and sufficient conditions for detailed balancing in mass action systems of arbitrary complexity, Chemical Engineering Science, 44 (1989), pp. 1819 – 1827.
[5] M. Feinberg, The existence and uniqueness of steady states for a class
of chemical reaction networks, Arch. Rational Mech. Anal., 132 (1995),
pp. 311–370.
[6] H. Geiringer, On the probability theory of linkage in Mendelian heredity, Annals Math. Statist., 15 (1944), pp. 25–57.
[7] A. N. Gorban, General H-theorem and entropies that violate the second law, Entropy, (2014).
[8] J. Higgins, Some remarks on Shear’s Liapunov function for systems of
chemical reactions, Journal of Theoretical Biology, 21 (1968), pp. 293–
304.
[9] F. Horn, Necessary and sufficient conditions for complex balancing in
chemical kinetics, Arch. Rational Mech. Anal., 49 (1972), pp. 172–186.
[10] F. Horn and R. Jackson, General mass action kinetics, Arch. Ration. Mech. Anal., 47 (1972), pp. 81–116.
[11] L. A. Kun and Y. I. Lyubich, The H-theorem and convergence to
equilibrium for free multi-locus populations, Kibernetika, (1980), p. 150.
[12] Y. I. Lyubich, Mathematical Structures in Population Genetics, vol. 22
of Biomathematics, Springer-Verlag, Berlin, 1992. Translated from the
1983 Russian original by D. Vulis and A. Karpov.
[13] L. Markus, Asymptotically autonomous differential systems, in Contributions to the theory of nonlinear oscillations, vol. 3, vol. 36 of Annals
of Mathematics Studies, Princeton University Press, 1956, pp. 17–29.
[14] K. Mischaikow, H. Smith, and H. R. Thieme, Asymptotically autonomous semiflows: chain recurrence and Lyapunov functions, Trans.
Amer. Math. Soc., 347 (1995), pp. 1669–1685.
[15] S. Müller and G. Regensburger, Generalized mass-action systems
and positive solutions of polynomial equations with real and symbolic
exponents (invited talk), in Computer Algebra in Scientific Computing,
V. P. Gerdt, W. Koepf, W. Seiler, and E. V. Vorozhtsov, eds., vol. 8660
of Lecture Notes in Computer Science, Springer International Publishing, 2014, pp. 302–323.
[16] T. Nagylaki, The evolution of multilocus systems under weak selection, Genetics, 134 (1993), pp. 627–47.

Müller and Hofbauer, 2015

21

[17] T. Nagylaki, J. Hofbauer, and P. Brunovský, Convergence of
multilocus systems under weak epistasis or weak selection, Journal of
Mathematical Biology, 38 (1999), pp. 103–133.
[18] S. Shahshahani, A new mathematical framework for the study of linkage and selection, vol. 211 of Memoirs of the AMS, Amer. Math. Soc.,
1979.
[19] D. Siegel and D. MacLean, Global stability of complex balanced
mechanisms, J. Math. Chemistry, 27 (2000), pp. 89–110.
[20] V. M. Vasil’ev, A. I. Vol’pert, and S. I. Hudjaev, The method of
quasi-stationary concentrations for the equations of chemical kinetics,
Comput. Math. Math. Phys., 13 (1974), pp. 187–206.
[21] A. I. Vol’pert and S. I. Hudjaev, Analysis in classes of discontinuous functions and equations of mathematical physics, vol. 8 of Mechanics: Analysis, Martinus Nijhoff Publishers, Dordrecht, 1985.
[22] R. Wegscheider, Über simultane Gleichgewichte und die Beziehungen
zwischen Thermodynamik und Reactionskinetik homogener Systeme,
Monatshefte für Chemie und verwandte Teile anderer Wissenschaften,
22 (1901), pp. 849–906.
[23] Y. B. Zel’dovich, The proof of singularity of the solution of mass law
equations, Zh. Fiz. Khim., 11 (1938), pp. 685–687.

