A robust approach to estimating rates from time-correlation functions

1

John D. Chodera,1, ∗ Phillip J. Elms,2, 3, † William C. Swope,4, ‡ Jan-Hendrik Prinz,5, § Susan
Marqusee,6, 1, 3, ¶ Carlos Bustamante,6, 1, 7, 8, 9, ∗∗ Frank Noé,5, †† and Vijay S. Pande10, ‡‡

2
3

1

California Institute of Quantitative Biosciences (QB3),
University of California, Berkeley, California 94720, USA
2
Biophysics Graduate Group, University of California, Berkeley, California 94720, USA
3
Jason L. Choy Laboratory of Single Molecule Biophysics,
University of California, Berkeley, CA 94720, USA
4
IBM Almaden Research Center, San Jose, CA 95120
5
DFG Research Center Matheon, Freie Universität Berlin, Arnimallee 6, 14195 Berlin, Germany
6
Department of Molecular & Cell Biology, University of California, Berkeley, CA 94720, USA
7
Department of Physics, University of California, Berkeley, CA 94720, USA
8
Department of Chemistry, University of California, Berkeley, CA 94720, USA
9
Howard Hughes Medical Institute, University of California, Berkeley, CA 94720, USA
10
Department of Chemistry, Stanford University, Stanford, CA 94305
(Dated: March 11, 2015)

4
5
6
7
8

arXiv:1108.2304v1 [cond-mat.stat-mech] 10 Aug 2011

9
10
11
12
13
14
15
16

While seemingly straightforward in principle, the reliable estimation of rate constants is seldom
easy in practice. Numerous issues, such as the complication of poor reaction coordinates, cause
obvious approaches to yield unreliable estimates. When a reliable order parameter is available, the
reactive flux theory of Chandler allows the rate constant to be extracted from the plateau region of
an appropriate reactive flux function. However, when applied to real data from single-molecule experiments or molecular dynamics simulations, the rate can sometimes be difficult to extract due to
the numerical differentiation of a noisy empirical correlation function or difficulty in locating the
plateau region at low sampling frequencies. We present a modified version of this theory which
does not require numerical derivatives, allowing rate constants to be robustly estimated from the
time-correlation function directly. We compare these approaches using single-molecule force spectroscopy measurements of an RNA hairpin.
Section: Kinetics, Spectroscopy or Statistical Mechanics, Thermodynamics, Medium Effects

17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37

The observed dynamics of complex molecular systems
such as biomolecules often suggest a simple underlying behavior. Much of chemistry and biophysics revolves around
attempting to identify simple models that adequately describe the observed complex dynamics of these systems.
In many cases, stochastic conformational dynamics can be
modeled to good accuracy using simple first-order phenomenological rate theory, a topic that has been extensively
studied theoretically [1, 2]. However, when it is necessary to
estimate rates from trajectories generated by computer simulation or observed in single-molecule experiments, numerous pitfalls can frustrate the ability to extract robust, reliable,
and accurate estimates of rate constants using seemingly obvious approaches. Here, we demonstrate these pitfalls for
naı̈ve approaches to rate estimation in single-molecule force
spectroscopy for an RNA hairpin, and show how reactive flux
theory [3–7] and a novel but related variation can provide
robustness to sampling frequency, finite statistics, and measurement noise.
Rate theory. Suppose we have a population of N noninteracting molecules in solution that can occupy one of two con-

38
39
40
41

42
43
44
45
46
47
48

If there is a separation of timescales between the short relaxation time within the conformational states and the long
time the system must wait, on average, in one conformational state before undergoing a transition to another state,
the asymptotic relaxation behavior of an initial population of
NA (0) molecules in conformation A and NB (0) molecules in
conformation B can be described by a simple linear rate law:
d
NA (t) = −kA→B NA (t) + kB→A NB (t)
dt

49
50
51
52

(1)

where kA→B and kB→A are microscopic rate constants. In
terms of time-dependent expectations over trajectories initiated from some initial nonequilibrium state, Eq. 1 is equivalent to
d
hhA (t)ine = −kA→B hhA (t)ine + kB→A hhB (t)ine (2)
dt

∗

jchodera@berkeley.edu
† elms@berkeley.edu
‡ swope@us.ibm.com
§ jan.prinz@fu-berlin.de
¶ marqusee@berkeley.edu
∗∗ carlos@alice.berkeley.edu
†† frank.noe@fu-berlin.de
‡‡ Corresponding author; pande@stanford.edu

formational states, denoted A and B. Without loss of generality, we assume we are given a trajectory of some order parameter x(t) that allows us to define associated occupation
functions hA (t) and hB (t) for states A and B, such that
(
(
1 if x(t) ≤ x‡
0 if x(t) ≤ x‡
hA (t) =
‡ ; hB (t) =
0 if x(t) > x
1 if x(t) > x‡

53
54
55
56
57
58

where hhA (t)ine denotes the nonequilibrium probability of
finding a given molecule in conformation A at time t given
that the fraction of molecules that were initially in conformation A was hhA (0)ine = NA (0)/N .
Were Eq. 2 to govern dynamics at all times, the expected
fraction of molecules in conformation A as a function of time

2
would be given by an exponential decay function,
hhA (t)ine = hhA i + [hhA (0)ine − hhA i] e−kt ,
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74

14

(3)

13
x / pN

59

where hhA i denotes the standard equilibrium expectation of
hA , giving the equilibrium fraction of molecules in conformation A. The quantity k ≡ kA→B + kB→A denotes the phenomenological rate constant because it is the effective rate
that dominates the observed exponential asymptotic relaxation decay behavior. It is the estimation of this quantity, k,
that will be our primary concern.
If the system were purely two-state, such that Eq. 3 held for
all time t > 0, a number of naı̈ve approaches to estimation
of the phenomenological rate constant k from observed trajectory data would yield useful rate estimates. For example,
given an observed trajectory x(t), we could simply compute
the number of times nc the dividing surface x‡ was crossed in
either direction in total trajectory time tobs , estimating the k
rate by,
kcrossings ≈

nc
.
tobs

(4)

12

11
0

76
77
78

Alternatively, we could partition the trajectory into segments
where the system remains on one side of x‡ in each segment,
and estimate the mean lifetime τ of these segments, from
which the rate k is estimated by,
klifetime ≈ τ −1 .

79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102

(5)

Both approaches will yield rate estimates that converge to the
true rate k as tobs → ∞ when x provides a perfect reaction coordinate for a perfectly two-state system, in that x‡ correctly
divides the two conformations states that interconvert with
first-order kinetics.
However, when considering trajectories obtained from
computer simulations or single-molecule experiments with
imperfect dividing surfaces, these naı̈ve approaches can lead
to substantially erroneous estimates. First, we do not expect Eq. 3 to hold for short times t < τmol , where τmol is the
timescale associated with relaxation processes that damp out
recrossings that occur due to imperfect definition of the separatrix between the reactant and product states [3, 4, 7]. An alternative view of this is that the observed coordinate x might
function as a good order parameter, in that it allows the conformational states to be well-resolved at extreme values of x,
but a poor reaction coordinate, in that both conformational
states are populated in some region near the optimal dividing
surface x‡ [8–10] (which is optimal in that it minimizes the
rate estimate in a variational sense [11]). The rate estimates
from Eqs. 4 and 5 will therefore overestimate the number of
crossings or underestimate the state lifetimes, instead converging to the transition state theory rate estimate kTST that
gives the instantaneous flux across the dividing surface,

d hhA (0)hB (t)i 
,
(6)
kTST ≡

dt
hhA i
t=0

111

113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146

103
104
105
106
107
108
109
110

and hence overestimating the true rate k. Additionally, if the
observed trajectories are not continuous, but instead consist of discrete observations made with a sampling resolution ∆t, additional issues develop. As the sampling interval
∆t increases, some crossing of the dividing surface x‡ will
be missed, and the perceived lifetimes of states will be increased, having the opposite effect of a poor reaction coordinate in diminishing the rate estimates of Eqs. 4 and 5. As a

20

30
t/s

40

50

60

P(x)

FIG. 1. Force trace of p5ab RNA hairpin in a stationary optical trap. A 60-second observation is shown, where the force
history x(t) recorded at 50 kHz and subsampled to 1 kHz is
plotted. A histogram of the observed force values is shown as
P (x) to the right. The red line indicates the optimal dividing
surface for rate calculations, x‡ ≈ 12.57 pN.

112
75

10

147
148
149
150
151
152
153
154

result, it can be difficult to predict whether the overall result
is an underestimate or overestimate of the true rate k. An example illustrating these effects for a model system where the
true rate is known is given in the Supplementary Material.
Application of naı̈ve rate estimators to single-molecule
data. To understand how these pathologies can affect real
measurements, we examined the behavior of the p5ab RNA
hairpin in an optical trap under passive conditions. This hairpin has been the subject of previous single-molecule force
spectroscopy studies [12–14], and exhibits apparent twostate kinetics as the hairpin folds and unfolds under an external biasing force. The force trace x(t) is shown in Fig. 1,
and reports the instantaneous force on the optically trapped
bead along the bead-bead axis; for a harmonic trap, this force
is linearly proportional to the displacement of the bead from
the center of the trap, and hence the bead-to-bead extension. As the hairpin folds, the bead-to-bead distance contracts, increasing the applied force as the polystyrene bead
conjugated to the end of the polymer moves away from the
center of the optical trap. At the stationary trap position used
for data collection, the hairpin makes many transitions between the two states resolvable from the measured force in
the 60-second trajectory, populating each state nearly equally
(Fig. 1). Data was collected at 50 kHz using a dual-beam
counter-propagating optical trap [15, 16], a high sampling
rate far above the corner frequency for bead response under
these conditions, as previously published [14]. To examine
the dependence on sampling interval ∆t, the data was also
subsampled to 1 kHz, a frequency found to be below the corner frequency of the bead, such that the bead velocity has
decorrelated between sequential observations due to hydrodynamic interactions [14].
The rate constant was estimated using the naı̈ve crossing rate kcrossings (Eq. 4) as a function of the dividing surface
choice x‡ , and plotted in Fig. 2 (middle upper and lower panels, red lines). Two issues are quickly discerned: First, near
the optimal choice of dividing surface (x‡ ∼ 12.57 pN), the
estimated rate kcrossing differs greatly depending on whether
the 1 kHz data (red dashed line) or 50 kHz data (red solid line)
were used to compute the rate estimate, yielding disparate
estimates of 45.4 s−1 and 552 s−1 , respectively. Second, as
the dividing surface is perturbed slightly, the rate estimate
for either sampling rate changes rapidly. Both properties are
highly undesirable, as practical estimators of the rate should

3
1 kHz

50 kHz

P(x)

1500

12.3

12.4

12.5 12.6
x / pN

12.7

12.8

12.9

13

1 kHz
50 kHz

k / s−1

3000

0
200

100
50
0
1
πA

0.6

πB

35

−1

30
3

3.5

1

2

4

30
59 59.5 60

10

20

30 40
t / ms

50

60

0

3
4
t / ms

5

6

FIG. 3. Reactive flux and implied rates from p5ab hairpin single-molecule force trajectory. The implied rate kim (t)
(red) and reactive flux rate correlation function kRF (t) (black)
are computed for the optimal dividing surface x‡ ≈ 12.57 pN
for 1 kHz (left) and 50 kHz (right). Close-up views compare
the scatter in the rate estimates in the plateau region (3–4 ms)
and long correlation times (59–60 ms) for 50 kHz data (right
insets).

150

0.8

1000 35

0
0

1000

40

500

0

2000

k / s−1

50

25

4000

40

kim(t)
k/s

12.2

k / s−1

12.1

π

k (t)
RF

75

0.4
0.2
0
12.1

12.2

12.3

12.4

12.5

12.6

12.7

12.8

12.9

13

172

x+ / pN

173
174

FIG. 2. Dependence of rate estimates on dividing surface.
Top: Histogram of observed forces near transition region between conformational states. Upper middle: Rate estimate
from crossing rate kcrossing (red lines), reactive flux rate estimated kRF (τ ) near plateau time of τ = 3 ms (green lines), and
implied rate kim (τ ) evaluated at τ = 60 ms (black lines), estimated from 1 kHz data (dashed lines) or 50 kHz data (solid
lines) as a function of dividing surface x‡ choice. Lower middle: Same as upper middle, but close-up view of rate estimates below 200 s−1 . Bottom: Estimates of equilibrium probabilities πA and πB estimated from 1 kHz data as a function
of dividing surface placement x‡ . (Estimates of πA and πB
from 50 kHz data are visually indistinguishable from 1 kHz
estimates.)

175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190

155
156
157
158
159
160
161
162

yield results insensitive to the sampling rate and exact placement of dividing surface.
Reactive flux theory. To deal with the problems inherent in
using an imperfect reaction coordinate or dividing surface,
Chandler (and subsequent workers) demonstrated how the
phenomenological rate could be recovered through the use of
time-correlation functions, proposing the reactive flux kRF (t)
be computed [3–6] to estimate k,

191
192
193
194
195
196
197
198
199

d hδhA (0) δhA (t)i
kRF (t) = −
,
dt
hδh2A i

(7)

200
201
202

163
164
165
166
167
168
169
170
171

where δhA (t) ≡ hA (t) − hhA i is the instantaneous deviation
from the equilibrium population for some trajectory x(t).
The reactive flux function kRF (t) measures the flux across the
boundary between A and B that is reactive, in the sense that
the system has crossed a dividing surface placed between A
and B at time zero and is located on the product side of the
boundary at time t. The reactive flux is bounded from above
by the transition state theory rate estimate kTST , the instantaneous flux across the boundary, because recrossings back

203
204
205
206
207
208
209
210
211

to the reactant state will diminish the reactive flux; kRF (t) becomes identical to kTST as t → 0+ [3]. At t larger than some
τmol , thermalization processes will cause recrossings to die
out, and the molecule will be captured either in its reactant
or product states and remain there for a long time. As a result, the asymptotic rate constant (whose existence requires
the presupposed separation of timescales) is only obtained at
τmol < t  τrxn , where kRF (t) reaches a plateau value. kRF (t)
subsequently decays to zero at t  τrxn with a time constant
of τrxn = 1/k [3, 4]. Subsequent work extends these concepts
to the case of multiple conformational states [5, 6].
Application of reactive flux theory to single-molecule data.
We computed the reactive flux kRF (t) from this force trajectory for both 1 kHz and 50 kHz sampling frequencies, using one-sided finite-differences to estimate the derivative in
Eq. 7. When estimated from 50 kHz data (Fig. 3, right), the reactive flux kRF (t) smoothly stabilizes to ∼ 36 s−1 after a transient time of τmol ≈ 3 ms. This is the plateau time t = 3 ms
for which kRF (t) ≈ k, with tmol < t  τrxn , where τrxn ≈ 28
ms. When the reactive flux kRF (t) is evaluated at t = 3 ms
for various choices of dividing surface x‡ in this transition region (Fig. 2, middle panels), the reactive flux rate is indeed
insensitive to the choice of x‡ at both 50 kHz (solid green
line) and 1 kHz (dashed green line) sampling frequencies. In
this respect, the reactive flux approach provides a much more
robust way to estimating rates than the naı̈ve estimators of
Eqs. 4 and 5. To our knowledge, this represents the first time
this theory has been applied to single-molecule experiments.
Implied rate theory. The universal application of the reactive flux approach to rate estimation from single-molecule
and computer experiments still presents a number of practical difficulties. Because the correlation function is estimated
from a trajectory x(t) sampled with discrete time resolution
∆t, computation of the time derivative in Eq. 7 by finitedifference methods can often introduce unacceptably large
amount of noise in the resulting estimate of kRF (t) (Fig. 3,
right inset, black dots). Alternatively, the correlation function
hδhA (0)δhA (t)i could be smoothed by fitting a polynomial to
produce a continuous estimate of the derivative, but this introduces a bias that is difficult to quantify. Additionally, if the

4
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241

reaction timescale τrxn is not very long compared to the observation interval ∆t, then the plateau region where kRF (t) is
identical to the rate may be small and difficult to detect before kRF (t) decays to zero. This can be seen in the reactive
flux kRF (t) estimated from the 1 kHz data (Fig. 3, left, black
dots), where the plateau region near 3–4 ms is relatively narrow and difficult to detect, and the kRF (t) falls (decaying as
ke−kt ) as t reaches times comparable to τrxn . Lastly, while
alternative expressions to Eq. 7 exist where the velocity normal to the separatrix at the time of barrier crossing is utilized
instead of a time derivative of the empirical correlation function [3, 4], it is difficult to compute this velocity for complex
dividing surfaces in computer simulations, and difficult to
measure experimentally in single-molecule experiments.
We propose an alternative approach, similar in spirit to reactive flux but more closely related to the rate theories used
in constructing Markov state models from molecular simulations [17–20], that avoids the need to compute the time
derivative of the correlation function in Eq. 7. Instead, we
estimate the rate kim (t) implied by the state-to-state transition probabilities observed for a given observation interval
t—referring to this quantity as the implied rate constant. As
with the reactive flux, for times t where τmol < t  τrxn , the
phenomenolgical rate constant (if it exists, by virtue of a separation of timescales) is recovered by kim (t), but our modified
estimator provides a much larger plateau for times t > τmol
where a usable rate estimate can be extracted.
As before, if a separation of timescales exists, relaxation behavior for times t > τmol is defined in terms of first order rate
equations (Eq. 2), here recast in matrix form,
d
p(t) = K p(t)
dt

242
243
244
245

246
247
248
249
250

263
264

T(t) = eKim (t) t ⇔ Kim (t) = t−1 log T(t),
265
266
267
268
269
270
271

µk (t) = eλk (t) t .
272
273

274

277
278
279
280
281

The eigenvalues of K are λ1 = 0, reflecting conservation of
probability mass, and λ2 = −(kA→B + kB→A ) = −k, which
governs the recovery toward equilibrium populations πA and
πB at the phenomenological relaxation rate k.
The solution to Eq. 8 (corresponding to Eq. 3) is given by

283
284

285
286
287

252
253
254
255
256
257

(10)

P∞

n
where eA ≡
n=0 A /n! is the formal matrix exponential
and T(t) can be identified as the column-stochastic transition probability matrix whose elements Tji (t) give the conditional probability of observing the system in conformation j
at time t given that it was initially in conformation i at time 0.
The elements of T(t) for a given observation interval t are
conveniently given in terms of the time-correlation function,

hhi (0) hj (t)i
Tji (t) ≡
πi

(11)

290
291
292
293
294
295
296

297

259
260
261
262

where the stationarity and time-reversal symmetry of physical systems at equilibrium ensures that hhi (0) hj (t)i =
hhj (0) hi (t)i, and πi is the equilibrium probability of state i.
For t > τmol , we have T(t) ≈ eKt for a constant matrix K,
but this will not hold for t < τmol . Instead, we can establish

(16)

just as for the reactive flux rate (Eq. 7) [3, 4]. Similarly, the
true phenomenological rate k is given by the long-time limit
of kim (t):
t→∞

hδhA (0)δhA (t)i
hδh2A i

(18)

However, when estimating the phenomenological rate
through this expression, evaluation of the correlation function should be for some t  τrxn = k−1 , as the statistical
error in the estimate of kim (t) grows with t (see Appendix).
When there is a separation of timescales such that τmol 
τrxn , such that a phenomenological rate exists, we can see
that kim (t) and kRF (t) are expected to provide similar estimates in the regime τmol < t  τrxn . We note Eq. 16 can
be rearranged to yield a correlation function
hδhA (0)δhA (t)i
= e−kim (t) t
hδh2A i

298
258

hδhA (0)δhA (t)i
,
hδh2A i

which is the main result of this paper.
In the limit t → 0+ , kim (t) reduces to the transition state
theory estimate kTST ,

d hδhA (0)δhA (t)i 
lim kim (t) = −
= kTST , (17)

dt
hδh2A i
t→0+
t=0

t→∞

288

(15)

which is simply the normalized fluctuation autocorrelation
function for the indicator function hA for state A (or, equivalently, for state B). µ2 (t) therefore takes the value of unity at
t = 0 and decays to zero at large t.
Combining Eqs. 14 and 15 gives the expression for the implied rate estimate kim (t) of the phenomenological rate k,

k = lim kim (t) = lim −t−1 ln

289

251

hδhA (0)δhA (t)i
,
hδh2A i

(8)
282

(14)

where µ2 (t) = 1 − (TAB (t) + TBA (t)). Using Eq. 11 and some
algebra, we find µ2 (t) can be written,
µ2 (t) =

276

(13)

The implied rate constant kim (t) for observation time t can be
obtained from the nonzero eigenvalue of Kim (t),
kim (t) = −λ2 (t) = −t−1 ln µ2 (t)

275

(12)

where the logarithm denotes the matrix logarithm. Assuming
a phenomenological rate constant k exists, all Kim (t) ≈ K for
t > τmol .
Because of their relationship through the exponential
(Eq. 12), T(t) and Kim (t) share the same eigenvectors uk ,
and their respective eigenvalues µk (t) and λk (t) are simply
related [21],

kim (t) = −t−1 ln

where p = [pA (t) pB (t)]T , pA (t) = hhA (t)ine and pB (t) =
hhB (t)ine denote the nonequilibrium occupation probabilities of states A and B at time t, and K is the matrix of rate
constants


−kA→B
kB→A
K=
.
(9)
kA→B −kB→A

p(t) = eKt p(0) = T(t) p(0)

a one-to-one correspondence between T(t) and the rate matrix Kim (t) it implies for any t,

(19)

By the definition of reactive flux (Eq. 7), we can write kRF (t)
in terms of kim (t) as,
d hδhA (0)δhA (t)i
d
= − e−kim (t) t
dt
hδh2A i
dt


d
= e−kim (t) t kim (t) + t kim (t)
dt

kRF (t) = −

(20)

5
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324

When t  τmol , then kim (t) ≈ k, and we have kRF (t) ≈ ke−k t .
Application of implied rate theory to single-molecule data.
To illustrate the estimation of the phenomenological rate k
using the implied timescale kim (t), we computed it for the
p5ab hairpin force trajectory described above. At the 50 kHz
sampling rate (Fig. 3, right), the rate estimates are almost
identical to those from kRF (t) for a broad range of times
where t > τmol , though there is much less noise in the kim (t)
rate estimate than in kRF (t) (Fig. 3, right inset). At the 1 kHz
sampling rate (Fig. 3, left), however, the rate estimate from
kim (t) remains stable over several times τrxn , even though
the kRF (t) has already decayed from the plateau region. The
implied rate estimate, kim (t), therefore appears to provide a
more robust estimate of the phenomenological rate under a
variety of conditions.
This robustness also carries over to an insensitivity to the
placement of dividing surface x‡ , the problem reactive flux
theory was originally envisioned to solve. Using an observation time of τ = 60 ms, the implied rate estimate kim (τ ) varies
much less than the naı̈ve rate estimates over a large range of
dividing surface choices (Fig. 2, middle panels, black dashed
and solid lines).
Microscopic rate constants. To obtain individual microscopic rates kA→B and kB→A , we recall that the phenomenological rate k represents the sum of the forward and backward
rates,

334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354

355
356
357

k = kA→B + kB→A

(21)

358
359

325
326

as well as the fact that the flux across the dividing surface
must be balanced at equilibrium,
πA kA→B = πB kB→A

327

(22)

360
361
362
363

which allows us to deduce that the individual rates are simply

364

(23)

366

kA→B = πB k ; kB→A = πA k

365

367
328
329
330
331
332
333

374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390

The equilibrium probabilities πA and πB can be simply estimated by the fraction of samples observed on each side of the
dividing surface x‡ , such that πA ≈ hhA i and πB ≈ hhB i. For
the RNA hairpin, estimates of πA and πB are shown as a function of dividing surface placement in Fig. 2 (bottom panel).
As both the equilibrium probability and phenomenological

[1] P. Hänggi, P. Talkner, and M. Borkovec, Rev. Mod. Phys.,
62, 251 (1990).
[2] H.-X. Zhou, Quarterly Rev. Biophys., 43, 219 (2010).
[3] D. Chandler, J. Chem. Phys., 68, 2959 (1978).
[4] J. A. M. Jr., D. Chandler, and B. J. Berne, J. Chem. Phys.,
70, 4056 (1979).
[5] J. E. Adams and J. D. Doll, Surface Science, 111, 492
(1981).
[6] A. F. Voter and J. D. Doll, J. Chem. Phys., 82, 80 (1985).
[7] B. J. Berne, Theor. Chem. Acc., 103, 335 (2000).
[8] J. D. Chodera and V. S. Pande, Phys. Rev. Lett., in press
(2011).
[9] G. Hummer, J. Chem. Phys., 120, 516 (2004).
[10] R. B. Best and G. Hummer, Proc. Natl. Acad. Sci. USA,
102, 6732 (2005).
[11] D. G. Truhlar and B. C. Garrett, Ann. Rev. Phys. Chem.,
35, 159 (1984).

368
369
370
371
372
373

391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406

rate estimates are sensitive to the choice of dividing surface,
the microscopic rates kA→B and kB→A will be more sensitive
to the dividing surface placement than either property alone.
The sensitivity of rates to the choice of dividing surface has
some important implications. While thermodynamic quantities (e.g. the free energy difference between two macrostates)
are rather insensitive to the choice of dividing surface (as
slight variation in πA and πB is suppressed by the logarithm
in ∆G = −kB T ln(πA /πB )), rates (and other kinetic properties such as commitment probabilities [8]) typically have exponential weighting working in the opposite direction, making the definition of the surface particularly important. A key
implication of this sensitivity is the challenge of comparing
theory and experiment in kinetics—both must agree on the
definition of the dividing surface in order to avoid confounding the comparison. This is also of course an issue with even
comparing different experiments. While this problem is unavoidable, our hope is that an approach which directly considers a detailed state decomposition [20, 22] will help further
aid in the connection between theory and experiment.
ACKNOWLEDGMENTS
The authors would like to thank Ken Dill (University of California, San Francisco), Phillip L. Geissler (University of California, Berkeley), and Jed W. Pitera (IBM Almaden Research
Center) for stimulating discussions on this topic, and Gregory R. Bowman (University of California, Berkeley) for helpful feedback on the manuscript. PJE would like to thank Steve
Smith (University of California, Berkeley) for help with the
instrumentation and Jin Der Wen (National Taiwan University) and Ignacio Tinoco (University of California, Berkeley)
for providing the p5ab RNA hairpin. This work was supported
in part by NIH grants GM 32543 (C.B.), GM 50945 (S.M.) and
a grant from the NSF (S.M.). JDC gratefully acknowledges
support from the HHMI and IBM predoctoral fellowship programs, NIH grant GM34993 through Ken A. Dill (UCSF),
and NSF grant for Cyberinfrastructure (NSF CHE-0535616)
through Vijay S. Pande (Stanford), and a QB3-Berkeley Distinguished Postdoctoral Fellowship at various points throughout this work. FN acknowledges support from DFG Research
Center Matheon.

[12] J. Liphardt, B. Onoa, S. B. Smith, I. Tinoco Jr., and C. Bustamante, Science, 292, 733 (2001).
[13] J.-D. Wen, M. Manosas, P. T. X. Li, S. B. Smith, C. Bustamante, F. Ritort, and I. Tinoco, Jr., Biophys. J., 92, 2996
(2007).
[14] P. J. Elms, J. D. Chodera, C. J. Bustamante, and S. Marqusee, In preparation (2010).
[15] S. B. Smith, Y. Cui, and C. Bustamante, Meth. Enzym.,
361, 134 (2003).
[16] C. Bustamante and S. B. Smith, “Light-force sensor and
method for measuring axial optical-trap forces from
changes in light momentum along an optical axis,”
(2006), united States Patent 7133132.
[17] W. C. Swope, J. W. Pitera, and F. Suits, J. Phys. Chem. B,
108, 6571 (2004).
[18] G. Hummer, New Journal of Physics, 7, 34 (2005).

6
407
408
409
410

[19] J. D. Chodera, W. C. Swope, J. W. Pitera, and K. A. Dill,
Multiscale Modeling and Simulation, 5, 1214 (2006).
[20] J.-H. Prinz, H. Wu, M. Sarich, B. Keller, M. Fischbach,
M. Held, J. D. Chodera, C. Schütte, and F. Noé, J. Chem.

411
412
413
414
415

Phys., 134, 174105 (2011).
[21] N.-V. Buchete and G. Hummer, J. Phys. Chem. B, 112,
6057 (2008).
[22] V. S. Pande, K. A. Beauchamp, and G. R. Bowman, Methods, 52, 99 (2010).

