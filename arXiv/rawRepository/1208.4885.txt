Implicit Ligand Theory: Rigorous Binding Free Energies and Thermodynamic
Expectations from Molecular Docking
David D. L. Minh∗

arXiv:1208.4885v1 [cond-mat.stat-mech] 24 Aug 2012

Department of Chemistry, Duke University, Durham NC 27708 USA
(Dated: August 27, 2012)
A rigorous formalism for estimating noncovalent binding free energies and thermodynamic expectations from calculations in which receptor configurations are sampled independently from the
ligand is derived. Due to this separation, receptor configurations only need to be sampled once,
facilitating the use of binding free energy calculations in virtual screening. Demonstrative calculations on a host-guest system yield good agreement with previous free energy calculations and
isothermal titration calorimetry measurements. Implicit ligand theory provides guidance on how
to improve existing molecular docking algorithms and insight into the concepts of induced fit and
conformational selection in noncovalent macromolecular recognition.

INTRODUCTION

The goal of molecular docking is to predict the most
stable configuration of a noncovalent complex between
a ligand and receptor. Based on this configuration, the
complex is assigned a score which may be used to approximately rank the binding affinity of one ligand to the
receptor versus another. Molecular docking has many potential applications, and has been most prominently applied to the virtual screening [1, 2] of chemical libraries
to aid the development of pharmaceuticals.
Given the three-dimensional structure of a protein receptor, docking algorithms have proven reasonably adept
at sampling stable conformations of small organic ligands
in the complex. Unfortunately, current scoring functions
perform poorly at predicting binding free energies [3–5].
Hence, docking is typically used to filter a large library
of potential ligands to a smaller binder-enriched library
that may be pursued experimentally or by more accurate and expensive computational methods [6–10]. Even
in this capacity, however, scoring functions are inconsistent, frequently presenting false positives (ligands predicted to bind but actually have weak or no affinity) and
false negatives (ligands predicted not to bind but actually
have significant affinity). For example, docking programs
often have difficulty distinguishing binding compounds
from decoys in which the chemical connectivity has been
randomized [3, 11]. Improved scoring functions would increase the capability to discern binders from non-binders.
The improvement of scoring functions, however, has
been hindered by the lack of a rigorous formalism for
obtaining binding free energies from molecular docking.
While molecular docking calculations are usually performed with a rigid receptor, existing formalisms for
binding free energies require a flexible receptor. Here, I
derive a formalism, implicit ligand theory, for estimating
binding free energies and thermodynamic expectations
based on docking ligands to rigid receptor structures. I
also describe practical aspects of statistical estimation,
present example calculations, and discuss how physics-

based (opposed to empirical or knowledge-based) docking
algorithms (see [12]) may be modified to exploit it. Beyond molecular docking, implicit ligand theory provides
insight into the concepts of induced fit and conformational selection in noncovalent macromolecular recognition.
THEORY

The standard binding free energy, the free energy of a
noncovalent association between a receptor R and ligand
L to form a complex RL, R + L ⇋ RL, is,

 ◦
C CRL
,
(1)
∆G◦ = −β −1 ln
CR CL
where β = (kB T )−1 is the inverse of Boltzmann’s constant, kB , times the temperature in Kelvin, T , C ◦ is
the standard concentration (typically 1 M), and CX is
the equilibrium concentration of species X ∈ {R, L, RL}
[13].
Statistical thermodynamics relates the standard binding free energy to a ratio of configurational partition functions [14],


ZRL,N ZN C ◦
∆G◦ = −β −1 ln
(2)
ZR,N ZL,N 8π 2
Z
ZRL,N = Iξ e−βU(rRL ,rS ) drRL drS
(3)
Z
ZY,N = e−βU(rY ,rS ) drY drS
(4)
Z
ZN = e−βU(rS ) drS ,
(5)
in which symmetry numbers and a small pressure-volume
term have been omitted from Eq. (2). ZRL,N and ZY,N
are configurational partition functions of the complex and
of the species Y ∈ {R, L}, respectively, in N molecules of
solvent. The potential energy U (rX , rS ) depends on rX ,
the internal coordinates of the receptor, ligand, or both
in complex (the external degrees of freedom have been

2
analytically integrated), and rS , the coordinates of N
molecules of solvent. The complex coordinates rRL may
be decomposed into the internal coordinates of the receptor, rR , and of the ligand, rL , and six degrees of freedom
describing their relative translation and rotation, ξL . For
simplicity, Jacobians for the transformation from Cartesian coordinates to a system with separated internal and
external degrees of freedom are not shown in Eqs. (3)
and (4). In ZRL,N , the indicator function Iξ ≡ I(ξL )
takes values between 0 and 1 and determines whether
the receptor and ligand are complexed or not. For tightbinding complexes, the binding free energy is insensitive
to the precise definition of Iξ [14].
Implicit Solvent Theory

The configurational integrals in Eq. (2) may be expressed in a formally equivalent but simpler form using implicit solvent theory [14]. In implicit solvent theory, the interaction energy is defined as ψ(rX , rS ) =
U (rX , rS ) − U (rX ) − U (rS ), where U (rX ) is the potential energy of species X by itself and U (rS ) the potential
energy of the solvent by itself. By integrating the configurational partition functions over rS , we may define the
ratios,
Z
ZRL,N
= Iξ e−β[U(rRL)+W (rRL )] drRL (6)
ZRL ≡
ZN
Z
ZY,N
ZY ≡
= e−β[U(rY )+W (rY )] drY ,
(7)
ZN
where,
!
R −βψ(r ,r ) −βU(r )
X S
S
e
e
drS
−1
R
, (8)
W (rX ) = −β ln
e−βU(rS ) drS

is a potential of mean force that can be interpreted
as the constant-pressure reversible work of transferring
the species X from the gas phase into the solvent. In
biomolecular modeling, W (rX ) is frequently estimated
as the sum of an electrostatic term from the PoissonBoltzmann equation [15] (or the Generalized Born approximation [16]), and a non-electrostatic term, which
to a first approximation is proportional to the molecular
surface area.
In terms of implicit solvent configurational integrals,
the standard binding free energy is,


ZRL C ◦
◦
−1
.
(9)
∆G = −β ln
ZR ZL 8π 2
As most implicit solvent models fail to account for specific interactions, such as hydrogen bonding, that can
have important structural and energetic consequences,
binding free energy calculations in implicit solvent are
generally expected to be less accurate than those in explicit solvent [17]. Nevertheless, binding free energy
calculations in implicit solvent have yielded promising
agreement with experimental results (e.g. [18–21]).

Implicit Ligand Theory

The development of implicit ligand theory is very similar to that of implicit solvent theory. It involves defining
the effective potential as U(rX ) = U (rX )+W (rX ), the effective interaction energy as Ψ(rRL ) = U(rRL ) − U(rR ) −
U(rL ), and,
!
R
Iξ e−βΨ(rRL ) e−βU (rL) drL dξL
−1
R
B(rR ) = −β ln
Iξ e−βU (rL) drL dξL


rL ,ξL
(10)
≡ −β −1 ln e−βΨ L,I ,

which is a potential of mean force that will subsequently
be referred to as the binding PMF. Throughout this par
per, angled brackets h...iX,... will be used to denote an
ensemble average over the coordinates r listed in the
superscript with respect to the density proportional to
qX,... , where X describes the coordinates in the effective
potential U(rX ), and ... are labels. Here, qL,I (rL , ξL ) =
Iξ e−βU (rL) . Within angled brackets, I will use a shorthand notation in which functions implicitly depend on
coordinates, e.g. Ψ ≡ Ψ(rRL ).
In terms of the binding PMF, Eq. (9) may be written
as,
!
R
−βU (rRL )
◦
I
e
dr
C
ξ
RL
R
∆G◦ = −β −1 ln R −βU (r )
R dr
e−βU (rL) drL 8π 2
e
R
!
R
Iξ e−β[U (rR)+Ψ(rRL )+U (rL )] drRL C ◦
−1
R
R
= −β ln
e−βU (rR) drR e−βU (rL ) drL 8π 2
!
R −β[B(r )+U (r )]
◦
R
R
e
dr
ΩC
R
R
= −β −1 ln
8π 2
e−βU (rR) drR



rR
(11)
≡ −β −1 ln e−βB R + ∆Gξ ,
R
where Ω = Iξ dξL (which may be analytically

 tractable)
◦
−1
is the
is the binding site volume, ∆Gξ = −β ln ΩC
8π 2
free energy of confining the ligand external degrees of
freedom to the binding site, and qR (rR ) = e−βU (rR) . Eqs.
(10) and (11) are the central theoretical results of this
paper.
Implicit ligand theory provides a rigorous framework
for binding free energies that separates the sampling of
receptor and ligand configurations. In Eq. (11), the receptor probability density is independent of any ligand
configuration. Likewise, the probability density of ligand
internal coordinates in Eq. (10) is independent from the
receptor configuration. In practice, however, sampling
from this ligand distribution may lead to slow convergence (this point will later be discussed in greater detail). The primary benefit of implicit ligand theory is
that the computationally expensive step of sampling receptor configurations only needs to be performed once.
Predicting binding free energies for a chemical library is
then limited by the much faster process of sampling ligand conformations.

3
Receptor Configurations

Thermodynamic Expectations

In addition to estimating the binding free energy, implicit ligand theory may also be used to estimate expected
values of observables in the bound ensemble. Observables
may include, for example, the mean potential energy, interaction energy, or distance between a ligand and receptor atom. Towards this end, it is useful to define a rigidreceptor expectation of an observable O(rRL ), weighted
by the interaction energy,
R
Iξ O(rRL )e−βΨ(rRL ) e−βU (rL ) drL dξL
R
Θ(rR ) =
Iξ e−βU (rL) drL dξL
rL ,ξL


(12)
≡ Oe−βΨ L,I .
If the observable is solely a function of the receptor configuration, then Θ(rR ) reduces to O(rR )e−βB(rR ) .
In terms of Eqs. (10) and (12), the expectation
of O(rRL ) with respect to the density proportional to
qRL,I (rRL ) = Iξ e−βU (rRL) is,
R
Iξ O(rRL )e−βU (rRL ) drRL
rRL
R
hOiRL,I ≡
Iξ e−βU (rRL) drRL
R
Iξ O(rRL )e−β[U (rR )+Ψ(rRL )+U (rL )] drRL
R
=
Iξ e−β[U (rR)+Ψ(rRL )+U (rL )] drRL
R
Θ(rR )e−βU (rR ) drR
= R −β[B(r )+U (r )]
R
R dr
e
R
r

≡

hΘiRR
rR β[∆G◦ −∆Gξ ]
r = hΘiR e
he−βB iRR

(13)

Eqs. (12) and (13) significantly generalize implicit ligand sampling [22], a method to estimate the potential of
mean force for the ligand center of mass. The results of
Cohen et al. [22] may be obtained by choosing the observable as a Dirac delta function for the ligand center
of mass, taking a natural logarithm, and multiplying by
β −1 . Cohen et al. [22] applied implicit ligand sampling
to study gas migration pathways in myoglobin, but the
possibility of estimating other observables and binding
free energies has not been previously recognized.
ESTIMATION

Applying implicit ligand theory to predicting binding
free energies involves three steps:
1. Sampling receptor configurations.
2. Estimating the binding PMF, B(rR ), for each receptor configuration.
3. Estimating ∆G◦ from B(rR ) estimates.
In this section, I present several ways, roughly in order
of increasing complexity, that these steps may be accomplished. A variant of one approach will be demonstrated
later in the paper.

Receptor configurations can be drawn from qR (rR ),
any (possibly unnormalized) distribution qR,w (rR ) on
the same support as qR (rR ) and for which w(rR ) =
qR (rR )/qR,w (rR ) may be calculated, or from multiple
distributions satisfying these conditions. Regardless of
the sampling method, however, convergence of free energy estimates requires representative sampling of both
the bound and unbound receptor configuration space. A
particularly straightforward protocol is to sample from
the distribution proportional to qR (rR ) = e−βU (rR) ; one
conducts a molecular dynamics (MD) simulation in the
implicit solvent used for W (rR ), collecting snapshots at
evenly spaced intervals that are longer than the statistical correlation time. This protocol may be satisfactory
if receptor fluctuations are minimal and the ligand does
not significantly perturb the receptor configurational ensemble.
For a receptor that undergoes larger structural fluctuations, sampling from multiple energetic minima may be
facilitated by applying an external biasing potential (e.g.
a harmonic bias) on one or more order parameters. If it is
known that a ligand significantly perturbs the receptor
configurational ensemble, it can be useful to introduce
multiple alchemical intermediates into a simulation. Alchemical calculations may involve a coupling parameter
λ, defined such that the two groups (e.g. the receptor and
ligand) are non-interacting at λ = 0 and fully interacting
with λ = 1. Simulations are conducted with λ at these
end points and at multiple values in between. Sampling
in each stage may be enhanced by Hamiltonian replica exchange (e.g. Gallicchio et al. [21], Jiang et al. [23], Gallicchio and Levy [24]), which entails stochastically swapping
the coordinates of different simulations with a probability that preserves the Boltzmann distribution. Receptor configurations obtained through a flexible-receptor
Hamiltonian replica exchange with a single ligand may
subsequently be used for implicit ligand free energy calculations with other ligands in the chemical library.
As a caveat, implicit ligand theory does not provide
a formal justification for docking to multiple experimentally determined structures (e.g. [25]) or any other set
of structures in which w(rR ) is unknown (e.g. homology modeling or flexible docking). One potential way to
use information about multiple structures is to conduct
multiple MD simulations with external potentials biased
towards one or more of the structures. To facilitate later
analysis, the external potentials should be set up to promote overlap in the configuration space of different simulations.

4
Estimating a Binding PMF

The binding PMF B(rR ) may be expressed in terms of
a ratio of partition functions,
!
R
Iξ e−βU (rRL) drL dξL
−1
(14)
,
B(rR ) = −β ln R
Iξ e−β[U (rL)+U (rR )] drL dξL

which clarifies that B(rR ) is a special type of free energy difference in which the receptor configuration rR
is rigid. Thus, B(rR ) may be calculated using any one
of many available methods to estimate free energy differences [26], including free energy perturbation (FEP) [27],
thermodynamic integration (TI) [28], and the Bennett
Acceptance Ratio (BAR) [29]. While formally equivalent, free energy methods can have dramatically different
convergence properties.
Based on the form of Eq. (10), the most straightforward estimation protocol is FEP. One can, for example,
draw ligand configurations from the distribution proportional to qL (rL , ξL ) = e−βU (rL) by conducting a MD simulation of the ligand in the appropriate implicit solvent
and collecting snapshots at sufficiently long intervals. Because qL is independent of ξL , the external degrees of
freedom sampled from the simulation may be replaced
by a new ξL sampled from the distribution proportional
to qξ,I = Iξ . The expectation in Eq. (11) may then be
estimated by the sample mean,
B̂(rR ) = −β −1 ln

N
1 X −βΨ(rRL,n )
e
,
N n=1

(15)

where rRL,n is the nth of N samples of the complex.
Throughout this paper, Â will denote a statistical estimator - an equation used to calculate a quantity based
on sampled data.
In exponential averages such as Eq. (15), a small subset of samples may contribute a large portion of the sum.
The limiting case of an individual important sample inspires the severe dominant state approximation, in which
a single value of Ψ(rRL ) is used to estimate B(rR ). Exponential averages may also be estimated via a cumulant
expansion [30], here shown for Eq. (10) to the fourth
order,
β 
 2 rL ,ξL β 2 
 3 rL ,ξL
rL ,ξL
B(rR ) ≈ hΨiL,I
−
ξΨ L,I +
ξΨ L,I
2!
3!



rL ,ξL 2


β 3 
 4 rL ,ξL
, (16)
ξΨ L,I − 3 ξΨ2 L,I
−
4!

L ,ξL
where ξΨ = Ψ(rRL ) − hΨirL,I
. Each expectation in
the cumulant expansion may be estimated by the sample
mean.
While formally correct, this approach to ligand sampling can converge slowly if most ligand configurations
placed in the binding site have overlapping atoms and
high values of Ψ(rRL ). One potential solution to this

problem is to sample the external degrees of freedom from
a distribution biased towards energetically favorable orientations by a confining potential
R Uc (ξL ). Multiplying
and dividing Eq. (10) by Ωc = Iξ e−βUc (ξL ) dξL and the
integrand in the numerator by e−βUc (ξL ) leads to,
 
ErL ,ξL
D
Ωc
−1
−1
−β[Ψ−Uc ]
(17)
− β ln
B(rR ) = −β ln e
Ω
L,Ic
where qL,Ic = Iξ e−β[U (rL )+Uc (ξL )] . Good choices for
Uc (ξL ), which may be ascertained from existing molecular docking algorithms (as will be discussed later in the
paper), will favor the sampling of poses with low Ψ(rRL ).
Alternatively, the binding PMF may be calculated using the inverse form of Eq. 10,
!
R
Iξ eβΨ(rRL ) e−βU (rRL) drL dξL
−1
R
B(rR ) = β ln
Iξ e−βU (rRL) drL dξL


rL ,ξL
(18)
= β −1 ln eβΨ RL,I .

Ligand configurations from the distribution proportional
to qRL,I (rL , ξL ) = Iξ e−βU (rRL) may be sampled, for example, from an implicit-solvent MD simulation in which
the receptor is held rigid and the ligand is allowed to
move, and the expectation estimated using the sample
mean estimator.
This straightforward procedure is also problematic because of the rarity of sampling configurations in which the
ligand is separated from the receptor or in which they
overlap. While these configurations are insignificant in
the conformational ensemble in which receptor and ligand
are fully interacting, they are relevant to the ensemble of
noninteracting ligand and receptor, and the convergence
of free energy differences requires phase space overlap
between adjacent thermodynamic states [26]. The phase
space overlap problem may also be alleviated by calculating the free energy difference with a reference state in
which the external degrees of freedom are confined,
ErL ,ξL
D
Ωc
. (19)
− β −1 ln
B(rR ) = β −1 ln eβ[Ψ−Uc ]
Ω
RL,I

The binding PMF may be estimated from the same samples as with Eq. (18), and will be more accurate the more
closely e−βUc (ξL ) resembles the distribution of ξL in the
complex.
As discussed, phase space overlap problems are often
resolved by introducing multiple alchemical stages into
a calculation, and sampling may be enhanced by Hamiltonian replica exchange. With multiple stages, the total
free energy difference between states with λ = 0 and
λ = 1 is the sum of free energy differences between adjacent stages, each of which may be estimated by FEP [27],
TI [28], or BAR [29]. Alternatively, the total free energy
difference may be estimated by the multistate Bennett
Acceptance Ratio (MBAR) [31].

5
Estimating the Binding Free Energy

DEMONSTRATION

Once B̂(rR ) is evaluated for each receptor configuration, the binding free energy may be calculated by estimating an ensemble average. The appropriate method
for estimating ∆G◦ depends on how the receptor configurations rR are sampled. If they are drawn from the
distribution qR (rR ), then the expectation in Eq. (11)
may be estimated by the sample mean,

As a demonstration, implicit ligand theory calculations were performed to estimate the standard binding
free energy of various ligands to Cucurbit[7]uril (CB[7])
in water. The binding of CB[7] to a number of ferrocenes, adamantanes, and bicyclooctanes has been wellcharacterized by both isothermal calorimetry and secondgeneration mining minima (M2) [18, 19] free energy calculations [32, 33]. Receptor configurations were sampled
by molecular dynamics, binding PMFs estimated with a
multi-stage alchemical calculation and MBAR [31], and
the binding free energy calculated using Eq. (20) or the
dominant state approximation.

∆Ĝ◦ = −β −1 ln

N
1 X −β B̂(rR,n )
e
+ ∆Gξ ,
N n=1

(20)

in which B̂(rR,n ) is the estimated binding PMF for the
nth of N receptor configurations. Because the implicitligand expression for the binding free energy, Eq. (11),
has the same form as Eq. (10), the dominant state approximation and cumulant expansion may also be applied.
If receptor configurations are drawn from a biased distribution, the importance sampling identity,
R
O(r)qT (r)dr
hOiT = R
qT (r)dr
R
O(r)w(r)qS (r)dr
hwOiS
= R
=
,
(21)
w(r)qS (r)dr
hwiS

may be applied. In this generic expression, w(r) =
qT (r)/qS (r) is a ratio of unnormalized densities qT (r) for
the target distribution and qS (r) for the sampling distribution. Using the sample mean estimator and importance sampling identity for the expectation in Eq. (11)
leads to,
PN
w(rR,n )e−β B̂(rR,n )
◦
−1
+ ∆Gξ(22)
∆Ĝ = −β ln n=1PN
n=1 w(rR,n )
If receptor configurations are drawn from multiple biased
distributions, then the expectation may be estimated using MBAR [31].

Thermodynamic Expectations

Thermodynamic expectations may be estimated from
the same data as the binding free energy. The appropriate estimator for Θ(rR ) will depend on how the ligand
configurations were sampled. Once Θ(rR ) is estimated
for every sampled receptor configuration, the appropriate estimator for the expectation in Eq. (13) similarly depends on how the receptor configurations were sampled.
In the simplest case for Θ(rR ), if ligand configurations
are sampled from qξ,I , then Θ(rR ) may be estimated by
rRL
a sample mean. In other cases, Θ(rR ) and hOiRL,I
may
be estimated using importance sampling, MBAR [31], or
a combination thereof.

Methods

Molecular dynamics simulations at 300 K were performed with a slightly modified [34] compilation of
NAMD [35] version 2.9. When appropriate, CB[7] was
fixed using the fixedAtoms parameter. The “commercial” force field parameters and topologies from Moghaddam et al. [33] were used for both CB[7] and its ligands.
To match the force field from Moghaddam et al. [33] as
closely as possible, 1-4 electrostatics were scaled by 0.5
and the nonbonded cutoff was set to 999 Å, which effectively turns off cutoffs. Water was represented with
the Generalized Born Surface Area (GBSA) implicit solvent model without ions and a surface tension of 0.006
kcal/mol/Å2. The receptor dielectric was 1.0 and solvent
dielectric was 78.5. A time step of 1 fs (using a 2 fs time
step with fixed atoms led to unstable trajectories) was
used with Langevin dynamics.
CB[7] was minimized for 2500 steps and thermalized
by increasing the temperature by 10 K and reinitializing velocities every 100 steps from 0 to 300 K. Receptor
snapshots were saved every 0.1 ns from a trajectory of 10
ns.
Binding PMFs for every ligand in Moghaddam et al.
[33] with the minimized CB[7] structure (15 repetitions
each) and 100 receptor simulation snapshots (1 repetition each) were estimated using Hamiltonian replica exchange, which can simultaneously dock a ligand and compute its binding free energy [21, 24]. The implementation
is similar to that from Gallicchio and Levy [24], except
that the receptor configuration is fixed. A reservoir of ligand configurations [24] was generated by simulating the
ligand for up to 10 ns and saving snapshots every 10 ps.
Simulations of the complex in which λ controls the extent
of interaction between the ligand and receptor were run
with λ ∈ {0, 10−5, 10−4 , 10−3 , 10−2 , 0.1, 0.2, 0.3, 0.4, 0.5,
0.6, 0.7, 0.8, 0.9, 0.95, 1.0}. As implemented in NAMD,
intermediate values of λ used a soft-core potential with
a van der Waals shift coefficient of 5. Electrostatic interactions were turned on when λ = 0.5. Using the colvars

6
module, a flat-bottom harmonic potential with a spring
constant of 10 kcal mol−1 Å−1 and starting at 0.75 Å was
used to restrain the center-of-mass distance between the
ligand core (heavy atoms except for the R groups in
Moghaddam et al. [33]) and the receptor heavy atoms.
This potential keeps the ligand within the binding site
when interactions
are turned off. The binding site volR
ume, Ω = Iξ dξL , is approximated as 4/3π(0.753)(8π 2 ).
Because NAMD does not allow the simultaneous use of
alchemical decoupling and implicit solvent, simulations
were conducted in vacuum.
The replica exchange simulation was initiated by taking a random ligand configuration, applying a random
rotation, and randomly placing it within the binding site.
This initial configuration was minimized and thermalized
with the same protocol as with CB[7], except that it was
done in vacuum. The thermalized structure was used to
start each replica. Occasionally, the random placement
of the ligand led to high forces that caused the simulations to crash; in this case, the simulation was restarted
with a different random initial configuration.
After every 5 ps of simulation for every value of λ, 1000
replica exchanges were attempted between each pair of
adjacent λ windows. After each set of replica exchange
attempts, the ligand configuration for λ = 0 was replaced
with a random ligand configuration from the reservoir,
randomly rotated, and placed in the binding site. (This
type of reservoir swap satisfies detailed balance.) The
simulation was conducted for 25 cycles, saving snapshots
every 0.5 ps, for a total of 2 ns of simulation for each
binding PMF. The docking and equilibration period, defined as the time before the potential energy of the fully
coupled state is within 20 kB T of its energy for the final
snapshot, was ignored in subsequent analysis.
Because alchemical coupling calculations were performed in vacuum, binding PMFs were estimated based
on a decomposition of B(rR ),
B(rR ) = Bcpl + BRL − BL − ∆U (rR )
(23)
!
R
Iξ e−βU(rRL ) drL dξL
Bcpl = −β −1 ln R
Iξ e−β[U(rL )+U(rR )] drL dξL
!
R
Iξ e−β∆U(rRL ) e−βU(rRL ) drL dξL
−1
R
BRL = −β ln
Iξ e−βU(rRL ) drL dξL
!
R
Iξ e−β∆U(rL ) e−βU(rL ) drL dξL
−1
R
BL = −β ln
.
Iξ e−βU(rL ) drL dξL

Bcpl is the free energy of turning on the interactions between the ligand and the rigid receptor in vacuum. BRL ,
BL , and ∆U (rR ) are free energies of transferring the complex, ligand, and receptor, respectively, from vacuum to
the target state (in implicit solvent). They are based on
∆U (rX ) = UT (rX ) − U (rX ), the potential energy difference between rX in the target state versus the state from
which configurations were sampled (in vacuum). Bcpl

was estimated by applying MBAR [31] to snapshots from
every 0.5 ps of simulation, and BRL and BL by singlestep FEP (evaluating transfer free energies by MBAR
would require calculating target-state potential energies
for every snapshot using computationally expensive force
fields).
This decomposition makes it straightforward to evaluate B(rR ) for a variety of force fields using the same
configurational samples. In this work, four are compared:
1. NAMD: the total potential energy from using
GBSA in NAMD [35];
2. M2: the total potential energy from using the
GBSA model in the M2 program [18, 19];
3. PB: Poisson-Boltzmann electrostatic solvation free
energies from UHBD [36] and bond, angle, dihedral,
coulomb, and van der Waals energies from the M2
program [18, 19];
4. PBSA: Poisson-Boltzmann electrostatic solvation
free energies from UHBD [36] and bond, angle, dihedral, coulomb, van der Waals, and nonpolar surface area energies from M2 [18, 19], the combination
used in Moghaddam et al. [33].
During this step, the NAMD, M2, and UHBD programs
are used strictly for single-point energy evalulations, not
for minimization or dynamics. Poisson-Boltzmann energies were calculated with a grid spacing of 0.18 Å with
dimensions such that the maximum dimensions of the
molecule are 0.7 (or less) of the final grid [33]. For
comparison, binding PMFs were also calculated from the
dominant state approximation with PBSA energies, using the lowest value of Ψ(rRL ) observed in the simulations
with λ = 0 or λ = 1.
Because receptor configurations were sampled from a
simulation in GBSA implicit solvent, binding free energies were estimated by using Eq. (22). Binding free
energies were also estimated with the dominant state approximation: using 
the lowest
rR observed value of B̂(rR )
to estimate −β −1 ln e−βB R .
To demonstrate the calculation of thermodynamic expectations and for comparison with results from Moghaddam et al. [33], the mean values of six PBSA energies van der Waals, coulomb, electrostatic solvation, valence
(bond + angle + dihedral), nonpolar solvation, and total
- were estimated for the complex, the receptor, and the
ligand. Mean PBSA energies for the ligand and receptor were estimated by applying the importance sampling
identity to the ligand from the non-interacting system in
vacuum and to the receptor from the GBSA simulation,
respectively. Occasionally, energies in the ligand trajectory briefly spiked to very high values. In estimating the
mean PBSA energies, these spikes were filtered out by
removing data points in which the total PBSA energy is
at least 100 kB T larger than the PBSA energy of the final

7

where U0 (rRL ) and U1 (rRL ) are the potential energies of
the non-interacting and fully interacting complexes, respectively, UP BSA (rL ) is the PBSA energy of only the
ligand, and rRL,n is the nth of N snapshots of either the
non-interacting (N0 snapshots) or fully interacting complex (N1 snapshots). B̂cpl was estimated by using MBAR
[31] with all replicas. While it would be possible to estimate the mean PBSA energies using all snapshots from
all replicas, this was avoided because of the computational expense of Poisson-Boltzmann calculations, which
can take over a minute per snapshot. After obtaining
Θ̂(rR ), the importance sampling identity, Eq. (21), was
used to estimate the expectations in Eq. (13). To ensure consistency of the estimator - an estimate of a constant yields the same constant
R ) was calculated for
E-rΘ̂(r
D


rR
R
= e−βB R . This esO = 1, in which case Θ̂(rR )
R


rR
timate of e−βB R was used in the denominator of Eq.
(13).

B(rR)
Bcpl

−23
−30
−37
−116.5
BRL

e−β(UP BSA (RL )−U0 (RL ))
,
N1 −β(U1 (rRL )−B̄cpl −U0 (rRL )
1+ N
e
0

−20
−27

−120

−123.5
−6.6
BL

w(rRL ) =

B02

−13

min{Ψ(rRL)}

snapshot. As the spikes were likely caused by the finite
molecular dynamics time step, they would probably be
avoided by using a propagator the exactly preserves the
Boltzmann distribution, e.g. Hybrid Monte Carlo [37].
Towards estimating the mean PBSA energies of the
complex, rigid-receptor expectations were estimated
by applying MBAR [31] to snapshots from the noninteracting and fully interacting states,
PN
w(rRL,n )O(rRL,n )
(24)
Θ̂(rR ) = n=1
PN
n=1 w(rRL,n )

−6.8
−7
−26.5
−30
−33.5
0

0.5
1
1.5
Total Simulation Time (ns)

2

FIG. 1. The mean and standard deviation of 15 independent estimates of B(rR ), Bcpl , BRL , BL , and min{Ψ(rRL )}
(kcal/mol) based on PBSA energies as a function of total MD
simulation time for the ligand B02. Analogous plots for the
other ligands in this study are available as Fig. S1 in the
Supplemental Material.

Results

Highlighting the importance of an accurate molecular
mechanics model, binding PMF estimates are strongly
dependent on the force field, as shown in Table I. For the
large and highly charged bicyclooctane B11, switching
the force field causes the binding PMF to change nearly
40 kcal/mol! With increasing magnitude of charge, larger
coulomb energies lead to larger values of Bcpl and larger
electrostatic solvation free energies increase the magnitude of BRL , BL , and ∆U (rR ) (for estimates of Bcpl ,
BRL , and BL , see Table SI of the Supplemental Material. Thus, estimating the binding PMF with Eq. (23)
entails the difficult task of computing a relatively small
difference between large values. The importance of the
force field has also been noted for M2 calculations [18, 19].
An alternate implementation, e.g. conducting replica exchange within implicit solvent rather than vacuum, may
not require the implicit solvent model to be as accurate.
With 2 ns of total simulation for all replicas, the standard deviation of binding PMF estimates ranges from

0.12 to 1.63 kcal/mol (Table I), with most estimates on
the lower range of imprecision. For all of the components of Eq. (23), the mean estimate does not appear
to shift after about 0.75 ns, and additional sampling reduces the standard deviation of the estimate (see Fig. 1
and Fig. S1 in the Supplemental Material. There is no
unique component that limits the convergence of B̂(rR );
the slowest converging component varies from ligand to
ligand. The binding PMF estimate B̂(rR ) and the minimal interaction energy min {Ψ(rRL )} converge at about
the same rate, suggesting that the limiting factor for convergence is finding a configuration with the lowest interaction energy. This interpretation is corroborated by the
fact that largest ligands with the most rotatable bonds
(see Moghaddam et al. [33] for structures) also have the
most variance in B̂(rR ), as the flexibility increases the
challenge of finding configurations with low Ψ(rRL ).
The accuracy of binding free energy estimates was
assessed with the correlation coefficient and root mean

8
square error,

(a)

l=1

between methods m1 and m2, where ∆G◦l,m is the binding free energy estimate for ligand l of L ligands using
method m (Tables I and II).
Binding free energy estimates based on the binding
PMF for a minimized receptor structure suffices to provide high correlation with experiment (R2 = 0.884 for
NAMD) and M2 free energy calculations (R2 = 0.827
for NAMD) (see Table I). Surprisingly, binding free energies from NAMD GBSA calculations are more highly
correlated to these benchmarks than ∆Ĝ◦ from PBSA
calculations. Ironically, the high correlation may be explained by inaccurately large binding PMF values resulting from highly charged ligands, as the molecules in this
set with the strongest charges also tend to have stronger
binding affinities. Although the correlation coefficient is
high, the RMSE is also considerable, over 10 kcal/mol.
Similar performance (R2 and RMSE) is observed by using the dominant state approximation with PBSA calculations. In contrast, using Eq. (23) with PBSA leads
to less correlated (lower R2 ) but more accurate (lower
RMSE) estimates of the binding free energy.
Even for this simple system, binding free energy estimates are substantially improved by using multiple receptor structures (Table II). With binding PMFs from PBSA
energies for 100 receptor structures, there is both higher
correlation and lower RMSE with respect to experiment
(R2Exp = 0.704, RMSEExp = 4.5) and especially with respect to M2 free energy calculations (R2Gilson = 0.925,
RMSEGilson = 2.4).
While there are some variations on the order of a few
kcal/mol, mean potential energy changes upon complexation are also consistent with results from Moghaddam
et al. [33] (Table III). Minor discrepencies between M2
and implicit ligand free energy and mean potential energy
calculations may be explained by a combination of imperfect sampling in the current calculations and the approximations in M2. As the described calculations were
performed in vacuum, the samples may not be from the
same configurational space as those in implicit solvent.
On the other hand, M2 assumes that the energy landscape of the ligand, receptor, and complex are a truncated harmonic wells with anharmonicity corrections.
Compared to the full procedure for estimating the
binding PMF, applying the dominant state configuration
leads to a reduction in the correlation with M2 results
and an increase in the RMSE (Table IV). In contrast,
applying the dominant state approximation to calculate
∆Ĝ◦ from B̂(rR ) leads to a near-constant reduction of
about 3 kcal/mol in the estimated binding free energy.
While the RMSE increases, the correlation with M2 results remains nearly identical. Given the same B̂(rR )

15
Count

v
u
L
u1 X
RMSE(m1, m2) = t
(∆G◦l,m1 − ∆G◦l,m2 )2 (25)
L

10
5
0
−25

−20
−15
Binding PMF (kcal/mol)

−10

(b)
−14.8
−16.9
−19

0

5
10
15
Number of Receptor Snapshots

20

(c)
−17.6
−18.3
−19
20

40
60
80
Number of Receptor Snapshots

100

FIG. 2.
(a) Histogram of binding PMF estimates B̂(rR )
(kcal/mol) of B02 to 100 snapshots of CB[7], using PBSA energies. The vertical line shows the mean binding PMF for the
minimized receptor structure. (b) and (c) Estimates of the
binding free energy ∆G◦ of B02 to CB[7] (kcal/mol), using
PBSA energies, as a function of the number of receptor snapshots. The line and error bars denote the mean and standard
deviation from bootstrapping: the binding free energy is estimated 100 times using random selections of N out of 100
binding PMFs. Analogous plots for the other ligands in this
study are available as Figs. S2 and S3 in the Supplemental
Material.

results, however, there is essentially no reason to apply
the dominant state approximation rather than Eq. (22).
There is considerable variation in the binding PMFs
for the 100 receptor structures (Fig. 2 and Fig. S2 in
the Supplemental Material. For most of the ligands, the
range of binding PMFs span 10 to 20 kcal/mol. While
the binding PMF of the minimized structure is often near
the lower end of the binding PMF distribution, this is not
always the case. In larger ligands, the binding PMF appears to be lower for other receptor structures. The fact
that a single structure does not always lead to the lowest
binding PMF shows a major limitation of using a single
receptor structure to estimate binding free energies.
In spite of the variability of binding PMFs, for the ligands in the test set, the average value of ∆G◦ appears to
stabilize after a relatively small number (about 15) of receptor snapshots (Fig. 2 and Fig. S3 in the Supplemental
Material. Using a greater number of snapshots slightly

9
reduces the variance of binding free energy estimates. After the certain point, however, further reduction in the
variance of ∆Ĝ◦ is limited by the variance in binding
PMF estimates.

DISCUSSION

While the good agreement between implicit ligand and
M2 calculations provides a proof of principle, the convergence and accuracy of implicit ligand calculations will
differ with other classes of receptor-ligand pairs. With
protein-ligand pairs, for example, representative sampling of receptors and finding low-energy poses of the
ligand will likely require much more MD simulation time.
On the other hand, many protein-ligand systems are not
as strongly charged and may be less sensitive to the electrostatic solvation free energy. Due to these variabilities,
assessments for the feasibility of implicit ligand calculations in different classes of systems will prove valuable.
Tests for convergence and accuracy may be similar to
those performed for the CB[7] system.
Numerous opportunities remain for further methodological improvement and optimization of implicit ligand
free energy calculations. The accuracy of implicit ligand
calculations (and M2 calculations) may be limited by the
quality of the force field. The decomposition of the binding PMF in Eq. (23) provides a facile means to integrate alternate and potentially more expensive potential
energies, e.g. quantum mechanical calculations or more
sophisticated nonpolar solvation free energies. Modeling
may also be improved by the inclusion of a few explicit
water molecules (see Supplemental Material.) Another
potential avenue for improvement is the fine-tuning of
the replica exchange protocol (e.g. using implicit solvent
or optimizing the number of stages and values of λ for a
particular system) or implementing alternative methods
to estimate the binding PMF and binding free energy.
Even without modifying the replica exchange protocol,
computations may be accelerated by optimizing existing
MD simulation packages for implicit ligand theory. Few
modern MD simulation programs take full advantage of
rigid degrees of freedom by skipping the calculation of
pairwise interactions between rigid atoms. Even fewer
implicit solvent models are designed with rigid receptors
in mind [38]; implicit ligand theory may inspire the development of such models.
Implicit ligand theory also provides guidance on how to
understand and improve existing molecular docking algorithms. The definition of Ψ(rRL ) provides a straightforward functional form that can be used to account for solvation free energies and ligand internal energies (strain),
which have been noted to be important factors in binding free energies [39], but are frequently ignored in the
interaction energy functions used by docking packages.
Implicit ligand theory also delineates how to improve the

ranking of different ligands. Molecular docking packages
currently rank receptor-ligand binding free energies based
on a single low-energy configuration. As such, they apply the crudest form of implicit ligand theory, the dominant state approximation, to estimate both the binding
PMF and the binding free energy. With important modifications to existing algorithms and the application of
more complex estimators, the accuracy of scoring functions should be enhanced.
One important potential change to molecular docking
is the inclusion of multiple receptor configurations. While
most modern docking packages account for the orientation and flexibility of the ligand, the large number of
coordinates makes the treatment of receptor flexibility
challenging. A number of groups have improved docking
performance by treating receptor flexibility by using multiple structures from crystallography [25, 40, 41] or MD
simulations [42] (the relaxed complex method [7, 43, 44]).
Molecular dynamics simulations have also revealed binding sites not discovered by crystallography [45, 46]. In
the case of HIV integrase, insight into a new binding site
even inspired the development of a new drug [47].
Despite of this success, it has hitherto remained unclear how to combine information from docking to different receptor snapshots. While averaging strategies have
been empirically compared [48], the default strategy has
been to rank the ligand using the minimal energy from
docking to all the snapshots. With implicit ligand theory,
it is clear that the binding free energy may also be estimated by using an exponential average or cumulant expansion of the binding PMF (which may still come from
the dominant state approximation) for different snapshots.
The computational expense of the relaxed complex approach may be reduced by clustering snapshots and selecting a representative snapshot from each cluster [44].
Assuming that the binding PMF is constant within the
cluster, estimated averages may be weighed by the cluster size. Using a clustering algorithm based on QR factorization to select 33 representative structures, Amaro
et al. [44] were able to accurately reproduce a histogram
of docking scores to over 400 structures. Further research
will be necessary to develop and validate algorithms that
reliably cluster receptor configurations in which the binding PMF is nearly constant.
Compared to the inclusion of multiple receptor structures, a more difficult task is the estimation of B(rR ) using molecular docking, as this involves a paradigm shift
from searching for a minimum to sampling from a distribution. Docking algorithms may be broadly classified
into two categories: matching and docking simulation
[49]. Matching algorithms such as DOCK [50] attempt
to match a ligand into a model of the binding site. DOCK
models both the ligand and the binding site as a set of
spheres and uses algorithms from graph theory to align
the ligand spheres into the binding site spheres. In dock-

10
ing simulation methods such as AutoDOCK [49, 51–53]
and MCDOCK [54], the ligand starts outside the binding site and its configuration and orientation are progressively modified to search for the lowest energy configuration of the complex.
Matching algorithms can estimate B(rR ) by a postprocessing algorithm. That is, after low-energy complexes
are found, they may be used to bias receptor-independent
random sampling of the ligand orientation by a confining potential Uc (ξL ), for use in Eq. (17). With a harmonic potential for Uc (ξL ), the ligand orientation will
come from a Gaussian distribution. An alternative postprocessing algorithm is to use the lowest-energy structure from a matching algorithm as a starting point for a
rigid-receptor MD simulation. This is not prohibitively
expensive; Graves et al. [8] even used MD simulations
with flexibility near the binding site as a postprocessing
step for molecular docking. Samples from this simulation
would be used to estimate B(rR ) based on Eq. (18) or
Eq. (19).
Docking simulation methods, on the other hand, will
need to be modified to sample from a known distribution rather than to search for the minimum energy. This
change may not require a complete revamp. Docking simulation algorithms are often based on Monte Carlo approaches, which preserve a desired distribution or may be
readily modified to do so. For example, MCDOCK [54]
and early generations of AutoDOCK [51, 52] use simulated annealing, a procedure for which it is possible to
calculate the importance sampling weight [55].
In addition to providing a path to rigorous binding
free energies from molecular docking, implicit ligand theory also quantifies existing notions [56] about whether
molecular recognition proceeds by induced fit or conformational selection [57, 58]. As all receptor configurations have finite Boltzmann probability, the issue is
a matter of degree. Suppose that a receptor binds to
two different ligands with the same binding free energy,
one by conformational selection and the other by induced fit. If, to a good approximation, the complex is
dominated by a single structure with receptor config∗
uration rR
such that B(rR ) = ∞ for all other receptor configurations, then Eq. (11) simplifies to ∆G◦ =
∗
∗
U(rR
) + B(rR
) + β −1 ln ZR + ∆Gξ . For the ligand that
∗
∗
binds by conformational selection, p(rR
) = e−βU (rR) /ZR
has a reasonably high probability. In the induced fit com∗
∗
plex, U(rR
) is much less favorable and B(rR
) must compensate accordingly to achieve the same ∆G◦ .
Source code and data used in this paper are available
at https://simtk.org/home/implicit_ligand.

ACKNOWLEDGEMENT

The author thanks David Beratan for being a supportive postdoctoral advisor, Aaron Virshup and Shahar

Keinan for helpful discussions, John Chodera and David
Mobley for comments on the manuscript, Yi Wang for
suggesting CB[7] as a test case, Michael Gilson for providing parameters for CB[7] and its ligands, Clayton Jarratt for pinpointing the cause of negative surface areas
in NAMD, and Emilio Gallichio for sharing source code
for BEDAM. Calculations were performed using Duke
Shared Computing Resources (DSCR). This research was
funded by NSF CHE10-57953, NIH 2P50 GM-067082-0610, and N00014-11-1-0729.

∗
Electronic Address: dm225@duke.edu
[1] B. K. Shoichet, Nature 432, 862 (2004).
[2] G. Klebe, Drug Discov Today 11, 580 (2006).
[3] R.
Kim
and
J.
Skolnick,
J Comput Chem 29, 1316 (2008).
[4] N.
Moitessier,
P.
Englebienne,
D.
Lee,
J.
Lawandi,
and
C.
R.
Corbeil,
British Journal of Pharmacology 153, S7 (2009).
[5] D. Plewczynski, M. Laźniewski, R. Augustyniak, and
K. Ginalski, J Comput Chem 32, 742 (2010).
[6] J. Wang, P. Morin, W. Wang,
and P. Kollman,
J Am Chem Soc 123, 5221 (2001).
[7] J. Lin, A. Perryman, J. Schames, and J. McCammon,
Biopolymers 68, 47 (2003).
[8] A. P. Graves, D. M. Shivakumar, S. E. Boyce,
M. P. Jacobson, D. A. Case, and B. K. Shoichet,
J Mol Biol 377, 914 (2008).
[9] D. C. Thompson, C. Humblet, and D. Joseph-McCarthy,
J Chem Inf Model 48, 1081 (2008).
[10] T. Hou, J. Wang, Y. Li,
and W. Wang,
J Comput Chem 32, 866 (2010).
[11] M. W. Chang, C. Ayeni, S. Breuer, and B. E. Torbett,
PLoS ONE 5, e11955 (2010).
[12] N. Huang, C. Kalyanaraman, K. Bernacki, and M. P.
Jacobson, Phys Chem Chem Phys 8, 5166 (2006).
[13] Activities have been assumed to be unity, a reasonable
approximation in the limit of low concentrations.
[14] M. K. Gilson, J. Given, B. Bush, and J. McCammon,
Biophys J 72, 1047 (1997).
[15] J. Wang, C. Tan, Y.-H. Tan, Q. Lu, and R. Luo, Commun Comput Phys 3, 1010 (2008).
[16] M.
Feig
and
C.
Brooks,
Curr Opin Struc Biol 14, 217 (2004).
[17] J. Michel and J. W. Essex, J Med Chem 51, 6654 (2008).
[18] C.-E.
Chang
and
M.
K.
Gilson,
J Comput Chem 24, 1987 (2003).
[19] C.-E. Chang, M. J. Potter,
and M. K. Gilson,
The Journal of Physical Chemistry B 107, 1048 (2003).
[20] M. Lee, Biophys J 90, 864 (2005).
[21] E. Gallicchio, M. Lapelosa,
and R. M. Levy,
J Chem Theory Comput 6, 2961 (2010).
[22] J. Cohen, A. Arkhipov, R. Braun, and K. Schulten,
Biophys J 91, 1844 (2006).
[23] W. Jiang,
M. Hodoscek,
and B. Roux,
J Chem Theory Comput 5, 2583 (2009).
[24] E.
Gallicchio
and
R.
M.
Levy,
J Comput-Aided Mol Des , 1 (2012).

11
[25] S. Rao, P. C. Sanschagrin, J. R. Greenwood,
M. P. Repasky, W. Sherman,
and R. Farid,
J Comput Aided Mol Des 22, 621 (2008).
[26] C. Chipot and A. Pohorille, eds., Free Energy Calculations, Vol. 86 (Springer, Berlin, 2007).
[27] R. Zwanzig, J Chem Phys 22, 1420 (1954).
[28] J. G. Kirkwood, J Chem Phys 3, 300 (1935).
[29] C. H. Bennett, J Comput Phys 22, 245 (1976).
[30] R. Zwanzig, J Chem Phys 22, 1420 (1954).
[31] M.
R.
Shirts
and
J.
D.
Chodera,
J Chem Phys 129, 124105 (2008).
[32] S. Moghaddam, Y. Inoue,
and M. K. Gilson,
J Am Chem Soc 131, 4012 (2009).
[33] S. Moghaddam, C. Yang, M. Rekharsky, Y. H.
Ko, K. Kim, Y. Inoue,
and M. K. Gilson,
J Am Chem Soc 133, 3570 (2011).
[34] Using the linear combination of pairwise overlap [59] algorithm, NAMD 2.9 calculates a negative surface area
for CB[7]. NAMD directly uses Appendix B of Weiser
et al. [59], in which the P1 parameter for the N sp3 atom
type with 1 bonded neighbor is 7.8602 × 10−2 , which is
smaller than other P1 values and the corresponding P2
parameter. By definition, P1 should be larger than P2 . To
bring this parameter in line with other P1 and to make it
larger than P2 , this parameter was multiplied by 10. The
modified code yields a positive surface area for CB[7].
[35] J. C. Phillips, R. Braun, W. Wang, J. Gumbart,
E. Tajkhorshid, E. Villa, C. Chipot, R. D. Skeel, L. Kalé,
and K. Schulten, J Comput Chem 26, 1781 (2005).
[36] M.
E.
Davis,
J.
D.
Madura,
B.
a.
Luty,
and
J.
McCammon,
Computer Physics Communications 62, 187 (1991).
[37] S. Duane, A. D. Kennedy, B. J. Pendleton,
and
D. Roweth, Phys Lett B 195, 216 (1987).
[38] O. Guvench, J. Weiser, P. Shenkin, I. KolossvRy, and
W. Still, J Comput Chem 23, 214 (2001).
[39] D.
L.
Mobley
and
K.
A.
Dill,
Structure/Folding and Design 17, 489 (2009).
[40] I. R. Craig, J. W. Essex,
and K. Spiegel,
J Chem Inf Model 50, 511 (2010).
[41] G. Bottegoni, W. Rocchia, M. Rueda, R. Abagyan, and
A. Cavalli, PLoS ONE 6, e18845 (2011).
[42] S. E. Nichols, R. Baron, A. Ivetac, and J. A. McCammon, J Chem Inf Model 51, 1439 (2011).
[43] J. Lin, A. Perryman, J. Schames, and J. McCammon,
J Am Chem Soc 124, 5632 (2002).
[44] R. E. Amaro, R. Baron,
and J. A. McCammon,
J Comput Aided Mol Des 22, 693 (2008).
[45] J. Schames, R. Henchman, J. Siegel, C. Sotriffer, H. Ni,
and J. McCammon, J Med Chem 47, 1879 (2004).
[46] R. E. Amaro, D. D. L. Minh, L. S. Cheng, W. M. Lindstrom, A. J. Olson, J.-H. Lin, W. W. Li, and J. A.
McCammon, J Am Chem Soc 129, 7764 (2007).
[47] J.
D.
Durrant
and
J.
A.
McCammon,
BMC Biol 9, 71 (2011).
[48] J.
L.
Paulsen
and
A.
C.
Anderson,
Journal Chem Inf Model 49, 2813 (2009).
[49] G. Morris, D. Goodsell, R. Halliday, R. Huey, W. Hart,
R. Belew, and A. Olson, J Comput Chem 19, 1639
(1998).
[50] I. D. Kuntz, J. M. Blaney, S. J. Oatley, R. Langridge,
and T. E. Ferrin, J Mol Biol 161, 269 (1982).
[51] D. Goodsell and A. Olson, Proteins 8, 195 (1990).

[52] G. Morris, D. Goodsell, R. Huey, and A. Olson, J Comput Aided Mol Des 10, 293 (1996).
[53] R. Huey, G. M. Morris, A. J. Olson, and D. S. Goodsell,
J Comput Chem 28, 1145 (2007).
[54] M.
Liu
and
S.
Wang,
J Comput Aided Mol Des 13, 435 (1999).
[55] R. Neal, Stat Comput 11, 125 (2001).
[56] H. Carlson, Curr Opin Chem Biol 6, 447 (2002).
[57] Y. Xu, J. P. Colletier, H. Jiang, I. Silman, J. L. Sussman,
and M. Weik, Protein Sci 17, 601 (2008).
[58] D. Bucher, B. J. Grant,
and J. A. McCammon,
Biochemistry-Us 50, 10530 (2011).
[59] J. Weiser, P. S. Shenkin,
and W. C. Still,
J Comput Chem 20, 217 (1999).
[60] J.
A.
Wagoner
and
V.
S.
Pande,
J Chem Phys 134, 214103 (2011).
[61] S. Wong, R. E. Amaro,
and J. A. McCammon,
J Chem Theory Comput 5, 422 (2009).

12
SUPPLEMENTAL MATERIAL

This supplemental material contains one theoretical
section, two tables, and three figures. The theoretical
section describes a hybrid implicit-explicit solvent model.
One table is for components of the binding PMF and the
other for average potential energies. The figures show
the convergence of binding PMF and binding free energy
estimates, as well histogram of binding PMF estimates
for different receptor snapshots.
Hybrid Implicit-Explicit Solvent

The desire to combine the speed of implicit solvent
with the molecular detail and accuracy of explicit solvent has inspired interest in hybrid implicit-explicit solvent models (see Wagoner and Pande [60] and references
therein). In the context of implicit ligand theory, a small
number of explicit solvent molecules can be considered
as a part of the receptor [61] during binding PMF calculations.
A simple formalism for a hybrid implicit-explicit solvent model may be derived by separating the coordinates
of N solvent molecules rS into explicitly represented coordinates rE and implicitly represented coordinates rI .

Partition functions analogous to and formally equivalent
to Eqs. (6) and (7) are then defined as,
Z
ZRL′ = Iδ e−β[U(rRL ,rE )+W (rRL ,rE )] drRL drE (26)
Z
(27)
ZR′ = e−β[U(rR ,rE )+W (rR ,rE )] drR drE .
Defining the effective interaction energy as Ψ′ (rRL , rE ) =
U(rRL , rE ) − U(rR , rE ) − U(rL ) and the binding PMF as,
!
R
Iδ e−β[Ψ(rRL,rE )+U (rL )] drL dδL
′
−1
R
,
B (rR , rE ) = −β ln
Iδ e−βU (rL ) drL dδL
the binding free energy may be written as,


ZRL′ C ◦
◦
−1
∆G = −β ln
′ Z 8π 2
ZR
L
!
R −β[B ′ (r ,r )+U (r ,r )]
R E
R E
e
drR drE ΩC ◦
−1
R
= −β ln
8π 2
e−βU (rR ,rE ) drR drE
E
D
′ rR ,rE
+ ∆Gδ ,
(28)
= −β −1 ln e−βB
R,E

where qR,E = e−βU (rR,rE ) . The main text focuses on
describing calculations in implicit solvent, with the understanding that explicit solvent may be readily included.

13
Ligand
AD1
AD2
AD3
AD4
AD5
B02
B05
B11
F01
F02
F03
F06
R2IT C
RMSEIT C
R2Gilson
RMSEGilson

NAMD
-14.1 (0.79)
-32.5 (0.15)
-31.0 (0.16)
-44.0 (0.94)
-32.2 (0.68)
-12.8 (0.41)
-40.4 (0.29)
-52.4 (1.50)
-1.8 (1.57)
-14.8 (0.96)
-16.3 (1.61)
-30.6 (0.18)
0.884
12.8
0.827
10.4

M2
-22.0 (0.51)
-29.0 (0.13)
-30.7 (0.18)
-36.7 (1.11)
-29.0 (0.25)
-18.8 (0.38)
-30.6 (0.40)
-38.5 (1.81)
-5.5 (0.81)
-14.1 (0.67)
-13.1 (1.03)
-20.0 (0.21)
0.750
7.9
0.907
4.8

PB
-23.0 (0.82)
-26.8 (0.12)
-28.9 (0.23)
-24.0 (1.12)
-26.0 (0.14)
-19.8 (0.53)
-19.5 (0.50)
-14.1 (1.72)
-10.9 (0.53)
-16.2 (0.42)
-16.4 (0.95)
-21.9 (0.18)
0.454
4.9
0.705
5.4

PBSA
-25.5 (0.83)
-29.4 (0.12)
-31.6 (0.23)
-26.9 (1.12)
-28.5 (0.14)
-22.6 (0.53)
-22.3 (0.50)
-17.5 (1.63)
-13.6 (0.53)
-19.2 (0.42)
-19.5 (0.94)
-25.4 (0.18)
0.490
4.7
0.712
4.5

min{Ψ(rRL )}
-31.3 (0.55)
-36.9 (0.30)
-40.3 (0.28)
-36.1 (0.45)
-36.2 (0.29)
-30.6 (0.54)
-34.3 (0.63)
-39.3 (1.90)
-24.7 (0.33)
-31.7 (0.38)
-31.1 (0.71)
-37.2 (0.24)
0.883
12.2
0.792
11.3

TABLE I. The mean and standard deviation of 15 independent estimates of the binding PMF, B(rR ), (kcal/mol) for various
ligands to the minimized structure of CB[7], based on applying Eq. (23) with different force fields (NAMD, M2, PB, and PBSA
columns) or on using the minimum observed value of the interaction energy Ψ(rRL ) from PBSA energies during the λ = 0 and
λ = 1 simulations (min{Ψ(rRL )} column). The bottom rows show the correlation coefficient (R2 ) and root mean square error
(RMSE, Eq. (25)) with respect to isothermal titration calorimetry experiments (ITC) and mining minima calculations (Gilson)
state approximation - calculating ∆Ĝ◦ by using a single binding
from Moghaddam et al. [33] that result from the
 dominant

−1
−βB rR
PMF estimate B̂(rR ) as an estimate for −β ln e
in Eq. (11).
R

Ligand
AD1
AD2
AD3
AD4
AD5
B02
B05
B11
F01
F02
F03
F06
R2IT C
RMSEIT C
R2Gilson
RMSEGilson

ITC
-14.1
-19.4
-20.4
-21.5
-19.1
-13.4
-19.5
-20.6
-12.9
-16.8
-17.2
-21.0

Gilson
-18.2
-25.9
-25.6
-29.7
-24.1
-12.0
-23.1
-22.4
-10.2
-12.4
-12.2
-17.8
0.782
4.6

NAMD
-9.4 (0.23)
-27.9 (0.19)
-35.7 (5.03)
-40.5 (0.21)
-29.5 (1.24)
-9.0 (0.38)
-38.0 (0.40)
-51.2 (0.34)
0.3 (0.82)
-12.0 (0.70)
-10.2 (0.16)
-24.1 (0.34)
0.870
14.0
0.841
11.3

M2
-16.3 (0.15)
-24.3 (0.22)
-28.6 (1.87)
-33.7 (0.32)
-24.0 (0.20)
-13.7 (0.16)
-27.7 (0.27)
-37.3 (0.24)
-0.6 (0.34)
-9.6 (0.75)
-7.3 (0.24)
-14.1 (0.46)
0.745
9.0
0.892
5.9

PB
-17.6 (0.25)
-22.9 (0.27)
-23.5 (0.23)
-24.3 (1.11)
-22.0 (0.35)
-15.4 (0.26)
-18.6 (0.27)
-17.2 (0.53)
-4.9 (0.26)
-11.7 (0.70)
-10.2 (0.22)
-16.2 (0.51)
0.671
4.4
0.923
3.4

PBSA
-20.1 (0.25)
-25.4 (0.26)
-26.2 (0.23)
-27.1 (1.06)
-24.4 (0.34)
-18.1 (0.25)
-21.4 (0.27)
-20.5 (0.51)
-7.6 (0.25)
-14.6 (0.71)
-13.2 (0.22)
-19.7 (0.52)
0.704
4.5
0.925
2.4

TABLE II. Estimates of the binding free energy ∆G◦ (kcal/mol) of various ligands to CB[7]. First, binding PMFs B(rR )
are estimated based on Eq. (23) for 100 receptor snapshots from a simulation in GBSA implicit solvent. Then ∆Ĝ◦ is
calculated using Eq. (22). The value in the parentheses is the standard deviation from bootstrapping: the binding free energy
is estimated based on 1000 random selections of 100 binding PMFs. The experimental and Gilson columns are isothermal
calorimetry measurements (ITC) and M2 calculations, respectively, taken from Moghaddam et al. [33]. The bottom rows are
the correlation coefficient (R2 ) and root mean square error (RMSE, Eq. (25)) with respect to the ITC and Gilson columns.

14
Ligand
AD1
AD2
AD3
AD4
AD5
B02
B05
B11
F01
F02
F03
F06

VDW
-32.5 (0.471)
-33.6 (0.931)
-32.8 (0.718)
-38.1 (1.400)
-33.3 (1.374)
-33.3 (0.622)
-32.9 (0.896)
-39.9 (1.192)
-26.2 (0.497)
-26.9 (1.518)
-28.7 (0.832)
-35.1 (1.154)

Coul
0.1 (1.509)
-65.8 (1.032)
-64.4 (0.693)
-125.2 (3.283)
-65.1 (1.549)
-5.8 (1.067)
-138.2 (1.231)
-199.3 (2.280)
-8.2 (1.824)
-65.7 (2.078)
-58.0 (0.987)
-116.1 (0.810)

PB
4.8 (1.547)
64.9 (0.783)
62.2 (0.855)
124.4 (1.003)
64.8 (1.415)
9.7 (0.770)
138.0 (1.151)
212.0 (1.066)
14.2 (1.119)
65.9 (0.923)
64.2 (0.649)
120.9 (0.651)

Val
-5.0 (2.785)
-5.9 (1.910)
-5.7 (2.128)
1.9 (4.475)
-4.9 (1.782)
1.4 (3.379)
-2.3 (1.236)
-5.6 (5.431)
8.7 (4.842)
-0.9 (2.237)
-0.4 (3.552)
-8.8 (4.862)

-2.5
-2.5
-2.6
-2.7
-2.5
-2.7
-2.8
-3.4
-2.7
-3.0
-3.0
-3.5

NP
(0.011)
(0.017)
(0.009)
(0.070)
(0.025)
(0.022)
(0.013)
(0.075)
(0.017)
(0.012)
(0.015)
(0.013)

Total
-35.2 (2.547)
-42.9 (1.693)
-43.4 (2.388)
-39.9 (2.817)
-40.9 (1.834)
-30.6 (2.187)
-38.1 (1.673)
-36.2 (4.475)
-14.3 (4.079)
-30.6 (2.253)
-26.1 (3.428)
-42.6 (4.132)

TABLE III. Estimates of the mean potential energy changes (kcal/mol) upon the binding of various ligands to CB[7]. The
columns refer to van der Waals (VDW), coulomb (Coul), electrostatic solvation (PB), valence (Val, bond + angle + dihedral),
nonpolar solvation (NP), and total energies. The value in the parentheses is the standard deviation from bootstrapping: the
observable is estimated based on 1000 random selections of 100 values of Θ̂. In Table SII of the Supplemental Material, mean
potential energies for the ligand, receptor, and complex are also shown.

Ligand
B̂(rR )
∆Ĝ◦
AD1
AD2
AD3
AD4
AD5
B02
B05
B11
F01
F02
F03
F06
R2IT C
RMSEIT C
R2Gilson
RMSEGilson
R2Exp
RMSEExp

min{Ψ(r
HREX
R )}
n
o min{Ψ(rR )}
n
o HREX
min B̂(rR )
EXP
min B̂(rR )
EXP
-28.6
-36.4
-38.1
-43.1
-35.8
-29.8
-37.9
-48.5
-22.7
-30.9
-28.7
-35.6
0.849
17.3
0.787
15.8
0.723
15.5

-27.2
-34.6
-36.8
-40.4
-33.6
-27.9
-35.6
-45.7
-21.3
-28.8
-27.0
-33.8
0.855
15.3
0.795
13.9
0.736
13.6

-22.0
-27.6
-27.6
-29.8
-26.8
-21.0
-23.7
-23.1
-10.2
-17.0
-14.5
-21.3
0.684
5.8
0.926
3.5
0.996
2.3

-20.1
-25.4
-26.2
-27.1
-24.4
-18.1
-21.4
-20.5
-7.6
-14.6
-13.2
-19.7
0.704
4.5
0.925
2.4

TABLE IV. Estimates of the binding free energy ∆G◦ (kcal/mol) using the PBSA model. First, the binding PMF B(rR )
is estimated with the dominant state
(min {Ψ(rR )}) or based on Eq. (23) (HREX). Then, ∆Ĝ◦ is from the
n approximation
o
dominant state approximation (min B̂(rR ) ) or based on Eq. (22) (EXP). The bottom rows show the correlation coefficient

(R2 ) and root mean square error (RMSE, Eq. (25)) with respect to isothermal titration calorimetry experiments (ITC) and
mining minima calculations (Gilson) from Moghaddam et al. [33], and the fourth column.

Ligand Chargea
Bcpl
BRL,NAM D BL,NAM D
BRL,M 2
BL,M 2
AD1
0
-31.6 (0.09) -115.9 (0.78) -2.8 (0.01) -111.5 (0.50) -1.1 (0.01)
1
-91.3 (0.12) -123.7 (0.10) -51.9 (0.04) -112.8 (0.04) -55.2 (0.04)
AD2
AD3
1
-93.2 (0.17) -118.9 (0.06) -50.5 (0.04) -108.9 (0.05) -51.4 (0.04)
AD4
2
-148.0 (0.41) -202.5 (0.62) -175.9 (0.63) -192.2 (0.75) -183.5 (0.58)
1
-90.5 (0.13) -124.3 (0.76) -52.1 (0.05) -111.9 (0.29) -53.5 (0.02)
AD5
B02
0
-31.9 (0.09) -118.4 (0.37) -6.9 (0.05) -111.4 (0.33) -4.5 (0.03)
B05
2
-156.8 (0.13) -187.3 (0.27) -173.2 (0.11) -176.4 (0.35) -182.7 (0.18)
4
-220.7 (0.83) -437.9 (1.24) -475.7 (0.65) -422.5 (1.20) -484.7 (0.97)
B11
F01
0
-25.2 (0.27) -117.2 (1.50) -10.1 (0.10) -65.0 (0.75) 35.3 (0.07)
F02
1
-84.2 (0.24) -112.1 (0.87) -50.9 (0.07) -77.9 (0.57) -28.0 (0.11)
1
-82.1 (0.51) -111.8 (2.04) -47.0 (0.04) -76.2 (1.45) -25.2 (0.07)
F03
F06
2
-144.6 (0.15) -152.3 (0.09) -135.7 (0.10) -123.3 (0.12) -127.9 (0.18)
a

BRL,P B
-128.1 (0.81)
-123.4 (0.02)
-122.3 (0.10)
-188.8 (0.87)
-123.5 (0.03)
-129.1 (0.49)
-173.4 (0.45)
-404.2 (1.93)
-92.5 (0.45)
-96.6 (0.32)
-97.0 (1.37)
-139.0 (0.09)

BL,P B
-4.5 (0.01)
-55.8 (0.03)
-54.5 (0.04)
-180.6 (0.54)
-55.9 (0.03)
-9.0 (0.02)
-178.6 (0.15)
-478.7 (0.74)
25.4 (0.07)
-32.5 (0.08)
-30.5 (0.05)
-129.5 (0.14)

BRL,P BSA
-122.3 (0.81)
-117.6 (0.02)
-116.4 (0.10)
-182.8 (0.86)
-117.6 (0.03)
-123.3 (0.49)
-167.5 (0.45)
-396.9 (1.80)
-86.6 (0.46)
-90.7 (0.32)
-91.1 (1.36)
-132.9 (0.09)

BL,P BSA
-2.6 (0.01)
-53.8 (0.03)
-52.3 (0.04)
-178.1 (0.54)
-53.9 (0.03)
-6.8 (0.02)
-176.4 (0.15)
-474.3 (0.75)
27.6 (0.08)
-29.9 (0.08)
-27.9 (0.05)
-126.3 (0.14)

Net formal charge

TABLE SI. The mean and standard deviation of 15 independent estimates for components of the binding PMF B(rR ) (kcal/mol), as described in Eq. (23), for various
ligands to the minimized structure of Cu[7].

15

16

Ligand
AD1
AD2
AD3
AD4
AD5
B02
B05
B11
F01
F02
F03
F06

Average Potential Energy
VDW
Coul
-90.2 (0.417) 50.7 (1.415)
-91.9 (0.905) 29.7 (0.888)
-91.7 (0.684) 23.7 (0.452)
-98.1 (1.382) 79.7 (3.240)
-91.5 (1.357) 19.7 (1.457)
-87.2 (0.582) 39.8 (0.929)
-90.5 (0.869) 29.4 (1.113)
-103.0 (1.171) 336.9 (2.218)
-88.1 (0.446) 84.0 (1.747)
-89.4 (1.502) 56.6 (2.010)
-90.1 (0.802) 55.2 (0.835)
-97.3 (1.133) 63.0 (0.616)

of Complexes
PB
-131.6 (1.500)
-122.9 (0.687)
-124.3 (0.768)
-191.4 (0.930)
-123.1 (1.364)
-131.2 (0.672)
-173.0 (1.087)
-404.0 (0.997)
-127.1 (1.054)
-119.3 (0.843)
-117.4 (0.529)
-153.2 (0.532)

Ligand
AD1
AD2
AD3
AD4
AD5
B02
B05
B11
F01
F02
F03
F06

Average Potential Energy of Ligands
VDW
Coul
PB
-1.8 (0.0063) -8.5 (0.0012) -4.6 (0.0014)
-2.5 (0.0049) 36.3 (0.0036) -55.9 (0.0028)
-3.0 (0.0058) 29.0 (0.0028) -54.6 (0.0028)
-4.1 (0.0056) 145.8 (0.0124) -183.9 (0.0089)
-2.4 (0.0052) 25.6 (0.0032) -56.1 (0.0030)
1.9 (0.0103) -13.6 (0.0032) -9.1 (0.0025)
-1.7 (0.0069) 108.3 (0.0081) -179.2 (0.0055)
-7.2 (0.0116) 477.0 (0.0132) -484.1 (0.0106)
-6.0 (0.0036) 33.1 (0.0059) -9.5 (0.0036)
-6.5 (0.0055) 63.1 (0.0069) -53.4 (0.0037)
-5.5 (0.0078) 54.1 (0.0069) -49.8 (0.0035)
-6.4 (0.0101) 120.0 (0.0109) -142.3 (0.0064)

Val
328.2 (2.651)
328.5 (1.710)
333.8 (1.950)
348.1 (4.394)
331.6 (1.565)
340.6 (3.270)
340.4 (0.896)
379.8 (5.364)
515.7 (4.767)
514.2 (2.068)
518.1 (3.448)
525.4 (4.787)

5.8
5.8
5.8
6.1
5.8
5.8
5.8
7.3
5.8
5.9
5.9
6.1

Val
52.6 (0.0232)
53.8 (0.0246)
58.8 (0.0259)
65.6 (0.0291)
55.9 (0.0245)
58.7 (0.0257)
62.1 (0.0270)
104.8 (0.0268)
226.5 (0.0251)
234.6 (0.0268)
238.0 (0.0286)
253.6 (0.0341)

NP
(0.011)
(0.017)
(0.009)
(0.070)
(0.025)
(0.021)
(0.012)
(0.075)
(0.016)
(0.012)
(0.015)
(0.012)

2.0
2.0
2.1
2.5
2.0
2.2
2.3
4.4
2.2
2.6
2.6
3.3

Total
162.8 (2.400)
149.2 (1.464)
147.4 (2.231)
144.4 (2.685)
142.5 (1.624)
167.8 (2.014)
112.1 (1.440)
217.0 (4.393)
390.4 (3.989)
368.1 (2.086)
371.7 (3.320)
343.9 (4.044)

NP
(0.0001)
(0.0001)
(0.0001)
(0.0001)
(0.0001)
(0.0001)
(0.0001)
(0.0002)
(0.0001)
(0.0002)
(0.0001)
(0.0002)

Total
39.7 (0.0236)
33.7 (0.0248)
32.4 (0.0264)
25.9 (0.0270)
25.0 (0.0248)
40.1 (0.0255)
-8.2 (0.0273)
94.8 (0.0232)
246.4 (0.0258)
240.4 (0.0270)
239.4 (0.0284)
228.1 (0.0339)

Average Potential Energy of the Receptor
VDW
Coul
PB
Val
NP
Total
-55.9 (0.2198) 59.2 (0.5253) -131.8 (0.3756) 280.6 (0.8513) 6.3 (0.0039) 158.4 (0.8516)

Ligand
AD1
AD2
AD3
AD4
AD5
B02
B05
B11
F01
F02
F03
F06

Average
VDW
-32.5 (0.471)
-33.6 (0.931)
-32.8 (0.718)
-38.1 (1.400)
-33.3 (1.374)
-33.3 (0.622)
-32.9 (0.896)
-39.9 (1.192)
-26.2 (0.497)
-26.9 (1.518)
-28.7 (0.832)
-35.1 (1.154)

Potential Energy Changes
Coul
PB
0.1 (1.509)
4.8 (1.547)
-65.8 (1.032) 64.9 (0.783)
-64.4 (0.693) 62.2 (0.855)
-125.2 (3.283) 124.4 (1.003)
-65.1 (1.549) 64.8 (1.415)
-5.8 (1.067) 9.7 (0.770)
-138.2 (1.231) 138.0 (1.151)
-199.3 (2.280) 212.0 (1.066)
-8.2 (1.824) 14.2 (1.119)
-65.7 (2.078) 65.9 (0.923)
-58.0 (0.987) 64.2 (0.649)
-116.1 (0.810) 120.9 (0.651)

Val
-5.0 (2.785)
-5.9 (1.910)
-5.7 (2.128)
1.9 (4.475)
-4.9 (1.782)
1.4 (3.379)
-2.3 (1.236)
-5.6 (5.431)
8.7 (4.842)
-0.9 (2.237)
-0.4 (3.552)
-8.8 (4.862)

TABLE SII.
Estimates of the mean potential energy
(kcal/mol) of the ligand, receptor, and complex for different
Cu[7] ligands. The columns refer to van der Waals (VDW),
coulomb (Coul), electrostatic solvation (PB), valence (Val,
bond + angle + dihedral), nonpolar solvation (NP), and total
energies. The value in the parentheses is the standard deviation from bootstrapping: the observable is estimated based
on 1000 random selections of 100 values of Θ̂.

NP
-2.5 (0.011)
-2.5 (0.017)
-2.6 (0.009)
-2.7 (0.070)
-2.5 (0.025)
-2.7 (0.022)
-2.8 (0.013)
-3.4 (0.075)
-2.7 (0.017)
-3.0 (0.012)
-3.0 (0.015)
-3.5 (0.013)

Total
-35.2 (2.547)
-42.9 (1.693)
-43.4 (2.388)
-39.9 (2.817)
-40.9 (1.834)
-30.6 (2.187)
-38.1 (1.673)
-36.2 (4.475)
-14.3 (4.079)
-30.6 (2.253)
-26.1 (3.428)
-42.6 (4.132)

17

AD1
B(rR)

−25

−30

−28.5

−30.7

−30.3

−90.3

−31

−91

−116.5

−117.2
BRL

−91.7

BRL

−31.7

−120

−117.5

−2.5

−53.6

−2.7
−2.8
−26.5

min{Ψ(rRL)}

min{Ψ(rRL)}

BL

−117.9

BL

−123.5

−30
−33.5
0

0.5
1
1.5
Total Simulation Time (ns)

−54
−34.6
−36
−37.4
0

−25

−33.4

−28.5

−92.3

−145.8

−93

−147.5

−116.2

−176.5
BRL

−149.3

BRL

−93.7

−116.5

−180

−183.5

−52.2

−175.8
BL

−116.9
−52.5

−177.5
−179.3

−52.9
−38.6

min{Ψ(rRL)}

BL

2

AD4

−21.5
B(rR)

−32

0.5
1
1.5
Total Simulation Time (ns)

Bcpl

B(rR)
Bcpl

−53.8

2

AD3

−30.6

min{Ψ(rRL)}

AD2

−29.3

Bcpl

Bcpl

B(rR)

−21.5

−40
−41.4
0

0.5
1
1.5
Total Simulation Time (ns)

2

FIG. S1. (a) The mean and standard deviation of 15 independent estimates of B(rR ), Bcpl , BRL , BL , and min{Ψ(rRL )}
(kcal/mol) based on PBSA energies as a function of total MD
simulation time.

−31.5
−35
−38.5
0

0.5
1
1.5
Total Simulation Time (ns)

2

18

AD5
B(rR)

−28

−20

−29.4

−27

−88.6

−23

−90

−30

−117.3

−116.5
BRL

−37

BRL

−91.4

−118

−120

−53.7

−6.6

−54.4
−34.6

min{Ψ(rRL)}

min{Ψ(rRL)}

BL

−123.5

BL

−118.7

−54

−36
−37.4
0

0.5
1
1.5
Total Simulation Time (ns)

−7
−26.5
−30
−33.5
0

−20

−216.5
Bcpl

−151.5
Bcpl

−23.5

−393
BRL

−166.6
BRL

−223.5

−400

−175.3

−471.5
BL

−407

BL

−169.4

−176

−475

−478.5
min{Ψ(rRL)}

−176.7
min{Ψ(rRL)}

B11

−220

−158.5

−168

2

−20

−23.5

−155

0.5
1
1.5
Total Simulation Time (ns)

−16.5
B(rR)

B(rR)

−6.8

2

B05

−16.5

B02

−13

Bcpl

Bcpl

B(rR)

−26.6

−30.8
−32.5
−34.3
0

0.5
1
1.5
Total Simulation Time (ns)

2

FIG. S1. (b) The mean and standard deviation of 15 independent estimates of B(rR ), Bcpl , BRL , BL , and min{Ψ(rRL )}
(kcal/mol) based on PBSA energies as a function of total MD
simulation time.

−26
−40
−54
0

0.5
1
1.5
Total Simulation Time (ns)

2

19

F01
B(rR)

−10

−21.5

−82.6
Bcpl

−23.5

−73

−88.6
BRL

−85.4

−80

−91.4

28.7

−29.3

28

min{Ψ(rRL)}

min{Ψ(rRL)}

−13
−20
−27
0.5
1
1.5
Total Simulation Time (ns)

−26.5
−30
−33.5

2

0

F03
B(rR)

−20

−80.6

−144.6
Bcpl

−27.4

−86.5

−132.3
BRL

−147.4

−133

−93.5

−133.7

−26.6

−125.3

−28

F06

−146

−83.4

−90

−126

−126.7
min{Ψ(rRL)}

−29.4

2

−26

−21.4

−82

0.5
1
1.5
Total Simulation Time (ns)

−24.6

BL

B(rR)
Bcpl

−30
−30.7

−18.6

BRL

−90

−87

0

BL

−84

−28.5

27.3

min{Ψ(rRL)}

−20

−17

−25

F02

−16.5

BL

BL

BRL

Bcpl

B(rR)

−3

−28.6
−30
−31.4
0

0.5
1
1.5
Total Simulation Time (ns)

2

FIG. S1. (c) The mean and standard deviation of 15 independent estimates of B(rR ), Bcpl , BRL , BL , and min{Ψ(rRL )}
(kcal/mol) based on PBSA energies as a function of total MD
simulation time.

−34.6
−36
−37.4
0

0.5
1
1.5
Total Simulation Time (ns)

2

20

30

AD1

40

AD2

20
20
10
0
−30
40

−25

−20

−15

−10

−5
AD3

0
−35
30

−30

−25

−20

−15

−10
AD4

20
20
10
0
−35
40

−30

−25

−20

−15

0
−10 −40
20
AD5

20

0
−35
20

−30

−25

−20

−15

−10

−5
B05

0
−25
20

−26

−24

−22

−20

−18

0
−16 −30
30
F01
20

10

10

−10

−5

0

5

0
10 −25
30
F03

20

20

10

10

0
−20

−10

0
B02

−20

−15

−10
B11

10

20

0
−15
30

−20

10

10

0
−28
30

−30

−15

−10

−5

0

5

0
−30

FIG. S2.
Histogram of binding PMF estimates B̂(rR )
(kcal/mol) of various ligands to 100 snapshots of Cu[7], using PBSA energies. The vertical line shows the mean binding
PMF for the minimized receptor structure.

−25

−20

−20

−15

−20

−15

−10

−10

−10

−5

0

0

−5
F02

5
F06

10

21

AD1

−14.8

−19.2
−20

−21.2
−18.9

−20.8
−24.2

AD2

−18

−25

−26.1
−20.8

−25.8
−25.2

AD3

−22.5

−26

−27.2
−17.1

−26.8
−23.5

AD4

−24

−25.5

−25.9
−18.7

−27.5
−23.2

AD5

−21.5

−24

−24.3
−13.6

−24.8
−17.2

B02

−21.5

−18

−18.4
−16.6

−18.8
−20.2

B05

−16

−21

−21.4
−12.1

−21.8
−18.4

B11

−19

−20

−20.9
−1

−21.6
−6.3

F01

−16.5

−7.5

−8.1
−6.9

−8.7
−12.4

−10.5

−14

−14.1
−6

−15.6
−12.2

F03

F02

−4.5

−13

−14
−10.1

−13.8
−17.4

F06

−10

−14.5

−19

−18.9
0

5
10
15
Number of Receptor Snapshots

20

−20.6
20

FIG. S3. Estimates of the binding free energy ∆G◦ of various
ligands to Cu[7] (kcal/mol), using PBSA energies, as a function of the number of receptor snapshots. The line and error
bars denote the mean and standard deviation from bootstrapping: the binding free energy is estimated 100 times using
random selections of N out of 100 binding PMFs.

40
60
80
Number of Receptor Snapshots

100

30

AD1

60

20

40

10

20

0
−30
40

−25

−20

−15

−10

−5
AD3

0
−35
30

AD2

−30

−25

−20

−15

−10
AD4

20
20
10
0
−35
40

−30

−25

−20

−15

0
−10 −40
20
AD5

20

0
−35
20

−30

−25

−20

−15

−10

−5
B05

0
−25
20

−26

−24

−22

−20

−18

0
−16 −30
30
F01
20

10

10

−10

−5

0

5

0
10 −25
30
F03

20

20

10

10

0
−20

−10

0
B02

−20

−15

−10
B11

10

20

0
−15
30

−20

10

10

0
−28
30

−30

−15

−10

−5

0

5

0
−30

−25

−20

−20

−15

−20

−15

−10

−10

−10

−5

0

0

−5
F02

5
F06

10

