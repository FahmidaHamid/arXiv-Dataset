Symmetry, Integrability and Geometry: Methods and Applications

SIGMA 11 (2015), 022, 21 pages

Dynamics on Networks of Manifolds
Lee DEVILLE and Eugene LERMAN
Department of Mathematics, University of Illinois, USA
E-mail: rdeville@illinois.edu, lerman@illinois.edu
URL: http://www.math.illinois.edu/~rdeville/,
http://www.math.illinois.edu/~lerman/

arXiv:1208.1513v4 [math.DS] 12 Mar 2015

Received April 24, 2014, in final form February 24, 2015; Published online March 12, 2015
http://dx.doi.org/10.3842/SIGMA.2015.022
Abstract. We propose a precise definition of a continuous time dynamical system made up
of interacting open subsystems. The interconnections of subsystems are coded by directed
graphs. We prove that the appropriate maps of graphs called graph fibrations give rise to
maps of dynamical systems. Consequently surjective graph fibrations give rise to invariant
subsystems and injective graph fibrations give rise to projections of dynamical systems.
Key words: coupled cell networks; open dynamical systems; control systems; morphisms of
dynamical systems
2010 Mathematics Subject Classification: 34C14; 18D99

1

Introduction

Given a dynamical system, one often starts by trying to find invariant subsystems; these include equilibria, periodic orbits, and higher dimensional invariant submanifolds. In addition,
constructing projections onto smaller systems as well as conjugacies and semi-conjugacies with
simpler systems are generally useful for understanding the qualitative properties of dynamical systems. All of these objects: invariant subsystems, projections, conjugacies and semiconjugacies can be realized as maps of dynamical systems (q.v. Definition 2.1). Thus the search
for maps between dynamical systems may be considered one of the fundamental questions of
the subject.
In this paper we give a precise definition of a continuous time dynamical system made up
of interacting open subsystems. We then exploit the combinatorial aspect of such systems to
produce maps of dynamical systems out of appropriate maps of graphs called graph fibrations
(q.v. Definition 3.1). We show that in particular surjective graph fibrations give rise to invariant
subsystems and injective graph fibrations give rise to projections of dynamical systems.
The present work is part of an ongoing project. In [5] we reformulated the groupoid formalism
of Golubitsky, Pivato, Stewart and Török [7, 8] for coupled cell networks (which are systems
of ordinary differential equations) in a coordinate free manner and extended it to groupoidinvariant vector fields on manifolds. A preliminary version was posted as [4]. We later realized
that groupoid invariance of vector fields is not needed for the existence of invariant subspaces.
With the benefit of hindsight we see that the theory developed in [5] is an equivariant version of
the theory that we develop here. We would like to point out that dropping groupoid invariance
makes the theory much simpler and more flexible. In particular we expect the results of this
paper to readily generalize to hybrid systems.
The absence of explicit groupoid symmetries makes our work close in spirit to the approach
to dynamics on networks advocated by Field [6]. Unlike Field we find it convenient to use
the language of category theory. We also find it useful to borrow the notions of open systems
and their interconnection from engineering (see, for example [3, 9, 12]) and the definition of

2

L. DeVille and E. Lerman

a graph fibration from computer science [2] (see [11] for a history of the notion and alternative
terminologies).
We believe that both Field’s approach and ours is based on the existence of a certain algebraic
structure which at the present time is not completely understood. Open continuous time systems
form an algebra over a certain operad [10]. This operad is implicit in the work of Field [6]. A piece
of this algebra shows up in our work as the interconnection maps (see Theorem 2.32). We do
not understand yet how graph fibrations interact with this operad and plan to address this issue
in a future work.
The goal of this paper is to construct a category of networks of continuous time systems and
a functor to the category of dynamical systems. A network in our sense consists of
• a finite directed graph G with a set of nodes G0 ,
• a phase space function P that assigns to each node of the graph an appropriate phase
space (which we take to be a manifold),
• a family of open systems {wa }a∈G0 (one for each node a of the graph G) consistent in an
appropriate way with the structure of the graph, and
• an
dinterconnection map I that turns these open systems into a vector field on the product
P(a) of the phase spaces of the nodes.
a∈G0

Our main result, Theorem 3.11, shows that graph fibrations compatible with phase space functions give rise to maps of dynamical systems. This allows us to define a functor from dynamical
systems on networks to general dynamical systems.
The reader may wonder what motivates us to come up with these definitions and constructions. Indeed there are many different kinds of objects in engineering, science and mathematics
that are called “networks”. The notion of a network in the present paper arose from the following idea, which is implicit in the literature on coupled cell networks. Imagine a physical system
modeled by a vector field X on a manifold M ; M is the collection of all possible states of the
system. Such systems are common in classical mechanics, to give one example. Suppose further
that our system consists of two interacting subsystems. We can model this by saying that the
collection of states of the first subsystem forms a manifold M1 and the second a manifold M2 .
We would like the states of the big system to be completely determined by the states of its
subsystems. We model this by requiring that M = M1 × M2 . A vector field X on M1 × M2
then has to be of the form
X(x1 , x2 ) = (X1 (x1 , x2 ), X2 (x1 , x2 )),
where
X1 (x1 , x2 ) ∈ Tx1 M1

for all

(x1 , x2 ) ∈ M1 × M2 ,

with a similar equation holding for X2 : M1 × M2 → T M2 . Note that the functions X1 , X2 are
not vector fields. They are open systems in the sense of Definition 2.22. Moreover the vector
field X may be considered to be a result of interconnecting X1 and X2 (see Proposition 2.24
and Theorem 2.32).
To continue with our example, observe that the evolution of the subsystem 1 depends on its
state and the state of the subsystem 2. Similarly the evolution the second subsystem depends on
its state and the state of the subsystem 1. These mutual influences can be pictured graphically as
x

M1
7

M2 .

Dynamics on Networks of Manifolds

3

Assume now that the map X2 does not really depend on the points of M1 . That is, there is
a map Y : M2 → T M2 with Y (x2 ) ∈ Tx2 M2 and X2 (x1 , x2 ) = Y (x2 ) for all (x1 , x2 ) ∈ M1 × M2 .
We can picture this as
M1 o

M2

and say that the second subsystem drives the first but not conversely. This way of picturing
a system made up of interacting subsystems generalizes to any number of subsystems. For
example, a system may be made up of three interacting subsystems like this:
x

M1
8

/ M3 .

M2

(1.1)

The total phase space of such a system would be the product M = M1 × M2 × M3 and the
dynamics would be governed by a vector field X of the form
X(x1 , x2 , x3 ) = (X1 (x1 , x2 ), X2 (x2 , x1 ), X3 (x3 , x2 )).
|

How are we then to interpret the diagram of the form M
? And why would we want to?
Here is a two part answer. We interpret this diagram as a vector field X on the manifold M of
the form
X(x) = w(x, x),
where w : M × M → T M is an open system with w(x1 , x2 ) ∈ Tx1 M for all (x1 , x2 ) ∈ M × M .
This seems a bit strange and pedantic, but it is useful. Consider a vector field Z on M × M × M
of the form
Z(x1 , x2 , x3 ) = (w(x1 , x2 ), w(x2 , x1 ), w(x3 , x2 )),
where w is the open system above. The vector field Z on M models the dynamics of a system
consisting of three interacting subsystems with the first driving the second, the second driving
the first and the third just as in (1.1), only now all the subsystems have isomorphic phase spaces.
It is not hard to check that the diagonal
∆M := {(x1 , x2 , x3 ) ∈ M × M × M | x1 = x2 = x3 }
is an invariant submanifold for the vector field Z. According to the philosophy we brought up
in the first paragraph of the paper the invariance of ∆M should be seen as coming from a map
of dynamical systems. And indeed the diagonal map
δ : M → M × M × M,

δ(x) = (x, x, x)

gives rise to a map of dynamical systems δ : (M, X) → (M × M × M, Z). The main result of
the paper, Theorem 3.11, implies that this map of dynamical systems is induced by the map of
graphs
ϕ
1

2

3

which is a graph fibration. We note that the vector field Z has groupoid symmetry in the sense
of Golubitsky et al. [7, 8] and [5]. For us, however, the groupoid invariance of Z is, in some sense,

4

L. DeVille and E. Lerman

incidental. It is a consequence of the fact that Z is assembled out of the triple of open systems
which lies in the image of the map ϕ∗ of Theorem 3.8 and that ϕ happens to be surjective.
The paper is organized as follows. We start by defining the category DS of continuous time
dynamical systems. We recall the definition of a directed multigraph, define the notion of
a network of manifolds and the total space of the network. We recall the notion of an open
system and discuss interconnections of open systems. We show how a network of manifolds
naturally leads to a collection of spaces of open systems that can be interconnected. We then
prove our main result, Theorem 3.11: fibrations of networks of manifolds give rise to maps of
dynamical systems. We end the paper with a collection of examples.

2

Definitions and constructions

We start by defining what we mean by a continuous time dynamical system and by a map
between two such systems.
Definition 2.1. A continuous time dynamical system is a vector field on a manifold. More
formally it is a pair (M, X), where X is a vector field on a manifold M .
A map from a dynamical system (M, X) to a dynamical system (N, Y ) is a smooth map
f : M → N that intertwines the two vector fields:
Df ◦ X = Y ◦ f,
where Df : T M → T N denotes the differential of f . One also says that the vector fields X
and Y are f -related.
Notation 2.2 (the category DS of dynamical systems). Continuous time dynamical systems
and maps of dynamical systems form a category. We denote it by DS.

2.1

Graphs and manifolds

Throughout the paper graphs are finite directed multigraphs, possibly with loops. More precisely, we use the following definition:
Definition 2.3. A graph G consists of two finite sets G1 (of arrows, or edges), G0 (of nodes, or
vertices) and two maps s, t : G1 → G0 (source, target); we write
G = {G1 ⇒ G0 }.
The set G1 may be empty, i.e., we may have G = {∅ ⇒ G0 }, making G a disjoint collection of
vertices with no arrows between them.
Definition 2.4. A map of graphs ϕ : A → B from a graph A to a graph B is a pair of maps
ϕ1 : A1 → B1 , ϕ0 : A0 → B0 taking edges of A to edges of B, nodes of A to nodes of B so that
for any edge γ of A we have
ϕ0 (s(γ)) = s(ϕ1 (γ))

and

ϕ0 (t(γ)) = t(ϕ1 (γ)).

We often omit the indices 0 and 1 and write ϕ(γ) for ϕ1 (γ) and ϕ(a) for ϕ0 (a).
Remark 2.5. The collection of finite (directed multi-)graphs and maps of graphs form a category Graph.
In order to construct networks from graphs we need to have a consistent way of assigning
manifolds to nodes of our graphs. We formalize this idea by making the collection of graphs
with manifolds assigned to vertices into a category Graph/Man.

Dynamics on Networks of Manifolds

5

Definition 2.6 (category of networks of manifolds Graph/Man). A network of manifolds is a pair
(G, P), where G is a (finite directed multi-)graph and P : G0 → Man is a function that assigns
to each node a of G a manifold P(a). We think of P as an assignment of phase spaces to the
nodes of the graph G, and for this reason we refer to P as a phase space function.
Networks of manifolds form a category Graph/Man. Its objects are are pairs (G, P) as above.
A morphism ϕ from (G, P) to(G0 , P 0 ) is a map of graphs ϕ : G → G0 with
P 0 ◦ ϕ = P.
Notation 2.7. Given a category C we denote the opposite category by C op , i.e. the category
with all of the same objects and all of the arrows reversed. We adhere to the convention that
a contravariant functor from a category C to a category D is a covariant functor
F : C op → D.
F (γ)

γ

Then for any morphism c −
→ c0 of C we have F (c) ←−−− F (c0 ) in D.
Next we recall the notion of a product in a category C . We will use them in two instances:
when C is the category Man of smooth finite dimensional manifolds and smooth maps and
when C is the category Vect of real (but not necessarily finite dimensional) vector spaces and
linear maps.
Definition
d C indexed by a set S is
d 2.8. A product of a family {cs }s∈S of objects in a category
0
an object s0 ∈S cs of C together with a family of morphisms {πs : s0 ∈S cs0 → cs }s∈S with the
following universal property: given andobject c0 of C and a family of morphisms {fs : c0 → cs }s∈S
there is a unique morphism f : c0 → s∈S cs with
πs ◦ f = fs

for all

s ∈ S.

Remark 2.9. If a product exists then it is unique up to a unique isomorphism [1].
Lemma 2.10. The category of manifolds Man has (finite) categorical products.
Proof . There are several ways to construct categorical products in Man. The first one uses
Cartesian products: given a family {Ms }s∈S of manifolds indexed by an n-element set S, order
the elements of S: S = {s1 , . . . , sn }. Set
l
s∈S

Ms =

n
Y

Ms i ,

i=1

where the right hand side is the Cartesian product. The projections psj :

n
Q

Msi → Msj are just

i=1

projections on the j-th factor. It is easy to check that a product constructed this way has the
requisite universal property. In particular, if we choose two different orderings of elements of S,
the resulting products are canonically isomorphic. This construction is convenient for writing
down examples.
However, for proving the results below, such as Proposition 2.15, it is better to have a construction of the product that does not involve a choice of ordering of the indexing set
F in question.
This may be done as follows. Given a family {Ms }s∈S of manifolds, denote by s∈S Ms their
disjoint union1 . Now define



l
G


Ms := x : S →
Ms  x(s) ∈ Ms for all s ∈ S .
s∈S

1

It may be defined by

s∈S

F
s∈S

Ms =

S
s∈S

Ms × {s}.

6

L. DeVille and E. Lerman

The projection maps πs :

d

Ms0 → Ms are defined by

s0 ∈S

πs (x) = x(s).
d
We denote x(s) ∈ Ms by xs and think of it as the sth “coordinate” of an element x ∈
Ms .
s∈S
d
Equivalently we may think of elements of the categorical product s∈S Ms as unordered tuples
(xs )s∈S with xs ∈ Ms .

Lemma 2.11. The category of vector spaces Vect has finite categorical products.
Sketch of proof . Just as in the proof of Lemma 2.10 the finite products in Vect can be constructed as vector spaces of ordered tuples of vectors, that is, as Cartesian products. Categorical
products in Vect can also be constructed as unordered tuples of vectors.

Definition 2.12 (total phase space of a network (G, P)). For a pair (G, P) consisting of a finite
graph G and an assignment P : G0 → Man, that is, for an object (G, P) of Graph/Man we set
l
PG ≡ P(G, P) :=
P(a),
a∈G0

the categorical product of manifolds attached to the nodes of the graph G by the phase space
function P and call the resulting manifold PG the total phase space of the network (G, P).
Example 2.13. Consider the graph
β

G= a

b
α

Define P : G0 → Man by P(a) = S 2 (the two sphere) and P(b) = S 3 . Then
P(G, P) = S 2 × S 3 .
Notation 2.14. If G = {∅ ⇒ {a}} is a graph with one node a and no arrows, we write G = {a}.
Then for any phase space function P : G0 = {a} → Man we abbreviate P({∅ ⇒ {a}}, P : {a} →
Man) as Pa.
Proposition 2.15. The assignment
l
(G, P) 7→ PG :=
P(a)
a∈G0

of phase spaces to networks extends to a contravariant functor
P : (Graph/Man)op → Man.
Proof . Suppose ϕ : (G, P) → (G0 , P 0 ) is a morphism in Graph/Man. That is, suppose ϕ : G →
G0 is a map of graphs with P 0 ◦ ϕ = P. We need to define a map of manifolds
Pϕ : PG0 → PG.
Since by definition PG is the product

d

P(a), the universal property of products implies that

a∈G0

in order to define Pϕ it is enough to define a family of maps

	
(Pϕ)a : PG0 → P(a) a∈G0 .

Dynamics on Networks of Manifolds

7

For any node a0 of G0 we have the canonical projection
πa0 0 : PG0 → P 0 (a0 ).
We therefore define
(Pϕ)a := πϕ0 a : PG0 → P 0 (ϕ(a)) = P(a)
for all a ∈ G0 . By the universal property of the product PG =

d

P(a) this defines the desired

a∈G0

map Pϕ : PG0 → PG.
The universal property of products also implies that the map P on morphisms of Graph/Man
as defined above is actually a functor. That is,
P(ψ ◦ ϕ) = Pϕ ◦ Pψ
for any pair (ψ, ϕ) of composable morphisms in Graph/Man.



Remark 2.16. Proposition 2.15 is an instance of a category-theoretic result that holds in greater
generality. Namely, given a category C with finite products consider the category FinSet/C
whose objects are pairs (X, P ), where X is a finite set and P is a function that assignes to each
element of X an object of C . The morphisms are commuting triangles. There is a contravariant
functor P : (FinSet/C )op → C which on objects is given by
l
P(X, P ) =
P (x).
x∈X

Example 2.17. Suppose G is a graph with two nodes a, b and no edges, G0 is a graph with one
node {c} and no edges, P 0 (c) is a manifold M , and ϕ : G → G0 is the only possible map of graphs
(it sends both nodes to c). Suppose further that P : G0 → Man is given by P(a) = M = P(b)
(so that P 0 ◦ ϕ = P). Then PG0 ' M ,
PG = {(xa , xb ) | xa ∈ P(a), xb ∈ P(b)} ' M × M,
and Pϕ : M → M × M is the unique map with (Pϕ(x))a = x and (Pϕ(x))b = x for all x ∈ PG0 .
Thus Pϕ : M → M × M is the diagonal map x 7→ (x, x).
Example 2.18. Let (G, P), (G0 , P 0 ) be as in Example 2.17 above and ψ : (G0 , P 0 ) → (G, P) be
the map that sends the node c to a. Then Pψ : PG → PG0 is the map that sends (xa , xb ) to xa .
Remark 2.19. If (G, P) is a graph with a phase function, that is, an object of Graph/Man, and
ϕ : H → G a map of graphs then P ◦ϕ : H → Man is a phase function and ϕ : (H, P ◦ϕ) → (G, P)
is a morphism in Graph/Man. We then have a map of manifolds
Pϕ : P(H, P ◦ ϕ) → P(G, P).
Similarly, a commutative diagram
j

K
ψ



G

/H
 ϕ

of maps of graphs and a phase space function P : G → Man give rise to the commutative diagram
of maps of manifolds
P(K, P ◦ ψ) o

Pj

_

P(H, P ◦ ϕ)
?

Pϕ

Pψ

P(G, P)

8

L. DeVille and E. Lerman

2.2

Embeddings and submersions from maps of graphs

As we said in the introduction, the main goal of this paper is to construct maps of dynamical systems from graph fibrations. In Proposition 2.15 we showed that a map of networks
ϕ : (G, P) → (G0 , P 0 ) defines a map of manifolds Pϕ : P(G0 , P 0 ) → P(G, P). In this subsection
we prove that:
1) If the map of graphs ϕ : G → G0 is injective on nodes, then Pϕ is a surjective submersion,
2) if the map of graphs ϕ : G → G0 is surjective on nodes, then Pϕ is an embedding.
(Recall that a smooth map between two manifolds is a submersion if its differential is onto at
every point. A smooth map between two manifolds is an embedding if it is 1-1, its differential is
1-1 everywhere and it is a homeomorphism onto its image.) Combined with Theorem 3.11 below,
this shows that surjective fibrations of networks of manifolds give rise to invariant dynamical
subsystems and injective fibrations give rise to projections of dynamical systems.
Lemma 2.20. Suppose ϕ : (G, P) → (G0 , P 0 ) is a map of networks of manifolds such that the
map on nodes, ϕ0 : G0 → G00 , is surjective. Then Pϕ : PG0 → PG is an embedding whose image
is the “polydiagonal”
∆ϕ = {x ∈ PG | xa = xb whenever ϕ(a) = ϕ(b)}.
Proof . Assume first for simplicity that G0 has only one vertex ∗ and P 0 (∗) = M . Then for any
vertex a of G we have
P(a) = P 0 (ϕ(a)) = P 0 (∗) = M,
PG0 = M and PG = M × · · · × M (|G0 | copies), where as before G0 is the set of vertices of the
graph G. In this case the proof of Proposition 2.15 shows that the map Pϕ : M → M G0 is of
the form
Pϕ(x) = (x, . . . , x)
for all x ∈ M . This is clearly an embedding. In general,


l
l
l

Pϕ : PG0 =
P 0 (a0 ) →
P(a) = PG
a0 ∈G00

a0 ∈G00

a∈ϕ−1 (a0 )

is the product of maps of the form
l
P 0 (a0 ) →
P(a),
x→
7 (x, . . . , x).



a∈ϕ−1 (a0 )

Lemma 2.21. Suppose ϕ : (G, P) → (G0 , P 0 ) is a map of networks of manifolds such that the
map ϕ0 : G0 → G00 on nodes is injective. Then Pϕ : PG0 → PG is a surjective submersion.
Proof . Since ϕ : G → G0 is injective, the set of nodes G00 of G0 can be partitioned as the disjoint
union of the image ϕ(G0 ), which is a copy of G0 , and the complement. Hence
l
l
l
PG0 '
P(ϕ(a)) ×
P 0 (a0 ) ' PG ×
P 0 (a0 ).
a∈G0

a0 6∈ϕ(G0 )

a0 6∈ϕ(G0 )

With respect to this identification of PG0 with PG ×

d

a0 6∈ϕ(G0 )

P 0 (a0 ) the map Pϕ : PG0 → PG is

the projection
PG ×

l

P 0 (a0 ) → PG.

a0 6∈ϕ(G0 )

which is a surjective submersion.



Dynamics on Networks of Manifolds

2.3

9

Open systems and their interconnections

Having set up a consistent way of assigning phase spaces to graphs, we now take up continuous
time dynamical systems. We start by recalling a definition of an open (control) systems, which
is essentially due to Brockett [3]. It is not the most general definition; it is more than enough
for this paper.
Definition 2.22. A continuous time control system (or an open system) on a manifold M
is a surjective submersion p : Q → M from some manifold Q together with a smooth map
F : Q → T M so that
F (q) ∈ Tp(q) M
Q
for all q ∈ Q. That is, the diagram

F
p

/ TM
π
commutes. Here π : T M → M is the canonical
& 

M

projection.
Definition 2.23 (Control(M × U → M )). Given a manifold M of “state variables” and a manifold U of “control variables” we may consider control systems of the form
F : M × U → T M,

F (x, u) ∈ Tx M

for all

(x, u) ∈ M × U.

The collection of all such control systems forms a vector space Control(M × U → M ). Explicitly
Control(M × U → M ) := {F : M × U → T M | F (x, u) ∈ Tx M for all (x, u) ∈ M × U }.
Now suppose we are given a finite family {Fi : Mi × Ui → T Mi }N
i=1 of control systems and we
want to somehow interconnect
them
to
obtain
a
closed
system
I
(F
1 , . . . , FN ), that is, a vector
d
field on the product i Mi . What additional data do we need to define the interconnection map
  l 
l
I:
Control(Mi × Ui → Mi ) → Γ T
Mi
?
i

i

An answer is given by the following proposition:
Proposition 2.24. Given a familyd{pj : Mj × Uj → Mj }N
j=1 of projections on the first factor
and a family of smooth maps {sj : Mi → Mj × Uj } so that the diagrams
Mj × Uj
O

sj

d

Mi

pj

%
prj

/ Mj

commute for each index j, there is an interconnection map I making the diagrams
d

i Control(Mi

× U i → Mi )

I



Control(Mj × Uj → Mj )

Ij

/ Γ(T ( Mi ))
i

d

/ Control(

 $j =D(prj )◦−

d

i Mi

prj

−−→ Mj )

commute for each j. The components
Ij of the interconnection map I are defined by Ij (Fj ) :=
d
Fj ◦sjdfor all j, where D(prj ) : T Mi → T Mj denotes the differential of the canonical projection
prj : Mi → Mj .

10

L. DeVille and E. Lerman

d
d
Proof . The space
d of vector fields Γ (T ( i Mi )) on the product i Mi is the product of vector
spaces Control( i Mi → Mj ):
  l  l
l

prj
Γ T
=
Control
Mi
Mi −−→ Mj .
i

j

i

In other words a vector field X on the product

d

i Mi

is a tuple X = (X1 , . . . , XN ), where

Xj := D(prj ) ◦ X.
d
Each component Xj : i Mi → T Mi is a control system.
To define a map from a vector space into a product of vector spaces it is enough to define
a map into each of the factors. We have canonical projections
l
πj :
Control(Mi × Ui → Mi ) → Control(Mj × Uj → Mj ),
j = 1, . . . , N.
i

Consequently to define the interconnection map I it is enough to define the maps
l

prj
Ij : Control(Mj × Uj → Mj ) → Control
Mi −−→ Mj .
i

d
prj
for each index j. We therefore define the maps Ij : Control(Mj ×Uj → Mj ) → Control( i Mi −−→
Mj ), 1 ≤ j ≤ N , by
Ij (Fj ) := Fj ◦ sj .



Remark 2.25. It will be useful for us to remember that the canonical projections
 l 
l

$j : Γ T
Mi → Control
Mi → Mj
are given by
$j (X) = D(prj ) ◦ X,
wheredas before D(prj ) : T
prj : Mi → Mj .

2.4

d

Mi → T Mj are the differentials of the canonical projections

Interconnections and graphs

We next explain how finite directed graphs whose nodes are decorated with phase spaces, that
is, networks of manifolds in the sense of Definition 2.6 give rise to interconnection maps. To
do this precisely it is useful to have a notion of input trees of a directed graph. This notion is
a generalization of the notion of an input set of Golubitsky et al. (op. cit.) [7, 8]. Given a graph,
an input tree I(a) of a vertex a is – roughly – the vertex itself and all of the arrows leading into
it. We want to think of this as a graph in its own right, as follows.
Definition 2.26 (input tree). Given a vertex a of a graph G we define the input tree I(a) to
be a graph with the set of vertices I(a)0 given by
I(a)0 := {a} t t−1 (a),
where, as before, the set t−1 (a) is the set of arrows in G with target a. The set of edges I(a)1
of the input tree is the set of pairs
I(a)1 := {(a, γ) | γ ∈ G1 , t(γ) = a},

Dynamics on Networks of Manifolds

11

and the source and target maps I(a)1 ⇒ I(a)0 are defined by
s(a, γ) = γ

and

t(a, γ) = a.

In pictures,
(a, γ)

γ

a

Example 2.27. Consider the graph
β

G= a

b
α

as in Example 2.13. Then the input tree I(a) is the graph with one node a and no edges:
I(a) = {a} (see Notation 2.14). The input tree I(b) has three nodes and two edges:
α
(b, α)
I(b) =

b
β

(b, β)

Notice that our definition of input tree “pulls apart” multiple edges coming from a common
vertex.
Remark 2.28. For each node a of a graph G we have a natural map of graphs
ξ = ξa : I(a) → G.
(a,γ)

γ

It is defined by sending the edge of the form γ −−−→ a to the edge s(γ) −
→ a. Note that the map
ξ need not be injective on vertices.
Proposition 2.29. Given a graph G with a phase space function P : G0 → Man, that is, a network (G, P) of manifolds, we have commutative diagrams of maps of manifolds
d

P(a) ×

PI(a)

P(s(γ))

Pja

γ∈t−1 (a)

O

Pξ

PG =

d

/
7 P(a)

Pa

Pιa

P(b)

b∈G0

for each node a of the graph G.
Proof . Let a be a node of the graph G. We then have a graph {a} with one node and no
arrows. Denote the inclusion of {a} in G by ιa and the inclusion into its input tree I(a) by ja .
Then the diagram of maps of graphs
{a}
ιa

ja

/ I(a)

  ξ

G

12

L. DeVille and E. Lerman

commutes. By Remark 2.19 we have a commuting diagram of maps of manifolds
P{a} o

Pja

Z

PI(a)
D

Pξ

Pιa

PG
Let us now examine more closely the map Pja : PI(a) → Pa.
Since the set of nodes I(a)0 of the input tree I(a) is the disjoint union
I(a)0 = {a} t t−1 (a),
and since ξa (γ) = s(γ) for any γ ∈ t−1 (a) ⊂ I(a)0 , we have
l
P(s(γ)).
PI(a) = P(a) ×
γ∈t−1 (a)

Since ja : {a} → I(a)0 = {a} t t−1 (a) is the inclusion,
Pja : PI(a) → Pa
is the projection
l
P(a) ×

P(s(γ)) → Pa.

γ∈t−1 (a)

Similarly
Pιa : PG → Pa
is the projection
l
P(b) → P(a).
b∈G0

The proposition follows from these two observations.
Example 2.30. Suppose
G=

a

b

is a graph as in Example 2.13 and suppose P : G0 → Man is a phase space function. Then
PI(b) ' P(a) × P(a) × P(b),
Pjb is the projection P(a) × P(a) × P(b) → P(b), and
Control(PI(b) → Pb) = Control(P(a) × P(a) × P(b) → P(b)).
On the other hand PI(a) = P(a), Pja : P(a) → P(a) is the identity map and
Control(PI(a) → Pa) = Γ(T P(a)),
the space of vector fields on the manifold P(a).



Dynamics on Networks of Manifolds

13

Notation 2.31. Given a network (G, P) of manifolds we have a product of vector spaces
Ctrl (G, P) :=

l

Control(PI(a) → Pa).

a∈G0

The elements of Ctrl (G, P) are unordered tuples of (wa )a∈G0 of
F control systems (q.v. Lemma 2.11). We may think of them as sections of the vector bundle
Control(PI(a) → Pa) → G0
a∈G0

over the vertices of G.
It is easy to see that Propositions 2.24 and 2.29 give us
Theorem 2.32. Given a network (G, P) of manifolds, there exists a natural interconnection
map
l
I:
Control(PI(a) → Pa) → Γ(T PG)
a∈G0

with
$a ◦ I ((wb )b∈G0 ) = wa ◦ Pja
Pι

a
for all nodes a ∈ G0 . Here $a : Γ(T PG) → Control(PG0 −−→
Pa) are the projection maps;
$a = D(Pιa ) (q.v. Remark 2.25).

Example 2.33. Consider the graph G as in Examples 2.13 and 2.30 with a phase space function
P : G0 → Man. Then the vector field
X = I (wa , wb ) : P(a) × P(b) → T P(a) × T P(b)
is of the form
X(x, y) = (wa (x), wb (x, x, y))

for all

(x, y) ∈ P(a) × P(b).

Example 2.34. Consider the graph

G=

a

b

c

and let P : G0 → Man be a phase space function. Then
(I (wa , wb , wc )) (x, y, z) = (wa (x), wb (x, x, y), wc (y, z))
for all (wa , wb , wc ) ∈ Ctrl (G, P) and all (x, y, z) ∈ P(a) × P(b) × P(c).

3

Maps of dynamical systems from f ibrations

Following Boldi and Vigna [2] (see also [11]) we single out a class of maps of graphs called graph
fibrations.
Definition 3.1. A map ϕ : G → G0 of directed graphs is a graph fibration if for any vertex a of G
and any edge e0 of G0 ending at ϕ(a) there is a unique edge e of G ending at a with ϕ(e) = e0 .

14

L. DeVille and E. Lerman

Example 3.2. The map of graphs
a1

γ

γ0

−−−→

b
a2

a

b

c

δ0

δ

sending the edge γ to γ 0 and the edge δ to δ 0 is a graph fibration.
Remark 3.3. Given any map ϕ : G → G0 of graphs and a node a of G there is an induced map
of input trees
ϕa : I(a) → I(ϕ(a)).
On edges of I(a) the map is defined by
ϕ(a, γ) := (ϕ(a), ϕ(γ))
(cf. Definition 2.26). Moreover the diagram of graphs
I(a)

ϕa

/ I(ϕ(a))
ξϕ(a)

ξa



G

ϕ


/ G0

commutes (the map ξa : I(a) → G from an input tree to the original graph is defined in Remark 2.28).
Lemma 3.4. If ϕ : G → G0 is a graph fibration then the induced maps
ϕa : I(a) → I(ϕ(a))
of input trees defined above are isomorphisms for all nodes a of G.
Proof . Given an edge (ϕ(a), γ 0 ) of I(ϕ(a)) there is a unique edge γ of G with ϕ(γ) = γ 0 and
t(γ) = a and consequently ϕa (a, γ) = (ϕ(a), γ 0 ). It follows that ϕa is bijective on vertices and
edges.

Remark 3.5. The converse is true as well: if the induced maps ϕa : I(a) → I(ϕ(a)) are isomorphisms for all nodes a of G then ϕ : G → G0 is a graph fibration.
Recall that a map from a network (G, P) to a network (G0 , P 0 ) is a map of graphs ϕ : G → G0
with the property that
P 0 ◦ ϕ = P.
Definition 3.6 (fibration of networks of manifolds). A map of networks ϕ : (G, P) → (G0 , P 0 )
of manifolds is a fibration if ϕ : G → G0 is a graph fibration.
Remark 3.7 (the category (Man/Graph)fib of networks of manifolds and fibrations). We note
that the composit of two fibrations is again a fibration. Consequently networks of manifolds
and fibrations form a category which we denote by (Man/Graph)fib .

Dynamics on Networks of Manifolds

15

Theorem 3.8 below is our reason for singling out fibrations of networks.
Theorem 3.8. A fibration ϕ : (G, P) → (G0 , P 0 ) of networks induces a linear map
ϕ∗ : Ctrl (G0 , P 0 ) → Ctrl (G, P).
Proof . Since
Ctrl (G, P) =

l

Control(PI(a) → Pa)

a∈G0

is a product of vector spaces, the map ϕ∗ is uniquely determined by maps from Ctrl (G0 , P 0 ) to
the factors Control(PI(a) → Pa), a ∈ G0 . On the other hand we have canonical projections
l
πb : Ctrl (G0 , P 0 ) =
Control(PI(c) → Pc) → Control(PI(b) → Pb)
c∈G00

for all b ∈ G00 . Hence in order to define the map ϕ∗ it is enough to define maps of vector spaces
ϕ∗a : Control(PI(ϕ(a)) → Pϕ(a)) → Control(PI(a) → Pa)
for all nodes a of the graph G. By Remark 3.3 the diagram
ϕa

I(a)

/ I(ϕ(a))
ξϕ(a)

ξa




/ G0

ϕ

G
P





P0

Man
commutes for each a ∈ G0 . Let
ϕ|{a} : {a} → {ϕ(a)}
denote the restriction of ϕ : G → G0 to the subgraph {a} ,→ G. It is easy to see that the
diagrams
I(a)

ϕa

O

jϕ(a)

ja

{a}

/ I(ϕ(a))
O

ϕ|{a}

/ {ϕ(a)}

commutes as well. By Lemma 3.4 the map ϕa is an isomorphism of graphs. Hence
Pϕa : PI(a) → PI(ϕ(a))
is an isomorphism of manifolds. Define
ϕ∗a : Control(PI(ϕ(a)) → Pϕ(a)) → Control(PI(a) → Pa)
by
ϕ∗a (F ) = DP(ϕ|{a} ) ◦ F ◦ (Pϕa )−1

16

L. DeVille and E. Lerman

for all F ∈ Control(PI(ϕ(a))). By the universal property of products this gives us the desired
map ϕ∗ . Moreover the diagrams
ϕ∗

Ctrl (G0 , P 0 )

/ Ctrl (G, P)

πϕ(a)

πa



Control(PI(ϕ(a)) → Pϕ(a))


/ Control(PI(a) → Pa)

ϕ∗a

commute for all a ∈ G0 .



Example 3.9. We write down an example of the map ϕ∗ constructed in Theorem 3.8. Consider
the graph fibration ϕ : G → G0 :
a1

γ

γ0

−→

b
a2

a

b

c

δ0

δ

as in Example 3.2. Let P 0 : G00 → Man be a phase space function. Then
Ctrl (G0 , P 0 ) = {(wa : P(a) → T P(a), wb : P 0 (a) × P 0 (a) × P 0 (b) → T P(b),
wc : P(b) × P(c) → T P(c))},
0

Ctrl (G, P ◦ ϕ) = {(wa0 1 : P 0 (a) → P 0 (a), wa2 : P 0 (a) → P 0 (a),
wb : P 0 (a) × P 0 (a) × P 0 (b) → T P 0 (b))}
and
ϕ∗ (wa0 , wb0 , wc0 ) = (wa0 , wa0 , wb0 ).
Remark 3.10 (the category DSN of dynamical systems on networks of manifolds). It is easy
to see that if ϕ : (G, P) → (G0 , P 0 ) and ψ : (G0 , P 0 ) → (G00 , P 00 ) are two fibrations then
(ψ ◦ ϕ)∗ = ϕ∗ ◦ ψ ∗ .
This can be interpreted as saying that the assignment
(G, P) 7→ Ctrl (G, P)
extends to a contravariant functor Ctrl from the category (Man/Graph)fib of networks of manifolds
and fibrations to the category Vect of real vector spaces and linear maps. That is, on arrows,
Ctrl ϕ := ϕ∗ .
Grothendieck’s construction (see for example [1]) applied to this functor produces a category
DSN which we would like to call the category of (continuous time) dynamical systems on networks
of manifolds. More explicitly the objects of the category DSN are triples
(G, P : G0 → Man, w ∈ Ctrl (G, P)),
where as before G is a finite directed graph, P is a phase space function and w = (wa )a∈G0 is
a tuple of control systems associated with the input trees of the graph G and the function P.

Dynamics on Networks of Manifolds

17

A morphism from (G0 , P 0 , w0 ) to (G, P, w) is a graph fibration ϕ : G → G0 with P 0 ◦ ϕ = P
and ϕ∗ w0 = w. Alternatively we may think of a map from (G0 , P 0 , w0 ) to (G, P, w) as a fibration
of networks of manifolds ϕ : (G, P) → (G0 , P 0 ) with ϕ∗ w0 = w.
Note that the Grothendieck construction also gives us a forgetful functor
DSN → (Man/Graph)fib op
that simply forgets the open systems. On objects it is given by sending the triple (G, P, w) to
the pair (G, P).
Of course just because we can define a category and call it a category of dynamical systems
on networks does not mean that this is a right thing to do. This said, Theorem 2.32 tells us that
to every dynamical system on a network (G, P, w) we can assign a dynamical system (PG, I w).
We will next argue that this assignment actually extends to a functor
P : DSN → DS
from dynamical systems on networks to the category DS of dynamical systems (q.v. Definition 2.1
and Remark 2.2). The first step is to define the functor on arrows. We do it in Theorem 3.11
below which may be considered the main result of the paper.
Theorem 3.11. Let ϕ : (G, P) → (G0 , P 0 ) be a fibration of networks of manifolds. Then the
pullback map
ϕ∗ : Ctrl (G0 , P 0 ) → Ctrl (G, P)
constructed in Theorem 3.8 is compatible with the interconnection maps
I 0 : Ctrl (G0 , P 0 ) → Γ(T PG0 )

and

I : Ctrl (G, P) → Γ(T PG).

Namely for any collection w0 ∈ Ctrl (G0 , P 0 ) of open systems on the network (G0 , P 0 ) the diagram
0
T PG
O

DPϕ

I 0 (w0 )

PG0

/ T PG
O
I (ϕ∗ w0 )

Pϕ

(3.1)

/ PG

commutes. Consequently
Pϕ : (P(G0 , P 0 ), I 0 (w0 )) → (P(G, P), I (ϕ∗ w0 ))
is a map of dynamical systems.
d
Proof . Recall that the
manifold
PG
is
the
product
a∈G0 Pa. Hence the tangent bundle bundle
d
T PG is the product a∈G0 T Pa. The canonical projections
T PG → T Pa
are the differentials of the maps Pιa : PG → Pa, where, as before, ιa : {a} ,→ G is the canonical
inclusion of graphs. Hence by the universal property of products, two maps into T PG are equal
if and only if all their components are equal. Therefore, in order to prove that (3.1) commutes
it is enough to show that
DPιa ◦ I (ϕ∗ w0 ) ◦ Pϕ = DPιa ◦ DPϕ ◦ I 0 (w0 )

18

L. DeVille and E. Lerman

for all nodes a ∈ G0 . By definition of the restriction ϕ|{a} of ϕ : G → G0 to {a} ,→ G, the
diagram
{a}

ϕ|{a}

/ {ϕ(a)}

(3.2)

ιϕ(a)

ιa





G

ϕ

/ G0

commutes. By the definition of the pullback map ϕ∗ and the interconnection maps I , I 0 the
diagram
O
: T Pa

o

T Pϕ(a)
0
wϕ(a)

(ϕ∗ w0 )a
I (ϕ∗ w0 )a

PI(a) o

c

O

DPϕ|{a}

Pϕa

PI(ϕ(a))

O

O

I 0 (w0 )ϕ(a)

(3.3)

Pξϕ(a)

Pξa

PG o

PG0

Pϕ

commutes as well. We now compute:
DPιa ◦ I (ϕ∗ w0 ) ◦ Pϕ = (I (ϕ∗ w0 ))a ◦ Pϕ
= DP(ϕ|{a} ) ◦ I 0 (w0 )ϕ(a)

by (3.3)
0

0

= DP(ϕ|{a} ) ◦ DPιϕ(a) ◦ I (w )

= DP ιϕ(a) ◦ ϕ|{a} ◦ I 0 (w0 )
0

0

= DP (ϕ ◦ ιa ) ◦ I (w )
0

by definition of I 0 (w0 )ϕ(a)
since P is a contravariant functor
by (3.2)

0

= DP(ιa ) ◦ DPϕ ◦ I (w ).
And we are done.



Corollary 3.12. The map
DSN → DS

ϕ
(G0 , P 0 , w0 ) −
→ (G, P, w) 7→


Pϕ
(PG0 , I (w0 )) −−→ (PG, I (w))

is a functor.
Remark 3.13. Given a dynamical system on a network (G, P, w) we can forget the dynamics.
This defines a functor
DSN → (Man/Graph)fib
from the category of dynamical systems on networks to a subcategory of the category of networks
of manifolds whose maps are fibrations of networks (hence the subscript fib ). Composing the
functor above with the functor Man/Graph → Graphop forgets all the information except for the
graph. This gives rise to a functor
DSN → Graphfib op .
Here the superscript op indicates that the functor reverses the direction of arrows and the subscript fib reminds us that the morphisms in the target category are the (opposite of the) graph
fibrations.
These two functors from DSN to DS and to Graphfib op , respectively, allow us to interpret
continuous time dynamical systems on networks both as dynamical systems and as graphs.

Dynamics on Networks of Manifolds

19

We end the paper with examples.
Example 3.14. Consider the graph fibration
a1

γ

γ0

b
a2

−→

a

b

c

δ0

δ

as in Examples 3.2 and 3.9. Let P 0 : G00 → Man be a phase space function and let P = P 0 ◦ ϕ.
Then
PG0 = P 0 (a) × P 0 (b) × P 0 (c),
PG = P 0 (a) × P 0 (a) × P 0 (b),
Pϕ(x, y, z) = (x, x, y),
and
DPϕ(p, q, r) = (p, p, q).
For any w0 = (wa0 , wb0 , wc0 ) ∈ Ctrl (G0 , P 0 ),

I 0 (w0 ) (x, y, z) = (wa0 (x), wb0 (x, x, y), wc0 (y, z)),
ϕ∗ w0 = (wa0 , wa0 , wb0 ),

I (ϕ∗ w0 ) (x1 , x2 , y) = (wa0 (x1 ), wa0 (x2 ), wb0 (x1 , x2 , y))
and

I (ϕ∗ w0 ) ◦ Pϕ (x, y, z) = (wa0 (x), wa0 (x), wb0 (x, x, y))
while

DPϕ ◦ I 0 (w0 ) (x, y, z) = DPϕ(wa0 (x), wb0 (x, x, y), wc0 (y, z)) = (wa0 (x), wa0 (x), wb0 (x, x, y)).
Hence


I (ϕ∗ w0 ) ◦ Pϕ = DPϕ ◦ I 0 (w0 )
as expected.
Example 3.15. In Example 3.14 above the map ϕ : G → G0 is neither injective nor surjective.
It can, of course, be factored as a surjection ψ : G → G00 :
a1

γ

γ0

b
a2

δ

ψ

−→

a

b
δ0

20

L. DeVille and E. Lerman

followed by an injection ι : G00 → G:
γ0

a

γ0

b

ι

a

−→

b

δ0

c

δ0

The map Pψ : PG00 → PG is easily seen to be given by
Pψ(x, y) = (x, x, y).
It is an embedding, as it should be (q.v. Lemma 2.20). The map Pı : PG0 → PG00 is given by
Pı(x, y, z) = (x, y).
It is a submersion (q.v. Lemma 2.21). Since P is a contravariant functor,
Pϕ = P(ı ◦ ψ) = Pψ ◦ Pı.
Theorem 3.11 tells us that for any w0 = (wa0 , wb0 , wc0 ) ∈ Ctrl (G0 , P 0 ), the map Pı projects the
integral curves of the vector field I (w0 ) to the integral curves of the vector field I (ı∗ w0 )
on PG00 . Furthermore, Pψ embeds the dynamical system (PG00 , I (ı∗ w0 )) into the dynamical
system (PG, I (ϕ∗ w0 )). An interested reader can check these two assertions directly.
Example 3.16. Consider the injective graph fibration ι : G → G0 :
4

1

2

3

ι

,→

10

1

7

5

2

6

3

8

(3.4)

9

Choose phase space functions P, P 0 so that i : (G, P) → (G0 , P 0 ) is a map of networks. By
Theorem 3.11, for any collection w0 ∈ Ctrl (G0 , P 0 ) of open systems on the network (G0 , P 0 )
the dynamics in the subsystem (PG, I (i∗ w0 )) drives the entire system (PG0 , I (w0 )). This is
intuitively clear from the graph (3.4) since there are no “feedbacks” from vertices 4, . . . , 10 back
into 1, 2, 3.

Acknowledgments
L.D. was supported by the National Science Foundation under grants CMG-0934491 and UBM1129198 and by the National Aeronautics and Space Administration under grant NASA-NNA13
AA91A. The authors also thank the anonymous referees whose comments significantly improved
the manuscript.

References
[1] Awodey S., Category theory, Oxford Logic Guides, Vol. 49, Oxford University Press, New York, 2006.
[2] Boldi P., Vigna S., Fibrations of graphs, Discrete Math. 243 (2002), 21–66.

Dynamics on Networks of Manifolds

21

[3] Brockett R.W., Control theory and analytical mechanics, in The 1976 Ames Research Center (NASA)
Conference on Geometric Control Theory (Moffett Field, Calif., 1976), Lie Groups: History, Frontiers and
Appl., Vol. 7, Math Sci Press, Brookline, Mass., 1977, 1–48.
[4] DeVille L., Lerman E., Dynamics on networks I. Combinatorial categories of modular continuous-time
systems, arXiv:1008.5359.
[5] DeVille L., Lerman E., Modular dynamical systems on networks, J. Eur. Math. Soc., to appear,
arXiv:1303.3907.
[6] Field M., Combinatorial dynamics, Dyn. Syst. 19 (2004), 217–243.
[7] Golubitsky M., Stewart I., Török A., Patterns of synchrony in coupled cell networks with multiple arrows,
SIAM J. Appl. Dyn. Syst. 4 (2005), 78–100.
[8] Stewart I., Golubitsky M., Pivato M., Symmetry groupoids and patterns of synchrony in coupled cell networks, SIAM J. Appl. Dyn. Syst. 2 (2003), 609–646.
[9] Tabuada P., Pappas G.J., Quotients of fully nonlinear control systems, SIAM J. Control Optim. 43 (2005),
1844–1866.
[10] Vagner D., Spivak D.I., Lerman E., Algebras of open dynamical systems on the operad of wiring diagrams,
arXiv:1408.1598.
[11] Vigna S., The graph-fibrations home page, http://vigna.di.unimi.it/fibrations/.
[12] Willems J.C., On interconnections, control, and feedback, IEEE Trans. Automat. Control 42 (1997), 326–
339.

