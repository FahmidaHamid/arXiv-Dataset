Richard C. Gerkin
Arizona State University
School of Life Sciences
rgerkin@asu.edu

Abstract
A recent Science paper [1] proposed that humans can
discriminate between at least a trillion olfactory stimuli.
Here we show that this claim is the result of a fragile estimation framework capable of producing nearly any result
from the reported data, including values tens of orders of
magnitude larger or smaller than the one originally reported in [1]. We conclude that there is no evidence for
the original claim.

Jason B. Castro
Bates College
Department of Psychology
Program in Neuroscience
jcastro@bates.edu

first demonstrate the framework’s fragility, and then explain its origin. For most of this paper, we remain agnostic about whether the framework is conceptually sound,
to highlight the fact that it has strictly methodological
problems of a statistical origin that do not depend on the
validity of a competing set of assumptions. In a concluding section, we explore possibilities for improving the
estimate.
largest possible

1 Introduction
A recent paper [1] proposed that humans can discriminate between at least a trillion olfactory stimuli. Using
that paper’s methods to reanalyze the data it presented,
we show that this estimate is problematically fragile.
Specifically, it varies systematically and sensitively (over
tens of orders of magnitude, in both directions), for modest changes in incidental experimental and analysis parameters against which a result ought to be robust. Had
the experiment enlisted ∼ 100 additional subjects similar to the original ones, the same analysis would have
concluded that all possible stimuli are discriminable (i.e.
that each of the more than 1029 olfactory stimuli possible in their framework are mutually discriminable). By
contrast, if the same experimental data were analyzed using moderately more conservative statistical criteria, it
would have concluded that there are fewer than 5,000
discriminable olfactory stimuli – no larger than the folk
wisdom value that the new estimate purports to replace.
As a result, data describing the same underlying perceptual abilities admit a wide range of extremely disparate, yet unobjectionable alternative conclusions (including both the largest and smallest possible estimates
allowed by the analysis framework). We conclude that
the framework is unsound; therefore there may be trillions of discriminable odor stimuli, or more, or fewer, but
the framework is incapable of settling this issue. Here we

estimate

arXiv:1502.05120v1 [q-bio.NC] 18 Feb 2015

Humans can discriminate trillions of olfactory stimuli, or more, or fewer

smallest possible

amount of data collected
Figure 1: Consistency of an estimator. An estimator is consistent if the
resulting estimate asymptotically converges (in expectation) as sample
size increases (black line). Uncertainty in the estimate (gray area) may
shrink with sample size, but the estimate itself should not systematically change with sample size, and should converge on the truth. Estimators without this property are termed inconsistent (the blue line is
a relevant example), and are considered unreliable, as the resulting estimate can be heavily biased by the sample size. If the estimate has a
minimum and maximum allowed value (see equation 1), an especially
inconsistent estimator can even produce any estimate within that range.

2 Problems with the estimate
The main concern is that the estimated number of discriminable stimuli depends steeply, systematically, and

A
% subjects that can significantly
discriminate mixtures

non-asymptotically on choices of arbitrary experimental
parameters, among them the number of subjects enrolled,
the number of discrimination tests performed, and the
threshold for statistical significance. We show below that
the order of magnitude claim of ‘at least one trillion olfactory stimuli’ requires that those parameters assume a
very narrow set of values. Certainly, the precise value
of an estimate may change as additional data are collected, but the estimate should not change in expectation;
it should not be possible to make an estimate arbitrarily large (or small), simply by collecting more (or less)
data. Similarly, the estimate itself should not become
arbitrarily small or large with adjustment of a significance criterion. Estimates that scale systematically with
such incidental parameter choices are considered statistically inconsistent (Figure 1). It is the inconsistency of
the present estimate that produces a tremendously large
space of extremely different, yet unobjectionable alternative conclusions that can be reached about the number
of discriminable olfactory stimuli.
To illustrate that we can correctly recapitulate the analysis undertaken in [1], Figure 2 shows our reproduction
(using raw supplementary data) of two critical figures
from that paper [1], from which its main conclusion was
drawn. Figure 3 and Table 2 quantify the fragility of
this conclusion, by generating estimates using the same
framework under trivial alternative scenarios in which
different numbers of subjects (or mixtures) were used,
or different choices of statistical threshold (α ) were used
for assessing discriminability. See Table 1 for definitions
of parameters used here and in [1]. Thus, we produced all
values shown here by analyzing the data from [1], using
the methods described therein, and varying only parameters. Code for these and all subsequent analyses are available at http://github.com/rgerkin/trillion.

Estimated number of discriminable olfactory stimuli

C

Number of distinct compounds available to make mixtures

N
O

Number of distinct compounds in a mixture

D

Number of distinct compounds in one mixture of a pair
that are not shared by the other. (D = N − O)

class
d

50
Mixtures of N=10
Mixtures of N=20
Mixtures of N=30

0
100

80
60
40
20
% mixture overlap ((D-N)/N)

0

0

20
40
60
80
% mixture overlap allowing
discrimination((d-N)/N)

100

B
30

# discriminable mixtures (z)

10

20

10

10

10

1

10

Figure 2: Reproduction of the main result published in [1], from analysis of raw data made available in supplemental materials of [1]. Compare to Figures 3 and 4 in that publication. A: Discriminability vs. Mixture overlap, expressed as a percentage of the mixture size N. From this
analysis, [1] derives d−N
N ∼ 51% (vertical dashed line) as the critical
value of mixture overlap at which 50% of mixtures achieve ‘significant
discriminability’. B: Estimated number of discriminable mixtures z vs.
mixture overlap (expressed as a percentage of N) allowing discrimination. The plot is obtained by regression and interpolation of results like
in A combined with equation 1. For a value of ∼ 51% as obtained in A,
one obtains the ‘trillions’ figure reported in [1].

Table 1: Definitions of parameters

z

100

the smallest possible number of discriminable stimuli is
∼ 4500 (see equation 1, in section 3 below). Figure 3 and
Table 2 thus demonstrate that 1) there is a regime of reasonable parameter choices for which one concludes that
all possible olfactory stimuli (i.e. all ∼ 1029 of them) are
discriminable; and 2) there is another regime of reasonable parameter choices for which one concludes that the
smallest possible number of stimuli (i.e. only ∼ 4500)
are discriminable. The only assumption required to obtain these estimates is that performance in new subjects
is similar to performance in the original subjects.
The fragility of the conclusion results from the claim
in [1] that a modest (if very interesting) correlation –

Number of distinct compounds shared by a mixture pair

All mixture pairs with the same value of N and D.
The value of D for which mixture pairs of a given N are
more likely than not to be discriminable at a rate significantly above chance.

In [1]’s experimental framework, there are three sets
of experiments, varying in the number of distinct molecular components N per mixture tested. We consider
the N = 30 case (without loss of generality) for which
there are ∼ 1029 possible olfactory stimuli, and for which
2

B
5

7

smallest possible
(<5000)

8
10
15
20

*

colors (c)

smallest possible
(<5000)

10

(c)

number of subjects tested (S)

number of mixture pairs per class tested (T)

A

29
40
57
80
114

13

(c)

19

(c)

26

*

37
52
74
104
148
208

160
227

295

All
5
00

0.0

01

0.0

5
5
02 0.00

0.0

25 0.05

1

0.0

Largest possible (All)
05

0
0.0

0.0

1
.00

0

1
0.0

5
5
02 0.00
0.0

25 0.05
0.0

α for significance

α for significance

C
29

28

26

10 10 10

24

10

22

10

20

10

all possible olfactory stimuli
(C choose N)

18

10

16

10

14

10

current estimate

12

10

10

10

8

10

6

10

4

10

colors
previous estimates
smallest possible
estimate

Figure 3: The estimation framework supports nearly any alternative conclusion, including the smallest and largest estimates possible under the
framework. A: Heat map showing alternative conclusions reached for different choices of T , the number of mixture pairs per class to test, and
application of alternative significance threshold α for discriminability, with the data from [1]. Asterisks (*) show the parameter regime (T = 20
mixtures, α = 0.05) used in [1]. Other values on each axis are chosen in a geometric progression around those parameters. The contour in
the lower right labeled ‘All’ demarcates a regime in which one will conclude that the largest possible number of of mixture stimuli (i.e. all
29
z(d = 0) = 128
30 > 10 of them) are discriminable (see equation 1). The contour in the upper left labeled ‘smallest possible’ demarcates a regime
in which one will conclude that the smallest possible number of stimuli are discriminable, i.e. only z(d = N = 30) < 5000 of them. The contour
labeled ‘colors’ demarcates a regime in which one concludes that the number of discriminable olfactory stimuli is the same order of magnitude
as the number of discriminable colors. B: Heat map similar to left, only with number of subjects on the vertical axis. A choice of α = 0.025 is
necessary to obtain the estimate that [1] reports for this analysis. C: Colorscale for A and B, with reference landmarks.

3

A

A
# Discriminable
stimuli (z)

Significance
threshold (α )

# Tests per
class (T )

2.02 ∗ 1012

0.05*

20*

4.56 ∗ 103†

0.05*

5

1.54 ∗ 1029‡

0.05*

185

8.94 ∗ 103

0.001

20*

1.79 ∗ 104

0.01

15

# Discriminable
stimuli (z)

Significance
threshold (α )

# Subjects
(S)

3.81 ∗ 1013

0.025*

26*

4.56 ∗ 103†

D>d
D=d
D<d

400 nm

wavelength (nm)

600 nm

B
fraction correctly
discriminated

B

0.025*

7

29

0.025*

135

7

0.001

26*

d

0.01

15

inter-stimulus distance (D)

1.54 ∗ 10 ‡
3.47 ∗ 10

2.98 ∗ 105

Figure 4: ‘Sphere packing’ to estimate the number of discriminable
colors: the motivation behind the framework in [1]. A: Hypothetical example showing a range of visible wavelengths. Relative to a
reference stimulus (thick vertical tick mark), extremely distant stimuli
(green circle) in this space are easy to discriminate, whereas extremely
close stimuli (red circle) may be impossible to discriminate, as they are
beyond the resolution of color vision. At some critical inter-stimulus
distance, d, stimuli will be ‘just discriminable’ (black circle). A typical stimulus pair on the space, separated by distance D, will tend to
be discriminable if D > d, and indiscriminable if D < d. B: This partitioning into discriminable and indiscriminable sets is captured in the
sigmoidal shape of the psychometric curve plotting discriminability vs.
distance. Knowing that an interval of length d on the space will tend
to span ‘just discriminable’ stimuli, one can calculate how many such
intervals, z, can be ‘packed’ onto the space to estimate the number of
discriminable colors.

Table 2: Estimates of z, the number of discriminable olfactory stimuli,
for different possible parameters values, for the C = 128, N = 30 case
used in [1]. This recapitulates selected points from Figure 3. * indicates
that the parameter value was used in [1]. We assume here that new
subjects perform similarly to the original subjects. Note that 4.56 ∗
103 (†) and 1.54 ∗ 1029 (‡) are the smallest and largest possible values
allowed by the framework from [1].

between the discriminability of a pair of mixtures and
the overlap (fraction of shared components) of those
mixtures – is evidence that a particular degree of mixture overlap defines a boundary that partitions the discriminable from the indiscriminable in a very highdimensional space. Below, we explore the consequences
of this decision, and its implications for calculating the
number of discriminable olfactory stimuli.

Because olfactory stimuli do not have obvious physical dimensions analogous to wavelength, olfaction is not
amenable to an identical calculation. Instead, [1] established a theoretical framework that yielded a similar calculation based upon the same underlying idea. [1] proposed to divide the size of a investigator-determined olfactory stimulus space by a data-determined variable representing resolution in this space. Instead of being continuous, one dimensional, and defined by some intrinsic
stimulus variable like wavelength, the olfactory stimulus
space was defined to be the discrete, high-dimensional
space spanned by all mixtures containing N = 30 different components (molecules) that could be assembled
from a library of C = 128 molecules; [1] also considers
the N = 10 and N = 20 cases, which we ignore in this
section with no loss of generality. This space
 of possible mixture stimuli is astronomically large CN , owing to
the proverbial ‘combinatorial explosion’, and each point

3 Explanation of the problems with the estimate
3.1 Recap of the basic framework
The framework’s logic is built on an analogy to color vision, where estimating the number of discriminable colors requires knowing only two numbers: the size of the
stimulus space (that is, the range of visible wavelengths),
and the minimally discriminable distance between a typical pair of stimuli (Fig. 4). Dividing the first number by
the second amounts to asking how many discriminable
intervals can be ‘packed’ into the stimulus space, with
that number providing an estimate of the number of discriminable color stimuli.
4

A

in the space corresponds to a specific multi-component
mixture.
One definition of distance between stimuli in this
space is the number of components D by which the stimuli differ. For example, nearest neighbors would be stimuli sharing all components but one (D = 1), and the most
distant points in this space would be stimuli differing in
all components (D = N).
[1] showed that discriminability of a stimulus pair
tends to increase with the distance D between the stimuli
in that pair (Figure 2A), and then argued for the existence of a special distance d corresponding to the D at
which stimuli are ‘just discriminable’. In other words,
for D > d stimuli should more often than not be considered discriminable and for D < d they should more often
than not be considered indiscriminable. By calculating d,
one could in turn readily calculate the number of stimuli
within a distance D ≤ d of a typical point in the stimulus
space using the provided formulas. Geometrically, the
set of stimuli with distance D ≤ d from a reference stimulus corresponds to a filled ‘ball’ of stimuli indiscriminable from the reference stimulus at its center. Conversely, the reference stimulus should be discriminable
from stimuli outside the ball. We could thus count the
number z of non-overlapping balls that can be packed
into the stimulus space, as the proposed in [1], by analogy to the example for color vision:

C
N

ball(d/2)

where ‘ball’ is defined as:

r  
N C−N
ball(r) = ∑
x
x=0 x

1.0

d

Fraction
discriminable

0.5

0.0

threshold

d

0.5

0.0
0.0

0.0
1.0
0.5
inter-stim distance (D)

1.0
0.5
threshold

B
1.0

0.5

d

Fraction
discriminable

1.0

threshold

0.5

0.0

0.0
0.0
1.0
0.5
inter-stim distance (D)

C 1.0

(1)

0.0

1.0
0.5
threshold

0.0

1.0
0.5
threshold

1.0

0.5

d

Fraction
discriminable

z(d) =

1.0

threshold

0.0
0.0
1.0
0.5
inter-stim distance (D)

0.5

0.0

(2)
Figure 5: Behavior of psychometric curves for hypothetical data describing discriminability vs. inter-stimulus distance. A: Left, A sharply
sigmoidal relationship in which discriminability changes dramatically
and categorically at a critical inter-stimulus distance, d. In all panels, d
is the value of the inter-stimulus distance D at which a threshold fraction of stimulus pairs are discriminable. In the left panels, this threshold
is set at 0.5. Right, The resulting value of d is nearly invariant to the
choice of threshold . B: Same as above, only for a less sharply sigmoidal data set. There is still a narrow regime in which d is largely
invariant to choice of threshold. C: Same as above, only for a weakly
sigmoidal data set. Here, there is no principled means for choosing the
d that is characteristic of discriminability relationships for stimuli. The
data in C do not support an interpretation in which there is defensible
characteristic ‘length scale’ for inter-stimulus distances.

Equation 1 produces the final estimate z of the number of discriminable stimuli. C and N are fixed by experimenter choices, and d – the resolution-like term –
is the only quantity derived from data that is related to
measured psychophysical performance. Note that for
C = 128, N = 30, as used in [1], the largest and smallest
possible values this equation can produce are ∼ 1.5∗1029
(for d = 0) and ∼ 4500 (for d = N), respectively. Assuming this framework is conceptually unproblematic (but
see [6]), the only question becomes: How do we derive
d from the data?

3.2 Derivation of the critical parameter d

that d corresponds to the distance D at which the ‘fraction correct’ reaches a certain value. In [1]’s threealternative forced-choice experiments, chance responding would produce a fraction correct of 13 , so the appropriate threshold would be somewhere between 13 and 1.
This threshold choice would be arbitrary – we might say
that a fraction correct of 12 reflects discriminable, or alter-

3.2.1 Thresholding the fraction discriminated
A classic psychometric curve (Figure 4B), showing discriminability as a function of inter-stimulus distance D,
admits a few plausible ways to derive d. The simplest is to simply use a discriminability threshold, such
5

estimated number of
discimrinable olfactory stimuli (z)

A
28

10
26
10
24
10
22
10
20
10
18
10
16
10
14
10
12
10
10
10
8
10
6
10
4
10

all possible olfactory stimuli (C choose N)
100
80
60
40
20

% mixture overlap (d)
required for discriminability

natively we might choose 23 or any other value between
1
3 and 1.
If the psychometric curve is sufficiently steep near
some value of D (Figure 5A represents an ideal case)
then the derived d will vary minimally over a wide range
of choices for the threshold. In this scenario, we might
be confident that the d we derive is a truly meaningful
measure of resolution – it would be robust. If not (Figure
5C), it will be very fragile. To test whether this scenario
applies to the data from [1], we plotted the fraction discriminated vs percent mixture overlap for that data (Figure 6), and then varied the threshold from 13 to 1, using
regression and interpolation to obtain the distance d corresponding to this threshold (Figure 7, thick red line), by
analogy to the framework in [1].

0

100 90 80 70 60 50 40
threshold defining discriminability
(% correctly discriminated)

B
estimated number of
discimrinable olfactory stimuli (z)

% subjects that
discriminated mixtures

100

50
Mixtures of N=10
Mixtures of N=20
Mixtures of N=30

0
100

80
60
40
20
% mixture overlap((N-D)/N)

0

all possible olfactory stimuli (C choose N)
28

10

25

10

22

10

19

10

16

10

13

10

10

10

7

10

smallest possible

4

10

1

10

100 90

Figure 6: Discriminability vs mixture overlap. Analogous to Figure 2,
except plotting fraction discriminated directly (as in Figure 5), instead
of fraction significantly discriminable. The threshold (50%) and the
procedure for computing mixture overlap at that threshold are as in
Figure 2A. Derived from data in [1] as for Figure 2.

80 70

60

50

40 33.3(chance)

threshold defining discriminability
(% correctly discriminated)
Figure 7: Relationship between the estimated number of discriminable stimuli z and the choice of threshold defining discriminability.
A) The thick red line shows the critical distance d that would result
from the data in [1] for a range of ‘fraction discriminated’ thresholds
between 100% (perfect discrimination), and 33.3% (chance discrimination). The curve was obtained by regression on plots like that in
Figure 6, by analogy to Figure 2 and [1]. Note that d exhibits a nearly
constant-slope relationship with threshold, meaning the data are not defined by a characteristic length scale, much like in Figure 5C. The thick
black curve shows the relationship between z and the chosen threshold.
This relationship was obtained directly from d, using equation 1, as in
[1]. The thin red lines correspond to the same calculation for d but
using data for only a single subject (one per line), showing similar sensitivity to the choice of threshold. The absence of a robust d for any
individual subject argues that the group data are not simply explained
by averaging across a population with well-defined, but diverse values
of d. Note that very modest and reasonable alternative choices for the
threshold result in extremely disparate estimates. The vertical axis is
bounded by the smallest and largest possible number of discriminable
stimuli allowed by the framework. The dashed lines are a visual guide
to specific (threshold, z) pairs. B) Box and whisker plots showing the
median and inter-quartile range for z when restricting the analysis to
individual subjects. Note that the worst performing subjects under one
threshold can discriminate many more stimuli than the best performing
subjects under a slightly more liberal threshold (compare best subject
using a 60% threshold vs. worst subject using a 40% threshold).

We subsequently used those values to compute the corresponding number of discriminable stimuli z (Figure 7,
black curve). These results show that neither the estimates of d nor by extension that of z are robust across
this range of thresholds, so it is impossible to report
with any confidence the number of discriminable stimuli using this approach. Intuitively, this ‘choose your favorite threshold’ strategy is problematic, as it effectively
amounts to picking a target number between ∼ 103 and
∼ 1029. Below, we show that the actual framework used
in [1] is nominally employed to make a more principled
choice of threshold; however it merely cloaks the arbitrariness of the threshold choice, but does not eliminate
it.
3.2.2 Thresholding the fraction significantly discriminable
A variation on the above approach, and the one used in
[1], is to apply a threshold not to the fraction discrimi6

nated, but to the fraction significantly discriminable. In
other words, determine for which subjects (or alternatively, for which classes of mixtures) the fraction discriminated is significantly greater than 31 , i.e. for which
subjects the null hypothesis of chance discrimination
can be rejected. To facilitate visualization of this step,
[1] re-plotted the summary data (fraction correctly discriminated) as fraction significantly discriminable (Figure 2A). This view of the data again provides a linear
relationship between distance D and, in this case, fraction significantly discriminable, which holds across all
the values of N tested. The relationship is now steeper
than it was for fraction discriminable (compare Figures
2 and 6) because the extra hypothesis-testing step acts as
a strong non-linear threshold that exaggerates otherwise
small differences in the data. Again a choice of threshold
choice is required; [1] chose a threshold of 50% significantly discriminable, and computed d using linear regression and interpolation as above.
Because the linear relationship between the distance
D and the fraction significantly discriminable (Figure 2)
is steeper than it is for D and the fraction discriminated
(Figure 6), the former would appear to be less fragile
than the latter. Indeed, varying the threshold (i.e. 50%)
itself (not shown), will have much less effect on the computed d (and consequently on z) for the former than for
the latter. However, by introducing a hypothesis-testing
step, the d derived from Figure 2 now varies systematically with the number of subjects enrolled in the study
(and the number of mixtures tested), and with the choice
of significance criterion α . This is because each data
point used to compute d becomes the binary result of a
hypothesis test, each of which depends critically on sample size and test specificity. Because d is then fed into an
expression (equation 1) that explodes geometrically, the
result is a recipe for producing any of a range of estimates
for z that one might choose. If one enlists more subjects or slackens the significance criterion, a very large
(even the largest possible) number will be obtained. If
one enlists fewer subjects or makes the significance criterion more strict, a very small (even the smallest possible)
number will be obtained. Figure 8 shows the explicit dependence of the estimate on these quantities. Naturally,
these can be varied in tandem too, with even more dramatic consequences, as described above (Figure 3 and
Table 2).
A hypothesis test is meant to assess the strength of evidence for or against a hypothesis (often against a null
hypothesis), not to make a point estimate. However, it
may not be uncommon for researchers to use hypothesis
testing in the manner done in [1] – to count the number
or fraction of data points exhibiting a certain property.
In many cases this may amount to a venial statistical sin
with (hopefully) benign consequences. But that is unfor-

tunately not the case here, due in part to the extremely
steep dependence of z on d guaranteed by equation 1.
If one claims an estimate to be meaningful, it is fair
to ask how vigorously would one have to defend a specific choice of arbitrary experimental parameters to defend a particular order-of-magnitude range around that
estimate. Unfortunately, the systematic sensitivities exhibited here severely undermine the plausibility and relevance of the estimate reported in [1]. Due to these sensitivities, one could pick almost any number of discriminable stimuli in advance, and affirm this number using
these or similar data. [1] simply exchanged the arbitrariness of a ‘fraction discriminated’ threshold with the arbitrariness of the sample size and α . Ultimately, the absence of a robust d to characterize the data is an insurmountable obstacle for the framework.

4 Building the the stimulus space
4.1 The structure of the stimulus space
One might ask: what is the right way to calculate d in
order to obtain a robust estimate of the number of discriminable stimuli? Before heading down this road and
devising alternative statistical approaches, it is worth first
clearly articulating the assumptions of a framework in
which a single variable plays such a special role. Under what conditions is it sensible to expect that plugging
a single data-derived number into equation 1 will produce a meaningful lower bound of the number of discriminable olfactory stimuli?
To gain some intuition into this, we can ask the analogous question in the simplified visual system example
(Figure 4) that was used as the principal motivation for
the procedure. The ‘sphere packing’ calculation in this
case naturally involves measuring the resolution of perception in terms of the stimulus, but its validity is not a
consequence of this measurement alone. Rather, the procedure in Figure 4 is sensible because the thing we are
calling an independent stimulus dimension (wavelength)
is respected as such by perception: we encounter monotonically changing, non-redundant percepts as we move
from one extreme of the stimulus space to the other. If
we didn’t – say, if the same percept ‘blue’ were experienced for several non-overlapping disjoint intervals – the
sphere packing formulation would fall apart. We might
observe that on average discriminability improves with
distance, but this would not be evidence of a characteristic length scale that partitions stimulus pairs into discriminable vs. indiscriminable sets.
Thus the sphere-packing framework is valid only if the
underlying geometry of stimulus space (that the investigator has designed) aligns with the geometry of perceptual space (as implemented in neural circuitry). For7

A

B
all possible olfactory stimuli (C choose N)

12

10

11

10
estimated number of discriminable
olfactory stimuli (z)

estimated number of discriminable
olfactory stimuli (z)

30

10
28
10
26
10
24
10
22
10
20
10
18
10
16
10
14
10
12
10
10
10
8
10
6
10
4
10
2
10
0
10

subjects (S)
mixtures (T)

colors
smallest possible

10

10

9

10

7

10
10

5

10

4

10

2

3 4 56

100
number of replicates

colors

6

10
5 67

uncorrected
corrected (FDR)

8

10

previous estimates
smallest possible
4 3

2

0.05

2

5 4 3

2

0.01
0.001
significance criterion (alpha)

65

Figure 8: Steep, systematic, and non-asymptotic dependence of the estimate on sample size (S or T ) and threshold α for statistical significance. A)
Dependence of the estimate (for mixtures of N = 30) on sample size. Black shows dependence on the number of subjects S enrolled in the study,
Red shows dependence on the number of mixtures T tested per mixture
 class. Once the number of mixtures or subjects tested is ∼ 150 (by no means
an unusually large sample size), the conclusion that all possible C
N mixtures are discriminable is guaranteed, in contradiction with experimental
results. B) Dependence of the estimate on the significance threshold α with (red) and without (black) a correction for multiple comparisons. [1] did
not correct for multiple comparisons.

mally, the map from stimulus space to perceptual space
needs to be homeomorphic, or nearly so. See [6] for further insight on this issue.

were increased to the size of a standard flavor and fragrance catalog (∼ 2000 chemicals), the estimate would
increase to z ∼ 1041, implying a unique olfactory percept
for each carbon atom on earth.

4.2 Redundancy in the stimulus space

Subjects’ performance could become worse when
mixtures are drawn from this larger, more complete library, and we acknowledge that we cannot know in advance what the newly calculated resolution d would be
on the new stimulus space. In other words, as the numerator of equation 1 increased, its denominator (given by
equation 2) might conveniently grow proportionally. Let
us therefore assume that with a library of sufficient size,
so many mixtures become indiscriminable that the resolution becomes as poor as the framework allows, with
d = N. Even in this edge case, if only mixtures differing in all components were ‘just discriminable’, we
would still calculate 1021 discriminable stimuli. If C is
increased to 106 , the smallest possible number of discriminable percepts (under the assumption of worst measurable performance, as above) is 1061 , or ten million
trillion unique olfactory percepts for every carbon atom
on earth (Fig. 9, red line). One may object that the inflation of C here is an unfair critique, as the perceptual
redundancy of molecules must at some point provide an
important constraint on the size of the artificially con-

Instead of providing evidence for this homeomorphism,
[1] assumed for the purposes of calculation that each
component of the molecular library (of size C = 128
in [1]) spanned an informative additional dimension for
perception to explore: each molecule in the library is
treated as an olfactory primary that is independent of all
the others. This is the assumption, codified in the numerator of equation 1, that allows for a massive space of
potential discriminable stimuli. Indeed, the guaranteed
runaway growth of the numerator as molecules are added
to the C-sized library was offered in [1] as an argument
for why the reported ‘trillion’ figure is a lower bound –
after all, C could always be higher.
It is worthwhile to quantify the behavior of the estimate as C changes. First, the estimate depends geometrically on C, with a power law exponent of ∼ 30 (Fig. 9,
blue line). In other words, if the chemical library were
doubled, the estimate z would increase by a factor of 230
under constant performance. If the component library
8

# possible olfactory
stimuli

80

estimated number of discriminable
olfactory stimuli (z)

10

70

10

of the underlying perceptual (or conceptual) representations of those stimuli. These maps are characterized by
the attribute that pairs of items which are considered intuitively to be perceptually near (rated similar or difficult
to discriminate) are nearer to one another on the map than
pairs of items which are perceptually more distant (rated
dissimilar or easy to discriminate). There are many algorithms for generating such maps, many of which have
been used before in olfaction, including variants of PCA
[3, 4, 8], non-negative matrix factorization (NMF, [2]),
and multi-dimensional scaling [5]. While there are open
questions in the generation of these maps (e.g. how many
dimensions should they have?), they all have the virtue
that their accuracy can be checked (e.g. by examining
the correlation between subjects’ indications of item pair
dissimilarity and the distance between that pair on the
map), and thus the maps can be improved. Developing
these maps may also have the collateral benefit of revealing stimulus dimensions intrinsic to olfaction (if any),
which could constrain the experimental choice of a resolution to measure.
Unfortunately, it is difficult if not impossible to create
these maps from the data discussed here, because each
mixture of a tested pair is used only once in [1], in that
pair alone, and never in any other pairs. Thus, there are
no serial comparisons of the same mixture that could be
used to anchor a stimulus on the map relative to anything other than that one stimulus against which it was
directly compared experimentally. Thus, there is no way
to compute distances between stimuli that do not appear
together in a tested pair. In future experiments such serial
repetition of already-tested mixtures would be required
to build up a data set to which the proposed method could
be applied.

same performance

60

10

50

10

40

10

30

10

worst possible

20

10

10

10

10

0

10 2

10 3
10 4
10 5
size of molecular library (C)

10 6

Figure 9: Explosive growth of the estimate z on the size (C) of the
molecular library. The number of possible stimuli z that can be assembled by choosing N = 30 distinct molecules from a library of size C increases geometrically with C (black line). If a library of a different size
had been used, and similar subject performance resulted, the estimated
number of discriminable stimuli z would grow along a similar trajectory
(blue line). Even if performance deteriorated as C increased, the estimate could never fall below the red line, which represents worst-case
performance (d = N). This results from the combinatorial explosion
inherent in equation 1.

structed stimulus space. Indeed, it has been reported that
as few as thirty components are required to imbue most
mixtures with a common smell, even when there is no
component overlap between the mixtures [7]. But this is
the essence of the problem with equation 1: where does
that point lie, and why wasn’t the constraint important to
consider for the original C = 128 molecular library?

6 Appendix
Here, we provide a more detailed statistical argument describing the framework’s extreme sensitivity to incidental parameters. The crux of the statistical issue is this: the
framework could only be valid if d, the estimated difference limen used in the calculation step, is a measure of
olfactory resolution that converges to the true value of
this quantity as more data is collected, i.e. if it is consistent.
‘Significantly discriminable’ is a moving target dependent on sample size, choice of significance criterion,
and correction for multiple comparisons. And d is the
only data-dependent value used in subsequent calculations (equation 1), Together, this guarantees that the estimate of z in the [1] is a moving target as well, dependent
on these same parameters. d is generated by testing a
number of null hypotheses, and is closely related to the
fraction of these which are rejected. But the probability

5 Avenues for improving the estimate
If one is seeking a conservative estimate of the number
of discriminable stimuli in a perceptual space whose organization and intrinsic dimensionality are poorly understood, it is arguably more appropriate to use a model that
accounts for the data with the smallest number of dimensions. The massive estimates possible in the framework
are an immediate consequence of a definition of dimensionality driven by experimenter designation, not data.
We therefore propose an alternative framework: use
experimental data to create a working map of the perceptual space, and then apply the sphere-packing framework to that map, rather than to a map of the stimulus
space. In cognitive science, psychometrics, and marketing, subject responses to stimuli are used to create maps
9

of D characterizing that mixture pair is necessarily > d.
If k >= 11 for fewer than 50% of subjects, then D <
d. If k >= 11 for exactly 50% of subjects, then D = d.
The actual estimate for d is obtained by regression in the
spirit of Figure 2.
What kind of subject can discriminate successfully 11
times out of 20? Consider a mixture class XN,D (characterized by N and D), and a subject performance of
fN,D , corresponding to the proportion of mixtures correctly discriminated from a sample of size T . Note that
fN,D is simply the abscissa of Figure 1 from [1]. A subject with fN,D = 0.55 would get k = T ∗ fN,D = 11 out
of T = 20 correct on average. So we can rewrite the inequality above as an equation:

of and criteria for rejection of these null hypotheses depends critically on sample size and α , the values that we
explored in Figure 3 and Table 2. Certainly, we would
agree that there is nothing objectionable about the specific parameters chosen in [1]. However, there is nothing
objectionable about many other values for those parameters either.
In effect, calculating d is somewhat like judging
whether a coin meets a cutoff for being fair based on a
series of tosses. It matters very much how many tosses
one makes, and how much deviation from chance one is
willing to tolerate before calling a coin unfair. If you
have no particular reason to believe a coin is unfair, you
6
might be disinclined to call it unfair if you observe 10
600
(60%) heads, but probably not if you observed 1000 heads
(also 60%). However, if you own a casino, you might
call 5100 heads in 10000 (51%) evidence of an unfair
coin. Whether the coin is fair is not something we directly measure, but rather we have more or less evidence
for various degrees of fairness.
A similar situation applies in [1]’s analysis by considering its formal definition of d (a definition we verified
by reconstructing the critical figures from [1] in Figure 2.
d is defined as that inter-stimulus distance D for which
50% of subjects can significantly discriminate a mixture
class. By a mixture ‘class’ we denote the set of mixture
pairs for which each mixture has the same number of total components (N) and each pair has the same number
of distinct, non-overlapping components D (D = N − O,
see Table 1). For example, the mixture pair (ABC, ABD)
would be a member of the class with N = 3 and D = 1
distinct components. We focus here on calculations pertaining to the number of tests T per class, but the same
argument is readily translated over to the number of subjects S.
To assess significant discriminability from chance, [1]
used a two-tailed binomial test. Thus if a p-value is
smaller than α2 then the subject is considered able to significantly discriminate from pairs in the mixture class.
The p-value is given by 1 minus the cumulative binomial
distribution function for n = T trials, k successes, and a
probability of success equal to 13 , with k corresponding to
the number of subjects discriminating correctly, and 31 to
chance in a 3-way forced choice task. Thus, the subject’s
discrimination performance is significant if:

1 − α /2 =

f N,D ∗T 

∑

i=0


T 1 i 2 T −i
( )( )
i 3 3

(4)

If the above equation is satisfied, then the subject will
be considered to be on the boundary between significantly discriminating and not significantly discriminating mixture pairs in the class. If half of subjects perform
better than fN,D , and half less, then half of subjects will
be considered to significantly discriminate mixture pairs
in the class (and half not), and so d will be set equal to
D. This is simply the definition of d.
The value fN,D for which that equation is satisfied depends upon α and T . fN,D is related to N and D through
the data, and so the value of D for which the equation is
satisfied (i.e. D = d) depends upon α , T , and the data.
However, it is inappropriate for the discriminability limen to depend on α and T in this way. As we showed
above, this has serious consequences for the estimate of
d, and therefore also for the estimate of z. It is what
makes z inconsistent.
Figure 10 shows the relationship between the critical
fN,D , T , and α . Note that this relationship is independent of the data. The data only determine how fN,D depends upon D and consequently determines z. In summary, a smaller (larger) value of α or T requires a much
higher (lower) value of fN,D to satisfy the equation. This
higher (lower) value of fN,D might only be found at a
much larger (smaller) value of D, implying a much larger
(smaller) value of d and therefore a much smaller (larger)
value of z.
With a sufficient number of subjects (or tests), even
barely above chance performance can produce estimates
of z equal to the largest possible number of stimuli (Figures 3 and 8). In fact, this is guaranteed by equation 4.
The critical values of fN,D required for statistical significance will asymptotically approach 13 (chance) as T approaches infinity. The same principle applies to a consideration of changes to the number of subjects S, instead of
the number of tests. This illustrates the core of the prob-

k  
1
T 1 i 2 T −i
α /2 > 1 − cd fbinomial (T, k, ) = ∑
( )( )
3
3 3
i=0 i
(3)
For α = 0.05, T = 20 (as used in [1]), this inequality
is satisfied for k >= 11. For each subject, k might be any
value between 0 and 20 depending on olfactory acuity. If
k >= 11 for more than 50% of subjects, then the value

10

cumulative probability

1.00
0.98
0.96

1- α

[5] M AMLOUK , A. M., C HEE -RUITER , C., H OFMANN , U. G., AND
B OWER , J. M. Quantifying olfactory perception: mapping olfactory perception space by using multidimensional scaling and
self-organizing maps. Neurocomputing 52 (2003), 591–597.

2

[6] M EISTER , M. Can humans really discriminate 1 trillion odors?
arXiv preprint arXiv:1411.0165 (2014).

0.8

[7] W EISS , T., S NITZ , K., YABLONKA , A., K HAN , R. M.,
G AFSOU , D., S CHNEIDMAN , E., AND S OBEL , N. Perceptual
convergence of multi-component mixtures in olfaction implies an
olfactory white. Proceedings of the National Academy of Sciences
(Nov. 2012).

0.6
0.4

T=5
T=20
T=80
T=320

0.2
0.0
0.0

0.2
0.4
0.6
0.8
fraction discriminated

[8] Z ARZO , M., AND S TANTON , D. T. Identification of latent variables in a semantic odor profile database using principal component analysis. Chem. Senses 31, 8 (Oct 2006), 713–724.

1.0

Figure 10: Fraction discriminated at which statistical significance is
reached. For each possible value of the number of tests T conducted
per mixture class, there is a cumulative distribution of the fraction f of
those tests that will be correctly discriminated, under the null hypothesis of chance ( 13 ) responding. The choice of significance threshold α
determines the fraction correct required to reject the null hypothesis,
and thus count as ‘significantly discriminating’ in the framework. For
a given value of α (0.05 shown here, and used in [1]), the fraction correctly discriminated required to reach this threshold varies greatly with
T . Rejecting the null hypothesis can thus be very easy or very hard
depending on T (or the number of subjects S, not shown), or on α .

lem. Discriminating significantly above chance can be a
very high bar or a very low bar depending on the parameters of the experiments and the analysis, including S, T ,
and α .

7 Acknowledgements
We thank Krishnan Padmanabhan and Shreejoy Tripathy
for helpful comments on the manuscript.

References
[1] B USHDID , C., M AGNASCO , M. O., V OSSHALL , L. B., AND
K ELLER , A. Humans can discriminate more than 1 trillion olfactory stimuli. Science (New York, N.Y.) 343, 6177 (Mar. 2014),
1370–1372.
[2] C ASTRO , J. B., R AMANATHAN , A., AND C HENNUBHOTLA ,
C. S. Categorical dimensions of human odor descriptor space
revealed by non-negative matrix factorization. PLoS ONE 8, 9
(2013), e73289.
[3] K HAN , R. M., L UK , C. H., F LINKER , A., A GGARWAL , A.,
L APID , H., H ADDAD , R., AND S OBEL , N. Predicting odor pleasantness from odorant structure: pleasantness as a reflection of the
physical world. J. Neurosci. 27, 37 (Sep 2007), 10015–10023.
[4] K OULAKOV, A. A., K OLTERMAN , B. E., E NIKOLOPOV, A. G.,
AND R INBERG , D. In search of the structure of human olfactory
space. Front Syst Neurosci 5 (2011), 65.

11

