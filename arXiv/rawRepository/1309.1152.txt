arXiv:1309.1152v2 [q-bio.PE] 17 Nov 2013

The inevitability of unconditionally deleterious
substitutions during adaptation
David M. McCandlish∗1 , Charles L. Epstein2 , and Joshua B. Plotkin1
1

2

Department of Biology, University of Pennsylvania, Philadelphia, PA
Department of Mathematics, University of Pennsylvania, Philadelphia, PA

Abstract

Studies on the genetics of adaptation typically neglect the possibility that a deleterious mutation might fix. Nonetheless, here we show that, in many regimes, the
first substitution is most often deleterious, even when fitness is expected to increase
in the long term. In particular, we prove that this phenomenon occurs under weak
mutation for any house-of-cards model with an equilibrium distribution. We find
that the same qualitative results hold under Fisher’s geometric model. We also provide a simple intuition for the surprising prevalence of unconditionally deleterious
substitutions during early adaptation. Importantly, the phenomenon we describe occurs on fitness landscapes without any local maxima and is therefore distinct from
“valley-crossing”. Our results imply that the common practice of ignoring deleterious substitutions leads to qualitatively incorrect predictions in many regimes. Our
results also have implications for the substitution process at equilibrium and for the
response to a sudden decrease in population size.

∗

To whom correspondence should be addressed. E-mail: davidmc@sas.upenn.edu.

1

Introduction
Organisms found in nature appear to be exquisitely adapted to their environments – so much
so that one might think adaptive changes dominate the process of evolution. However, a more
careful examination reveals that adaptive substitutions cannot be the whole story. First, the
genomes of organisms are filled with elements believed to be deleterious (Lynch, 2007). Second, genetic drift is known to permit the fixation of both neutral and mildly deleterious mutations, as is commonly observed in experimental populations (Halligan and Keightley, 2009).
Therefore, a fundamental question for evolutionary biology is to determine under what conditions a population’s fitness will tend to increase as opposed to decrease.
In this paper we consider this question in a simple case. We suppose that a population is
evolving in the regime of “weak mutation”, so that each new mutation is either lost or goes
to fixation before the next new mutation enters the population (e.g., Gillespie, 1983; Iwasa,
1988; Sella and Hirsh, 2005; Berg et al., 2004; McCandlish, 2011, 2013). We also assume the
“house of cards” model, so that the fitness of each new mutant is drawn independently from a
constant distribution (Kingman, 1977, 1978; Gillespie, 1984; Kauffman and Levin, 1987; Ohta
and Tachida, 1990; Flyvbjerg and Lautrup, 1992; Orr, 2002; Jain and Krug, 2007; Joyce et al.,
2008; Park and Krug, 2008). We then ask whether the first mutation that fixes in the population
is more likely to increase or decrease fitness.
The answer to this question is surprising. Even when a population is destined to adapt towards higher fitness over the long term, the first mutation to fix will often decrease fitness. We
quantify the effects of the first substitution in two ways. First, we study the expected selection coefficient of the first substitution. If the expected selection coefficient is positive, then
the fitness of the population is expected to increase in the short term. Second, we study the
probability that the first substitution is advantageous. If this probability exceeds one-half, then
the first substitution will be advantageous the majority of the time. Our main result is a mathematical theorem that characterizes the set of circumstances under which fitness tends to initially
increase or decrease.
In particular, we show that for essentially any distribution of mutational effects there exists
a range of initial fitnesses such that the expected selection coefficient of the first substitution
is negative. On its own, this result is not surprising. After all, if a population starts at the
highest possible fitness then it has nowhere to go but down. What is more surprising is that
this range of initial fitnesses always includes the equilibrium mean fitness, as well as fitnesses
smaller than the equilibrium mean. In other words, for many populations undergoing adaptation,
fitness is expected to decrease in the short term even though the expected fitness must eventually
increase to its equilibrium value in the long term. Likewise, we show that there is a range of
initial fitnesses, including values smaller than the equilibrium median fitness, such that the first
substitution will be deleterious a majority of the time.
2

Our results on the predominance of downhill steps, even during adaptation, may sound
surprising. But there is a simple, underlying reason why these phenomena occur. Even though
each individual deleterious mutation is extremely unlikely to fix, as the population increases in
fitness and approaches equilibrium there is an increasing supply of deleterious mutations (cf.
Hartl and Taubes, 1998; Silander et al., 2007). As a result, in total there is a substantial chance
– in fact, often a chance greater than 50% – that one of these deleterious mutations will be
the next to fix. At a mathematical level, the phenomena we discuss are consequences of a
deeper result, which we also prove, that the fitness achieved after a single substitution is always
probabilistically less than a fitness drawn from the equilibrium distribution.
Our results have several counter-intuitive consequences. As already mentioned, they imply
that evolution can be dominated by unconditionally deleterious substitutions in the short term
even if a population is expected to substantially increase in fitness in the long term. To put this
another way, the “fitness trajectory” (i.e. the expected fitness of the population viewed as a function of time, Kryazhimskiy et al., 2009) will often be non-monotonic. There is another apparently paradoxical consequence of our results: if one begins observing a well-adapted (i.e. equilibrial) population at a random time, the next substitution is more likely to be deleterious than
advantageous even though in the long term the frequency of deleterious and advantageous substitutions must be exactly equal (see, e.g. Tachida, 1991; Sella and Hirsh, 2005).
We test the generality of our results by investigating another model commonly used to study
adaptation, Fisher’s Geometric Model (Fisher, 1930; Kimura, 1984; Hartl and Taubes, 1996,
1998; Orr, 1998; Waxman and Peck, 1998; Poon and Otto, 2000; Martin and Lenormand, 2006),
which assigns fitnesses based on an n-dimensional continuous phenotype. We find that our
results hold in this case as well, in most regimes. Furthermore we demonstrate the existence of
a “cost of complexity” (Orr, 2000) where increasing the dimensionality of the phenotypic space
increases the probability that the first substitution is deleterious.
Our results are important because they challenge two standard ways of thinking about evolution. First, a very large literature on the genetics of adaptation (Orr, 2005) focuses on quantities such as the distribution of selection coefficients fixed in a sequence of adaptive substitutions (Orr, 1998, 2002; Joyce et al., 2008), the number of substitutions that occur before a
population arrives at a local optimum (Gillespie, 1984; Jain and Seetharaman, 2011), and the
rate of adaptation (Orr, 2000; Welch and Waxman, 2003; Martin and Lenormand, 2006). Although most studies in this literature declare by fiat that deleterious fixations cannot occur (e.g.,
by using 2s as the probability of fixation, Haldane, 1927), our work shows that a general theory
of adaptation must accommodate deleterious substitutions to achieve predictions that are even
qualitatively correct.
Second, there is a persistent intuition in the literature that fitness is expected to increase
when a population is below the equilibrium mean fitness and decrease when a population is
above the equilibrium mean fitness. According to this intuition, the equilibrium mean fitness
3

is precisely that fitness for which the expected fitness change is equal to zero. Our results
show that this intuition is false: in fact, fitness is expected to decrease when a population starts
at its equilibrium mean fitness. The standard intuition fails because it erroneously treats the
approach to equilibrium as a deterministic process around the equilibrium mean, whereas in
fact a stochastic treatment is required.
The remainder of our paper is organized as follows. We first explain our mathematical
framework for evolution under weak mutation, and we present our main results for the house-ofcards model. We then illustrate our results by considering a well-studied case where the fitness
distribution is Gaussian (Tachida, 1991, 1996; Gillespie, 1994). We follow this by analyzing
Fisher’s geometric model, in which we observe and analytically quantify the same qualitative
results found in the house-of-cards model. We conclude by discussing the significance of our
results in the context of the broader literature on adaptation.

Methods
Evolutionary dynamics
We consider a haploid population of size N evolving in the limit of weak mutation, so that
each new mutation either goes to fixation or is lost from the population before the next new
mutation enters the population. In this limiting regime we can neglect periods of polymorphism
and simply model the population as monomorphic, jumping from one genotype to another at
each fixation event. We assume that new mutations enter the population as a Poisson process
with rate N . Thus, time is measured in terms of the expected number of substitutions that would
have accumulated in the population if all mutations were neutral.
Our most important assumption is that the fitness of each new mutation is drawn independently from some fixed probability distribution ψ that does not depend on the current fitness of
the population. In the literature, this is known as the House of Cards (HOC) model (Kingman,
1977, 1978). We assume that ψ is a continuous probability distribution, and we denote its probability density function as ψ(y), where ψ(y) dy gives the probability that the fitness of a new
mutation lies in the interval [y, y + dy].
Throughout, we assume that fitnesses are measured in terms of relative Malthusian fitness (also known as additive fitness, Sella and Hirsh, 2005), which is the log of the relative
Wrightian fitness (expected number of offspring divided by the expected number of offspring
of some arbitrary type) (Crow and Kimura, 1970; Wagner, 2010; Houle et al., 2011). We define
the selection coefficient as the fitness difference between the new mutant and the allele currently fixed in the population. This definition approximates the standard selection coefficient
4

when relative Wrightian fitnesses are close to 1 (with the approximation becoming exact in the
diffusion limit). While these choices allow a more elegant presentation, our results also hold
for Wrightian fitnesses and the standard selection coefficient (see Appendix A).
Suppose a population is currently fixed for an allele with fitness x. What is the instantaneous
rate of substitution to any other fitness, y, which we denote Q(y|x) dy? Alleles with fitness y
originate within the population by mutation at rate N ψ(y) dy, and each such mutation fixes
with probability u(s, N ), where s is the selection coefficient, s = y − x. Multiplying the rate of
origination by the probability of fixation yields the rate at which a population jumps from one
fitness to another:
Q(y|x) dy = N ψ(y) u(y − x, N ) dy.

(1)

Thus, if P (x, t) denotes the probability that the population is at fitness x at time t, we have:
∂P (x, t)
=
∂t

Z

∞

P (y, t) Q(x|y) − P (x, t) Q(y|x) dy

(2)

−∞

In other words, the population’s fitness is described by a continuous time and state Markov
process whose transition rates are given by Equation 1. We also assume that at t = 0 the
population has some particular initial fitness, i.e. P (x, 0) = 1 for some fitness x.
In what follows, we use the probability of fixation for a Moran process: (Moran, 1959, see
also McCandlish et al. In prep.):

u(s, N ) =

1 − e−s
1 − e−N s

(3)

so that our results hold exactly for a haploid Moran process in the limit of weak mutation. However, our results also hold approximately for a diploid Wright-Fisher process in the absence of
dominance and in the limit of weak mutation, provided we adjust appropriately for the difference in chromosomal population size and for the slight difference in the form of the probability
of fixation (see Sella and Hirsh, 2005).

Statistics describing the evolutionary process
In this section we define some quantities that describe the process of evolution under weak
mutation. We let k(x) denote the substitution rate for a population with fitness x and m(x)
5

the mean selection coefficient of the first mutation to fix in a population initially at fitness x.
Furthermore, we let p(x) denote the probability that this substitution will be advantageous.
Aside from the first substitution event, we are also interested in how the expected fitness of
the population changes over time. We let Fx (t) denote the expected fitness of a population at
time t given that its fitness was x at time t = 0. Following (Kryazhimskiy et al., 2009), we call
Fx (t) the fitness trajectory.
The properties of the first mutation to fix are related to the shape of the fitness trajectory. In
particular, the first derivative of the fitness trajectory with respect to time at t = 0 is simply the
product of the substitution rate and the expected selection coefficient of the first substitution:
∂
F (t)t=0 = m(x )k(x). However, as a technical matter it is worth noting that these means,
∂t x
m(x) and Fx (t), may not necessarily be finite in some instances, for example if ψ has extremely
heavy tails (see Joyce et al., 2008).

Results
The equilibrium distribution
In order to analyze evolution on an HOC landscape we must first determine whether the
population eventually reaches an equilibrium distribution, and, if so, what form the equilibrium
distribution takes.
The equilibrium distribution, which we will write as π, describes the long-term probability
of finding the population at any given fitness. Moreover, for a population at equilibrium, the
frequency of substitutions into fitness class y is equal to the frequency of substitutions from y
to other fitnesses. If an equilibrium distribution π exists it must be unique, since our model
operates in continuous time and there is a positive transition rate from every fitness x to the
region where ψ is non-zero.
From these conditions, it is easy to show that if π exists then its probability density function,
π(y), must be proportional to ψ(y)e(N −1)y (Iwasa, 1988; Berg et al., 2004; Sella and Hirsh,
2005). As a result, the equilibrium π exists and its probability density function is given by
ψ(y)e(N −1)y
,
(N −1)z dz
ψ(z)e
−∞

π(y) = R ∞

(4)

R∞
provided that the normalizing constant Z = −∞ ψ(z)e(N −1)z dz is finite. This gives a mathematical condition for the existence of the equilibrium distribution, but not a biological condition,
6

i.e. one defined in terms of the evolutionary dynamics. We have derived such a condition, which
will be presented more fully elsewhere. Roughly speaking, this condition states that an equilibrium distribution exists if the fraction of advantageous substitutions, p(x), decreases to zero as
the initial fitness, x, increases. More precisely, if the limit as x → ∞ of p(x) equals zero for a
population of size N , then an equilibrium distribution with finite mean exists for a population
of size N − 1.

Deleterious substitutions can dominate short-term evolution
We are now in a position to state our main results. In Appendix A, we prove the following
theorem: for any choice of population size N > 1 and fitness distribution ψ such that an equilibrium distribution π with a finite mean exists, there exists some fitness x1 such that m(x) < 0
for any x > x1 and furthermore x1 is less than the mean of π. What this result says is that, for
any population whose starting fitness exceeds some constant, x1 , the first substitution to fix is
expected to have a negative selection coefficient. Indeed, the average selection coefficient of
the first substitution is guaranteed to be negative when starting at the equilibrium mean fitness,
and also when starting with a fitness within some range strictly less than the equilibrium mean.
This result
 has important consequences for the shape of the fitness trajectory, Fx (t). Recall
∂
that ∂t Fx (t)t=0 , the initial slope of the fitness trajectory starting at x, has the same sign as
mean selection coefficient of the first mutation to fix, m(x). Therefore, for any starting fitness
in the interval between x1 and the mean equilibrium fitness, the fitness trajectory must initially
be decreasing. Nonetheless, because asymptotically the fitness trajectory must approach the
equilibrium mean fitness, such trajectories must eventually increase back towards the equilibrium mean. Thus, provided an equilibrium with finite mean exists, for any choice of population
size N > 1 and HOC model ψ, there is a range of starting fitnesses that produce non-monotonic
fitness trajectories: fitness is expected to decrease in the short term, and then increase towards
the equilibrium mean in the long term.
Figure 1A gives an example of such a trajectory (black curve). The population starts below
the equilibrium mean fitness (dashed line), and its expected fitness decreases initially, even
though in the long term this expectation increases to the equilibrium mean fitness (Figure 1A,
inset).
Figure 1A also shows several realizations of individual population histories (gray lines),
which provide some insight into why the fitness trajectory (i.e. the ensemble mean fitness)
has a non-monotonic shape. There are two things to notice about these trajectories. First, the
individual trajectories tend to exhibit early deleterious substitutions. The preponderance of early
deleterious substitutions is shown in Figure 1B. Second, notice that the more fit a population, the
longer the waiting time until the next substitution (see, e.g. the upper-right corner of Figure 1A).
7

B

0.010

0.5

0.015

0.010

0.005

0.005

1.0

proportion of fixations
that are advantageous

0.015

relative Malthusian fitness

A

0

250

500

time

0

5000

10000

750

1000

0.0

0

25

time

Figure 1: A. A non-monotonic fitness trajectory (black line). The population begins with fitness
.009, which is below the equilibrium mean fitness of .010 (dashed line). The fitness trajectory
(that is, the ensemble mean fitness) decreases initially, even though it then increases towards
the equilibrium mean in the long term (inset). Ten individual population realizations are shown
in light gray (some of these trajectories extend below the region shown on the y-axis). B.
The expected proportion of substitutions that are advantageous, as a function of time, starting
again from fitness .009. Both panels are the result of 100, 000 simulations with the following
parameters: N = 1001, and the mutational distribution ψ is normal with mean 0 and variance
10−5 . The proportion of advantageous fixations was calculated as the expected advantageous
substitution rate across this ensemble of populations, divided by the expected total substitution
rate.

8

50

This means that once a population fixes an extremely fit genotype it will tend to remain at that
genotype for a very long time. At short time scales, however, such advantageous mutations
are unlikely to have occurred, whereas over the long term it becomes increasingly likely that
a high-fitness genotype will enter a population and go to fixation. Thus, following its shortterm decline, the ensemble mean fitness eventually increases, as populations in the ensemble
eventually acquire a substitution to a very high fitness.
Our first result described above pertains to the expected selection coefficient of the first substitution, and not to the probability that this first substitution will be deleterious or advantageous.
We have thus derived a corresponding result that characterizes how often the first substitution
is deleterious. In particular, in Appendix A, we prove that for any choice of N > 1 and ψ such
that an equilibrium distribution π exists, there exists some fitness x2 such that p(x) < 1/2 for
x > x2 , and, furthermore, x2 is less than the median of π. What this result says is that for any
population whose starting fitness exceeds some constant, x2 , the first substitution to fix is more
likely to be deleterious than advantageous. Moreover, even if the initial fitness is drawn at random from the equilibrium distribution then the next substitution will be deleterious a majority
of the time (see Appendix A).
Our results on the mean and the median fitness after one substitution are both consequences
of a more general set of results we prove in Appendix A and Supporting Information S1. These
results yield a simple picture for how the distribution of fitnesses following a substitution depends on a population’s initial fitness. In particular, we show that increasing the initial fitness
of a population always shifts the distribution of fitnesses after one substitution to the right, and
that this distribution approaches the equilibrium distribution as the initial fitness increases to
infinity. Likewise, decreasing the initial fitness shifts the distribution of fitnesses after the first
substitution to the left, and this distribution approaches ψ in the limit of a large, negative initial
fitness. When we say that a random variable X is to the “left” of a random variable Y we
mean that every quantile of Y is greater than the corresponding quantile of X, except perhaps
for the 0-th and 1-st quantiles; one might also say that the random variable X is stochastically
less than the random variable Y . These results are illustrated graphically in Figure 2, which
shows the probability distributions π and ψ, together with the fitness distribution after the first
substitution, for several different choices of the population’s initial fitness.
The key implication of Figure 2 is that the distribution of fitnesses following one substitution
is always to the left of the equilibrium distribution, irrespective of the initial fitness. As a result,
the mean of the fitness distribution after one substitution must always be less than the mean of
the equilibrium distribution (Appendix A). And so, if a population starts at the equilibrium mean
fitness, then its mean fitness must be reduced by the first substitution – which is equivalent to
saying that the expected selection coefficient of the first substitution is negative. A similar result
holds for a population starting at the median of the equilibrium fitness distribution (Appendix
A).

9

200
150

probability
density

mutational
distribution

initial fitness
0.01
0.02
0.03
0.04

100
50

equilibrium
distribution

0

1.00

initial fitness
0.01
0.02
0.03
0.04

0.75

cumulative
probability

0.50
0.25

mutational
distribution

0.00
0.00

equilibrium
distribution
0.01

0.02

0.03

relative Malthusian fitness

0.04

Figure 2: The distribution of fitnesses following one substitution is bounded between the mutational distribution, ψ, and the equilibrium distribution, π. The top panel shows probability
density functions and the bottom panel shows corresponding cumulative distributions. Black
curves correspond to the mutational distribution, ψ, which is a Gamma-distributed with shape
20 and mean .01, in this example; and the corresponding equilibrium distribution, π, which is
Gamma-distributed with shape 20 and mean .02; N = 1001. The distribution of fitnesses following the first substitution are shown in gray lines, for populations initially at fitness x = .01,
x = .02, x = .03 and x = .04. Notice that the cumulative distribution functions for all x are
bounded between the cumulative distribution functions for the mutational distribution and for
the equilibrium distribution; also note that the cumulative distributions shift monotonically to
the right with increasing x.

10

In summary, we have shown that under the house of cards model deleterious substitutions
are expected to occur while a population is adapting – that is, while a population is still below its equilibrium mean fitness. Indeed, deleterious substitutions can be more likely to occur
than advantageous substitutions during adaptation. Moreover, such mutations are unconditionally deleterious in the sense that they have no productive value for potentiating subsequent
adaptation. We stress the generality of these results, which hold for any choice of mutational
distribution ψ and for any population size N > 1 so long as an equilibrium distribution with
finite mean exists. As we shall soon see, some choices of ψ guarantee such an equilibrium
for all N , which implies that the predominance of deleterious substitutions persists even when
selection against deleterious substitutions is arbitrarily strong.

Case study: the Gaussian House of Cards
Our main result guarantees a range of initial fitnesses for which the initial step in adaptation is dominated by deleterious fixations. But how large is this range of initial fitnesses? To
investigate this question we consider the best-studied version of the HOC model, in which the
distribution of mutational effects, ψ, is Gaussian with mean µ and standard deviation σ. In this
case, it has been shown (Tachida, 1991, 1996) that, for any choice of N and σ, the equilibrium
distribution, π, is also Gaussian, with standard deviation σ and mean µ + (N − 1)σ 2 .
Because ψ and π are both normally distributed with the same variance, we can conduct
a nice analysis by exploiting symmetry. In particular, consider the point half-way between the
means of ψ and π, which we denote by x∗ = µ+(N −1)σ 2 /2. It turns out that the distribution of
fitnesses fixed by the first substitution for a population that starts with fitness x∗ + c is the same
distribution as for a population starting at x∗ −c when this distribution is reflected across x∗ (see
Supporting Information S2). Thus, m(x∗ + c) = −m(x∗ − c) and p(x∗ + c) = 1 − p(x∗ − c).
In particular, this means that m(x∗ ) = 0 and p(x∗ ) = 1/2.
Intuitively, these results suggest that the region where deleterious substitutions dominate
evolution includes all initial fitness greater than x∗ . We verified this conjecture using a systematic numerical search for all parameters σ between 10−5 and 10 and (N − 1)σ between 10−3
and 20. In all cases examined we found m(x) < 0 and p(x) < 1/2 for x > x∗ . Thus, when
a population starts at the mean of the mutational fitness distribution, deleterious substitutions
begin to dominate once the population’s fitness has increased half-way to its long-term expected
value. In other words, there is a substantial range of fitnesses for which deleterious substitutions
dominate adaptation.
The symmetry argument above also provides some insight about the size of the selection
coefficients of the first substitution. For instance, if the population starts at the mean fitness
of the mutational distribution, then one intuitively expects the first substitution to have a large,
11

positive effect due to the abundant supply of advantageous mutations. This intuition is indeed
correct. At the same time, by symmetry, this intuition also implies that if a population starts at
the equilibrium mean fitness, then the first substitution will typically have a large, deleterious
effect.
In order to illustrate the preceding results, consider the case in which µ = 0, σ 2 = 10−5
and N = 1001 (Figure 3). In this case, the equilibrium fitness distribution is Gaussian with
mean .01 and variance 10−5 , so that the average selection coefficient of new mutations, for a
population with the equilibrium mean fitness, is N s ≈ −10. Despite this large, negative average selection coefficient, for a population starting at the equilibrium mean fitness, the first
substitution is deleterious 89% of the time, and the average selection coefficient of the first
substitution is N s = −3.1. The bottom two panels of Figure 3 also show our analytical approximation (solid lines) as compared with the exact results (points, as determined by numerical
integration), see Supporting Information S3.
It is important to remember that the symmetry about x∗ = µ + (N − 1)σ 2 /2 with respect
to the distribution of fitnesses in the first substitution does not imply that all dynamics are
symmetrical. Note in particular that because u(y − x, N ) is increasing in x for N > 1, the
substitution rate, k(x), is a strictly decreasing function of the fitness x for any HOC model
with N > 1. This implies, for instance, that while the fraction of deleterious substitutions at
x∗ + c equals the fraction of advantageous substitutions at x∗ − c, the actual rate of deleterious
substitutions at x∗ + c must be less than the rate of advantageous substitutions at x∗ − c. In
the example above, with µ = 0, σ = .01 and N = 1001, the substitution rate at fitness µ is
1.62 times the neutral substitution rate, at fitness z it is 22% of the neutral substitution, and at
the equilibrium mean fitness the substitution rate is 1.1% of the neutral rate. Thus, while the
average fitness effect of a substitution starting from the equilibrium mean fitness is relatively
large and negative, the expected waiting time for this first fixation to occur is much longer than
the waiting time starting from the mean of the HOC fitness distribution.

Case study: Fisher’s geometric model
Our results for the HOC model do not necessarily hold when the distribution of fitnesses
introduced by mutation is allowed to depend on the current fitness (Kryazhimskiy et al., 2009).
For instance, in this more general class of correlated fitness landscapes it is possible to find
circumstances where the expected selection coefficient is positive when a population starts at
its equilibrium mean fitness. An immediate question, then, is whether the HOC model is pathological in some sense, or whether our qualitative results hold for other commonly used fitness
landscapes.
In order to investigate this question, we turn to Fisher’s geometric model (FGM), which
has emerged as an important framework for understanding both adaptive and nearly neutral
12

125
100

probability
density

75
50
25
0
0.010

expected
selection
coefficient of
first substitution

0.005

0.000

0.005

0.010
1.00

probability that
first substitution
is deleterious

0.75
0.50
0.25
0.00
0.010

0.005

0.000

0.005

0.010

0.015

0.020

relative Malthusian fitness

Figure 3: Probability density function of the HOC fitness distribution, ψ, and the equilibrium
distribution, π, together with the expected fitness effect of the first substitution, m(x), and the
probability that the first substitution will be deleterious, 1 − p(x), all expressed as functions of
the initial fitness, x. The HOC distribution is Gaussian with µ = 0 and σ 2 = 10−5 ; N = 1001.
Vertical lines denote the mean of the HOC distribution, the mean fitness at equilibrium, and
the average of these two fitnesses, x∗ . Solid lines in the bottom two plots show our analytical
approximations (see Supporting Information S3); the individual points denote exact results as
determined by numerical integration.

13

evolution (Fisher, 1930; Kimura, 1985; Hartl and Taubes, 1996, 1998; Orr, 1998). In addition
to its prominence in the contemporary literature, we have chosen to study FGM because it is
typically thought of as a paradigmatic example of a smooth, correlated fitness landscape. This
contrasts with the HOC model, which is an uncorrelated or rugged landscape (Kauffman and
Levin, 1987). If our results were caused by the uncorrelated nature of the HOC model, then we
would not expect to find the same results in Fisher’s geometric model.
For the sake of concreteness, we will consider a specific, widely used version of FGM (Martin and Lenormand, 2006; Martin et al., 2007; Martin and Lenormand, 2008; Tenaillon et al.,
2007; Lourenço et al., 2011) which assumes that Malthusian fitness falls off quadratically with
the distance to some optimum phenotype in an n-dimensional phenotypic space. In particular,
we assume that the relative Malthusian fitness of any phenotype z is given by −(1/2)||z||2 ,
where ||z|| is the Euclidean distance to the optimum phenotype. This is equivalent to assuming
that relative Wrightean fitness is a Gaussian function of the distance to the phenotypic optimum.
In addition, we assume that the distribution of phenotypes produced by mutation is multivariate
Gaussian with variance λ centered at the current phenotype z, and that new mutations enter the
population as a Poisson process at rate N .
Under this model, for a population fixed for a phenotype with fitness x, the fitness of new
mutants is distributed as −λ/2 times a non-central chi-squared distributed random variable with
n degrees of freedom and non-centrality parameter −2x/λ (this follows from Appendix 2 of
Martin and Lenormand, 2006). Furthermore, it can readily be confirmed using Tenaillon et al.
(2007)’s method that the equilibrium distribution for N > 1 is −1 times a gamma distributed
random variable, where the gamma distribution has shape n/2 and scale 1/(N − 1) (note that
this distribution is independent of λ, Sella and Hirsh, 2005; Tenaillon et al., 2007). In particular,
the equilibrium mean fitness is −n/(2(N −1)) ≈ −n/(2N ), and while no analytical expression
exists for the median of this distribution, the median is always greater than the mean (Chen and
Rubin, 1986).
The analysis of this model can be simplified by recognizing that the evolutionary dynamics of the model are much easier to understand if we work in scaled fitnesses, N x, instead of
fitness. This is because, to a very close approximation, under FGM the evolutionary dynamics
of a population when measured in terms of scaled fitnesses depend only on the dimensionality,
n, and on the compound parameter N λ (Supporting Information S4.1). Thus, in addition to the
probability that the first substitution is deleterious when starting from the equilibrium median
fitness, it is most useful to examine the expected scaled selection coefficient (N s) for a population starting at the equilibrium mean fitness and to consider the behavior of these quantities as
a function of n and N λ.
Figure 4 shows us that the evolutionary dynamics under FGM fall in one of two regimes,
depending on the value of N λ. When N λ is very close to zero, the expected scaled selection
coefficient of the first substitution is also close to zero (or indeed, sometimes very slightly posi14

0

n=1

expected scaled
1
selection
coefficient of
first substitution 2
starting at the
equilibrium
3
mean fitness

n=5
n = 10

n = 20

4
0

10

20

30

Nλ

40

Tail
Approx.

1.0

probability first
substitution is
deleterious
starting at the
equilibrium
median fitness

n = 20
n = 10
n=5

0.8

n=1

0.6
0.4
0.2
0.0

0

10

20

30

Nλ

40

Tail
Approx.

Figure 4: Expected scaled selection coefficient of the first substitution, starting from the equilibrium mean fitness, and fraction of substitutions that are deleterious, starting from the equilibrium median fitness, under Fisher’s geometric model. Both panels show these quantities
as a function of N λ, for three values of N (N = 11, light gray; N = 101, dark gray;
N = 1001, black) and for several different values of the phenotypic dimensionality n. The
lines for N = 101 and N = 1001 are almost completely overlapping. Small circles show the
asymptotic, large N λ values, based on Martin and Lenormand (2008)’s tail approximation.

15

tive). Similarly, in this regime, the fraction of substitutions that are deleterious is approximately
one-half. Thus, if mutations have extremely small effects, the naive intuitions discussed in the
Introduction are basically accurate.
However, when N λ is greater than approximately 2, the situation is quite different: all of
the qualitative results we derived for the HOC model also hold in this regime. In particular,
the expected selection coefficient starting from the equilibrium mean fitness is negative; and
the majority of substitutions starting from the equilibrium median fitness are deleterious (Figure 4). Furthermore, in this regime increasing the dimensionality of phenotype space decreases
the expected scaled selection coefficient of the first substitution and increases the proportion
deleterious first substitutions (Figure 4). This constitutes a “cost of complexity” (Orr, 2000) in
that increasing the dimensionality of the phenotypic space makes the dynamics less favorable
for an adapting population.
To better understand this large N λ regime, it is helpful to note that both of our statistics
of interest become less sensitive to N λ as N λ becomes large. In this regime, most mutations
are deleterious and strongly selected against, which suggests that mutations destined for fixation will tend to come from the right tail of the mutational fitness distribution. Indeed, as N λ
becomes large, one can show that the mutational distribution converges to a tail approximation
previously introduced by Martin and Lenormand (2008) (see Supporting Information S4.2).
This tail approximation also suggests a method for deriving analytical results in the large N λ
regime. In particular, Martin and Lenormand (2008) derive a number of results using this tail
approximation in conjunction with an approximation for the probability of fixation that allows
only for advantageous fixations. By modifying their method to allow for the possibility of deleterious fixations, we obtain the following simple expression for the proportion of substitutions
that will be advantageous, starting from the equilibrium median fitness (Supporting Information
S4.3):
1
.
(5)
2 + n/2
This expression clearly indicates that, in the large N λ regime, the proportion of deleterious
substitutions from the equilibrium median fitness exceeds 1/2 and is an increasing function of
the phenotypic dimensionality, n. Applying similar methods to the expected scaled selection
coefficient of the first substitution from the equilibrium mean fitness indicates that for large N λ
this quantity is 1) always negative and 2) solely a function of n (Supporting Information S4.3).

Discussion
We have demonstrated that evolution can be dominated by deleterious substitutions in the
short term even when adaptation will eventually occur over the long term. Critically, this initial
16

decrease in fitness is not due to alleles that potentiate or otherwise promote the subsequent increase in fitness (Cowperthwaite et al., 2006), as would occur if these populations were crossing
fitness valleys (Wright, 1932; Kimura, 1985; van Nimwegen and Crutchfield, 2000; Weinreich
and Chao, 2005; Weissman et al., 2009). Rather, this decrease in fitness is due to unconditionally deleterious substitutions that have absolutely no effect other than to decrease the fitness of
the population. Our results imply that studies of adaptation that ignore deleterious substitutions
must give qualitatively incorrect predictions, at least in some regimes.
More precisely, we have considered a population evolving under a Moran process in the
limit of weak mutation, where the fitnesses of new mutations are drawn independently from
some fixed distribution (Kingman, 1977, 1978, i.e., the house of cards model). Our results
hold for arbitrarily large populations, and hence arbitrarily strong selection, under only the
condition that a long-term equilibrium distribution exists with finite mean. This condition is
always satisfied under the biologically plausible assumption that the probability that the next
substitution be advantageous approaches zero as the fitness of a population increases to infinity.
Our two main results guarantee a region of initial fitnesses, below the equilibrium mean fitness, where the expected selection coefficient of the first substitution is negative; and a region of
initial fitnesses, below the equilibrium median fitness, where the first substitution will be deleterious a majority of the time. In addition, we have shown qualitatively similar behavior under
Fisher’s Geometric Model, where a “cost of complexity” (Orr, 2000; Martin and Lenormand,
2006) also arises, so that the magnitude of these effects becomes larger as the dimensionality of
the phenotypic space increases (c.f. Fisher, 1930).
Our results are surprising, and so it is important to develop some intuitions for why they
hold. At the most basic level, our results are possible because the process of adaptation itself
tends to increase fitness until the vast majority of possible mutations are deleterious (Hartl and
Taubes, 1998; Silander et al., 2007). Indeed, this majority is eventually so vast that, at some
sufficiently high fitness, deleterious mutations become responsible for the bulk of substitutions.
At a slightly more detailed level, the question is one of time scales: natural selection is so
efficient that in the long term a population will spend most of its time at extremely rare, highfitness alleles. However, the waiting time for such alleles to enter the population by mutation is
extremely long, so that many populations will experience a deleterious substitution before even
having the opportunity to fix an allele with high fitness. Thus, fitness may tend to decrease in
the short term even though it will on average increase in the long term.
Finally, at a more mathematical level, our results follow from a deeper theorem that states
that, no matter what the initial fitness, every quantile of the distribution of fitnesses after one
substitution is less than the corresponding quantile of the equilibrium fitness distribution. We
have used this deeper result to derive our two main results, but it has other consequences that
we have not yet investigated in detail. For instance, consider a population that has experienced
17

a recent change in environment or in population size, such that its current fitness is much higher
than the equilibrium distribution. In this case, our result implies that the distribution of fitnesses
after one substitution occurs will be to the left of the equilibrium distribution. Thus, fitness does
not decrease to the new equilibrium by many small steps, but rather takes one large downhill
jump.
The relationship between the equilibrium fitness distribution and the distribution of fitnesses
after one substitution has an intuitive basis. In essence, high-fitness genotypes are occupied at
high frequency in equilibrium for two distinct reasons:
1. A population is more likely to become fixed for a high-fitness allele because the probability of fixation is greater for high-fitness mutations.
2. Once fixed at a high-fitness allele, the time until the next fixation tends to be long, because
of selection against deleterious substitutions.
While both of these factors push the equilibrium distribution towards very high fitnesses, only
the first factor influences the distribution of fitnesses after one substitution. As a result, the
distribution of fitnesses at equilibrium is always stochastically greater than the distribution of
fitnesses after one substitution.
This distinction between the two factors above, and their different effects on evolution, is
often neglected in the literature. In particular, the weak-mutation literature is primarily composed of two types of Markov models. In the first type of model, time is measured in units that
are independent of when substitution events occur – so that time continues to elapse during the
periods between subsequent substitution events in the population (see e.g. Iwasa, 1988; Sella
and Hirsh, 2005; Berg et al., 2004; Kryazhimskiy et al., 2009; McCandlish, 2013). In the second
type of model, time is always discrete, and each unit of time corresponds to a single substitution
event, no matter how long a population actually spends waiting in between substitution events
(e.g. Gillespie, 1983, 1984; Hartl and Taubes, 1998; Orr, 2002; Weinreich et al., 2006; Draghi
and Plotkin, 2013). Mathematically, a model of the first type is called the “full chain”; the
corresponding model of the second type is called the “embedded chain”. Both of these Markov
processes are important theoretical objects. However, while both of the above-mentioned factors influence the behavior of the full chain, only the first factor influences the behavior of the
corresponding embedded chain. This means that the full chain and the embedded chain can
have very different properties.
For instance, at equilibrium, evolution under the house of cards model is characterized by
periods of rapid substitutions among relatively low-fitness alleles interspersed with long periods of stasis at high-fitness alleles (Iwasa, 1993). As a result, the equilibrium distribution of
the full chain is concentrated at higher fitnesses than the equilibrium distribution of the embedded chain, since the embedded chain neglects the extra amount of time a population typically
18

spends fixed at high-fitness alleles (more precisely, the probability density function of the equilibrium distribution for the embedded chain is proportional to π(x) k(x), where the substitution
rate k(x) is a decreasing function of x). Which type of these two equilibrium distributions is
relevant for a particular purpose depends on whether one observes a population at a random
time (as is most often the case for empirical data), in which case the full chain is appropriate; or
whether one observes a population at a random substitution, in which case the embedded chain
is appropriate.
Our results also have several important implications for the common practice of ignoring
deleterious substitutions when studying adaptation. First, by demonstrating that adaptation can
occur even when unconditionally deleterious substitutions dominate short-term evolution, we
have shown that any satisfactory, general theory of adaptation must allow for the possibility of
deleterious substitutions.
Second, our results characterize the conditions under which deleterious substitutions initially dominate the the adaptive process, i.e. when a majority of substitutions are deleterious or
when fitness decreases in expectation. The range of parameters where deleterious substitutions
play a non-negligible role is likely to be much larger.
Third, we emphasize that the frequency of deleterious substitutions changes as a population
evolves. This frequency is therefore a property of the evolutionary dynamics rather than a
parameter that can be assigned at the outset.
Finally, the problem of neglecting deleterious substitutions is particularly acute for studies
that depend on “extreme value theory”, or “tail approximations,” because the mathematical
methods underlying such studies assume the current fitness is already in the extreme right tail
of the mutational fitness distribution. This is precisely the regime where we expect deleterious
substitutions to be most important and therefore precisely the regime where they should not
be neglected. One way forward for these studies is to incorporate approximations that allow
deleterious substitutions to occur, as we did here in our analysis of Fisher’s Geometric Model.
An important limitation of our current analysis is that it has been conducted in the limit of
weak mutation. It thus remains an open question how broadly these phenomena occur in other
population-genetic regimes. However, a recent study of cancer progression by McFarland et al.
(2013) suggests that similar dynamics, featuring a predominance of deleterious substitutions
despite long-term adaptation, may occur even in populations with substantial polymorphism.

Acknowledgements
We thank Ricky Der and Mitchell Johnson for fruitful discussions and Warren Ewens for
comments on the manuscript. J.B.P. acknowledges funding from the Burroughs Wellcome
19

Fund, the David and Lucile Packard Foundation, the James S. McDonnell Foundation, the Alfred P. Sloan Foundation, the U.S. Department of the Interior (D12AP00025), and the Foundational Questions in Evolutionary Biology Fund (RFP-12-16). J.B.P., C.L.E. and D.M.M.
acknowledge funding from the U.S. Army Research Office (W911NF-12-1-0552).

20

Literature Cited
Berg, J., S. Willmann, and M. Lassig, 2004. Adaptive evolution of transcription factor binding sites. BMC Evol. Biol. 4:42. URL http://www.ncbi.nlm.nih.gov/pubmed/
15511291.
Chen, J. and H. Rubin, 1986. Bounds for the difference between median and mean of gamma
and poisson distributions. Statistics & Probability Letters 4:281–283.
Cowperthwaite, M. C., J. Bull, and L. A. Meyers, 2006. From bad to good: Fitness reversals
and the ascent of deleterious mutations. PLoS Comput. Biol. 2:e141.
Crow, J. F. and M. Kimura, 1970. An Introduction To Population Genetics Theory. Blackburn
Press, Caldwell, New Jersey.
Draghi, J. A. and J. B. Plotkin, 2013. Selection biases the prevalence and type of epistasis along
adaptive trajectories. Evolution URL http://dx.doi.org/10.1111/evo.12192.
Fisher, R. A., 1930. The Genetical Theory of Natural Selection. Clarendon Press.
Flyvbjerg, H. and B. Lautrup, 1992. Evolution in a rugged fitness landscape. Physical Review
A 46:6714.
Gillespie, J. H., 1983. A simple stochastic gene substitution model. Theor. Popul. Biol.
23:202 – 215. URL http://www.sciencedirect.com/science/article/
pii/004058098390014X.
———, 1984. Molecular evolution over the mutational landscapes. Evolution 38:1116 – 1129.
URL http://www.jstor.org/stable/2408444.
———, 1994. Substitution processes in molecular evolution. III. Deleterious alleles. Genetics 138:943 – 952. URL http://www.genetics.org/content/138/3/943.
abstract.
Haldane, J. B. S., 1927. A mathematical theory of natural and artificial selection, part V:
Selection and mutation. Mathematical Proceedings of the Cambridge Philosophical Society
23:838 – 844. URL http://dx.doi.org/10.1017/S0305004100015644.
Halligan, D. L. and P. D. Keightley, 2009. Spontaneous mutation accumulation studies in evolutionary genetics. Annual Review of Ecology, Evolution, and Systematics 40:151–172.
Hartl, D. and C. Taubes, 1998. Towards a theory of evolutionary adaptation. Genetica 102-103:525 – 533. URL http://dx.doi.org/10.1023/A:1017071901530.
10.1023/A:1017071901530.

21

Hartl, D. L. and C. H. Taubes, 1996. Compensatory nearly neutral mutations: selection without adaptation. J. Theor. Biol. 182:303–309. URL http://dx.doi.org/10.1006/
jtbi.1996.0168.
Houle, D., C. Plabon, G. P. Wagner, and T. F. Hansen, 2011. Measurement and meaning in
biology. Q. Rev. Biol. 86:3–34.
Iwasa, Y., 1988.
Free fitness that always increases in evolution.
J. Theor. Biol.
135:265 – 281. URL http://www.sciencedirect.com/science/article/
pii/S0022519388802431.
———, 1993. Overdispersed molecular evolution in constant environments. J. Theor. Biol.
164:373 – 393. URL http://www.sciencedirect.com/science/article/
pii/S0022519383711616.
Jain, K. and J. Krug, 2007. Deterministic and stochastic regimes of asexual evolution on rugged
fitness landscapes. Genetics 175:1275 – 1288.
Jain, K. and S. Seetharaman, 2011. Multiple adaptive substitutions during evolution in
novel environments. Genetics 189:1029 – 1043. URL http://www.genetics.org/
content/189/3/1029.abstract.
Joyce, P., D. R. Rokyta, C. J. Beisel, and H. A. Orr, 2008. A general extreme value theory model
for the adaptation of dna sequences under strong selection and weak mutation. Genetics
180:1627–1643. URL http://dx.doi.org/10.1534/genetics.108.088716.
Kauffman, S. and S. Levin, 1987. Towards a general theory of adaptive walks on rugged landscapes. J. Theor. Biol. 128:11 – 45.
Kimura, M., 1984. The neutral theory of molecular evolution. Cambridge University Press.
———, 1985. The role of compensatory neutral mutations in molecular evolution. J. Genet.
64:7 – 19.
Kingman, J., 1977. On the properties of bilinear models for the balance between genetic mutation and selection. in Mathematical Proceedings of the Cambridge Philosophical Society,
vol. 81, Pp. 443–453. Cambridge Univ Press.
———, 1978. A simple model for the balance between selection and mutation. Journal of
Applied Probability Pp. 1–12.
Kryazhimskiy, S., G. Tkaçik, and J. B. Plotkin, 2009. The dynamics of adaptation on correlated
fitness landscapes. Proc. Natl. Acad. Sci. U. S. A. 106:18638 – 18643. URL http://www.
pnas.org/content/106/44/18638.abstract.

22

Lourenço, J., N. Galtier, and S. Glémin, 2011. Complexity, pleiotropy, and the fitness effect of mutations. Evolution 65:1559–1571. URL http://dx.doi.org/10.1111/j.
1558-5646.2011.01237.x.
Lynch, M., 2007. The origins of genome architecture. Sinauer Associates Inc.
Martin, G., S. F. Elena, and T. Lenormand, 2007. Distributions of epistasis in microbes fit
predictions from a fitness landscape model. Nat. Genet. 39:555–560. URL http://dx.
doi.org/10.1038/ng1998.
Martin, G. and T. Lenormand, 2006. A general multivariate extension of fisher’s geometrical
model and the distribution of mutation fitness effects across species. Evolution 60:893–907.
———, 2008. The distribution of beneficial and fixed mutation fitness effects close to an
optimum. Genetics 179:907–916. URL http://dx.doi.org/10.1534/genetics.
108.087122.
McCandlish, D. M., 2011. Visualizing fitness landscapes. Evolution 65:1544 – 1558. URL
http://dx.doi.org/10.1111/j.1558-5646.2011.01236.x.
———, 2013. On the findability of genotypes. Evolution URL http://dx.doi.org/10.
1111/evo.12128.
McCandlish, D. M., C. L. Epstein, and J. B. Plotkin, In prep. Formal properties of the probability of fixation: Identities, inequalities and approximations .
McFarland, C. D., K. S. Korolev, G. V. Kryukov, S. R. Sunyaev, and L. A. Mirny, 2013. Impact of deleterious passenger mutations on cancer progression. Proceedings of the National
Academy of Sciences 110:2910–2915.
Moran, P. A. P., 1959. The survival of a mutant gene under selection. Journal of the Australian
Mathematical Society 1:121 – 126.
Ohta, T. and H. Tachida, 1990. Theoretical study of near neutrality. I. Heterozygosity and rate
of mutant substitution. Genetics 126:219 – 229. URL http://www.genetics.org/
content/126/1/219.abstract.
Orr, H. A., 1998. The population genetics of adaptation: The distribution of factors fixed during
adaptive evolution. Evolution 52:935 – 949. URL http://www.jstor.org/stable/
2411226.
———, 2000. Adaptation and the cost of complexity. Evolution 54:13–20.
———, 2002. The population genetics of adaptation: The adaptation of DNA sequences.
Evolution 56:1317 – 1330.
23

———, 2005. The genetic theory of adaptation: A brief history. Nat. Rev. Genet. 6:119 – 127.
Park, S.-C. and J. Krug, 2008. Evolution in random fitness landscapes: the infinite sites model.
Journal of Statistical Mechanics: Theory and Experiment 2008:P04014.
Poon, A. and S. P. Otto, 2000. Compensating for our load of mutations: Freezing the meltdown of small populations. Evolution 54:1467 – 1479. URL http://dx.doi.org/10.
1111/j.0014-3820.2000.tb00693.x.
Sella, G. and A. E. Hirsh, 2005. The application of statistical physics to evolutionary biology. Proc. Natl. Acad. Sci. U. S. A. 102:9541 – 9546. URL http://www.pnas.org/
content/102/27/9541.abstract.
Silander, O. K., O. Tenaillon, and L. Chao, 2007. Understanding the evolutionary fate of finite
populations: the dynamics of mutational effects. PLoS Biol. 5:e94.
Tachida, H., 1991. A study on a nearly neutral mutation model in finite populations. Genetics
128:183–192.
———, 1996. Effects of the shape of distribution of mutant effect in nearly neutral mutation
models. J. Genet. 75:33–48.
Tenaillon, O., O. K. Silander, J.-P. Uzan, and L. Chao, 2007. Quantifying organismal complexity using a population genetic approach. PLoS One 2:e217. URL http://dx.doi.org/
10.1371/journal.pone.0000217.
van Nimwegen, E. and J. P. Crutchfield, 2000. Metastable evolutionary dynamics: Crossing
fitness barriers or escaping via neutral paths? Bull. Math. Biol. 62:799 – 848.
Wagner, G. P., 2010. The measurement theory of fitness. Evolution 64:1358–1376. URL
http://dx.doi.org/10.1111/j.1558-5646.2009.00909.x.
Waxman, D. and J. R. Peck, 1998. Pleiotropy and the preservation of perfection. Science
279:1210–1213.
Weinreich, D. M. and L. Chao, 2005. Rapid evolutionary escape by large populations from
local fitness peaks is likely in nature. Evolution 59:1175 – 1182.
Weinreich, D. M., N. F. Delaney, M. A. DePristo, and D. L. Hartl, 2006. Darwinian evolution
can follow only very few mutational paths to fitter proteins. Science 312:111 – 114.
Weissman, D. B., M. M. Desai, D. S. Fisher, and M. W. Feldman, 2009. The rate at which
asexual populations cross fitness valleys. Theor. Popul. Biol. 75:286 – 300.
Welch, J. J. and D. Waxman, 2003. Modularity and the cost of complexity. Evolution 57:1723–
1734.
24

Wright, S., 1932. The roles of mutation, inbreeding, crossbreeding and selection in evolution.
in Proceedings of the Sixth International Congress of Genetics, Pp. 356 – 366.

25

Appendix A

Proof of the main result

In this appendix, we provide a characterization of the distribution of fitnesses after one
substitution. In particular, we provide bounds on the mean and cumulative distribution function
of this distribution in terms of the means and cumulative distribution functions of the mutational
fitness distribution, ψ, and the corresponding equilibrium distribution, π. Additional results
describing how changing the initial fitness of the population changes the distribution of fitnesses
after one substitution can be found in Supporting Information S1.
More formally, the distribution of fitnesses after one substitution has a probability density
function given by Q(y|x)/k(x)
R ∞ dy, where Q(y|x) dy is the substitution rate from x to the interval [y, y + dy] and k(x) = −∞ Q(y|x) dy is the substitution rate at x. In order to understand
the structure of this distribution, we first state a very general result concerning the expected
value of any non-decreasing function, f , of fitness with respect to the distribution of fitnesses
after one substitution as compared with the expected value of f for fitnesses drawn from ψ and
π. Deferring the proof of the main result until the end of this Appendix, we then state several corollaries corresponding to statements made in the main text, where these corollaries are
derived by making specific choices for the non-decreasing function f .
Here is the general result:
Theorem 1. Under the house of cards model with a continuous mutational distribution ψ and
with N > 1, for any arbitrary initial fitness x and non-decreasing, real-valued function f
defined on the real line, we have
Z

∞

Z

∞

Q(y|x)
dy ≤
f (y) ψ(y) dy ≤
f (y)
k(x)
−∞
−∞

Z

∞

f (y) π(y) dy

(A1)

−∞

whenever the corresponding integrals are finite. The above inequalities are strict if there exist
two open intervals of non-zero length within the support of ψ such that the value of f is strictly
greater for members of the first interval than it is for members of the second.
Our biological results then follow by picking particular non-decreasing functions f .
Corollary 2 (Expected fitness after one substitution). For any N > 1, continuous probability
distribution ψ, and any choice of initial fitness:
1. The expected Malthusian fitness after one substitution is strictly less than the expected
Malthusian fitness at equilibrium and strictly greater than the expected Malthusian fitness
of new mutations, should these expectations be finite.
26

2. The expected Wrightean fitness after one substitution is strictly less than the expected
Wrightean fitness at equilibrium and strictly greater than the expected Wrightean fitness
of new mutations, should these expectations be finite.
Proof. The first statement follows directly from Theorem 1 by choosing f (y) = y. This function is strictly increasing and so the condition for the strictness of the inequalities is satisfied.
The second statement follows directly from Theorem 1 by choosing f (y) = ey (Malthusian
fitness is simply log Wrightean fitness); this function is also strictly increasing and so the inequalities are strict.
An immediate consequence of this corollary is that for a population that starts at the equilibrium mean fitness, the first substitution is expected to decrease fitness and so the expected
selection coefficient of the first substitution is negative. The fact that the expected selection
coefficient of the first substitution is a continuous function of the initial fitness (see Supporting
Information S1 for a proof) implies the existence of some critical initial fitness, strictly less than
the equilibrium mean fitness, such that the expected selection coefficient of the first substitution
is always negative for initial fitnesses greater than this initial fitness, as stated in the main text.
See also Supporting Information S1 for a proof that the expected selection coefficient of the
first substitution is finite whenever either of 1) the mean fitness of new mutations or 2) the mean
fitness at equilibrium is finite.
Corollary 3 (Cumulative distribution function of fitness after one substitution). For N > 1,
any continuous probability distribution ψ, any choice of initial fitness x, and for all fitnesses z
such that the probability that a new mutant has fitness less than or equal to z is strictly between
0 and 1, the cumulative distribution function of the distribution of fitnesses after one mutation
is strictly less than the cumulative distribution function of the mutational distribution and, if an
equilibrium distribution exists, strictly greater than the cumulative distribution function of the
distribution of fitnesses at equilibrium.
Proof. Let f be the function that takes the value 1 on the interval (z, ∞) and 0 otherwise. Then
Theorem 1 gives us:
Z

∞

Z
ψ(y) dy <

z

z

∞

Q(y|x)
dy <
k(x)

Z

∞

π(y) dy

(A2)

z

Rz
where the inequalities are strict since 0 < −∞ ψ(y)dy < 1 implies that there exists an open
interval where ψ(y) > 0 with y < z and another open interval where ψ(y) > 0 with y > z.

27

However, since probability distributions must integrate to 1, we also have
Z

z

Z

z

ψ(y) dy >
−∞

−∞

Q(y|x)
dy >
k(x)

Z

z

π(y) dy

(A3)

−∞

as required.
This corollary then allows us to prove the following result:
Corollary 4 (Quantiles of fitness after one substitution). N > 1, any continuous probability
distribution ψ, any choice of initial fitness x, and any choice of q ∈ (0, 1), the q-th quantile of
the distribution of fitnesses after one substitution is strictly greater than the q-th quantile of the
distribution of fitnesses introduced by mutation and, if an equilibrium distribution exists, strictly
less than the q-th quantile of the equilibrium fitness distribution.
Proof. This follows immediately from Corollary 3 by choosing z to be the q-th quantile of the
distribution of fitnesses after one substitution.
Results about when a majority of substitutions are deleterious then follow from choosing
q = 1/2 and asking when this quantile is less than the initial fitness. If the initial fitness is the
equilibrium median fitness, then the median fitness after one substitution is less than the initial
fitness, meaning that the probability that the first substitution is deleterious is greater than 1/2.
The fact that the probability that the first substitution is deleterious is continuous in the initial
fitness (see Supporting Information S1 for a proof) then implies the existence of the critical
initial fitness referred to in the main text.
Corollary 4 can also provide insight into the dynamics of a population at equilibrium. In
particular, note that if the probability that the next substitution is deleterious was q for each
quantile q of the equilibrium distribution, then the probability that the next substitution would
be deleterious for a population whose fitness was drawn at random from the equilibrium distribution would be 1/2. However, Corollary 4 implies that the probability that the next substitution
is deleterious at a particular fitness is always strictly greater than the quantile of that fitness in
the equilibrium distribution. Thus, the probability that the next substitution is deleterious for
a population whose fitness is drawn from the equilibrium distribution must be strictly greater
than 1/2.
It is worth noting that the above results can all be extended to the case where the house
of cards distribution is discrete or contains point masses (i.e. where ψ(y) dy is an arbitrary
probability measure instead of a probability density function and expectation is interpreted in
terms of Lebesgue integration). However, the statement of the results in this more general
28

setting becomes more complex due to the non-zero probability of substitutions that are precisely
neutral. See also Supporting Information S1 for additional proofs relating the distribution of
fitnesses after one substitution for a population currently fixed at fitness x to the corresponding
distribution for a population currently fixed at some other fitness x0 and a characterization of
the behavior of the distribution of fitnesses after one substitution in the limit where the initial
fitness x tends to either ∞ or −∞.
We now provide the proof for Theorem 1.
Proof. Consider a non-decreasing function f , and let
Z

∞

f (y)

Ex (f ) =
Z−∞
∞

Q(y|x)
dy
k(x)

f (y) π(y) dy

Eπ (f ) =

(A4)
(A5)

−∞

be finite. The first thing we want to know is the sign of
Z

∞

(f (y) − Eπ (f ))

Ex (f ) − Eπ (f ) =
−∞

Q(y|x)
dy,
k(x)

(A6)

where we have used the fact that Q(y|x)/k(x) dy is a probability density and therefore integrates
to one. Since k(x) > 0 it thus suffices to determine the sign of
Z

∞

(f (y) − Eπ (f )) Q(y|x) dy.

(A7)

−∞

Now, define z to be any fitness such that f (y) ≥ Eπ (f ) for y > z and f (y) ≤ Eπ (f ) for y < z.
Such a fitness surely exists since f is non-decreasing and min f ≤ Eπ (f ) ≤ max f . We can
then write
Z

∞

−∞

(f (y) − Eπ (f )) Q(y|x) dy
Z z
=
(f (y) − Eπ (f )) N ψ(y) u(y − x, N ) dy
−∞
Z ∞
+
(f (y) − Eπ (f )) N ψ(y) u(y − x, N ) dy (A8)
z

29

where the first integral on the right hand side is non-positive and the second integral is nonnegative. Now, McCandlish et al. (In prep.) have proved that for N > 1 and s > s0 we have
u(s, N )
0
< e(N −1)(s−s )
u(s0 , N )

(A9)

and the inequality is reversed for s < s0 . Thus, for any three fitnesses, x, y and z we have

(N −1)(y−z)

< u(z − x, N ) e
u(y − x, N ) = u(z − x, N ) e(N −1)(y−z)


> u(z − x, N ) e(N −1)(y−z)

for y > z
for y = z
for y < z.

(A10)

Using this inequality together with Equation A8 yields:
Z

∞

Z

z

(f (y) − Eπ (f )) N ψ(y) u(z − x, N ) e(N −1)(y−z) dy

(f (y) − Eπ (f )) Q(y|x) dy ≤
−∞

−∞

Z

∞

(f (y) − Eπ (f )) N ψ(y) u(z − x, N ) e(N −1)(y−z) dy
z
Z ∞
−(N −1)z
≤ N u(z − x, N ) e
(f (y) − Eπ (f )) ψ(y) e(N −1)y dy
−∞
Z ∞
−(N −1)z
≤ N Z u(z − x, N ) e
(f (y) − Eπ (f )) π(y) dy
−∞

Z ∞
−(N −1)z
≤ N Z u(z − x, N ) e
f (y) π(y) dy − Eπ (f )
+

−∞

=0
(A11)
where we have also used the definition of π(y), the fact that π is probability distribution and
hence integrates to 1, and theRdefinition of Eπ (f ). This demonstrates
the second inequality in
R∞
∞
the statement of the theorem, −∞ f (y) (Q(y|x)/k(x)) dy ≤ −∞ f (y) π(y) dy.
To see that this inequality is strict if there exist two open intervals of non-zero length within
the support of ψ such that f is strictly greater on one of these intervals than it is on the other,
notice that in the derivation of the first line of Equation A11 the inequality for the probability
of fixation given byREquation A10 is strict. Thus, the first Rline of Equation A11 can only be
z
∞
an equality if both −∞ (f (y) − Eπ (f )) ψ(y) dy = 0 and z (f (y) − Eπ (f )) ψ(y) dy = 0.
However if there exist two open intervals within the support of ψ such that f is strictly greater
on one of these intervals than it is on the other, then there exists at least one of 1) some open
interval α = (a, b) within the support of ψ with a < b ≤ z such that (f (y) − Eπ (f )) < 0 for
30

y ∈ (a, b) or 2) some open interval β = (c, d) within the support of ψ with d > c ≥ z such that
(f (y) − Eπ (f )) >
R z0 for y ∈ (c, d). Now, (f (y) − Eπ (f )) ≤ 0 for y ≤ z, so that the existence
of α implies that −∞ (f (y) − Eπ (f )) ψ(y) dy < 0. Similarly, (f (y) − Eπ (f )) ≥ 0 for y ≥ z
R∞
so that the existence of β implies that z (f (y) − Eπ (f )) ψ(y) dy > 0. Thus in either case the
inequality is strict.
To prove the other inequality in the statement of the theorem, we proceed in a similar manner. Let
Z ∞
f (y) ψ(y) dy
(A12)
Eψ (f ) =
−∞

be finite.
Now, we want to know the sign of Ex (f ) dy − Eψ (f ) dy, which takes the same sign as
Z

∞

(f (y) − Eψ (f )) Q(y|x) dy.

(A13)

−∞

Choose z to be a fitness such that f (y) ≥ Eψ (f ) for y > z and f (y) ≤ Eψ (f ) for y < z. Then
Z

∞

z

Z
(f (y) − Eψ (f )) Q(y|x) dy =

−∞

(f (y) − Eψ (f )) N ψ(y) u(y − x, N ) dy
−∞

Z
+
Z

∞

(f (y) − Eψ (f )) N ψ(y) u(y − x, N ) dy
z
∞

≥

(A14)

(f (y) − Eψ (f )) N ψ(y) u(z − x, N ) dy
−∞

= 0,
where we have used the fact that u(z − x, N ) > u(y − x, N ) for y < z and u(z − x, N ) <
u(y − x, N ) for y > z. This proves the first inequality in the statement of the theorem.
The argument for the strictness of this inequality if there exist two open intervals within the
support of ψ such that f is strictly greater on one of these intervals than it is on the other
is similar to the argument used for the other inequality and hinges on the strictness of the
inequalities u(z − x, N ) > u(y − x, N ) for y < z and u(z − x, N ) < u(y − x, N ) for y > z
used to derive the second line in Equation A14 rather than on the strictness of the inequalities
in Equation A10.

31

Supporting Information
Supporting Information S1

Additional results on the distribution of fitnesses after one substitution

This section of the Supporting Information contains additional results to complement those
derived in Appendix A. First, we derive several results related to how the distribution of fitnesses after one substitution changes as the initial fitness is varied. Next, we derive conditions
for when the expected value of a non-decreasing function is finite with respect to the distribution of fitnesses after one substitution. Finally, we prove that the substitution rate (k(x)),
expected selection coefficient of the first substitution (m(x)), and proportion of the time the
first substitution is advantageous (p(x)) all change continuously as a function of initial fitness
(x).
The following result shows that the distribution of fitnesses after one substitution for a population fixed for fitness x is to the left of the distribution of fitnesses after one substitution for
a population fixed at fitness x0 > x. The method of proof is similar to the proof of Theorem 1
in Appendix A but uses a different inequality for the probability of fixation.
Proposition S1. Under the house of cards model with a continuous mutational distribution ψ
and N > 1, for any arbitrary initial fitnesses x and x0 with x0 > x and any non-decreasing,
real-valued function f defined on the real line, we have
Z

∞

Q(y|x)
dy ≤
f (y)
k(x)
−∞

∞

Q(y|x0 )
f (y)
dy
k(x0 )
−∞

Z

(S1)

whenever the corresponding integrals exist. The above inequality is strict if there exist two open
intervals of length greater than zero within the support of ψ such that the value of f is strictly
greater for members of the first interval than it is for members of the second.
Proof. Let
Z

∞

Q(y|x)
dy < ∞
k(x)
−∞
Z ∞
Q(y|x0 )
0
Ex (f ) =
f (y)
dy < ∞.
k(x0 )
−∞
Ex (f ) =

f (y)

32

(S2)
(S3)

Also, let z be any fitness such that f (y) ≤ Ex0 (f ) for y < z and f (y) ≥ Ex0 (f ) for y > z. Such
a fitness surely exists since f is increasing and min f ≤ Ex0 (f ) ≤ max f .
We are interested in the sign of
∞

Z

(f (y) − Ex0 (f ))

Ex (f ) − Ex0 (f ) =
−∞

Q(y|x)
dy.
k(x)

(S4)

First, we expand
Z

∞

Q(y|x)
(f (y) − Ex0 (f ))
dy =
k(x)
−∞

z

N ψ(y) u(y − x, N )
dy
k(x)
−∞
Z ∞
N ψ(y) u(y − x, N )
(f (y) − Ex0 (f ))
+
dy,
k(x)
z
Z

(f (y) − Ex0 (f ))

(S5)

where the first term on the right-hand side is non-positive and the second term in non-negative.
Now McCandlish et al. (In prep.) have shown that for N > 1, c > 0 and s0 > s
u(s0 , N )
u(s0 + c, N )
<
,
u(s + c, N )
u(s, N )

(S6)

and that the inequality is reversed for s0 < s. Thus, for any four fitnesses x, x0 , y and z with
x < x0 :
 u(y−x0 ,N )
< u(z−x0 ,N ) for y > z
u(y − x, N )  u(y−x0 ,N )
(S7)
= u(z−x0 ,N ) for y = z
u(z − x, N ) 
 u(y−x0 ,N )
> u(z−x0 ,N ) for y < z.
Combining this inequality with Equation S5 yields:
Z

∞

∞

u(z − x, N ) u(y − x0 , N )
(f (y) − Ex0 (f )) N ψ(y)
dy
k(x)
u(z − x0 , N )
−∞
Z
u(z − x, N ) k(x0 ) ∞
u(y − x0 , N )
0 (f )) N ψ(y)
≤
(f
(y)
−
E
dy
x
u(z − x0 , N ) k(x) −∞
k(x0 )
Z
u(z − x, N ) k(x0 ) ∞
Q(y|x0 )
0
≤
(f
(y)
−
E
(f
))
dy
x
u(z − x0 , N ) k(x) −∞
k(x0 )
= 0.
(S8)

Q(y|x)
dy ≤
(f (y) − Ex0 (f ))
k(x)
−∞

Z

33

This demonstrates the inequality in the statement of the proposition. The justification for the
condition on the strictness of the inequality is similar to that given in the proof of Theorem 1
except that it relies on the strictness of the inequalities in Equation S7.
This proposition can then be used to show that the expected fitness after one substitution is
increasing as a function of the initial fitness, and that, indeed, every quantile of the distribution
of fitnesses after one substitution (except for the 0-th and 1-st) is increasing as a function of
initial fitness. The proofs of these statements are exactly analogous to the proofs for Corollaries 2, 3 and 4 given in Appendix A.
We also wish to characterize the limit of the distribution of fitnesses after one substitution
as the initial fitness becomes extremely large or extremely small. For technical reasons, we will
conduct this proof in somewhat more generality than the previous proofs in that ψ(y) dy will be
an arbitrary probability measure and all associated integrals will be Lebesgue integrals. Note
that in this more general context it is still the case that an equilibrium measure
ψ(y)e(N −1)y
dy
ψ(z)e(N −1)z dz
−∞

π(y) dy = R ∞

(S9)

existsRfor the stochastic process defined by Equation 2 provided that the normalizing constant
∞
Z = −∞ ψ(z)e(N −1)z dz is finite. We can now state the result:
Proposition S2. For N ≥ 1, we have
1. For all fitnesses y
Q(y|x)
dy = ψ(y) dy.
x→−∞ k(x)
lim

(S10)

2. If π exists, for all fitnesses y

lim

x→∞

Q(y|x)
dy = π(y) dy.
k(x)

(S11)

Proof. For the first statement in the theorem, we begin by characterizing
Z

∞

k(x) =

Z

∞

N ψ(y) u(y − x, N ) dy.

Q(y|x) dy =
−∞

−∞

34

(S12)

R∞
Now, 0 < u(y − x) ≤ 1 and −∞ ψ(y) dy = 1 < ∞, so that applying the Lebesgue dominated
convergence theorem to move the limit inside the integral gives us
Z

∞

N ψ(y) lim u(y − x, N ) dy

lim k(x) =

x→−∞

x→−∞

−∞

(S13)

= N.
where for the second equality have used the fact that limx→−∞ u(y − x, N ) = 1. Thus
Q(y|x)
N ψ(y)u(y − x, N )
dy = lim
dy
x→−∞ k(x)
x→−∞
k(x)
= lim ψ(y)u(y − x, N )dy
lim

(S14)

x→−∞

= ψ(y).
This completes the proof of the first portion of the proposition
To address the second statement in the proposition, where x → ∞, first observe that
Q(y|x) dy = e−(N −1)x N ψ(y) e(N −1)y u(x − y, N ) dy,

(S15)

where we have used the identity u(y − x, N ) = e(N −1)(y−x) u(x − y, N ). Then
(N −1)x

lim k(x) e

x→∞

= lim e

(N −1)x

x→∞

∞

Q(y|x) dy
−∞

Z

∞

= N lim

x→∞

Z

(S16)

ψ(y) e(N −1)y u(x − y, N ) dy,

−∞

provided
that the integral in the last line is finite, which it is since 0 < u(y − x, N ) ≤ 1 and
R∞
ψ(y) e(N −1)y dy = Z < ∞ by assumption. The two last facts also allow us to apply the
−∞
Lebesgue dominated convergence theorem to move the limit inside the integral, which together
with the fact that limx→∞ u(x − y, N ) = 1 yields
lim k(x) e(N −1)x = N Z.

x→∞

35

(S17)

Using this last result and equation S15, we then have
Q(y|x)
N ψ(y) e(N −1)y u(x − y, N )
lim
dy = lim
dy
x→∞ k(x)
x→∞
k(x) e(N −1)x
N ψ(y)e(N −1)y
=
dy
NZ
= π(y) dy,

(S18)

as required.
Because many of our results describe inequalities for the expected value of a non-decreasing
function f with respect to ψ, π, and the distribution of fitnesses after one substitution, it is helpful to characterize when these expectations exist. The following result shows that if this expectation is finite with respect to either ψ or π, then it is also finite with respect to the distribution
of fitnesses after one substitution:
Proposition S3. Under the house of cards model with a continuous mutational distribution ψ,
N > 1, and any non- decreasing, real-valued function f defined on the real line, we have
1. If

R∞

2. If

R∞

3. If

R∞

−∞

−∞

−∞

dy is finite for any x, then it is finite for all x.
f (y) Q(y|x)
k(x)
f (y) ψ(y) dy is finite, then

R∞

f (y) π(y) dy is finite, then

R∞

−∞

−∞

f (y) Q(y|x)
dy is finite for all x.
k(x)
f (y) Q(y|x)
dy is finite for all x.
k(x)

Proof. If f is constant on the interior of the support of ψ, then we are done, since then all the
above integrals take this constant values. If f is not constant on the interior of the support of
ψ, without loss of generality we can assume that f takes both positive and negative values on
the interior of the support of ψ since otherwise we can simply consider a function f ∗ (y) =
f (y) − f (w) for some w such that w is in the interior of the support of ψ, which alters the
values of the above integrals by f (w) but does not affect whether the integrals are finite.
Let z be a constant such that f (y) ≥ 0 for y ≥ z and f (y) ≤ 0 for y ≤ z. To demonthe first claim, note that becauseR0 < k(x) < N for all x, it suffices to show that
Rstrate
∞
∞
f
(y)
Q(y|x0 ) dy is finite given that −∞ f (y) Q(y|x) dy is finite for some x. Because we
−∞
will demonstrate the finiteness of these integrals using the limit comparison test, we must make a
separate
argument for R each limit of these improper integrals.
We thus consider
R∞
z
0
0
f
(y)
Q(y|x
)
dy
and
f
(y)
Q(y|x
)
dy
separately.
z
−∞

36

Now, lims→∞ u(s, N ) = 1 and lims→−∞ u(s, N ) e(N −1)s = 1 so that
u(y − x0 , N )
=1
y→∞ u(y − x, N )
lim

(S19)

and
0

u(y − x0 , N )
u(y − x0 , N ) e(N −1)(y−x ) (N −1)(x0 −x)
lim
= lim
e
y→−∞ u(y − x, N )
y→−∞ u(y − x, N ) e(N −1)(y−x)
(N −1)(x0 −x)

=e
Thus, we have

.

f (y) Q(y|x0 )
= 1 > 0,
y→∞ f (y) Q(y|x)
lim

which shows that

R∞
z

(S21)

f (y) Q(y|x0 ) dy is finite. Similarly, we have
f (y) Q(y|x0 )
0
= e(N −1)(x −x) > 0,
y→−∞ f (y) Q(y|x)
lim

which shows that

(S20)

Rz
−∞

(S22)

f (y) Q(y|x0 ) dy is finite.

ToR show the second claim, note that because
0 < k(x) < N for all x, it suffices to show that
R∞
z
both −∞ f (y) ψ(y) u(y − x, N ) dy and z f (y) ψ(y) u(y − x, N ) dy are finite. This result folRz
R∞
lows because 0 < u(y−x, N ) < 1 and we are given that −∞ f (y) ψ(y) dy and z f (y) ψ(y) dy
are finite.
R∞
R z To show the third claim, it suffices to show
R ∞that z f (y) ψ(y) u(y − z, N ) dy and
f (y) ψ(y) u(y − z, N ) dy are finite, since then −∞ f (y) (Q(y|x)/k(x)) dy is finite for all
−∞
x by the first claim. To show that these integrals are finite, we note that 0 < u(s, N ) < e(N −1)s
for N > 1 (McCandlish et al., In prep.) so that
Z
0≤

∞
−(N −1)z

Z

f (y) ψ(y) u(y − z, N ) dy ≤ e
z

z

37

∞

f (y) ψ(y) e(N −1)y dy < ∞

(S23)

and
Z

z

0≥

−(N −1)z

Z

z

f (y) ψ(y) u(y − z, N ) dy ≥ e
−∞

f (y) ψ(y) e(N −1)y dy > −∞,

(S24)

−∞

as required.
Finally, for Appendix A, we also need proofs that m(x) and p(x) are continuous functions
of x. First we need to prove some simpler results. We begin by proving that the substitution
rate is continuous with respect to initial fitness.
Proposition S4. k(x) is continuous in x.
Proof. First note that k(x) exists for all x because 0 < u(s, N ) ≤ 1 so that 0 < k(x) ≤ N .
We want to show that for any  > 0, there exists a δ > 0 such that if 0 < |x − x0 | < δ then
|k(x) − k(x0 )| < . In fact, in this case we can choose δ < /N . First, we note that u(s, N ) is
d
d
u(s, N ) < 1(McCandlish et al., In prep.), so that 0 > dx
u(y − x, N ) >
continuous and 0 < ds
0
0
−1, and thus |u(y − x, N ) − u(y − x , N )| < |x − x |. We then have
0

Z

∞

|u(y − x, N ) − u(y − x0 , N )| ψ(y) dy
−∞
Z ∞
0
< N |x − x |
ψ(y) dy

|k(x) − k(x )| = N

(S25)

−∞

< ,
as required.
R∞
Note that since −∞ ψ(y) dy = 1, the above proof has in fact demonstrated that |k(x) −
k(x0 )| ≤ N |x − x0 | for all x, x0 . Thus k(x) is not merely continuous, but is rather Lipschitz
continuous with Lipschitz constant N .
Next, we prove a technical lemma.
Lemma S5. If ψ or π has a finite mean, then

R∞
−∞

y Q(y|x) dy is a continuous function of x.

R∞
Proof. If ψ has finite mean, then −∞ |y| ψ(y) dy < ∞. For  > 0, choose 0 < δ <
 R

∞
/ N −∞ |y| ψ(y) dy . Noting again that |u(y − x, N ) − u(y − x0 , N )| ≤ |x − x0 |, for

38

0 < |x − x0 | < δ we have
Z




∞

Z

∞

y Q(y|x) dy −

−∞

−∞


Z

y Q(y|x ) dy  ≤ N
0

∞

|y| |u(y − x, N ) − u(y − x0 , N )| ψ(y) dy
−∞
Z ∞
0
|y| ψ(y) dy
≤ N |x − x |
−∞

< ,
(S26)
as required.
Now, suppose π has finite mean so that

R∞
−∞

|y| π(y) dy < ∞. We first note that:


 

 d −(N −1)x
 

−(N −1)x
−(N −1)x d
 e



−(N
−
1)
e
u(x
−
y,
N
)
+
e
=
u(x
−
y,
N
)
u(x
−
y,
N
)
 dx
 

dx


 


 
d
≤ (N − 1) e−(N −1)x u(x − y, N ) + e−(N −1)x u(x − y, N )
dx
≤ N e−(N −1)x
(S27)
where we have used the facts that 0 < u(x − y, N ) ≤ 1 and 0 ≤
all x, x0 ,

d
u(x
dx

− y, N ) ≤ 1. Thus, for



0
0
 −(N −1)x

u(x − y, N ) − e−(N −1)x u(x0 − y, N ) ≤ N e−(N −1) min(x,x ) |x − x0 | .
e

(S28)

choice of x and choice of  > 0, pick δ > 0 such that δ e(N −1)δ <
Now, for any given
R
∞
/ e−(N −1)x N 2 Z −∞ |y| π(y) dy , which is possible since δ e(N −1) δ can be made arbitrarily
small. Using the identities u(s, N ) = e(N −1)s u(−s, N ) and π(y) = e(N −1)y ψ(y)/Z, for 0 <

39

|x − x0 | < δ we have
Z




∞

−∞

Z

∞



y Q(y|x ) dy 
0

y Q(y|x) dy −
−∞

Z ∞


0
y (u(y − x, N ) − u(y − x , N )) ψ(y) dy 
= N 
−∞

Z ∞


0
−(N −1)y

y (u(y − x, N ) − u(y − x , N )) e
π(y) dy 
=NZ

Z−∞


 ∞  −(N −1)x
−(N −1)x0
0

y e
u(x − y, N ) − e
u(x − y, N ) π(y) dy 
=NZ
−∞
Z ∞
0
−(N −1) min(x,x0 ) 2
≤ |x − x | e
N Z
|y| π(y) dy
−∞
Z ∞
0
(N −1)|x−x0 | −(N −1)x
2
|y| π(y) dy
≤ |x − x | e
e
N Z

(S29)

−∞

< ,
as required.
Together, these results allow us to address the continuity of m(x).
Proposition S6. If ψ or π has finite mean then m(x) is a continuous function of x.
Proof. Because

R∞
m(x) =

−∞

y Q(y|x) dy
− x,
k(x)

(S30)

R∞
the continuity of m(x) follows immediately from the continuity of −∞ y Q(y|x) dy (Lemma S5),
the continuity of k(x) (Proposition S4), the fact that k(x) is strictly positive, and the continuity
of x.
Finally, we address the continuity of p(x).
Proposition S7. p(x) is continuous in x.
Proof. Because

R∞
p(x) =

x

Q(y|x) dy
k(x)

40

(S31)

and
R ∞ k(x) is both continuous (Proposition S4) and strictly positive, it suffices to show that
Q(y|x) dy is continuous in x.
x
R x+δ
Now, for  > 0, choose δ > 0 such that δ < /(2N ) and x−δ ψ(y) dy < /(2N ). It is
always possible to choose an appropriate δ to satisfy the second inequality because we have
assumed that ψ(x) is a continuous probability distribution, i.e. it has no point masses. Thus the
total probability in an open ball of radius δ around x can be made arbitrarily small by choosing
a sufficiently small δ.
Assuming that |x − x0 | < δ we have
Z




∞

Z

∞

Q(y|x) dy −
x0

x

 Z
 
Q(y|x0 ) dy  ≤ 

∞

∞



Q(y|x) dy −
Q(y|x0 ) dy 
x
x
Z 0

 x



0
+
Q(y| min(x, x )) dy  .
 x

Z

(S32)

To analyze the first term on the right-hand side, we again use the fact that |u(y − x, N ) − u(y −
x0 , N )| ≤ |x − x0 |, so that for 0 < |x − x0 | < δ we have
Z




x

∞

Z
Q(y|x) dy −
x

∞


Z

0
0

Q(y|x ) dy  ≤ N |x − x |

∞

ψ(y) dy

x

(S33)

< /2.
To analyze the other term, we note that 0 ≤ u(s, N ) ≤ 1 so that for 0 < |x − x0 | < δ we have
Z 0

Z 0

 x

 x





0
Q(y| min(x, x )) dy  ≤ N 
ψ(y) dy 

 x

 x

Z x+δ




≤N
ψ(y) dy 
x−δ

< /2
Substituting Equation S33 and Equation S34 into Equation S32 yields the desired result.

41

(S34)

Supporting Information S2

The Gaussian HOC

In the main text, we claim that for the Gaussian HOC,
Q(x∗ − z|x∗ − c)
Q(x∗ + z|x∗ + c)
dz
=
dz
k(x∗ + c)
k(x∗ − c)

(S35)

for all c and z, where x∗ = µ + (N − 1)σ 2 /2. To demonstrate this equality, it is sufficient
to show that Q(x∗ + z|x∗ + c) ∝ Q(x∗ − z|x∗ − c) when viewed as a function of z (i.e. with
c and x∗ held constant), since two probability density functions that are proportional to each
other must be equal. Noting that for the Gaussian HOC π(x∗ + z) = ψ(x∗ − z), and that more
generally u(s, N ) = u(−s, N ) e(N −1)s , and π(y) ∝ ψ(y)e(N −1)y , we have
Q(x∗ + z|x∗ + c) = N ψ(x∗ + z) u((x∗ + z) − (x∗ + c), N )
= N ψ(x∗ + z) u(z − c, N )
= N π(x∗ − z) u(c − z, N ) e(N −1)(z−c)
∗

∝ ψ(x∗ − z) u(c − z, N ) e(N −1)(x −c)
∝ ψ(x∗ − z) u((x∗ − z) − (x∗ − c), N )
∝ Q(x∗ − z|x∗ − c)

(S36)

as required.

Supporting Information S3

Analytical approximations for the
House of Cards model

It is often useful to develop analytical approximations for quantities of evolutionary interest.
Here we present a system for developing analytical approximations under the House of Cards
model. This system has the surprising feature that the terms in the analytical approximations
are very closely related to the mutational and equilibrium distributions of the underlying House
of Cards model.
Our main strategy is to extend the standard approximation for the probability of fixation,

42

u(s, N ) ≈ s, to accommodate deleterious fixations:
(
u(s, N ) ≈

− s e(N −1)s for s ≤ 0
s
for s > 0

(S37)

(McCandlish et al., In prep.). This approximation has the interesting property that when used in
place of the true probability of fixation to define the transition rates in Equation 1, the resulting
Markov process has an equilibrium distribution identical to the equilibrium distribution obtained
using the true probability of fixation (Equation 4).
Using this approximation, we can then analyze the dynamics as follows. For a population
fixed for an allele with fitness x, the rate of beneficial substitutions, kb (x), is
∞

Z

∞

Z
Q(y|x) dy ≈ N

kb (x) =
x

(y − x)ψ(y) dy

(S38)

x

while the rate of deleterious fixations is
Z

x

kd (x) =

Q(y|x) dy
Z x
(y − x) e(N −1)(y−x) ψ(y) dy
≈ −N
−∞
Z x
−(N −1)x
≈ −N Z e
(y − x) π(y) dy
−∞

(S39)

−∞

Similarly, the expected instantaneous rate of change in fitness due to beneficial fixations is
Z

∞

(y − x) Q(y|x) dy

rb (x) =
x

Z
≈N

(S40)

∞
2

(y − x) ψ(y) dy
x

43

while the expected instantaneous rate of change in fitness due to deleterious fixations is
Z

x

(y − x) Q(y|x) dy
Z x
(y − x)2 e(N −1)(y−x) ψ(y) dy
≈ −N
−∞
Z x
−(N −1)x
(y − x)2 π(y) dy.
≈ −N Z e

rd (x) =

−∞

(S41)

−∞

To put this another way, approximating the substitution rate and the expected change in fitness
for a population fixed for fitness x comes down to calculating the first few moments of truncated
versions of ψ and π. For many common distributions, these moments are easy to compute or
can be looked up in a table (e.g., Table 1 of Jawitz, 2004).
With these few quantities in hand, we can calculate a variety of other quantities of interest.
Of course, the total substitution rate is
k(x) = kb (x) + kd (x),

(S42)

and the probability that the next substitution is advantageous is

p(x) =

kb (x)
.
k(x)

(S43)

Similarly, the expected instantaneous rate of change in fitness is
r(x) = rb (x) + rd (x)

(S44)

and the expected selection coefficient of the first substitution is
m(x) = r(x)/k(x).

(S45)

One can also compute the expected selection coefficient of the first substitution conditional on
it being advantageous, rb (x)/kb (x), or deleterious, rd (x)/kd (x).
In the case when ψ is normal with mean µ and variance σ 2 , π is normal with mean µ0 =
µ + (N − 1)σ 2 and the same variance. Let us write the cumulative distribution function of ψ and
44

Rx
Rx
π as Ψ(x) = −∞ ψ(y) dy and Π(x) = −∞ π(y) dy, respectively. Looking up the necessary
moments (Jawitz, 2004) and simplifying leads to the following expressions:

kb
kd
rb
rd



1 − Ψ(x)
2
= N ψ(x) σ + (µ − x)
ψ(x)


Π(x)
2
0
= N ψ(x) σ − (µ − x)
π(x)


2 1 − Ψ(x)
2
= N ψ(x) (µ − x) σ + (µ − x)
ψ(x)


2 Π(x)
0
2
0
.
= N ψ(x) (µ − x) σ − (µ − x)
π(x)

(S46)
(S47)
(S48)
(S49)

It is interesting to ask why the above expressions are so symmetric. This is in large part a consequence of the fact that for our approximation of u(s, N ), it is still the case that u(s, N ) =
u(−s, N )e(N −1)s and thus the symmetry argument given in Supporting Information S2 for the
distribution of fitnesses after one substitution still holds under the approximation. As a consequence, the approximation is exactly correct for m(x∗ ) and k(x∗ ), where x∗ = (µ + µ0 )/2.
The above equations were used to plot the curves in Figure 3. Note that the approximation,
while reasonably good, is always more extreme than the numerical results, in the sense that,
e.g., the analytical result for m(x) is too high when m(x) is positive and too low when m(x)
is negative. This is to be expected, since our approximation underestimates the contribution of
nearly neutral fixations and therefore overestimates the average magnitude of the mutations that
fix.

Supporting Information S4
Supporting Information S4.1

Results for Fisher’s Geometric Model

Scaling of the model

In the main text, we note that evolution under Fisher’s geometric model is particularly easy
to understand when fitnesses are measured in scaled fitness because then, to a very good approximation, the dynamics depend only on the dimensionality n and the compound parameter
N λ. To see why this is the case, recall that the fitness of a mutant introduced by mutation when
the current fitness is x is −λ/2 times a non-central chi-squared distributed random variable with
n degrees of freedom and non-centrality parameter −2x/λ. Thus, if X = N x is the current
scaled fitness, the scaled fitness of a new mutant is − N2λ times a non-central chi-squared random
variable with n degrees of freedom and non-centrality parameter −2x/λ = − N2λ X. Thus, the
45

mutational process, when viewed in terms of scaled fitness, depends only on n and the product
N λ.
Furthermore, it is well-known that the evolutionary dynamics under weak mutation depends
primarily on scaled fitness, and not on fitness and population size separately, so long as selection
coefficients remain small. In particular, if we approximate the probability of fixation as

u(s, N ) =

1 − e−s
s
≈
,
1 − e−N s
1 − e−N s

(S50)

then the instantaneous transition rate from scaled fitness X to scaled fitness Y is given by:
Q(Y |X) ≈ ΦX (Y )

Y −X
,
1 − e−(Y −X)

(S51)

where ΦX (Y ) is the probability density function describing the scaled fitnesses of new mutations for a population whose current scaled fitness is X (Kryazhimskiy et al., 2009). Since this
probability density function depends only on n, the compound parameter N λ and the current
fitness X, it is clear that the dynamics of evolution under FGM when viewed in terms of scaled
fitnesses depend only on n and N λ provided that the absolute size of the selection coefficients
is sufficiently small.
Finally, using the above approximation for the transition rate from scaled fitness X to scaled
fitness Y yields a simple form for the equilibrium distribution. In particular the equilibrium
distribution in terms of scaled fitnesses is −1 times a gamma distribution with shape n/2 and
scale 1. Note that this equilibrium distribution is independent of N λ and that its mean is simply
−n/2.

Supporting Information S4.2

The large N λ limit

Having shown that the dynamics of evolution under FGM, to a good approximation, depend
only on n and N λ when measured in terms of scaled fitnesses, it is natural to ask what happens
in various limiting cases of these two parameters. Here we will discuss the dynamics as N λ becomes large. In particular, we will take an approach based on approximating the distribution of
scaled fitnesses introduced by mutation, ΦX , under the assumption that terms of order 1/(N λ)
are negligible.
In order to investigate the large N λ limit, it is helpful to write out the PDF of ΦX (Y )

46

explicitly. Recalling that X, Y ≤ 0, we have:

ΦX (Y ) =

1 Y +X
e Nλ Nλ
Nλ



Y
X

s

 12 (n/2−1)
In/2−1


!
Y
X
2
2
Nλ
Nλ

(S52)

where Iv (x) is a modified Bessel function of the first kind:

Iv (x) =

∞
X
k=0

 x 2k+v
1
.
k! Γ(k + v + 1) 2

(S53)

Following Martin and Lenormand (2008) in using the method of Jaschke et al. (2004), we then
note that

2 !
Y
1
+O
e =1+
Nλ
Nλ
s
!



n/2−1
Y
X
1
2
2
=
(Y X)(1/2)(n/2−1)
Nλ
Nλ
Nλ
Y
Nλ

In/2−1

(S54)
1
+O
Γ(n/2)



1
Nλ

2 !!
(S55)

so that
X/(N λ)

ΦX (Y ) = e

(−Y )n/2−1
Γ(n/2)(N λ)n/2



1
) .
1 + O(
Nλ

(S56)

We can thus make the approximation

ΦX (Y ) ≈ eX/(N λ)

(−Y )n/2−1
Γ(n/2)(N λ)n/2

(S57)

for large N λ. Note that this is identical to the tail approximation for x close to 0 used by Martin
and Lenormand (2008) when translated into scaled fitness and adapted to the case of an isotropic
FGM as analyzed here. This equivalence makes sense if we consider what happens if we make
N λ large by increasing N while keeping λ and X fixed, since then x = X/N approaches 0 just
as in the approximation developed by Martin and Lenormand (2008).

47

Analytical approximations in the large N λ
limit

Supporting Information S4.3

Given the approximation to the evolutionary dynamics for large N λ developed in the previous section (Supporting Information S4.2), one can develop analytical results for the probability
that the next substitution is advantageous and the expected scaled selection coefficient of the
next substitution by using a further approximation for the probability of fixation. In particular,
we will approximate the term:
Y −X
(S58)
1 − e−(Y −X)
in Equation S51 as
Y −X
≈
1 − e−Y −X

(

− (Y − X) eY −X for Y − X ≤ 0
Y −X
for Y − X > 0.

(S59)

This approximation is very similar to the approximation used in Supporting Information S3 in
that its use results in the same equilibrium distribution as the Markov process given by Equation S51. Importantly, this approximation can similarly be viewed as a modification of the
standard approximation used in the literature on the genetics of adaptation (where the rate of
advantageous substitutions is proportional to the selection coefficient) to accommodate the possibility of deleterious substitutions.
To begin, let us recall that for b > −1 and a ≤ 0
Z

0

(−z)b dz =

a

and

Z

(−a)b+1
b+1

(S60)

a

ez (−z)b dz = Γ(b + 1, −a),

(S61)

−∞

where Γ(b + 1, −a) is an upper incomplete gamma function.
Using the first of the above integrals (Equation S60), we then have that the rate of advanta-

48

geous substitution is
Z 0
eX/(N λ)
kb (X) ≈
(Y − X)(−Y )n/2−1 dy
n/2
Γ(n/2)(N λ)
X
X/(N λ)
e
(−X)n/2+1
≈
.
Γ(n/2)(N λ)n/2 (n/2)(n/2 + 1)

(S62)

Using the second of the above integrals (Equation S61), we also have that the rate of deleterious
substitution is
Z X
eX/(N λ)
kd (X) ≈ −
(Y − X)e(Y −X) (−Y )n/2−1 dy
Γ(n/2)(N λ)n/2 −∞
eX/(N λ)
e−X (Γ(n/2 + 1, −X) + X Γ(n/2, −X))
≈
Γ(n/2)(N λ)n/2

eX/(N λ)
≈
(−X)n/2 + e−X (n/2 + X) Γ(n/2, −X)
n/2
Γ(n/2)(N λ)

(S63)

where we have used the recurrence relation Γ(α + 1, β) = α Γ(α, β) + β α e−β to derive the last
line. Thus, we have

p(X) =

kb (X)
kb (X) + kd (X)

−X
.
≈
−X
−X + (n/2)(n/2 + 1) (1 + e (n/2 + X) (−X)−(n/2) Γ(n/2, −X))

(S64)

Notice that the probability in the last line is not a function of N λ. Thus, while the absolute substitution rate at any fixed X decreases for large N λ as N λ increases (see the factor
eX/(N λ) /(N λ)n/2 in Equations S62 and S63), the fraction of beneficial substitutions approaches
a definite limit as N λ → ∞.
Now, if we approximate the median fitness at equilibrium by the mean fitness at equilibrium, Equation S64 shows that the probability that the next substitution is advantageous at the
equilibrium median fitness is simply
p(−n/2) ≈

49

1
,
n/2 + 2

(S65)

as stated in the main text (as a formal matter, the simplification arises because the term (n/2 +
X) becomes 0 if X = −n/2). Critically, this expression is always less than 1/2 for n > 0.
The expected selection coefficient of the first substitution, conditional on it being advantageous, can also be found using Equation S60:
R0
X

Y (Y − X)(−Y )n/2−1 dy

mb (X) ≈ R 0

(Y − X)(−Y )n/2−1 dy
2
≈ −X
,
n/2 + 2

−X

X

(S66)

which is equivalent to the expression given by Martin and Lenormand (2008) when the expression given by Martin and Lenormand (2008) is translated into scaled fitness. At the equilibrium
mean fitness, this gives us
n
.
(S67)
mb (−n/2) ≈
n/2 + 2
Similarly, the expected selection coefficient of the first substitution, conditional on it being
deleterious, can be found using Equation S61 and the recursive formula for the incomplete
gamma function:
RX
md (X) ≈ −∞
RX

Y (Y − X)e(Y −X) (−Y )n/2−1 dy

(Y − X)e(Y −X) (−Y )n/2−1 dy
−∞

−X

X Γ(n/2 + 1, −X) + Γ(n/2 + 2, −X)
−X
X Γ(n/2, −X) + Γ(n/2 + 1, −X)


n
Γ(n/2 + 1, −X)
≈−
1+
− X.
2
(n/2 + X)Γ(n/2 + 1, −X) + (−X)n/2+1 e−X

≈

(S68)

At the equilibrium mean fitness, this expression simplifies further to

md (−n/2) ≈ −

e
n/2

n/2
Γ(n/2 + 1, n/2).

(S69)

We can now use these results to characterize the expected selection coefficient of the first
substitution for a population whose initial fitness is equal to the equilibrium mean fitness. The

50

expected selection coefficient is given by:
m(−n/2) ≈ p(−n/2) mb (−n/2) + (1 − p(−n/2)) md (−n/2)
n/2

n
n/2 + 1
e
≈
Γ(n/2 + 1, n/2)
,
−
2
(n/2 + 2)
n/2
n/2 + 2

(S70)

which is solely a function of n. Recalling the well-known inequality Γ(α, β) ≥ e−β β α−1 for
α ≥ 1 (see, e.g., Olver et al., 2010, Section 8.10), we have
n
−
(n/2 + 2)2



e
n/2

n/2
Γ(n/2 + 1, n/2)

n/2 + 1
n
n/2 + 1
≤
−
n/2 + 2
(n/2 + 2)2 n/2 + 2
(n/2)2 + n/2 + 2
≤−
n/2 + 2
<0

(S71)

for n ≥ 1, so that our approximation of m(n/2) is always negative.

Literature Cited in Supporting Information
DLMF, 2013. NIST Digital Library of Mathematical Functions. http://dlmf.nist.gov/, Release
1.0.6 of 2013-05-06. URL http://dlmf.nist.gov/. Online companion to Olver et al.
(2010).
Jaschke, S., C. Klüppelberg, and A. Lindner, 2004. Asymptotic behavior of tails and quantiles
of quadratic forms of gaussian vectors. Journal of Multivariate Analysis 88:252–273.
Jawitz, J. W., 2004. Moments of truncated continuous univariate distributions. Advances in
Water Resources 27:269–281.
Kryazhimskiy, S., G. Tkaçik, and J. B. Plotkin, 2009. The dynamics of adaptation on correlated
fitness landscapes. Proc. Natl. Acad. Sci. U. S. A. 106:18638 – 18643. URL http://www.
pnas.org/content/106/44/18638.abstract.
Martin, G. and T. Lenormand, 2008. The distribution of beneficial and fixed mutation fitness
effects close to an optimum. Genetics 179:907–916. URL http://dx.doi.org/10.
1534/genetics.108.087122.
McCandlish, D. M., C. L. Epstein, and J. B. Plotkin, In prep. Formal properties of the probability of fixation: Identities, inequalities and approximations .
51

Olver, F. W. J., D. W. Lozier, R. F. Boisvert, and C. W. Clark (eds.) 2010. NIST Handbook of
Mathematical Functions. Cambridge University Press, New York, NY. Print companion to
DLMF.

52

