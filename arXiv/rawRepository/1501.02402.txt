Electronic health record phenotyping improves detection and screening of type 2
diabetes in the general United States population: A cross-sectional, unselected,
retrospective study
Ariana E. Anderson1, Wesley T. Kerr*1,2, April Thames1, Tong Li1, Jiayang Xiao1,
Mark S. Cohen1
(1) Department of Psychiatry and Biobehavioral Sciences, University of California, Los
Angeles
(2) Department of Biomathematics, David Geffen School of Medicine at UCLA
(*) Corresponding author
Contact Information:
Semel Institute
760 Westwood Plaza, Ste B8-169,
Los Angeles, CA 90095-1406
Phone: (310) 254-5680
Email: WesleyTK@UCLA.edu
Keywords: diabetes, evidence-based medicine, logistic regression, electronic health care records,
population screening
Abstract:

Objectives: In the United States, 25% of people with type 2 diabetes are undiagnosed.
Conventional screening models use limited demographic information to assess risk. We
evaluated whether electronic health record (EHR) phenotyping could improve diabetes screening,
even when records are incomplete and data are not recorded systematically across patients and
practice locations.
Methods: In this cross-sectional, retrospective study, data from 9,948 US patients between 2009
and 2012 were used to develop a pre-screening tool to predict current type 2 diabetes, using
multivariate logistic regression. We compared (1) a full EHR model containing prescribed
medications, diagnoses, and traditional predictive information, (2) a restricted EHR model where
medication information was removed, and (3) a conventional model containing only traditional
predictive information (BMI, age, gender, hypertensive and smoking status). We additionally
used a random-forests classification model to judge whether including additional EHR
information could increase the ability to detect patients with Type 2 diabetes on new patient
samples.
Results: Using a patient's full or restricted EHR to detect diabetes was superior to using basic
covariates alone (p<0.001). The random forests model replicated on out-of-bag data. Migraines
and cardiac dysrhythmias were negatively associated with type 2 diabetes, while acute bronchitis
and herpes zoster were positively associated, among other factors.
Conclusions: EHR phenotyping resulted in markedly superior detection of type 2 diabetes in a
general US population, could increase the efficiency and accuracy of disease screening, and are
capable of picking up signals in real-world records.

1

Introduction
Although roughly 25% of those with type 2 diabetes are undiagnosed in the United States,
population-wide screening for diabetes currently is not cost-effective because of the additional
time and laboratory testing required1-3. Intervention studies have shown that diabetes can be
prevented in high-risk individuals3-5, while weight loss and lifestyle changes can revert the
recently diagnosed patients (<4 years) to pre-diabetes status6. This makes population-wide
screening not just an issue of prevention, but also one of treatment.
The total estimated cost of diagnosed diabetes in 2012 reached a staggering $245 billion, a 41%
increase since 2007. People with diagnosed diabetes, on average, have medical expenditures
approximately 2.3 times higher than people who do not have diabetes7. Given that expenditures
for patients with diabetes account for 20% of healthcare spending annually, 7 and that new
legislation bars insurers from dropping coverage of ill patients, characterizing diabetes risk
using electronic health records (EHR) allows this financial liability to be both appreciated and
mitigated by those bearing the financial burden of the disease.
Diabetes screening risk scores combine both patient demographic information and laboratory
testing to predict future likelihood of developing diabetes. Risk scores are derived from
demographic information such as age, gender, comorbid hypertension, ethnicity, and body mass
index (BMI). Laboratory tests include fasting plasma glucose concentration, oral glucose
tolerance test or hemoglobin A1c (compared more thoroughly in 8). These tests often require
fasting, routine blood draws, and monitoring, which can place undue burden on the patient,
staff, and treating physician. This makes population-wide screening expensive and impractical,
particularly in resource limited health-care settings which are the most likely to service at-risk
patients2, 3. Laboratory tests cannot, and should not, be performed on every individual after
every health care encounter.
Diabetes screening is recommended by the U.S. Preventive Services Task Force only for
asymptomatic adults with treated or untreated blood pressure over 135/80 mm Hg, even though
hypertension is only one of many known risk factors for diabetes9. In this sample, 27.5% of
patients with type 2 diabetes did not have a hypertension diagnosis; this criterion would result
in lab tests for 1 in 3 healthy patients, while failing to identify roughly 1 in 4 patients with type 2
diabetes. These data suggest that more sophisticated screening methods are needed, consistent
with the Wilson and Jungner criteria10, 11.
Many current diabetes risk models are not generalizable to the disproportionate number of
ethnic/racial minorities with Type 2 diabetes in the U.S. 12. For example, the FINDRISC score
was developed on Finnish patients13. Although it was found to be the best risk assessment tool in
Caucasian patients8, it was suboptimal for use on Arab and Filipino populations14, 15. Therefore,
wide-scale screening methods that assume a “one-size-fits all” approach is simply not feasible
among heterogeneous populations. Considering that African Americans, Hispanic/Latino
Americans, American Indians, Asian Americans, and Pacific Islander Americans are at
particularly high risk for type 2 diabetes1, it is important to understand the unique risk factors
that continue to drive this growing health disparity among these groups, and to assess risk
accurately in the subpopulations most likely to have the disease.
Electronic health care records are used by more than half of the nation's health care providers,
and more than 80% of hospitals have implemented electronic records since the 2009 stimulus
bill16. EHRs are also of interest among research investigators, as this provides a rich data
resource that can improve research efficiency, as advocated by the NIH’s Health Care Systems

2

Collaboratory (https://www.nihcollaboratory.org/) program which engages healthcare systems
to improve medical research17. EHR-based phenotypes can profile individuals who may benefit
from interventions18. In a similar fashion, an evaluation guided by EHRs may improve the
treatment and prognosis for patients with type 2 diabetes19. For instance, usage of an EHR was
associated with a decreased rate of emergency department visits in individuals with diabetes20,
21, and EHR data have been used to compute the prospective risk of developing dementia in
individuals with diabetes22. While EHRs have demonstrated potential for detecting and
monitoring diabetes23-26, previous studies have used only a subset of all information available in
the medical record, and typically have assessed risk only on patients for whom there were
specific laboratory results available (e.g., fasting plasma glucose). In order for EHR
phenotyping to be used in practice, it must improve accuracy even when using “typical” quality
records, containing large amounts of missing data and unsystematic recordings across practice
locations, consistent with at-risk patients receiving inconsistent medical attention27.
Current risk scores pose an economic and logistical challenge for population-wide screening,
and are less sensitive to detecting diabetes in non-white populations who are more likely to have
diabetes16,17. More generally, automatically predicting chronic disease using electronic health
records has numerous applications outside of clinical practice, and would open the riskassessment doorway to those who ultimately bear the financial burden incurred by the disease:
the insurers. A better estimate of risk on the part of insurers could encourage targeted patienteducation and incentive programs to reduce financial liability.
EHR models extend screening, conventionally framed between the doctor and the patient, to the
payer and the patient. Data mining methods are powerful, but wild-type electronic records
frequently are messy18; these tools should be validated against real-world data if realistic results
are desired. We examine whether augmenting risk scores using EHR-derived phenotypes would
increase sensitivity in the general population for detecting patients who should be screened
further using laboratory testing, even when records are incomplete, and are not recorded
systematically across health professionals and/or practice locations. When implemented on a
population, this step-wise screening process would decrease the public health cost of more
expensive testing, while simultaneously identifying previously overlooked at-risk patients.
Subjects
The study population included 9,948 patients, 18.1% diagnosed with type 2 diabetes, within the
EHRs provided by the web-based company, Practice Fusion. Practice Fusion provides an EMR
service which is free to health care providers. These records were collected between 2009 and
2012 in a retrospective study, from 1,137 unique sites spanning all 50 United States, detailed
further in Table 1. This dataset is public and de-identified. We intentionally use an unselected
patient population who had a wide variety of laboratory tests, prescribed medications, and
diagnoses across 1,137 different practice locations. In contrast to a controlled research
environment28, this EHR data approximates the diverse US clinical environment, including the
presence of unsystematic and incomplete information reflective of at-risk patients receiving
inconsistent medical care.
Exact visit dates were removed as patient-identifying information. A patient was labeled as
either healthy, or having “Type 1" or “Type 2" diabetes according to at least one corresponding
diagnosis within ICD-9 250.X category (no patients had mixed diagnoses). No ethnicity
information was provided in this sample. There were approximately 131,000 patient unique
transcript entries (containing height, weight, BMI, BP, Respiratory Rate, and Heart Rate) for the

3

9,948 patients across an approximately 4 year time period, leading to roughly 2-3
visits/year/patient, on average.
Table 1: Demographic Information

This dataset was rich in the breadth of information it contained: lab results; medication dosage,
and history; basic patient demographic information (age, gender, state); smoking status;
transcripts (BMI, systolic/diastolic blood pressure (BP), height, weight); allergies; and
diagnosed conditions for each visit as ICD-9 codes. We identified and condensed redundant
features manually (e.g. Warfarin and Coumadin). When BMI values were over 70, or below 10,
we re-coded height and weight as not available (“-NA-”). Moreover, the “Healthy Controls” in
this sample, on average, had more prescribed medications and higher smoking rates than
patients with Type 1 or Type 2 Diabetes. This natural sample provided a more realistic control
group to identify which factors in the EHR were predictive of a Type 2 diabetes diagnosis.
Missing data were common in this sample: less than 1% of the patients had a recorded family
history of diabetes (ICD9 V18.0), despite a prevalence of 11.8% in the US population. This posed
a “worst case" scenario for prediction: given missing, unsystematic and incomplete information
from a patient’s medical history, could residual information still augment current diabetes risk
scores in a way that improves the accuracy and efficiency of type 2 diabetes screening in the
general population?
Materials and Methods
We assessed whether Type 2 diabetes risk scores could be improved with EHR phenotypes,
created using the additional medical and diagnostic information contained in the EHR. Because
the visit dates were removed to protect patient privacy, longitudinal data were not available. It
is therefore unknown whether patients developed diabetes during their time of service, or
whether it preceded their entry into this study. It is similarly unknown whether patients
identified as “healthy” had undiagnosed diabetes. Similarly, the ordering of medications, nondiabetes diagnoses, and the diabetes diagnosis are similarly unknown. Using real-world clinical
data, these models then assess the current likelihood of a patient having a current diagnosis of
Type 2 Diabetes, rather than the future likelihood of developing diabetes. The value of including
EHR information was computed by comparing models using a chi-square test.

4

We predicted current Type 2 diabetes status using a multivariate logistic regression in R29
comparing three separate models: (1) Conventional Model mimicking conventional risk scores;
(2) a full “EHR Model” based upon the EHR phenotype, containing conventional information
and both diagnostic and prescription information; (3) “EHR DX” model which contained
conventional information and diagnostic information. Within this model, prescription
information was removed because a diabetes diagnosis would likely physician prescribing habits.
Models are described in more detail below.
The first model (Conventional model) mimics conventional risk scores by including only the
limited subset of covariates (smoking status, gender, age, BMI, and hypertensive status) that
have been used in current diabetes risk models 8, 21, and included all interaction effects. This was
used as a reference standard in lieu of established risk scores because it ensures that difference
between the two models is attributable to the structure and covariates, instead of the underlying
study populations. We compared these models in a hierarchical regression with a chi-square
test, and computed Receiver Operating Characteristic (ROC) curves by measuring the Area
Under the Curve (AUC) within the R package ROCR 30.
The second “EHR Model" used 298 features: 150 most common diagnoses, 150 most commonly
prescribed medications (before condensing name-brand and generic), transcript information
(Table 2), and other specialized features summarized in Table 2. Hypertensive status,
hyperlipidemia, and metabolic diagnosis all were assessed separately. In order to reduce bias we
removed as predictors established treatments and complications of diabetes mellitus: primary
and secondary diabetes-related diagnoses (ICD-9 250.X, 249.X), foot ulcers (ICD-9 707.X),
diabetic retinopathy (ICD-9 362.01), polyneuropathy in diabetes (ICD-9 357.2), diabetic cataract
(ICD-9 366.41), and diabetes mellitus complicating pregnancy, childbirth or the puerperium
(ICD-9 648.0X). Medications used to treat diabetes, such as metformin (GlucophageTM), were
excluded from the model.
For the EHR Model, we created an “additional risk factor” variable tallying common
comorbidities of diabetes, including conditions that have been shown to be more common in
diabetes, but may be caused by factors other than diabetes. These included: candidiasis of skin
and nails, malignant neoplasm of pancreas, other disorders of pancreatic internal secretion,
polycystic ovaries, disorders of lipoid metabolism, overweight, obesity, and other
hyperalimentation, trigeminal nerve disorders, hypertensive heart disease, acute myocardial
infarction, other acute and subacute forms of ischemic heart disease, old myocardial infarction,
angina pectoris, other forms of chronic ischemic heart disease, atherosclerosis, gingival and
periodontal diseases, disorders of menstruation and other abnormal bleeding from female
genital tract, unspecified local infection of skin and subcutaneous tissue, acquired acanthosis
nigricans and tachypnea.
The third “EHR DX Model” used all features as in the EHR model, yet excluded all the
medications. This was based on the assumption that a clinician’s prescribing behavior would
likely be influenced by a patient’s diabetes status. Given that this sample is not longitudinal,
excluding medication information reduces the bias inherent in all observational studies.

5

Table 2: Summary of Variables Used to Predict Diabetes

Within the EHR model, the multivariate logistic regression implies necessarily that the
covariates of interest and the resulting p-values are statistically dependent, making traditional
multiple hypotheses correction methods unnecessary (e.g. Bonferroni correction). We make our
interpretation more conservative by adjusting for the false discovery rate (FDR) using the
graphically sharpened method, setting the maximum proportion of false discoveries at .0531, 32 as
implemented by Pike.33 The FDR is computed over all 298 estimated p-values. We indicate
which variables had q-values (adjusted p-values) in the FDR significance range using an asterisk
within the regression tables, along with odds-ratio 95%-confidence intervals which take into
account the prevalence of the risk factors being considered.
Finally, we assessed the validity of these three models with a hold-out dataset using a random
forests prediction model, to assess the sensitivity of these models to overfitting 34. In the
random forests model, decision trees are constructed by resampling with replacement from the
data and the predictors. Prediction of cases, using individual decision trees which did not
sample that observation, provides an unbiased estimate of the testing accuracy. We run the
random forest model using the data from the EHR model, the EHR DX model, and the
conventional model. Machine learning methods such as random forests are undeniably more
powerful in their prediction, and the testing accuracy they provide is an unbiased estimate of the
predictive power on new observations. Here, we create random forests models using a
regression, to create similar ROC curves as the logistic models.
Results
The Full EHR model had sensitivity: 80.6% (78.6%-82.4%), specificity: 74.0% (72.9%-74.9%),
and overall accuracy: 75.2% (77.3%-79.0%). When excluding medications in the EHR model, the
overall accuracy dropped only slightly to 73.2% (72.3%-74.1%). The DX EHR model had
sensitivity: 79.2% (77.2%-81.0%), specificity: 71.9% (70.9%-72.8%). The conventional model
had sensitivity: 78.1% (76.1%-80.0%), specificity: 60.2% (59.1%-61.3%), and overall accuracy:

6

63.4% (62.4%-64.4%). All ranges correspond to 95% confidence intervals, using a decision
threshold corresponding to the disease prevalence in the population (18.1%). All ranges reflect
95% confidence intervals.
The Full EHR model had a positive predictive value of 40.7% (39.0%-42.3%), and a negative
predictive value of 94.5% (93.9%-95.1%). The DX EHR model had a positive predictive value of
38.4% (36.9% - 40.0%) and a negative predictive value of 94.0% (93.3%-94.5%). The
conventional model had a positive predictive value of 30.3% (28.9%-31.7%) and a negative
predictive value of 92.5% (91.8%-93.3%).
The Full EHR model and the DX EHR Models both predicted better than the conventional
models (chi-square test, p<0.001). For the Full EHR Model, the AUC was 84.9%; for the DX
EHR Model, the AUC was 83.2%; for the Conventional model, the AUC was 75.0%. The
sensitivity of the EHR models was uniformly superior for all thresholds, as shown in Figure 1.
Factors associated significantly with a Type 2 diabetes diagnosis for the EHR model are
presented in Table 3, with the full EHR model containing 298 coefficients and significance levels
supplied in the Supplemental Table along with the Conventional Model.

7

Table 3: Statistically Significant Covariates to determine Type 2 Diabetes Status
using EHR phenotypes: variables on the top half of the table decrease the
likelihood of type 2 diabetes, while variables on the bottom half increase the
likelihood of type 2 diabetes. Significance indicates * for P < 0.05, ** for P < 0.01,
and *** for P < 0.001. Q-significance indicates p-values after adjusting for the
false-discovery rate, which controls for the total rate of falsely rejected null
hypotheses.

In the conventional model the variables age, hypertensive status, and the interaction of age with
hypertension, all were significant predictors of type 2 diabetes. The interaction between age and
hypertensive status indicated that younger hypertensive patients had a greater chance of type 2

8

diabetes than elderly hypertensive patients. The 298 coefficients for both the full EHR model,
the EHR DX Model, and the conventional model are provided within the Supplementary Data
Table 1, Table 2, and Table 3.
Within the hold-out data (using the random forests probabilistic models), the EHR models had
stronger sensitivity than the Conventional model for all thresholds, as shown in Table 4 and
Figure 2. The AUC for the full EHR model, the EHR DX model, and the Conventional model
were (81.3%, 79.6%, 74.8%). The overall accuracies were dependent on thresholds chosen, but
for all thresholds, the ROC curve for the EHR models exceeded the sensitivity of the
conventional model as shown in Supplementary Figure 2. Additionally, the random forest
accuracies on the hold-out data were actually greater than the within-sample accuracy using the
logistic regression model, demonstrating that machine-learning models have much stronger
ability to predict chronic disease than the traditional parametric models. The overall accuracy of
the algorithm is somewhat less important than the sensitivity and the positive predictive value.
Algorithms which sought only to maximize total accuracy (removing weights and thresholds)
had higher overall accuracy (84%) but markedly inferior sensitivity, implying that they would
rarely classify an individual as having diabetes.
Table 4: Models containing both diagnostic and medication information
performed better than the Conventional models. While the overall accuracies
depended on the choice of thresholding, for all thresholds the sensitivity of the
EHR models exceeded that of conventional models.

Discussion
The EHR phenotype models outperformed the basic screening model for detecting individuals
at-risk for diabetes. While many of the risk factors identified in the full EHR model have been
identified previously, they have not been evaluated within the context of all other clinical factors.
Our model is not prognostic; the factors we have found associated with type 2 diabetes might be
complications or comorbidities of the disease, rather than its cause. However, given the finding
that type 2 diabetes was diagnosed most frequently after a patient exhibited at least one
complication, and that 25% of patients are undiagnosed35, this situation may reflect clinical
practice. We specifically excluded known complications of diabetes to reduce this bias, but the
complications and causes of diabetes often can be intertwined (e.g. cardiovascular disease).
Additionally, we demonstrated that the EHR had strong predictive power when excluding all
physician-prescribed medications, suggesting that the diagnoses contain nearly the same
information as the medications prescribed to treat them.
Each of the discussed factors is associated with diabetes and could be used as clinical markers of
increased risk, but should not be considered cause or consequence of the disease. For example,
specific clinic locations were associated with an increased likelihood of current type 2 diabetes.
This reflects different baseline prevalence of type 2 diabetes within different communities36. Due
to the structure of our multivariate logistic regression model, each discussed factor was

9

significant, controlling for and separate from all other measured factors, while adjusting for the
false discovery rate.
We discuss first the factors that increased the likelihood of type 2 diabetes mellitus. We do not
interpret the relative magnitude of each factor, only its sign. Hypercholesterolemia and
hypertension are the two other pillars of metabolic syndrome37; therefore we fully expected that
these disorders would be highly associated due to similar underlying pathophysiology and risk
factors. Medications used to treat nerve disorder have side effects of weight gain (pregabalin &
gabapentin), which might indirectly be causal in the development of insulin tolerance in type 2
diabetes38, 39. However, because these medications also may be prescribed to treat diabetic
neuropathy, this relationship was unclear. Similarly, the importance of common complications
of type 2 diabetes reflects the current state of care, where patients should be assessed for type 2
diabetes if they experience complications associated with the disease, such as decreased innate
or acute immune function or neural pain. Overall, this list of positively associated factors for
current type 2 diabetes was in consensus with the literature. Therefore, our results suggest that
EHR research can determine effectively that each of these established risk factors were
independent, and meaningful in the full context of the patient.
The factors that decrease the likelihood of diabetes have been discussed less frequently in the
literature, potentially because the cost of missing high-risk patients is greater than the benefit of
identifying low-risk patients. Although there is no ICD-9 code for physical activity, the factors in
this category reflect the treatment for mild discomfort, temporary pain, and potential athletic
injuries. Athletic activity decreases insulin sensitivity, even when no weight loss is achieved, and
this is important for the prevention and management of type 2 diabetes5. In contrast to these
factors, we found also that markers of physical frailty, and diseases that inhibit food intake,
decreased the risk of current type 2 diabetes. Patients with these conditions are at risk for
muscle loss, which was associated negatively with type 2 diabetes40-42. In aggregate, these factors
of increased activity or frailty can be viewed, alternatively, as signs of increased health
consciousness. We found that patients who were integrated into the medical system or aware of
the consequences of chronic disease were less likely to have current type 2 diabetes.
One of the benefits of EHR research is that, in addition to verifying the factors that had a
relatively clear interpretation, EHR mining can identify factors where the link with disease is
either unproven or unsuspected. Some factors identified here are less established in the type 2
diabetes literature. In particular, although some work has addressed the association of
homosexuality, sexual identity disorders, and sexual deviancy (ICD-9 302.X) with diabetes43, 44,
our results suggest that more work should be done to understand the link between diabetes and
these factors, so that at-risk patients can be identified better. In contrast to increasing the risk of
current type 2 diabetes, we are uncertain why allergic rhinitis (ICD-9 477.X), and use of depot
medroxyprogesterone contraceptives, decreased the prevalence of type 2 diabetes. Even though
type 2 diabetes has been shown to affect innate or acute immunity45, we are unaware of a strong
link between type 2 diabetes and allergies, which primarily are a dysfunction of the adaptive or
acquired immune system. Due to the underlying etiology behind the previous controversial link
between exogenous hormone treatment for menopause and cardiovascular risk, we expect that
the usage of depot medroxyprogesterone contraceptives reflects a patient population that
engages in other activities that decrease type 2 diabetes risk, and not that depot
medroxyprogesterone itself is protective for type 2 diabetes. The interpretation of each of these
factors is unclear, therefore our results suggest that more work should be done to understand
these observed links.

10

In addition to these interpretable factors, there were a number of factors that were associated
negatively with type 2 diabetes, even though the literature suggested that the association should
be positive. An established side effect of prednisone treatment is increased insulin resistance
and steroid-induced type 2 diabetes46. Therefore, clinicians may prescribe prednisones only in
low-risk patients. As noted above, type 2 diabetes is associated positively with disorders of the
innate or acute immune system, metabolic syndrome and cardiac dysfunction; therefore we are
uncertain why some of these factors were negatively associated with type 2 diabetes. Further,
type 2 diabetes is a risk factor for hemorrhoids (ICD-9 455.X). Migraine also shares common
comorbidities with type 2 diabetes47, including some we identified here. Therefore, we are
uncertain why the diagnosis of migraine decreased the risk of current type 2 diabetes. Our EHR
model found also that being a current smoker decreased the risk of diabetes, which reflects how
smoking increases base metabolic rate. Yet, this contradicts at least one study in the literature48
which found smoking increased diabetes risk. However, this difference may be due to how we
controlled for many other factors, while previous studies on smoking and diabetes accounted for
a limited number of confounders (e.g. age & BMI). These factors warrant further study to
understand why our analysis of EHR records did not replicate previous work.
While these results seem to summarize and review the major themes in research, we also
identified factors that were not significantly associated, positively or negatively, with type 2
diabetes, and are related to the themes we discussed above. This lack of significance could reflect
either a lack of statistical power due to infrequent prescribing and thereby false negatives, or a
lack of an effect. Not all disorders of acute or innate immunity or the treatment for those
conditions were associated with type 2 diabetes. Even though some were, not all medications for
hypertension and hypothyroidism or markers of physical frailty were associated with current
type 2 diabetes. Medications hypothesized to be associated with diabetes, such as varenicline49,
were not associated in our analysis.
Our model also faced challenges with missing data such as family history, and did not contain
several important risk factors for diabetes, such as ethnicity and socioeconomic status26, due to
incomplete patient records. The missing data affected mainly the full EHR model, as the basic
covariates (age, BMI, etc.) were rarely missing. Missing data in this population wasn’t addressed,
but it could have been imputed to improve accuracy and reduce bias. Patients with Type 1
diabetes were underrepresented in this sample. Although we established a protocol for
interpreting medication and laboratory test results, there was large variation in the reporting of
these factors; therefore some bias and/or misreporting could be present. Due to privacy
concerns, our model was unable to incorporate longitudinal information in the EHR that we
would expect to improve its overall accuracy. Moreover, this model was trained using patients
who had a current diagnosis of Type 2 diabetes, which implicitly assumes that diagnosed and
undiagnosed diabetes patients are similar, but this hypothesis needs to be confirmed. In the
future, we will confirm the profiles of diagnoses and undiagnosed patients using longitudinal
data on an independent database, with a 12-18 month pre-index period with no diagnoses for
Type I or II.
It also was intriguing that a family history of diabetes did not show a strong effect. Along with
poor family medical history reporting, this implies that even although there is a genetic link for
type 2 diabetes, non-genetic factors may have more effectively identified at-risk patients. We
were not able to incorporate ethnicity information into this model, because such information
was unavailable. Given that the prevalence of diabetes in the sample population (18.1%) greatly
exceeded the general US diabetes prevalence (11.8%), this suggests that the sample population
may have had an over-representation of minority patients. The superior performance of the
EHR phenotype model compared to the conventional model may indicate then that additional

11

health information provides additional diabetes risk factors that are especially relevant to
minority populations.
Conclusion
Given that nearly 1 in 3 Americans will develop diabetes at some point in their lifetime,
predicting and assessing diabetes risk on a population-wide scale is critical for both prevention
and effective treatment. We anticipate that the largest adopter of EHR phenotype models will be
insurers; risk scores will be created using existing claims databases. Given that the average
patient with diabetes incurs over twice the expected cost as a patient without 7, there exists a
significant financial incentive for insurers to reduce diabetes risk in patients they cover. An
EHR phenotype-based pre-screen could be used for national diabetes screening at little cost, as
risk scores could be computed automatically within EHRs to efficiently identify patients who
should undergo more formal and sensitive laboratory screening and/or preventive behavioral
interventions. Individual patients who are at high-risk for chronic and costly diseases will be
targeted for patient-education programs, and reduction in calculated risk will be rewarded
monetarily.
These promising results showed EHR phenotypes provided superior predictive accuracy for
assessing diabetes status, compared to traditional non-laboratory information (p<0.001). We
have demonstrated that this is possible even in the face of a diverse, at-risk patient population,
with missing and incomplete patient records pooled across practice locations. This suggests that
incorporating more medical history would increase the accuracy of existing diabetes risk scores
in at-risk patient populations, for step-wise screening. The total increase in accuracy for full
screening is partially dependent upon how much of the additional information provided by the
EHR is correlated with the laboratory testing. Due to the retrospective and correlative nature of
EHR research, we cannot resolve whether the EHR phenotype risk factors were a cause or effect
of diabetes, but this may match clinical practice where 25% of people with type 2 diabetes are
undiagnosed.
Given that this analysis showed superior prediction of diabetes using only 3 years of incomplete
and unsystematically recorded data, we anticipate that the true signal and potential of an ideal,
complete, and systematically utilized EHR is much greater than we demonstrate here. As EHRs
become more widely used, we hope that the size and quality of the records will increase by
orders of magnitude. This demands that future databases should be constructed in such a way as
to allow easy data mining; and thereby to encourage researchers to develop prospective risk
models27, 50. Reducing the amount of missing data would only strengthen the ability of these
models to detect type 2 diabetes.
We, and others, have advocated that data mining EHRs could be used to address numerous
clinical challenges51-53, such as identifying patients at risk for depression, suicide, strokes, and
cardiovascular events. Risk scores, not limited just to diabetes, should be automatically
computed and included in a general patient profile, providing physicians an instant assessment
of potential health conditions. EHR phenotypes additionally could be used for assessment of
treatment efficacy, when incorporated into statistical models such as a propensity score 28.
Beyond prediction, using EHR-phenotype models provide invaluable information about the risk
factors themselves. For example, EHRs can be used to assess comparative risks of medication
classes (as is being done54), and answer important treatment questions, including whether
statins or fibrates should be used to treat high cholesterol in patients with diabetes. However,
our experience with hormonal therapy for menopause55 taught us that, while there is great

12

potential in retrospective, observational studies, the highest level of evidence is a doubleblinded, randomized clinical trial. Because of this, resulting associations with diabetes are
necessarily ambiguous, with no defined causal relationship, and need to be carefully scrutinized
in light of complementary controlled studies27. For screening of a disease that is both the fifth
leading cause of preventable death in the United States and has a tremendous rate of
undiagnosed patients, we argue that the accuracy of the model is more important any causal
inference of the predictors. Because the EHR and data mining are both nascent, there is a vast
unexplored territory with applications so broad they have yet to be defined.

13

Acknowledgements:
We acknowledge NIH R33DA026109 to M.S.C., the University of California (UCLA)-California
Institute of Technology Medical Scientist Training Program (NIH T32 GM08042), the Systems
and Integrative Biology Training Program at UCLA (NIH T32 GM008185), and the UCLA
Department of Biomathematics for partial funding of this research. We additionally thank
Practice Fusion, Inc. for providing data publicly for research. Ariana E. Anderson, Ph.D., holds a
Career Award at the Scientific Interface from the Burroughs Wellcome Fund.

14

0.4

0.6

Full EHR Model
DX EHR Model
Traditional Model

0.0

0.2

True positive rate

0.8

1.0

ROC Curve

0.0

0.2

0.4

0.6

0.8

1.0

False positive rate
Figure 1: ROC Curve comparing Traditional to EHR phenotype Diabetes
Prediction, using logistic regression model.

15

0.4

0.6

Full EHR Model
DX EHR Model
Traditional Model

0.0

0.2

True positive rate

0.8

1.0

ROC Curve

0.0

0.2

0.4

0.6

0.8

1.0

False positive rate
Figure 2: ROC Curve comparing Traditional to EHR phenotype Diabetes
Prediction, using random forests holdout models.

Competing Interests:
The authors declare that they have no competing interests.
Authors Contributions:
AA conceived of the study, performed the statistical analysis, and wrote the first draft of the
manuscript. WK interpreted results and models. All authors contributed to manuscript
revisions, and have read and approve of the final draft.

16

17

References:
1.
Control CfD, Prevention, Control CfD and Prevention. National diabetes fact sheet: national estimates and
general information on diabetes and prediabetes in the United States, 2011. Atlanta, GA: US Department of Health
and Human Services, Centers for Disease Control and Prevention. 2011; 201.
2.
Kahn R, Alperin P, Eddy D, et al. Age at initiation and frequency of screening to detect type 2 diabetes: a
cost-effectiveness analysis. The Lancet. 2010; 375: 1365-74.
3.
Gillies CL, Lambert PC, Abrams KR, et al. Different strategies for screening and prevention of type 2
diabetes in adults: cost effectiveness analysis. Bmj. 2008; 336: 1180-5.
4.
Tuomilehto J, Lindström J, Eriksson JG, et al. Prevention of type 2 diabetes mellitus by changes in lifestyle
among subjects with impaired glucose tolerance. New England Journal of Medicine. 2001; 344: 1343-50.
5.
Pan X-R, Li G-w, Hu Y-H, et al. Effects of diet and exercise in preventing NIDDM in people with impaired
glucose tolerance: the Da Qing IGT and Diabetes Study. Diabetes Care. 1997; 20: 537-44.
6.
Lim E, Hollingsworth K, Aribisala B, Chen M, Mathers J and Taylor R. Reversal of type 2 diabetes:
normalisation of beta cell function in association with decreased pancreas and liver triacylglycerol. Diabetologia.
2011; 54: 2506-14.
7.
Association AD. Economic costs of diabetes in the US in 2012. Diabetes Care. 2013; 36: 1033-46.
8.
Schwarz P, Li J, Lindstrom J and Tuomilehto J. Tools for predicting the risk of type 2 diabetes in daily
practice. Hormone and metabolic research. 2009; 41: 86-97.
9.
Calonge N, Petitti DB, DeWitt TG, et al. Screening for type 2 diabetes mellitus in adults: US Preventive
Services Task Force recommendation statement. Annals of internal medicine. 2008; 148: 846-54.
10.
Wilson J and Jungner G. Principles and practice of screening for disease. Geneva: World Health
Organization, 1968. Public health papers. 2011; 34.
11.
Sheehy AM, Coursin DB and Gabbay RA. Back to Wilson and Jungner: 10 good reasons to screen for type
2 diabetes mellitus. Mayo Clinic Proceedings. Mayo Foundation, 2009, p. 38.
12.
Rosella LC, Mustard CA, Stukel TA, et al. The role of ethnicity in predicting diabetes risk at the population
level. Ethnicity & health. 2012; 17: 419-37.
13.
Lindström J and Tuomilehto J. The Diabetes Risk Score A practical tool to predict type 2 diabetes risk.
Diabetes Care. 2003; 26: 725-31.
14.
Ku G and Kegels G. The performance of the Finnish Diabetes Risk Score, a modified Finnish Diabetes
Risk Score and a simplified Finnish Diabetes Risk Score in community-based cross-sectional screening of
undiagnosed type 2 diabetes in the Philippines. Primary care diabetes. 2013; 7: 249-59.
15.
Al-Lawati J and Tuomilehto J. Diabetes risk score in Oman: a tool to identify prevalent type 2 diabetes
among Arabs of the Middle East. Diabetes research and clinical practice. 2007; 77: 438-44.
16.
Brooks R and Grotz C. Implementation of electronic medical records: How healthcare providers are
managing the challenges of going digital. Journal of Business & Economics Research (JBER). 2010; 8.
17.
Richesson RL, Hammond WE, Nahm M, et al. Electronic health records based phenotyping in nextgeneration clinical trials: a perspective from the NIH Health Care Systems Collaboratory. Journal of the American
Medical Informatics Association. 2013; 20: e226-e31.
18.
Newton KM, Peissig PL, Kho AN, et al. Validation of electronic medical record-based phenotyping
algorithms: results and lessons learned from the eMERGE network. Journal of the American Medical Informatics
Association. 2013; 20: e147-e54.
19.
Cebul RD, Love TE, Jain AK and Hebert CJ. Electronic health records and quality of diabetes care. New
England Journal of Medicine. 2011; 365: 825-33.
20.
Reed M, Huang J, Brand R, et al. Implementation of an outpatient electronic health record and emergency
department visits, hospitalizations, and office visits among patients with diabetes. JAMA. 2013; 310: 1060-5.
21.
Speedie SM, Park Y-T, Du J, et al. The impact of electronic health records on people with diabetes in three
different emergency departments. Journal of the American Medical Informatics Association. 2014; 21: e71-e7.
22.
Exalto LG, Biessels GJ, Karter AJ, et al. Risk score for prediction of 10 year dementia risk in individuals
with type 2 diabetes: a cohort study. The Lancet Diabetes & Endocrinology. 2013; 1: 183-90.
23.
Mani S, Chen Y, Elasy T, Clayton W and Denny J. Type 2 diabetes risk forecasting from EMR data using
machine learning. AMIA Annual Symposium Proceedings. American Medical Informatics Association, 2012, p. 606.
24.
Griffin S, Little P, Hales C, Kinmonth A and Wareham N. Diabetes risk score: towards earlier detection of
type 2 diabetes in general practice. Diabetes/metabolism research and reviews. 2000; 16: 164-71.
25.
Woolthuis EPK, de Grauw WJ, van Gerwen WH, et al. Identifying people at risk for undiagnosed type 2
diabetes using the GP's electronic medical record. Family practice. 2007; 24: 230-6.

18

26.
Hippisley-Cox J, Coupland C, Robson J, Sheikh A and Brindle P. Predicting risk of type 2 diabetes in
England and Wales: prospective derivation and validation of QDScore. BMJ: British Medical Journal. 2009; 338.
27.
Hersh WR, Weiner MG, Embi PJ, et al. Caveats for the use of operational electronic health record data in
comparative effectiveness research. Medical Care. 2013; 51: S30-S7.
28.
Schneeweiss S. Learning from Big Health Care Data. New England Journal of Medicine. 2014; 370: 21613.
29.
Team RDC. R: A language and environment for statistical computing. R foundation for Statistical
Computing. 2005.
30.
Sing T, Sander O, Beerenwinkel N and Lengauer T. ROCR: visualizing classifier performance in R.
Bioinformatics. 2005; 21: 3940-1.
31.
Benjamini Y and Hochberg Y. On the adaptive control of the false discovery rate in multiple testing with
independent statistics. Journal of Educational and Behavioral Statistics. 2000; 25: 60-83.
32.
Verhoeven KJ, Simonsen KL and McIntyre LM. Implementing false discovery rate control: increasing your
power. Oikos. 2005; 108: 643-7.
33.
Pike N. Using false discovery rates for multiple comparisons in ecology and evolution. Methods in Ecology
and Evolution. 2011; 2: 278-82.
34.
Breiman L. Random forests. Machine learning. 2001; 45: 5-32.
35.
Harris MI. Undiagnosed NIDDM: clinical and public health issues. Diabetes Care. 1993; 16: 642-52.
36.
Peréz-Stable EJ, Napoles-Springer A and Miramontes JM. The effects of ethnicity and language on medical
outcomes of patients with hypertension or diabetes. Medical Care. 1997: 1212-9.
37.
Grundy SM, Brewer HB, Cleeman JI, Smith SC and Lenfant C. Definition of metabolic syndrome report of
the National Heart, Lung, and Blood Institute/American Heart Association Conference on scientific issues related to
definition. Circulation. 2004; 109: 433-8.
38.
Silveira D, Klein P, Ransil B, et al. Lateral asymmetry in activation of hypothalamic neurons with
unilateral amygdaloid seizures. Epilepsia. 2000; 41: 34-41.
39.
Williams KW and Elmquist JK. Lighting up the hypothalamus: coordinated control of feeding behavior.
Nature neuroscience. 2011; 14: 277.
40.
Fiatarone MA and Evans WJ. 11 The Etiology and Reversibility of Muscle Dysfunction in the Aged.
Journal of Gerontology. 1993; 48: 77-83.
41.
Jeejeebhoy K. Muscle function and nutrition. Gut. 1986; 27: 25-39.
42.
Hubert HB, Bloch DA and Fries JF. Risk factors for physical disability in an aging cohort: the NHANES I
Epidemiologic Followup Study. The Journal of rheumatology. 1993; 20: 480-8.
43.
Boehmer U, Bowen DJ and Bauer GR. Overweight and obesity in sexual-minority women: evidence from
population-based data. American Journal of Public Health. 2007; 97: 1134-40.
44.
Conron KJ, Mimiaga MJ and Landers SJ. A population-based study of sexual orientation identity and
gender differences in adult health. American Journal of Public Health. 2010; 100: 1953-60.
45.
Pickup JC. Inflammation and activated innate immunity in the pathogenesis of type 2 diabetes. Diabetes
Care. 2004; 27: 813-23.
46.
Pagano G, Cavallo-Perin P, Cassader M, et al. An in vivo and in vitro study of the mechanism of
prednisone-induced insulin resistance in healthy subjects. Journal of Clinical Investigation. 1983; 72: 1814.
47.
Scher AI, Bigal ME and Lipton RB. Comorbidity of migraine. Current opinion in neurology. 2005; 18:
305-10.
48.
Wannamethee SG, Shaper AG and Perry IJ. Smoking as a modifiable risk factor for type 2 diabetes in
middle-aged men. Diabetes Care. 2001; 24: 1590-5.
49.
Kristensen P, Pedersen-Bjergaard U and Thorsteinsson B. Varenicline may trigger severe hypoglycaemia
in Type 1 diabetes. Diabetic Medicine. 2008; 25: 625-6.
50.
Kudyakov R, Bowen J, Ewen E, et al. Electronic health record use to classify patients with newly
diagnosed versus preexisting type 2 diabetes: infrastructure for comparative effectiveness research and population
health management. Population health management. 2012; 15: 3-11.
51.
Roque FS, Jensen PB, Schmock H, et al. Using electronic patient records to discover disease correlations
and stratify patient cohorts. PLoS computational biology. 2011; 7: e1002141.
52.
Masica M and Collinsworth M. Leveraging Electronic Health Records in Comparative Effectiveness
Research. Prescriptions for Excellence in Health Care Newsletter Supplement. 2012; 1: 6.
53.
Kerr WT, Lau EP, Owens GE and Trefler A. The future of medical diagnostics: large digitized databases.
The Yale journal of biology and medicine. 2012; 85: 363.

19

54.
Miriovsky BJ, Shulman LN and Abernethy AP. Importance of health information technology, electronic
health records, and continuously aggregating data to comparative effectiveness research and learning health care.
Journal of Clinical Oncology. 2012; 30: 4243-8.
55.
Investigators WGftWsHI. Risks and benefits of estrogen plus progestin in healthy postmenopausal women:
principal results from the Women's Health Initiative randomized controlled trial. JAMA. 2002; 288: 321-33.

20

