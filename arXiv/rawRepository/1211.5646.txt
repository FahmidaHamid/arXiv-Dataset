Quasispecies Theory for Evolution of Modularity
Jeong-Man Park, Liang Ren Niestemski, and Michael W. Deem
Department of Physics & Astronomy,
Rice University, Houston, TX 77005–1892, USA

arXiv:1211.5646v4 [q-bio.PE] 5 Jan 2015

Department of Physical and Biological Science,
Western New England University Springfield MA, 01119
Department of Physics, The Catholic University of Korea, Bucheon 420-743, Korea

Abstract
Biological systems are modular, and this modularity evolves over time and in different environments. A number of observations have been made of increased modularity in biological systems
under increased environmental pressure. We here develop a quasispecies theory for the dynamics
of modularity in populations of these systems. We show how the steady-state fitness in a randomly
changing environment can be computed. We derive a fluctuation dissipation relation for the rate of
change of modularity and use it to derive a relationship between rate of environmental changes and
rate of growth of modularity. We also find a principle of least action for the evolved modularity
at steady state. Finally, we compare our predictions to simulations of protein evolution and find
them to be consistent.
PACS numbers: 87.10.-e, 87.15.A-, 87.23.Kg

1

I.

INTRODUCTION

Biological systems have long been recognized to be modular. In 1942 Waddington presented his now classic description of a canalized landscape for development, in which minor
perturbations do not disrupt the function of developmental modules [1]. In 1961 H. A.
Simon described how biological systems are more efficiently evolved and are more stable if
they are modular [2]. A seminal paper by Hartwell et al. firmly established the concept of
modularity in cell biology [3]. Systems biology has since provided a wealth of examples of
modular cellular circuits, including metabolic circuits [4, 5] and modules on different scales,
i.e. modules of modules [6]. Protein-Protein interaction networks have been observed to be
modular [7–9]. Ecological food webs have been found to be modular [10]. The gene regulatory network of the developmental pathway exhibits modules [11, 12], and the developmental
pathway is modular [13]. Modules have even been found in physiology, specifically in spatial
correlations of brain activity [14, 15].
The modularity of a biological system can change over time. There are a number of
demonstrations of the evolution of modularity in biological systems. For example, the modularity of the protein-protein interaction network significantly increases when yeast is exposed to heat shock [16], and the modularity of the protein-protein networks in both yeast
and E. coli appears to have increased over evolutionary time [17]. Additionally, food webs
in low-energy, stressful environments are more modular than those in plentiful environments
[18], arid ecologies are more modular during droughts [19], and foraging of sea otters is
more modular when food is limiting [20]. Other complex dynamical systems exhibit timedependent modularity as well. The modularity of social networks changes over time: stock
brokers instant messaging networks are more modular under stressful market conditions [21],
and socio-economic community overlap decreases with increasing stress [22]. Modularity of
financial networks changes over time: the modularity of the world trade network has decreased over the last 40 years, leading to increased susceptibility to recessionary shocks [23],
and increased modularity has been suggested as a way to increase the robustness and adaptability of the banking system [24]. Much of the research on modularity has suggested that
gene duplication, horizontal gene transfer, and changes in the total number of connections
may all play a role in the evolution of modularity [25–27].
In an effort to proceed further with these observations, we here present a quasispecies
2

theory for the evolutionary dynamics of modularity. This analytical theory complements
numerical models that have investigated the dynamics of modularity [27–30]. We assume
that modularity can be quantified in the system under study. We further assume that
modularity is a good order parameter to describe the state of the system. That is, we
project the dynamics onto the slow mode of modularity, M. In section II we introduce
the quasispecies description for the dynamics of modularity. The details of the sequence
level evolutionary dynamics are what, when projected out, define the fitness function f (m)
introduced in this section. In section III we show how the steady-state fitness in a randomly
changing environment can be computed from the time-dependent average fitness starting
from random initial conditions. In section IV we derive a fluctuation dissipation theory
for the dynamics of modularity. In section V we derive a relationship between rate of
environmental change and rate of growth of modularity. In section VI we find the evolved,
steady-state value of modularity by a principle of least action. In section VII we compare
some of the predictions to simulations of protein evolution. We conclude in section VIII.

II.

THE QUASISPECIES THEORY FOR DYNAMICS OF MODULARITY

Quasispecies theory captures the basic aspects of mutation and evolutionary selection in
large, evolving populations [31, 32]. These models have been widely used in the physics
literature to describe evolutionary biology [33]. A series of papers showed how these models
could be solved in the steady-state limit, first by a mapping to an inhomogeneous Ising model
[34–38] and later by solution with functional integral techniques [39–41]. A Hamilton-Jacobi
approach has been used to derive dynamical predictions in these models [42]. Quasispecies
theory has been extended to larger alphabets [43] and to describe the effects of horizontal
gene transfer [44–46] and finite populations [47, 48].
We here develop quasispecies theory for the dynamics of modularity. We consider a
population of systems, where each system is characterized by a specific connection matrix,
from which the modularity can be calculated. Evolution occurs within each system by
mechanisms such as point mutation or horizontal gene transfer. Horizontal gene transfer is
not allowed between systems, because such events would violate the assumption that the
fitness of each system depends only on the modularity of that system. Competition occurs
both within and between systems. The evolutionary dynamics of this population of systems
3

is fully specified by the rate at which each system reproduces, f , termed “fitness,” and the
rate at which changes of modularity arise, µ. Since the state of each system is specified
by the slow modularity variable, M, the fitness is a function of the modularity, f = f (M).
The f (M) function is from a detailed calculation, numerical simulation, or experimental
observation of the competitive evolutionary dynamics within each system with a given value
of modularity. Thus, the rate at which a system with modularity M replicates, f (M), is an
input to the theory to be derived here. The present theory predicts how modularity in the
population of systems will evolve, given the replication rates and mutation rates.
The fitness function f (M) fundamentally characterizes an evolving network. With this
f (M), the dynamics of modularity can be calculated. For example, the f (M) could be
deduced for the evolution of the protein-protein interaction network in E. coli, showing the
evolutionary advantage of modularity for this system [17]. The f (M) is the driving force
for spontaneous emergence of modularity in a protein network [27]. The f (M) quantifies
the benefit of modularity to a system, and we will show that modularity evolves to a finite
modularity at steady state in a population of systems.
Modularity is defined on a network of nodes and edges. Thus, the fundamental object
describing each system is the connection matrix, with the ij element of the connection matrix
representing the value of edge ij. The connection matrix gives the links between the nodes
of the network. For example, in the protein-protein interaction network, the nodes are the
proteins and the links tell one whether protein i interacts with protein j. Modularity of each
system is calculated directly from the connection matrix of that system, and rearrangement
of the connections within this matrix changes the modularity of a given system.
The connection matrix, ∆ij , is a binary matrix that denotes whether nodes i and j
interact (∆ij = 1) or not (∆ij = 0). The detailed dynamics of the system may well have
non-trivial couplings between nodes [27], and the connection matrix is the projection of the
non-zero couplings. We allow each node to be connected to C other nodes on average. The
number of nodes is denoted by L. Rearrangement of the entries within this matrix changes
the modularity of the matrix. For simplicity, we assume that the modules which form are
of size l. There are two ways to view the fixed partitioning that we consider. First, this
partitioning results from modularity that is induced by horizontal gene transfer of segments
with fixed length l, as was previously shown [17, 27]. Second, biological modules are often of
roughly fixed size, so it is not too much of a simplification to say the module size is constant
4

for all modules. A fixed partitioning is a subset of all possibilities; in this work, we consider
only this fixed partitioning. Thus a modular system will have an excess of connections along
the l × l block diagonals of the connection matrix. In other words, the probability of a
connection is C0 /L outside the block diagonals when ⌊i/l⌋ =
6 ⌊j/l⌋ and C1 /L inside the
block diagonals when ⌊i/l⌋ = ⌊j/l⌋, with C = C0 + (C1 − C0 )l/L. Modularity is defined
by the excess of connections in the block diagonals, over that observed outside the block
diagonals: M = (C1 − C0 )l/(LC).
Modularity changes because the entries in the connection matrix change. There are
several possible models for how the connection matrix may reorganize. We here consider
the model in which connections may independently reorganize. This model is biologically
appropriate when connections between nodes are governed by independent pieces of structure
in each node. We are not specifically considering “hub” nodes that connect to a very large
number of other nodes. A model of this effect would be hierarchical. We are here considering
one level of this hierarchy in the present model. Thus, we here consider a simple model in
which each of these connections has a rate µ to rewire. That is, we define µ to be the rate at
which any given 1 in the ∆ matrix hops to another random location. In a typical biological
system there are a finite number of connections per site, even for a large matrix, and so
we consider the limit of C finite and L large, i.e. a dilute matrix of connections. Thus, the
entries in the connection matrix each have rate µ to independently move to a new position
in the connection matrix, and collisions between connections do not significantly affect the
dynamics in the dilute limit.
When the population of systems is large, the probability distribution to have a connection
matrix with modularity m obeys (see Appendix A)




1
dPm (t′ )
l
′
+
Pm−1/[(L−l)C] (t′ )
= L[f (m) − hf i]Pm (t ) + µCl (1 − m) 1 −
dt′
L
LC


1
l
Pm+1/[(L−l)C] (t′ )
+µC (L − l) m + (1 − m) +
L LC


l
−µC (L − l) m + 2(1 − m)
Pm (t′ )
(1)
L
where m takes values −l/(L − l), (−l + 1/C)/(L − l), (−l + 2/C)/(L − l), . . . , 1. The average
fitness is given by
hf (t)i =

X

f (m)Pm (t)

(2)

m

The average modularity as a function of time is given by M(t) =
5

P

m

mPm (t).

III.

THE STEADY-STATE FITNESS IN A RANDOMLY FLUCTUATING ENVI-

RONMENT

We here consider how to describe the effect of environmental change on the evolution of
modularity. We characterize the environmental changes by their magnitude and frequency.
We denote the magnitude of environmental change by p. If p = 0, the environment does
not change at all, and if p = 1, the environment is completely different before and after
the change. Although the environmental change is random, on average a fraction p of the
environment’s effect on the fitness of the system is modified by the change. This model is used
to describe evolution of influenza viruses, where p is defined as above [49, 50]. In application
to data on influenza vaccines, p is termed pepitope and serves as an accurate order parameter
to characterize how effective a vaccine against one strain will be in protecting against another
strain that is distance pepitope away [51–53]. Here we consider these environmental changes
to occur with a frequency, which we denote by 1/T . In particular, we consider that the
environmental changes occur every T timesteps. This characterization of environmental
change by magnitude and frequency, p and 1/T , has been used extensively in the past
[17, 18, 23, 27, 54].
A changing environment will put pressure on the system to have an efficient response
function. As the environment changes, the favorable niches for the system change, and the
system must adapt to the changing landscape. The more rapidly the environment changes or
the more dramatically the environment changes, the more pressure there is on the system to
be adaptable. As noted above, it has been widely observed that systems under pressure tend
to become more modular. The mean fitness of the systems a time T after an environmental
change will depend on the magnitude of the change, p, as well as the modularity. We
denote this value by fp,T (M). We can derive this function fp,T (M) for any p and T from
the average fitness as a function of time, starting from random initial conditions, which we
denote as hgi(t), with hgi(0) = 0. See Fig. 1 for a depiction of the hierarchy of evolutionary
timescales. The observable hgi(t), Fig. 1c, is an input to the theory presented here and
comes from a detailed calculation, numerical simulation, or experimental observation of the
competitive evolutionary dynamics. The change of environment decreases the fitness by 1−p
on average [54], and the time of evolution in each environment is T . These two conditions

6

T

0.8

t* - T

t*

0.8
0.75
0.7

0.4

<g>(t*)

0.6

Fitness

Fitness

Fitness

0.6

0.8

0.65

(1-p) <g>(t*)
0.4

0.6

0.2

0.2

0.55

0
0 T

1000

2000

3000

4000

5000

0.5

0

50

100

150

Time

200

250

300

0
0

Time

200

400

600

800

1000

Time

FIG. 1: a) Shown is the fitness of a single evolving system with a given modularity as a function
of time. Positive fitness means growth of the system. The environment is repeatedly changed each
T = 300 time steps. Shown in b) is the average of these responses during a time 0 to T after each
environmental change, averaged over many environmental changes. Shown in c) is the average
response function to p = 1 environmental changes, hgi(t). The response function in b) follows from
a master response function curve in c), being the t∗ −T to t∗ subset where hgi(t∗ −T ) = (1−p)hgi(t∗ ).
Here p = 0.3 and T = 300. The present theory applies once the curve in c) has been determined.

imply fp,T (M) = hgi(t∗) where t∗ is defined by
hgi(t∗ − T ) = (1 − p)hgi(t∗ )

(3)

The function fp,T (M) tells us the average, evolved fitness of the system at the end of each
environmental change. This function can be considered to be the fitness when the environmental change is integrated out. This fp,T (M) is the fitness function that goes into Eq.
(1).
Evolution of modularity depends on how the response function fp,T (M) of the system
varies with the parameters of environmental change, p and T . Since systems under stress
tend to become more modular, an interpretation is that the average fitness for a modular
system is greater than that for a non-modular system, at least for small T or large p where
stress is large. This behavior has been observed in a model of systems evolving in a changing
environment, when horizontal gene transfer is included [27]. We have recently proved this
canonical behavior for a Moran model of population evolution in a glassy, modular fitness
landscape [55]. Glassy evolutionary dynamics has been noted a number of times [56, 57].
Conversely, at long time, the less modular system should have a higher fitness, because
modularity is a constraint on the optima that can be achieved.
In Eq. (1), we here take this function f (m) as input. We assume only that the population
7

tc
tc

0.8
0.8

0.8

0.6

0.6

0.4

0.4

0.2

0.2

0.4

Modularity

Fitness

Fitness

0.6

0.2

0
0

200

tc

400

600

800

0
0

t (response time)

200

tc

400

600

800

0

T

FIG. 2: Shown is the fitness of an evolving system. a) The fitness of the non-modular (hg0 i, solid)
and block-diagonal (hg1 i, dashed) system are shown, starting from a random initial configuration.
These hg0 i and hg1 i are inputs to the theory. The modular system is taken to be more fit at short
time and less fit at long time. b) The evolved, steady-state fitness of a system predicted by the
theory in a changing environment (dot dashed), shown for varying T and p = 1. The fitness follows
the high-modularity curve at rapid environmental changes, small T , and the low-modularity curve
at slow environmental changes, large T . Since p = 1, the function fp=1,T (M ) = hg(M )i(t = T ). The
function hg(M )i is here taken for simplicity to be (1 − M )hg0 i(t) + M hg1 i(t). Note the modularity
tends to 1 and the fitness to hg1 i for rapid environmental change (small T ), and the modularity tends
to 0 and the fitness to hg0 i for slow environmental change (large T ). The modularity calculated
from theory, Eq. (13), is shown (dotted). Also shown is the theoretical result for small M , Eq.
(15), to first order in l/L (short dashed). In this example L = 120, l = 10, µ = 0.01, and C = 5.77.
For these particular hg0 i and hg1 i, the modularity emerges only for environmental changes that
occur on a timescale T < tc ≈ 285.

averages for large M and small M look like the dashed and solid curves in Fig. 2a. Putting
these points together, the quasispecies theory presented here quantitatively describes the
emergence of modularity at small p or large T , as shown in Figs. 3 and 2b.

8

IV.

A FLUCTUATION DISSIPATION THEOREM

There is a fluctuation dissipation relation for the rate of change of modularity. Multiplying
Eq. (1) by m and summing, we find that the rate of change of modularity satisfies
dM
= Lhmf (m)i − LMhf i − µM
dt

(4)

This equation is a type of continuous-time Price equation [58]. This equation implies a type
of useful fluctuation-dissipation theorem. Expanding f (m), we can alternatively write this
fluctuation dissipation relation describing the evolution of modularity as

dM
df 
hσ 2 i − µM
≈L
dt
dm M M

(5)

2
Here M = hmi is the average modularity of the system, and σM
= hm2 i − M 2 is the variance

of the modularity, where m is the modularity for any particular system in the population.

V.

ENVIRONMENTAL CHANGE SELECTS FOR MODULARITY

We now derive a relationship between the rate of growth of modularity and the environmental pressure. We investigate the dynamics for small modularity, and we consider a
Taylor series expansion of the fitness function: f (m) = f (0) + m∆f + o(m). The function
∆f is time independent, depending on p, T , and other parameters of the evolution within
each system that have been projected out. We investigate the growth of modularity from
an initially non-modular state. We consider how the response function depends on p. If
p = 0, the environment is not changing, t∗ → ∞ in the expression of Eq. (3), and the system
will stay in the M = 0 state. This implies ∆f = 0 when p = 0, as otherwise a non-zero
modularity would emerge, see Eq. (15) below. For small p, the environment is changing only
slightly, t∗ is large, and the system will evolve a small value of M. Expanding in a Taylor
series for small p and T ≪ t∗ , Eq. (3) becomes
hg ′ i(t∗ )
hg ′ i(t∗ )
hg ′ i(t∗ )
p
= m ∗m ≈ m m ≈ m m
T
hgm i(tm )
hgm i(∞)
hg0i(∞)

(6)

′
where the last two relationships arise because hgm
i(t∗m ) is small and because t∗m is large and

m is small. Thus, ∆f = limm→0 [f (m) − f (0)]/m = ∆f (p/T ). Expanding ∆f to first order
in p/T and taking m small, we find ∆f = αp/T . When m is small, equation (4) becomes
2
M ′ = LσM
∆f − µM

9

(7)

2
Using the result above for ∆f , we find M ′ ≈ αLσM
p/T , leaving out the small term propor-

tional to M in Eq. (7). We, thus, find
pE ≈

1 dM
R dt

(8)

2
2
where pE = p/T is the environmental pressure, and R = αLσM
. In this equation, R ∝ hσM
i,

which as experimentalists have anticipated is related to replicate variability in experiments
[59].
This Eq. (8) follows from the fluctuation dissipation relation in Eq. (4) and the response
function of the modular system being greater than that of the non-modular system at short
time. Equation (8) may be interpreted as a Taylor series expansion of dM/dt in allowed
combinations of p and 1/T . Alternatively, Eq. (8) may be interpreted as the linear response
of the modularity to the environmental pressure. The coefficient R is a measure of ruggedness of the evolutionary landscape within each system. This ruggedness slows down the
evolutionary dynamics, and the selection for an effective response function provided by a
changing environment implicitly selects for modularity when horizontal gene transfer is active [27]. Here, we are able to show that R is proportional to the variance of the modularity,
which is expected to be related to the ruggedness of the landscape. It is the ruggeddness of
the landscape that leads to non-trivial replicate variability.
For what forms of hgm i(t) will the ∆f (p/T ) function be analytic in p/T ? We first consider an exponential convergence of the fitness function: hgm i(t) = g(∞) − am exp(−βm t),
where we have left out the m depencence of g(∞) because we expect it to be higher
order than linear in m. Eq. (6) becomes pg(∞)/T = am βm exp(−βm t∗m ), and we find
fp,T (m) = hgm i(t∗m ) = g(∞)−g(∞)p/(T βm). We thus find m∆f = g(∞)(p/T )(1/β0 −1/βm ),
which is positive because we expect the modular system to converge faster, βm > β0 .
−1
Thus, we find Eq. (8), with α = −g(∞)dβm
/dm|m=0 . Conversely, for a power law de-

cay hgm i(t) = g(∞) − am t−β , we find the fitness to be non-linear in p/T : fp,T (m) =
β/(β+1)

g(∞) − am [(pg(∞)/(T amβ)]β/(β+1) . In this case, Eq. (8) is modified to be pE
left hand side, with α =

1/(β+1)
−[g(∞)/β]β/(β+1) dam
/dm|m=0 .

on the

Finally, for a logarithmic decay

[55] hgm i(t) = g(∞) − am ln−2/ν (t/t0m ), we find the fitness to be non-analytic in p/T , since
(p/T )t∗m g(∞) = (2/ν)am ln−2/ν−1 (t∗m /t0m ). This equation can be solved in terms of powers
of the product logarithm, or Lambert W0 function. Performing an asymptotic analysis for
small p/T , we find fp,T (m) ∼ g(∞) − am ln−2/ν (T /p). In this case, Eq. (8) is modified to be
10

1/(ln2 pE )1/ν on the left hand side, with α = −dam /dm|m=0 .
Equation (8) is a description of how the evolvability of the system depends on the environmental change. That is, dM/dt is a measure of the evolvability of the system, with
larger values indicating a greater rate of change of the measurable order parameter M. This
measure of evolvability is greater for greater environmental pressures, pE . The drive for
spontaneous emergence of modularity, large dM/dt, is also greater for landscapes that are
more rugged, i.e. larger R, which can be estimated from variability of replicate experiments.
Equation (8) says that an increase of environmental pressure should lead to the evolution
of systems with increased modularity. A study of 117 species of bacteria showed that the
modularity of the bacteria’s metabolic networks increased monotonically with variability of
the environment in which the bacteria lived [60]. Metabolic networks of pathogens alternating between hosts were found to be more modular than those of single-host pathogens
[61].

VI.
A.

STEADY-STATE VALUES OF MODULARITY IN ONE ENVIRONMENT
Field Theory for the Dynamics of Modularity

Here we rewrite the dynamical equations of quasispecies theory in the language of field
theory. We solve the field theory in the limit of large system sizes to determine the steadystate modularity that emerges at long time. The theory is distinct from traditional quasispecies theory because the replication rate depends on the modularity rather than the
Hamming distance from a wild-type strain. Nonetheless, we will show that the theory can
still be solved exactly in the limit of a large system size.
For large values of L, for which the changes in M are nearly continuous, we here determine
the average fitness implied by Eq. (1) at long time by techniques borrowed from quantum
field theory [39, 41]. We write the dynamical equations in Eq. (1) in terms of raising and
lowering operators. We then use coherent states to write this second quantization in terms
of a Bosonic field theory, with fields zij∗ (t), zij (t) representing density at ∆ij (t) at time t.

11

The action of this field theory is
Z tf X
X

∗
S[{z}, {z }] =
zij∗ (t)∂t zij (t)dt +
zij∗ (0)zij (0) − zij (tf ) + LC
0

ij

C1
L
Z
−L
−

−

µ
L2

ij

in
X

zij∗ (0) −

ij

tf

0

Z

1
f
LC
tf

0

"

XX
ij

C0
L

out
X

in
X
ij

zij∗ (0)

ij

out

X
1
z ∗ (t)zij (t)
zij∗ (t)zij (t) −
L/l − 1 ij ij

∗
[zmn
(t) − zij∗ (t)]zij (t)dt

!#

dt
(9)

mn

Note that the fitness depends on the modularity of the connection matrices of each state
at each point in time in Eq. (9), just as it did in Eq. (1). Also note that Eqs. (1) and
(9) are exact for arbitrary, non-linear fitness functions f (m). Here “in” means in the l × l
block diagonals and “out” means outside these block diagonals. The quadratic terms can
be integrated out (see Appendix B) [41], and we are left with an action expressed in terms
¯
of a modularity field, ξ, and its conjugate, ξ:
Z tf
¯
S = L
[C ξ(t)ξ(t)
− f (ξ(t))]dt − LC ln Q
(10)
0

where the determinant is Q = [lC1 (tf ) + (L − l)C0 (tf )]/(LC), where the vector C(t) =
(C1 (t), C0 (t)) satisfies
dC/dt = A(t)C(t)
where



A(t) = 

¯
−µ(L − l)/L + ξ(t)
µl/L

and C(0) = (C1 , C0 ).

B.


µ(L − l)/L

¯
−µl/L − ξ(t)l/(L − l)

(11)

(12)

The Steady-State, Average Value of Modularity

The average modularity follows a dynamical trajectory away from an initial state to a final
steady state value. For large L, this action becomes large, and a saddle point calculation can
be used (see Appendix C). The remarkable result from this derivation is that the modularity
which emerges at long time obeys a principle of least action:
o
n
p
2
fpop = max f (ξ) − µC[(L − l)l/L ][2 + (L/l − 2)ξ − 2 (1 − ξ)(1 + (L/l − 1)ξ)] (13)
ξ

12

The variance of the modularity is small, O(1/L), and the modularity is determined by the
solution of the implicit equation
f (M) = fpop

(14)

Here fpop is the mean population fitness, i.e. Eq. (2) with t → ∞. Thus, a principle of
least action gives the evolved modularity at steady state. Coexistence of populations with
different modularity, i.e. bimodality in the distribution of modularity, is possible if the f (m)
function is discontinuous [45].

C.

Phase Diagrams for The Emergence of Modularity

While Eq. (13) is a general result, we can proceed further in the limit that evolved
modularities are small. Expanding for small M, we find
2l [df /dM|M =0]
µC(L − l) − 2l [d2 f /dM 2 |M =0 ]
l [df /dM|M =0]2
fpop ∼
+ f (0)
µC(L − l) − 2l [d2 f /dM 2 |M =0 ]
l [df /dM|M =0 ]
M ∼
µC(L − l) − 2l [d2 f /dM 2 |M =0 ]

ξmax ∼

(15)

Thus, as long as a modular system has a higher fitness, df /dM > 0, modularity will spontaneously emerge, M > 0, for large enough system sizes, L. Note also when M is small, that
the steady state modularity calculated exactly from Eq. (13) is in agreement with the small
M result in Eq. (15), as shown in Fig. 2b. Note that for large L/l, Eq. (7) combined with
2
= l/[L(L − l)C].
Eq. (15) implies that at steady state σM
∞

For fitness functions for which df /dM|M =0 = 0, more analysis is required. For example, if
f (M) = kM 2 /2, there is a phase transition at µ∗ : For µ < µ∗ modularity emerges, whereas
for µ > µ∗ the population remains in the non-modular phase. This phase transition is
analogous to the error catastrophe found in traditional quasispecies theory. Phase diagrams
for a number of fitness functions are shown in Fig. 3.

13

2

k

1.5

Modular

1

Non-modular
0.5

0
0

0.5

1

1.5

µC

2

2.5

3

FIG. 3: The phase diagram for emergence of modularity. Below a critical mutation rate, modularity spontaneously emerges. Results are shown for f (M ) = kM 2 /2 (solid), f (M ) = kM 3 /2 (longdashed), f (M ) = kM 4 /2 (short-dashed), f (M ) = kM 10 /2 (dotted), and f (M ) = ekM − kM − 1
(dot-dashed). Results here are shown for l = 10, L = 120.
VII.

USING QUASISPECIES THEORY TO EXTRAPOLATE SIMULATION

DATA ON SPONTANEOUS EMERGENCE OF MODULARITY

We use Eq. (1) to analyze M(t) data on spontaneous emergence of modularity in a
simulation of an evolving protein network [27] to deduce df /dm and to derive f (M) by
integration. For this system, we know the mutation rate, as two of the connections change
per time step in the upper half of the connection matrix, and so we can use Eq. (1) at short
time to determine df /dm. Alternatively we can determine df /dm if we know the variance
of the modularity and M(t), c.f. Eq. (5). We assume f (M) is quadratic, and integrate
the df /dm to determine the f (M). There are ND = 346 total connections in the upper
half of the connection matrix and N0 = 22 connections in the upper half of the connection
matrix when M = 0 for the parameters of [27]. Thus, we take C = 346 × 2/L = 5.77 and
µ = 2/346. When M = 0, the population was prepared by four discrete time iterations of
the mutation step, from a single initial configuration [27]. We find f (M) ∼ 1.4M reproduces
the data at small M. For the initial condition of M = 0.38, the configurations were taken
from an ensemble [27], which we take to satisfy Eq. (1). We find f (M) = 1.4M − 1.31M 2
approximately reproduces the data, as shown in Fig. 4. Equation (13) predicts a steadystate value of M = 0.45, toward which the computationally costly simulations appear to be

14

0.5

Modularity

0.4
0.3
0.2
0.1
0
0

5

10

Time

FIG. 4: Shown is modularity versus time for a population that exhibits spontaneous emergence
of modularity. The curves are from theory, Eq. (1), and the data (circles) are from [27]. Two
different initial conditions are shown, M (0) = 0 and M (0) = 0.38. In this example the derived
underlying fitness function is f (M ) = 1.4M − 1.31M 2 , the mutation rate is µ = 2/346, and the
average number of connections is C = 346 × 2/L = 5.77.

heading.

VIII.

CONCLUSION

The examples of environmental stress leading to modularity, ranging from metabolic
networks of bacteria in different physical environment to simulations of emergence of protein
secondary structure, can be quantified by quasispecies theory. The approximate relation
RpE = dM/dt relates rate of growth of modularity to the ruggedness of the fitness landscape,
R, and environmental pressure, pE , for small values of modularity. The present theory should
allow the analysis of complex, evolving populations to go beyond a demonstration of the
existence of modularity to a quantitative analysis of the dynamics of modularity. That is,
the theory presented here should allow the determination of the f (M) function for these
evolving populations, by using the predictions to determine the f (M) that best matches
observation. Knowing the f (M) and µ that fundamentally characterize a population would
then allow for out-of-sample predictions of dynamical modularity.

15

Acknowledgments

This research was supported by US National Institutes of Health, 1 R01 GM 100468–
01. JMP was also supported by the Catholic University of Korea research fund 2014 and
by the National Research Foundation of Korea Grant (NRF-2011-013-C00029 and NRF2013R1A1A2006983).

IX.

APPENDIX A

We here derive Eq. (1). The rate to increase modularity for a matrix with modularity m
is rup = µnout (L/l)l2 /L2 . Recall we are in the dilute limit: C is finite, and L is large. Thus,
collisions between entries in the connection matrix can be ignored. The rate to decrease
modularity for a matrix with modularity m is rdown = µnin L(L − l)/L2 . Here the number of
connections inside the l × l blocks is given by nin and the number of connections outside the
l × l blocks is given by nout . We have the constraint nin + nout = CL. We also have by the
definition of modularity m = [nin /l − nout /(L − l)]l/(CL), which shows modularity changes
by discrete increments of ±1/[C(L − l)]. Thus, we find rup (m) = µCl(L − l)(1 − m)/L and
rdown (m) = µC(L − l)(Lm − lm + l)/L. For non-zero modularity, to avoid collisions in the
∆ matrix, we further require hnin i ≪ lL, i.e. C(l − lM + LM) ≪ lL. Alternatively, if this
constraint is not satisfied, we can view Eq. (1) as a generalization to the case of integer
occupation numbers of the ∆ matrix with certain biased hopping probabilities, rup (m) and
rdown (m), given above. The rate of change of Pm (t) due to replication is L[f (m) − hf i]Pm (t),
P
where the second term ensures conservation of probability, m Pm (t) = 1 ∀ t. This is the

first term on the right hand side in Eq. (1). The rate of increasing Pm (t) due to an increase
of modularity from m − 1/[C(L − l)] to m is rup [m − 1/(C(L − l))]Pm−1/[C(L−l)] (t), which

is the first µ-dependent term in Eq. (1). The rate of increasing Pm (t) due to a decrease of
modularity from m + 1/[C(L − l)] to m is rdown [m + 1/(C(L − l))]Pm+1/[C(L−l)] (t), which is
the second µ-dependent term in Eq. (1). The rate of decreasing Pm (t) due to modularity
changing from m to m ± 1/[C(L − l)] is [rup (m) + rdown (m)]Pm (t), which is the third µdependent term in Eq. (1). Thus, we have derived Eq. (1).

16

X.

APPENDIX B

We here calculate the determinant that comes from integrating out the zij∗ and zij fields
in Eq. (9). The probability of connections inside and outside the blocks have been taken
initially to be Poisson in Eq. (9), with average probability of a connection per site to be C1 /L
inside the blocks and C0 /L outside the blocks. The overall average number of connections
per row is C = C0 + (C1 − C0 )l/L. We here project the number of connections onto the
constraint that there are LC total connections. As in [41], this constraint is enforced with
a projection operator that leads to twisted boundary conditions. A modularity field ξ and
conjugate field ξ¯ are defined, with ξ(t) as the argument of the fitness function in Eq. (9).
We use a trotter factorization and define ǫ = tf /M and will take the limit M → ∞. We
define δ = 1 if ⌊i/l⌋ = ⌊j/l⌋ and zero otherwise. The partition function becomes
Z
PM
P
−ǫLC M
¯
k=1 f [ξ(k)]
k=1 ξ̄(k)ξ(k)+ǫL
Z =
[D ξDξ]e
Z 2π
PM P
P
dη −iη−LC
∗
×
e
[Dz ∗ Dz]e− k=0 ij zij (k)zij (k)+ ij zij (M )
2π
0
PM P
P
∗
2
∗
∗
∗
×e k=1 ij [zij (k)+(ǫµ/L ) mn (zmn (k)−zij (k))+ǫξ̄(k)(Lδ−l)/(L−l)zij (k)]zij (k−1)
×e(C1 (0)/L)e

iη/(LC)

Pin
ij

∗ (0)+(C (0)/L)eiη/(LC)
zij
0

Pout
ij

∗ (0)
zij

(16)

Integrating out zij∗ (0) and zij (0), the action remains the same except the start on sums over
k are incremented by one, and the terms C1 (0)z ∗ (0) and C0 (0)z ∗ (0) become C1 (1)z ∗ (1) and
C0 (1)z ∗ (1) with






l
l
¯
C1 (1) = C1 (0) 1 − ǫµ 1 −
+ ǫξ(1) + C0 (0)ǫµ 1 −
L
L


l
l
l
¯
+ C1 (0)ǫµ
C0 (1) = C0 (0) 1 − ǫµ − ǫξ(1)
L
L−l
L

(17)

Iterating the process of integrating out the z ∗ (k) and z(k), we find that the vector C(t) =
(C1 (t), C0 (t)) renormalizes according to Eq. (11). Finally, integrating out z ∗ (M) and z(M),
we find the final contribution to the partition function is
Z
PM
P
−ǫLC M
¯
k=1 ξ̄(k)ξ(k)+ǫL
k=1 f [ξ(k)]
Z =
[D ξDξ]e
Z 2π
dη −iη−LC [lC1 (M )+(L−l)C0 (M )]eiη/(LC)
e
e
×
2π
0

17

(18)

Performing the final integration over η, we find the final expression for the partition function
to be
Z =

Z

¯
[D ξDξ]e

−ǫLC

PM

k=1 ξ̄(k)ξ(k)+ǫL

PM

k=1 f [ξ(k)]



lC1 (M) + (L − l)C0 (M)
LC

LC

(19)

Thus, the action in Eq. (10) is derived.

XI.

APPENDIX C

Here we calculate the saddle-point solution to the action (10) at large time. For large L,
this saddle point solution is exact. For large tf , Eq. (10) becomes
¯ − f (ξ)] − LC ln Q
S = Ltf [C ξξ
where





Q = T r etf A 

C1 (0)/C
C0 (0)/C

The larger eigenvalue of A is given by
1
λ+ = −
2






(20)



l L−l 
,
L L

"
#1/2


2
L − 2l ¯
L − 2l ¯
1
4lξ¯2
µ−
µ−
ξ +
ξ +
L−l
2
L−l
L−l

(21)

(22)

Thus, the action tends to
¯ + f (ξ)] + LCtf λ+
− S ∼ Ltf [−C ξξ

(23)

¯ we find
Maximizing this over ξ,
− S/(Ltf ) ∼ f (ξ) − µC[(L − l)l/L2 ][2 + (L/l − 2)ξ − 2

p

(1 − ξ)(1 + (L/l − 1)ξ)] (24)

Maximizing over ξ gives Eq. (13). Using that the partition function Z grows at long time
as exp(Lfpop tf ) [41], we find Eq. (14).

[1] C. H. Waddington, Nature 150, 563 (1942).
[2] H. A. Simon, Proc. Amer. Phil. Soc. 106, 467 (1962).
[3] L. H. Hartwell, J. J. Hopfield, S. Leibler, and A. W. Murray, Nature 402, C47 (1999).

18

[4] E. Ravasz, A. L. Somera, D. A. Mongru, Z. N. Oltvai, and A.-L. Barabási, Science 297, 1551
(2002), URL http://www.sciencemag.org/cgi/content/abstract/297/5586/1551.
[5] B. Callahan, M. Thattai, and B. I. Shraiman, Proc. Natl. Acad. Sci. USA 106, 19410 (2009),
URL http://www.pnas.org/cgi/content/abstract/106/46/19410.
[6] M. R. da Silva, H. Ma, and A.-P. Zeng, Pr. Inst. Electr. Elect. 96, 1411 (2008), URL
http://ieeexplore.ieee.org/xpl/freeabs_all.jsp?arnumber=4567408.
[7] V. Spirin and L. A. Mirny, Proc. Natl. Acad. Sci. USA 100, 12123 (2003), URL
http://www.pnas.org/cgi/content/abstract/100/21/12123.
[8] A.-C. Gavin, P. Aloy, P. Grandi, R. Krause, M. Boesche, M. Marzioch, C. Rau,
L. J. Jensen, S. Bastuck, B. Dümpelfeld, et al., Nature 440, 631 (2006), URL
http://www.ncbi.nlm.nih.gov/pubmed/16429126.
[9] C. von Mering, E. M. Zdobnov, S. Tsoka, F. D. Ciccarelli, J. B. Pereira-Leal,
C. A. Ouzounis, and P. Bork, Proc. Natl. Acad. Sci. USA 100, 15428 (2003), URL
http://www.pnas.org/cgi/content/abstract/100/26/15428.
[10] A. E. Krause, K. A. Frank, D. M. Mason, R. E. Ulanowicz, and W. W. Taylor, Nature 426,
282 (2003), URL http://www.ncbi.nlm.nih.gov/pubmed/14628050.
[11] E.

C.

Raff

and

R.

A.

Raff,

Evol.

Dev.

235

2,

(2000),

URL

http://www3.interscience.wiley.com/journal/119052048/abstract.
[12] G.

P.

Wagner,

Integr.

Comp.

Biol.

36

36,

(1996),

URL

http://icb.oxfordjournals.org/cgi/content/abstract/36/1/36.
[13] C.

P.

Klingenberg,

Annu.

Rev.

Ecol.

Evol.

S.

39,

115

(2008),

URL

http://search.ebscohost.com/login.aspx?direct=true&db=a9h&AN=35967311.
[14] D. Meunier, S. Achard, A. Morcom, and E. Bullmore, NeuroImage 44, 715 (2009), URL
http://www.ncbi.nlm.nih.gov/pubmed/19027073.
[15] M. Chavez, M. Valencia, V. Navarro, V. Latora, and J. Martinerie, Phys. Rev. Lett. 104,
118701 (2010), URL http://prl.aps.org/abstract/PRL/v104/i11/e118701.
[16] A. Mihalik and P. Csermely, PLoS Comput. Biol. 7, e1002187 (2011).
[17] J. He, J. Sun, and M. W. Deem, Phys. Rev. E 79, 031907 (2009).
[18] D. M. Lorenz, A. Jeng, and M. W. Deem, Phys. Life Rev. 8, 129 (2011).
[19] M. Rietkerk, S. C. Dekker, P. C. de Ruiter, and J. van de Koppel, Science 305, 1926 (2004).
[20] M. T. Tinker, G. Bentall, and J. A. Estes, Proc. Natl. Acad. Sci. USA 105, 560 (2008).

19

[21] S. Saavedra, K. Hagerty, and B. Uzzi, Proc. Natl. Acad. Sci. USA 108, 5296 (2011).
[22] E. Estrada and N. Hatano, in Econophysics approaches to large-scale business data and financial crisis, edited by M. Takayasu, T. Watanabe, and H. Takayasu (Springer, 2010), pp.
271–288.
[23] J.

He

and

M.

W.

Deem,

Phys.

Rev.

Lett.

105,

198701

(2010),

URL

http://prl.aps.org/abstract/PRL/v105/i19/e198701.
[24] A. G. Haldane and R. M. May, Nature 469, 351 (2011).
[25] J. S. Hallinan, Biosystems 74, 51 (2004), URL http://dx.doi.org/10.1016/j.biosystems.2004.02.004.
[26] P.

B.

Rainey

and

T.

F.

Cooper,

Res.

Microbiol

155,

370

(2004),

URL

http://dx.doi.org/10.1016/j.resmic.2004.01.011.
[27] J. Sun and M. W. Deem, Phys. Rev. Lett. 99, 228107 (2007).
[28] H. Lipson, J. B. Pollack, and N. P. Suh, Evolution 56, 1549 (2002).
[29] N. Kashtan and U. Alon, Proc. Natl. Acad. Sci. USA 102, 13773 (2005).
[30] N. Kashtan, E. Noor, and U. Alon, Proc. Natl. Acad. Sci. USA 104, 13711 (2007).
[31] M. Eigen, Naturwissenschaften 58, 465 (1971).
[32] J. F. Crow and M. Kimura, An Introduction to Population Genetics Theory (Harper and Row,
New York, 1970).
[33] K. Jain and J. Krug, in Structural approaches to sequence evolution: Molecules, networks and
populations, edited by H. R. U. Bastolla, M. Porto and M. Vendruscolo (Springer Verlag,
Berlin, 2005), pp. 299–339, q-bio.PE/0508008.
[34] I. Leuthäusser, J. Chem. Phys 84, 1884 (1986).
[35] P. Tarazona, Phys. Rev. A 45, 6038 (1992).
[36] E. Baake, M. Baake, and H. Wagner, Phys. Rev. Lett. 78, 559 (1997), 79, 1782.
[37] E. Baake, M. Baake, and H. Wagner, Phys. Rev. E 57, 1191 (1998).
[38] D. B. Saakian and C.-K. Hu, Phys. Rev. E 69, 021913 (2004).
[39] L. Peliti, Europhys. Lett. 57, 745 (2002).
[40] D. B. Saakian, E. Munoz, C.-K. Hu, and M. W. Deem, Phys. Rev. E 73, 041913 (2006).
[41] J.-M. Park and M. W. Deem, J. Stat. Phys. 125, 975 (2006).
[42] D. B. Saakian, O. Rozanova, and A. Akmetzhanov, Phys. Rev. E 78, 041908 (2008).
[43] E. T. Munoz, J.-M. Park, and M. W. Deem, J. Stat. Phys. 135, 429 (2009).
[44] E. Cohen, D. A. Kessler, and H. Levine, Phys. Rev. Lett. 94, 098102 (2005).

20

[45] J.-M. Park and M. W. Deem, Phys. Rev. Lett. 98, 058101 (2007).
[46] E. T. Munoz, J.-M. Park, and M. W. Deem, Phys. Rev. E 78, 061921 (2008).
[47] J.-M. Park, E. Muñoz, and M. W. Deem, Phys. Rev. E 81, 011902 (2010).
[48] D. M. Lorenz, J.-M. Park, and M. W. Deem, Phys. Rev. E 87, 022704 (2013).
[49] M. W. Deem and H.-Y. Lee, Phys. Rev. Lett. 91, 068101 (2003).
[50] J. Sun, D. J. Earl, and M. W. Deem, Phys. Rev. Lett. 95, 148104 (2005).
[51] E. T. Munoz and M. W. Deem, Vaccine 23, 1142 (2004).
[52] V. Gupta,

D.

J. Earl,

and M. W.

Deem,

Vaccine

24,

3881

(2006),

URL

http://dx.doi.org/10.1016/j.vaccine.2006.01.010.
[53] H. Zhou and M. W. Deem, Vaccine 24, 2451 (2006).
[54] D. J. Earl and M. W. Deem, Proc. Natl. Acad. Sci. USA 101, 11531 (2004).
[55] J. Park, M. Chen, D. Wang, and M. W. Deem (2014), submitted.
[56] B. S. Khatri, T. C. McLeish, and R. P. Sear, Proc. Natl. Acad. Sci. USA 1006, 9564 (2009).
[57] K. Vetsigian, C. Woese, and N. Goldenfeld, Proc. Natl. Acad. Sci. USA 103, 10696 (2006).
[58] G. R. Price, Nature 227, 520 (1970).
[59] T. F. Cooper and R. E. Lenski, BMC Evol. Biol. 10, 1e11 (2010).
[60] M. Parter, N. Kashtan, and U. Alon, BMC Evol. Biol. 7, 169 (2007).
[61] A. Kreimer, E. Borenstein, U. Gophna, and E. Ruppin, Proc. Natl. Acad. Sci. USA 105, 6976
(2008).

21

0.05

tc

0.44
0.8
0.04

Modularity
Fitness

0.42
0.4
0.6
0.03
0.4
0.4
0.02
0.39
0.38
0.2
0.01
0.36
0.38
0
0

2005 tc

40010
5

Time
T

600 15

