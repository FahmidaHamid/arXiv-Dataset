Reconstructing subclonal composition and evolution from whole
genome sequencing of tumors
Amit G. Deshwar1 , Shankar Vembu2 , Christina K. Yung3 , Gun Ho Jang3 , Lincoln Stein3,4 ,
and Quaid Morris1,2,4,5,6

arXiv:1406.7250v3 [q-bio.PE] 6 Jan 2015

1

Edward S. Rogers Sr. Department of Electrical and Computer Engineering, University of
Toronto
2
Donnelly Center for Cellular and Biomolecular Research, University of Toronto
3
Ontario Institute for Cancer Research
4
Department of Molecular Genetics, University of Toronto
5
Banting and Best Department of Medical Research, University of Toronto
6
Department of Computer Science, University of Toronto

Abstract
Tumors often contain multiple subpopulations of cancerous cells defined by distinct somatic
mutations. We describe a new method, PhyloWGS, that can be applied to WGS data from
one or more tumor samples to reconstruct complete genotypes of these subpopulations based
on variant allele frequencies (VAFs) of point mutations and population frequencies of structural
variations. We introduce a principled phylogenic correction for VAFs in loci affected by copy
number alterations and we show that this correction greatly improves subclonal reconstruction
compared to existing methods.

1

Introduction

Tumors contain multiple, genetically diverse subclonal populations of cells that have evolved from
a single progenitor population through successive waves of expansion and selection [1–3]. Reconstructing their evolutionary histories can help identify characteristic driver mutations associated
with cancer development and progression [4, 5]; and can provide insight into how tumors might
respond to treatment [6, 7]. In some cases, it is possible to genotype the subpopulations present in
a tumor, while reconstructing its history, using the population frequencies of mutations that distinguish these subclonal populations [2, 8–21]. Increasingly, tumors are being characterized using
whole genome sequencing (WGS) of bulk tumor samples [22] and few automated methods exist to
reliably perform this reconstruction on the basis of these data.
Subclonal reconstruction algorithms attempt to infer the population structure of heterogeneous
tumors based on the measured variant allelic frequency (VAF) of their somatic mutations. Some
methods perform this reconstruction based solely on single nucleotide variants or small indels
(collectively known as simple somatic mutations or SSMs) [16–19, 21, 23]. Others use changes in
read coverage to identify genomic regions with an average ploidy that differs from normal which
they explain using inferred copy number variations (CNVs) affecting some of the cells in the sample
[15, 20, 24, 25].

1

The low read depth of current WGS complicates subclonal reconstruction. Until recently, subclonal populations (i.e., subpopulations) were defined based on accurate estimates of the proportion
of cells with each mutation (i.e., their population frequency) which, for individual SSMs, are only
available through targeted resequencing where the read depths are orders of magnitude higher
than typical WGS depths [17, 18, 23]. However, preliminary evidence suggests that the much larger
number of mutations detected by WGS can compensate for their decreased read depth [26]. In
contrast, CNVs affect large, multi-kilobase or megabase-sized regions of the genome allowing the
average copy number of these regions to be accurately estimated with WGS. Unfortunately, CNVbased subclonal reconstruction is more difficult than SSM-based reconstruction because of the
need to simultaneously estimate population frequency and new copy number for each CNV. Most
CNV-based methods only attempting to infer the copy number status of the clonal cancerous population [24,25] that contains the mutations shared by all of the cancerous cells. The few CNV-based
methods [15, 20] that attempt to resolve more than one cancerous subpopulation are practically
limited to a small number (often two) of subpopulations. In contrast, SSM-based methods applied
to targeted resequencing data can reliably resolve many more cancerous subpopulations [16–18,23].
However, it remains unclear what the limits of WGS-based automated subclonal reconstruction
are.
Another open question is how to combine CNVs and SSMs when doing reconstruction. CNVs
overlapping SSMs can interfere with SSM-based reconstruction because they complicate the relationship between VAF and population frequency. Although some methods attempt to model the
impact of CNVs on the allele frequency of overlapping SSMs [17–19,27], these methods have significant restrictions. For example, several of these methods [17, 18] make the unrealistic assumption
that every cell either contains the structural variation and the mutation or neither. Also, no method
places structural variations in a phylogenetic tree, which is important for studying the evolution of
cancerous genomes.
We describe PhyloWGS, the first method designed for complete subclonal phylogenic reconstruction of both CNVs and SSMs from whole genome sequencing of bulk tumor samples. Unlike
all previous methods, PhyloWGS appropriately corrects SSM population frequencies in regions
overlapping CNVs and is fast enough to perform reconstruction of at least five cancerous subpopulations based on thousands of mutations. We present results on subclonal reconstruction problems
that cannot be correctly reconstructed using previous methods. We also probe the relationship
between WGS read depth and the number of subpopulations that PhyloWGS can recover. Finally,
we demonstrate that even in the absence of reliable CNV estimates, it is still feasible to perform
automated subclonal composition reconstruction based on SSM frequency data at typical WGS
read depths (30-50x), even for highly rearranged genomes where less than 2% of the SSMs lie in
regions of normal copy number.

2

Previous work

Figure 1 provides an overview of an evolving tumor, measuring of VAFs, and the resulting subclonal
reconstruction process. Panel (i) of this figure shows a visualization of the evolution of a tumor over
time as noncancerous cells (subpopulation A, shown in grey) are replaced by, at first, one clonal
cancerous population (subpopulation B, shown in green) which then further develops into multiple
cancerous subpopulations (C and D, shown in blue and yellow, respectively). Tumor cells define
new subpopulations by acquiring new oncogenic mutations that allow their descendants to expand
relative to the other tumor subpopulations. Each circle in Panel (i) refers to a subpopulation. We
associate subpopulations with the set of shared somatic mutations that distinguish it from its parent

2

600

a

b

c

a

B
a

400

C

Sequencing

b

# of SSMs

A

D
a

200

b
d

0

Time
Tumor sample taken
d

c

b

a

Clonal
Frequency

600

a

# of SSMs

400

b

0.1

i ii
iii iiii
a

100

20

c

200

0

0.1

0.2

0.3

0.4

Variant Allele Frequency

0.5

b

B

50
30

C

a
c

b

a

b
d

0.3

D

0.4

Variant Allele Frequency

A

0

B

50

C

30

D

A

a

Population
Frequency

A

80
a

d

0.2

a

OR

a

b

b

c

a

b

c

d

B

C

0.5

0.6

Population
Frequency

20

A

30

B

20

C

30

D

D

0.6

Figure 1: The development of intratumor heterogeneity and subclonal reconstruction.
Tumor composition over time (i), the resulting distribution of variant allele frequencies (ii), the
result of successful inference of the VAF clusters (iii), and the desired output of subclonal inference
(iiii)
subpopulation (or, in the case of A, from the germline (or reference) genome); this mutation set is
indicated by the corresponding lower case letter (e.g. mutation set b first appears in subpopulation
B ). However, each subpopulation also inherits all of its parent’s mutations; the subclonal lineage
of a mutation is the set of all subpopulations that contain it (e.g., the subclonal lineage of a is A,
B, C, and D).
In general, the subpopulation-defining mutation sets include more than one mutation. Cancerous cells often have increased mutation rates, and even noncancerous cells accumulate somatic
mutations at a rate of 1.1 per cell division [28]. As such, subpopulations are defined not only by the
small number of oncogenic ‘driver’ mutations that support rapid expansion but also a larger number
of ‘passenger’ mutations acquired before the driver mutation(s). The selective sweeps that cause
subpopulation expansion increase the population frequency of both driver and passenger SSMs,
driving them to having indistinguishable population frequencies [29, 30]. However, sampling and
technical noise in sequencing means that the observed VAFs are distributed around the true value
for a subpopulation. Panel (ii) shows an example histogram of measured VAFs for SSMs found in
a heterogeneous tumor sample.
Subclonal reconstruction algorithms define mutation sets, and their associated subpopulations,
by analyzing the population frequencies of somatic mutations detected in a tumor sample. In
Figure 1, all mutations are SSMs, and all SSMs occur on one copy in diploid regions of the genome.
In this case, the estimated population frequency of an SSM is simply twice its VAF. Figure 2,
discussed in the next section, shows how CNVs overlapping SSM loci change this relationship.
Note that although each VAF cluster corresponds to a subclonal lineage, and a subpopulation that
was present at some point during the tumor’s evolution, this subpopulation need not be present
when the tumor was sampled. In Figure 1, subpopulation B is no longer present in the tumor,
3

although its two descendant subpopulations are. These vestigial VAF clusters, if they exist, always
correspond to subpopulations at branchpoints in the phylogeny, however, not every branchpoint
generates a vestigial cluster.

2.1

SSM-based approaches

SSM-based subclonal reconstruction algorithms attempt to reconstruct the subpopulation genotypes based on VAF clusters (and their associated mutation sets) identified by fitting statistical
mixture models to the VAF data either without phylogenic reconstruction [18, 19, 21, 31], before
phylogenic reconstruction [32] or concurrently with it [16,17]. Often, as in Figure 1, the clusters are
overlapping which introduces uncertainty in the exact number of mutation sets represented in the
tumor (as well as in the assignment of SSMs to clusters). Adding more clusters to the model always
provides better data fit, so to prevent overfitting, the cluster number is selected by balancing data
fit versus a complexity penalty (e.g. the Bayesian Information Criteria) or by Bayesian inference
in a non-parametric model [17, 18, 31].
In panel (iii) in Figure 1 the correct number of clusters have been recovered along with appropriate central VAFs.
Assuming that the correct VAF clusters can be recovered, the subclonal lineages corresponding
to each mutation set must still be defined. Defining the subclonal lineages is equivalent to defining
the tumor phylogeny; and often multiple phylogenies are consistent with the recovered VAF clusters
(e.g. panel (iiii) in Figure 1). Complete and correct reconstruction of subpopulation genotypes
requires resolving this ambiguity. To do so, reconstruction methods make one of a handful of
assumptions about the process of tumor evolution.
A common, and powerful, assumption is the infinite sites assumption (ISA) [17, 33, 34] which
posits that each SSM only occurs once in the evolutionary history of the tumor. The ISA implies
that the tumor evolution is consistent with a ‘perfect and persistent phylogeny’ [18]: each subpopulation has all of the SSMs that its ancestors had; each SSM appears in only one subclonal lineage;
and each subclonal lineage corresponds to a subtree in the phylogeny of tumor subpopulations.
Because SSMs are relatively rare (compared to the genome size), the ISA is nearly always valid for
all SSMs. So there is little danger of incorrect reconstructions due to violations of the ISA. In many
cases, the ISA alone permits the recovery of multiple, complete subpopulation genotypes from a
single or small number of tumor samples using either the sum rule [17] (also called the pigeonhole
principle [26]) or the crossing rule [17], respectively. Methods that do not use the ISA require, in the
case of no measurement noise, at least as many tumor samples as there are subpopulations [16, 35];
in actual application when there is noise, even more samples are required.
Unfortunately, the ISA alone is often unable to fully resolve reconstruction ambiguity. As such,
some methods [16, 32] also make a sparsity assumption to select among ISA-respecting phylogenies
consistent with the VAF frequency data. This assumption, which we call strong parsimony, posits
that due to expansion dynamics, there are a small number of subpopulations still present in the
tumor [16,32], and that many of the VAF clusters are vestigial. These methods therefore select the
phylogeny (or phylogenies) that maximize the number of vestigial VAF clusters [16], or equivalently,
the number of branchpoints where the parental subpopulation has a zero frequency in the current
tumor [16, 32]. The strong parsimony assumption does resolve some ambiguity, and leads to the
correct reconstruction in Figure 1, but it is risky as its empirical validity is not yet established.
For example, under some conditions, a linear (i.e. non-branching) phylogeny can be mistaken for a
branching one; the risk of this occurring increases as the VAF measurement noise or the number of
subpopulations in the tumor increases. This background distribution of false positive vestigiality
is not yet considered by either of the methods that assume strong parsimony.
4

Table 1: Table of subclonal reconstruction methods, their properties and assumptions
XXX

XXX Method
XXX
XX

Property

SSM
CNV
Weak parsimony
Strong parsimony
Infinite sites
Phylogenetic inference
Parametric
Multiple samples
Genotype uncertainty

PhyloWGS
PhyloSubTHetA PyCloneTrAp
[17]
[15]
[18]
[16]
Y
Y
N
Y
Y
Y
N
Y
N
N
Y
Y
N/A Y
Y
N
N
N/A N
Y
Y
Y
N/A Y
Y
Y
Y
N
N
Y
N
N
Y
N
N
Y
Y
N
Y
N
Y
Y
N
N/A N

ClomialRecBTP
[35]
[32]
Y
Y
N
N
Y
Y
N
Y
N
Y
N
Y
Y
N
Y
N
N
N

By assigning all SSMs within a VAF cluster to the same mutation set; reconstruction methods
make another implicit assumption which we call weak parsimony. This assumption does not hold
if two mutation sets have the same population frequency. Note that if the ISA is valid, by the
pigeonhole principle, weak parsimony is guaranteed to be valid whenever the population frequency
of the mutation set is > 50%.
Table 1 classifies reconstruction methods based on these assumptions, whether they recover
complete subpopulation genotypes (or simply identify subclonal lineages), and whether they can
handle single tumor samples, multiple tumor samples, or both.
PhyloWGS, like its predecessor PhyloSub [17], does not make the strong parsimony assumption
nor does it only report a single tree. Instead it reports samples from the posterior distribution
over phylogenies. Because the clustering of the VAF frequencies is performed concurrently with
phylogenic reconstruction, PhyloWGS is able to perform accurate reconstruction even when the
weak parsimony assumption is violated in a strict subset of the samples available. For example,
if the VAF clusters overlap in one sample but not another. Our Markov Chain Monte Carlo
(MCMC) procedure samples phylogenies from the model posterior that are consistent with the
mutation frequencies and does not rule out phylogenies that are equally consistent with the data.
From this collection of samples, areas of certainty and uncertainty in the reconstruction can be
determined.

2.2

CNV-based approaches

There are three major differences between CNV-based reconstruction and SSM-based reconstruction. First, because large regions of the genome are affected by CNVs and reads mapping across the
regions can be used to estimate average ploidy, accurate quantification of changes in average copy
number can be achieved with much smaller read depths (as low as 5-7x) [15,36]. However, the other
two differences make CNV-based subclonal reconstruction more difficult and less generally applicable compared with SSM-based methods. One difference is that the ISA is often invalid because
CNVs affect large regions of the genome. As such, it is more common to see overlapping mutations
occurring in independent cells; these make the reconstruction problem more challenging. Even in
the circumstance that only one CNV affects a given region, inferring its population frequency is still
challenging because at least two values, population frequency φ ∈ (0, 1) and non-negative integer
5

Figure 2: Example of CNVs affecting the distribution of VAFs.
copy number C, have to be simultaneously inferred from a single observed, non-normal average
copy number x 6= 2. In particular, this equation,
x = φC + (1 − φ)2,
always has at least two different solutions for x > 1.
In absence of other information, like B-allele frequencies [26], parsimony assumptions are relied upon to resolve reconstruction ambiguities. One strategy only attempts to reconstruct the
cancerous, subclonal lineage [24, 25] with the highest population frequency (also known as the
‘clonal population’). From this reconstruction, the proportion of cells in the tumor sample that
are cancerous (i.e. the cellularity), as well as detecting CNVs that are shared by all cancerous
cells in the tumor can be derived. However, this approach can fail when there are multiple subclonal populations, especially if they share few CNVs [15, 20]. Methods that attempt to detect
> 1 cancerous subpopulation do so by balancing data fit with a complexity term that penalizes
additional subpopulations [15, 20]. So far, these methods seem to be practically limited to a small
number of cancerous subpopulations (i.e., 2); and cannot be applied to tumors with substantial
rearrangements.

2.3

Combining SSMs and CNVs

In loci affected by CNVs, computing the population frequency of an SSM from its VAF requires
knowing whether the SSM occurred before, after or independently of the CNV. If the SSM occurred
before the CNV, and CNV affects the copy number of the SSM, then computing its VAF also requires
knowing the new number of maternal and paternal copies of the locus. Figure 2 illustrates a
situation where incorporating CNV information is critical for subclonal reconstruction. Without
CNV information, the two VAF peaks would be interpreted as two separate subclonal lineages.
With CNVs, it becomes clear that the second peak is caused by the amplification of part of the
genome that increases the VAF of all SSMs found in the region.
Some subclonal reconstruction methods simply ignore the impact that CNVs have on the relationship between SSM population and allele frequency [16, 21]. Other methods that do account for
the effect of copy number changes on SSM frequencies [17–19] by integrating over all the possible
relationships between allele frequency and population frequency without making use of the fact
that the infinite sites assumption, which was necessary to uniquely associate SSMs to subclonal
lineages in the first place, also constrains this relationship [26].
6

For the first time, we describe an automated method, PhyloWGS, that performs subclonal
reconstruction using both CNVs and SSMs. By combining information from both CNVs and
SSMs, and properly accounting for their interaction, we provide a more comprehensive and accurate
description of subclonal genotype.

3

Results

In the following, we first provide a brief explanation of how PhyloWGS incorporates both SSMs
and CNVs in phylogenic reconstruction by converting CNVs into pseudo-SSMs and performing
subclonal reconstruction on the SSMs and pseudo-SSMs; full details are provided in the Methods
section. Then, we show an illustrative example where accounting for the effect of CNVs on SSMs
permits the correct subclonal reconstruction of a tumor population whereas using either CNV
or SSM data in isolation does not. Then, we describe our efforts to quantify the relationship
between read depth and the number of subpopulations that can be accurately recovered by applying
PhyloWGS to simulated WGS data of different read depths, number of subpopulations, and SSMs.
Next, we describe the application of PhyloWGS to three TCGA benchmark datasets. Finally, we
describe the application of PhyloWGS to two real datasets: a multiple-sample WGS data from a
patient with chronic lymphocytic leukemia and a single sample from a breast tumor.

3.1

Incorporating CNVs with SSMs in phylogenic reconstruction

We assume that a CNV algorithm has already been applied to the sequencing data and that this
algorithm provides estimates of copy number C and population frequency φi for each CNV i. We
use these estimates in two ways: first, for each CNV, we create an equivalent pseudo-SSM with
population frequency φi by adding an SSM to the dataset with total reads di and variant reads
di ∗ φi /2 rounded to the nearest whole number (i.e., the expected number of variant reads of a
heterozygous mutation with population frequency φi ) where di is set to a user-defined multiple of
the average WGS read-depth. If a confidence interval for φi is available, we can set di to have the
same confidence interval. Note, we allow multiple CNVs to affect the same locus; each of these
CNVs is assigned its own pseudo-SSM.
Second, we associate all SSMs within the region affected by the CNV to this pseudo-SSM. Our
model (described in the Methods section) uses this association to compute the transformation from
the inferred population frequency of an SSM to its expected VAF.
Here, we briefly describe how this transformation when there is only one CNV affecting the SSM
locus; the Methods section describes the general version of the transformation, used by PhyloWGS,
that allows multiple CNVs to affect the locus.
Given the population frequency of the CNV, φc , the copy number of the CNV C broken down
into maternal and paternal components C = C p + C m , and the population frequency of the SSM,
φs , the equations below compute the expected allele frequency of the SSM xssm . Here we are using
the terms ‘maternal’ and ‘paternal’ simply to distinguish the two copies and not to suggest that we
have actually assigned each chromosome to each parent. Furthermore, the description here assumes
that the SSM is on the maternal copy, if it is on the paternal copy, replace C m with C p below.
If a SSM lies in a region affected by a CNV, there are three possibilities for their phylogenic
relationship:
1) SSM precedes the CNV event, i.e., the CNV occurred in a cell already containing the SSM
2) SSM occurs after the CNV event, i.e., the SSM occurred in a cell already containing the CNV
7

3) SSM and CNV occurred in separate branches of phylogeny, i.e., the mutations occur in separate
cells and no cell contains both the SSM and the CNV.
Case 1 (SSM → CNV)
Because of the infinite sites assumptions, this phylogenic relationship requires φs ≥ φc > 0. In this
case, cells with the CNV contain C m copies of the SSM and cells with the SSM but not the CNV
only have one mutated copy. As such, the expected allele frequency can be written as:
xssm =

C m φc + (φs − φc )
2(1 − φc ) + Cφc

The numerator corresponds to the average number of copies per cell of the SSM-mutated locus in
the population and the denominator is the average number of copies per cell of the locus (mutated
or not) in the population. We note that if there is no copy number change in C m then the numerator
is simply φs ; and if C m = 0 then the numerator is φs − φc .
Case 2 (CNV → SSM)
This case is only possible if the maternal locus still exists after the CNV (i.e. C M ≥ 1), and
furthermore that φc ≥ φs > 0. By the infinite sites assumption, only one copy of the locus is
affected, so the numerator is simply φs and we do not need to know the breakdown of C into C m
and C p . As such:
xssm =
Case 3 ( %
&

SSM
CN V

φs
2(1 − φc ) + Cφc

)

In this case, the SSM and CNVs lie on different branches of the phylogeny and no cell in the
population contains both mutations, so the only constraints on φs and φc are that φs + φc ≤ 1. As
per Case 2, the average number of loci affected by the SSM is φs . So the expected allele frequency
is identical to case 2.
xssm =

φs
2(1 − φc ) + Cφc

We illustrate some of the ways how the relationship between a CNV and an affected SSM in
the phylogenetic tree affects the observed VAF of that SSM in Figure 3.
We note that the breakdown of C into C m and C p and phasing the SSM only affects the expected
variant allele frequency in Case 1. This is because it is the only case where a CNV event can affect
a mutated locus. Although PhyloWGS requires the breakdown of C into C m and C p under these
conditions, we do not require the SSM to be phased, as many cannot be [26], and instead consider
both possibilities when computing the likelihood. Some subclonal copy number callers decompose
C into C m and C p [37]; if the caller does not provide this decomposition, then PhyloWGS should
be run on loci where C ∈ {0, 1, 2}.
An important consequence of these rules is that under some conditions, it is possible to unambiguously identify a branching phylogeny using single-sample data. If an SSM can be phased to an
amplified locus there are situations where given particular values of xssm , φc , C p and C m one can
distinguish between Case 1 and Case 3. For example, given xssm = 0.1, φc = 0.4, C m = 10, C p = 1,
for Case 3 the inferred φs is 0.56. However, if Case 1 were true the resulting inferred φs would be
8

Figure 3: Changes to VAF caused by CNVs with different phylogenetic relationships.
negative and so Case 1 is not possible. This condition holds whenever xssm ∗ (2(1 − φc ) + Cφc ) <
(C m − 1)φc . We were unable to find any other circumstances in which single sample VAFs were
more consistent with a branching phylogeny than a chain phylogeny.

3.2

The combination of CNVs with SSMs is required for accurate subclonal
reconstruction

Consider a tumor where 25% of the cells are normal (no SSMs and diploid, population A), 25% come
from a subpopulation with only SSMs (SSM1-4, population B) and 50% belong to a descendant
subpopulation of B containing all the SSMs from B and adding new simple somatic variants (SSM59

A

B

C

A

B

C

1

0.75

0.5

1

0.723

0.496

A: –
B: SSM1; SSM2; SSM3; SSM4
C: SSM5; SSM6; SSM7; SSM8; CNV1

A: –
B: SSM1; SSM2; SSM3; SSM4
C: SSM5; SSM6; SSM7; SSM8; CNV1

(A)

(B)

A

B

C

A

C

1

0.739

0.492

1

0.5

A: –
B: SSM1; SSM2; SSM3
C: SSM4; SSM5; SSM6; SSM7; SSM8

A: –
C: CNV1

(C)

(D)

Figure 4: Example subclonal structure and inferred phylogenies using different methods. A: Example of tumor subclonal structure. B: Tumor phylogeny recovered by PhyloWGS. C:
Tumor phylogeny recovered by PhyloSub. D: Subclonal structure implied by only CNVs.
8) and a homozygous deletion (CNV1) in the region containing SSM4, labelled population C. The
evolutionary tree of this population is shown in Figure 4A. In reads sampled from this population,
the expected variant allele frequencies for SSM1-3 are 37.5% (i.e. half of their population frequency)
and for SSM5-8 they are 25%; however based on the rules described in the Methods section, the
expected variant allele frequency of SSM4 is 25%. This is because all the copies of the genome at
that position come from population A or B. Population A and B are present in equal proportions
and only one copy in population B contains variant reads, so 25% of the genomes contain the
variant allele. As such, methods that do not incorporate the CNV change at the SSM4 locus will
incorrectly assign SSM4 to population C. Also, methods that incorporate only CNV information
cannot detect the subpopulation B which is defined by SSM alone.
We generated simulated variant and reference allele counts for this example at a simulated readdepth of 60. A table containing the reference and total read counts for each SSM can be found as
Table 2. PhyloWGS was able to correctly reconstruct the evolutionary history and subpopulation
structure (Figure 4B). However, a version of PhyloSub which ignored CNVs incorrectly assigned
SSM4 to population C (Figure 4C). Furthermore, by construction, there is no way to recover
population B based only on CNV data, so a perfect CNV-based algorithm would infer the subclonal
structure in Figure 4D.
We also ran PyClone [18] on this dataset. PyClone cannot take as input the fact that a locus
has been homozygously deleted, so we ran PyClone either by telling it there were no CNV changes
or that there was a deletion of one copy. Without any input CNV alterations, PyClone produced a
clustering identical to PhyloSub, while in the single copy deletion state, PyClone placed SSM4 in
an additional cluster with no other mutations. As this simple example illustrates, integrating data
from both SSMs and CNVs is required for full, and accurate, subclonal reconstruction.

10

Table 2: Table showing reference and total read counts for example tumor sequencing data
mutation id
s0
s1
s2
s3
s4
s5
s6
s7
s8
s9
s10
s11

reference counts
23
35
26
29
30
42
27
36
59
57
51
37

total counts
47
69
51
56
40
70
41
56
75
76
68
51

Table 3: Table of subclonal lineage proportions used
Number of populations
3
4
5
6

3.3

φ values used (linear)
0.44, 0.11
0.56, 0.25, 0.06
0.64, 0.36, 0.16, 0.04
0.71, 0.44, 0.25, 0.11, 0.03

Applying PhyloWGS to simulated data

An important question in subclonal analysis of tumor samples is estimating how deep sequencing
must be in order to recover the subclonal structure. To answer this question we applied PhyloWGS
to simulated read counts with known subclonal structure. Our simulations looked at a range of
total population counts (3, 4, 5, 6), read depths (20, 30, 50, 70, 100, 200, 300) and number of
SSMs per population (5, 10, 25, 50, 100, 200, 500, 1000). For each combination of population
count, read depth and SSMs per population we generated simulated tumor data for which the
subclonal population frequencies were consistent with both branching and linear phylogenies. For
each simulated SSM k in subpopulation u, reference allele reads (ak ) were drawn as:
ak ∼ Binomial(dk , 1 − φu + 0.5φu ) ;

dk ∼ Poisson(r) ,

where φu is the clonal frequency of population u and r is the simulated read depth. A table of the
φ values used for the simulations can be found as Table 3. First, we examined the time needed to
complete sampling as a function of the number of SSMs (shown in Figure 5). In less than three
hours on a single core of an Intel i7-4770K, on average, inference could be completed with up to
1000 SSMs (all timing data shown uses the simulated dataset with 5 subpopulations).
To determine the number of subpopulations our algorithm found, we analyzed the sampled tree
with the highest complete data likelihood and removed any subpopulations with zero assigned SSMs.
11

●
●
●

10000
●

●
●
●

●
●
●
●

one hour

Runtime (s)

●

●
●
●
●

●
●

●
●
●
●
●
●

●

1000

●
●
●
●
●
●
●
●
●
●
●
●

10

100

1000

Number of SSMs
Figure 5: PhyloWGS Runtime. The relationship between the number of SSMs in the simulated
dataset with 5 subpopulations and the runtime on a log10-log10 plot. Runtime is computed using
a single core of an Intel i7-4770K with 2500 MCMC iterations and 5000 inner Metropolis-Hastings
iterations. Runtime can be greatly decreased by parallelizing the sampling or by taking less samples;
however, the implications of these options have not been explored.
We then compared the difference between the number of subpopulations used to generate the data
and the number of subpopulations identified by our algorithm. The results of this comparison for
ambiguous phylogeny simulations are shown in Figure 6. Several relationships between simulation
parameters and the output of our model can be observed. First, unsurprisingly, increasing the
read depth and decreasing the number of subpopulations resulted in increased accuracy in the
estimated number of subpopulations. Second, for the ambiguous phylogeny simulations, there is a
U-shaped relationship between accuracy and the number of SSMs characterizing each population,
12

3 Populations
300

Read Depth

200
100

Error
−1

70

0

50
30
20
5

10

25

50

100

200

500

1000

4 Populations
300
Error

Read Depth

200

<=−2

100

−1
70

0

50

1
>=2

30
20
5

10

25

50

100

200

500

1000

5 Populations
300
Error

Read Depth

200

<=−2

100

−1
70

0

50

1
>=2

30
20
5

10

25

50

100

200

500

1000

6 Populations
300

Read Depth

200

Error

100

<=−2
−1

70

0

50

1

30
20
5

10

25

50

100

200

500

1000

Number of SSMs per cluster

Figure 6: Recovering true number of clusters. Each figure shows the relationship between
the number of SSMs per cluster, the read depth and the ability of PhyloWGS to recover the true
number of populations for 3 (A), 4(B), 5(C) and 6(C) population simulations. Error is calculated
by subtracting the true number of subclonal lineages from the number found.

13

where accuracy first increases and then decreases as the number of SSMs increases. This decrease
in accuracy with high numbers of SSMs is non-intuitive, as more SSMs provide more information
with which to perform inference. However, the Dirichlet process prior sometimes overestimates
the number of source components [38]. While this overestimation has not been demonstrated for
the tree-structured stick-breaking process used by PhyloWGS, the similarity between the processes
makes it likely that this is the case. While some of these errors can be eliminated by ad-hoc
removal of clusters with a small number of SSMs, there is not yet a consistent approach to do this,
so we leave the results untouched. These results suggest that for three or four subpopulations, a
read depth consistent with typical WGS experiments (20x–30x) is sufficient to identify the correct
number of subpopulations, while experiments with 200x-300x are needed to resolve tumors with up
to six subpopulations.
Another important measure of the performance of our algorithm is how accurately the mapping
from population to SSM is. To evaluate this accuracy in a systematic way that accounts for
class-imbalance, varying number of SSMs and differing number of clusters we examine the Area
Under the Precision-Recall Curve (AUPRC) between the known true co-clustering matrix and the
average co-clustering matrix from our samples. A co-clustering matrix M is a binary matrix where
Mij = 1 if SSM i and SSM j are in the same cluster.
The average co-clustering matrix is
constructed by taking the average of the co-clustering matrices of each sample in the Markov chain
after burn-in and is an estimate of the posterior mean co-clustering matrix of our model. The
average co-clustering matrix better predicts the true co-clustering matrix than the co-clustering
matrix computed from the maximum data likelihood tree. AUPRC was chosen over Area Under
the Receiver-Operator Curve (AUROC) as it is known to be more informative in the presence of
class-imbalance [39] which changes as the number of populations increase.
In Figure 7 we plot the resulting AUPRC for our simulation experiments. As with inferring
the number of populations, our method does better as the read depth increases and the number of
populations decreases. Unlike the last result, there is no clear relationship between the number of
SSMs and the resulting AUPRC. To provide qualitative guidance to users of the meaning of various
AUPRC cutoffs, we show several examples of inferred co-clustering matrices with AUPRCs of 0.65,
0.8, 0.9 and 0.98 in Figure 8.

3.4

Simulations with CNV changes

Next, we generated simulated data from a more complex genetic environment. In these cases we
simulated data from a tumor with 20% normal tissue, a 40% CNV-free subpopulation with 500
mutations and a descendent subpopulation with another 200 mutations but a substantial CNV
affecting 50% of the genome, either an amplification or a deletion. We simulated data with read
depth 20, 30, 50, 70, 100, 200 and 300 10 times for each read depth / alteration pair. We then applied
PhyloWGS and computed the AUPRC scores. To demonstrate the importance of incorporating
CNVs in phylogenetic reconstruction we compared the scores from PhyloWGS with those from
PyClone [18]. Performance for both methods can be seen in Figure 9. Using PhyloWGS results
in superior clustering when compared to PyClone for both subclonal amplifications and deletions,
with the exception of amplifications with low read-depths, where the performance distributions
closely overlap.

3.5

TCGA Benchmark

Next, we apply PhyloWGS to the TCGA variant-calling benchmark 4 dataset [40]. The samples we
examined consist of a normal population, a cancerous cell-line population HCC 1143 and a spiked-

14

Area under the precision−recall curve
Area under the precision−recall curve
Area under the precision−recall curve
Area under the precision−recall curve

3 Populations
1.0
●
●
●
●
●
●

0.9

●
●
●
●
●
●

●
●
●

●
●

●

●

5

●

10

●

25

●

50

●

100

●

200

●

●

500

●

●

1000

●

●

2000

●

●
●
●
●
●
●
●
●

●
●
●

0.8

#SSMs

●

0.7
0

100

200

300

4 Populations
1.0

●

0.9

●

●

0.8

●
●
●
●
●
●

●
●
●
●

●

●

5

●

10

●

●

25

●

50

●

100

●

200

●

500

●

1000

●

2000

●
●
●

●
●
●

0.7

●
●
●
●
●

0.6

●
●
●
●
●
●

0

100

200

300

5 Populations
1.0

●
●
●
●

0.8
●
●
●

0.6
●
●
●
●
●
●

0.4

●

●
●
●
●

●
●
●
●
●
●
●
●

●
●

●

5

●

10

●
●

●

25

●

50

●

100

●

200

●

500

●

1000

●

2000

●
●

●
●
●
●

100

200

300

6 Populations
1.0

●
●
●

0.8
●
●
●

●
●

0.4

●
●
●
●

0

●
●
●
●
●

●

●

5

●

10

●

●

25

●
●
●
●

●

50

●

100

●

200

●

500

●

1000

●

2000

●

●
●
●
●
●
●
●
●

#SSMs
●

●
●
●
●
●
●

0.6

#SSMs

●
●
●
●

●
●
●
●

0

●

#SSMs

●
●
●
●
●
●

●
●
●
●

●

100

200

300

Read depth

Figure 7: Reconstruction accuracy Each figure shows the relationship between the read depth
and the accuracy of the resulting clustering, measured as Area Under the Precision-Recall Curve
(AUPR). Plots for 3 (A), 4(B), 5(C) and 6(D) populations are shown with each line representing a
different number of SSMs per cancerous population.

15

Example Co−clustering (AUPR=0.98)

Example Co−clustering (AUPR=0.90)

value
1.00

SSM ID

SSM ID

value
1.00
0.75
0.50

0.75
0.50

0.25

0.25

0.00

0.00

SSM ID

SSM ID

Example Co−clustering (AUPR=0.80)

Example Co−clustering (AUPR=0.65)

value
1.00

SSM ID

SSM ID

value
1.00
0.75
0.50

0.75
0.50

0.25

0.25

0.00

0.00

SSM ID

SSM ID

Figure 8: Co-clustering examples Each figure shows mean co-clustering matrixes for simulations
with 4 populations (3 cancerous), where the AUPR is 0.98 (A), 0.90 (B), 0.80 (C) and 0.65 (D).
Rows and columns correspond to individual SSMs. For visibility, the matrix has been randomly
subsampled to 150 SSMs from the 600 SSMs used in the simulation. Pixel color indicates coclustering probability.
in subclonal descendant of the cancerous population in various proportions with 30x coverage.
Starting with the publicly available BAM files we identified locations of possible structural variation
using BIC-seq [36] with default parameters, except for the bandwidth parameter, which was set to
1000. We changed the bandwidth parameter because we found the default value of 100 resulted
in overly noisy segmentations and highly variable normalized read counts. To identify SSMs and
the number of variant and reference reads for each SSM, we reverted the BAM files into unaligned
reads using Picard 1.90 [41]. Reads for each sample were then realigned using BWA 0.6.2 [42]
and collapsed using Picard. Aligned reads of a cancerous sample and its matched normal were
analyzed by two somatic calling tools: MuTect 1.1.4 [43] and Strelka 1.0.7 [44]. A set of high
confidence mutations were extracted by taking an intersection of the calls made by MuTect and
Strelka. Previous verification on other tumor/normal pairs showed that this approach achieved
> 90% precision (data not shown). We first ran THetA [15] using the output of BIC-seq with the
16

1.0
●

●

●

●

●

●
●

●

0.9

●

●
●

AUPR

●

●
●

Algorithm
● PhyloWGS
● PyClone

●

AUPR

●
●

0.9

●

0.8

●

●

●

0.8

Algorithm
● PhyloWGS
● PyClone

●

●

0.7

●

●
●

●

●

0.6
0

100

200

300

0

Read Depth

100

200

300

Read Depth

Figure 9: Reconstruction accuracy Each figure shows the relationship between the read depth
and the accuracy of the resulting clustering, measured as Area Under the Precision-Recall Curve
(AUPR) for PhyloWGS and PyClone. Plots are shown for subclonal additions (A) and deletions
(B)
aim of using THetA’s output to provide us with the CNV information that PhyloWGS requires
(see Methods section). However, despite the fact that the subclonal population varied from 40%
to 10%, THetA returned nearly identical composition inferences for all the samples (see Figure
10). Because of this, we decided that we could not rely on THetA’s copy number calls, we instead
simply removed all SSMs in a location where BIC-seq identified possible structural variation. This
eliminated most of the SSMs identified, leaving only 62 SSMs from the original 4,344. Despite this
small number of SSMs our algorithm was still able to identify the correct number of populations
and captured the changing composition of the samples. Also, the inferred SSM content of each
cluster was identical in the three separate runs.

3.6

Chronic Lymphocytic Leukemia

Next, we applied PhyloWGS to a data from patient CLL077 extracted from Supplementary Table
7 from a paper describing a Chronic Lymphocytic Leukemia (CLL) dataset [11]. For this patient,
five tumor samples were collected over the course of treatment. We note that our method does
not assume or use any temporal relationships in multiple sample data and could equally be applied
to multiple samples collected simultaneously. We have previously reported experiments using the
targeted resequencing data with average read depth of 100,000x at 17 identified SSMs [17], we
now instead use the data from WGS for that same set of mutations, with average read depth of
40x. By examining the number of reference and variant alleles it was clear that the mutation in
gene SAMHD1 was at a location that was homozygous in the cancerous subpopulation it was part
of. This is because the proportion of variant reads was far above 50% (the expected variant allele
proportion for a heterozygous SSM present in every cell of the sample). We simulated the data
that a CNA algorithm would find by assuming that the copy number at that location was one in
a CNA-defined subpopulation and that the proportion of cells in that population was the same
as implied by halving the proportion of variant alleles. After running PhyloWGS on this data,
we compare the maximum data likelihood tree with the expert-generated tree found using a semimanual method and targeted resequencing data in Figure 11. The two trees are nearly identical
17

Known

100

PhyloWGS

THetA

Percent

75

Subpopulation
Normal
Subpopulation 1 (parent)
Subpopulation 1 (subclone)

50

25

0

S1

S2

S3

S1

S2

S3

S1

S2

S3

Sample

Figure 10: True and inferred composition of TCGA benchmark samples. The figure shows
the true (left), inferred by PhyloSub (center) and inferred by THetA (right) composition of three
TCGA benchmark samples. Each bar represents a single sample.
with the exception of assigning a single SSM to a child of the subpopulation where it is found in
the expert tree.

3.7

Breast Tumor

We analyzed data from WGS at 288x coverage from tumor PD4120a, first reported in [26] and
re-analyzed in [15]. We confined our analysis to SSMs in genomic regions where THetA and the
original analysis agreed on the copy number status of the genome (chr 3,4q,5,10,13,16q,17,19 and
20). These regions contains a total of 26,029 SSMs, of which 4,739 were in regions affected by
clonal copy number changes and 2,171 were in regions affected by subclonal copy number changes.
We then ran PhyloWGS, PyClone and SciClone on SSMs in regions of normal copy number and
on SSMs in both altered and normal copy number. PyClone uses a non-phylogenic correction for
copy number alterations and SciClone performs no correction. Based on the semi-manual clustering
from [26], we identified those mutations assigned to clusters D,C and B with high probability to use
as our gold standard for clustering. We then compared AUPR for all three algorithms on the two
datasets (see Figure 12). All three algorithms have very similar performance when only looking at
SSMs in normal regions (Fig. 12 left panel). PhyloWGS continues to have very high performance
when SSMs in regions of copy number alterations are included, while both PyClone and SciClone
have much worse performance than PhyloWGS (Fig. 12 right panel).

18

A

B

1
1
1
1
1

0.92
0.97
1
0.96
0.62

0.72
0.79
0.80
0.65
0.23

0.33
0.52
0.50
0.39
0.10

0.65
0.61
0.72
0.60
0.18

0.31
0.24
0.41
0.31
0.07

C

D

c

d

E
< 0.01
0.03
0.04
0.14
0.31

a

b

1
1
1
1
1

0.88
0.91
0.96
0.92
0.70

e
< 0.01
0.02
0.02
0.20
0.39

a: –
b: BCL2L13; NAMPTL; GPR158;
SAMHD1
c: DAZAP1; EXOC6B; GHDC;
OCA2; PLA2G16; SLC12A1
d: LRRC16A
e: KLHDC2; COL24A1; NOD1;
HMCN1; MAP2K1

A: –
B: BCL2L13; NAMPTL; GPR158;
SAMHD1; SLC12A1
C: DAZAP1; EXOC6B; GHDC;
OCA2; PLA2G16
D: LRRC16A
E: KLHDC2; COL24A1; NOD1;
HMCN1; MAP2K1

Figure 11: Expert-generated and inferred phylogenies from CLL patient CLL077. Left:
The expert-generated phylogeny based on targeted deep sequencing data. Right: The phylogeny
inferred by PhyloWGS on allele frequencies of the same SSMs found using WGS. The subclonal
lineage population frequencies for the five samples and the SSM assignments of lineages are also
shown in the figure.

4

Discussion

Our work makes two important contributions to the burgeoning field of subclonal reconstruction.
First, we provide the first automated method that integrates SSM and CNV data in the reconstruction of tumor phylogenies. This is an important innovation, previous methods either ignore
the impact that CNVs have on SSM allele frequencies [16, 21], or assume that the CNVs affect
all (and only) the cells that contain the SSM [17–19]. These assumptions can lead to incorrect
inferences about the population frequency of SSMs because how a CNV affects the allele frequency
of an SSM depends on its phylogenic relationship with the SSM. Many of the insights about how
to integrate SSM and CNV data appear in [26]; our work here extends and formalizes these seminal observations while also providing an automated method for phylogenic reconstruction. A
further advantage of combining SSMs and CNVs in the phylogenic reconstruction is that CNVs
overlapping the SSM locus can provide further constraints on the tree-structure than are provided
by SSM frequency alone, and we described one case where it is possible to unambiguously infer
branching when an amplification of a SSM-containing locus does not lead to a large increase in the
SSM allele frequency. Second, we show that given typical WGS read depths, SSM-based methods
are able to accurately reconstruct tumor phylogenies and detect and assign SSMs for at least six
subpopulations. Previously it wasn’t clear to what extent this reconstruction is possible; and no
automated reconstructions with more than two cancerous subpopulations based on WGS data had
been described. Furthermore, we demonstrate the importance of phylogenetic correction of VAFs
19

Normal CN SSMs

All SSMs

Area under the precision−recall curve

1.00

0.75

Algorithm
PhyloWGS
PyClone
SciClone

0.50

0.25

0.00

Figure 12: Subclonal reconstruction algorithms applied to breast tumor PD4120 Left:
Area Under the Precision Recall curve (AUPR) for PhyloWGS, PyClone and SciClone when looking
at SSMs in areas of normal copy number. Right: AUPR for PhyloWGS, PyClone and SciClone
when looking at SSMs in altered and normal copy number.
of SSMs that occur in loci affected by copy number changes when performing subclonal reconstruction. Specifically, we presented results on a breast cancer benchmkar where methods that do not use
PhyloWGS’s phylogenic correction perform much worse at recovering subpopulations. Finally, we
report examples of accurate subclonal reconstruction for cancer populations with highly reordered
20

chromosomes solely on the basis of SSM frequencies in the regions of normal copy number. On
these same data, a state-of-the-art CNV-based method failed to perform the reconstruction.
The current version of PhyloWGS relies on preprocessing the sequencing data with a CNV-based
method for subclonal reconstruction. This is because it assumes that initial population frequency
φi and copy number data Ci are already available for the CNVs; furthermore, for amplifications,
Ci > 2, it requires Ci to be separated into the relative number of each of the two copies, i.e.,
{Cim , Cip }. It does not, however, require the SSMs to be phased; in other words, it does not need
to know whether the SSMs occurred on the maternal or paternal copy of the chromosome. New
CNV-based methods provide {Cim , Cip } [37]; our work anticipates further developments in subclonal
CNV callers. If used with a method that cannot decompose copy number changes into changes
in the maternal and paternal loci, PhyloWGS can be restricted to regions of copy number loss
(i.e. Ci < 2), where there is only one possible breakdown. Note that this decomposition is only
necessary when an SSM precedes a CNV on the same branch of a phylogeny.
We also note that PhyloWGS does not require the CNV-based preprocessing to be able to
detect all of the subclonal populations, and we have shown that PhyloWGS can detect additional
populations either defined completely by SSMs or that were not detected by CNV-based methods.
This is particularly important because recent CNV-based methods are limited to a maximum of
two cancerous populations and those that can detect > 1 cancerous subpopulation do so by relying
on a strong parsimony assumption. If invalid, this assumption can lead to large errors in subclonal
reconstruction because it selects branching phylogenies over chain phylogenies that are equally
well-supported by the data.
Indeed our results suggest an alternative strategy for combining SSMs and CNVs in subclonal
reconstruction. Regions unaffected by CNVs can be relatively easily detected using methods such
as BIC-seq [36]. Even in highly rearranged cancer genomes, there are often non-negligible regions
of normal copy number and we have shown that we can achieve reasonably accurate subclonal
reconstructions using the limited number of SSMs in regions of normal copy number in the TCGA
benchmark.
In the final stages of preparing this manuscript, a new method, cloneHD [27] was published.
Like PhyloWGS, this method combines both SSMs and CNVs in subclonal reconstruction and does
so using WGS data from single and multiple samples. However, unlike PhyloWGS, cloneHD does
not explicitly perform phylogenic reconstruction, so it is unable to fully account for the phylogenic
relationship among SSMs and CNVs when analyzing SSM allele frequency. As such, it is not clear
to us that it can correctly solve the subclonal reconstruction problem posed in Figure 1. The
cloneHD manuscript also does not extend the limits of WGS-based subclonal reconstruction as
none of the examples reconstruct more than two cancerous subpopulations from a single sample.
Finally, cloneHD appears to rely on the strong parsimony assumption in order to assess subclonal
genotypes, and only reports a single reconstruction, obscuring the uncertainty involved. However,
cloneHD does appear to be an interesting and powerful method and we hope that future work can
compare the merits and drawbacks of these alternate approaches to subclonal reconstruction.

5

Conclusions

We have presented a new method, PhyloWGS, that reconstructs tumor phylogenies and characterizes the subclonal populations present in a tumor sample using both SSMs and CNVs. Our method
takes as input measures of allelic frequency of SSMs, as well as estimates of population frequencies and copy number for each CNV. PhyloWGS groups the SSMs and CNVs into subpopulations,
and estimates the population frequencies and the phylogenic relationship of these subpopulations.

21

PhyloWGS is based on a generative probabilistic model of allele frequencies that incorporates a
nonparametric Bayesian prior over trees. The output of PhyloWGS consists of samples from this
distribution generated through Markov Chain Monte Carlo and we report the tree that maximizes
the likelihood of the data found during the sampling run, if a single point estimate is required.
However, unlike our previous PhyloSub method [17], PhyloWGS includes CNVs in its subclonal
reconstruction and, in doing so, can correctly account for the effect of CNVs on the VAF of overlapping SSMs. PhyloWGS also runs more than 50 times faster than PhyloSub, making it feasible
to apply it to the thousands of SSMs that are found through WGS.
We have applied PhyloWGS to real and simulated data from WGS of tumor samples to demonstrate that subclonal populations can be reliably reconstructed based solely on SSMs from medium
depth sequencing (30x-50x). We have also used PhyloWGS to correctly solve a simulated subclonal
reconstruction problem that neither an SSM-based nor CNV-based method can solve alone; and
to reconstruct the phylogeny and subclonal composition of a highly rearranged sample for which a
CNV-based method fails. We also demonstrate that when applied to WGS of time-series samples
from a chronic lymphocytic leukemia patient, PhyloWGS recovers the same tumor phylogeny previously reconstructed by applying PhyloSub and a semi-manual method to data from deep targeted
resequencing. Finally, we demonstrate state-of-the-art performance in subclonal reconstruction on
a breast tumor sample, highlighting the advantages of performoing phylogenetic CNV correction.
Our work thus greatly expands the range of tumor samples for which subclonal reconstruction is
possible, enabling widespread use of automated subclonal reconstruction for medium-depth WGS
sequencing experiments.

6
6.1

Methods
PhyloSub model

Our probabilistic model for read count data is based on PhyloSub [17]. For each SSM that is
detected by high-throughput sequencing methods, cells containing the SSM are referred to as the
variant population and those without the variant as the reference population. Let ai and bi denote
the number of reads matching the reference allele A and the variant allele B respectively at position
i, and let di = ai +bi . Let µri denote the probability of sampling a reference allele from the reference
population. This value depends on the error rate of the sequencer. Let µvi denote the probability of
sampling a reference allele from the variant population which is set to 0.5 if there are no CNVs – in
other words, the SSM is assumed to only affect one of the two chromosomal locations. Let φ̃i denote
the fraction of cells from the variant population, i.e., the SSM population frequency at position i,
and 1 − φ̃i denote the fraction of cells from the reference population at position i. Let DP(α, H)
denote the Dirichlet process (DP) prior with base distribution H and concentration parameter α.
Samples from the DP are used to generate the SSM population frequencies {φ̃i }. The observation
model for allelic counts has the following generative process:
G ∼ DP(α, H) ;

φ̃i ∼ G ;

ai | di , φ̃i , µri , µvi ∼ Binomial(di , (1 − φ̃i )µri + φ̃i µvi ) .

(1)

The posterior distribution of φ̃i is p(φ̃i | ai , di , µri , µvi ) ∝ p(ai | di , φ̃i , µri , µvi )p(φ̃i ).
The Dirichlet process prior DP(α, H) in the observation model of allelic counts (1) is useful to
infer groups of mutations that occur at the same SSM population frequency [12, 18]. Furthermore,
being a nonparametric prior, it allows us to avoid the problem of selecting the number of groups of
mutations a priori. However, it cannot be used to model the clonal evolutionary structure which
takes the form of a rooted tree. In order to model this, we use the tree-structured stick-breaking
22

process prior [45] denoted by TSSB(α, γ, H). The parameters α and γ influence the height and
width of the tree respectively and are similar to the concentration parameter in the Dirichlet process
N
prior. Let {φk }K
k=1 denote the set of unique frequencies in the set {φ̃i }i=1 , where K is the number
of subclones or nodes in the tree. In other words, multiple elements in the set {φ̃i }N
i=1 will take
K
on the same value from the set {φk }k=1 of unique frequencies. The prior/base distribution H of
the SSM populationP
frequencies is the uniform distribution Uniform(0, 1) for the root node and
Uniform(0, φpar(v) − w∈S(v) φw ) for any other node v in the tree, where par(v) denotes the parent
node of v and S(v) is the set of siblings of v. This ensures that the clonal evolutionary constraints
(discussed below) are satisfied when adding a new node in the tree. Given this model and a set
of N observations {(ai , di , µri , µvi )}N
i=1 , the tree structure and the SSM population frequencies {φ̃i }
are inferred using Markov Chain Monte Carlo (MCMC) sampling (see PhyloSub [17] for further
details).
Given the current state of the tree structure, we sample SSM population frequencies in such a
way that the SSM population frequency φv of every non-leaf node v in the tree is greater than or
equal to the sum of the SSM population frequencies of its children. To enforce
P this constraint, we
introduce a set of auxiliary variables {ηv }, one for each node, that satisfy v ηv = 1, and rewrite
the observation model for allelic counts (1) explicitly in terms of these variables resulting in the
following posterior distribution:
p(η̃i | ai , di , µri , µvi ) ∝ p(ai | di , Gi = g, η˜i , µri , µvi )p(η̃i ) ,

(2)

where we have used {η̃i } to denote the auxiliary variables for each SSM. The prior/base distribution
of the auxiliary variables is defined such that it is 1 for the root node and Uniform(0, ηpar(v) )
for any other node v in the tree. When a new node w is added to the
P tree, we sample ηw ∼
Uniform(0, ηpar(w) ) and update ηpar(w) ← ηpar(w) − ηw . This ensures that v ηv = 1. This change is
crucial as it allows us to design a Markov chain that converges to the stationary distribution
of {ηv }.
P
The SSM
population
frequency
for
any
node
v
can
then
be
computed
via
φ
=
η
+
v
v
w∈D(v) ηw =
P
ηv + w∈C(v) φw , where D(v) and C(v) are the sets of all descendants and children of node v
respectively. This construction ensures that the SSM population frequencies of mutations appearing
at the parent node is greater than or equal to the sum of the frequencies of all its children. We use
the Metropolis-Hastings algorithm [46] to sample from the posterior distribution of the auxiliary
variables {η˜i } (2) and derive the SSM population frequencies from these samples by selecting the
sampled set of population frequencies with the highest likelihood. We use an asymmetric Dirichlet
distribution as the proposal distribution.

6.2

Integrating CNV data into PhyloSub

The focus of our new method, PhyloWGS is integrating SSM frequencies with existing copy number
variation (CNV) based subclonal reconstructions. As mentioned above, our algorithm takes as input
a set of SSMs along with their allele frequencies, expressed for each SSM i, as the number of reads
at the locus supporting either the SSM (bi ) or the reference allele (ai ). We also allow our algorithm
to take a set of inferred copy number changes, where for each change j, the input provides the new
copy number Cj as well as the proportion of the population with the change φ̃j . In some cases,
we also require the breakdown of Cj into the new number of maternal (Cjm ) and paternal (Cjp )
copies of the locus (see below for details). If this breakdown is not available, we can restrict our
attention to CNVs for which Cj < 2 because in these cases, there is only one possible breakdown.
Also, in the absence of paternal/maternal breakdown, we should still be able to, in theory, assign
SSMs with overlapping CNVs with Cj > 2 to specific populations once the phylogeny and subclonal
populations have been defined using SSMs and CNVs in regions of Cj ≤ 2.
23

Below, we describe the rules, based on the infinite sites assumption, that we use to determine
the relationship between the population frequency of an SSM φ̃i and its observed variant allele
frequency (bi /di ). When the SSM does not overlap a region that has a predicted CNV in any cell in
the tumor population, then the predicted allele frequency is simply half of the modeled population
frequency. We also describe the method by which we transform each CNV j into a pseudo-SSM to
be included in the phylogeny.
6.2.1

If CNVs do not overlap with any SSM

If a CNV occurs in a region without any SSMs, we generate a ‘pseudo-SSM’ for the CNV j which
is represented in the model as a heterozygous, binary somatic mutation with a read depth that
reflects the uncertainty in the provided population frequency φ̃j for the CNV. Specifically, we
generate reference and variant read counts, aj and bj , respectively, such that the allelic frequency
bj /(aj + bj ) is approximately equal to φj /2 and the total number of reads aj + bj is selected based
on the evidence supporting the CNV. Generating this pseudo-SSM allows the CNV to be treated
like any other SSM in the phylogeny model.
6.2.2

If CNVs overlap with SSMs

If a structural variant occurs in a region with an SSM i, this complicates the relationship between
the proportion of cells that contain the SSM and the expected number of reads because cells with
the CNV will have more (or fewer) than two copies of the locus where the SSM lies. Assuming equal
sampling of these regions, the expected proportion of reads without the mutation (ζi ) is always:
Nir /(Nir + Niv ) where Nir is the number of copies of the locus that have the reference allele and
Niv is the number of copies of the locus with the variant allele. To account for sequencing error we
define  as the probability of reading the reference allele when the locus contains the variant allele
and vice-versa. The expected proportion of reads containing the reference allele is then:
ζi =

Nir (1 − ) + Niv 
Nir + Niv

Looking at a tumor sample with multiple populations and without structural variations, if each
population u is present with proportion
ηu and P
where sui is 1 if population
u contains the SSM i
P
P
r
u
and 0 otherwise, then Ni = 2 ∗ u ηu (1 − si ) + u ηu sui and Niv = u ηu sui . This is equivalent to
an algorithm that looks at each population and performs the following update. If the population
u contains the SSM i then
Nir ← Nir + ηu ,
Niv ← Niv + ηu .
If the population does not contain the SSM then:
Nir ← Nir + 2ηu ,
Niv ← Niv + 0 .
To take into account CNVs requires a more complex procedure. For each population, for each
SSM, the number of reference and variant alleles depends on the copy number of the locus Ci
and, potentially, number of maternal (Cim ) and paternal (Cip ) copies of the locus as well as the
evolutionary relationship between the SSM and the CNV. The infinite sites assumption does not
apply for CNVs, adding a further level of complexity because multiple CNVs at the same locus are
24

possible. For each population, the CNV that affects its contribution to the number of reference
and variant genomes can be found by ascending the evolutionary tree towards the root. The first
CNV found in this ascent is the CNV relevant for the population. If no CNV is found than the
population is not affected by a CNV. For each population there are five possible situations:
(i) The population does not contain the SSM and is not affected by a CNV
(ii) The population does not contain the SSM but is affected by a CNV
(iii) The population contains the SSM but is not affected by a CNV
(iv) The population contains the SSM and is affected by a CNV, and the SSM occurred after the
CNV
(v) The population contains the SSM and is affected by a CNV, and the CNV occurred after the
SSM
If a population does not contain the SSM, then even if a CN change has occurred (cases i and
ii), the update rule is:
Nir ← Nir + ηu Ci ,
Niv ← Niv + 0 .
If a population contains the SSM and the SSM occurred after a CN change (or there was no CN
change) (cases iii and iv) then there is a single copy of the mutated genome and the remainder are
reference, so the the update rule is:
Nir ← Nir + ηu × max(0, Ci − 1) ,
Niv ← Niv + ηu .
If a population contains the SSM and the SSM occurred before the CN change (case v) then there
are two possibilities, the SSM is on the maternal copy or the paternal copy. If the SSM is on the
maternal copy, the update rule is:
Nir ← Nir + ηu Cip ,
Niv ← Niv + ηu Cim .
If however, the SSM is on the maternal copy, the update rule is:
Nir ← Nir + ηu Cim ,
Niv ← Niv + ηu Cip .
Note that the breakdown of Ci into Cim and Cip is only required if the CNV occurs after the SSM
on the same branch.
Now that we can calculate Nir and Niv , the observation model for the allelic counts has the
following generative process (cf. (1)):
G ∼ TSSB(α, γ, H) ;

η̃i ∼ G ;


Nir (1 − ) + Niv 
ai | di , η̃i ,  ∼ Binomial di ,
.
Niv + Nir
Note that in some circumstances, a SSM can be placed on a particular copy of the chromosome by
looking for reads that cover the SSM and nearby heterozygous germline mutations. If this is not
possible then the likelihood of ai is the average of two likelihoods; the likelihood if the SSM occurs
on the maternal genome and the likelihood if the SSM occurs on the paternal genome.
25

6.3

Extension to multiple samples

Our model can be easily extended to multiple tumor samples. We make no assumptions regarding
the time that the samples were collected, so this extension is equally applicable to multiple samples
collected simultaneously (e.g. as in [2]) or over a period of time as in [11]. We allow the treestructured stick-breaking process prior to be shared across all the samples. The main technical
difference between the single and the multiple sample models lies in the sampling procedure for
SSM population frequencies. In the multiple sample model, we ensure that the clonal evolutionary
constraints are satisfied separately for each tumor sample and then make a global MetropolisHastings move based on the product of posterior distributions across all the samples (cf. (2)).

6.4

MCMC settings

In all the MCMC experiments, we fix the number of MCMC iterations to 2,500 and use a burn-in of
100 samples. We also fix the number of iterations in the Metropolis-Hastings algorithm to 5,000 and
set the scaling factor for the Dirichlet proposal distribution to 100 (see PhyloSub paper [17]). We
use the CODA R package [47] for MCMC diagnostics to monitor the convergence of the samplers
using the complete-data log likelihood traces and the corresponding autocorrelation function.

6.5

Sequencing error

It is becoming increasingly clear that sequencing error is not uniform across the genome and different
trinucleotide sequences result in different sequencing error rates [48]. While the precise nature of
these differences is not yet fully known, PhyloWGS allows the user to input a different sequencing
error rate for each mutation.

References
[1] Peter C Nowell. The clonal evolution of tumor cell populations. Science, 194(4260):23–28,
1976.
[2] Marco Gerlinger, Andrew J. Rowan, Stuart Horswell, James Larkin, David Endesfelder, Eva
Gronroos, Pierre Martinez, Nicholas Matthews, Aengus Stewart, Patrick Tarpey, Ignacio
Varela, Benjamin Phillimore, Sharmin Begum, Neil Q. McDonald, Adam Butler, David Jones,
Keiran Raine, Calli Latimer, Claudio R. Santos, Mahrokh Nohadani, Aron C. Eklund, Bradley
Spencer-Dene, Graham Clark, Lisa Pickering, Gordon Stamp, Martin Gore, Zoltan Szallasi,
Julian Downward, P. Andrew Futreal, and Charles Swanton. Intratumor heterogeneity and
branched evolution revealed by multiregion sequencing. The New England Journal of Medicine,
366(10):883–892, 2012.
[3] Andrew E. O. Hughes, Vincent Magrini, Ryan Demeter, Christopher A. Miller, Robert Fulton,
Lucinda L. Fulton, William C. Eades, Kevin Elliott, Sharon Heath, Peter Westervelt, Li Ding,
Donald F. Conrad, Brian S. White, Jin Shao, Daniel C. Link, John F. DiPersio, Elaine R.
Mardis, Richard K. Wilson, Timothy J. Ley, Matthew J. Walter, and Timothy A. Graubert.
Clonal architecture of secondary acute myeloid leukemia defined by single-cell sequencing.
PLoS Genetics, 10(7):e1004462, 07 2014.
[4] D. Hanahan and R. A. Weinberg. The hallmarks of cancer. Cell, 100(1):57–70, 2000.

26

[5] D. Hanahan and R. A. Weinberg. Hallmarks of cancer: The next generation. Cell, 144(5):646–
674, 2011.
[6] Samuel Aparicio and Carlos Caldas. The implications of clonal genome evolution for cancer
medicine. New England Journal of Medicine, 368(9):842–851, 2013.
[7] Philippe L Bedard, Aaron R Hansen, Mark J Ratain, and Lillian L Siu. Tumour heterogeneity
in the clinic. Nature, 501(7467):355–364, 2013.
[8] Charles G. Mullighan, Letha A. Phillips, Xiaoping Su, Jing Ma, Christopher B. Miller,
Sheila A. Shurtleff, and James R. Downing. Genomic analysis of the clonal origins of relapsed
acute lymphoblastic leukemia. Science, 322(5906):1377–1380, 2008.
[9] N. E. Navin and J. Hicks. Tracing the tumor lineage. Molecular Oncology, 4(3):267–283, 2010.
[10] A. Marusyk and K. Polyak. Tumor heterogeneity: Causes and consequences. Biochimica et
Biophysica Acta, 1805(1):105–117, 2010.
[11] Anna Schuh, Jennifer Becq, Sean Humphray, Adrian Alexa, Adam Burns, Ruth Clifford,
Stephan M. Feller, Russell Grocock, Shirley Henderson, Irina Khrebtukova, Zoya Kingsbury,
Shujun Luo, David McBride, Lisa Murray, Toshi Menju, Adele Timbs, Mark Ross, Jenny
Taylor, and David Bentley. Monitoring chronic lymphocytic leukemia progression by whole
genome sequencing reveals heterogeneous clonal evolution patterns. Blood, 120(20):4191–4196,
2012.
[12] Sohrab P. Shah, Andrew Roth, Rodrigo Goya, Arusha Oloumi, Gavin Ha, Yongjun Zhao,
Gulisa Turashvili, Jiarui Ding, Kane Tse, Gholamreza Haffari, Ali Bashashati, Leah M. Prentice, Jaswinder Khattra, Angela Burleigh, Damian Yap, Virginie Bernard, Andrew McPherson,
Karey Shumansky, Anamaria Crisan, Ryan Giuliany, Alireza Heravi-Moussavi, Jamie Rosner,
Daniel Lai, Inanc Birol, Richard Varhol, Angela Tam, Noreen Dhalla, Thomas Zeng, Kevin Ma,
Simon K. Chan, Malachi Griffith, Annie Moradian, S.-W. Grace Cheng, Gregg B. Morin, Peter
Watson, Karen Gelmon, Stephen Chia, Suet-Feung Chin, Christina Curtis, Oscar M. Rueda,
Paul D. Pharoah, Sambasivarao Damaraju, John Mackey, Kelly Hoon, Timothy Harkins, Vasisht Tadigotla, Mahvash Sigaroudinia, Philippe Gascard, Thea Tlsty, Joseph F. Costello,
Irmtraud M. Meyer, Connie J. Eaves, Wyeth W. Wasserman, Steven Jones, David Huntsman,
Martin Hirst, Carlos Caldas, Marco A. Marra, and Samuel Aparicio. The clonal and mutational
evolution spectrum of primary triple-negative breast cancers. Nature, 486(7403):617–656, 2012.
[13] Scott L Carter, Kristian Cibulskis, Elena Helman, Aaron McKenna, Hui Shen, Travis Zack,
Peter W. Laird, Robert C. Onofrio, Wendy Winckler, Barbara A. Weir, Rameen Beroukhim,
David Pellman, Douglas A. Levine, Eric S. Lander, Matthew Meyerson, and Gad Getz. Absolute quantification of somatic DNA alterations in human cancer. Nature Biotechnology,
30(5):413–421, 2012.
[14] Dan A. Landau, Scott L. Carter, Petar Stojanov, Aaron McKenna, Kristen Stevenson,
Michael S. Lawrence, Carrie Sougnez, Chip Stewart, Andrey Sivachenko, Lili Wang, Youzhong
Wan, Wandi Zhang, Sachet A. Shukla, Alexander Vartanov, Stacey M. Fernandes, Gordon
Saksena, Kristian Cibulskis, Bethany Tesar, Stacey Gabriel, Nir Hacohen, Matthew Meyerson,
Eric S. Lander, Donna Neuberg, Jennifer R. Brown, Gad Getz, and Catherine J. Wu. Evolution and impact of subclonal mutations in chronic lymphocytic leukemia. Cell, 152(4):714–726,
2013.
27

[15] L Oesper, A Mahmoody, and BJ Raphael. Theta: Inferring intra-tumor heterogeneity from
high-throughput dna sequencing data. Genome Biology, 14:R80, 2013.
[16] F Strino, F Parisi, M Micsinai, and Y Kluger. Trap: A tree approach for fingerprinting
subclonal tumor composition. Nucleic Acids Research, 41(17):e165, 2013.
[17] W Jiao, S Vembu, A G Deshwar, L Stein, and Q Morris. Inferring clonal evolution of tumors
from single nucleotide somatic mutations. BMC Bioinformatics, 15:35, 2014.
[18] Andrew Roth, Jaswinder Khattra, Damian Yap, Adrian Wan, Emma Laks, Justina Biele,
Gavin Ha, Samuel Aparicio, Alexandre Bouchard-Côté, and Sohrab P Shah. Pyclone: Statistical inference of clonal population structure in cancer. Nature Methods, 11:396–398, 2014.
[19] Noemi Andor, Julie V Harness, Sabine Müller, Hans W Mewes, and Claudia Petritsch. Expands: expanding ploidy and allele frequency on nested subpopulations. Bioinformatics,
30(1):50–60, 2014.
[20] Mengjie Chen, Murat Gunel, and Hongyu Zhao. Somatica: identifying, characterizing and
quantifying somatic copy number aberrations from cancer genome sequencing data. PloS one,
8(11):e78143, 2013.
[21] Nicholas B Larson and Brooke L Fridley. Purbayes: estimating tumor cellularity and subclonality in next-generation sequencing data. Bioinformatics, 29(15):1888–1889, 2013.
[22] John N Weinstein, Eric A Collisson, Gordon B Mills, Kenna R Mills Shaw, Brad A Ozenberger, Kyle Ellrott, Ilya Shmulevich, Chris Sander, Joshua M Stuart, Cancer Genome Atlas Research Network, et al. The cancer genome atlas pan-cancer analysis project. Nature
genetics, 45(10):1113–1120, 2013.
[23] Li Ding, Timothy J Ley, David E Larson, Christopher A Miller, Daniel C Koboldt, John S
Welch, Julie K Ritchey, Margaret A Young, Tamara Lamprecht, Michael D McLellan, et al.
Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing.
Nature, 481(7382):506–510, 2012.
[24] Scott L Carter, Kristian Cibulskis, Elena Helman, Aaron McKenna, Hui Shen, Travis Zack,
Peter W Laird, Robert C Onofrio, Wendy Winckler, Barbara A Weir, et al. Absolute quantification of somatic dna alterations in human cancer. Nature biotechnology, 30(5):413–421,
2012.
[25] Arief Gusnanto, Henry M Wood, Yudi Pawitan, Pamela Rabbitts, and Stefano Berri. Correcting for cancer genome size and tumour cell content enables better estimation of copy number
alterations from next-generation sequence data. Bioinformatics, 28(1):40–47, 2012.
[26] Serena Nik-Zainal, Peter Van Loo, David C. Wedge, Ludmil B. Alexandrov, Christopher D.
Greenman, King Wai Lau, Keiran Raine, David Jones, John Marshall, Manasa Ramakrishna,
Adam Shlien, Susanna L. Cooke, Jonathan Hinton, Andrew Menzies, Lucy A. Stebbings,
Catherine Leroy, Mingming Jia, Richard Rance, Laura J. Mudie, Stephen J. Gamble, Philip J.
Stephens, Stuart McLaren, Patrick S. Tarpey, Elli Papaemmanuil, Helen R. Davies, Ignacio
Varela, David J. McBride, Graham R. Bignell, Kenric Leung, Adam P. Butler, Jon W. Teague,
Sancha Martin, Goran Jönsson, Odette Mariani, Sandrine Boyault, Penelope Miron, Aquila
Fatima, Anita Langerød, Samuel A.J.R. Aparicio, Andrew Tutt, Anieta M. Sieuwerts, Åke

28

Borg, Gilles Thomas, Anne Vincent Salomon, Andrea L. Richardson, Anne-Lise BørresenDale, P. Andrew Futreal, Michael R. Stratton, and Peter J. Campbell. The life history of 21
breast cancers. Cell, 149:994–1007, 2012.
[27] Andrej Fischer, Ignacio Vázquez-Garcı́a, Christopher JR Illingworth, and Ville Mustonen.
High-definition reconstruction of clonal composition in cancer. Cell Reports, 2014.
[28] Sam Behjati, Meritxell Huch, Ruben van Boxtel, Wouter Karthaus, David C. Wedge, Asif U.
Tamuri, Inigo Martincorena, Mia Petljak, Ludmil B. Alexandrov, Gunes Gundem, Patrick S.
Tarpey, Sophie Roerink, Joyce Blokker, Mark Maddison, Laura Mudie, Ben Robinson, Serena
Nik-Zainal, Peter Campbell, Nick Goldman, Marc van de Wetering, Edwin Cuppen, Hans
Clevers, and Michael R. Stratton. Genome sequencing of normal cells reveals developmental
lineages and mutational processes. Nature, 513(7518):422–425, 09 2014.
[29] Rebecca A Burrell, Nicholas McGranahan, Jiri Bartek, and Charles Swanton. The causes and
consequences of genetic heterogeneity in cancer evolution. Nature, 501(7467):338–345, 2013.
[30] Christoph A Klein. Selection and adaptation during metastatic cancer progression. Nature,
501(7467):365–372, 2013.
[31] Christopher A. Miller, Brian S. White, Nathan D. Dees, Malachi Griffith, John S. Welch,
Obi L. Griffith, Ravi Vij, Michael H. Tomasson, Timothy A. Graubert, Matthew J. Walter,
Matthew J. Ellis, William Schierding, John F. DiPersio, Timothy J. Ley, Elaine R. Mardis,
Richard K. Wilson, and Li Ding. SciClone: Inferring clonal architecture and tracking the
spatial and temporal patterns of tumor evolution. PLoS Comput Biol, 10(8):e1003665, 08
2014.
[32] Iman Hajirasouliha, Ahmad Mahmoody, and Benjamin J. Raphael. A combinatorial approach
for analyzing intra-tumor heterogeneity from high-throughput sequencing data. Bioinformatics, 30(12):78–86, 2014.
[33] Motoo Kimura. The number of heterozygous nucleotide sites maintained in a finite population
due to steady flux of mutations. Genetics, 61(4):893, 1969.
[34] Richard R Hudson. Properties of a neutral allele model with intragenic recombination. Theoretical population biology, 23(2):183–201, 1983.
[35] Habil Zare, Junfeng Wang, Alex Hu, Kris Weber, Josh Smith, Debbie Nickerson, ChaoZhong
Song, Daniela Witten, C. Anthony Blau, and William Stafford Noble. Inferring clonal composition from multiple sections of a breast cancer. PLoS Computational Biology, 10(7):e1003703,
07 2014.
[36] Ruibin Xi, Angela G Hadjipanayis, Lovelace J Luquette, Tae-Min Kim, Eunjung Lee, Jianhua
Zhang, Mark D Johnson, Donna M Muzny, David A Wheeler, Richard A Gibbs, et al. Copy
number variation detection in whole-genome sequencing data using the bayesian information
criterion. Proceedings of the National Academy of Sciences, 108(46):E1128–E1136, 2011.
[37] Gavin Ha, Andrew Roth, Jaswinder Khattra, Julie Ho, Damian Yap, Leah M Prentice, Nataliya Melnyk, Andrew McPherson, Ali Bashashati, Emma Laks, et al. Titan: inference of
copy number architectures in clonal cell populations from tumor whole-genome sequence data.
Genome research, 24(11):1881–1893, 2014.

29

[38] Jeffrey W Miller and Matthew T Harrison. A simple example of Dirichlet process mixture
inconsistency for the number of components. In Advances in Neural Information Processing
Systems, pages 199–206, 2013.
[39] Jesse Davis and Mark Goadrich. The relationship between precision-recall and roc curves. In
Proceedings of the 23rd international conference on Machine learning, pages 233–240. ACM,
2006.
[40] Adam Ewing. Tcga mutation/variation calling benchmark 4. https://cghub.ucsc.edu/datasets/
benchmark download.html, January 2013.
[41] The Broad Institute. Picard: Java tools for manipulating bam files. http://picard.sourceforge.
net/.
[42] Heng Li and Richard Durbin. Fast and accurate long-read alignment with burrows–wheeler
transform. Bioinformatics, 26(5):589–595, 2010.
[43] Kristian Cibulskis, Michael S Lawrence, Scott L Carter, Andrey Sivachenko, David Jaffe,
Carrie Sougnez, Stacey Gabriel, Matthew Meyerson, Eric S Lander, and Gad Getz. Sensitive
detection of somatic point mutations in impure and heterogeneous cancer samples. Nature
biotechnology, 31(3):213–219, 2013.
[44] Christopher T Saunders, Wendy SW Wong, Sajani Swamy, Jennifer Becq, Lisa J Murray, and
R Keira Cheetham. Strelka: Accurate somatic small-variant calling from sequenced tumor–
normal sample pairs. Bioinformatics, 28(14):1811–1817, 2012.
[45] Ryan Prescott Adams, Zoubin Ghahramani, and Michael I. Jordan. Tree-structured stick
breaking for hierarchical data. In Advances in Neural Information Processing Systems 23,
pages 19–27, 2010.
[46] W Keith Hastings. Monte carlo sampling methods using markov chains and their applications.
Biometrika, 57(1):97–109, 1970.
[47] Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. CODA: Convergence diagnosis
and output analysis for MCMC. R News, 6(1):7–11, 2006.
[48] Paul C Boutros, Adam D Ewing, Kyle Ellrott, Thea C Norman, Kristen K Dang, Yin Hu,
Michael R Kellen, Christine Suver, J Christopher Bare, Lincoln D Stein, et al. Global optimization of somatic variant identification in cancer genomes with a global community challenge.
Nature genetics, 46(4):318–319, 2014.

30

