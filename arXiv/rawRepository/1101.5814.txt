1

arXiv:1101.5814v3 [q-bio.GN] 9 Aug 2011

Joint scaling laws in functional and evolutionary categories in
prokaryotic genomes.
J. Grilli1 , B. Bassetti1,2 , Sergei Maslov3 , M. Cosentino Lagomarsino4,5,∗
1 Dipartimento di Fisica, Università degli Studi di Milano, Milano, Italy
2 I.N.F.N. Milano, Milano, Italy
3 Department of Condensed Matter Physics and Materials Science, Brookhaven National
Laboratory, Upton, NY 11973, United States of America
4 Génophysique / Genomic Physics Group, UMR 7238 CNRS “Microorganism
Genomics”, Paris, France
5 Université Pierre et Marie Curie, Paris, France
∗ E-mail: Marco.Cosentino-Lagomarsino@upmc.fr

Abstract
We propose and study a class-expansion/innovation/loss model of genome evolution taking into account
biological roles of genes and their constituent domains. In our model numbers of genes in different
functional categories are coupled to each other. For example, an increase in the number of metabolic
enzymes in a genome is usually accompanied by addition of new transcription factors regulating these
enzymes. Such coupling can be thought of as a proportional “recipe” for genome composition of the
type “a spoonful of sugar for each egg yolk”. The model jointly reproduces two known empirical laws:
the distribution of family sizes and the nonlinear scaling of the number of genes in certain functional
categories (e.g. transcription factors) with genome size. In addition, it allows us to derive a novel relation
between the exponents characterizing these two scaling laws, establishing a direct quantitative connection
between evolutionary and functional categories. It predicts that functional categories that grow fasterthan-linearly with genome size to be characterized by flatter-than-average family size distributions. This
relation is confirmed by our bioinformatics analysis of prokaryotic genomes. This proves that the joint
quantitative trends of functional and evolutionary classes can be understood in terms of evolutionary
growth with proportional recipes.

1

Introduction

Protein-coding genes in genomes can be classified in both functional categories (e.g. transcription factors
or metabolic enzymes) as well as “evolutionary categories” or families of homologous genes (to avoid
confusion, in the following we will reserve the term “category” to functional annotations, and we will use
the term “family” as a generic indication of homology classes, or domain families/superfamilies in domain
data, see Methods). Functional categories are routinely composed of a large number of evolutionary ones.
This distinction is illustrated in Fig. 1, where genes are characterized by both shape (functional category)
and color (homology class) with each shape represented by multiple colors. Understanding the principles
connecting these separate classifications of genomic material is an important step in order to disentangle
the organization of the content of whole genomes.
More specifically, studies of fully sequenced genomes revealed that their functional and evolutionary
composition is governed by simple quantitative laws [1, 2]. In particular, for prokaryotes the number of
genes in individual functional categories was shown to scale as a power law of the total number of genes in
the genome [2]. Depending on the functional category the exponent of this scaling law varies from 0 (for
fixed sets of housekeeping genes) to 1 (for metabolic enzymes) and all the way up to 2 (for transcription
factors and kinases) [2, 3]. Furthermore, the distribution of sizes of gene families (called “evolutionary
categories” in our title) has a scale-free distribution with the exponent inversely correlated with the
genome size [1,4,5]. The overall number of gene (or domain) families represented by at least one member

2

exhibits a slower-than-linear scaling with the total number of genes in a genome [6, 7]. Biologically,
the growth of evolutionary families derives from combined processes of horizontal gene transfer, gene
duplication, gene genesis, and gene loss [8]. For prokaryotes, horizontal transfer appears to dominate
gene family expansion [9], and the same process is presumably very important for the introduction of a
new evolutionary family into an extant genome.
The comprehension of these empirical laws requires to construct quantitative models that explore
different design principles, or more prosaically the recipes by which genomes are built from elementary
functional and evolutionary ingredients. In this study we introduce the first model to jointly explain
observed scaling laws for evolutionary families and functional categories.
Several theoretical models have been previously proposed to explain the observed power-law distribution of family sizes [5,10–13] Most of these models are of class-expansion/innovation/loss type, abstractly
mimicking basic evolutionary moves such as horizontal transfer, duplication, loss. We recently formulated
a related model that in addition to family size distribution also explains and successfully fits the scaling
of the number of distinct gene families represented in a genome as a function of genome size [6, 14].
On another front, the “toolbox model” of evolution of metabolic networks and their regulation recently proposed by one of us [15] offered an explanation for the quadratic scaling between the number of
transcription factors and the total number of genes in prokaryotes. In this model, metabolic and regulatory networks of prokaryotes are shaped by addition of co-regulated metabolic pathways. The number of
added enzymes systematically decreases with the proportion to which the organism has already explored
the universe of available metabolic reactions, and thus, indirectly, with the size of its genome. For the
purposes of the present study, a key ingredient of the toolbox model is that events adding or deleting
genes in multiple functional categories (in this case metabolic enzymes and transcription factors regulating metabolic pathways) are tightly correlated with each other. The concept of coordinated expansion or
contraction of functional categories can in principle be extended beyond enzymes and their regulators.
One should note that this explanation of scaling of functional categories is conceptually different from
that based on “evolutionary potentials” proposed in Ref. [3]. Evolutionary potentials quantify the intrinsic
growth rates of individual categories. This means that in this model the growth of one functional category
is represented as uncoupled from growth or decline in other functional categories. However, evolutionary
potentials could also be the effective result of the coordinated expansion of multiple functional categories
linked by interactions of biological and evolutionary origin (e.g. linking membrane proteins with signal
transduction, etc.) On the other hand, it is clear that models with evolutionary potentials represent quite
well the empirical data on the growth of functional categories, and thus it appears that this must be (at
least) a very good effective description, that any more detailed model needs to reproduce.
This study brings together the basic ingredients of class-expansion/innovation/loss models [6, 14]
and coordinated growth of functional categories [15]. The resulting combination allows us to study the
interplay between the scaling of evolutionary and functional categories. In particular, we mathematically
derive a relation between the exponents characterizing these two scaling laws. It predicts that functional
categories that grow faster-than-linearly with genome size are characterized by flatter-than-average family
size distributions. This prediction of our model is subsequently verified by our analysis of functional
and evolutionary scaling in empirical data on sequenced prokaryotic genomes. Finally, we analyze and
discuss the alternative combination of a class-expansion/innovation/loss model with growth of functional
categories dictated by evolutionary potentials.

2

MATERIALS AND METHODS

Models
The model represents a genome as a list of genes, which is partitioned in homology families and functional
categories. Genome evolution is modeled as a stochastic process where the elementary moves can be

Domains in Functional Category

3

600
400
200
0
0

A

Cumulative Probability

Number of Domain Families

800

B
Number of Domains

1000

Translation
Regulation of Transcription
Metabolic Processes

100

10

2000
4000
6000
8000
Genome Size (Number of Domains)

C
1000

Genome SIze (Number of Domains)

10000

Scaling laws
Evolutonary Categories
(Domain Families / Homology Classes)

Functional Categories

Genome
Figure 1. Scaling laws in joint functional/evolutionary partitioning of genomes. Genomes are
partitioned into families of homologous genes (colors) and functional categories (shapes). (A) The
number of unique evolutionary categories (domain families) (y-axis) scales sub-linearly with the genome
size (x-axis.) (B) Cumulative histograms of domain family size (see Figure 4). (C) The number of
transcriptional regulators (red), metabolic enzymes (blue), and housekeeping genes responsible for
translation (green) plotted as a function of the genome size measured by the total number of domains.
Symbols in all the plots are empirical data for protein domains in 753 fully sequenced bacterial genomes.
any of two types: (i) a “family expansion” or “duplication” move in which a new domain is placed
in an evolutionary category (family of homologous domains) already present in the genome or (ii) an
“innovation” move in which a new family with just one domain appears in a genome (e.g. by the virtue
of horizontal gene transfer).
We would like to emphasize that in the tradition established in “duplication-innovation-loss” models,
which we follow, the family expansion move is customarily labeled as duplication. In reality this move
can come either by the virtue of gene duplication or by horizontal gene transfer, which appears to be
the dominant class-expansion mechanism in bacteria [9]. The overall family size in all genomes might be
generating an effective “preferential attachment” for HGT events (see Refs. [3, 16] and open comments
by referees therein).
Although genes are natural objects of this kind of description, it is not simple to use genes as central
units in the analysis of empirical data, mainly due to the fact that gene dynamics is complex and may
contain events of gene fusion, splitting and internal rearrangements. Thus, as in some previous analyses,
we will compare the models with data on protein domains [3, 6], which have the important property that

4

0.2

100

50

Relative Innovation Rate
of Functional Category (χc)

Families in Functional Category

150

0
0 200 400 600 800
Total Number of Families

Nucleotide transport
and metabolism
Small molecule binding
Translation
DNA replication,
recombination, repair
Transcription Factors
Inorganic ion transport
and metabolism
Oxidation/Reduction
Transferases
Other enzymes
Signal transduction

0.1

0
0

2000 4000 6000 8000
Genome Size
(Number of Domains)

Figure 2. The number of evolutionary (domain) families belonging to a functional category follows a
linear law in empirical data, denoting a possible invariant of genome composition. The left panel plots
the data on for the number of families fc in the ten largest functional categories on all genomes,
following the trend fc = Ac + χc f , where f is the total number of families on the genome. Symbols are
empirical data for 753 fully sequenced bacterial genomes. The offset Ac is large only for the
“translation” category. The right panel is a plot of the coefficients χc obtained from the same data
(subtracting the offset Ac obtained from a linear fit), as a function of genome size in domains, n. See
also Supplementary Table S1.
they cannot be split into smaller units [17]. Domains are modular building blocks of proteins and it has
been argued that they effectively work as the natural atomic elements in genome evolution [4]. Concerning
the scaling laws, domains appear to have the same qualitative behaviour as genes. Throughout the paper,
we will be comparing the models with data on 753 bacteria from the SUPERFAMILY database [18]. The
models will be formulated for abstract atomic elements that could be genes or domains, and possible
relevant issues when dealing empirically with genes will be addressed in the discussion. In describing the
models we will generally refer to these units as genes.
Technically, in order to compare with the protein domain data we rely on simplifying assumptions
on the domain composition of proteins. Obviously the situation is more complex than this. We have
verified in the data that the number of TF domains are linear in the number of TF genes (Supplementary
Figure S5), with slope 1.09 (average number of TF domains in a TF gene). A second assumption is that
the number of families belonging to a functional category is linear in the total number of families. This
assumption is in accordance with data (see Figure 2 and Supplementary Figure S1). In particular, we
observed this trend for the number of transcription factor superfamilies (see Supplementary Figure S2).
Standard Chinese Restaurant Process.
The starting point is a class-expansion/innovation process for the homology families that reproduces
qualitatively the empirical scaling laws [6]. This process (known in mathematical literature as “Chinese
Restaurant Process”or CRP [19]) defines a growth dynamics for the partitioning of a set of elements
(genes or domains) based on two basic growth moves. Traditionally the CRP model is defined by two
parameters α and θ constrained by 0 ≤ α ≤ 1 and θ > −α. The moves are quantified and defined by two

5

probabilities pO and pN of duplication and innovation respectively.
• The class-expansion probability piO of a domain family i is proportional to the number of family
members ni currently in the genome offset by α: piO ∼ ni − α (see Table 1).
• The innovation probability pN is the probability of adding a new domain family with one member.
It corresponds to a new domain family appearing in a genome by de novo evolution or horizontal
gene transfer. The CRP model assumes pN ∼ αf + θ, where f is the total number of domain
families present in the genome.
P
The normalization condition pN + i piO = 1 determines the pre-factor in both equations to be 1/(n + θ).
A gene loss move does not seem to be essential for the basic qualitative results. Indeed, if stochastic
(uniform) gene loss is incorporated into the model it results only in renormalization of parameters pO
and pN [14].
We explore the model by direct simulation and by solving continuous “mean-field” equations [6, 14]
that describe the mean behaviour of the number of homology families and functional categories, and the
statistics of the population of families and categories.
CRP model incorporating functional categories.
In order to introduce functional categories into the CRP, one has to specify pO and pN for different
categories. We first assume that the probability of introducing a gene of a specific functional category by
the innovation move is independent of genome size. This assumption implies that the number of homology
families of a given category scales linearly in the total number of families, and is justified empirically
for some functional categories by domain data (see Figure 2 and Supplementary Figures S1 and S2).
Equivalently, pcN = χc pN , where χc is the probability of introducing a new family of the category c. In
other words, it is assumed here that every time a new family is added, the probability that it will belong
to category c is χc .
Under this assumption, the mean-field equation describing the growth of a family of homologous
domains (evolutionary category) is
C(n)∂n ni =

f
X

aij nj − α.

(1)

j=1

Here the genome size n is used instead of time and averages over multiple realizations of a process are
implied. The novel ingredient of the model - coordinated growth of functional categories - is encoded
in the coefficients aij responsible for correlated duplications between evolutionary families i and j. We
assume aij to depend only on functional roles of families i and j. The equation describing the growth of
f - the number of distinct families in a genome is the same as in a standard CRP model.
C(n)∂n f = (αf + θ) .

(2)

The function C(n), which
P sets a natural time scale for the process, is determined by the normalization
condition ∂n n = 1, i.e. i ∂n ni + ∂n f = 1.
For the specific case of categories of transcription factors (TFs) regulating metabolic processes and
their metabolic target enzymes, the necessity of a correlated move can be argued along the lines of
Ref. [15]. A set of new targets has to be added to incorporate a new metabolic function. This entails
the addition of a new metabolic pathway that is long enough to connect a new nutrient to a previously
existing pathway, that further converts it to a central metabolic “core network”. Supposing that each
newly added branch is controlled by only one added transcription factor, since the length of the branch
becomes smaller with increasing size of the organismal metabolic network (compared to a metabolic

6

“universe”), on average, increasingly more TFs per target will be needed in order to control newly
incorporated branches.
More generally, functional, genetic and epistatic interactions can create the correlated growth of
different functional categories of genes. In the discussion section we provide the empirical evidence of
statistically significant correlations between various functional categories.
Following the recipe outlined in Ref. [15] we consider a simplified version of the model involving
only two functional categories: 1) T F - transcription factors controlling metabolic processes; 2) met metabolic enzymes they regulated. As in the toolbox model, changes in nT F and nmet are coordinated
with correlation coefficients aij given by
aij =

nmet
, aji = 0; for i 6= j
U
and aii = 0 .

Here U is the size of the metabolic universe, i denotes any gene family from functional category T F , and
j - from the functional category met. In this variant, addition of transcription factors can only occur
conditionally to the addition of metabolic enzymes. In the following, we will refer to this model variant
as model Ia.
We define a second variant of the correlated model (model Ib), which is a more direct
extension of the standard CRP model, and thus can exploit previous mean-field theory analytical results.
In this case
aij =

ni
, aji = 0; for i 6= j
nmet
and aii = 1 ,

(where i again denotes any gene family from functional category T F and j - from the functional category
met). In this model variant, all families (and hence also transcription factors families) have an equal
intrinsic growth rate on top of the correlation. If aij = 0, i 6= j the model is equivalent to the standard
CRP. Finally, we also considered a model (model II) where correlations between functional categories are
absent, but instead members of a given functional category are added at a category-dependent intrinsic
rate as prescribed by “evolutionary potentials” of Molina and van Nimwegen (in this case, aij = 0 for
i 6= j, and aii = ρc(i) , where c(i) is the functional category to which family i belongs, and ρc(i) is the
evolutionary potential of class c). These results are discussed later on in the manuscript and compared
to to the two “correlated duplication” models above (see Discussion and Supplementary Text).
To resume, two kinds of models are considered here: “correlated recipes”, where the scaling exponents
can only result from interactions between categories (model Ia and Ib, the main focus of our study), and
“absolute recipes” (model II), leading to different intrinsic growth rates for different categories. Correlated
models might contain an specific intrinsic growth rate of the classes, equal for all classes (model Ib), or
not (model Ia). We will see that the important distinction between model I (a and b) and model II is
that the different scaling exponents for functional categories are a result of correlations and not absolute
class expansion rates.

Data
Data on superfamily domain assignments and superfamily functional annotations for the 753 Bacteria
were obtained from the SUPERFAMILY (v1.73) database [18]. The database contains 1291 different
domain superfamilies grouped into 47 different functional categories (60 families do not belong to a
specific category). These categories are divided into 6 larger groups (Metabolism, General, Regulation,
Information, Initiation Complex Processes and Elongation Complex Processes, see also
http://supfam.cs.bris.ac.uk/SUPERFAMILY 1.73/function).

7

Evaluation of exponents in empirical data
We considered the normalized cumulative histograms (families with more than d members) and noncumulative histograms (families with exactly d members) of the populations for all evolutionary families
(related to exponent β, see Results), and those restricted to the families belonging to each of the main
functional categories indexed by c (related to the exponent βc , see Results). Exponents were estimated
by fitting the data with a power-law, restricting to a window where the x axis value was less than a
cutoff value, as in Ref. [14]. The cutoff was chosen for each fit, by minimizing the chi square residuals
with varying window size. This procedure was implemented with a custom CINT (C++) script using
the ROOT software. Figure 6 is obtained considering the fitted exponents for the histograms of the five
largest genomes (where the “finite-size correction” is smallest, see Figure 5 and Ref. [14].)

Empirical correlations among functional categories
Correlation between families (or categories) populations were calculated from the deviations from the
average trend. We obtained the frequency of a family/category in every genome, defined as the ratio
between the population of a family in domains and the total number of domains assigned on that genome.
Subsequently for every family/category, we extracted an average trend as a function of genome size n
using a sliding-window histogram (with window size of 280 domains and resolution of 28 domains), and we
considered the deviation of each genome from the average trend at its value of n. The Pearson correlation
of these deviations over all the genomes was considered between each pair of families/categories (Figure
7 and Supplementary Table S3 and S4).

Models and simulations
The quantitative duplication-innovation evolutionary models were explored by a mean-field analytical
approach and direct numerical simulations. The mean-field approach considers equations for the means
of the observed quantities in the large-n approximation. In parallel with the mean-field analysis, we
performed simulations of the main model and its variants. The realizations depend on the following
parameters. (i) The parameters of a standard CRP, α and θ. (ii) The parameter χc , i.e. the probability
that a new family belongs to a given functional category. This parameter can be inferred from data (see
Results and Figure 2). For example, for the case of transcription factors and targets, we defined χT F
from the slope extrapolated from Supplementary Figure S2, giving χT F ' 0.035 (see also Supplementary
Figure S6). (iii) Initial conditions, represented by initial configuration (number of leaves, number of TFs
and number of families in both categories). We have used the configuration of the smallest bacterium in
the dataset (Candidatus Carsonella ruddii). An alternative choice could be the minimal intersection of
all genomes in the database. (iv) Variant-specific parameters, that amount to the evolutionary potentials
ρc for the first variant of the model, and the correlation matrix between functional categories, aij for
the second variant. Simulation results are typically visualized in boxplots in order to compare the means
with the probability distributions. In these plots bars correspond to (in order) the smallest observation,
lower quartile, median, upper quartile, and largest observation.

3

RESULTS

A new invariant of genome composition
We found (Figure 2 and Supplementary Table See also Supplementary Table S1) that the number of
evolutionary domain families forming a functional category follows a linear law in empirical data, denoting
a possible invariant of genome composition. This also implies that the mean law ∂n fc = χc ∂n f assumed
in the model is justified by the data. This does not mean exactly that the fraction of all families belonging

8

to a certain functional category is constant. Rather, the observed law can be fc = Ac +χc f , with an offset
Ac representing a minimal amount of evolutionary families required to build a given functional category.
In empirical data, this offset appears to be large only for the “translation” functional category.

The model captures the combined scaling laws
Numerical simulation and mean-field analytical solutions of the correlated growth model (model I) reproduce very well both the empirical behavior of the TFs scaling law and the statistics for evolutionary
domain families (Figure 3 and Supplementaty Figure S4). We found no significant qualitative difference between models Ia and Ib regarding these observables. Furthermore, the joint scaling laws can be
reproduced also with an uncorrelated model (model II), with minor technical difficulties (see Discussion).
The correct asymptotic quadratic scaling can be obtained from mean-field arguments for both
model I and II. These arguments are presented in the Supplementary Text. In order to illustrate this
point we consider for example model Ib. Starting fromPEqs. 1 one has to sum over all domain families
from functional categories T F and met. Since
P nT F = i∈T F ni , depends on the number of TF classes,
one must have for its derivative ∂n nT F = i∈T F ∂n ni + ∂n fT F . Combined, these two equations give
dnT F /dnmet = 2(nT F − α)/(nmet − α) ' 2nT F /nmet , or finally the quadratic scaling nT F ∼ n2met .
Altogether, the agreement between data and model is universal, in the sense that the same three
parameters are sufficient to predict family/category numbers and populations for all genomes in the
dataset. Moreover, the comparison does not rely on the adjustment of any hidden parameter. It is also
worthwhile noting that, while the input of model I (a and b) is built to give an asymptotic power-law
scaling exponent of two for transcription factors (which is reproduced by the mean-field approach), at the
relevant genome sizes the model automatically reproduces the correct empirical exponent (about 1.6 in
the SUPERFAMILY data) as an effect of the finite system size. Note that in model Ib TFs can duplicate
both spontaneously (uncorrelated move) and following spontaneous duplication of targets (correlated
move), corresponding to the terms aii and aij in equation 1, while in model Ia this does not happen.
The extension of the model to more than two categories requires to know the laws through which
families of different categories are correlated with each other. Supplementary Figure S3 compares the
results obtained by a correlated duplication model formulated with three categories (TFs, met, others).
Table 1. Basic model quantities and notations
Quantity
α,θ
n
ni
nc
f (n)
fc (n)
f (d, n)
fc (d, n)
β
βc
χc
ζc

Meaning
CRP model parameters
Genome size quantified by its total number of domains
Number of domains in the family i
Number of domains in the functional category c
Number of families in a genome of size n
Number of families in a genome of size n belonging to the functional category c
Number of families with exactly d members in a genome of size n
Number of families belonging to the functional category c with exactly d members in a genome of size n
Exponent of the family-population histogram
Exponent of the family-population histogram restricted to category c
Probability to introduce a new family of the category c (empirically quantified by the slope of fc vs. f )
Exponent of the scaling of the size of functional category c vs. genome size n

Number of Domain Families

1200
1000
800
600
400
200
2000

4000

6000

Genome Size (Domains)

8000

Number of Transcr. Factor Domains

9

1000

100

10

1

1000

Genome Size (Domains)

10000

Figure 3. Comparison between 1000 realizations of the correlated duplication model Ib at α = 0.3 and
θ = 140 (blue boxplot) with empirical data (red). The left panel is a plot of the number of distinct
domain families versus genome size. The fact that the number of families does not saturate is a
property of the standard duplication-innovation model (see [6] for a complete discussion). The right
panel plots the number of TF domains versus the total number of domains, showing that the scaling of
the transcription functional category is well reproduced (exponent ' 1.6.) See Supplementary Figure S4
for model Ia.

Prediction of the exponents of the family-population histogram restricted to
single functional categories.
While the agreement between model and data shows that the scaling of functional and evolutionary
categories can be understood jointly, it does not provide by itself any substantially new information
about how the two partitionings interact. Further insight can be obtained considering the distributions
of the number of domains per family for different evolutionary families belonging to the same functional
category. In general, the population of domain families of a genome follows a near power law distribution
whose slope depends on genome size (Figure 4). The mean number f (d, n) of domain families having
d members at large genome size n is well described by the slope 1/d1+β (see Figure 4) , and thus the
cumulative histogram by Q(d, n) ∼ 1/dβ , where the fitted exponent β typically lies between 0 and 1.
The standard CRP predicts this behavior [6, 14]. The model described here here allows to consider the
same histograms restricted to specific functional categories (Figure 4 and Figures 6).
A mean-field calculation (see Supplementary Text) based on the model variant with correlated duplication predicts that the different trend of domain population histograms for transcription-factor families
β
scales as f (d, n)T F ∼ 1/d1+ 2 (see Figure 5). Thus, the ratio between the exponent of the cumulative
histogram of all families and the exponent of the cumulative histogram restricted to families belonging to
the transcription factor category is predicted to be equal to the mean-field exponent for the scaling of the
functional category. Specifically, Q(d, n) scales as 1/dβ whereas QT F (d, n) scales as d−β/2 and thus the
ratio of exponents is β/(β/2) = 2, and this matches the asymptotic scaling of the number of transcription
factors. More in general, the model indicates that each time the per-family duplication probability for a
functional category takes the form pcO ' ζc nc , where nc is the total population of the functional category c,
the coefficient ζc will appear in the equation for P (d)c , the (cumulative) distribution of families belonging
category c. This causes the relationship βc = β/ζc and appears to be robust with respect to the choice of
a specific model (see Supplementary Text). In other words, a precise quantitative relationship must exist
between the scaling exponent of a category and the slope of the family population histogram restricted

10

to the same category. Functional categories that grow faster-than-linearly with genome size will have
flatter-than-average domain family size distributions. Conversely categories growing slower-than-linearly
will follow a steeper-than-average slope.
Accordingly, a strongly visible trend should be expected in empirical data from families belonging
to the transcription factor category, which scales with exponent 2. Indeed, the empirical population
histograms for the transcription factor functional category for all the genomes in the data set have
a slope that is spectacularly different from the global one (Figure 5 and Supplementary Figure S13).
Quantitatively, this observation is in excellent agreement with predictions (Table 2). Direct simulations of
the correlated model reproduce well both the behavior of the histograms at given size and the dependency
on genome size (see Figure 4).
More generally, one can test the prediction ζc = β/βc with an empirical evaluation of many functional
categories (Figure 6). The agreement of empirical data with the predicted behavior is reasonably good,
keeping in mind that many functional categories are composed by few or poorly populated families, and
in these cases the data might not follow a scaling law that is as clearly defined as the metabolism or the
transcription factor categories.

4

DISCUSSION

Population of evolutionary families of a given functional category
We have presented the first combined quantitative description of the partitioning of genomes in both
evolutionary families and functional categories. The results show that a theoretical framework that
correctly reproduces both the scaling laws for functional categories of genes/domains and the scaling
laws for gene/domain families (numbers and histograms) is possible. Biologically, this finding can help
us understand the large-scale architecture of a genome in terms of its functional content.
Analyzing the data in order to formulate the model, we found that the number of evolutionary
domain families forming a functional category is linear in the total number of domain families (Figure 2).
Thus, the genomic subdivision of evolutionary classes in functional categories appears to be arguably the
simplest possible, if one disregards the class population. This ingredient was taken as an assumption for
all the models considered here, which the data fully justify.
The model leads to the nontrivial prediction that connects the growth exponent of a functional
category to the slope of the population family histogram restricted to the same category. In other
words, the populations functional categories and evolutionary families of genes are connected by a simple
quantitative law. Specifically, the ratio between the exponent of the cumulative histogram of all families
Table 2. Prediction of the exponent of the family-population histograms restricted to singular
functional category. Comparison between expected and observed ratio of the exponent of the
cumulative histogram of all families and the exponent of the cumulative histogram of
transcription-factor families ( Figure 6 ), for the five largest bacteria in the SUPERFAMILY database.
The ratio can be compared with the mean-field prediction of 2, or directly with the empirical exponent
of the transcription factor functional category (1.6).
Genome
Sorangium cellulosum
Burkholderia xenovorans
Burkholderia
Solibacter usitatus
Bradyrhizobium japonicum

β/βT F
1.72 ± 0.1
1.63 ± 0.08
1.54 ± 0.13
1.46 ± 0.05
1.59 ± 0.11

ζT F
1.6
1.6
1.6
1.6
1.6

11

Families with more than D Domains

Empirical Data
1

1

A

-0.2

Total

-0.5
0,1

0,1

0,01

0,01

-2
-2.5

n < 1000
1000 < n < 2000
2000 < n < 3500
3500 < n < 5000
n > 5000

Transcription Factors
0,001
1

10

100

1000

Number of Domains D

0,001

10

100

1000

Number of Domains D

Families with more than D Domains

Model
1

1

Total

-0.5

0,1

B

-0.2
0,1

-2
0,01

0,01

-2.5
Transcription Factors
0,001

10

0,001
1000
1

100

Number of Domains D

10

100

Number of Domains D

1000

Families with more than D Domains

Overlay Empirical Data / Model
1

1

Total

-0.5

C

-0.2

0,1

0,01

-1.5

0,1

10

0,01
1

-1

0,001

Transcription Factors
0,0001
1

100

Number of Domains D

1000

10

100

1000

Number of Domains D

Figure 4. Empirical data and simulations for the normalized domain family population cumulative
histograms. The histograms are defined as the fraction f (d, n)/f (n) of families with more than d
domains. (A) Empirical data for the 753 bacteria in the SUPERFAMILY database (each color is a set
of genomes with similar sizes). Left panel: domain family population cumulative normalized
histograms. Right panel: normalized cumulative histograms restricted to domain families belonging to
the transcription factor functional categories. Note that the histograms slopes are different. (B)
Simulations for domains family population cumulative histograms of CRP with correlated duplications
run at α = 0.3 and θ = 140. The plots in the two panels are defined as in (A). (C) Comparison between
simulations of the correlated duplication model variant run at α = 0.3 and θ = 140 (black lines) with
empirical data (orange lines) for the largest genome sizes (5000 < n < 8500). Left panel: global
normalized cumulative histograms of domain family population. Right panel: normalized cumulative
histograms restricted to transcription factor domain families.

Exponento of cumulative histograms

12

1.5

Total
TF

1

0.5
2000

4000
6000
Genome size

8000

Figure 5. Exponent of evolutionary families and genome size. Fitted exponent of domain family
population cumulative histograms vs. genome size, for the 753 bacteria in the SUPERFAMILY
database for TF families (red circles) and all families (black squares), obtained by a fitting method
giving a lower weight to the tail in order to keep into account the cutoffs (used in Ref. [14]).
and the exponent of the cumulative histogram restricted to families belonging to a functional category is
predicted to be equal to the exponent for the scaling of the functional category.
To generate this prediction, we have analyzed in detail the case of transcription factors, where the
exponent of the population histogram is halved due to the quadratic scaling using mean-field calculations
and simulations, and verified that it holds in general by simulations of both model variants. Empirical data
on transcription factors follow this behavior remarkably well, showing population cumulative histograms
of transcription factor superfamilies decaying with halved exponents compared to the global populations.
The fatter tails of the TF histograms might also be related to the fact that only a few highly populated
DNA-binding domain superfamilies dominate the population of TF DNA-binding domains and determine
the scaling laws (Supplementary Text and Supplementary Figures S10 and S11). More in general, we
have also compared the behavior of domain family population histograms for all the empirical functional
categories with the prediction, obtaining results that are in good agreement (Figure 6), in particular for the
highly populated categories, where the fitting procedure gives the highest confidence. The only highlypopulated category that significantly violates this general trend is small molecule binding, a category
composed of very few highly-populated domain families. This category is known to follow peculiar
evolutionary laws, with high mobility of domains across the metabolic network, resulting in members of

13

2
Transcription Factors

Scaling Exponent (ζ c)

Theoretical Slope

1.5
Small molecule
binding

1

0.5
Translation

0
0

1
2
3
4
Inverse of Histogram Exponent (1/βc)

5

Figure 6. Linear relation between ζc and 1/βc . Our theory predicts ζc ∼ β/βc (solid line). The
empirical value of β = .74 is calculated from the family population histograms of the five most
populated genomes. Symbols (circles and triangles) are empirical data for 38 functional categories (see
also Supplementary Table S2). Triangles represent the ten most populated categories, where the
estimated exponents are most accurate. The outlier is the “small molecule binding” category known to
follow peculiar evolutionary mechanisms [20].
the same family being scattered across different pathways and producing lineage-specific domain families,
with frequent re-invention of the same function by different families [20, 21]. Thus, the exception makes
biological sense, and can be understood in terms of members of evolutionary classes “jumping” to different
functional categories with high rate during evolution.

Correlated and absolute recipes
The central ingredient of our main model (model I) is the coupling between addition/removal of genes
in different functional categories. From a biological standpoint, it is reasonable that gene repertoires
of functional categories related to each other via shared tasks, pathways or processes should follow
coordinated rules [8]. In order to further justify this assumption, we probed directly the empirical
domain data for correlation between number of domains in different functional categories,. To this end,
for each genome g we calculated the deviation δnc (g) between the functional category size (nc (g) and its
average size in genomes of comparable size (see Methods). We then calculated the matrix of correlations
between values of δnc for different functional categories c. The results are reported in Figure 7 and

14

Supplementary Tables S3 and S4. We also tested that this procedure for evaluating the correlation was
not dependent on genome size (Supplementary Figure S9.) The metabolism categories appear to be
highly (anti-)correlated with each other, probably because of the role they play in different pathways of
a common metabolic network [15]. The observed correlations between metabolic families might also be
relevant for reproducing the correct tail of the family population histogram restricted to the metabolism
category (Supplementary Figure S3).
An alternative approach is a description where the growth of each category is governed by intrinsic
“evolutionary potentials” [3]. We have also analyzed such a description in some detail (see Supplementary text and Supplementary Figure S3). Despite of minor differences, a model combining classexpansion/duplication/loss with uncorrelated moves for the functional categories, model II, can also
perform well in reproducing the joint scaling law and in predicting a relationship between the scaling exponents and the functional categories. In particular, this means that the latter result should not by itself
be considered a piece of evidence in favor of a correlated recipe. Figure 8 illustrates the basic differences
between the two descriptions. The evolutionary potentials approach generically requires a lower number
of parameters, but suffers from the tedious technical problem that the values of the growth coefficients
cannot be controlled directly, because of the scaling of the normalization constant with genome size (see
Supplementary Text and Supplementary Figure S7). The correlated model is technically more under
control, since its behavior does not rely on any unknown normalization constant. For this reason, it
also performs better with functional categories that grow faster than linear with genome size, such as
transcription factors. On the other hand, such a model can be formulated with very few parameters only
when a synthetic description for the correlations, such as the toolbox model, is provided.
Here, we have considered mainly a model with three categories (transcription factors, metabolic, and
others) and one nonzero correlation between metabolic domains and transcription factors. In general,
specific biological details of how categories are correlated with each other determine the scaling exponents
relating their genome fractions to each other and genome size. Note that the task of formulating a
correlated model for many categories requires a knowledge of how the different functional categories are
“slaved” to each other. This structure is largely unknown quantitatively, and can in principle define
an arbitrarily complex network of interactions, since many categories may correlate with many others
in potentially complicated ways. Should the importance of correlated recipes be confirmed by further
analysis, it seems likely that the full formulation of such a description would still require to solve this
problem. In order to show explicitly that the model can in principle be successfully extended to many
categories (and still give scaling laws) we have analyzed the case of a simple hierarchical structure where
many categories are slaved to a main one (see Supplementary Figure S8).
Overall, since functional categories scaling laws effectively emerge from the correlated approach, a
good reconciliation of the two approaches could be to interpret the evolutionary potential model as an
emergent description (which can be very useful in concrete empirical applications). In other words,
evolutionary potentials would describe emergent effective growth of functional categories of a genome,
averaging over more “microscopic” evolutionary processes where addition of genes belonging to specific
functional categories needs to comply to constraints combining different functions to perform specific
cell tasks. These kind of interactions between functions are better described by correlated growth of
functional categories. In this view, genome growth would be governed by a relative recipe, where the
proportions are more important than the exact amounts, rather than an absolute recipe, where only the
detailed amounts of each ingredient play a role.

m/tr =metabolism
and transport
p/c =production
and conversion

Energy p/c
E- transfer
Photosynthesis
Amino acids m/tr
Nitrogen m/tr
Coenzyme m/tr
Nucleotide m/tr
Carbohydrate m/tr
Lipid m/tr
Polysaccharide m/tr
Cell envelope m/tr
Secondary metabolism
Redox
Transferases
Other enzymes

Energy p/c
E- transfer
Photosynthesis
Amino acids m/tr
Nitrogen m/tr
Coenzyme m/tr
Nucleotide m/tr
Carbohydrate m/tr
Lipid m/tr
Polysaccharide m/tr
Cell envelope m/tr
Secondary metabolism
Redox
Transferases
Other enzymes

15

1

0.5

0

-0.5

-1

Figure 7. Correlation between the populations of 24 different metabolic functional categories from the
SUPERFAMILY database for 753 bacteria. The correlation matrix is calculated from fluctuations of
categories from the average trend (see Methods). Both correlation and anticorrelation are present
between categories. Different metabolism categories are highly (anti-)correlated.

16

prediction:
domain families scaling

CRP

duplication
Domain classes

innovation

+
Evolutionary
potentials

or

Correlation

different duplication
rates
Evolutionary
potentials

Functional categories

prediction: existence of scaling laws in functional categories

duplication of Leaves
Functional Categories
in a regulation network
Correlation
correlation: a new duplicated
gene must be regulated
prediction: exponent 2 for transcription factors
prediction: relation between categories scaling exponent and
domain families population histograms

Figure 8. Models with correlated versus absolute moves. Top: the Chinese restaurant process (CRP)
acts on the homology families (colors) with a duplication and an innovation move. It is extended here
to include functional categories (shapes) Middle: model with evolutionary potentials. Functional
categories are assigned differential duplication rates as in ref [3]. Bottom: Model with correlated moves.
Members of the functional categories are added proportionally between correlated pairs of functions
(e.g. transcription factors and metabolic targets) as in Ref. [15].

17

References
1. Huynen, M. A. and van Nimwegen, E. (1998) The frequency distribution of gene family sizes in
complete genomes.. Mol Biol Evol, 15(5), 583–9.
2. van Nimwegen, E. (2003) Scaling laws in the functional content of genomes. Trends in Genetics,
19(9), 479–484.
3. Molina, N. and van Nimwegen, E. (2008) The evolution of domain-content in bacterial genomes.
Biology Direct, (3), 51+.
4. Koonin, E. V., Wolf, Y. I., and Karev, G. P. (2002) The structure of the protein universe and
genome evolution.. Nature, 420(6912), 218–23.
5. Dokholyan, N. V., Shakhnovich, B., and Shakhnovich, E. I. (2002) Expanding protein universe and
its origin from the biological Big Bang.. Proc Natl Acad Sci U S A, 99(22), 14132–6.
6. Cosentino Lagomarsino, M., Sellerio, A., Heijning, P., and Bassetti, B. (2009) Universal features
in the genome-level evolution of protein domains. Genome Biology, 10(1), R12+.
7. Perez-Rueda, E., Janga, S., and Martinez-Antonio, A. (2009) Scaling relationship in the gene
content of transcriptional machinery in bacteria.. Molecular Biosystems, DOI: 10.1039/b907384a.
8. Koonin, E. V. and Wolf, Y. I. (2008) Genomics of bacteria and archaea: the emerging dynamic
view of the prokaryotic world. Nucleic Acids Research, 36(21), 6688–6719.
9. Treangen, T. J. and Rocha, E. P. C. (2011) Horizontal transfer, not duplication, drives the expansion of protein families in prokaryotes.. PLoS Genet, 7(1), e1001284.
10. Karev, G. P., Wolf, Y. I., Rzhetsky, A. Y., Berezovskaya, F. S., and Koonin, E. V. (2002) Birth
and death of protein domains: a simple model of evolution explains power law behavior.. BMC
Evol Biol, 2(1), 18.
11. Qian, J., Luscombe, N. M., and Gerstein, M. (2001) Protein family and fold occurrence in genomes:
power-law behaviour and evolutionary model.. J Mol Biol, 313(4), 673–81.
12. Kamal, M., Luscombe, N., Qian, J., and Gerstein, M. (2006) Analytical Evolutionary Model for
Protein Fold Occurrence in Genomes, Accounting for the Effects of Gene Duplication, Deletion,
Acquisition and Selective Pressure. In Koonin, E., Wolf, Y., and Karev, G., (eds.), Power Laws,
Scale-Free Networks and Genome Biology, pp. 165–193 Spinger, New York.
13. Durrett, R. and Schweinsberg, J. (2005) Power laws for family sizes in a duplication model. Ann.
Probab., 33(6), 2094–2126.
14. Angelini, A., Amato, A., Bianconi, G., Bassetti, B., and Cosentino Lagomarsino, M. (2010) Meanfield methods in evolutionary duplication-innovation-loss models for the genome-level repertoire of
protein domains. Phys. Rev. E, 81(2), 021919.
15. Maslov, S., Krishna, S., Pang, T., and Sneppen, K. (2009) Toolbox model of evolution of prokaryotic
metabolic networks and their regulation. Proceedings of the National Academy of Sciences, 106(19),
9743–9748.
16. Isambert, H. and Stein, R. (2009) On the need for widespread horizontal gene transfers under
genome size constraint.. Biology Direct, 4(1), 28+.

18

17. Bornberg-Bauer, E., Beaussart, F., Kummerfeld, S. K., Teichmann, S. A., and Weiner, 3rd, J.
(2005) The evolution of domain arrangements in proteins and interaction networks.. Cell Mol Life
Sci, 62(4), 435–45.
18. Wilson, D., Madera, M., Vogel, C., Chothia, C., and Gough, J. (2007) The SUPERFAMILY
database in 2007: families and function. Nucleic Acids Res, pp. D308–D313 Updated 7/2009.
19. Pitman, J. (2006) Combinatorial Stochastic Process, Notes for St. Flour Summer SchoolSpringerVerlag, Berlin.
20. Anantharaman, V., Koonin, E. V., and Aravind, L. (2001) Regulatory potential, phyletic distribution and evolution of ancient, intracellular small-molecule-binding domains.. J Mol Biol, 307(5),
1271–1292.
21. Chothia, C., Gough, J., Vogel, C., and Teichmann, S. A. (2003) Evolution of the protein repertoire..
Science, 300(5626), 1701–1703.
22. Charoensawan, V., Wilson, D., and Teichmann, S. A. (2010) Genomic repertoires of DNA-binding
transcription factors across the tree of life. Nucleic Acids Research,.

1

Supplementary Text and Figures for Grilli et al.

S1

Description of the model and basic mean-field results

This section discusses in more detail the analytical derivation of the scaling for the main observables of
model I and II using a mean-field approach.
Consider a joint partioning of elementary units (domains or genes) in functional and evolutionary
categories, as illustrated in Figure 1 of the main text. The elementary units (in our case domains),
belong to a single evolutionary family i, and every family i belongs to one and only one functional
category c.
The generic stochastic growth model considered here defines how new units are introduced into the
system. The model is specified by a set of basic rates. The basic set of rates is constitued by the
probabilities pi that a newly added unit belongs to a certain class i. More in detail, we define a probability
piO (where O stands for “old”) that a new domain belongs to a family i which is already present in the
system (i.e. having at least one member) and the probability pN (where N stands for “new”) that the
added unit belongs to a family which is not already present in the system.
The choice of piO and pN defines the model as a stochastic process for the basic observables (such as
genome size n, family number f and its population ni , etc.), but one extra detail is needed. When a
new class is introduced, the model needs to specify the category it belongs to. As discussed in the main
text, in the model considered here a newly added family always belongs to a category c with probability
χc . The probabilities piO , pN and χc can depend, in principle, on the number of units n and on their
distribution in families, on the total number of families f and so on. Empirical data indicate (see Figure 2
in the main text) that χc is a category-dependent constant, and thus does not depend on n.
The mean-field approximation is useful to extract the basic information from the model [6]. In each
realization of the full stochastic process, the probabilities of the possible configurations at time t + 1 are
determined by the configuration at time t. The mean-field approximation assumes that the configuration
at time t is the average configuration. For example, if one is interested in the number of domains belonging
to family i, the average number of elements ni (t + 1) at time t + 1 will be equal to the average number
of elements ni (t) at time t summed with the average number of elements added in a time step, i.e. piO .
For asymptotically large t this implies the approximate equation ∂t ni = piO for the averages (here the
averaging procedure is implicit in the notation). Since typically, at each step one and only one element
is added, the mean number of elements is n = t. If this is not the case, we can obtain ∂n ni simply from
∂t ni divided by ∂t n. Considering n = t we obtain, for a generic model, the following mean-field equations
∂n ni = piO
∂n f = pN
∂n fc = χc pN
X
X
X
∂n nc = ∂n
ni =
∂n ni + ∂n fc =
piO + χc pN .
i∈c

S1.1

i∈c

(S1)

i∈c

Models with correlations

We now deal with the scaling of the basic observables in the model taking into account the correlation
between categories growth (model I of the main text).

2

The correlation appears in the growth of the domain families of different categories. Thus the probability piO that a domain is added to a given family i can be written as
Pf
j=1 ai,j nj − α
i
.
(S2)
pO = Pf
i,j=1 ai,j nj + θ
The coordinated growth of functional categories is encoded by the coefficients ai,j , responsible for the
correlated expansion of evolutionary families i and j (See Equation 1 of the main text). The standard
Chinese Restaurant Process (CRP) is obtained by imposing ai,j = δi,j (where δi,j is equal to 1 if i = j
and 0 otherwise). We assume that these coefficients depend only on the functional categories c and c0 to
which the families i and j belong. The probability of introducing a new domain is given by
αf + θ
.
(S3)
pN = Pf
i,j=1 ai,j nj + θ
S1.1.1

Model Ia.

We consider a model inspired by ref. [15] (the toolbox model, in which the growth of the number of
transcription factors is coupled to the number of added metabolic enzymes), extended to describe a joint
partitioning in functional and evolutionary categories. In the original version of the model the average
increment of the main observables at each time step is

U
∆n
met =
nmet
(S4)
∆n
=1,
TF

and thus ∆nT F /∆nmet = nmet /U , which gives a quadratic scaling for nT F with nmet .
Model Ia is an extension of the toolbox model is formulated following equation S2, by using a proper
definition of ai,j , such as the same equation of the toolbox model is valid. We observe that, for our purpose,
the time step of equation we can be defined arbitrarily, as genome growth is eventually parameterized by
n. Rewriting the equations as
(
∆nmet = nmet
(S5)
,
∆nT F = nmet nmet
U
gives the summed probabilities piO relative to the two categories

X
nmet − αfmet

pmet
:=
piO =
O
C(n)
i∈met
nmet

nmet −αfT F
pT F := P
i
U
,
O
i∈T F pO =
C(n)

(S6)

while

αf + θ
.
C(n)
Accordingly, we extend the model to an arbitrary number of families by the choice ai,j =
i is a T F family and j a metabolic family and zero otherwise. This gives
P

nmet ni

U nT F n j − α
pi = j∈met

if i ∈ T F
Pf
 O
i,j=1 ai,j nj + θ
ni − α

i

if i ∈ met .

pO = Pf
i,j=1 ai,j nj + θ
pN =

(S7)
nmet ni
U nT F

if

(S8)

This model gives the asymptotic quadratic scaling of nT F with nmet by definition, using the exact
same argument as the toolbox model. Other results have been obtained numerically (see Supplementary
Figure S4).

3

S1.1.2

Model Ib.

This second formulation of a model with correlated recipe (model Ib) imposes a different correlation rule.
For example, consider the model involving only two functional categories, transcription factors controlling
metabolic processes and metabolic enzymes.
In this variant the coefficients ai,j have both a diagonal and a non diagonal part, ai,j = δi,j + bi,j .
If b = 0 the model is the standard Chinese Restaurant Process. For this reason, model Ib is simpler to
treat analytically, exploiting previous results. This work focuses mainly on the case bi,j = ni /nmet if
i is a family from the functional category of transcription factors and j is a family from the metabolic
functional category (and bi,j = 0 otherwise).
In this case, the summed probabilities piO relative to the two categories are
P

i
−α
+ j∈met nnmet

p i = n i P

if i ∈ T F
 O
f
i,j=1 ai,j nj + θ
(S9)
ni − α

i

if
i
∈
met.
p
=

P
O
f

i,j=1 ai,j nj + θ
Using the definitions given in Equation S1, one can see that,
C(n)∂n nT F = nT F + nT F − αfT F + C(n)∂n fT F = 2nT F − αfT F + αfT F + θχT F = 2nT F + θχT F , (S10)
while
C(n)∂n nmet = nmet − αfmet + C(n)∂n fmet = nmet + θχmet .

(S11)

Hence, for large n, since ∂n fc = χc pN ' αfc , the terms in the r.h.s. of Equations (S10) and (S11) cancel,
giving the effective equation,
dnT F
2nT F
'
,
(S12)
dnmet
nmet
and thus the scaling nT F ∼ n2met .

S1.2

Model II (model with evolutionary potentials)

This section presents in more detail the uncorrelated version of the model for the joint scaling (model
II), assigning evolutionary potentials [3] ρc to the functional categories, related to the probability that
a gene added in a functional category is fixed by natural selection. This model is an example of an
“absolute recipe”, since each category grows with an intrisic rate ρc , summing up the growth of the
families belonging to the given category. The rate ρc acts on family growth through the class-expansion
move. The probability of class expansion of a family belonging to the category c is equal to
ρc(i) ni − α
piO = Pf
,
j=1 ρc(j) nj + θ

(S13)

where ρc(i) = ρc if the evolutionary family i belongs to the functional category c. This model assumes
that the value of ρc (i) depends only on the category to which family i belongs. The probability that a
domain belonging to category c is added by class expansion is then
X
ρc nc − αfc
pcO :=
piO = Pf
.
(S14)
j=1 ρc(j) nj + θ
i∈c
Equally, the probability that the new domain is introduced by an innovation move (i.e. it belongs to a
new family) is equal to
αf + θ
pN = Pf
.
(S15)
j=1 ρc(j) nj + θ

4

Under the assumption (confirmed by empirical data, see main text) that the growth of old functional
categories by adding new homology families through the innovation move is uniform (i.e. that fc =
Ac + χc f ), the probability that a new family belonging to the category c is added by an innovation move
is
αfc + θχc
αf + θ
= Pf
.
(S16)
pcN := χc pN = χc Pf
j=1 ρc(j) nj + θ
j=1 ρc(j) nj + θ

Evolutionary potentials can reproduce the combined scaling laws at finite sizes.
We tested this model by a combination of mean-field analytical arguments and direct simulation.
The mean-field equations are obtained from Equation S1 by using Equations S13 and S15. The
equation for the growth of the mean number of members nc of a functional category can be obtained
simply by summing on the homology families that belong to a given category,
∂n nc =

ρc nc + θχc
,
C(n)

(S17)

P
where C(n) ' i ρi ni . If C(n) ∼ n, equation (S17) corresponds to the evolution equation written by
Molina and Nimwegen. Simulations of this model (see Supplementary Figure S7) confirm that this is the
case. Thus, the mean-field argument predicts that this model can reproduce both scaling laws.
Also note that a rescaling of C(n) is equivalent to a rescaling of α. Indeed, for large n, pN ' αf /C(n)
(and pO = 1 − pN ), so imposing C(n) ' qn is equivalent to dividing α by the constant factor q. Thus,
one can choose q = 1 without loss of generality (by a rescaling of all the ρc ), and the solution for the
population of a functional category will be nc ∼ nρc /q as in the Molina/Nimwegen model, and thus
ζc = ρc /q
On the other hand, an important point regarding this model is that, asymptotically for any choice
over the P
ρc set, the maximum large-n exponent observed will be 1, Indeed, we can use the approximation
C(n) = i ρi Ni ∼ ρmax nρc /q , but C = qn, so that q = ρcmax . This means that an exponent close to 2,
such as that observed for transcription factors can only be obtained in a transient regime of the model.
Furthermore, the change of the evolutionary potential of one functional category has repercussions on
the other categories, as it implies a change in the normalization costant C. These facts make a direct
identification of the value of the evolutionary potential with an intrinsic propery of a single functional
category difficult. They also make the direct identification of evolutionary potentials less straightforward
(as it requires an arbitrary rescaling).
However, the above remarks have little practical importance, and the large-n behaviour of the model
does not really affect its performance at the relevant values of n. Numerical simulations show that at the
empirical genome sizes, the scaling behaviour of the model can reproduce rather well the empirical one.
For simplicity we have restricted to three main categories (transcription factors, metabolic genes and
“others”) and we verified that in practice it is not hard to find a parameter set in good agreement with
the empirical data on protein domains (Supplementary Figure S3). The general number of parameters
to adjust increases with the number of functional categories that one needs to consider.

S2

Exponents of family size distribution histograms

This section discusses the family size distribution histograms, as obtained from the mean-field approach.
To fix the ideas, we will focus on model Ib, where the mean-field equations can exploit the known
results from the CRP. It is possible to write a mean-field “flux equation” for the histograms [14], which
implements the fact that each duplication adds a family with one extra member to the histogram count
and subtracts a family with its previous population,
∂n f (d, n) = pO (d − 1, n)f (d − 1, n) − pO (d, n)f (d, n) + pN δd,1

(S18)

5
where pO (d, n) = d−α
n+θ is the probability that a family with d domains add a new duplicated member.
αf +θ
The term pN = n+θ contains the innovation probability contributing to the growth of the number of
families with one member. Note that the flow between families can be written as
X

∂n ni = (d − α)





families with

i∈

f (d, n)
.
n+θ

j domains

This equation requires an assumption on f (d, n) in order to be solved. We assume the ansatz f (d, n) =
P (d)f (n) which is justified by both simulation and empirical data [14]. Using the fact that ∂n f (n) = pN ,
combined with Equation S18 gives the following equation for the probability of a family to have d members
αP (d) = (d − 1 − α)P (d − 1) − (d − α)P (d) ,

(S19)

which can be solved in discrete or continuous d to get
P (d) ∼

 1+α
1
.
d

(S20)

This predicts the asymptotic behaviour of data and simulations (see Figure 6) with β = α, where β is
the asymptotic exponent of the family size distribution.
Let us now turn to the same distribution, restricted to transcription factors. In model Ib, the flux
from transcription factor families caused by family expansion is caused by two separate contribution, the
CRP standard one, plus additions of transcription factors to an existing family caused by the addition of
a metabolic enzyme


1
ni
piO (n) =
(ni − α) +
nmet , if i ∈ T F
(S21)
C(n)
nmet
i.e.
piO (n) =

1
[2ni − α] , if i ∈ T F .
C(n)

(S22)

Thus, for the transcription factor families, the probability that a domain is added to a family with d
members will be
1
pTOF (d, n) =
[2d − α] .
(S23)
C(n)
The quantity pTOF (d, n) is the probability that a new transcription factor domain is added to a family
with d members. The flux equation for TF families can be obtained by substituting equation S23 in
equation S18, (for d > 1)
C(n)∂n fT F (d, n) = [2(d − 1) − α] fT F (d − 1, n) − [2d − α] fT F (d, n)

(S24)

This is solved using the usual ansatz fT F (d, n) = PT F (d)fT F (n) (as explained above it is confirmed by
both data and simulations). Using fT F (n) = χT F f (n), leads to the equation
αPT F (d) = (2d − 2 − α)PT F (d) − (2d − α)PT F (d) ,
which gives:
P (d)T F

 1+ α2
1
∼
d

,

(S25)

(S26)

that is β = α/2 = β/2. In the above calculation we have supposed again that the number of transcription
factors is small with respect to to the total number of metabolic enzymes.

6

Furthermore, it can be argued that this fact is more general. Indeed, each time the per-family
duplication probability for the TF functional category will have the form
piO ' 2ni ,
when family i belongs to TF category, the coefficient 2 will appear in the equation for P (d)T F modifying
the exponent. In particular, this will also be true for models Ia (generalizing the toolbox model) and II
(generalizing evolutionary potentials).
In other words, each time a functional category scales with a given exponent, it can be argued on
rather general grounds that the exponent of the population histograms of the homology families that
form it will be affected. It is possible to to generalize this argument, and find a precise relationship
between the scaling exponent of a category and the family population histogram (restricted to the same
category). In other words, if ζc is the scaling exponent of the category c and βc is the exponent of the
cumulative distribution histogram for the families belonging to category c, that is (see Equation S26):
P (d)c ∼

 1+βc
1
,
d

we suggest that βc = β/ζc . We tested this prediction in empirical data plotting 1/βc versus ρc in Figure 6
(Pearson correlation coefficient 0.47).

S3
S3.1

Comparison of models by numerical simulation
Correlated and absolute recipes

This section compares the correlated duplication and the evolutionary potential model variants. We
considered a three categories model (TF, Metabolic and “other”).
The evolutionary potential model needs to supply three parameters ρc , while the correlated model
needs to supply the correlation law between categories (aij ). We impose a correlation only between
transcription factor and metabolic families with the correlated model Ib prescription, i.e.
aij = ni /nmet ,

(S27)

where i is a TF family and j Metabolic, aij = 0 (no correlation) otherwise.
Figure S3 summarizes the results of this comparison. The correlated duplication model performs better
in reproducing the behavior of the transcription factor category (both scaling law and histograms). Both
models are unsatisfactory in reproducing the family population histogram of the metabolism families.
This is probably caused by the fact that neither model include a correlation between metabolic families
(Figure 7).
Figure S7 illustrates the behaviour of the normalization function C(n). C(n) is linear with n in the
range of empirical genome sizes (although the slope is not exactly 1). It becomes nonlinear at larger sizes,
and its linear behavior is restored only at very large values of n.

S3.2

Model I can reproduce a set of different exponents

Extending a model (with absolute or correlated recipe) to a large number of categories is not a simple
task. In the case of an absolute recipe model, adding a new category c0 (and thus introducing a new
evolutionary potential ρc0 ) generally requires, in order preserve the scaling of all the categories, a tuning
of all the evolutionary potentials (both the old ones and the new one). This is due to the fact that all
the evolutionary potentials appear in the normalization constant C(n) in the growth equation of each
category (Equation (S13). In a model with a correlated recipe, the main problem is related to the fact

7

that the interaction laws between categories are not known, they can be complex and possibly include
feedback.
In order to produce the proof of principle that a model with correlated recipes can work with more
than three categories, we considered a trivial generalization of model Ib to multiple categories that are
slaved to a main one, and considered the question of whether this model would be able to reproduce an
arbitrary set of scaling exponents for the categories.
We consider a correlation matrix ai,j of the form δi,j + bi,j , where bi,i = 0. This model deals with C+1
categories, the met category (in analogy with model Ib defined in the main text, this is a category whose
growth is not conditioned to the others), and an additional set of C categories labeled from 1 to C. The
non diagonal correlation coefficients bi,j are zero if family i belongs to the met category, and γc(i) ni /nmet
if family i belongs to category c, different from met, and j belongs to the met category. Substituting this
choice in equation S9, gives
nc
dnc
= (1 + γc )
(S28)
dnmet
nmet
and thus
c
nc ∼ n1+γ
met .

(S29)

Supplementary Figure S8 shows simulations from a model with 10 + 1 categories. The model is able to
reproduce an arbitrary set of exponents. We observe that this version has similar problems as the model
with evolutionary potentials, as, in absence of a biological underlying model, it needs the tuning of a
set of parameters to reproduce the scaling laws. The fitted exponent is typically different from 1 + γc ,
specifically it seems to be closer to one. We interpret this as a finite size effect, due to the fact that the
contribution of innovation to the scaling exponents is relevant.

S4

Details of TF-domain superfamily scaling

We observe that the quadratic (or very nearly so) scaling for transcription factors is clearly visible at in
the two most populated families of transcription factor DNA-binding domains (Homeodomain-like and
Winged-helix), which have a rather clean slope (see Supplementary Figure S10). In fact, three families
present a clearly observable scaling alone (Homeodomain-like, Winged-helix and C-terminal), but just
the first two follow a very nearly quadratic scaling.
Note however that removing the six most populated TF families, representing 80% of the total TFdomain population, the remaining ones considered together still present a scaling when added up, but
with exponent ' 0.9 (see Supplementary Figure S11). This indicates that the collective scaling of TF
families cannot be entirely recunducted to properties of the most populated ones, but these are the
families responsible for the quadratic scaling.
Thus, the “pure” quadratic scaling is observable in the largest transcription factor families. Collecting
all the families, wemeasure a lower exponent in empirical data (close to 1.6). Supplementary Figure S11
explains this behavior, showing the total contribution of the smaller transcription factor families. These
families collectively show a lower exponent (close to 1). Thus, we can interpret the lower collective
exponent as an effect of family size (i.e., in the language of statistical mechanics, a “finite-size” effect)
connected to the fact that for smaller family size, the innovation move is more relevant and thus the
family expansion process is slower. The same effect is present in our simulations (see Supplementary
Figure S12.)

8

Families in Functional Category

400

300

Translation
Regulation of Transcription
Metabolic Processes

200

100

0
0

400
Total Number of Families

800

Supplementary Figure S1. Scaling of the number of families in the three main functional
categories. Linear scaling behaviour of the number of families in three important functional categories
versus total number of families from empirical data (for 753 bacteria in the SUPERFAMILY database).
The slopes for the three linear laws are 0.01 (Translation), 0.03 (Regulation of Transcription) and 0.47
(Metabolic Processes).

Number of TF Families

9

25
20
15
10
5
200

300 400 500 600 700
Total number of classes

800

Supplementary Figure S2. Transcription factor families. Boxplot of the number of
transcription factor domain families versus total number of domain families (data from 753
SUPERFAMILY bacteria). There appears to be a roughly linear scaling. This means that the number
of TF domain families is compatible with a null hypothesis of independent addition model.
Charoensawan et al [22] propose that the number of TF families follows a linear scaling with genome
size. If this were to be the case, the innovation dynamics of transcription factor families should be
distinct form other families. In fact, if fT F (n) ∼ n, since the total number of families is sublinear,
f (n) ∼ nα in the CRP (Figure 1), then one would have fT F f 2−α , which is not confirmed by the
SUPERFAMILY data analyzed here.

10

1

100

1000

Number of Metabolic Domains

1000

B

100

C

0,1

Transcription Factor
1

10

100

Number of Domains D

1000

1

Metabolic
0,1

D
0,01

0,001
1

10

100

Number of Domains D

1000

+ Evolutionary
Potential

1000

100

10

100

1000

Number of Metabolic Domains

1000

100
100

1000

Number of Domains

1

0,01

Number of Transcription Factors Domains

10

Number of Metabolic Domains

A

100

Families with more than D Domains

Families with more than D Domains

CRP

1000

100

Families with more than D Domains

+ Correlation

Families with more than D Domains

Number of Metabolic Domains

Number of Transcription Factors Domains

CRP

1000

Number of Domains

1

0,1

Transcription Factor
0,01
1

10

100

Number of Domains D

1000

1

Metabolic
0,1

0,01

0,001
1

10

100

Number of Domains D

1000

Supplementary Figure S3. Comparison between models Ib and II. Comparison between
simulation of the correlated duplication model Ib (left panel) and evolutionary potentials (right panel)
model variants with empirical data. Simulations are run at α = 0.3 and θ = 140. (a) Number of TFs
domains vs. number of metabolic domains (the blue boxplot corresponds to simulations, red circles to
empirical data). (b) Number of metabolic domains vs. total number of domains (the blue boxplot
corresponds to simulations, red circles to empirical data). (c) Family population histograms restricted
to the transcription factor functional category (black circles are simulations, magenta lines empirical
data). (d) Family population histograms restricted to the metabolism functional category (black circles
are simulations, magenta lines empirical data).

2000

10000

A

1500

Number of Families

Number of Transcription Factor Domains

11

1000

1000

100

10

1
10

500

0
0

100
1000
10000
Number of Metabolic Domains
Families with more than D domains

Families with more than D domains

-0.5
0.1

-1.5

0.01

0.0001
1

2000
4000
6000
Total Number of Domains

8000

1

1

0.001

B

C
10

100

Number of Domains D

1000

-0.2

0.1

0.01
1

-1

D
10

100

Numbero of Domains D

1000

Supplementary Figure S4. Simulations of the correlated duplication model Ia for two
categories (transcription factors and metabolic enzymes). The plots are obtained from 1000
realizations with α = 0.3, θ = 140 and U = 7000. The observables are the same as in figure S3. (a)
scaling of the number of transcription factors with the number of metabolic enzymes. (b) Number of
families as a function of genome size n. (c) Family population (cumulative) histograms. (c) Family
population histograms restricted to the families belonging to the transcription factor functional
category.

12

a)

6000

4000

2000

0
0

b)

800
Number of Tf Domains

Number of Domains

8000

600

400

200

0

1000

2000

3000

4000

Number of Genes

5000

6000

0

200

400

600

800

Number of Tf Genes

Supplementary Figure S5. Linear relation between the number of domains and the
number of genes. (a) Number of Domains vs. number of protein-coding genes for the 753 bacteria in
the SUPERFAMILY database. There are, on average, 1.45 domains per gene. (b) Linear scaling
behaviour of the number of TF domains vs. number of TF genes. There are, on average, 1.09 TF
domains in a TF gene.

Domains in Functional Category

40

30

20

10

0

200

400
600
Number of Domains

800

Supplementary Figure S6. Simulation of the number of transcription factor families.
Comparison between empirical data and simulations of the number of transcription factor domain
families plotted against total number of families. The scaling is empirically linear, i.e. the number of
TF domain families is reproduced by a null hypothesis of independent addition model. The choice of
the parameter is 0.035.

13

1,5

1,5

Biological sizes

1,4

1,4

C(n)/n

C(n)/n

Large n behaviour
1,3
1,2
1,1
1
0

1,3
1,2
1,1

2000

4000
6000
8000
Number of Domains

10000

1
0

1e+06

2e+06 3e+06 4e+06
Number of Domains

5e+06

Supplementary Figure S7. Normalization constant inthe model with evolutionary
potentials (model II). Behavior of the ratio C(n)/n, where C(n) is the normalization factor for the
evolutionary potential model. Data from simulations with three categories run at parameters α = 0.3
and θ = 140. C(n) is linear with n in the range of empirical genome sizes, it then looses linearity, to
become linear only asymptotically.

14

10000

A

Domains in functional category

Domains in functional category

10000

1000

100

10

1
100

1000
Genome size

100

10

1000
Genome size

10000

1000

C

Domains in functional category

Domains in functional category

1000

1
100

10000

10000

1000

100

10

1
100

B

1000
Genome size

10000

D
100

10

1
100

1000
Genome size

10000

Supplementary Figure S8. Simulation of model Ib with 10 + 1 categories. 10 categories are
slaved to one master category with different correlation laws, which determine the observed exponents).
Panel A, B and C show the simulations of the population of three categories (respectively with γc equal
to 1, 0 and −0.7). The red lines are power-law fits of the simulated data. Panel D shows the power-law
fits of the simulated data for all ten categories.

Energy p/c
E- transfer
Photosynthesis
Amino acids m/tr
Nitrogen m/tr
Coenzyme m/tr
Nucleotide m/tr
Carbohydrate m/tr
Lipid m/tr
Polysaccharide m/tr
Cell envelope m/tr
Secondary metabolism
Redox
Transferases
Other enzymes

m/tr =metabolism
and transportation
p/c =production
and conversion

Energy p/c
E- transfer
Photosynthesis
Amino acids m/tr
Nitrogen m/tr
Coenzyme m/tr
Nucleotide m/tr
Carbohydrate m/tr
Lipid m/tr
Polysaccharide m/tr
Cell envelope m/tr
Secondary metabolism
Redox
Transferases
Other enzymes

15

1

Energy p/c
E- transfer
Photosynthesis
Amino acids m/tr
Nitrogen m/tr
Coenzyme m/tr
Nucleotide m/tr
Carbohydrate m/tr
Lipid m/tr
Polysaccharide m/tr
Cell envelope m/tr
Secondary metabolism
Redox
Transferases
Other enzymes

Energy p/c
E- transfer
Photosynthesis
Amino acids m/tr
Nitrogen m/tr
Coenzyme m/tr
Nucleotide m/tr
Carbohydrate m/tr
Lipid m/tr
Polysaccharide m/tr
Cell envelope m/tr
Secondary metabolism
Redox
Transferases
Other enzymes

size < 4000

0.5

0

-0.5

-1

size > 4000

Supplementary Figure S9. Correlation matrix for two sets of genomes with different
sizes. Left panel: Correlation matrix for genomes with size < 4000. Right panel: Correlation matrix
for genome with size > 4000. The correlations do not depend on size.

16

100

Homeodomain-like
Number of domains

Number of domains

Winged helix
DNA-binding domain

10

100

10

1

1
1000
Total number of domains

10000

1000
Total number of domains

100

Lambda repressor-like
DNA-binding domains
Number of domains

Number of domains

C-terminal effector domain
of the bipartite response regulators

10

100

10

1

1
1000
Total number of domains

10000

1000
Total number of domains

Number of domains

100

10

10000

Transposase IS200-like

Periplasmic binding protein-like I
Number of domains

10000

1

100

10

1
1000
Total number of domains

10000

1000
Total number of domains

10000

Supplementary Figure S10. Most populated transcription factor superfamilies. Boxplots
for the population of the six most populated superfamilies of TF DNA-binding domains (y-axis in each
panel) versus number of domains of each genome (x-axis in each panel). The presence of scaling laws
appears likely for the three most populated families and arguable for the first five. Red lines represent
best power law fit (1.8 for Winged Helix ,2.1 for Homeodomain-like and 1.7 for C-terminal effector)

17

700

Number of domains

600
500
400
300
200
100
0
0

2000
4000
6000
Total number of domains

8000

Supplementary Figure S11. Scaling of the least populated transcription factor
superfamilies. Collective scaling of the number of transcription factor domains after removing the six
globally most populated families. While a few genomes show large fluctuations from the typical trend, a
clear scaling is still observable for most genomes, with a fitted exponent equal to 0.9

Fitted Exponent of TF vs Metabolic

18

1.9

1.8

1.7

1.6

1.5
0

50000
1e+05
1.5e+05
Maximum genome size

2e+05

Supplementary Figure S12. MARCO Finite-size effects on the scaling exponent ζT F for
transcription factors in simulations of model Ib. The plot shows the fitted exponent (y-axis)
from the curve of the number of transcription factor domains versus the number of metabolic enzymes
in 500 simulated realizations of model Ib with parameter α = 0.3 and θ = 140. Each point on the x-axis
corresponds to simulated data stopped at a given size n. The mean-field prediction (ζT F = 2) is reached
only in the limit n → ∞. This plot shows that the fitted exponent 1.6 (instead of 2) for the growth of
transcription factors vs metabolic domains is due to a finite-size effect of a process that produces an
exponent 2 in the large-n limit. The same effect is present in models Ia and II.

Ratio between histogram exponents

19

3
2.5
2
1.5
1
0.5
0
0

2000
4000
6000
Total number of domains

8000

Supplementary Figure S13. Ratio between exponents of family population histograms.
The plot reports the ratio β/βT F between the exponent of the total family population histograms and
the histograms restricted to the transcription factor families (see Figure 5 in the main text), as a
function of genome size. The values of the ratio are distributed around 1.6 and the fluctuation range
decreases with increasing genome size.

20

Supplementary Table S1. Fitted values of χc and offsets Ac from fc vs f for the ten largest
functional categories

Transcription Factors
Translation
Small molecule binding
Nucleotide transport and metabolism
DNA replication/repair
Inorganic ion transport and metabolism
Redox
Transferases
Other enzymes
Signal transduction

Ac
2.2 ± 0.4
61.0 ± 0.35
3.0 ± 0.2
5.6 ± 0.3
9.5 ± 0.6
0.2 ± 0.4
−7.6 ± 0.5
5.3 ± 0.2
−14.8 ± 1.1
−3.2 ± 0.3

χc
0.0267 ± 0.0006
0.0133 ± 0.0006
0.01 ± 0.0002
0.02 ± 0.0005
0.0437 ± 0.0009
0.0272 ± 0.0005
0.0592 ± 0.0008
0.0213 ± 0.0004
0.155 ± 0.002
0.0282 ± 0.0005

Reduced chi square
4.5
3.9
0.9
3.1
9.8
3.5
7.9
1.6
35.7
3.3

The number of evolutionary families belonging to a functional category follows a linear law in empirical
data. The table reports fits of fc = Ac + χc f from the plots in Figure 2 of the main text, where fc
represents the number of families in category c on all genomes and f is the total number of families on
the genome. The third column is the reduced chi square.

Supplementary Table S2. Data of fitted exponents from Figure 6 of the main text, for the
ten largest functional categories

Transcription Factors
Translation
Small molecule binding
Nucleotide transport and metabolism
DNA replication/repair
Inorganic ion transport and metabolism
Redox
Transferases
Other enzymes
Signal transduction

ζc
1.6 ± 0.02
0.176 ± 0.003
0.918 ± 0.006
0.61 ± 0.01
0.54 ± 0.01
1.40 ± 0.02
1.3 ± 0.01
1.09 ± 0.01
1.09 ± 0.01
1.77 ± 0.03

βc
0.47 ± 0.01
1.46 ± 0.02
0.25 ± 0.01
0.71 ± 0.01
0.9 ± 0.01
0.46 ± 0.01
0.52 ± 0.02
0.43 ± 0.01
0.64 ± 0.01
0.4 ± 0.01

21

Supplementary Table S3. Correlation coefficients between the populations of metabolic
functional categories
En
ePh
Aa
N
Co
Nu
Ca
Li
Ps
Ce
2M
Rx
Tr
Ot

En
1
0.14
0.07
0.55
0.23
0.36
0.19
−0.06
−0.08
−0.14
0.02
0.22
0.31
−0.10
−0.004

e0.14
1
0.29
0.15
0.11
0.43
−0.09
−0.52
0.35
−0.29
0.13
0.19
0.47
0.09
0.05

Ph
0.07
0.29
1
0.12
0.21
−0.02
−0.09
−0.16
−0.21
0.14
−0.18
0.15
0.06
0.16
−0.05

Aa
0.55
0.15
0.12
1
0.08
0.39
0.19
−0.14
−0.07
−0.22
0.01
0.07
0.40
0.02
0.14

N
0.23
0.11
0.21
0.08
1
−0.13
−0.08
−0.003
−0.14
−0.09
0.09
0.26
0.04
−0.03
−0.02

Co
0.36
0.43
−0.02
0.39
−0.13
1
0.14
−0.33
0.44
−0.37
−0.04
0.08
0.51
0.12
0.16

Nu
0.19
−0.09
−0.09
0.19
−0.08
0.14
1
−0.03
−0.09
−0.10
−0.02
−0.10
0.03
−0.11
−0.13

Ca
−0.06
−0.52
−0.16
−0.14
−0.003
−0.33
−0.03
1
−0.20
0.53
−0.18
0.02
−0.46
−0.11
0.16

Li
−0.08
0.35
−0.21
−0.07
−0.14
0.44
−0.09
−0.20
1
−0.35
0.15
0.18
0.06
0.13
0.20

Ps
−0.14
−0.29
0.14
−0.22
−0.09
−0.37
−0.10
0.53
−0.35
1
−0.12
−0.05
−0.36
0.09
−0.07

Ce
0.02
0.13
−0.18
0.01
0.09
−0.04
−0.02
−0.18
0.15
−0.12
1
−0.0002
0.01
−0.22
−0.31

2M
0.22
0.19
0.15
0.07
0.26
0.08
−0.10
0.02
0.18
−0.05
−0.0002
1
−0.11
0.20
0.08

Rx
0.31
0.47
0.06
0.40
0.04
0.51
0.03
−0.46
0.06
−0.36
0.01
−0.11
1
−0.10
0.14

Tr
−0.10
0.09
0.16
0.02
−0.03
0.12
−0.11
−0.11
0.13
0.09
−0.22
0.20
−0.10
1
0.17

Ot
−0.004
0.05
−0.05
0.14
−0.02
0.16
−0.13
0.16
0.20
−0.07
−0.31
0.08
0.14
0.17
1

Pearson’s correlation coefficients between the populations of 24 different metabolic functional categories
from the SUPERFAMILY database for 753 bacteria. Correlations are calculated from fluctuations of
categories from the average trend (see Methods). Both correlation and anticorrelation are present
between categories. Metabolism categories are highly (anti-)correlated. We used the following short
forms for the metabolic functional categories: En = Energy p/c, e- = Electrons transfer, Ph =
Photosynthesis, Aa = Amino acids m/tr, N = Nitrogen m/tr, Co = Coenzyme m/tr, Nu = Nucleotide
m/tr, Ca = Carbohydrate m/tr, Li = Lipid m/tr, Ps = Polysaccharide m/tr, Ce = Cell envelope m/tr,
2M = Secondary metabolism, Rx = Redox, Tr = Transferases, Ot = Other enzymes. Where m/tr
stands for “metabolism and trasportation” and p/c means “production and conversion”.
Supplementary Table S4. P-Values of correlation coefficients between the populations of
metabolic functional categories
En
ePh
Aa
N
Co
Nu
Ca
Li
Ps
Ce
2M
Rx
Tr
Ot

En
0
5 · 10−5
0.02
< 10−6
< 10−6
< 10−6
< 10−6
0.05
0.01
4 · 10−5
0.26
< 10−6
< 10−6
4 · 10−3
0.46

e5 · 10−5
0
< 10−6
2 · 10−5
1 · 10−3
< 10−6
8 · 10−3
< 10−6
< 10−6
< 10−6
3 · 10−4
1 · 10−6
< 10−6
7 · 10−3
0.08

Ph
0.02
< 10−6
0
1 · 10−3
< 10−6
0.29
2 · 10−3
< 10−6
< 10−6
2 · 10−4
< 10−6
5 · 10−5
0.06
2 · 10−5
0.08

Aa
< 10−6
2 · 10−5
1 · 10−3
0
0.02
< 10−6
2 · 10−6
4 · 10−5
0.02
< 10−6
0.39
0.03
< 10−6
0.28
5 · 10−5

N
< 10−6
1 · 10−3
< 10−6
0.02
0
2 · 10−4
0.01
0.47
7 · 10−5
5 · 10−3
8 · 10−3
< 10−6
0.13
0.18
0.31

Co
< 10−6
< 10−6
0.29
< 10−6
2 · 10−4
0
1 · 10−4
< 10−6
< 10−6
< 10−6
0.13
0.02
< 10−6
2 · 10−4
4 · 10−6

Nu
< 10−6
8 · 10−3
2 · 10−3
2 · 10−6
0.01
1 · 10−4
0
0.20
5 · 10−3
3 · 10−3
0.26
3 · 10−3
0.17
8 · 10−4
9 · 10−5

Ca
0.05
< 10−6
< 10−6
4 · 10−5
0.47
< 10−6
0.20
0
< 10−6
< 10−6
< 10−6
0.30
< 10−6
8 · 10−4
7 · 10−6

Li
0.01
< 10−6
< 10−6
0.02
7 · 10−5
< 10−6
5 · 10−3
< 10−6
0
< 10−6
3 · 10−5
< 10−6
0.06
3 · 10−4
2 · 10−6

Ps
4 · 10−5
< 10−6
2 · 10−4
< 10−6
5 · 10−3
< 10−6
3 · 10−3
< 10−6
< 10−6
0
5 · 10−4
0.07
< 10−6
6 · 10−3
0.03

Ce
0.26
3 · 10−4
< 10−6
0.39
8 · 10−3
0.13
0.26
< 10−6
3 · 10−5
5 · 10−4
0
0.50
0.38
< 10−6
< 10−6

2M
< 10−6
1 · 10−6
5 · 10−5
0.03
< 10−6
0.02
3 · 10−3
0.30
< 10−6
0.07
0.50
0
8 · 10−4
< 10−6
0.01

Rx
< 10−6
< 10−6
0.06
< 10−6
0.13
< 10−6
0.17
< 10−6
0.06
< 10−6
0.38
8 · 10−4
0
3 · 10−3
4 · 10−5

Tr
4 · 10−3
7 · 10−3
2 · 10−5
0.28
0.18
2 · 10−4
8 · 10−3
8 · 10−4
3 · 10−4
6 · 10−3
< 10−6
< 10−6
3 · 10−3
0
1 · 10−6

Ot
0.46
0.08
0.08
5 · 10−5
0.31
4 · 10−6
9 · 10−5
7 · 10−6
2 · 10−6
0.03
< 10−6
0.01
4 · 10−5
1 · 10−6
0

P-values of the Pearson’s correlation coefficients between the populations of 24 different metabolic
functional categories from the SUPERFAMILY database for 753 bacteria (the most significant values
are in boldface). Correlations are calculated from fluctuations of categories from the average trend (see
Methods). The (anti-)correlation is statistically significant for the most of the metabolic categories. We
used the following short forms for the metabolic functional categories: En = Energy p/c, e- = Electrons
transfer, Ph = Photosynthesis, Aa = Amino acids m/tr, N = Nitrogen m/tr, Co = Coenzyme m/tr, Nu
= Nucleotide m/tr, Ca = Carbohydrate m/tr, Li = Lipid m/tr, Ps = Polysaccharide m/tr, Ce = Cell
envelope m/tr, 2M = Secondary metabolism, Rx = Redox, Tr = Transferases, Ot = Other enzymes.
Where m/tr stands for “metabolism and trasportation” and p/c means “production and conversion”.

