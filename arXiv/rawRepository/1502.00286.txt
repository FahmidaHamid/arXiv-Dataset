Analysis of single particle trajectories: when things go wrong
D. Holcman∗ 1 , N. Hoze∗1 , and Z. Schuss∗

arXiv:1502.00286v1 [physics.bio-ph] 1 Feb 2015

∗ corresponding

2

authors: david.holcman@ens.fr, hoze@biologie.ens.fr and schuss@post.tau.ac.il

To recover the long-time behavior and the statistics of molecular trajectories from the large
number (tens of thousands) of their short fragments, obtained by super-resolution methods
at the single molecule level [1, 2], data analysis based on a stochastic model of their nonequilibrium motion is required. Recently, we characterized the local biophysical properties
underlying receptor motion based on coarse-grained long-range interactions, corresponding
to attracting potential wells of large sizes [3], as predicted theoretically in [4, 5] (see also [6]
for corrals). The purpose of this letter is to point out what was done and not done in [7] on
this subject.
Parameter estimation
The new paper of Masson et al. [7] presents a comparable study of glycine receptors at
inhibitory synapses. It is our aim here to clarify some issues that arise from the analysis
and simulations presented there. In particular, [7] asserts that“the method used in Hoze et
al. (9), also based on a combination of high-density single-molecule imaging and statistical
inference, evaluates the diffusion and drift by computing the maximal likelihood estimation
in a mesh square as described in Türkcan et al. (7).” This statement may be misleading,
because the analysis of [3] does not concern “maximal likelihood estimation.” The analysis of
[3] is based on the assumption that the molecular motion is a diffusion process, whose local
drift and diffusion coefficients are estimated from local conditional moments of the available
many fragments of the trajectories. The estimates in [3] are the standard non-parametric
empirical estimates of the drift and diffusion coefficients known for decades [8, 9, 10, 11].
Thus the analysis presented in Türkcan et al [12], which was actually published after [3] has
been sent for publication, does not directly concern the issue at hand.
The physical model of a receptor motion on a homogenous surface is the overdamped limit
of the Saffman-Delbrück-Langevin model [13], [14]. Specifically, the diffusion of a receptor
embedded in a membrane surface is generated by a diffusion coefficient D and a field of force
F (X),
Ẋ =

F (X) √
+ 2D ẇ,
γ

(1)

where ẇ is a vector of independent standard δ-correlated Gaussian white noises and γ is
the dynamical viscosity [11]. However, the trajectory fragments are not collected on the
microscopic time-scale of (1), but rather on a coarser time-scale of the recording apparatus
that coarse-grains short events that are due to crowding organization of a variety of obstacles.
Thus (1) is coarse-grained on a coarser spatiotemporal scale into an effective stochastic
equation as (see [16])
√
Ẋ = b(X) + 2B e (X) ẇ,
(2)
1
2

Ecole Normale Supérieure, 46 rue d’Ulm 75005 Paris, France.
Department of Applied Mathematics, Tel-Aviv University, Tel-Aviv 69968, Israel

1

with the empirical drift field b(X) and diffusion matrix B e (X), where the effective diffusion
tensor D e (X) = 12 B e (X)B Te (X) can be expressed in terms of the more microscopic diffusion
coefficient D and in terms of the density and geometry of obstacles. The observed effective
diffusion tensor needs not be isotropic and can be state dependent, whereas the friction
coefficient γ remains constant. Obviously, the impenetrable obstacles that slow the effective
diffusion down affect neither the microscopic physical properties of the diffusing particle nor
those of the membrane. Note that the effective field b(X) may have no potential (see [10]).
Theoretically, the coefficients of (1) can be statistically estimated at each point X =
(X , X 2 )T of the membrane from an infinitely large sample of its trajectories in the neighborhood of the point X at time t. Specifically, setting ∆X(t) = X(t + ∆t) − X(t), the
infinitesimal coefficients are given by the limits of the expectations [10], [11]
1

E[∆X(t) | X(t) = X]
b(X) = lim
,
∆t→0
∆t

E[∆X(t)T ∆X(t) | X(t) = X]
DI = lim
.
∆t→0
2∆t

(3)

In practice, the expectations are estimated by finite sample averages and ∆t is the timeresolution of the recording of the trajectories, as described in [3]. Thus the estimates [7]
seem overly optimistic as far as the relation between the theoretical and the sampled trajectories is concerned. By definition, the moment estimation in (3) requires small fragments
of trajectories passing through each point of the membrane surface, which is precisely the
massive data generated by the sptPALM method [1, 2] on biological samples. The empirical
estimator defined by (3) has been used over the past 60 years in signal processing [11] and
recently applied in several cell biology contexts [17]. The empirical estimator used in [16] is
optimal as its variance is minimal and equals to the Cramér-Rao lower bound, as shown in
section IIIE of [17], using numerical simulations. This approach is clearly different from the
Bayesian method (see formula 6 in [7] and previous publications).
A positive point of the manuscript [7] is the attempt to include in the analysis the influence of the Gaussian instrumental noise on the localization of moving receptors and thus on
their trajectories. However, the variance term in formula 6 of [7] is inapplicable to sort out
the biophysical parameters when there is a force or a drift component that can vary significantly in space. This is indeed the case at potential wells. The additional term, needed in
formula 6 of [7] appears in the direct estimation of the variance E ((X n+1 − X n )2 |X n = X)
and is proportional to the Laplacian of a potential well ∆V , multiplied by the variance of
the localization precision. Finally, the motion blur due to the open camera shutter during
acquisition can also be included in the analysis, as recently discussed in [17].
The potential energy
The fluctuation-dissipation principle invoked in [7] expresses the relation between the local friction acting on the diffusing receptor and the diffusion coefficient. This relation is
microscopic and is a part of the collision model of diffusion. The observed coarse-grained
dynamics, which depends on obstacle density and may vary spatially, while friction remains
constant, should not be expected to obey the fluctuation-dissipation principle [18]. Formula
1 of [7] postulates that the friction coefficient is an average with respect to the obstacle
density, which leads to a coarse-graining approximation, incompatible with the local interpretation that the potential creates by local molecular interactions (which can extend only to
2

few nanometers). This interpretation is thus inconsistent with the hundreds-of-nanometers
size of the effective potential well described in Fig. 3a of [7]. As described above, the effective field b(X) that accounts for local traps [5] may have no potential at all. The relation
between the local molecular energy and the size and depth of the potential well remains
unclear.
Energy maps
The purpose of estimating the drift term is to clarify whether forces other than diffusion
contribute to the dynamics. In this respect, although a clear large locally confining potential
well was presented in [7], it is not clear what is the meaning of the energy map presented
in Fig. 2c and f. Potential interactions are local and the force is due to the gradient of the
potential, thus a large region with given constant energy indicates pure Brownian motion in
this region, without interactions with any field. Is the energy actually calibrated or extracted
from data?
Simulations
Another unclear point of the paper [7] is the role, goal, and the construction of the simulations. The statement ”Fokker-Planck equations can always be approximated by master
equations” seems to indicate that the observed drift vector and diffusion tensor, which may
be space and time-dependent, are known in the entire domain for all relevant times, which
may be quite long. The Fokker-Planck equation (FPE) can be extracted from its global
empirical solution, which is not contained in the empirical data. Thus the only way to
extract a FPE from the data is to estimate the coefficients from the data, as described in
[3]. Simulations of long trajectories of the assumed diffusion process can be run once the
coefficients have been estimated in the entire domain. The approximations of the solution of
the FPE proposed in [7] is a path integral that requires entire trajectories, not only disjoint
fragments. The statement ”these simulated trajectories [...] characteristics match those of
the experimental ones” should be clarified, because theoretically, all diffusion processes may
have the same trajectories, but with different probabilities. Thus simulated trajectories do
not ”match” empirical trajectories. What can be matched are various statistics of the trajectories, though it is not enough to match moments, because statistics, such as first passage
times, which may be rare events, cannot be extracted from short simulations and certainly
not from short fragments of trajectories. The computation of the MFPT of a given diffusion
process to a boundary requires either solving the Pontryagin-Andronov-Vitt boundary value
problem [10] or running Brownian simulations, once the drift and diffusion tensor have been
estimated. But it cannot be computed from the solution of the Fokker-Planck equation in
free space, because absorbing boundary conditions are necessary. A new approach based on
stochastic simulations in the entire dendrite is developed in [15].
Finally, estimating biophysical quantities, such as the first and second moments from the
path-integral approach used in [7] may introduce another computational bias: using entire
trajectories instead of two consecutive points from the same trajectory to compute these
moments results in an estimation procedure that smoothes out the values of the diffusion
coefficient. The diffusion coefficients and energy extracted in [7] are significantly lower and
smoother than the ones presented in [3]. It is not clear whether this is a consequence of the
method of [7] or it captures the biophysical reality of inhibitory receptor trafficking.

3

References
[1] Manley, S. et al. (2008), ”High-density mapping of single molecule trajectories with
photoactivated localization microscopy.” Nat. Methods 5:155–157.
[2] Giannone, G. et al. (2010), ”Dynamic superresolution imaging of endogenous proteins
on living cells at ultra-high density.” Biophys. J. 99:1303–1310.
[3] Hoze, N. et al. (2012), ”Heterogeneity of receptor trafficking and molecular interactions
revealed by superresolution analysis of live cell imaging,” Proc. Natl. Acad. Sci. USA
109: 17052–17057.
[4] Holcman, D., Z. Schuss (2004), ”Escape through a small opening: receptor trafficking
in a synaptic membrane,” J. Stat. Phys. 117 (5/6), pp.191–230.
[5] Taflia, A. and D. Holcman (2007), ”Dwell time of a Brownian molecule in a microdomain
with traps and a small hole on the boundary,” J. Chem. Phys. 126, 234107; doi:
10.1063/1.2746840
[6] Saxton, M.J. (1995), ”Single-particle tracking: effects of corrals.” Biophys. J. 69, 389–
398.
[7] Masson, J.B. et al. (2014), ”Mapping the energy and diffusion landscapes of membrane
proteins at the cell surface using high-density single-molecule imaging and Bayesian
inference: Application to the multiscale dynamics of glycine receptors in the neuronal
membrane.” Biophys. J. 106 (1), pp.74–83.
[8] Karlin, S. and H.M. Taylor (1981), A Second Course in Stochastic Processes. Gulf
Professional Publishing pp. 159–161
[9] Schuss, Z. (1980), Theory and Applications of Stochastic Differential Equations, Wiley
Series in Probability and Statistics - Applied Probability and Statistics Section, NY
[Hardcover].
[10] Schuss, Z. 2010, Theory and Applications of Stochastic Processes: An Analytical Approach. Applied Mathematical Sciences vol.170, Springer NY.
[11] Schuss, Z. (2011), Nonlinear Filtering and Optimal Phase Tracking. Applied Mathematical Sciences vol. 180, Springer NY.
[12] Türkcan, S., A. Alexandrou and J.-B. Masson (2012), ”A Bayesian inference scheme
to extract diffusivity and potential fields from confined single-molecule trajectories.”
Biophys. J. 102, pp.2288–2298.
[13] Saffman, P.G. and M. Delbrück (1975), ”Brownian motion in biological membranes.”
Proc. Natl. Acad. Sci. 72, pp.3111–3113.
[14] Saffman, P.G. (1976), ”Brownian motion in thin sheets of viscous fluid,” J . Fluid Mech.
73 (4), pp.593–602.
4

[15] Hoze, N., D. Holcman (2014), Biophys. Journ. (in press) 16, 107, Issue 12.
[16] Hoze, N., D. Nair, E. Hosy, C. Sieben, S. Manley, A. Herrmann, J.B. Sibarita, D.
Choquet, D. Holcman (2012), Proc. Natl. Acad. Sci. USA 109, pp.17052–17057.
[17] Verstergaard, C.L., P. Blainey and H. Flyvbjerg (2014), ”Optimal estimation of diffusion
coefficients from single-particle trajectories.” Phys. Rev. E, 89, 022726.
[18] Holcman, D., N. Hoze, Z. Schuss 2011, ”Narrow escape through a funnel and effective
diffusion on a crowded membrane,” Phys. Rev. E, 84 (2-1):021906.

5

