arXiv:1411.4624v2 [q-bio.MN] 22 Feb 2015

A Coupled Stochastic Model Explains Differences
in Circadian Behavior of Cry1 and Cry2 Knockouts
John H. Abel1 , Lukas A. Widmer2 , Peter C. St. John1 , Jörg Stelling2 , and
Francis J. Doyle III1,*
1 Department

of Chemical Engineering, University of California Santa Barbara,
Santa Barbara, California 93106-5080
2 Department of Biosystems Science and Engineering, ETH Zürich, and
Swiss Institute of Bioinformatics, 4058 Basel, Switzerland
* Email: doyle@engineering.ucsb.edu
February 24, 2015

Classification:
Quantitative Biology | Molecular Networks
Keywords:
Systems Biology | Circadian Rhythms | Stochastic Systems

1

1

Introduction

Circadian rhythmicity in gene expression affects a wide variety of biological processes at multiple
scales, including sleep-wake cycles, feeding-fasting behavior, cell cycles, and metabolism (1–3). A
population of approximately 20,000 oscillators in the suprachiasmatic nucleus of the brain serves
as the mammalian master clock, and synchronizes circadian oscillations in peripheral tissues
(4). Cellular oscillators in the SCN display stochastic variation in rhythmicity and period length,
due to the low molecular counts of core clock proteins. Stochastic noise has previously been
implicated in a variety of phenomena within the SCN (5, 6), and is thought to play an important
role in SCN behavior (7). SCN cells resist noise to establish robust system-wide rhythmicity
through coupling via the neurotransmitter VIP, which promotes transcription of the circadian
gene Period (Per) (8, 9).
The mammalian cell-autonomous oscillator is driven by a central transcription-translation
feedback loop, in which the protein products of E box-activated genes Per and Cryptochrome (Cry)
form heterodimers to repress their own transcription, as shown in Fig. 1. As these transcription
factors are degraded, transcription begins again, repeating the cycle with near-24 hour periodicity. While both CRY1 and CRY2 isomers are known E box repressors, Cry1 and Cry2 knockouts
display significant differences in rhythmicity and period length (10, 11). Prior work has shown
that single dissociated SCN neurons display persistent circadian rhythmicity in wild-type and
Cry2 knockout, while dissociated Cry1 knockout cells are largely arrhythmic. However, rhythmicity may be restored in Cry1 knockout populations through intercellular coupling (10, 12).
This difference in knockout behaviors has led to speculation that CRY1 and CRY2 play distinct,
non-redundant roles in the circadian oscillator or differ in strength of repression (13–15).
Here, we address the roles of Cry1 and Cry2 through a coupled stochastic model of the core
circadian oscillator, explicitly accounting for intrinsic noise and coupling dynamics through the
VIP and C-response element binding protein (CREB) pathway. We demonstrate that it is not
necessary for CRY1 and CRY2 to perform different functions in the oscillator; rather, knockout
characteristics of SCN neurons are well-explained by the absolute abundance of PER, CRY1,
and CRY2 proteins, in conjunction with intrinsic noise. Specifically, the higher expression of
Cry1 (16) causes Cry1 knockouts to lack sufficient CRY to rhythmically repress transcription.
When coupled, the positive-feedback VIP loop forces cells to cross a bifurcation and become limit
cycle oscillators, as positive feedback loops under certain conditions promote oscillatory behavior
(17). The results reconcile single uncoupled cell and network behavior, and demonstrate the
importance of absolute abundances and stochastic noise in understanding the circadian oscillator.

2

Model Structure and Parameter Identification

A schematic representation of the states captured in this model is shown in Fig. 1. We focus
on accurately capturing the network dynamics of the central Per-Cry transcription-translation
feedback loop. For intercellular coupling, we include the VIP-CREB pathway, as VIP has been
shown to play an essential role in driving synchronization within the SCN through induction
This work was supported in part by the National Institutes of Health under grant 1R01GM096873-01, and the
Institute for Collaborative Biotechnologies under grant W911NF-09-0001 from the U.S. Army Research Office. The
content of the information does not necessarily reflect the position of the policy of the Government, and no official
endorsement should be inferred.

2

VIP

C
GP

Neighboring
Cell

R

Kinase
Cascade

PER-CRY2

PER-CRY1

ular
c e ll
tra
lar
Ex
ellu
rac
Int

CREB

Nu
CRE

E box
E box
VIP prom.

cle
ar

PER

Per
Cry1
Cry2

CRY1

VIP

CRY2

VIP

VIP
Export

Figure 1: Visualization of model components. The model explicitly includes four
mRNA species (Per, Cry1, Cry2, VIP), four cytosolic proteins (PER, CRY1, CRY2, VIP),
and three nuclear transcription regulators (PER-CRY1, PER-CRY2, and CREB). The
central negative feedback loop (via PER-CRY) is modulated by the external positive
feedback loop (via VIP) which mediates cell to cell communication. VIP excreted
from nearby cells is received by G protein-coupled receptor (GPCR), which couples
cells in proximity.
of the core clock gene Per (8, 9). Here, we assume that VIP production is modulated by the
PER-CRY complex, as it is synthesized in phase with Cry mRNAs (16), and is regulated by the
clock. In (18), the phase of VIP release was found to be important for driving synchronization.
The model agrees with both this theory and experiment in that VIP is released in-phase with Per
expression (19).
The model explicitly includes the dynamics of the PER-CRY1-CRY2 feedback loop and VIP
signalling, resulting in an 11-state model with 34 kinetic parameters. The differential equations and the corresponding stochastic propensity functions for each state were formulated using Michaelis-Menten-type kinetics for repression and enzyme-mediated degradation, and massaction kinetics for translation and dimerization reactions. For Per, an additional CREB-dependent
activation term was added to the Michaelis-Menten repression. Differences between Cry1 and
Cry2 expression levels are captured through differing transcription, translation, and degradation
rates. Despite some evidence suggesting a difference in repressive ability between CRY isoforms
(20), the model did not require explicitly differentiating between repressive potency to accurately capture experimental phenotypes. While repressive potency could compensate for protein
concentration differences in simplified deterministic models, molecular noise is intrinsically tied
to absolute molecular numbers. Therefore in biochemical systems where stochastic effects are
relevant, repressive potency is inherently different from relative abundance.
We optimized model parameters using an evolutionary algorithm. The optimization was performed with respect to experimental mRNA and protein concentrations and amplitudes, RNAi
sensitivities, and phase relationships (11, 16, 21–25). Though quantitative data exists only for liver
and fibroblast cells, we assume relative mRNA and protein concentrations are conserved between
cell types (16, 21). Parameters were estimated from the deterministic model. Since a majority
of quantitative biological data exist at population level, we optimized the model in the coupled
state with the VIP pathway included. To model uncoupled cells, all VIP concentrations were set
3

Individual Cell

Per mRNA molecules

Per mRNA conc.

1.0

Coupled Population
(a)

0.8

0.8

0.6

0.6
0.4

0.4
0.2

0.2
0

1

2

3

4

5

400

6
(c)

0.0

600

200

400

100

200
0

1

2

3

4

5

6

Days

0

1

2

3

4

5

800

300

0

(b)

1.0

0

6
(d)

0

1

2

3

4

5

6

Days

Figure 2: Deterministic ((a)-(b)) and stochastic ((c)-(d)) simulation of the single uncoupled cell and network-level model. Deterministic trajectories represent normalized Per mRNA concentrations, stochastic trajectories show Per mRNA molecule
count. (a) The deterministic single uncoupled cell model shows damped oscillations.
(b) When coupling (VIP) is included, the model crosses a bifurcation to a deterministic limit-cycle oscillator. (c) Stochastic simulation of the single uncoupled cell model
demonstrates no decay in noise-driven oscillation amplitude. (d) Synchronization is
maintained at a mean population level (n = 225 cells, black) despite noisy individual
cells (gray traces).
to zero, which reflects the low concentration of VIP and lack of functional synapses in cultures of
mechanically-dissociated SCN neurons. Cells within the coupled population were connected to
horizontal and vertical neighbors on a 15-by-15 cell grid, with periodic boundaries. For conversion to a stochastic model, the volume parameter Ω was fit through the desynchronization rate
of decoupled oscillators to correctly capture intrinsic stochastic noise (26, 27).
The model equations for each state were written and solved using the CasADi computer algebra package (28) and the SUNDIALS ODE solvers suite (29). The model was simulated stochastically using the Gillespie algorithm, as implemented in StochKit2 (30). A detailed description of
model equations, parameters, and fitting is available (31).

3

Results

In the single uncoupled cell case, the deterministic model shows damped oscillations (Fig. 2(a)).
When simulated stochastically (Fig. 2(c)), single dissociated cells display sustained non-damping
oscillatory behavior. This indicates that single uncoupled cells in this model are noise-driven
oscillators, i.e. they are damped in the absence of noise; however, molecular noise in the biochemical reactions causes sustained oscillation (32). As shown in (33), single dissociated neurons
are well approximated as damped oscillators driven by molecular noise, and cannot be distinguished from noisy limit-cycle oscillators. With the VIP coupling pathway included, the system
crosses a bifurcation to a deterministic limit cycle oscillator (Fig. 2(b)). This bifurcation is caused
by inclusion of the VIP positive feedback on Per expression. For uncoupled cells, this loop is
4

Photons/min
Per mRNA molecules

50
40
30
20
10
0

Wild-Type

800
600

Cry1 KO

Cry2 KO

(a)

(b)

(c)

(d)

(e)

(f)

400
200
0

0 1 2 3 4 5 6 0 1 2 3 4 5 6 0 1 2 3 4 5 6
Days

Days

Days

Figure 3: The stochastic mathematical model captures individual neuron behavior.
(a)-(c) Experimental Per2-luc traces, from (10). (d)-(f) Per mRNA stochastic simulation
trajectories from the model.
knocked out. That is, when uncoupled, each individual cell is a noise-driven oscillator. When
coupled, each individual cell becomes a limit cycle oscillator. When simulated stochastically in
Fig. 2(d), this coupling is sufficient to drive phase synchrony in the mean (black), despite noise
in the single-cell trajectories (gray traces).
The central clock in the SCN has shown a strong robustness to genetic perturbations, and
the ability to maintain synchronized rhythmicity even with knockouts to core clock genes (6, 10).
At a single dissociated cell level the clock is less robust to perturbation, with dissociated Cry1
knockouts displaying less regular rhythms. First we demonstrate that the model captures the
phenotypes of Cry1 and Cry2 knockouts at both the level of dissociated cells (Fig. 3) and coupled
networks (Fig. 4). If both CRY isoforms act as E-box repressors, knockout of either Cry is expected
to increase transcription of Per, with the response being more severe for the Cry1 knockout, as
CRY1 is more abundant than CRY2. This is indeed seen in both Per2-luc measurements (10) and
in silico Per mRNA trajectories. When coupling is restored as in full SCN explants, rhythmicity
and synchronization is restored for Cry1 knockouts in both experiment and simulation, as shown
in Fig. 4. The model also correctly captures the directions of population-level period sensitivity to
Cry knockouts. Model Cry1 knockouts displayed a shortened period (82% of wild-type length),
and model Cry2 knockouts displayed a lengthened period (114% of wild type), consistent with
period shortening and lengthening in experiment (Cry1 knockout 90-95%, Cry2 knockout 105110%) (10, 11, 16).
To quantify neuron behavior, we use a rhythmicity index as defined in (34): the fraction of
energy contained within the frequency band corresponding to circadian oscillations, as calculated
via a discrete wavelet transform (DWT). The discrete wavelet transform is performed by applying
high and low-pass filters consecutively to resolve a time series at different scales. The energy
k D j k for each DWT level j is

k D j k2 =

K

∑ Wj,k2 ,

k =1

5

(1)

Per mRNA molecules Per2-luc Traces

1.0
0.9
0.8
0.7
0.6
0.5
1.0
0.8
0.6
0.4
0.2
0.0

Wild-Type

Cry1 KO

Cry2 KO

(a)

(b)

(c)

(d)

(e)

(f)

0 1 2 3 4 5 6 0 1 2 3 4 5 6 0 1 2 3 4 5 6
Days

Days

Days

Figure 4: Rhythmicity and synchronization were achieved for coupled SCN phenotypes in both experimental SCN explants (10) ((a)-(c)) and in silico coupled simulations ((d)-(f)). Individual cell traces for simulation data are shown in gray. Each
trajectory shown is normalized, as the number of cells differs between experimental
SCN explants. A downward trend is observed in biological SCN explant rhythms
likely due to cell death.
where Wj,k is the kth wavelet coefficient at DWT level j. Thus, the rhythmicity index is
RI =

k Dc k 2
J

∑ k Dj

,

(2)

k2

j =1

where J is the number of levels of the discrete wavelet transform, and Dc is the energy of the
wavelet level containing the circadian frequency. By Parseval’s theorem, this is equivalent to
the mean of the squared Fourier coefficients within each frequency band (34). We define the
circadian frequency band Dc to contain periods between 23 and 43 of mean wild-type period, as it
will capture oscillations with a near-circadian frequency.
When this metric is applied (Fig. 5), experimental and simulated results show good agreement, and demonstrate the strong increase in circadian rhythmicity in coupled Cry1 knockouts.
Since Cry1 and Cry2 play the same role in the model, the result indicates that the relative abundance of Cry isoforms in conjunction with intrinsic molecular noise is sufficient to capture the
differing effects of Cry1 and Cry2 knockouts.

4

Conclusion

In this work, we applied a new coupled stochastic model of the circadian oscillator to a lingering
question regarding the roles of Cry isoforms. We demonstrate that relative abundance is sufficient
to explain Cry knockout behaviors, and that a parallel role for Cry1 and Cry2 in the circadian gene
repression is consistent with experimental data. These results suggest that the inclusion of VIP
coupling causes individual cells to cross a Hopf bifurcation. This further supports the possibility
that single, decoupled cells may not exhibit deterministic limit cycles, though single-cell limit
cycle oscillators remain a widely-used convention. While deterministic models are sufficient to
6

Simulation

(a)

Rhythmicity Index

1.0

Uncoupled

Experiment

(b)
Coupled

Single-cell

Tissue

0.8
0.6
0.4
0.2
0.0

WT

Cry1 KO Cry2 KO

WT

Cry1 KO Cry2 KO

Figure 5: Model correctly predicts noise characteristics of single uncoupled cells
(black) and the coupled population (gray). Error bars represent variance. (a) Stochastic simulation. For each sample, n = 225. (b) Experimental results from (10). Single
dissociated cell mean and variance were taken from ten cells of each phenotype. SCN
tissue rhythmicity was taken from tissue explants of O(103 ) cells. Overall knockout
behavior corresponds closely with model prediction.
capture population-level limit cycle behavior, they are insufficient to describe the noise-induced
oscillations in single dissociated cells. Finally, these results emphasize the importance of describing circadian rhythmicity at the single-cell level with a continuous metric, rather than the
traditional binary classification of “rhythmic” or “arrhythmic.” Though the chosen rhythmicity
metric is not new, it adds detail to the understanding of cellular circadian behavior, and further
validates the dynamics captured by this new model.

References
1. J. Bass and J. S. Takahashi, “Circadian integration of metabolism and energetics,” Science, vol.
330, no. 6009, pp. 1349–1354, 2010.
2. J. Bieler, R. Cannavo, K. Gustafson, C. Gobet, D. Gatfield, and F. Naef, “Robust synchronization of coupled circadian and cell cycle oscillators in single mammalian cells,” Mol. Syst. Biol.,
vol. 10, no. 7, p. 739, 2014.
3. C. B. Green, J. S. Takahashi, and J. Bass, “The Meter of Metabolism,” pp. 728–742, 2008.
4. K. A. Lamia, K.-F. Storch, and C. J. Weitz, “Physiological significance of a peripheral tissue
circadian clock,” Proc. Natl. Acad. Sci. U. S. A., vol. 105, no. 39, pp. 15 172–15 177, 2008.
5. A. B. Webb, N. Angelo, J. E. Huettner, and E. D. Herzog, “Intrinsic, nondeterministic circadian rhythm generation in identified mammalian neurons,” Proc. Natl. Acad. Sci. U. S. A., vol.
106, no. 38, pp. 16 493–16 498, 2009.
6. C. H. Ko, Y. R. Yamada, D. K. Welsh, E. D. Buhr, A. C. Liu, E. E. Zhang, M. R. Ralph, S. A.
Kay, D. B. Forger, and J. S. Takahashi, “Emergence of noise-induced oscillations in the central
circadian pacemaker,” PLoS Biol., vol. 8, no. 10, p. e1000513, 2010.

7

7. D. B. Forger and C. S. Peskin, “Stochastic simulation of the mammalian circadian clock,”
Proc. Natl. Acad. Sci. U. S. A., vol. 102, no. 2, pp. 321–324, 2005.
8. S. J. Aton, C. S. Colwell, A. J. Harmar, J. Waschek, and E. D. Herzog, “Vasoactive intestinal
polypeptide mediates circadian rhythmicity and synchrony in mammalian clock neurons,”
Nat. Neurosci., vol. 8, no. 4, pp. 476–483, 2005.
9. D. K. Welsh, J. S. Takahashi, and S. A. Kay, “Suprachiasmatic nucleus: cell autonomy and
network properties,” Annu. Rev. Physiol., vol. 72, pp. 551–577, 2010.
10. A. C. Liu, D. K. Welsh, C. H. Ko, H. G. Tran, E. E. Zhang, A. A. Priest, E. D. Buhr, O. Singer,
K. Meeker, I. M. Verma, F. J. Doyle III, J. S. Takahashi, and S. A. Kay, “Intercellular coupling
confers robustness against mutations in the SCN circadian clock network,” Cell, vol. 129,
no. 3, pp. 605–616, 2007.
11. G. T. van der Horst, M. Muijtjens, K. Kobayashi, R. Takano, S. Kanno, M. Takao, J. de Wit,
A. Verkerk, A. P. Eker, D. van Leenen, R. Buijs, D. Bootsma, J. H. Hoeijmakers, and A. Yasui,
“Mammalian Cry1 and Cry2 are essential for maintenance of circadian rhythms,” Nature, vol.
398, no. 6728, pp. 627–630, 1999.
12. J. A. Evans, H. Pan, A. C. Liu, and D. K. Welsh, “Cry1-/- circadian rhythmicity depends on
SCN intercellular coupling,” J. Biol. Rhythm., vol. 27, no. 6, pp. 443–452, 2012.
13. M. Ukai-Tadenuma, R. G. Yamada, H. Xu, J. A. Ripperger, A. C. Liu, and H. R. Ueda, “Delay
in feedback repression by cryptochrome 1 is required for circadian clock function,” Cell, vol.
144, no. 2, pp. 268–281, 2011.
14. E. V. McCarthy, J. E. Baggs, J. M. Geskes, J. B. Hogenesch, and C. B. Green, “Generation of
a novel allelic series of cryptochrome mutants via mutagenesis reveals residues involved in
protein-protein interaction and CRY2-specific repression,” Mol. Cell. Biol., vol. 29, no. 20, pp.
5465–5476, 2009.
15. S. K. Khan, H. Xu, M. Ukai-Tadenuma, B. Burton, Y. Wang, H. R. Ueda, and A. C. Liu, “Identification of a novel cryptochrome differentiating domain required for feedback repression in
circadian clock function,” J. Biol. Chem., vol. 287, no. 31, pp. 25 917–25 926, 2012.
16. C. Lee, J.-P. Etchegaray, F. R. Cagampang, A. S. Loudon, and S. M. Reppert, “Posttranslational
Mechanisms Regulate the Mammalian Circadian Clock,” Cell, vol. 107, no. 7, pp. 855–867,
2001.
17. B. Ananthasubramaniam and H. Herzel, “Positive feedback promotes oscillations in negative
feedback loops,” PLoS One, vol. 9, no. 8, p. e104761, 2014.
18. B. Ananthasubramaniam, E. D. Herzog, and H. Herzel, “Timing of Neuropeptide Coupling
Determines Synchrony and Entrainment in the Mammalian Circadian Clock,” PLoS Comput.
Biol., vol. 10, no. 4, 2014.
19. A. Morin, L. Denoroy, and M. Jouvet, “Daily variations in concentration of vasoactive intestinal polypeptide immunoreactivity in discrete brain areas of the rat,” Brain Res., vol. 538,
no. 1, pp. 136–140, 1991.
20. E. A. Griffin Jr., D. Staknis, and C. J. Weitz, “Light-Independent Role of CRY1 and CRY2 in
the Mammalian Circadian Clock,” Science, vol. 286, no. 5440, pp. 768–771, 1999.
8

21. Y. Lee, R. Chen, H.-m. Lee, and C. Lee, “Stoichiometric relationship among clock proteins
determines robustness of circadian rhythms,” J. Biol. Chem., vol. 286, no. 9, pp. 7033–7042,
2011.
22. K. Obrietan, S. Impey, D. Smith, J. Athos, and D. R. Storm, “Circadian Regulation of cAMP
Response Element-mediated Gene Expression in the Suprachiasmatic Nuclei,” J. Biol. Chem.,
vol. 274, no. 25, pp. 17 748–17 756, 1999.
23. S. A. Tischkau, J. W. Mitchell, S.-H. Tyan, G. F. Buchanan, and M. U. Gillette, “Ca2+/cAMP
response element-binding protein (CREB)-dependent activation of Per1 is required for lightinduced signaling in the suprachiasmatic nucleus circadian clock,” J. Biol. Chem., vol. 278,
no. 2, pp. 718–723, 2003.
24. H. S. Nielsen, J. Hannibal, and J. Fahrenkrug, “Vasoactive intestinal polypeptide induces Per1
and Per2 gene expression in the rat suprachiasmatic nucleus late at night,” Eur. J. Neurosci.,
vol. 15, no. 3, pp. 570–574, 2002.
25. E. E. Zhang, A. C. Liu, T. Hirota, L. J. Miraglia, G. Welch, P. Y. Pongsawakul, X. Liu, A. Atwood, J. W. Huss, J. Janes, A. I. Su, J. B. Hogenesch, and S. A. Kay, “A genome-wide RNAi
screen for modifiers of the circadian clock in human cells,” Cell, vol. 139, no. 1, pp. 199–210,
2009.
26. J. Rougemont and F. Naef, “Dynamical signatures of cellular fluctuations and oscillator stability in peripheral circadian clocks,” Mol. Syst. Biol., vol. 3, no. 93, p. 93, 2007.
27. P. C. St. John, S. R. Taylor, J. H. Abel, and F. J. Doyle III, “Amplitude Metrics for Cellular
Circadian Bioluminescence Reporters,” Biophys. J., vol. 107, no. 11, pp. 2712–2722, 2014.
28. J. Andersson, J. Akesson, and M. Diehl, Recent Advances in Algorithmic Differentiation.
Springer Berlin Heidelberg, 2012, vol. 87.
29. A. C. Hindmarsh, P. N. Brown, K. E. Grant, S. L. Lee, R. Serban, D. E. Shumaker, and C. S.
Woodward, “SUNDIALS: Suite of Nonlinear and Differential/Algebraic Equation Solvers,”
ACM Trans. Math. Softw., vol. 31, no. 3, pp. 363–396, 2005.
30. K. R. Sanft, S. Wu, M. Roh, J. Fu, R. K. Lim, and L. R. Petzold, “StochKit2: software for
discrete stochastic simulation of biochemical systems with events,” Bioinformatics, vol. 27,
no. 17, pp. 2457–2458, 2011.
31. J. H. Abel, L. A. Widmer, P. C. St. John, J. Stelling, and F. J. Doyle III, “A Coupled Stochastic
Model Explains Differences in Circadian Behavior of Cry1 and Cry2 Knockouts,” arXiv, p.
1411.4624v1, 2014.
32. P. Thomas, A. V. Straube, J. Timmer, C. Fleck, and R. Grima, “Signatures of nonlinearity in
single cell noise-induced oscillations,” J. Theor. Biol., vol. 335, pp. 222–234, 2013.
33. P. O. Westermark, D. K. Welsh, H. Okamura, and H. Herzel, “Quantification of circadian
rhythms in single cells,” PLoS Comput. Biol., vol. 5, no. 11, p. e1000580, 2009.
34. T. L. Leise and M. E. Harrington, “Wavelet-based time series analysis of circadian rhythms,”
J. Biol. Rhythm., vol. 26, no. 5, pp. 454–463, 2011.

9

35. L. A. Widmer, J. Stelling, and F. J. Doyle III, “Note: Parameter-independent bounding of the
stochastic Michaelis-Menten steady-state intrinsic noise variance,” J. Chem. Phys., vol. 139,
no. 16, p. 166102, 2013.
36. T. Hirota, J. W. Lee, P. C. St John, M. Sawa, K. Iwaisako, T. Noguchi, P. Y. Pongsawakul,
T. Sonntag, D. K. Welsh, D. A. Brenner, F. J. Doyle III, P. G. Schultz, and S. A. Kay, “Identification of small molecule activators of cryptochrome,” Science, vol. 337, no. 6098, pp. 1094–1097,
2012.
37. F. Fortin and D. Rainville, “DEAP: Evolutionary algorithms made easy,” J. Mach. Learn. Algorithms, vol. 13, pp. 2171–2175, 2012.
38. K. Obrietan, S. Impey, D. Smith, J. Athos, and D. R. Storm, “Circadian Regulation of cAMP
Response Element-mediated Gene Expression in the Suprachiasmatic Nuclei,” J. Biol. Chem.,
vol. 274, no. 25, pp. 17 748–17 756, 1999.

5

Appendix: Model Description

Deterministic Model
The deterministic model is composed of eleven ODEs. Each reaction in the model obeys either mass-action or Michaelis-Menten kinetics, and the system behaves as a limit cycle oscillator
without requiring higher-order Hill kinetics. This reflects (17), in that a positive feedback loop
(VIP-CREB promotion of Per transcription) ameliorates the need for physically unrealistic high
order Hill terms. Avoiding Hill terms decreases error in the stochastic simulation, as the linear
noise approximation (LNA) variance of the stochastic Michaelis-Menten equation is known to be
bounded to [1, 43 ] of the true LNA variance at steady state (35).
The period of the deterministic model was scaled to 23.7 hours, however, the amplitudes were
not scaled. The units of the state variables are arbitrary relative concentrations, and the units of
parameters are provided. Tables 1 and 2 contain the equations and parameters, respectively, for
the ODE model of circadian cells.

Model Assumptions
The following assumptions were made in the development of this model:
• CLOCK and BMAL1 are considered approximately constant, through the v2pr parameter.
This parameter captures the repression of E-box genes, which is achieved through binding
of PER-CRYs to CLOCK-BMAL1.
• Degradation within the cell is assumed to be enzyme-mediated with Michaelis-Menten
kinetics. Extracellular VIP is assumed to degrade with mass-action kinetics.
• No Hill term of order higher than unity is used, as the external positive feedback arm
causes sufficient nonlinearity to create a limit cycle.
• Because nuclear CRY1 and CRY2 are believed to share a degradation pathway, shared
degradation kinetics are derived under the pseudo-steady state hypothesis, as in (36).

10

Uncoupled Population

Per mRNA molecules

400

300

200

100

0

0

5

10

15

20

Days

Figure 6: A population of 225 uncoupled cells results in gradual desynchronization
and eventually low-amplitude fluctuations caused by random noise. Individual cells
show a wide variance in period length with no VIP coupling. This variance leads to
gradual desynchrony. Though the population average displays only low-level fluctuations (black line), individual cells continue to oscillate without damping (gray
traces).
• PER is assumed to be required for nuclear uptake of CRY. We additionally assume that
equilibrium between PER-CRY complexes and free CRY proteins in the nucleus is fast, and
do not explicitly consider multiple CRY nuclear states.

Conversion to Coupled Stochastic Form
To create a stochastic form of the model, concentration was converted to population using a volume parameter Ω. This volume was determined by fitting the stochastic model to the desynchronization rate of a population of decoupled oscillators, to capture the correct amount of stochasticity in the population (27). For the model, Ω = 400. Additionally, a diffusion rate between
adjacent cells was defined, and an equation added to account for coupling between cells. Networks for population simulations consisted of 225 cells. Coupled populations were placed on a
15-by-15 cell grid, and coupled to the two nearest neighbors horizontally and vertically. Boundary conditions were considered to be periodic. VIP in the grid location of one cell (V IP1 ) may
move to a coupled cell (V IP2 ) with propensity k t × VIP1 Ω, in units molecules/hour. We used a
k t value of 10.0 to reflect the fact that diffusion occurs rapidly in comparison to the slow reactions involved in cellular timekeeping. However, k t values within an order of magnitude yield
near-identical results.

Model Fitting
The model was fit by use of an evolutionary algorithm in Python (37). Parameter values were
generated randomly. Criteria used in the fitness function constructed for this algorithm are
shown in Table 3. If the solution for a set of parameter values was not a limit-cycle oscillator, the
fitness function returned a maximum value.
11

Table 1: Ordinary differential equations comprising the coupled circadian model.

State Variable

Symbol

Model Equation

Per mRNA

p

v1pp CREB + v2pr
v3p p
dp
=
−
dt
K1p + C1P + C2P K2dp + p

Cry1 mRNA

c1

dc1
v4c1r
v c1
=
− 5c1
dt
K3c + C1P + C2P K4dc + c1

Cry2 mRNA

c2

dc2
v6c2r
v7c2 c2
=
−
dt
K3c + C1P + C2P K4dc + c2

VIP mRNA

vip

dvip
v8vr
v9v vip
=
−
dt
K5v + C1P + C2P K6dv + vip

Per Protein

P

dP
v P
= k1p p − 10P
− v11aCP P × C1 − v11aCP P × C2
dt
K8dP + P

+v12dCP C1P + v12dCP C2P
Cry1 Protein

C1

v
C1
dC1
= k2c c1 − 13C1
− v11aCP P × C1 + v12dCP C1P
dt
K9dC + C1

Cry2 Protein

C2

dC2
v
C2
= k2c c2 − 14C2
− v11aCP P × C2 + v12dCP C2P
dt
K9dC + C2

VIP Protein

VIP

dVIP
= k3v vip − v15V VIP
dt

CRY1-PER Dimer

C1P

dC1P
v16C1P C1P
= v11aCP P × C1 − v12dCP C1P −
dt
K10dCn + C1P + C2P

CRY2-PER Dimer

C2P

dC2P
v17C2P C2P
= v11aCP P × C2 − v12dCP C2P −
dt
K10dCn + C1P + C2P

CREB Protein

CREB

dCREB
v18V VIP
v19CR CREB
=
−
dt
K11V + VIP K12dCR + CREB

12

Table 2: Parameter descriptions for circadian ODE model.

Parameter

Description

Value

Units

v1pp

CREB-induced Per mRNA promotion

0.235

[-]/hr

v2pr

Per mRNA transcription

0.415

[-]2 /hr

v3p

Per mRNA degradation

0.478

[-]/hr

v4c1r

Cry1 mRNA transcription

0.350

[-]2 /hr

v5c1

Cry1 mRNA degradation

1.44

[-]/hr

v6c2r

Cry2 mRNA transcription

0.124

[-]/hr

v7c2

Cry2 mRNA degradation

2.28

[-]/hr

v8vr

VIP mRNA transcription

0.291

[-]2 /hr

v9v

VIP mRNA degradation

1.35

[-]/hr

v10P

Per protein degradation

13.0

[-]/hr

v11aCP

PER-CRY dimer formation

0.493

([-]× hr)−1

v12dcp

PER-CRY dimer dissociation

0.00380

1/hr

v13C1

Cry1 protein degradation

4.12

[-]/hr

v14C2

Cry2 protein degradation

0.840

[-]/hr

v15V

VIP protein degradation

0.723

1/hr

v16C1P

PER-CRY1 dimer degradation

0.0306

[-]/hr

v17C2P

PER-CRY2 dimer degradation

0.0862

[-]/hr

v18V

CREB activation by VIP receptors

0.789

[-]/hr

v19CR

CREB deactivation

1.27

[-]/hr

k1p

PER translation

7.51

1/hr

k2c

CRY translation

0.572

1/hr

k3v

VIP translation

5.50

1/hr

K1p

Per transcription constant

0.264

[-]

K2dp

Per degradation constant

0.00795

[-]

K3c

Cry transcription constant

0.156

[-]

K4dc

Cry degradation constant

1.94

[-]

K5v

VIP transcription constant

0.115

[-]

K6dv

VIP degradation constant

0.110

[-]

K7dP

Per protein degradation constant

0.0372

[-]

K8dC

Cry protein degradation constant

4.23

[-]

K9dCn

PER-CRY dimer degradation constant

0.0455

[-]

K10V

CREB protein activation constant

1.46

[-]

K11CR

CREB protein deactivation constant

1.01

[-]

13

Table 3: Components of the model fitness function for optimizing a parameter set.
Criteria 1-11, 14-18 from (16, 21); criteria 12, 13 from (10, 11, 16); criterion 20 from
(19); and criteria 19, 21 from (38).

Index

Description

Weight

Desired

Result

1

Per mRNA Peak-trough ratio

0.5

Large

Large

2

Cry1 mRNA Peak-trough ratio

0.5

2.16

2.30

3

Cry2 mRNA Peak-trough ratio

0.5

2.24

2.20

4

Per protein Peak-trough ratio

3

Large

Large

5

Cry1 protein Peak-trough ratio

3

3.247

2.41

6

Cry2 protein Peak-trough ratio

3

1.98

1.60

7

Fraction PER of total PER, CRY1, CRY2

3

0.10

0.06

8

Fraction CRY1 of total PER, CRY1, CRY2

3

0.56

0.63

9

Fraction CRY2 of total PER, CRY1, CRY2

3

0.34

0.31

10

Cry1 siRNA sensitivity

5

<0

<0

11

Cry2 siRNA sensitivity

5

>0

>0

12

Cry1 knockout period

12

< 0.95

0.89

13

Cry2 knockout period

12

> 1.15

1.16

14

Fraction PER-CRY1 of total CRY1

1

0.40

0.22

15

Fraction PER-CRY2 of total CRY2

1

0.35

0.10

16

tmax mRNAs - tmax complexes

3

0.75

0.81

17

tmax cytocsolic protein - tmax mRNAs

3

0.25

0.01

18

tmax PER-CRY - tmax cytosolic protein

3

0

0.18

19

tmax CREB - tmax mRNAs

8

> 0.80

0.93

20

VIP protein peak-trough ratio

5

3.00

3.48

21

CREB peak-trough ratio

5

3.00

2.76

22

Deterministic coupled cells must synchronize

20

True

True

14

