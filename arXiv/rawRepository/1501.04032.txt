arXiv:1501.04032v1 [q-bio.NC] 16 Jan 2015

Mean Time-to-Fire for the Noisy LIF Neuron
A detailed derivation of the Siegert Formula
Ken Kreutz-Delgadoâ€ 
January 16, 2015

Abstract
When stimulated by a very large number of Poisson-like presynaptic current input spikes, the temporal
dynamics of the soma membrane potential V (t) of a leaky integrate-and-fire (LIF) neuron is typically modeled
in the diffusion limit and treated as a Ornstein-Uhlenbeck process (OUP). When the potential reaches a
threshold value Î¸, V (t) = Î¸, the LIF neuron fires and the membrane potential is reset to a resting value,
V0 < Î¸, and clamped to this value for a specified (non-stochastic) absolute refractory period Tr â‰¥ 0, after
which the cycle is repeated. The time between firings is given by the random variable Tf = Tr + T where T
is the random time which elapses between the â€œunpinningâ€ of the membrane potential clamp and the next,
subsequent firing of the neuron. The mean time-to-fire, Tbf = E(Tf ) = Tr + E(T ) = Tr + Tb, provides a
measure Ï of the average firing rate of the neuron,
Ï = Tbfâˆ’1 =

1

Tr + Tb

.

This note briefly discusses some aspects of the OUP model and derives the Siegert formula giving the firing
rate, Ï = Ï(I0 ) as a function of an injected current, I0 . This is a well-known classical result and no claim to
originality is made. The derivation of the firing rate given in this report, which closely follows the derivation
outlined by Gardiner [6], minimizes the required mathematical background and is done in some pedagogic
detail to facilitate study by graduate students and others who are new to the subject. Knowledge of the
material presented in the first five chapters of Gardiner [6] should provide an adequate background for
following the derivation given in this note.

1

Background

Simple phenomenological models of the dynamical depolarization behavior of the membrane potential, V (t),
of a neuron often separate its behavior into two phases: (1) an analytically tractable â€œsubthresholdâ€ behavior,
which describes the behavior until a threshold membrane potential value, V (t) = Î¸, is attained. (2) At which
point an action potential spike is triggered, followed by an absolute refractory period after which the cycle
repeats itself.
In particular, the leaky integrate and fire (LIF) model assumes that the depolarization dynamics in the
subthreshold regime of the part of the soma responsible for spike generation behaves like a linear RC circuit,
LIF :
â€ 

d
1
1
V (t) = âˆ’ (V (t) âˆ’ Vr ) + I(t) ,
dt
Ï„
C

Ï„ = RC

(1)

Department of Electrical & Computer Engineering, University of California, San Diego. Email: kreutz@ece.ucsd.edu

1

This assumption is consistent with the fact that averaging over a length of a cylindrical neuron membrane
yields this behavior as a low-order approximation [20, 22]. For mammalian neurons a typical time-constant
value is Ï„ âˆ¼ 5â€“10 msec [20, 18]. The constant membrane reversal (aka, equilibrium) potential is denoted by
Vr .
Notwithstanding the gross simplification that occurs from the use of the LIF, additional significant
approximation issues occur due to the nature of the stochastic assumptions that are made on the afferent
currents which comprise the components of the membrane current I. Generally we can write,
I(t) = Ie (t) + Iint + Isyn ,
where Ie (t) is an externally injected current for experimental or control purposes, Iint represents internal or
internal noise which is generally neglected,1 while Isyn represents the summed effect of all of the afferent
â€œupstreamâ€ neurons which are sending spikes to the neuron across synaptic clefts. Ignoring the intrinsic
noise and treating the injected noise as constant on the time-scale of interest, I(t) = I0 , we have,
Nsyn

I(t) = I0 + Isyn = I0 +

X

ej Ij (t),

(2)

j=1

where j indexes one of the Nsun synapses, Ij (t) is a current induced at the j synapse by presynaptic
stimulation, and ej is the synaptic efficacy of the j synapse which is positive for input from an excitatory
presynaptic neuron and negative for an inhibitory presynaptic neuron. As many researchers have noted
[4, 8, 12, 21, 22, 2, 7, 11] at the finest time scale one cannot ignore the fact that each Ij (t) is effectively a
spike train.2 However it is much more difficult to analyze a spiking stimulus than one that has continuous
sample paths.
For this reason, as discussed in the aforementioned references, it is commonly argued that for neuronal
ensembles that operate in the limit of high impinging spiking rates (relative to the membrane time constant)
and small per-spike efficacies (relative to the magnitude of the spiking threshold magnitude) one can approximate a spiking point process which is assumed to have independent increments by a diffusive, continuous
sample path Wiener process (aka Brownian motion). And indeed, such arguments can at times be made
rigorous [4, 12, 6, 23]. The diffusion approximation is made by matching the mean and variance of a input
spike train to the drift (local mean) and intensity (local variance) of a Wiener process. In particular, if each
of the input current spike trains represented by Ij (t) is a stationary poisson renewal process with rate Î»j ,
we have (see, e.g., [21]),
X
X
e2j Î»j
(3)
ej Î»j and s2syn = Var {Isyn (t)} =
Ibsyn = E {Isyn (t)} =
j

j

The practical reasonableness of approximating Isyn (t) by a Wiener process with this (local) mean and variance
is discussed in [2, 11].

An additional problem arises because in order to model Isyn by a continuous sample path Wiener process, it should be an independent increment process. However, there are capacitive dynamics at work in the
synapses which induce correlations. To rigorously model such effects is onerous, so an additional approximation is usually made. In addition to assuming that the spike trains impinging on the soma are a Wiener
process, it is also assumed that the capacitive time constants at the synapses are fast compared to the time
constant of the soma membrane. This assumption can also be problematic (see the discussions in [11, 3]).
Suffice it to say, that in this note we do make the following huge simplifications for purposes of mathematical
tractability:
1 Internal, intrinsic noise is thermal noise (Johnson or Nyquist noise), â€œshot noiseâ€ (due to ions clumping up as they pass
through channels) and channel noise due to the stochastic natures of the opening and closing of large numbers of channel pores
on the neuronal membrane. Even taken collectively, such noise affects are usually (but not always) of low order compared to
the other terms.
2 The resulting model is known as the Stein Model [16, 17, 21, 22].

2

â€¢ We assume that we can model the firing behavior of a neuron by the simple LIF model given by Eq. (1).
â€¢ We assume that the collective effect of the presynaptic spike trains impinging on the neuron can be
model by an independent increment Wiener process.
â€¢ We assume that the capacitive effects of synaptic and dendritic accumulation and processing of the
spike trains are negligible.
To assemble the above pieces into the complete model which we will use in the sequel, define the zero
mean process and unit variance process,

1 
I(t) âˆ’ Ibsyn ,
Iesyn (t) =
ssyn

so that,

Combinging Eq.s (1), (2) (4) we have,

Isyn (t) = Ibsyn + ssyn Iesyn (t).

d
ssyn e
1
1
1
Isyn (t).
V (t) = Vr + Ibsyn + I0 âˆ’
V (t) +
dt
Ï„
C
Ï„
C
|
{z
} |{z}
|{z}
âˆš
Î±0 =Âµ
Î±1 =Îº
Î²=Ïƒ
{z
}
|

(4)

(5)

Î±(V )=Î±0 +Î±1 V

Thus,

dV (t) = Î±(V (t)) +

p
Î² dIesyn (t).

To gain a further degree of abstraction, we set X = V and W = Iesyn (t) where W denotes the standard (zero
mean and unit intensity) Wiener process. More generally, Î² can also depend on the state X(t), Î² = Î²(X).
The model,
p
dX(t) = Î±(X(t)) + Î²(X(t)) dW (t),
(6)
is known as a stochastic differential equation [6, 23] and has to be interpreted according to the rules of a
stochastic calculus.3 Our particular model with an affine drift term
Î±(X) = Î±0 âˆ’ Î±1 X = Âµ âˆ’ ÎºX,

Î±1 = Îº > 0,

(7)

and state-independent intensity,
Î²(X) = Î²0 = Ïƒ 2 > 0,

(8)

is known as the Ornstein-Uhlenbeck process (OUP),
dX(t) = Âµ âˆ’ Îº X(t) + Ïƒ dW (t).

(9)

If in addition a firing threshold with reset (after a possible refractory period) is enforced, we obtain the OUP
Leaky integrate-and-fire model, which we also refer to as the OUP/LIF neuron.
The LIF neuron fires when V (t) = Î¸. The first-passage time to threshold, TÎ¸ , beginning from a membrane
voltage reset value V (t0 ) = v0 at initial time t = 0 is defined by,

TÎ¸ = TÎ¸ (v0 ) = inf{t  V (t) = Î¸, V (t0 ) = v0 < Î¸}.
3 The standard ones being the Ito Calculus and the Stratonovic Calculus [6, 23]. This distinction vanishes for the OrnsteinUhlenbeck process (OUP), which is the situation under consideration. Because our analysis is based on the use of the FokkerPlanck diffusion equations, the stochastic calculus is not used in this note.

3

Note that under our model, T is a random variable. For the model under consideration in this note, i.e. the
Ornstein-Uhlenbeck process (OUP), we desire to know if the neuron will fire in finite time with probability
one as well as the mean time to fire. Note that if there is a finite probability that the neuron will never fire in
finite time, then the mean time to fire must be infinite as T = âˆ will have a nonzero probability of occurring.
Thus, as noted by [21] one should always first ascertain that a neuron will fire (or not) in finite time with
probability one. As noted in the abstract (and discussed below) knowledge of the mean time-to-fire provides
a measure of the firing rate of the neuron.
Although we have indicated, and will continue to indicate, the dependence of the passage time T on the
threshold value Î¸ and the initialization (i.e., the reset) voltage v0 , in fact we are interested in its dependence
on the injected current I0 which is our parameter of control to affect the firing behavior of the neuron, so
we will write variously T = TÎ¸ (v0 ) = TÎ¸ (v0 , I0 ) = T (I0 ), etc.
The goal of this note is to demonstrate that the OUP/LIF has a finite passage time with probability one,
so that the neuron is almost surely guaranteed to fire in a finite time, and to derive its mean first passage
as a function of the injected current I0 , the reset voltage V (t0 ) = v0 , and the threshold value Î¸ which in
turn allows us to determine the mean firing rate as a function of these quantities and the absolute refractory
period Tr . At the price of some inelegance, the derivation is kept as simple has possible in order to be
accessible to a wider range of students and nonspecialists.4 An attempt has been made to be thorough and
detailed, and therefore many derivation steps are given which are often left out of the published literature
and textbooks.

2
2.1

SDEs, FPEs and the First-Passage Time
Stochastic Differential Equations and the Fokker-Planck Equation

As motivated in the prior discussion, we are interested in the dynamical behavior of the homogeneous
stochastic differential equation (SDE),
SDE :

dX(t) = Î±(X(t))dt +

p

Î²(X(t)) dW (t)

tâ‰¥0

(10)

where W is a standard Wiener process. With the assumption that the initial condition X(0) is (possibly
degenerate) gaussian and independent of W , this describes the behavior of a continuous sample path, homogeneous Markov process.5 Although we are primarily interested in the behavior of the OUP, we will keep
the development fairly general and only specialize to the OUP towards the end of the note.
Eq. (10) provides a local description of the behavior of a diffusion process. There are many global
solutions consistent with this local behavior, each one determined by the imposition of initial and boundary
conditions. The Markov process (10) takes continuous values and therefore, once appropriate initial and
boundary conditions have been imposed, has a behavior which is described by a transition probability
4 In particular we avoid, or minimize, the discussion of moment generating functions; Laplace transforms and complex
analysis; stochastic differential equations; the theory of the Sturm-Liouville problem; the theory of integral equations; and the
theory of diffusion process boundary conditions, all of which have utility in a rigorous analysis of the first passage time problem
[1, 5, 8, 9, 12, 13, 14, 15]. Knowledge of the behavior of a first-order scalar stochastic dynamical system as described in the
first 5 chapters of the textbook by Gardiner should provide an adequate background for following the development given in this
note.
5 The process is homogeneous because the Î±(x) and Î²(x) are independent of the time, t.

4

density function, p(x, t|x0 , t0 ), which uniquely satisfies the Chapman-Komolgorov equation (CKE),6
Z
CKE :
p(x, t|x0 , t0 ) = p(x, t|xâ€² , tâ€² )p(xâ€² , tâ€² |x0 , t0 )dxâ€²
and the condition,
p(x, t) =
for all admissible values of x and t [6].

Z

(11)

p(x, t|xâ€² , tâ€² )p(xâ€² , tâ€² )dxâ€² ,

Under mild assumptions on Î±(Â·) and Î²(Â·) a distribution which satisfies the CKE also satisfies a differential
version of the CKE, the (forward) Fokker-Planck equation (FPE) [12, 23, 6],7,8
âˆ‚
âˆ‚
1 âˆ‚2
Î²(x)p(x, t|x0 , t0 ).
p(x, t|x0 , t0 ) = âˆ’ Î±(x)p(x, t|x0 , t0 ) +
âˆ‚t
âˆ‚x
2 âˆ‚x2

(12)

There are many possible solutions, f (x, t), to the Fokker-Planck equation,
FPE :

âˆ‚
âˆ‚
1 âˆ‚2
Î²(x)f (x, t)
f (x, t) = âˆ’ Î±(x)f (x, t) +
âˆ‚t
âˆ‚x
2 âˆ‚x2

(13)

and it is the imposition of initial conditions (at t = t0 ) and boundary conditions that determines which
particular solution is obtained. In particular, if consistent sets of initial and boundary conditions are correctly
chosen for the stochastic differential equation Eq. (10) and for the FPE Eq. (13), the solution to Eq. (13) will
correctly describe the stochastic behavior of Eq. (10) and satisfy the corresponding CKE (11). In particular
the imposition of the initial condition (IC),
f (x, t0 ) = Î´(x âˆ’ x0 ),

(14)

the unrestricted boundary conditions,9

f (âˆ’âˆ, t) = p(âˆ’âˆ, tx0 , t0 ) = 0

and the pdf normalization condition,10

Z

6


and f (âˆ, t) = p(âˆ, tx0 , t0 ) = 0, .

(15)


p(x, tx0 , t0 )dx = 1,

We define the conditional density function p(x, t|x0 , t0 ) as



	
p(x, tx0 , t0 )dx = Prob X(t) âˆˆ (x, x + dx)X(0) = x0 ,

with corresponding condition probability distribution,
Z x




	
p(xâ€² , tx0 , t0 )dxâ€² = Prob X(t) â‰¤ xX(0) = x0 .
P (x, tx0 , t0 ) =
âˆ’âˆ

7 Also

known as the (forward) diffusion equation, the forward Kolmogorov equation, and the Smoluchowski equation.
equivalence between Eq.s (10) and (12) holds in general under the rules of the Ito stochastic calculus. In general
the equivalence does not hold under the rules of the Stratonovich calculus. Although most authors and researchers work
primarily within the Ito formalism (e.g., [6, 23]) some adhere to the Stratonovich formalism (e.g. [8]), which can potentially
cause confusion when comparing results across various source texts and papers. However, the Ornstein-Uhlenbeck process,
which is the model under consideration in this note, fortuitously has the same behavior under both the Ito and Stratonovich
interpretations [6].
9 It is possible to place alternative and/or additional conditions on the behavior of the solution f (x, t) at x = Â±âˆ, depending
on the nature of the solution one is looking for [8, 6, 23].
10 Note that the normalization condition is sufficient for the previous boundary conditions at x = Â±âˆ. One reason to decouple
the two conditions is that under some alternative boundary conditions reasonable solutions can satisfy
Z

p(x, tx0 , t0 )dx < 1,
8 The

where the loss of probability corresponds to the probability of â€œaborption.â€ For a discussion of this subtle point see [23].

5


to the solution of the FPE (13) will result in a transition density p(x, tx0 , t0 ) that correctly describes the
stochastic behavior, X(t), t â‰¥ 0, of Eq. (10), provided the latter has been subjected to the initial condition
X(t0 ) = x0 with no other conditions imposed on X(t).11 On the other hand, if one applies the initial condition
f (x, t0 ) = p(x, t0 ), subject to the same boundary conditions, one obtains the solution f (x, t) = p(x, t). Below,
we will discuss other important solutions to the FPE, as well as to the backward FPE which is to be discussed
next.
Within the interior of an admissible open state space region of the SDE (10), the sample paths system
are all continuous, provided that Î±(Â·) and Î²(Â·) are reasonably well-behaved functions of their arguments.
This means that the solutions to the FPE, and its variants discussed below, will assumed to be continuous
functions of their space and time arguments within the interior of the state space. Of course, once the
state X(t) hits the threshold value Î¸, which is a boundary of the state space interior, there is a radical,
discontinuous reset of the state value,
X(Î¸) â†’ X(t0 ) = x0 < Î¸.

2.2

The Homogeneous Backward and Mixed Fokker-Planck Equations

The density satisfying the CKE also satisfies the backward Fokker-Planck equation (BFPE),
BFPE :

âˆ’

âˆ‚
1
âˆ‚2
âˆ‚
p(x, t|x0 , t0 ) = Î±(x)
p(x, t|x0 , t0 ) + Î²(x) 2 p(x, t|x0 , t0 )
âˆ‚t0
âˆ‚x0
2
âˆ‚x0

(16)

In this equation x and t are fixed (i.e., the final state and time are treated as parameters) and x0 and t0
are treated independent variables subject to the constraint t0 â‰¤ t. If the SDE (10) is subject to the initial
condition X(t0 ) = x0 and is otherwise unrestricted, then its stochastic behavior is described by the solution
to (16) which satisfies the final condition (FC),
p(x, t|x0 , t) = Î´(x0 âˆ’ x).
This equation is often presented in a slightly different form in the homogeneous case which we are
considering in this note.12 Homogeneity means that for all Ï„ ,
p(x, tâ€² + Ï„ |x0 , tâ€²0 + Ï„ ) = p(x, tâ€² |x0 , tâ€²0 ).
In particular, for Ï„ = âˆ’tâ€²0 , and elapsed time t = tâ€² âˆ’ tâ€²0 , we have,
p(x, t|x0 , 0) = p(x, 0|x0 , âˆ’t).
Taking making the assignments t0 = âˆ’t and t = 0 in the left-hand-side of Eq. (16), we have,
âˆ’

âˆ‚
âˆ‚
âˆ‚
âˆ‚
p(x, t|x0 , t0 ) â†’ âˆ’
p(x, 0|x0 , âˆ’t) = p(x, 0|x0 , âˆ’t) = p(x, t|x0 , 0).
âˆ‚t0
âˆ‚(âˆ’t)
âˆ‚t
âˆ‚t

Thus if we define,
g(y, t) = p(x, t|y, 0),
the homogenous BFPE can be rewritten as the mixed Fokker-Planck equation (MFPE),
MFPE :

âˆ‚
1
âˆ‚2
âˆ‚
g(y, t) = Î±(y) g(y, t) + Î²(y) 2 g(y, t)
âˆ‚t
âˆ‚y
2
âˆ‚y

(17)

11 This is called the unrestricted case as no limitations are placed on the values taken by the state X(t) for t > t . Note that
0
the general solution involves x0 and t0 as â€œfree parameters.â€
12 It should be noted that a stationary process is necessarily homogenous. (However, a homogenous process is not necessarily
stationary, unless special initial conditions have been chosen or the process is considered in the asymptotic limit t â†’ âˆ given
certain stability assumptions.)

6

Note that in Eq. (17) t is the (â€œforwardâ€) time which has elapsed since the initial time t0 = 0 and y is the
value at the (â€œbackwardâ€) initial time, X(0) = y.13 This variant of the BFPE can be found amply utilized
in references which primarily focus on the homogenous case (e.g., [15, 5, 8]) as well as in other sources (see,
e.g., Eq. (5.5.5) of [6]).
Because Eq. (17) has an independent parameter, t, that refers to the future (forward) time and an
independent parameter that refers to the current (or backward) initial condition y = X(0), we call Eq. (17)
the mixed Fokker-Planck equation (MFPE) in order to distinguish it from the (forward) FPE (13) and the
BFPE (16). It is important to recognize the distinct differences between these three equations.
Under the appropriately consistent initial and boundary conditions the solutions to the FPE, BFPE, and
MFPE are equal and describe the stochastic behavior of the SDE (10). In particular, we are interested in
the initial conditions for the FPEs which correspond to X(0) = y,14
ICs :

f (x, 0) = p(x, 0|y, 0) = g(y, 0) = Î´(x âˆ’ y)

(18)

As all three variants of the FPE yield the same solution for the transition density function, p(x, t|y, 0), we
are free to use the one which is of greatest convenience given the nature of Î±(Â·), Î²(Â·), and the boundary
conditions. Note that the solutions to the FPEâ€™s obtained via the use of the ICs (18) have tacit dependencies;
specifically f (x, t) tacitly depends on y while g(y, t) tacitly depends on x. In the sequel it will be useful to
make these dependencies notationally overt via the definitions,
f (x, t) = fy (x, t) = f (x, t; y) and g(y, t) = gx (y, t) = g(y, t; x).

2.3

The First Passage Time

Consider the case where as long as X(t) âˆˆ S, for some open, connected subset of the reals, S âŠ‚ R, its
dynamical behavior is described by the SDE (10). If S = R, we say that the SDE is unrestricted, whereas if S
is a proper subset of the reals, we say that it is restricted. A standard choice is an open internal, Sa,Î¸ = (a, Î¸).
Our primary interest is with the case when a â†’ âˆ’âˆ,
S = SÎ¸ = (âˆ’âˆ, Î¸).
Because the SDE (10) models a diffusion process, it has continuous sample paths, and thus the only way that
X(t) can exit the admissible state space S is to hit the upper limit Î¸ at some passage time15 tâ€² , X(tâ€² ) = Î¸.
In the leaky integrate-and-fire (LIF) neuron, as soon as (i.e., the first time that ) X(t) â€œescapes fromâ€
the region S, the neuron fires (an impulse is generated and sent to downstream neurons) and the dynamics
represented by the SDE (10) is â€œturned offâ€ for a (deterministic) duration, Tr chosen to model the absolute
refractory period of the neuron, after which the clock is reset to zero, t = t0 = 0, and the neuron is reset to
its initialization value, X(0) = x0 . The process repeats itself indefinitely.
Once the neuron is reset the dynamical behavior (10) is allowed to run in an unrestricted manner until
the threshold Î¸ is reached. Thus one is interested in the first passage time. This is defined as,

	
T = TS (x0 ) = inf tX(t) 6âˆˆ S, X(0) = x0 âˆˆ S
13 In

terms of the notation used in Eq. (12), Eq. (17) is

âˆ‚
âˆ‚
1
âˆ‚2
p(x, t|x0 , 0) = Î±(x0 )
p(x, t|x0 , 0) + Î²(x0 ) 2 p(x, t|x0 , 0).
âˆ‚t
âˆ‚x0
2
âˆ‚x0
14 Because of the assumption of homogeneity, henceforth, with no loss of generality, we take t = 0, and henceforth we will
0
always take t â‰¥ 0.
15 Also known as a hitting time, an exit time, an escape time, or a (gamblerâ€™s) ruin time.

7

For our situation of interest, we have

	
T = TÎ¸ (x0 ) = inf tX(t) = Î¸, X(0) = x0 < Î¸ .

The time between firings is given by the random variable Tf = Tr + T where T is the random time which
elapses between the â€œunpinningâ€ of the membrane potential clamp and the next, subsequent firing of the
neuron, as just defined. The mean time-to-fire (MTF),
Tbf = E(Tf ) = Tr + E(T ) = Tr + Tb,

provides a measure Ï of the average firing rate (AFR) of the neuron,
Ï = Tbfâˆ’1 =

1
Tr + Tb

.

The primary goal of this note is to derive the mean passage time (MPT),
Tb = TbÎ¸ (x0 ) = E{TÎ¸ (x0 )},

for the Ornstein-Uhlenbeck process (OUP) in a greater degree of detail than is easily found in the literature.

2.4

The MFPE for the Restricted, Subthreshold Dynamics

Because until the state X(t) reaches the threshold value Î¸ the local â€œsubthresholdâ€ dynamics are modeled
by the SDE (10), its local, stochastic behavior until it escapes from the set S is completely captured by the
FPEs. Indeed, itâ€™s entire stochastic behavior within the the interior of the region S is captured by the FPEs.
What distinguishes the global solution to the FPEs for the restricted behavior (X(t) confined to S) from the
global solution for the unrestricted behavior (X(t) free to take any value in R) are not the FPEâ€™s themselves
(they after all describe the same local motions within the the interior of the set S for both the restricted
and unrestricted cases) but rather the boundary conditions which are applied to the FPEs (because the
difference between the two cases arises when the restricted motion bumps up against the boundary).
To handle the â€œbumping upâ€ against the boundary Î¸ which turns off the dynamics, we imagine that the
SDE (10) describes the behavior of a brownian motion particle that is absorbed (â€œvanishesâ€) as soon as it
hits the position Î¸, never to return again.16 The theory of boundary conditions for Markov and diffusion
processes is discussed at length in many places (see, e.g., [8, 6]); suffice it to say that for our purposes it
is enough to know that the appropriate boundary conditions to enforce in the FPE (13) and the MFPE
(17) if one is interested in solving for the transition density function are the respective absorbing boundary
conditions,
ABCs :

f (Î¸, t) = p(Î¸, t|x0 , 0) = 0

and g(Î¸, t) = p(x, t|Î¸, 0) = 0

(19)

The first condition says that the probability of being at Î¸ is zero (because once you step there, you vanish)
and the second condition says that once youâ€™ve vanished, you never return to anywhere (because youâ€™ve
vanished for good). Because a diffusion processes is continuous, these conditions imply that,


	

	

(20)
Prob X(t) â‰¥ Î¸X(0) = x0 = 0 and Prob X(t)X(0) = x0 â‰¥ Î¸ = 0.

As described in a variety of sources, the BFPE is particularly useful for solving passage time problems
[8, 12, 21, 23, 6], particularly in the guise of the MFPE variant given by Eq. (17) above [15, 5, 8, 6].17 In
particular, the solution of Eq. (17),
âˆ‚
1
âˆ‚2
âˆ‚
gx (y, t) = Î±(y) gx (y, t) + Î²(y) 2 gx (y, t),
âˆ‚t
âˆ‚y
2
âˆ‚y
16 A
17 In

nice discussion of this is given in [23].
particular, the development given in this note closely follows that beginning with Eq. (5.5.5) on page 131 of [6].

8

(21)

subject to the respective initial and boundary conditions,
gx (y, 0) = Î´(y âˆ’ x)

and gx (Î¸, t) = 0, âˆ€t

(22)

is equal to the restricted dynamics probability density function,
gx (y, t) = pb(x, t|y, 0),

where,

and



	
pb(x, t|y, 0)dx = Prob X(t) âˆˆ (x, x + dx), X(tâ€² ) < Î¸, âˆ€tâ€² âˆˆ [0, t]X(0) = y ,
Z x
Z x
b
pb(x, t|y, 0)dx
gx (y, t)dx =
Gx (y, t) = P (x|y, 0) =
âˆ’âˆ
âˆ’âˆ


	
= Prob X(t) â‰¤ x, X(tâ€² ) < Î¸, âˆ€tâ€² âˆˆ [0, t]X(0) = y

is the probability distribution function for the restricted processes X(t). Because Eq. (21) describes the
behavior of a continuous sample path diffusion motion, the density function gx (y, t) and the distribution
function Gx (y, t) are continuous functions of x, y and t within the interior of the state space.

2.5

Moments of the First Passage Time

The development in this section closely follows that of Section 5.5.1 of [6]. However, as noted in [21] there
are some additional subtle points to be addressed in the derivation of the passage time moments.18
Note from the development in the previous section that,19

	
Prob T = TÎ¸ (y) > t = GÎ¸ (y, t) =

Z

Î¸

gx (y, t)dx.

âˆ’âˆ

Thus the distribution function of T is given by,20

	

	
QÎ¸ (y, t) = Prob T = TÎ¸ (y) â‰¤ t = 1 âˆ’ Prob T = TÎ¸ (y) > t = 1 âˆ’ GÎ¸ (y, t).

Having obtained the passage time distribution function QÎ¸ (y, t) we can compute the passage time probability
density function as,21,22
qÎ¸ (y, t) =

âˆ‚
âˆ‚
âˆ‚
QÎ¸ (y, t) = âˆ’ GÎ¸ (y, t) = âˆ’
âˆ‚t
âˆ‚t
âˆ‚t

Z

Î¸

âˆ’âˆ

gx (y, t)dx. = âˆ’

Z

Î¸

âˆ’âˆ

âˆ‚
gx (y, t)dx.
âˆ‚t

(23)

From the assumed continuity of Gx (y, t) and gx (y, t), QÎ¸ (y, t) and qÎ¸ (y, t) are similarly continuous.
Note that the condition,
QÎ¸ (y, âˆ) = lim QÎ¸ (y, t) = 1 âˆ€y ,
tâ†’âˆ

(24)

18 Both [8] and [21] stress the importance of ascertaining that the probability of a finite passage time be one in order to claim
that a neuron will reliably fire when stimulated. In addition, a probability-one finite mean passage time provides a technical
justification for a seemingly minor, yet key, step made in the development given in [6].
19 Note that G (y, 0) = 1 for all y < Î¸ and that G (y, t) = 0 for y â‰¥ Î¸. In particular, G (Î¸, t) = 0.
Î¸
Î¸
Î¸
20 Note that Q (y, t) = 1 for all y â‰¥ Î¸ and that Q (y, 0) = 0 as X(0) = y < Î¸.
Î¸
Î¸
21 Note that q (Î¸, t) = 1 and q (y, 0) = 0 for y < Î¸.
Î¸
Î¸
R
R
22 For future reference note that Q (y, t) = t q (y, t)dt and in particular that Q (y, âˆ) = âˆ q (y, t)dt, which should have
Î¸
Î¸
Î¸
0 Î¸
0
a value of one if we are to have a finite passage time occur almost surely.

9

if it holds, means precisely that the first passage time is finite, and therefore neuron will fire in finite time,
with probability one regardless of the initialization state. Therefore we will spend some time to verify this
fact for the OUP neuron.
What does it mean if QÎ¸ (y, âˆ) < 1? It is a property of probability measures that they can be decomposed
into a continuous part (like QÎ¸ (y, t)), represented by continuous probability density functions, like
qÎ¸ (y, t) =

âˆ‚
QÎ¸ (y, t),
âˆ‚t

which have no jumps, and a discrete, â€œatomicâ€ part that places nonzero probability mass on discrete points
[10].23 If Q(Î¸ (y, âˆ) = 1, then Q(Î¸ (y, t) is a distribution which describes a completely continuous random
variable, T , that with probability one takes a finite value T = t, 0 < T < âˆ. On the other hand, if
QÎ¸ (y, âˆ) < 1, then with probability,
GÎ¸ (y, âˆ) = 1 âˆ’ QÎ¸ (y, âˆ),

the threshold Î¸ will not be hit in any finite time, which means that there must be a discrete, atomic amount
(equal to 1 âˆ’ QÎ¸ (y, âˆ)) of probability mass (conceptually) located at t = âˆ. In this latter case there is a
nonzero probability that the neuron will never fire.24
We do assume that, for each y, limtâ†’âˆ QÎ¸ (y, t) = QÎ¸ (y, âˆ) converges to a constant value that is independent of t.25 And if
Z âˆ
qÎ¸ (y, t)dt
QÎ¸ (y, âˆ) =
0

converges, it must be the case that,26

qÎ¸ (y, âˆ) = 0.

(25)

Note that Eq. (24) is true if and only if
GÎ¸ (y, âˆ) = lim GÎ¸ (y, t) = 0,
tâ†’âˆ

âˆ€y .

(26)

Although condition (26) is often assumed to be true,27 as noted in [21] this is a key property28 that ideally
should be verified. Of course, (26) can always just be assumed to be true.29 Indeed, we will do just that by
(temporarily) assuming a stronger condition, namely that the convergence of GÎ¸ (y, t) obeys,
lim tn GÎ¸ (y, t) = 0 ,

tâ†’âˆ

âˆ€y ,

(27)

for specific values of n â‰¥ 0. When such assumptions are made, we will be very careful to note them.30
To demonstrate an application of the condition (27), we first define the moments of the first passage time
random variable T = TÎ¸ (y) by
Z âˆ
Z âˆ
 n
âˆ‚
n
(28)
tn GÎ¸ (y, t)dt.
t qÎ¸ (y, t)dt = âˆ’
mn = mn (Î¸, y) = E T } =
âˆ‚t
0
0
23 There is also a third, mathematically abstract,â€œsingularâ€ part which is not encountered when dealing with phenomena in
the physical world.
24 For an example of a model neuron that has a nonzero probability of never firing, see the example on page 142 of [21].
25 We prove later that Q (y, âˆ) â‰¤ 1.
Î¸
26 Thus we have that q (y, 0) = q (y, âˆ) = 0 for y < Î¸. We can have q (y, âˆ) = 0 and yet have a nonzero probability mass at
Î¸
Î¸
Î¸
t = âˆ because qÎ¸ (y, t) represents the purely continuous part of the T -distribution. It is unfortunately the case that egregiously
using qÎ¸ (y, âˆ) in place of the more accurate limtâ†’âˆ qÎ¸ (y, t) can be misleading: qÎ¸ (y, âˆ) does not represent probability mass
at infinity, but rather the probability density on the way to infinity.
27 For example, see Equation (5.5.16) of [6].
28 Equivalent to the probability one finite passage time condition (24).
29 And then hopefully verified after the fact, thereby demonstrating that a self-consistent derivation has occurred.
30 Eventually we will replace the condition (27) with the finite moments condition (43).

10

Note, in particular, that the â€œzeroth momentâ€, m0 , has already been encountered,
m0 (Î¸, y) = QÎ¸ (y, âˆ) = 1 âˆ’ GÎ¸ (y, âˆ),
and gives the total probability that the first passage time from the initial state y is finite. As we have noted,
m0 (Î¸, y) = 1 for all y

â‡â‡’

GÎ¸ (y, âˆ) = 0 for all y.

To compute higher order moments, mn (Î¸, y) from Eq. (28), it is useful to note that,
âˆ‚ n
âˆ‚
t GÎ¸ (y, t)dt = tn GÎ¸ (y, t)dt + n tnâˆ’1 GÎ¸ (y, t)dt
âˆ‚t
âˆ‚t
so that integrating the last integral on the far right hand side of (28) by parts yields
Z âˆ
tnâˆ’1 GÎ¸ (y, t)dt âˆ’ lim tn GÎ¸ (y, t) + lim tn GÎ¸ (y, t).
mn (Î¸, y) = n
tâ†’âˆ

0

(29)

tâ†’0

For n = 0, this yields,
m0 (Î¸, y) = GÎ¸ (y, 0) âˆ’ GÎ¸ (y, âˆ) = 1 âˆ’ GÎ¸ (y, âˆ),
as expected. For n â‰¥ 1, we have,
mn (Î¸, y) = n

Z

âˆ

0

tnâˆ’1 GÎ¸ (y, t)dt âˆ’ lim tn GÎ¸ (y, t),

(30)

tâ†’âˆ

which, in turn, gives
mn (Î¸, Î¸) = 0

for all t â‰¥ 1.

Finally, note that by invoking condition (27), Eq. (30) becomes the very useful relationship,
Z âˆ
Condition (27) =â‡’ mn (Î¸, y) = n
tnâˆ’1 GÎ¸ (y, t)dt for n â‰¥ 1,

(31)

0

Inspired by Eq. (23), integrate every term in Eq. (21) by âˆ’
qÎ¸ (y, t) = âˆ’Î±(y)

RÎ¸

âˆ’âˆ

( Â· )dx to obtain the equation,

1
âˆ‚2
âˆ‚
GÎ¸ (y, t) âˆ’ Î²(y) 2 GÎ¸ (y, t).
âˆ‚y
2
âˆ‚y

(32)

Now differentiate every term by t,
âˆ‚
âˆ‚ âˆ‚
1
âˆ‚2 âˆ‚
qÎ¸ (y, t) = âˆ’Î±(y)
GÎ¸ (y, t) âˆ’ Î²(y) 2 GÎ¸ (y, t).
âˆ‚t
âˆ‚y âˆ‚t
2
âˆ‚y âˆ‚t
Râˆ
Finally, integrate every term by 0 ( Â· )dt,


Z âˆ
Z âˆ
Z âˆ
âˆ‚
âˆ‚
âˆ‚
âˆ‚2
1
âˆ‚
âˆ’ GÎ¸ (y, t) dt + Î²(y) 2
âˆ’ GÎ¸ (y, t) dt,
qÎ¸ (y, t)dt = Î±(y)
âˆ‚t
âˆ‚y 0
âˆ‚t
2
âˆ‚y 0
âˆ‚t
{z
}
|0
{z
}
{z
}
|
|
qÎ¸ (y,âˆ)âˆ’qÎ¸ (y,0)=0

to obtain,

|

0 = Î±(y)

qÎ¸ (y,t)

{z

m0 (Î¸,y)

}

|

1
âˆ‚2
âˆ‚
m0 (Î¸, y) + Î²(y) 2 m0 (Î¸, y).
âˆ‚y
2
âˆ‚y
11

qÎ¸ (y,t)

{z

m0 (Î¸,y)

(33)

}

(34)

Eq. (34) is to be solved for the finite passage time probability subject to the boundary conditions,
lim m0 (Î¸, y) = m0 (Î¸, âˆ’âˆ) = 0 and m0 (Î¸, Î¸) = 1.

yâ†’âˆ’âˆ

Setting,
mâ€²0 (Î¸, y) =

(35)

âˆ‚
m0 (Î¸, y),
âˆ‚y

we have,
âˆ‚ â€²
Î±(y) â€²
m (Î¸, y) = âˆ’2
m (Î¸, y),
âˆ‚y 0
Î²(y) 0
or
mâ€²0 (Î¸, y)
Integrating one more time,

31

 Z
= lim C0 exp âˆ’2
â„“â†’âˆ’âˆ

m0 (Î¸, y) = C1 + lim C0
â„“â†’âˆ’âˆ


Î±(y â€² ) â€²
dy .
Î²(y â€² )

y

â„“

Z

â„“

y

(

exp âˆ’2

Z

y â€²â€²

â„“

Invoking the boundary conditions (35) yields the answer,
(
)
â€²â€²
y
R Î±(yâ€² ) â€²
Ry
exp âˆ’2 Î²(yâ€² ) dy dy â€²â€²
m0 (Î¸, y) = lim

â„“

â„“â†’âˆ’âˆ RÎ¸
â„“

â„“

(

exp âˆ’2

y
Râ€²â€²
â„“

Î±(y â€² )
â€²
Î²(y â€² ) dy

)

dy â€²â€²

Î±(y â€² ) â€²
dy
Î²(y â€² )

â‰¤1

)

for

dy â€²â€² .

y â‰¤ Î¸.

(36)

Note we have verified the claim made earlier that m0 (Î¸, y) = QÎ¸ (y, âˆ) â‰¤ 1. If is apparent that if Î±(y) and
Î²(y) are such that the limit of the right hand side of Eq. (36) is one, then,32
m0 (Î¸, y) = QÎ¸ (y, âˆ) = 1 â‡â‡’ GÎ¸ (y, âˆ) = 0

(37)

for all y, and then with probability one the first passage time is finite. We will see below that this is true
for the OUP.33
Now assume that condition (27) holds for n = 1,
lim t GÎ¸ (y, t) = 0,

tâ†’âˆ

âˆ€y.

Then (31) holds for n = 1, yielding the following expression for the mean first passage time,
Z âˆ

	
E TÎ¸ (y) = m1 (Î¸, y) =
GÎ¸ (y, t)dt.

(38)

0

Next integrate all terms in Eq. (32) by
âˆ’

Z

0

âˆ

Râˆ
0

qÎ¸ (y, t)dt = Î±(y)

( Â· )dt to obtain,

âˆ‚
âˆ‚y

Z

0

âˆ

âˆ‚2
1
GÎ¸ (y, t)dt + Î²(y) 2
2
âˆ‚y

Z

âˆ

GÎ¸ (y, t)dt.

0

31 Differential equations that can be solved in this manner, i.e., via successive integrations, are said to be â€œsolvable by
quadrature.â€
32 Note that the right hand side verifies (27) for n = 0.
33 That this holds for the OUP is also discussed on page 171 of [21].

12

Finally by invoking (37) and (38) we have the differential equation,
âˆ’1 = Î±(y)

1
âˆ‚2
âˆ‚
m1 (Î¸, y) + Î²(y) 2 m1 (Î¸, y),
âˆ‚y
2
âˆ‚y

(39)

which can be solved for the first moment m1 (Î¸, y) subject to the boundary condition,
m1 (Î¸, Î¸) = 0.
Equations (34) and (39) are special cases of the,34
DARLING & SIEGERT MOMENTS RECURSION [5]

âˆ’n mnâˆ’1 (Î¸, y) = Î±(y)

1
âˆ‚2
âˆ‚
mn (Î¸, y) + Î²(y) 2 mn (Î¸, y)
âˆ‚y
2
âˆ‚y

(40)

which is to be solved subject to the conditions,
mâˆ’1 (Î¸, y) = 0,

m0 (Î¸, Î¸) = 1 and mn (Î¸, Î¸) = 0 for

n â‰¥ 1.

The recursion (40) is straightforward to derive for n â‰¥ 1,35 assuming,Rfor now, that (27) holds for the desired
âˆ
values of n. This is done by integrating all terms in Eq. (32) by âˆ’n 0 tnâˆ’1 ( Â· )dt, to obtain,
âˆ’n

Z

0

âˆ

tnâˆ’1 qÎ¸ (y, t)dt = Î±(y)

âˆ‚
âˆ‚y

 Z
n

0

âˆ


 Z âˆ

1
âˆ‚2
tnâˆ’1 GÎ¸ (y, t)dt + Î²(y) 2 n
tnâˆ’1 GÎ¸ (y, t)dt ,
2
âˆ‚y
0

which from Eq. (28) and (31) immediately yields the moments recursion (40).
There is an alternative derivation of (40) that will allow us to replace the assumption that (27) holds
with the assumption of the existence of the passage time moments.36 Because,
qÎ¸ (y, t) = âˆ’

âˆ‚
GÎ¸ (y, t),
âˆ‚t

we have that Eq. (33) yields the first passage time diffusion equation (FPTDE) for the first passage time
probability density function,
FPTDE
âˆ‚
1
âˆ‚2
âˆ‚
qÎ¸ (y, t) = Î±(y)
qÎ¸ (y, t) + Î²(y) 2 qÎ¸ (y, t)
âˆ‚t
âˆ‚y
2
âˆ‚y
subject to qÎ¸ (y, 0) = 0 and qÎ¸ (Î¸, t) = 1

(41)

If we now integrate every term in this diffusion equation against tn ,37 we get,
Z âˆ
âˆ‚
1
âˆ‚2
âˆ‚
mn (y) + Î²(y) 2 mn (y).
tn qÎ¸ (y, t)dt = Î±(y)
âˆ‚t
âˆ‚y
2
âˆ‚y
0
34 This recursion is given as Eq. (6.5) in [5]. For now it assumes that condition (27) holds, though this will be slightly weakened
below and then replaced by the sufficient condition that the moments are assumed to exist.
35 The case n = 0 has been handled separately above.
36 The assumption of finite moments is the standard one encountered in the literature [5]. As mentioned previously assumption
(27) is used Rin [6].
37 I.e., by âˆ tn ( Â· )dt.
0

13

Then, integration by parts yields,
Z âˆ
Z âˆ
âˆ‚
tn qÎ¸ (y, t)dt = âˆ’n
tnâˆ’1 qÎ¸ (y, t)dt + lim tn qÎ¸ (y, t),
tâ†’âˆ
âˆ‚t
0
0
{z
}
|
mnâˆ’1 (Î¸,y)

so that,

âˆ’n mnâˆ’1 (Î¸, y) + lim tn qÎ¸ (y, t) = Î±(y)
tâ†’âˆ

1
âˆ‚2
âˆ‚
mn (y) + Î²(y) 2 mn (y).
âˆ‚y
2
âˆ‚y

It is immediately apparent that the Darling & Siebert Moments Recursion (40) holds if we assume that,
lim tn qÎ¸ (y, t) = âˆ’ lim tn

tâ†’âˆ

tâ†’âˆ

âˆ‚
GÎ¸ (y, t) = 0,
âˆ‚t

(42)

a condition which should be compared to condition (27). Condition (42) is equivalent to the condition,
lim tnâˆ’1 GÎ¸ (y, t) = 0,

tâ†’âˆ

which is actually weaker than condition (27).38 This is a consequence of Lâ€™HoÌ‚pitalâ€™s rule,
0 = lim tnâˆ’1 GÎ¸ (y, t) = lim
tâ†’âˆ

tâ†’âˆ

1
âˆ‚
âˆ‚GÎ¸ (y, t)/âˆ‚t
GÎ¸ (y, t)
= lim
=
lim tn GÎ¸ (y, t).
tâ†’âˆ (1 âˆ’ n)tâˆ’n
t1âˆ’n
1 âˆ’ n tâ†’âˆ âˆ‚t

A sufficient condition for Eq. (42) to hold, is that the n-th first passage time moment exist,
Z âˆ
tn qÎ¸ (y, t)dt < âˆ.
mn (Î¸, y) =
0

We have thus demonstrated the standard sufficient condition for recursion (40):
Sufficient Condition for the Darling & Siegert Moments Recursion to hold [5]
Assume that m0 (Î¸, y) = 1. If all first passage time moments exist for n â‰¤ n0 ,
mn (Î¸, y) < âˆ,

(43)

then the Darling & Siegert Moments Recursion (40) is valid for n â‰¤ n0 .
To actually verify condition (43) in an a priori manner is usually nontrivial. It involves analytical and/or
numerical knowledge of qÎ¸ (y, t) which is obtained from solving the diffusion equation (41). This is generally
a difficult task [1, 14]. Because of the difficulty in verifying (43), we will henceforth assume that all first
passage time nâ€“th degree moments, n â‰¥ 1, of interest exist.
A necessary condition that moments exist for n â‰¥ 1 is that m0 (Î¸, y) = 1. This is because if m0 (Î¸, y) < 1,
there must be nonzero probability mass at infinity which would case all moments n â‰¥ 1 to be infinite.39 So
ideally, at the very least, one should verify that m0 (Î¸, y) = 1. We do this for the OUP model in the next
subsection.
38 It is weaker because for the moments recursion (40) to hold for the n-th moment on the right hand side, it is now sufficient
for (27) to hold for only n âˆ’ 1.
39 This is discussed in [21].

14

We can solve Eq. (40) to obtain a recursive formula expressing the moment mn (Î¸, y) in terms of the lower
order moment mnâˆ’1 (Î¸, y). To do so let mn (y) = mn (Î¸, y) and define,
mâ€²n (y) =

âˆ‚
mn (y),
âˆ‚y

a(y) = 2

Î±(y)
Î²(y)

and b(y) = âˆ’2n

mnâˆ’1 (y)
.
Î²(y)

Then (for fixed Î¸) Eq. (40) becomes,
d â€²
m (y) + a(y)mâ€²n (y) = b(y).
dy n

(44)

This is a linear, inhomogenous first-order differential equation that can be solved by the standard method of
variation of parameters. The general solution is the sum of a particular solution, Ïˆp (y), and a homogeneous
solution, C0 Ïˆ(y), where C0 is a constant to be determined. For the homogeneous case, we have,
d
Ïˆ(y) + a(y)Ïˆ(y) = 0,
dy
which is solved by,40
 Z
Ïˆ(y) = exp âˆ’

y
â€²

a(y )dy

âˆ’âˆ

â€²



 Z
= exp âˆ’2

y

âˆ’âˆ


Î±(y â€² ) â€²
dy .
Î²(y â€² )

A particular solution is then given by,
Ïˆp (y) = Ïˆ(y)

Z

y

âˆ’âˆ

b(y â€² ) â€²
dy ,
Ïˆ(y â€² )

as can be readily checked. Thus, the general solution for mâ€²n (y) is,
mâ€²n (y) = C0 Ïˆ(y) + Ïˆp (y).
Another integration yields,
Z
mn (y) =

y

âˆ’âˆ

=

Z

y

(C0 Ïˆ(y â€²â€² ) + Ïˆp (y â€²â€² )) dy â€²â€² + C1
(Z â€²â€²
)
y

â€²

C0 exp

âˆ’âˆ

a(y )dy

â€²

â€²â€²

+ Ïˆ(y )

âˆ’âˆ

Z

y â€²â€²

âˆ’âˆ

b(y â€² ) â€²
dy
Ïˆ(y â€² )

!

dy â€²â€² + C1

The boundary condition mn (Î¸) = 0 leads to the choices C0 = 0 and,
!
Z yâ€²â€²
Z Î¸
b(y â€² ) â€²
â€²â€²
dy dy â€²â€² .
Ïˆ(y )
C1 = âˆ’
â€²)
Ïˆ(y
âˆ’âˆ
âˆ’âˆ
Then (note that y â‰¤ Î¸),
mn (y) = âˆ’

Z

Z

Î¸
â€²â€²

Ïˆ(y )

y

y â€²â€²

âˆ’âˆ

b(y â€² ) â€²
dy
Ïˆ(y â€² )

!

dy â€²â€² .

Thus we have shown that,
Z

Î¸

Z

y â€²â€²

mnâˆ’1 (y â€² ) â€²
mn (y) = 2n
Ïˆ(y )
dy
â€²
â€²
y
âˆ’âˆ Î²(y )Ïˆ(y )

 Z y
Î±(y â€² ) â€²
.
dy
where Ïˆ(y) = exp âˆ’2
â€²
âˆ’âˆ Î²(y )
â€²â€²

!

dy â€²â€²
(45)

40 Similarly to the derivation to m (y) done above, one more carefully would take the lower limit of integration to be â„“ and
0
then take â„“ â†’ âˆ’âˆ to deal with terms involving nonconvergent integrals. We avoid this fussiness for now, but later we will have
to bring the parameter â„“ into the foreground in order to obtain sensible answers.

15

In the literature rather than working with Ïˆ(y), it is more common to see results written in terms of

 Z y
Î±(y â€² ) â€²
âˆ’1
dy .
Ïˆ (y) = exp 2
â€²
âˆ’âˆ Î²(y )
For this reason we define,41

 Z y
C âˆ’1
C
Î±(y â€² ) â€²
W(y) =
Ïˆ (y) =
exp 2
dy .
â€²
Î²(y)
Î²(y)
âˆ’âˆ Î²(y )

(46)

Notice that the inclusion of the constant C in the definition of W(y) does not affect the formula in
Eq. (45), and thus we can rewrite (45) as the,
SIEGERT FORMULA [15]
!
Z yâ€²â€²
dy â€²â€²
â€²
â€²
â€²
mn (y) = 2n
W(y )mnâˆ’1 (y ) dy
â€²â€²
â€²â€²
y Î²(y )W(y )
âˆ’âˆ

 Z y
Î±(y â€² ) â€²
C
exp 2
dy .
with W(y) =
â€²
Î²(y)
âˆ’âˆ Î²(y )
Z

Î¸

(47)

This important relationship between consecutive moments of the passage time is referred to in the literature
as the Siegert formula [13, 14] and is given as Equation (3.14) in Siegertâ€™s original 1951 paper [15].42

2.6

Mean First Passage Time for the OUP

We now use the theory developed in the previous section to show that the first passage time is finite with
probability one and to compute the mean first passage time for the Ornstein-Uhlenbeck Process (OUP),
which is given by the SDE (10) with,
Î±(x) = Âµ âˆ’ Îºx, Îº > 0, and Î²(x) = Ïƒ 2 > 0,
so that,
dX = (Âµ âˆ’ Îºx) dt + Ïƒ dW.

As mentioned earlier dealing with the limit y â†’ âˆ’âˆ is a touchy issue. For this reason we proceed by
setting the lower limits in the integrals of the Siegert formula which are at âˆ’âˆ to the finite value â„“ and after
having formed the final quantities of interest we will take the limit â„“ â†’ âˆ’âˆ.43 Thus we will proceed via the
steps,
Z
Z
Z
function of

( Â· ) dy â†’ function of

( Â· ) dy â†’ lim

â„“â†’âˆ’âˆ

â„“

âˆ’âˆ

function of

( Â· ) dy.

â„“

41 The

quantity W(y) also has an important interpretation. it is often the case that C can be chosen so that W(y) is normalized
to be a probability density function. In this case it is not hard to show that W (x) is then the steady-state (t â†’ âˆ) probability
density function which is the stationary solution to the non-thresholded (forward) Fokker-Planck Equation (13),
âˆ’

1 âˆ‚2
âˆ‚
Î±(x)W(x) +
Î²(x)W(x) = 0
âˆ‚x
2 âˆ‚x2
W(x) = lim p(x, t|x0 , t0 ).
tâ†’âˆ

The derivation of W (x) as a solution to the steady-state Fokker-Planck equation is given in the Appendix.
42 This formula also appears to have been independently discovered by Johannesma (see Eq. (15) in [9]). Another early
reference to the Siegert formula in the context of neuronal modeling is given in [4] (see Eq. (5.1) in this latter reference).
43 The rigorous way to handle this case is to define the two boundary diffusion problem, â„“ < x < Î¸, with appropriate boundary
conditions at â„“ and Î¸. After the first passage time problem has been rigorously solve for this case, one can take â„“ â†’ âˆ’âˆ
[8, 12, 23, 6]. Rather than have to devote time to discuss the somewhat subtle issue of diffusion boundary conditions, in this
note we have opted to work with improper integrals and evaluate expressions containing such integrals as appropriately defined
limiting cases.

16

We begin by computing,
2

Zy
â„“

2
Î±(y â€² ) â€²
dy = 2
Î²(y â€² )
Ïƒ

Zy

2
= 2
Ïƒ

Zy

â„“

0

Îº
=âˆ’ 2
Ïƒ
Îº
=âˆ’ 2
Ïƒ
Îº
=âˆ’ 2
Ïƒ
This shows that,

(Âµ âˆ’ Îºy â€² )dy â€²

Z0
2
(Âµ âˆ’ Îºy )dy + 2 (Âµ âˆ’ Îºy â€² )dy â€²
Ïƒ
â„“

Îº  2
Âµ 
Âµ 
2
y âˆ’2 y + 2 â„“ âˆ’2 â„“
Îº
Ïƒ
Îº



2
2
Âµ
Âµ
Âµ
Âµ2
Îº
Âµ
Âµ2
2
2
y âˆ’2 y+ 2 +
âˆ’
+ 2 â„“ âˆ’2 â„“+ 2
Îº
Îº
ÎºÏƒ 2
ÎºÏƒ 2
Ïƒ
Îº
Îº

Âµ 2
Âµ 2
Îº 
yâˆ’
+ 2 â„“âˆ’
.
Îº
Ïƒ
Îº
â€²

â€²

ï£± y
ï£¼

 


ï£² Z Î±(y â€² ) ï£½
Âµ 2
Âµ 2
Îº
Îº 
â€²
exp 2
exp
,
y
âˆ’
â„“
âˆ’
dy
=
exp
âˆ’
ï£³
Î²(y â€² ) ï£¾
Ïƒ2
Îº
Ïƒ2
Îº

(48)

â„“

and

exp

ï£±
ï£²
ï£³

âˆ’2

Zy
â„“

ï£¼



 
Î±(y â€² ) â€² ï£½
Îº 
Âµ 2
Âµ 2
Îº
exp
âˆ’
.
y
âˆ’
â„“
âˆ’
dy
=
exp
Î²(y â€² ) ï£¾
Ïƒ2
Îº
Ïƒ2
Îº

(49)

The latter expression allows Eq. (36) to be written as,

m0 (Î¸, y) =

Ry

lim â„“
â„“â†’âˆ’âˆ RÎ¸

exp
exp

â„“

n

n

Îº
Ïƒ2

y â€²â€² âˆ’

Îº
Ïƒ2

y â€²â€² âˆ’


Âµ 2
Îº

Âµ 2
Îº

o
o

dy â€²â€²
= 1,
dy â€²â€²

for all y â‰¤ Î¸,

(50)

showing that the probability of the OUP neuron firing in a finite time is one.44
Having shown that m0 (y) â‰¡ 1, from the Siegert formula (47) and Eq. (48) we can compute m1 (y),45
!
Z Î¸
Z yâ€²â€²
dy â€²â€²
â€²
â€²
m1 (y) = 2
W(y ) dy
â€²â€²
â€²â€²
y Î²(y )W(y )
âˆ’âˆ
ï£±
ï£¼
ï£«
ï£¶
yâ€²
ï£´
ï£´
â€²â€²
Z
Z
Z Î¸
ï£²
ï£½
y
Î±(y)
dy â€²â€²
ï£·
)ï£¬
(
exp âˆ’2
= lim 2
dy dy â€² ï£¸
ï£­
â€²â€²
y
ï£´
â„“â†’âˆ’âˆ
ï£´
Î²(y)
R Î±(yâ€² )
âˆ’âˆ
y
ï£³
ï£¾
â„“
Ïƒ 2 exp âˆ’2 Î²(yâ€² ) dy â€²
â„“

=2

Z

y

Î¸

dy

â€²â€²

n
2 o
Ïƒ 2 exp âˆ’ ÏƒÎº2 y â€²â€² âˆ’ ÂµÎº

!


Îº  â€² Âµ 2
exp âˆ’ 2 y âˆ’
dy â€²
Ïƒ
Îº
âˆ’âˆ

Z

y â€²â€²

After some rearrangement and variable renaming this becomes the OUP/LIF Mean First Passage Time
(OUP-MFPT) formula,
44 See

also Eq. (9.237) of [21]. Note that we have satisfied the necessary condition that all higher order moments exist.
that it exists, m1 (y) < âˆ.

45 Assuming

17

Siegert formula for the OUP-MFPT
Âµ
Î¸âˆ’
âˆšÎº
Îº

âˆš Ïƒ/
Z
Ï€
m1 (Î¸, y) =
Îº

ÎºÎ¸âˆ’Âµ
âˆš
Îº

e

Âµ
yâˆ’
âˆšÎº
Ïƒ/ Îº

z2
2

âˆš ÏƒZ
Ï€
(1 + erf(z)) dz =
Îº

e

z2
2

(1 + erf(z)) dz

(51)

Îºyâˆ’Âµ
âˆš
Ïƒ Îº

where erf denotes the error function. This result is well known in the literature. Reference [14] refers to it
as the Siegert formula, despite its specialization to the case of the first moment, because it is readily derived
from the general Siegert formula (47) as we have done here.
Via use of the general Siegert formula (47) one can now proceed to derive the second moment of the first
passage time for the OUP, and hence the variance of the passage time from knowledge of both the first and
second moments. The form of the solutions (though not the details of the computations) can be found in
[19], though represented in term of the normal integral (which is closely related to the error function).

3

Mean Firing Rate for the OUP/LIF Neuron

Exploiting the fact that under the assumptions described in Section 1 the LIF subthreshold dynamics describe
an Ornstein-Uhlenbeck process (OUP), we have been able to derive the mean first passage time (MFPT) for
the neuron to hit the firing threshold after a reset at time t = 0. Specifically, MFPT as a function of the
threshold value Î¸ and the membrane voltage reset value v0 is given by Eq. (51),
Tb = TbÎ¸ (x0 ) = E{TÎ¸ (x0 )} = m1 (Î¸, v0 ).

As discussed above, once the MFPT is at hand, the mean time-to-fire (MTF) of the OUP/LIF neuron,
Tbf = E(Tf ) = Tr + E(T ) = Tr + Tb,

is used to form the average firing rate (AFR) of the neuron,
Ï = Tbfâˆ’1 =

1

Tr + Tb

.

Recall from Eq. (5) that of all the parameters that define the OUP/LIF neuron, only
1
1
(52)
Vr + Ibsyn + I0
Ï„
C
is generally under our immediate control. It is evident that the first two terms on the right-hand-side of this
equation can have a confounding effect that must be compensated for. Given the relationship between Âµ(I0 )
and the injected current (52), and recalling that,
Âµ = Âµ(I0 ) =

1
1
=
,
Ï„
RC
we obtain the Siegert formula which shows how I0 affects the mean firing rate for the OUP/LIF Neuron
(LIF-MFR) in terms of the parameters defining the LIF-MFR neuron,
Îº=

Siegert formula for the LIF-MFR
ï£«

ï£¬
âˆš
Ï(I0 ) = ï£¬
ï£­Tr + Ï„ Ï€

Âµ(I0 ) =

Î¸âˆ’Ï„ Âµ(I0 )
âˆš
Ï„Ïƒ

Z

e

yâˆ’Ï„ Âµ(I0 )
âˆš
Ï„Ïƒ

1
1
Vr + Ibsyn + I0 ,
Ï„
C
18

z2
2

ï£¶âˆ’1

ï£·
(1 + erf(z)) dz ï£·
ï£¸

Ï„ = RC

(53)

As mentioned in the first section of this note, the OUP-LIF is a tremendously simplified model of
neuronal dynamics. There is much research activity involved with relaxing the model assumptions. As one
can imagine, determining the mean first passage time for more complex is a highly nontrivial endeavor. A
low-order correction to the LIF-MFR (53) to partially account for synaptic capacitive effects is given in [3].
Further relevant modeling issues are discussed in the survey paper [11].

Appendix â€“ Stationary Distribution of the Unrestricted FPE
The Markovian probabilistic behavior of the homogeneous stochastic differential equation (10) is described
by the transition probability density function, p(x, t|x0 , t0 ), which is a solution to the (forward) Fokker-Planck
Equation (13) subject to the initial condition (14) and the unrestricted boundary conditions (15). Under
reasonable conditions on the SDE (10), in the limit as t â†’ âˆ the pdf p(x, t|x0 , t0 ) converges to a steady-state
density, W(x), which is independent of the time, t, and of the initial information (x0 , t0 ) [6, 23],
W(x) = lim p(x, t|x0 , t0 ).
tâ†’âˆ

Since in the limit the steady-state density W(x) is independent of the initial condition (14), and
it must solve the steady-state (forward) Fokker-Planck equation,
âˆ’

âˆ‚
1 âˆ‚2
Î²(x)W(x) = 0,
Î±(x)W(x) +
âˆ‚x
2 âˆ‚x2

subject to the boundary conditions (15) and the pdf normalization condition,
Z
W(x)dx = 1.

(A.1)
âˆ‚
âˆ‚t W(x)

= 0,

(A.2)

(A.3)

Note that we can rewrite Equation (A.2) as
 


âˆ‚
âˆ‚
Î²(x)W(x) âˆ’ 2Î±(x)W(x) = 0,
âˆ‚x âˆ‚x
which yields,

assuming that,46




âˆ‚ 
Î²(x)W(x) âˆ’ 2Î±(x)W(x) = 0,
âˆ‚x


 
  
âˆ‚ 

= 0.
= Î±(x)W(x) 
Î²(x)W(x)

âˆ‚x
x=âˆ’âˆ
x=âˆ’âˆ

An additional integration yields,


 Z x
C
Î±(xâ€² ) â€²
W(x) =
exp 2
dx ,
â€²
Î²(x)
âˆ’âˆ Î²(x )

assuming that,

where C is a constant of integration.




Î²(x)W(x) 

(A.4)

= 0,
x=âˆ’âˆ

46 Note that these are stronger conditions than merely requiring that W(âˆ’âˆ) = 0. They correspond to conditions being
placed on Î±(x) and Î²(x) (i.e., on the SDE (10)).

19

Note the equivalence of equations (46) and (A.4). If we chose the constant C to ensure that W(x) is a
properly normalized probability density function, we obtain the following pdf as a steady-state solution to
the Fokker-Planck equation,
)
(
x
R
â€²
Î±(x
)
â€²
Î²(x)âˆ’1 exp 2
Î²(xâ€² ) dx
W(x) =

Râˆ

Î²(xâ€²â€² )âˆ’1

(

âˆ’âˆ

exp 2

âˆ’âˆ

x
Râ€²â€²

âˆ’âˆ

Î±(xâ€² )
â€²
Î²(xâ€² ) dx

)

.

(A.5)

dxâ€²â€²

For the Ornstein-Uhlenbeck process (OUP) (6)â€“(9) we have,
Î±(x) = Î±0 âˆ’ Î±1 x = Âµ âˆ’ Îºx and Î²(x) = Î²0 = Ïƒ 2 .
This yields,

 x
R
exp Ïƒ22 (Âµ âˆ’ Îº xâ€² ) dxâ€²
â„“
(
)
â€²â€²
x
Râˆ
R
2
â€²
â€²
exp Ïƒ2 (Âµ âˆ’ Îº x ) dx dxâ€²â€²

W(x) = lim

â„“â†’âˆ’âˆ

âˆ’âˆ

= lim

Râˆ

â„“â†’âˆ’âˆ



exp
(

exp

âˆ’âˆ

=

Râˆ

âˆ’âˆ



exp
(

exp

2
Ïƒ2

2
Ïƒ2

Rx
0

x
Râ€²â€²
0

â„“

2
Ïƒ2

x
R

(Âµ âˆ’ Îº xâ€² ) dxâ€² +

0

x
Râ€²â€²

2
Ïƒ2

0

(Âµ âˆ’

â€²

â€²

(Âµ âˆ’ Îº x ) dx
(Âµ âˆ’

Îº xâ€² ) dxâ€²

)

â„“

R0
â„“



Îº xâ€² ) dxâ€²

+

R0

(Âµ âˆ’ Îº xâ€² ) dxâ€²
(Âµ âˆ’

Îº xâ€² ) dxâ€²



!)

dxâ€²â€²

dxâ€²â€²

	

exp Ïƒ22 Âµ x âˆ’ 21 Îº x2
= Râˆ
.
2
	
1
â€²â€²2
â€²â€²
â€²â€²
exp Ïƒ2 Âµ x âˆ’ 2 Îº x
dx
âˆ’âˆ

Now note that,






Âµ
Âµ  2 Âµ2
Âµ2
Âµ2
1 2
2
+
.
2 Âµ x âˆ’ Îº x = âˆ’Îº x âˆ’ 2 x + 2 âˆ’ 2 = âˆ’Îº x âˆ’
2
Îº
Îº
Îº
Îº
Îº
Thus,

n
2 o
exp âˆ’ ÏƒÎº2 x âˆ’ ÂµÎº
,
W(x) = Râˆ
n
2 o
dxâ€²â€²
exp âˆ’ ÏƒÎº2 xâ€²â€² âˆ’ ÂµÎº
âˆ’âˆ

or,

W(x) =
which is a Gaussian pdf with mean
47 E.g.,

Âµ
Îº

r



Âµ 2
Îº 
Îº
,
exp âˆ’ 2 x âˆ’
Ï€Ïƒ 2
Ïƒ
Îº

and variance

Ïƒ2
2Îº.

see [21].

20

This is a standard result.47

(A.6)

References
[1] L Alili, P Patie, and Jesper Lund Pedersen. Representations of the first hitting time density of an
ornstein-uhlenbeck process 1. Stochastic Models, 21(4):967â€“980, 2005.
[2] D.J. Amit and M.V. Tsodyks. Quantitative study of attractor neural network retrieving at low spike
rates I: Substrate - spikes, rates and neuronal gain. Network, 2:259â€“273, 1991.
[3] N. Brunel and S. Sergi. Firing frequency of integrate-and-fire neurons with finite synaptic time constants.
Journal of Theoretical Biology, 195:87â€“95, 1998.
[4] R.M Capocelli and L.M Ricciardi. Diffusion approximation and first passage time problem for a nodal
neuron. Kybernetik, 8(6):214â€“223, 1971.
[5] D.A. Darling and A.J.F. Siegert. The first passage problem for a continuous markov process. The
Annals of Mathematical Statistics, 24:624â€“639, 1953.
[6] C.W. Gardiner. Stochastic methods. Springer-Verlag, Berlinâ€“Heidelbergâ€“New Yorkâ€“Tokyo, 4th edition,
2009.
[7] W. Gerstner and W.M. Kistler. Spiking Neuron Models: Single Neurons, Populations, Plasticity. Cambridge University Press, Cambridge UK, 2002.
[8] N.S. Goel and N. Richter-Dyn. Stochastic Models in Biology. Academic Press, New York, 1974.
[9] P.I.M. Johannesma. Diffusion models for the stochastic activity of neurons. In E.R. Caianiello, editor,
Neural Networks â€“ Proceedings of the School on Neural Networks June 1967 in Ravello, pages 116â€“144.
Springer-Verlag, New York, 1968.
[10] A. Papoulis and S.U. Pillai. Probability, Random Variables, and Stochastic Processes. McGraw-Hill,
Boston, 4th edition, 2002.
[11] A. Renart, N. Brunel, and X.-J. Wang. Mean-field theory of irregulary spiking neuronal populations
and working memory in recurrent cortical networks. In J. Feng, editor, Computational Neuroscience â€“ A
Comprehensive Approach, chapter 15, pages 431â€“490. Chapman & Hall/CRC, Boca Ratonâ€“Londonâ€“New
York, 2003.
[12] L.M. Ricciardi. Diffusion Processes and Related Topics in Biology. Springer-Verlag, Berlin-HeidelbergNew York, 1977.
[13] L.M. Ricciardi and S. Sato. Diffusion processes and first-passage-time problems. In L.M. Ricciardi, editor, Lectures in Applied Mathematics and Informatics, chapter 5, pages 206â€“285. Manchester University
Press, Manchesterâ€“New York, 1990.
[14] L. Sacerdote and M.T. Giraudo. Stochastic integrate and fire models: A review on mathematical methods and their applications. In M. Bachar, J. Batzel, and S. Ditlevsen, editors, Stochastic Biomathematical Models with Applications to Neuronal Modeling, chapter 5, pages 99â€“148. Springer, Heidelbergâ€“New
Yorkâ€“Dordrechtâ€“London, 2013.
[15] A.J.F. Siegert. On the first passage time probability problem. Physical Review, 81(4):617â€“623, 1951.
[16] R.B. Stein. A theoretical analysis of neuronal variability. Biophysical Journal, 5(2):173â€“194, 1965.
[17] R.B. Stein. Some models of neuronal variability. Biophysical Journal, 7(1):37â€“68, 1967.
[18] D. Sterratt, B. Graham, A. Gillies, and D. Willshaw. Principles of Computational Modelling in Neuroscience. Cambridge University Press, Cambridge UK, 2011.
21

[19] M.U. Thomas. Some mean first-passage time approximations for the Ornstein-Uhlenbeck process. Journal of Applied Probability, 12(3):600â€“604, 1975.
[20] H.C. Tuckwell. Introduction to Theoretical Neurobiology: Volume 1, Linear Cable Theory and Dendritic
Structure. Cambridge University Press, Cambridge UK, 1988.
[21] H.C. Tuckwell. Introduction to Theoretical Neurobiology: Volume 2, Nonlinear and Stochastic Theories.
Cambridge University Press, Cambridge UK, 1988.
[22] H.C. Tuckwell. Stochastic Processes in the Neurosciences. SIAM, Philadelphia, 1989.
[23] N.G. van Kampen. Stochastic Processes in Physics and Chemistry. Elsevier, Amsterdam, 3rd edition,
2007.

22

