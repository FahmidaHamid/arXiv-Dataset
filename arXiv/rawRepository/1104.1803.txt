1

Flow Cytometry Based State Aggregation
of a Stochastic Model of Protein Expression

arXiv:1104.1803v1 [math.PR] 10 Apr 2011

Anahita Mirtabatabaei, Francesco Bullo, Mustafa Khammash

Abstract— In this article, we introduce the new approach
fluorescence grid based aggregation (FGBA) to justify a dynamical model of protein expression using experimental fluorescence
histograms. In this approach, first, we describe the dynamics of
the gene-protein system by a chemical master equation (CME),
while the protein production rates are unknown. Then, we
aggregate the states of the CME into unknown group sizes. We
show that these unknown values can be replaced by the data
from the experimental fluorescence histograms. Consequently,
final probability distributions correspond to the experimental
fluorescence histograms.

I. I NTRODUCTION
In the study of protein expression, flow cytometry is a
promising technique for the analysis of protein regulatory
system [11], [9], [13]. In a cell colony, flow cytometery
measures single cell’s fluorescent intensity, which represents the protein concentration, and draws a fluorescence
histogram. A fluorescence histogram of a cell colony is a
plot of the cell count versus measured fluorescent intensity
[17]. In theory, the process of protein expression has been
stochastically analyzed to generate a probability distribution
of protein concentration. However, there are two deficiencies
to this analysis. First, generated probability distributions
do not represent the experimental fluorescence histograms,
since the relation between fluorescent intensity and protein
concentration is unknown. Second, the protein production
rate, which is a key parameter in stochastic analysis of
expression, is not known for different expression states of
a gene.
In this paper, we study the expression of a protein called
Ag43 by a gene named agn43. This protein is not involved
in feedback regulation, and instead the encoding gene uses a
mechanism of generating multiple phases in order to regulate
the protein production. Phase variation describes changes in
the expression state of the gene that results in mixed cell
cultures in a colony [16]. A gene is called to have an On,
Partial, or Off expression state, if it produces protein with
a high, low, approximately zero rate, respectively. In the
mechanism of agn43 regulation, between phases with On and
Off expression states, the gene enters intermediate phases
that act as buffers and prevent back and forth switching.
Recently, Lim et al. (2007) proposed a dynamical model
for the phase variation of agn43 and identified a third
expression state, Partial, for the gene. They verified the
model deterministically, and computed the phase variation
rates of the gene. However, the protein production rates in
those three expression states are unknown, and the dynamics
of the protein production is not analyzed.

As our main contribution, we introduce a new approach to
justify the dynamical model of gene-protein system by the
experimental fluorescence histograms. We call this approach
the fluorescence grid based aggregation (FGBA). First, we
compute the rate of increase in cell’s fluorescent intensity
by the steady state histograms. This rate has a linear relation
with the protein production rate. Second, assuming that the
stochastic dynamics of the gene-protein system is a Markov
process, we describe this system by a chemical master
equation (CME), while the protein production rates, for
different expression states, are unknown. Third, we aggregate
the states of the CME into groups with unknown sizes, and
compute the dynamics of the aggregated system. Aggregation
of Markov chains, also known as sparse grid approximation
[5] and projection through interpolation [12], has been employed to the gene regulatory networks in order to reduce
the computation time. However, in those studies, the number
of states being aggregated and the protein production rates
were known, as opposed to our method. In FGBA method,
we aggregate the CME based on the fluorescence grid sizes
in experimental fluorescence histograms. By employing this
method on the CME (3), we achieve the following goals: (1)
we eliminate the dependence of the CME on protein number,
and hence, its dependence on unknown protein production
rates; (2) we define CME as a function of fluorescent
intensity, solving which gives final probability distributions
that correspond to the experimental fluorescence histograms;
and (3) we reduce the size of the differential CME to reduce
the computation time. Finally, we find an upper bound for the
evolution of the error caused by employing FGBA method.
The paper develops as follows. The remainder of this
section reviews the studied gene and protein. The deterministic and stochastic analysis of the gene-protein system is
discussed in Sections II and III, respectively. The FGBA
method and its error are presented in Subsection III-A.
Numerical results are provided in Section IV. Finally, some
conclusions are drawn in Section V.
A. Gene-Protein System
Antigen 43 (Ag43) is an outer membrane protein in the
bacteria Escherichia coli and is described as its ”most
abundant phase varying outer membrane protein” [7]. This
protein is encoded by a single gene called agn43 or flu.
Flu is an abbreviation of fluffing due to the fact that the
production of Ag43 causes interspecies cell aggregation by
Ag43-Ag43 interaction. Hence, the expression of this protein
enhances biofilm formation. As mentioned above, the phase

2

variation of agn43 regulates production of Ag43. In agn43,
phase variation is performed by an epigenetic switch. An
epigenetic switch can be defined as a heritable yet reversible
switch in gene expression state, which is not mediated by
a change in DNA sequence [16]. Therefore, agn43 is a
controllable toggle switch. As a practical device, a toggle
switch forms a synthetic, addressable cellular memory unit
and has implications for biotechnology, biocomputing and
gene therapy [4].
The dynamics of phase variation in agn43 is studied separately by [11] and [16]. A schematic of the model proposed
by [11] is illustrated in Figure 1. The methylation state
of three GATC sequences along the gene decides whether
the expression is On (methylated) or Off (unmethylated).
The methylation state of the GATC sites is determined
by competitive binding between OxyR, a global oxidative
stress protein, and DNA adenine methylase (Dam). Since
there is no DNA demethylation reaction, gene replication
is essential to the phase variation. After each replication:
fully methylated agn43 (MF ), whose expression state is On,
becomes hemimethylated (MH ); the hemimethylated agn43
generates one hemimethylated and one unmethylated and
naked agn43 (UN ); and the gene in the rest of phases keeps
its initial phase. In Lim’s model, the expression state of MH
is said to be either On or Partial, while we assume this
expression to be On, according to the heritable expression
state of agn43 [15]. OxyR can bind to UN and generate
an unmethylated agn43 with OxyR (UO ). In Lim’s phase
variation model, agn43 in UN and UO phases partially
transcribes protein, as opposed to the model proposed by
Marjan et al. (2008). In Lim’s model the DNA in UO phase
can undergo a conformational change, giving rise to an Off
phase (O) with Off expression state.
II. D ETERMINISTIC A NALYSIS
The deterministic dynamics of the agn43-Ag43 system can
be divided into three parts: gene’s phase variation, protein
production, and the gene replication during cell division.
A. Dynamics of Phase Variation
We briefly review the dynamics of agn43 phase variation
in Lim’s model. According to Section I-A, five phases and
three expression states are assigned to agn43: MF , MH , UN ,
UO , and O phases with On, On, Partial, Partial, and Off
expression states, respectively. As illustrated in Figure 1, the
dynamics of these five phases can be written as:
ṀF (t) = kM MH (t), M˙H (t) = kH UN (t) − kM MH (t),
U̇N (t) = k−O UO (t) − (kO + kH )UN (t),

U̇O (t) = k−R O(t) + kO UN (t) − (k−O + kR )UO (t),
Ȯ(t) = −k−R O(t) + kR UO (t).

According to the supplementary methods of [11], kM = 4.3,
kR
kO
k−O = 3.7, and k−R = 15.8. Based on our sensitivity
analysis, we used kH = 0.4. Here, we need two more
equalities to compute all the phase varying rates. Owing
to rare On-Off switching of the agn43 (7 × 10−3 cells per

βon
MF
100%
50%

↑

βon

↑

βpartial

↓↑

βpartial

↓↑

βoff

kM

MH

kH

50%
100%

UN

100%

UO

100%

O

kO k−O
kR k−R

xg

→

γ

∅

xg

→

γ

∅

xg

→

γ

∅

xg

→

γ

∅

xg

→

γ

∅

Fig. 1.
Lim’s dynamical model of agn43-Ag43. The gene has five
phases MF , MH , UN , UO , and O, with On, On, Partial, Partial, and
Off expression states, respectively. Depending on the expression state, the
protein xg is produced with three different rates βon , βpartial , and βoff , but
degrades with fixed rate γ. The arrows on the left represent the effect of
replication on the phase of the gene.

generation), kH  kO , hence we assume that kO = 1000kH .
Finally, considering the steady state of the system, it can be
computed that kR = 0.118kO .
B. The Dynamics of the Protein Production
A useful function that describes protein production rate
in many real genes is Hill function [2]. According to this
function, in the absence of activator and repressor, the protein
production rate is constant. As discussed in Section I-A, there
is no feedback regulation in the production of Ag43 and the
concentration of external factors, OxyR and Dam, during cell
growth is constant by over expression. Thus, the dynamics
of protein production can be described by
ẋg (t) = β − γxg (t),

(1)

where xg (t), β, and γ represent the concentration, production
rate, and degradation rate of the reporter protein, respectively.
In the experiments by [11], green fluorescent protein (GFP)
is used as a reporter, and its production is regulated by agn43.
GFP exhibits fluorescence in the cell, that can be measured
by flow cytometry. Based on the method of generating and
amplifying the expression of GFP in [11], we assume that
there is a linear relation between the rates of Ag43 production
and GFP production in the cell. However, their degradation
is independent of each other, and the latter is measurable by
flow cytometer. Therefore, we consider the dynamics of GFP
production to verify the model by experimental results.
The rate γ is the sum of dilution and degradation rates.
Dilution is the reduction of protein density due to increase
in cell volume. Since a flow cytometer measures the total
fluorescence of a cell rather than the density of fluorescence,
the dilution rate is zero here. Degradation rate is computed by
protein’s half life τ while its production rate is zero. That is,
xg (τ ) = xg (0)/2 = xg (0)e−γτ , and thus γ = ln 2/τ . Half
life of wild type GFP is 26 hours [3], and one generation
takes 85 minutes [11], therefore, γ is equal to 0.0378 protein
per generation.
The protein production rate β depends on the expression
state of the gene, On, Partial, or Off. Consider a gene that

3
βon

↑

kM

MH

↑

↓↑k

kO

UO

−O

↓↑k

kR

Fig. 2. Three fluorescence histograms of cell colonies in three different
expression states after 20 hours. This plot tells us that the steady state
fluorescent intensity of a cell whose agn43 has On, Partial, or Off expression state is 103.5 , 101.8 , or 10 a.u., respectively. Reprinted figure with
c
permission from [11]. 2007,
by Nature Publishing Group.

remains in one expression state as time goes to infinity.
Then, the protein concentration of the cell reaches a steady
state xg,∞ , and thus limt→∞ ẋg (t) = 0. It follows from
equation (1) that β = γxg,∞ protein per generation. Our tool
to compute xg,∞ is the experimental fluorescence histogram,
e.g., Figure 2. However, for each expression state, such
histogram gives us the fluorescent intensity of a cell in
steady state in arbitrary units (a.u.) instead of the protein
concentration.
In a cell, the fluorescent intensity xf depends linearly
on protein (GFP) concentration, see [1] and [14]. That is,
xf (t) = µxg (t), where we call µ the fluorescence-GFP ratio,
and its value unknown. Taking the derivative of both sides
gives
ẋf (t) = µ(β − γxg (t)) = µβ − γxf (t) = βf − γxf (t), (2)
where βf denotes the rate of increase in fluorescent intensity
of the cell. According to Figure 2, the steady state fluorescent
intensity xf,∞ of a cell whose agn43 has On, Partial, or Off
expression state is 103.5 , 101.8 , or 10 a.u., respectively. It
follows from βf = γxf,∞ that βf,on = 238, βf,partial = 3,
and βf,off = 0.37 a.u. per generation.

O

kH

→
←
γ

βoff

→
←
γ

...

βon

→
←
2γ

↑

βpartial

↓↑k

kO

βpartial

−R

0

↑

βpartial

→
←
γ

→
←
2γ

kM

βon

→
←
γ

kH

UN

βon

→
←
γ

MF

→
←
2γ

−O

↓↑k

kR

βpartial

→
←
2γ

−R

1

βoff

→
←
2γ

...
xg
2 ...

Fig. 3. Each circle represents one possible configuration for a cell that
contains agn43, based on the cell’s protein concentration (horizontal axis)
and its gene’s phase (vertical axis). The transitions between configurations,
shown by arrows, is possible through phase variation (red arrows) or change
in protein concentration (black arrows). For brevity, the effect of cell
replication on protein concentration is not illustrated.

In other words, we compute the probability of a cell being
in any configuration, which is here determined by its gene’s
phase plus its protein concentration, as a function of time.
Therefore, a cell’s configuration changes based on: (1) phase
variation rates, (2) protein production and degradation rates,
and (3) replication rates, see Figure 3. For each cell, the
probability of having any such configuration is a function
of time, and the union of those probabilities makes up the
probability distribution vector P (t). More specifically, the
first five entries of P (t) represent the probability of a cell
having no protein and a gene with MF , MH , UN , UO , and
O phases, respectively; the second five entries represent the
probability of the cell having one protein and a gene in
mentioned phases; and so on. This probability vector evolves
according to a continuous-time Markov process, which is
called the chemical master equation (CME):
Ṗ (t) = AP (t) + DP (t),

(3)

C. Replication Rates
Replication of the cell has two effects in our model. First,
we assume that the protein concentration of the cell becomes
half of its initial value. This assumption is based on two
reasons: ”in immunofluorescence studies of Ag43-producing
E. coli, the protein is seen evenly distributed over the surface
of the entire cell” [6]; and, in our stochastic analysis we have
observed that employing binomial distribution for protein
concentration after replication has a negligible effect on the
final probability distribution, see Figure 5. Second, after
replication the gene’s phase vary: any MF gene becomes
MH ; half of MH genes become UN , and the other half
remain MH ; and genes in the rest of phases keep their initial
phase, see Figure 1.
III. S TOCHASTIC A NALYSIS
We aim to describe the dynamics of the protein expression
by the phase varying gene agn43 by a Markovian process.

where the transition matrix A contains phase varying rates,
and protein production and degradation rates, and D is the
replication matrix. According to the system’s deterministic
dynamics, we compute the building blocks of the transition
matrix, i.e., phase variation matrix K and protein production
matrix B:


0
0
0
0
0

kM
0
0

−kM
kH
0

0
−kH − kO
k−O
K=


0
kO
−k−O − kR
0
0
kR

βon 0
0
0
0
 0 βon
0
0
0

0 βpartial
0
0
B=
 0
 0
0
0
βpartial
0
0
0
0
0
βoff

0
0
0
k−R
−k−R



.






,



4

If we denote the identity matrix of size five by I5 , then

K −B
γI5
0
...

B
K
−
B
−
γI
2γI
0
5
5

A=
0
B
K
−
B
−
2γI
3γI
5
5

..
..
.
.




.


(4)
After replication, as mentioned in Section II-C, any configuration transforms into another configuration with half protein
concentration. Hence, the replication matrix can be written
as D = −I + D+ . The negative identity matrix represents a
continuous reduction in the probability of all configurations
due to reduction in protein concentration. The D+ matrix
contains the information on phase change and is composed
of the blocks


0 0 0 0 0
 1 0.5 0 0 0 


+

(5)
Di,j
=
 0 0.5 1 0 0  ,
 0 0 0 1 0 
0 0 0 0 1
where the protein concentration of the ith five configurations
is approximately half of that of the jth five configurations.
Note that in computing the rates, one unit time is equal to
one generation or the time between two replications.
A. Fluorescence Grid Based Aggregation
Aggregation or lumping of Markov chains has been known
for a long time [10]. Here, we aggregate the states of Markov
chain Ṗ (t) = AP (t) into groups of m1 , m2 , . . . states by a
linear aggregation operator E:
 m1

z }| {

 1...1 0...


m2


z }| {


E =  0...0 1...1 0 ...
.






..
..
.
.
Therefore, the aggregated probability vector at time t, is
equal to Pagg (t) = EP (t). Taking the derivative of both
sides gives Ṗagg (t) = E Ṗ (t) = EAP (t). To find the
dynamics of Pagg (t) independent of P (t), we define P (t)
as an approximate function of Pagg (t). We assume that the
probability of being in state i is equal to the aggregated
probability of being in the group that contains i divided by
the number of states in that group, that is,
P (t) ' F Pagg (t),
where F is the disaggregation operator and

1 
0
m1 


..
..

m
.  1
.


1 
0
 m1

1 
0
0
F =
m2 


..
..
..


.
.
.  m2

1 

0
0
m2

..
..
.
.

(6)


... 




.

... 





Now, consider the following approximated aggregated
Markov chain
Pa (0) = Pagg (0) = EP (0),
Ṗa (t) = EAF Pa (t).

(7)

Based on assumption (6), the evolution of the solution Pa (t)
can approximate the evolution of the aggregated probability
vector Pagg (t).
Remark 1 (Properties of aggregation). First, our linear aggregation method is not lumpable [10], or unbiased [8]: a
Markov chain is lumpable with respect to an aggregation
if the transitions and states inside any partition group also
compose a Markov chain. The class of Markov chains which
admits this exact aggregation was investigated in [10] and
proved to be quite narrow. In our aggregation method the necessary and sufficient condition for lumpability of the CME
is CBAC = AC. It is easy to see that this equality does
not always hold, and thus our aggregation is not lumpable.
Second, our aggregation is regular [8]: an aggregation is
regular if it is both linear and state partitioning. Being state
partitioning means that the aggregator should assign each
state of Markov process to be aggregated to exactly one super
state. It can be easily checked that our aggregation is state
partitioning.
Before proceeding to the theorem, define fluorescence rate
matrix Bf to be equal to a protein production matrix B
whose entries (e.g., βon ) are replaced by the corresponding
fluorescence based production rates (e.g., βf,on ), see Section II-B.
Theorem III.1 (FGBA algorithm). Consider a gene-protein
system that can be described by the CME Ṗ (t) = AP (t),
where the transition matrix A is given by equation (4). From
the experimental fluorescence histograms, extract the fluorescence grids ∆1 , ∆2 , . . . and the fluorescence rate matrix Bf .
Then the solution to the following fluorescence based CME
simulates the experimental fluorescence histogram:
Ṗf (t) = Af Pf (t),
Af =

0
...
K − ∆11 Bf
1
1

B
K
−
B
0
f
f
∆1
∆2

1

0
K − ∆13 Bf 0
∆2 B f

..
..
.
.

γ∆1
I
0
.
.
.
0
5
∆2

γ(∆1 +∆2 )
γ∆
I5
0
 0 − ∆21 I5
∆3

+
γ(∆1 +∆2 )
γ(∆1 +∆2 +∆3 )
0
0
−
I
I5
5
∆3
∆4

..
..
.
.









,
0 


(8)
where Pf (0) is computed based on the initial state of the
system in the experiments.
Remark 2. In Theorem III.1, the phase variation matrix K
can be any arbitrary matrix with zero column sum.
Proof: [Proof of Theorem III.1] First, we aggregate
the states of the initial CME Ṗ (t) = AP (t) by lumping

5

the configurations with different protein numbers but same
phase, that is, the configurations along the x-axis of Figure 3.
Therefore, in above mentioned aggregation (disaggregation)
operator, each entry Eij (Fij ) is replaced by a five by five
block Eij I5 (Fij I5 ), and we denote the new aggregation (disaggregation) operator by E (F ). Employing these operators,
the dynamics of the approximated aggregated CME will be:
Pa (0) = EP (0)
Ṗa (t) = Aa Pa (t),
Aa = EAF


K − m11 B
0
...
1


K − m12 B
0
m1 B


1
1
=

0
K − m3 B 0
m2 B


..
..
.
.


γm1
0
0
...
m2 I5
γ(m1 +m2 )
 0 − γm1 I

I5
0


m2 5
m3

.
γ(m1 +m2 +m3 )
+ 0
1 +m2 )

0
− γ(mm
I
I
0
5
5
m4
3


..
..
.
.
(9)
In essence, the (5i)th entry of Pa (t) represents the probability of having a protein concentration between m1 +· · ·+mi−1
and m1 + · · · + mi proteins at time t. Notice that the group
sizes mi and the protein production rates in B are unknown.
Now, assume that for i = 1, 2, . . . , the each group size mi
satisfies
mi = max{xg ∈ N| µxg ≤ ∆i },
(10)
where xg is the protein number and µ is the fluorescenceGFP ratio, defined in Section II-B. Roughly speaking, mi
is the number of proteins in one cell that increases the
fluorescent intensity of the cell by ∆i . Since for the experimental fluorescence grids in histograms of [11], mi ’s tend
to be large, one can see that µmi ' ∆i . Then, according to
equation (2),
β∗
βf,∗
βf,∗ /µ
=
'
.
mi
∆i /µ
∆i
Moreover, for any i, j, k ∈ {1, 2, . . . },

(∆i + ∆j )/µ
∆i + ∆ j
mi + mj
'
=
mk
∆k /µ
∆k

Therefore, the fluorescence based CME (8) is a direct
consequence of approximated aggregated CME (9) under
assumption µmi = ∆i , and the unknown values µ and
mi ’s are eliminated. Note that the ith entry of Pf (t) is now
the probability of cell having fluorescent intensity between
∆1 + · · · + ∆i−1 and ∆1 + · · · + ∆i .
Proposition III.2 (Evolution of error in FGBA method).
Consider the dynamics of a gene-protein system with only
one gene phase, hence one protein production rate β, is
described by the CME dotP (t) = AP (t). By employing the
FGBA method, the system’s dynamics can be approximated
by the fluorescence based CME Ṗf (t) = Af Pf (t). Assume
that:
1) there exists r ∈ R>0 such that the fluorescence grids
satisfy ∆i ≤ r∆i−1 ; and

2) there exists  ∈ R>0 such that the group sizes satisfy
|µmi − ∆i | ≤ .
Let e(t) denote the error in the expected value of the final
probability distribution, that is,
e(t) = µE[P (t)] − E[Pf (t)],
then e(t) can be upper bounded by a well defined function of
E[Pf (t)], , r, and the minimum and maximum fluorescence
grid.
Proof: This error in FGBA method is caused by
two reasons: aggregating the states of initial CME; and
approximating the group sizes mi by fluorescence grid sizes,
instead of employing the exact equation (10). Therefore,
e(t) = µE[P (t)] − E[Pf (t)]

= (µE[P (t)] − µE[Pa (t)]) + (µE[Pa (t)] − E[Pf (t)])

= µe1 (t) + e2 (t).

We first compute the first term’s upper bound:
e1 (t) = E[P (t)] − E[Pa (t)]

= [0 1 2 . . . ]P (t) − [0 m1 m1 + m2 . . . ]Pa (t).

Taking the derivative of both sides gives
ė1 (t) = [0 1 . . . ]AP (t)
− [0 m1 m1 + m2 . . . ]Aa Pa (t),
where Aa = EAF , and E and F are the aggregation and
disaggregation operators introduced in Section III-A. Hence,
ė1 (t) = [β β − γ β − 2γ . . . ]P (t)
m2 (m1 + m2 )
m2
γ . . . ]Pa (t)
− [β β − 1 γ β −
m2
m3
= β1T P (t) − γ[0 1 2 . . . ]P (t)
m21 m2 (m1 + m2 )
. . . ]Pa (t).
− β1T Pa (t) + γ[0
m2
m3
Clearly, 1T Pa (t) = 1T P (t) = 1. By adding and subtracting
γe1 (t) we have
ė1 (t) = γe1 (t)
m2 (m1 + m2 )
m21
− m1
− (m1 + m2 ) . . . ]Pa (t).
+ γ[0
m2
m3
Integrating from 0 to t gives
Z t
γt
e1 (t) = e e1 (0) −
eγ(t−τ ) γ
0

m1 (m2 − m1 ) (m1 + m2 )(m3 − m2 )
[0
. . . ]Pa (τ )dτ.
m2
m3
According to the initial value Pa (0) = EP (0) we have
e1 (0)

=

[0 1 2 . . . ]P (0) − [0 m1 m1 + m2 . . . ]EP (0)

= P2 (0) + · · · + (m1 − 1)Pm1 (0)

+Pm1 +1 (0) + · · · + (m2 − 1)Pm2 (0)
+....

6

Clearly, e1 (0) is a convex combination of {1, 2, . . . , mmax },
where mmax is the maximum group size. Hence, denoting
the maximum fluorescence grid by ∆max ,
e1 (0) ≤ mmax ≤ (∆max + )/µ.
Therefore,
e1 (t) ≤

mi − mi−1
∆max +  γt
e − max{
}
i
µ
mi
Z t
eγ(t−τ ) γ[0 m1 m1 + m2 . . . ]Pa (τ )dτ.
0

According to the assumptions 1 and 2, the
i−1
value maxi { mi −m
} can be upper bounded by
mi
1 − ∆min /(r∆min + r + ), which we denote by
r̂:
∆max +  γt
e + r̂(1 − e−γt )γE[Pa (t)].
e1 (t) ≤
µ
Second, we compute the upper bound on error e2 (t):
e2 (t) = µ[0 m1 m1 + m2 . . . ]Pa (t)
− [0 ∆1 ∆1 + ∆2 . . . ]Pf (t)

≤ [0 ∆1 ∆1 + ∆2 . . . ]Pa (t) + 1Pa (t)

− [0 ∆1 ∆1 + ∆2 . . . ]Pf (t).

The value 1Pa (t) is equal to , and using assumption 2,
one can compute the scalar function g(, t) such that eAa t ≤
g(, t)eAf t , then
Pa (t) = eAa t Pa (0) ≤ g(, t)eAa t Pf (0) = g(, t)Pf (t).
Consequently,
e2 (t) ≤ (g(, t) − 1)E[Pf (t)] + ,
and finally
µe1 (t) + e2 (t) ≤ (∆max + )eγt


+ r̂(1 − e−γt )γ + g(, t) +  E[Pf (t)].

IV. N UMERICAL R ESULTS
In the experiments done by Lim et al., they let six
separate colonies of E. coli grow for 20 hours. Each colony
started from a cell that contains a mutant of agn43 with Off
expression state. The gene was mutated by deleting different
parts of the upstream sequences of agn43. They claimed
that the only difference in the dynamics of gene-protein
system in these mutants is the ratio kR /k−R , see Figure 1.
According to the steady state of phase varying dynamics,
the ratio kR /k−R is equal to the fraction of unmethylated
cells with Off expression, and is experimentally found to
be 15.8, 8.9, 5.5, 4.3, 1, and 0.1 for the six mutants. Finally,
they measured the fluorescence of the cells in each colony
with flow cytometer and drew fluorescence histograms, see
Figure 4.(a). In these histograms, the fluorescence grids ∆i
are equal to 10i − 10i−1 , where i ∈ 0.05{0, 2, . . . , 40}.
Now, to generate analytical fluorescence histograms, we
employ the FGBA method stated in Theorem III.1 to the

gene-protein systems of the mutants of agn43 (each system
has one of the six mentioned values for kR /k−R , and the
rest of parameters remains constant.) Knowing the phase
variation rates, Section II-A; degradation and fluorescence
increase rates, Section II-B; and fluorescence grids, the
fluorescence based transition matrix Af of equation (8) can
be computed. Therefore,
Ṗf (t) = Af Pf (t) + Df Pf (t),

(11)

where Df = −I + Df+ is the fluorescence based replication
+
matrix. The Df+ is composed of blocks Di,j
, given by equation (5), while the fluorescence of the ith five configurations
is approximately half of the jth five configurations.
Remark 3. In Lim’s model, the replication of the gene
is described by a discrete time reaction. Accordingly, we
first employed a discrete time replication in our stochastic
analysis. However, the variance of the resulting probability
distribution did not match the variance of the experimental
fluorescence histograms, see Figure 5. This disagreement
can be explain as follows: The experimental histograms are
taken from a colony of the cells, and in a colony not all the
cells replicate at the same time. Therefore, a continuous time
replication can better capture the behavior of a large number
of cells than a discrete time replication.
Equation (11) is an infinite dimensional ODE, hence we
truncate this equation into a finite dimensional equation. The
finite dimensional CME should contain configurations whose
protein concentration is between zero and the maximum
number of proteins in one cell, or equivalently, configurations
whose fluorescence is less than the maximum value observed
(104 a.u.). The solutions to the final CME’s for the six
mentioned mutants are plotted in Figure 4.(b).
V. C ONCLUSION AND F UTURE W ORK
As our main result, we introduced a new approach to justify the dynamical model of protein expression by the experimental fluorescence histograms. We described the dynamics
of a gene-protein system, whose protein production rates are
unknown, with a chemical master equation (CME). Based on
the resolution of the experimental histograms, we aggregated
the states of the CME, however, the number of states in
each aggregated group is also unknown. We proved that the
unknown protein production rates and number of states in
one group can be replaced by the fluorescence increase rate
and the fluorescence grids from the histograms, respectively.
Therefore, the final probability distribution is the theoretical
fluorescent histogram of the gene-protein model, and can be
verified by the experimental fluorescence histograms. One
future challenge is to compute the parameters of a geneprotein system via its fluorescence histograms. The solution
to the CME, which is a probability distribution, has been
numerically approximated from the parameters of the CME,
see [18]. A reverse analysis of this method can help us find
the parameters of a gene-protein system by experimental
fluorescence histograms.

7

VI. ACKNOWLEDGMENTS
(a)

The authors would like to thank Marjan Van der Woude,
João Hespanha, Brian Munsky, and Sandra Dandach for their
helpful comments and encouragements.

(b)
0.06
0.03

R EFERENCES

0
0.06 0

1

2

3

4

0.03
0
0.060

1

2

3

4

0.03
0
0.060

0.5

1

1.5

2

2.5

3

3.5

4

0.5

1

1.5

2

2.5

3

3.5

4

0.5

1

1.5

2

2.5

3

3.5

4

0.03
0
0.06 0
0.03
0
0.06 0
0.03
0

0

1

2

3

Total cell fluorescence (log10 a.u.)

(a)
(b)
(c)

Normalized cell count

Fig. 4. (a) The fluorescence histograms for six separate colonies, each
starting from a mutant of agn43 with Off expression state. Lim et al.
claims that the only difference in the dynamics of these mutants is the
ratio kkR , which is equal to 15.8, 8.9, 5.5, 4.3, 1, and 0.1 from top to
−R
c
bottom. Reprinted figure with permission from [11]. 2007,
by Nature
Publishing Group. (b) The probability distribution of fluorescent intensity
resulting from solving the aggregated CME of equation (3). Each plot is
obtained by solving the model with one of the six mentioned values for
kR
, and the rest of parameters remains constant. These plots proves that
k−R
our method can make a phase varying model verifiable by the fluorescence
histograms.

0.06
0.03

0.06

0

1

2

3

4

1

2

3

4

0.03
0

0

Total cell fluorescence (log10 a.u.)

Fig. 5. (a) The experimental fluorescence histogram of a colony that starts
from a mutant of agn43 with Off expression state and the ratio kkR = 1.
−R
c
Reprinted figure with permission from [11]. 2007,
by Nature Publishing
Group. (b) The probability distribution of fluorescent intensity resulting
from solving the fluorescence based CME with discrete time replications for
the same mutant. We assumed that the fluorescence becomes half in each
replication. (c) The probability distribution of fluorescent intensity resulting
from solving the fluorescence based CME with discrete time replications for
the same mutant. Here, the replication matrix is constructed by a binomial
probability distribution, in order to increase the resulting variance. This
figure tells us that a model with discrete time replication can not capture the
variance of the experimental fluorescent intensity distributions. Moreover,
employing a binomial probability distribution for replication only slightly
increases this variance.

4

[1] J. H. Ahna, H. S. Chub, T. W. Kimb, I. S. Ohb, C. Y. Choia,
G. H. Hahnc, C. G. Parkc, and D. M. Kimc. Cell-free synthesis
of recombinant proteins from pcr-amplified genes at a comparable
productivity to that of plasmid-based reactions. Biochemical and
Biophysical Research Communications, 338:1346–1352, 2005.
[2] U. Alon. An Introduction to Systems Biology: Design Principles of
Biological Circuits. CRC Press, 2006.
[3] P. Corish and C. Tyler Smith. Attenuation of green fluorescent protein
half-life in mammalian cells. Protein Engineering, 12(12):1035–1040,
1999.
[4] T. S. Gardner, C. R. Cantor, and J. J. Collins. Construction of a genetic
toggle switch in escherichia-coli. Nature, 403:339–342, 2000.
[5] M. Hegland, C. Burden, L. Santoso, S. MacNamara, and H. Booth.
A solver for the stochastic master equation applied to gene regulatory networks. Journal of computational and applied mathematics,
205(2):708–724, 2007.
[6] I. R. Henderson, M. Meehan, and P. Owen. Antigen 43, a phasevariable bipartite outer membrane protein, determines colony morphology and autoaggregation in escherichia coli k-12. FEMS Microbiology
Letters, 149(1):115–120, 1997.
[7] I. R. Henderson and P. Owen. The major phase-variable outer
membrane protein of escherichia-coli structurally resembles the immunoglobulin a1 protease class of exported protein and is regulated by
a novel mechanism involving dam and oxyr. Journal of Bacteriology,
181(7):2132–2141, 1999.
[8] E. C. Howe and C. R. Johnson. Aggregation of markov processes:
Axiomatization. Journal of Theoretical Probability, 2(2):201–208,
1989.
[9] F.J. Isaacs, J. Hasty, C.R. Cantor, and J.J. Collins. Prediction and
measurement of an autoregulatory genetic module. 100(13):7714–
7719, 2003.
[10] J. G. Kemeny and J. L. Snell. Finite Markov Chains. Springer, 1976.
[11] H. N. Lim and A. van Oudenaarden. A multistep epigenetic switch
enables the stable inheritance of dna methylation states. Nature
Genetics, 39(2):268–275, 2007.
[12] B. Munsky and M. Khammash. The finite state projection approach for
the analysis of stochastic noise in gene networks. IEEE Transactions
on Automatic Control, 53(1):201–214, 2008.
[13] B. Munsky, B. Trinh, and M. Khammash. Listening to the noise:
random fluctuations reveal gene network parameters. Molecular
Systems Biology, 5(1), 2009.
[14] M.R. Soboleski, J. Oaks, and W.P. Halford. Green fluorescent protein
is a quantitative reporter of gene expression in individual eukaryotic
cells. The FASEB journal, 19(3):440–442, 2005.
[15] M. W. van der Woude. Re-examining the role and random nature of
phase variation. FEMS Microbiology Letters, 254(2):190–197, 2006.
[16] M. W. van der Woude and I. R. Henderson. Regulation and function
of ag43 (flu). Annual Review of Microbiology, 62:153–169, 2008.
[17] J.V. Watson. Introduction to Flow Cytometry. Cambridge Univ Press,
1991.
[18] J. Zhang, L. T. Watson, C. A. Beattie, and Y. Cao. Radial basis
function collocation for the chemical master equation. Int. J. Comput.
Methods, 7(03):477–498, 2010.

