Quasispecies dynamics on a network of interacting genotypes and idiotypes:
Formulation of the model
Valmir C. Barbosa,1 Raul Donangelo,2, 3 and Sergio R. Souza2, 4

arXiv:1311.4857v1 [q-bio.PE] 19 Nov 2013

1

Programa de Engenharia de Sistemas e Computação,
COPPE, Universidade Federal do Rio de Janeiro,
Caixa Postal 68511, 21941-972 Rio de Janeiro - RJ, Brazil
2
Instituto de Fı́sica, Universidade Federal do Rio de Janeiro,
Caixa Postal 68528, 21941-972 Rio de Janeiro - RJ, Brazil
3
Instituto de Fı́sica, Facultad de Ingenierı́a, Universidad de la República,
Julio Herrera y Reissig 565, 11.300 Montevideo, Uruguay
4
Instituto de Fı́sica, Universidade Federal do Rio Grande do Sul,
Caixa Postal 15051, 91501-970 Porto Alegre - RS, Brazil
A quasispecies is the stationary state of a set of interrelated genotypes that evolve according to
the usual principles of selection and mutation. Quasispecies studies have invariably concentrated on
the possibility of errors during genotype replication and their role in promoting either the survival
or the demise of the quasispecies. In a previous work [V. C. Barbosa, R. Donangelo, and S. R.
Souza, J. Theor. Biol. 312, 114 (2012)], we introduced a network model of quasispecies dynamics,
based on a single probability parameter (p) and capable of addressing several plausibility issues
of previous models. Here we extend that model by pairing its network with another one aimed
at modeling the dynamics of the immune system when confronted with the quasispecies. The
new network is based on the idiotypic-network model of immunity and, together with the previous
one, constitutes a network model of interacting genotypes and idiotypes. The resulting model
requires further parameters and as a consequence leads to a vast phase space. We have focused on a
particular niche in which it is possible to observe the trade-offs involved in the quasispecies’ survival
or destruction. Within this niche, we give simulation results that highlight some key preconditions
for quasispecies survival. These include a minimum initial abundance of genotypes relative to that
of the idiotypes and a minimum value of p. The latter, in particular, is to be contrasted with the
stand-alone quasispecies network of our previous work, in which arbitrarily low values of p constitute
a guarantee of quasispecies survival.
PACS numbers: 87.23.Kg, 89.75.Fb, 02.10.Ox, 02.50.-r

I.

INTRODUCTION

The immune system is one of the central regulatory
systems of the body, being responsible for the detection
and eventual removal of both external agents that may be
potentially harmful and body cells whose behavior may
have become abnormal. These targets of the immune system are generically referred to as antigens, in allusion to
the fact that they trigger the system’s response and ultimate production of antibodies or activation of destroying
cells. In order to be able to respond appropriately to a
potentially large variety of antigens, the immune system
is highly adaptive and along its existence evolves from an
initial state of innate immunity through a series of states
of acquired immunity. Modeling the dynamics that gives
rise to this type of learning has been challenging for many
decades and has elicited the appearance of at least two
main explanatory frameworks. One of them is the clonalselection theory [1, 2], which postulates the preferential
survival of those cell types that are more effective for a
certain class of antigens. This theory has been successful
in many respects but has failed in others, e.g., explaining
the existence of any level of innate immunity, which by
definition exists in the absence of any antigens.
The other leading framework to model the dynamics
of immunity is that of the so-called idiotypic network

[3]. The main idea is that the molecular structures capable of being recognized by the immune system, known
as epitopes, are found not only in antigens but also in
the receptors of the immune-system cells whose task is
to recognize those antigens. That is, not only can these
cells recognize antigens, they can also recognize one another in much the same way. Readily, the existence of
such a network of epitope types, known as idiotypes, has
the potential to explain not only how immunity is acquired but also how it can exist before antigens are ever
encountered. The idiotypic-network theory has enjoyed
both enthusiasm and skepticism along the years, the latter owing mainly to the many difficulties associated with
confirming it experimentally. Many of its elements, however, are present in models of a hybrid nature, particularly in those that aim to characterize those phenomena,
such as autoimmunity, that are essentially of a systemic
nature (cf., e.g., [4–6] and references therein).
One common element of all mathematical models of
the immune system is the overly simplistic manner in
which the system’s interaction with antigens is handled.
Typically the immune-system model involves a set of
time-dependent equations describing the behavior of certain quantities (e.g., the abundance of a given cell type)
and including independent terms to account for the presence of antigens. Such terms can be adjusted to account

2
for the simultaneous presence of several antigens, but in
general independently of one another. The drawback,
of course, is that in important cases such as infections
by some viral species, the many different viral strains
that may be concomitantly present mutate into one another frequently and confront the immune system in everchanging ways.
Here we address the problem of how antigens and entities of the immune system interact with one another
when both sides already display complex dynamic behavior even when left to themselves. We introduce a
random-graph model of this interaction that takes into
account not only the interaction itself but also the dynamics of genotype mutation on the antigen side and
of idiotype recognition on the immune-system side. Our
model can be viewed as comprising two subnetworks, one
whose nodes represent genotypes that mutate into one
another as they replicate, the other whose nodes represent idiotypes that stimulate (are recognized by) one
another and proliferate as a consequence. The two subnetworks are put together by the addition of new edges to
give idiotypes the further stimuli provided by the genotypes.
In building the two subnetworks we have drawn on
previous ideas dealing with graph-theoretic representations of both interacting genotypes and idiotypes. On
the genotype side the network we use is the same we
introduced recently [7] to model the dynamics of the socalled quasispecies. A quasispecies is the stationary state
of a set of genotypes that mutate into one another while
replicating without recombination based on fitnesses that
do not depend on genotype abundance (cf., e.g., [8–12]
and references therein). Our model is based on a single
probability parameter, p, that regulates both graph connectivity and the occurrence of mutations, and can also
successfully account for the well-known transition from
adaptation to degeneracy when mutations become too
frequent. For the idiotype side we use a similar network
while incorporating some of the essential premises of the
idiotypic-network theory. Like our quasispecies network,
our idiotypic network is based on a single probability parameter, r, whose function is to regulate both graph connectivity and the occurrence of stimulation/recognition
of idiotypes by one another.
Each node in our model is a binary sequence, i.e., a
sequence of 0’s and 1’s. This representation is suitable
for both genotypes and idiotypes, since it can easily accommodate the types of interaction that are necessary in
each subnetwork. Specifically, on the quasispecies side
mutations are bit alterations and are more likely to occur between two genotypes that do not differ at too many
loci. On the idiotypic side, by contrast, stimulation occurs as a function of how well the two sequences involved
can be said to be complementary to each other on a
locus-wise basis, being more likely as complementarity
increases. This stems directly from the physicochemical
nature of the molecular coupling that, in the immune system, leads to stimulation. As the quasispecies and idio-

typic networks are combined together into the full model,
this same notion of complementarity is used to account
for how genotypes stimulate idiotypes, again based on
probability r.
Before proceeding, we note that, by virtue of its underlying random-graph model and of the agent interactions
this model represents, the subject we study in the present
work is related to various other topics of interest. One of
them is the wider discipline of complex networks, which
in little more than a decade has uncovered many common
underpinnings to a great variety of natural and technological systems of interacting agents [13–15]. Another
of these topics is that of evolutionary games, which encompass the so-called predator-prey systems and, essentially, are characterized by the mediation of abundancedependent fitnesses. The reader is referred to [16, 17],
for example, as well as to references therein.
In a similar vein, note that the essence of our model
is that it portrays the interaction of antagonistic agent
populations as they adapt to each other while competing for supremacy. Thus, while in the present study we
instantiate such agents by interrelated genotypes invading the body and idiotypes defending it, taking a broader
view may come to benefit several other areas. One area
with obvious conceptual ties to our invader-defender setting is that of computer security, and in fact proposals
have been put forward that are based on immune-related
notions [18, 19]. This has also been the case of other
areas with less obvious but equally relevant connections
to our study, such as combinatorial optimization (cf. [20]
for an application to the prediction of protein structure),
user profiling for adaptive information filtering in online
systems [21], and classification of textual documents [22].
Useful reviews on how these and other areas have come
to be influenced by immune-inspired abstractions can be
found in [23, 24].
The remainder of the paper is organized in the following manner. First we introduce the model’s details
in Section II. Then we discuss some aspects of the computational methodology we have used and present our
results, all in Section III. These results elucidate the role
played by initial conditions, as well as by one of our main
parameters, the probability p, in promoting the survival
or the demise of the quasispecies as a function of how
genotypes interact with one another and with the idiotypes. These issues are discussed in Section IV, which is
followed by conclusions in Section V.

II.

MODEL

We consider 2L+1 binary sequences of length L and
group them into sets A and B, each set comprising all
2L distinct sequences of length L. Each sequence in set
A stands for a genotype, each sequence in set B for an
idiotype. Our model is based on a directed random graph
D of node set A ∪ B. For i ∈ A ∪ B, we use Ii to denote
the set of in-neighbors of node i and Oi to denote its set

3
of out-neighbors. Graph D has self-loops at all nodes,
so it holds that both i ∈ Ii and i ∈ Oi . We describe
the edge set of graph D in three separate stages: first
the edges involving nodes in A exclusively, then edges
involving nodes in B exclusively, then the edges used to
interconnect the two halves.

A.

Quasispecies network

X

fj qji Xj ,

(1)

j∈Ii

where fj is the fitness of genotype j and reflects its replication rate. We assume throughout that fj = 2−dj ,
where dj is the number of 1’s in genotype j. That is,
a genotype’s fitness decays exponentially with its Hamming distance to the genotype having no 1’s (the fittest
genotype, or wild type). Equation (1) is the well-known
quasispecies equation [16, 25], now written for graph D
as in the uniform case of [7].

B.

j∈Ii

This constitutes a very simple model of the idiotypic network in the absence of antigens.

C.

For i, j ∈ A (i.e., i and j are both genotypes), possibly
identical, an edge exists directed from i to j with probability pij = pHij , where p is a probability parameter and
Hij is the Hamming distance between i and j. If the edge
does exist then it is possible for genotype i to mutate into
genotype j during replication, provided i 6= j. The probability that such mutation occurs is
Pqij , assumed proportional to pij in such a way that j∈Oi qij = 1, where
qii is the probability that genotype i remains unchanged
during replication. Note that larger Hamming distances
entail smaller connection probabilities and, consequently,
smaller mutation probabilities as well.
Letting Xi denote the time-dependent abundance of
genotype i, we write
Ẋi =

some rate λ > 0 to the total stimulus received by i, yields
X
Ẋi = λ
sji Xj .
(2)

Idiotypic network

For i, j ∈ B (i.e., i and j are both idiotypes), again possibly identical, an edge exists directed from i to j with
probability rij = rL−Hij , where r is another probability parameter. The existence of this edge indicates that
idiotype i stimulates idiotype j during the proliferation
phase of the idiotypic dynamics, provided i 6= j. The
probability that this stimulation occurs P
is sij , assumed
proportional to rij in such a way that
j∈Oi sij = 1,
where sii is the probability that idiotype i stimulates
no other idiotype during proliferation. Now larger Hamming distances entail larger connection and stimulation
probabilities, which indeed are expected to be larger if
the idiotypes involved are more complementary to each
other (i.e., differ at more loci).
Letting Xi denote the time-dependent abundance of
idiotype i, and assuming that Xi grows in proportion by

Genotype-idiotype interaction network

We are now in position to describe the entirety of graph
D, of node set A ∪ B, which is intended to model the interaction of the quasispecies and idiotypic networks, of
node sets A and B, respectively. We do this by allowing
the existence of edges directed from nodes in A to nodes
in B, indicating that idiotypes are stimulated not only
by one another but also by the genotypes against which
they are supposed to constitute a defense. This, in effect, brings antigens into the idiotypic dynamics and lets
graph D work as a model of how invading genotypes and
defending idiotypes interact with one another. Adding
these edges to the network has the potential of enlarging
the Oi sets for i ∈ A and the Ii sets for i ∈ B. The former has the immediate consequence of requiring
that we
P
adjust the quasispecies-network constraint j∈Oi qij = 1
P
to j∈Oi ∩A qij = 1. As for the latter, it remains for us
to specify how a genotype i ∈ A stimulates an idiotype
j ∈ B.
We begin by assuming that the length-L sequences representing genotypes and idiotypes are all relative to the
same support, i.e., they all share the same representation
space, {0, 1}L. In other words, the Hamming distance is
well defined also between a genotype and an idiotype.
Our approach is then to handle idiotype stimulation independently of whether it is effected by a genotype or
another idiotype. That is, we let the edge from genotype
i ∈ A to idiotype j ∈ B exist with the same probability rij as above. When it does exist, stimulation too
occurs with the same probability sij as above, so every
node P
i ∈ A is now subject to the additional constraint
that j∈Oi ∩B sij = 1. Equation (2), therefore, remains
unchanged.
Once coupled in this way, the 2L+1 differential equations given in Eqs. (1) and (2) mandate an unbounded
exponential growth of both genotype and idiotype abundances from any nontrivial initial values. We therefore
lack further coupling in order for the possibility of genotype removal by the idiotypes to be explicitly taken into
account. We achieve this by rewriting Eq. (1) as
Ẋi =

X

j∈Ii

fj qji Xj − µ

X

sij Xj ,

(3)

j∈Oi ∩B

where µ > 0 is a rate parameter. This modification to
Eq. (1) lets the abundance of genotype i be decreased at
a rate that is proportional to how strongly i stimulates
each idiotype j.

4
Further modifications to all equations might still be
considered for the removal of genotypes as they mutate
into other genotypes or the removal of idiotypes as they
stimulate (and are therefore recognized and sought for
destruction by) other idiotypes. We approach this last
step by henceforth considering relative, rather than absolute, abundances. Proceeding in this way is equivalent
to imposing that the various abundances sum up to a
constant at all times, which automatically leads to the
appearance of terms that account for the desired sources
of both genotype and idiotypePremoval.
For i ∈ A ∪ B, let xi = Xi / k∈A∪B Xk be
Pthe relative
abundance of genotype or idiotype i. Thus, i∈A∪B xi =
1 at all times. It follows that
P
Ẋk
Ẋi
ẋi = P
− xi Pk∈A∪B
X
k
k∈A∪B
k∈A∪B Xk
Ẋi
= P
− xi (φ − µψ + λ),
(4)
k∈A∪B Xk
P
P
P
where φ = k∈A fk xk and ψ = k∈B xk ℓ∈Ik ∩A sℓk .
In this expression for ψ, the rightmost summation represents the stimulatory influence of all genotypes upon
idiotype k and is here referred to as that idiotype’s
proP
x
and
liferability.
Note,
additionally,
that
φ/
k
k∈A
P
ψ/ k∈B xk are, respectively, the average genotype fitness and idiotype proliferability.
Equation (4) yields the final expressions for ẋi :
X
X
ẋi =
fj qji xj − µ
sij xj − xi (φ − µψ + λ) (5)
j∈Ii

j∈Oi ∩B

for i ∈ A and

An idiotype, on the other hand, can only have other
idiotypes as out-neighbors. Its number of out-neighbors
that are also idiotypes, ignoring self-loops, is
L  
X
L L−h
r
= (1 + r)L − rL .
h

III.

ẋi = λ

sji xj − xi (φ − µψ + λ)

(6)

j∈Ii

for i ∈ B.

RESULTS

We begin by revisiting Eq. (5) and recognizing that it
is possible for ẋi to be negative when xi = 0, thus leading
the implicit constraint that xi ≥ 0 for all i ∈ A ∪ B at all
times to be violated. We fix this by noting that it suffices
that this equation’s predecessor for absolute abundances,
Eq. (3), be modified to
Ẋi =

X

fj qji Xj − µH(Xi )

j∈Ii

X

sij Xj ,

(10)

j∈Oi ∩B

where H(z) is the Heaviside step function, adapted to
yield 1 if and only if z > 0 (yield 0, otherwise). This
modification forbids Ẋi to be negative when Xi = 0 and
affects both Eqs. (5) and (6), since the expression for ψ
is itself affected.
The actual expressions we use are then as follows,
where all appearances of the H function have been shifted
by a suitably small δ > 0 to avoid numerical instabilities.
For
X
X
ψ=
xk
sℓk H(xℓ − δ),
(11)
k∈B

X

(9)

h=1

ℓ∈Ik ∩A

we have
X
X
fj qji xj −µH(xi −δ)
ẋi =
sij xj −xi (φ−µψ+λ)
j∈Oi ∩B

j∈Ii

(12)
D.

for i ∈ A and

Expected connectivity

In graph D, a genotype i may have out-neighbors both
in set A (other genotypes) and in set B (idiotypes). If one
ignores all self-loops, then the expected number of outneighbors of the former type can be obtained by considering every other genotype j and counting the edge from i
to j with weight pHij [26]. That is, a genotype’s expected
number of out-neighbors that are genotypes other than
itself is
L  
X
L h
p = (1 + p)L − 1.
(7)
h
h=1

As for a genotype’s expected number of out-neighbors
that are idiotypes, we have
L  
X
L L−h
r
= (1 + r)L .
h

h=0

(8)

ẋi = λ

X

sji xj − xi (φ − µψ + λ)

(13)

j∈Ii

for i ∈ B.
While Eqs. (12) and (13) provide instantaneous values
of ẋi that are correct in the sense of never allowing xi
to fall below δ, actually solving the equations requires
further control. Specifically, when the value of xi is to
be updated, say at time t, one must ensure that the time
step to be used, ∆t, necessarily entails xi + ẋi ∆t ≥ δ.
Thus, before stepping time when ẋi < 0 one must first
discover the time T > t at which this derivative will lead
to xi = δ [that is, one must solve xi + ẋi (T − t) = δ for
T ] and then choose ∆t < T − t. What we do is solve
xi + ẋi (T − t) = δ/10 instead (again, to avoid numerical instabilities), which implies that xi > δ/10 at all
times. Consequently, even though Eqs. (12) and (13) ensure ẋi ≥ 0 already for xi = δ, during solution it is still

5

1

Probability density

10-2

10-4

xA

possible for xi to fall below δ, though remaining strictly
above δ/10. We use δ = 10−10 throughout.
We give results for L = 10 (i.e., for 1 024 genotypes
and 1 024 idiotypes) in Figs. 1–6. These results reflect
our exploration of a specific parameter niche in which it
is possible to observe a rich variety of behaviors for the
entire quasispecies (Figs. 1–3) and, particularly, for the
wild type (Figs. 4–6). We follow [7] and let x1 denote the
relative abundance of the wild type. Moreover, we let the
relative abundance of genotypes be denoted by xA , i.e.,
X
xA =
xi .
(14)

10-6

10-8

(a)

i∈A

0

10

20

30

20

30

20

30

t
1

Probability density

10-2

10-4

xA

We use xA (0) to denote the initial value of xA .
All figures give results based on at least 104 instances
of graph D. Solving Eqs. (12) and (13) for each instance
starts at uniform relative abundances for genotypes and
likewise for idiotypes. That is, initially xi = xA (0)/2L
for i ∈ A and xi = [1 − xA (0)]/2L for i ∈ B. All 2L+1
equations are then time-stepped through t = 50, which
empirically we found to suffice for all relative abundances
to reach a stationary state.

10-6

DISCUSSION
10-8

(b)
0

10

t
1

10-2

Probability density

The three plots in Fig. 1 show the distribution of
the genotypes’ relative abundance, xA , as t is varied
from t = 0 through t = 30. All cases correspond to
p = r = 0.1, meaning that on average both the genotype and the idiotype subnetworks have densities of the
same order of magnitude, and so does the set of edges
directed from the genotype subnetwork to the idiotype
subnetwork to account for the removal of genotypes by
idiotypes [cf. Eqs. (7)–(9)]. It also means that the dynamics of genotype mutation and of idiotype stimulation
are based on the same underlying probability. The three
cases also have in common that λ = µ = 0.1, so the rate
at which idiotypes proliferate due to stimulation by other
idiotypes and the rate at which genotypes are eliminated
as they stimulate idiotypes are the same. What distinguishes the three cases from one another is the initial
relative abundance of genotypes, xA (0), which is varied
from 0.14 in panel (a) through 0.16 in panel (c).
These three values of xA (0) were singled out, despite
being so close to one another, because they allow us to
qualitatively zoom in on what appears to be a transition
from a regime in which the genotypes may either disappear or endure in the long run (i.e., the quasispecies may
perish or survive) to another in which they endure almost
certainly. In fact, examining the three panels of Fig. 1
reveals that, even though in all three cases the genotypes
are driven toward a sharp decrease in relative abundance
up to about t = 2, regardless of the particular instance
of graph D on which the dynamics is taking place, thereafter network structure begins to matter and does so in
a manner that depends on what the relative genotype
abundance was to begin with.

10-4

xA

IV.

10-6

10-8

(c)
0

10

t

FIG. 1: Evolution of the probability distribution of xA from
xA (0) = 0.14 (a), xA (0) = 0.15 (b), and xA (0) = 0.16 (c), for
p = r = 0.1 and λ = µ = 0.1. Data are based on at least 104
independent instances of graph D and are log-binned to the
base 1.2. Probabilities are given according to the gray scale
on the right of each panel, where darker is closer to 1.

For the lowest of the three values used in the figure [xA (0) = 0.14], and notwithstanding the fact that
there exist network topologies continuing to push the
genotypes toward the demise of the quasispecies, there
are also cases in which the underlying network topology supports the survival of the quasispecies to the point

6

0

1

10

10-2

10

xA

10-4

-6

10

-2

Probability

Probability density

-1

10

-3

10

-4

10
10-8

(a)
0

-5

10
10

20

30

t

-6

10 0

5

10

Number of out-neighbors

1

Probability density

10-2

xA

10-4

10-6

10-8

(b)
0

10

20

30

t

FIG. 2: Evolution of the probability distribution of xA from
xA (0) = 0.10 for p = r = 0.1. Panel (a) has λ = 0.01 with
µ = 0.1; panel (b) has λ = 0.1 with µ = 0.01. Data are based
on at least 104 independent instances of graph D and are
log-binned to the base 1.2. Probabilities are given according
to the gray scale on the right of each panel, where darker is
closer to 1.

that it seriously threatens the idiotype population, i.e.,
xA approaches 1. This turn of events becomes significantly more pronounced as xA (0) is slightly increased,
quickly reaching the situation in which almost no network
topology supports the destruction of the quasispecies [for
xA (0) = 0.16].
Interestingly, a similar situation occurs when xA (0) remains fixed, along with p and r, while λ and µ are made
to vary relative to each other. This is shown in Fig. 2, in
whose panels we have p = r = 0.1 and xA (0) = 0.1 but
λ and µ are given values one order of magnitude apart:
λ = 0.01 and µ = 10λ in panel (a), λ = 0.1 and µ = λ/10
in panel (b). Thus, the ratio λ/µ increases by two orders
of magnitude from one scenario to the next. In the first
of these scenarios it is uncertain whether the quasispecies
will be led to extinction, whereas in the second it almost
certainly survives. The ratio λ/µ indicates how much
more responsive the immune system is in reorganizing itself to respond to the threat of the genotypes than it is in
actually destroying genotypes. What we see in the figure

FIG. 3: (Color online) Probability distribution of a genotype’s
number of out-neighbors in set A, ignoring self-loops. Data
are given for p = 0.1 and are based on 104 independent instances of graph D. As defined, the probability that an edge
exists between two genotypes in D depends on the Hamming
distance between them. If this probability were independent
of the two genotypes, the resulting distribution would be the
Poisson distribution, here shown as a solid line for the same
mean of 1.59 that is given for p = 0.1 by Eq. (7). If z is the expected number of out-neighbors given by this equation, then
the Poisson distribution of mean z requires that edges exist
with the fixed probability z/(2L − 1) = [(1 + p)L − 1]/(2L − 1),
which approaches the probabilities we use only as p nears 1.

is that a heavy imbalance toward the former almost certainly leads to dominance by the attacking quasispecies.
Throughout the transition depicted in Figs. 1 and 2,
the bifurcation that the genotype population undergoes
at about t = 2 clearly depends on the particular instance
of graph D being used. We study the role of network
topology on the quasispecies by initially continuing to
focus on the p = r = 0.1 setting that is common to both
Figs. 1 and 2. In this setting, the stationary-state distribution of a genotype’s number of out-neighbors is the one
shown in Fig. 3, where only out-neighbors in set A are
counted (i.e., out-neighbors that are genotypes as well, so
only the value of p matters) and self-loops are ignored (so
that 0 is a possibility). This distribution is clearly concentrated on the lowest numbers of out-neighbors and in
this range it seems to be possible to approximate it by the
Poisson distribution of mean given by Eq. (7). However,
the Poisson distribution arises only when edges exist with
the same probability for all node pairs (as in the original Erdős-Rényi model [27] and its directed variant [26]),
and in fact we see in the figure that the two distributions
differ markedly for the higher numbers of out-neighbors.
The distribution shown in Fig. 3 indicates that a randomly chosen genotype is likely to be able to mutate
only into a small number of other genotypes. If idiotypes
were altogether absent this would entail excellent survival chances for the quasispecies, meaning in particular

7

xA(0) = 0.095
xA(0) = 0.10
xA(0) = 0.11
xA(0) = 0.12
xA(0) = 0.13
xA(0) = 0.14
xA(0) = 0.15

10

-3

x1

10

-5

10

10

-3

10

-7

10

-9

-9

10

10

-11

-11

2

4

6

8

10

12

Number of out-neighbors

xA(0) = 0.095
xA(0) = 0.10
xA(0) = 0.11

-1

10

-3

x1

10

-5

10

-7

10

-9

10

-11

2

4

6

8

10 0

2

4

6

8

10

12

Number of out-neighbors

FIG. 4: (Color online) Stationary-state relative abundance of
the wild type (x1 ) as a function of its number of out-neighbors
in set A, ignoring the self-loop. Data are given for p = r = 0.1
and λ = µ = 0.1, and are based on 105 independent instances
of graph D.

10 0

-5

10

-7

10

10 0

p = 0.10 | r = 0.10
p = 0.10 | r = 0.01
p = 0.01 | r = 0.10

-1

x1

-1

10

12

Number of out-neighbors
FIG. 5: (Color online) Stationary-state relative abundance of
the wild type (x1 ) as a function of its number of out-neighbors
in set A, ignoring the self-loop. Data are given for p = r = 0.1
and λ = µ = 0.1, and are based on either 105 (filled symbols)
or 106 (empty symbols) independent instances of graph D.

that the wild type would be able to climb from its initial
relative abundance of 1/2L ≈ 10−3 toward a stationarystate relative abundance of the order of 10−1 [7]. In the
presence of idiotypes, however, one must look at how network topology affects the quasispecies from a closer perspective, paying special attention to how the wild type’s
number of out-neighbors affects its stationary-state relative abundance, x1 .
Figure 4 shows the average value of x1 as a function
of the wild type’s number of out-neighbors in set A and
ignoring the self-loop. All data in this figure are still

FIG. 6: (Color online) Stationary-state relative abundance of
the wild type (x1 ) as a function of its number of out-neighbors
in set A, ignoring the self-loop. Data are given for λ = µ = 0.1
and xA (0) = 0.1, and are based on 105 independent instances
of graph D when p = 0.1, 106 instances when p = 0.01.

relative to p = r = 0.1 and λ = µ = 0.1. Each plot corresponds to a different value of the initial genotype population, beginning at xA (0) = 0.095 and proceeding through
xA (0) = 0.15 (i.e., up to inside the transition qualitatively depicted in Fig. 1). In those instances of graph D
in which the wild type has no out-neighbors, the value
of x1 is influenced from outside exclusively by mutations
into the wild type and by the action of the idiotypes. Under these circumstances, it is clear from the figure that
the wild type recovers from its initial situation of uniform
dilution with respect to the other genotypes, i.e., from an
initial relative abundance of xA (0)/2L ≈ 10−4 . Instances
with larger numbers of out-neighbors at the wild type,
on the other hand, reflect the effect of mutations of the
wild type into other genotypes as well, leading to progressively smaller values of x1 until a precipitous drop
to some value between δ/10 and δ is reached (cf. Section III), indicating the total absence of D instances in
which the wild type has any of the corresponding numbers out-neighbors. Some of this figure’s plots are repeated in Fig. 5 alongside new plots for the same values
of xA (0) but ten times as many instances of graph D,
which postpones the aforementioned drop as D instances
appear in which the wild type has a larger number of
out-neighbors. Taken together, the two figures seem to
support the presence of an exponential decay of x1 with
the wild type’s number of out-neighbors. However, as
already suggested by the data in Fig. 1, such decay is
ever slower as xA (0) increases, so the wild type is ever
more resilient to the possibility of mutation into a larger
number of genotypes.
Varying the value of p and r relative to each other
can provide further insight into wild-type survival, since
these are the parameters regulating edge density and also
mutation or stimulation on those edges that do exist in a

8
particular instance of graph D. We give data for this in
Fig. 6, which continues to be relative to λ = µ = 0.1 but
now focuses exclusively on the xA (0) = 0.1 case of Figs. 4
and 5. Note, first, that using p = 0.1 with r = 0.01 has no
relevant effect with respect to the p = r = 0.1 case. The
reasons for this can be grasped from Eqs. (8) and (9): According to these equations, decreasing r from 0.1 to 0.01,
though entailing a difference by one order of magnitude in
the value of this probability, impacts the expected number of out-neighbors a genotype or an idiotype has inside
set B much more modestly. In fact, these variations are
in both cases from about 2.59 to about 1.01 and seem to
affect genotype-idiotype interaction very little.
On the other hand, using p = 0.01 with r = 0.1, while
affecting only the quasispecies side of the network in comparison to the p = r = 0.1 case, leads to very different
results. By Eq. (7), now a genotype’s expected number
of out-neighbors in set A drops from 1.59 to 0.1, therefore
by one order of magnitude as well. Genotypes are then
very sparsely interconnected to one another, but in spite
of this we see in Fig. 6 that the wild type manages to survive for those instances of graph D in which it has a very
small number of out-neighbors. The pattern of survival is
significantly different from the previous one, which may
at first seem as a surprise given that the pull of idiotypes
on genotypes continues to be the same and all that has
changed is the density in genotype interconnection and
the probabilities that mutations occur. However, the resulting expected sparsity does not rule out those relatively rare D instances in which the wild type is fed by
mutations from at least one other genotype. Combined
with the very low number of genotypes into which the
wild type itself may mutate, this unexpected existence of
edges incoming to the wild type ensures survival.
It follows from these analyses of the data in Fig. 6 that,
as in the case of the isolated quasispecies network [7],
probability p is instrumental in determining the fate of
the wild type. Contrasting with that case, however, the
wild type is no longer guaranteed to survive for arbitrarily low values of p. Instead, it seems that some minimum
value is required for the quasispecies to resist the action
of the idiotypes, i.e., for the wild type to escape being
diluted into the remainder of the quasispecies.

V.

CONCLUSION

Quasispecies studies have invariably concentrated on
characterizing two distinct regimes for the evolution of
genotypes through time, one in which the wild type survives in the quasispecies, another in which the wild type
becomes diluted and no more abundant than any of the
quasispecies’ other genotypes. Distinguishing between
the two regimes has been a matter of selecting the right
perspective from which to model replication errors, or
mutations. In our own previous model, for example,
the single parameter p can be used to characterize quasispecies survival or demise: Increasing p progressively

leads the wild type to a situation in which its relative
abundance cannot rise above those of the other, less fit
genotypes [7]. This focus on the two extremal regimes
of survival and demise has been motivated by the theory’s purported use in the modeling of viral populations,
along with its appeal as a potential aid in the discovery
of therapies [10, 11].
However, in our view the picture has clearly been incomplete, particularly when viral pathogens are the motivation, because the quasispecies’ interaction with the
host’s immune system seems to have been left completely
aside. The present work constitutes an attempt to take
the immune system into account and study its effect on
quasispecies behavior. Our model uses the same network
as [7] to represent the interacting genotypes and interconnects it to another network built on top of the so-called
idiotypes, some of the fundamental motifs of the host’s
immune response. Like the quasispecies network, this
new, idiotypic network is self-adapting (based on the idea
of complementarity among idiotypes) and potentially effective in destroying genotypes (based on the idea that
genotypes and idiotypes are mutually complementary to
some degree).
The resulting network is a continuous-time dynamical
system whose variables, representing the relative abundances of genotypes and idiotypes, are coupled with one
another according to a random-graph model. The system’s behavior depends on four parameters (the probabilities p and r and the rates λ and µ), as well as on the
initial relative abundance of genotypes, xA (0), which together give rise to a phase space of vast proportions. In
view of this, we have concentrated on analyzing a specific
niche inside which both survival and destruction of the
quasispecies can be examined side by side.
Our exploration of this particular niche has highlighted
the existence of two main factors influencing quasispecies
survival. The first one is xA (0) itself, or equivalently the
interplay between λ and µ. If genotypes are reasonably
abundant in the beginning with respect to idiotypes, or if
idiotypes eliminate genotypes much more slowly than the
idiotypes adapt their abundances to meet the challenge of
the mutating genotypes (i.e., µ ≪ λ), then it is possible
for the quasispecies to survive. The second factor is the
topology of the quasispecies network, governed by the p
parameter. Unlike the case of the isolated quasispecies
network, in which very low values of p are practically a
guarantee that the wild type will nearly dominate the
quasispecies even from an initial situation of total dilution, the presence of the idiotypic network makes things
quite different. Specifically, a non-negligible value of p
seems necessary to ensure that the quasispecies network
is sufficiently dense, and mutations sufficiently likely, for
genotypes to change into one another and help the wild
type evade the action of the idiotypic network.
Further research will concentrate on revisiting Eqs. (2)
and (3) with the goal of modeling the action on the immune system of those quasispecies, such as that of HIV,
that work toward depleting the system’s supply of idio-

9
types. While the required changes may turn out to be
conceptually simple, it seems unavoidable that at least
one new rate parameter will be needed, thus enlarging
the model’s phase space even further. Finding an appropriate parameter niche to explore, however, may provide
interesting insight into how genotype mutation, idiotype
stimulation, and idiotype destruction affect one another.

[1] F. M. Burnet, The Clonal Selection Theory of Acquired
Immunity (Cambridge University Press, Cambridge, UK,
1959).
[2] D. R. Forsdyke, FASEB J. 9, 164 (1995).
[3] N. K. Jerne, Ann. Inst. Pasteur Imm. C125, 373 (1974).
[4] L. E. Flores, E. J. Aguilar, V. C. Barbosa, and L. A. V.
Carvalho, J. Theor. Biol. 229, 311 (2004).
[5] U. Behn, Immunol. Rev. 216, 142 (2007).
[6] A. Madi, D. Y. Kenett, S. Bransburg-Zabary, Y. Merbl,
F. J. Quintana, A. I. Tauber, I. R. Cohen, and E. BenJacob, PLoS ONE. 6, e17445 (2011).
[7] V. C. Barbosa, R. Donangelo, and S. R. Souza, J. Theor.
Biol. 312, 114 (2012).
[8] M. Eigen, Naturwissenschaften 58, 465 (1971).
[9] M. Eigen and P. Schuster, Naturwissenschaften 64, 541
(1977).
[10] E. Domingo, Contrib. Sci. 5, 161 (2009).
[11] A. S. Lauring and R. Andino, PLoS Pathog. 6, e1001005
(2010).
[12] A. Más, C. López-Galı́ndez, I. Cacho, J. Gómez, and
M. A. Martı́nez, J. Mol. Biol. 397, 865 (2010).
[13] S. Bornholdt and H. G. Schuster, eds., Handbook of
Graphs and Networks (Wiley-VCH, Weinheim, Germany,
2003).
[14] M. Newman, A.-L. Barabási, and D. J. Watts, eds., The
Structure and Dynamics of Networks (Princeton University Press, Princeton, NJ, 2006).
[15] B. Bollobás, R. Kozma, and D. Miklós, eds., Handbook

Acknowledgments

We acknowledge partial support from CNPq, CAPES,
a FAPERJ BBP grant, and the joint PRONEX initiative
of CNPq/FAPERJ under contract No. 26-111.443/2010.

[16]
[17]
[18]
[19]
[20]
[21]
[22]
[23]
[24]
[25]

[26]
[27]

of Large-Scale Random Networks (Springer, Berlin, Germany, 2009).
M. A. Nowak, Evolutionary Dynamics (Harvard University Press, Cambridge, MA, 2006).
J. Knebel, T. Krüger, M. F. Weber, and E. Frey, Phys.
Rev. Lett. 110, 168106 (2013).
P. K. Harmer, P. D. Williams, G. H. Gunsch, and G. B.
Lamont, IEEE T. Evol. Comput. 6, 252 (2002).
M. Drozda, S. Schaust, and S. Schildt, Nat. Comput. 10,
243 (2011).
V. Cutello, G. Nicosia, M. Pavone, and J. Timmis, IEEE
T. Evol. Comput. 11, 101 (2007).
N. Nanas, M. Vavalis, and A. De Roeck, Swarm Intell. 4,
275 (2010).
A. Abi-Haidar and L. M. Rocha, Evol. Intell. 4, 69
(2011).
S. M. Garrett, Evol. Comput. 13, 145 (2005).
J. Timmis, A. Hone, T. Stibor, and E. Clark, Theor.
Comput. Sci. 403, 11 (2008).
C. K. Biebricher and M. Eigen, in Quasispecies: Concept and Implications for Virology, edited by E. Domingo
(Springer, Berlin, Germany, 2006), vol. 299 of Current
Topics in Microbiology and Immunology, pp. 1–31.
R. M. Karp, Random Struct. Algor. 1, 73 (1990).
P. Erdős and A. Rényi, Publ. Math. (Debrecen) 6, 290
(1959).

