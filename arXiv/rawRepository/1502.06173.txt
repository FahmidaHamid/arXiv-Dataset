Clique topology of real symmetric matrices

arXiv:1502.06173v1 [q-bio.NC] 22 Feb 2015

Supplementary Text for:
Clique topology reveals intrinsic geometric structure in neural correlations
Carina Curto, Chad Giusti, and Vladimir Itskov
Feb 21, 2015

Contents
1 Introduction

1

2 The order complex

3

3 Clique topology
3.1 The clique complex of a graph .
3.2 Chains and boundaries . . . . .
3.3 Homology of a clique complex .
3.4 Clique topology across the order

. . . . .
. . . . .
. . . . .
complex

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

5
. 5
. 7
. 9
. 11

4 Clique topology of random and geometric matrices
11
4.1 Dimension of geometric order complexes . . . . . . . . . . . . . . . . . . . 13
4.2 Figure 2a examples from the main text . . . . . . . . . . . . . . . . . . . . 14
5 Computational aspects and persistence
5.1 A brief history of persistent homology . . . . . . . .
5.2 Persistent homology of order complexes . . . . . . .
5.3 Persistence lifetimes of random and geometric order
5.4 CliqueTop software . . . . . . . . . . . . . . . . . .

1

. . . . . .
. . . . . .
complexes
. . . . . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

14
14
15
16
17

Introduction

The purpose of this supplement is to provide a more complete account of the mathematics
underlying our analyses in the main text. In particular, the order complex and clique
topology are described more precisely here. The order complex of a matrix is analogous
to its Jordan Form, in that it captures features that are invariant under a certain type
of matrix transformation. Likewise, the clique topology of a matrix is analogous to its
eigenvalue spectrum, in that it provides a set of invariants that can be used to detect
structure. While the Jordan Form and eigenvalue spectrum are invariant under linear
change of variables, the order complex and clique topology are invariant under monotonic
transformations of the matrix entries.

1

Seeking quantities that are invariant under linear coordinate transformations is natural in physical applications, where measurements are often performed with respect to
an arbitrary basis, such as the choice of x, y and z directions in physical space. In contrast, measurements in biological settings are often obtained as nonlinear (but monotonic)
transformations of the underlying “real” variables, while the choice of basis is meaningful
and fixed. For example, basis elements might represent particular neurons or genes, and
measurements (matrix elements) could consist of pairwise correlations in neural activity,
or the co-expression of pairs of genes. Unlike change of basis, these transformations are
of the form
Lij = f (Mij ),
where f is a nonlinear, but monotonically increasing function that is applied to each entry
of M . The Jordan Form of a matrix, and its spectrum, may be badly distorted by such
transformations; it also discards basis information which may be meaningful and should
be preserved.
Given a symmetric, N × N matrix that reflects correlations or similarities between N
entities (such as neurons, imaging voxels, etc.), we have two basic questions:
Q1. Is the matrix a monotonic transformation of a random or geometric1 matrix?
Q2. Can we distinguish between these two possibilities, without knowing f ?
Perhaps surprisingly, information sufficient to answer these questions is contained in the
ordering of matrix entries, and is encoded in its order complex, to be described in the next
section. To extract the relevant features, we compute certain topological invariants of the
order complex, which we refer to as the clique topology of the matrix. The motivation for
this choice stems from recent mathematical results by M. Kahle [Kah09], describing the
clique topology of random symmetric matrices asymptotically (for large N ); and our own
computational results, showing that random and “generic” Euclidean distance matrices
can be readily distinguished using clique topology for N ∼ 100.
We have made an effort to keep these explanations self-contained, but details of how
certain computations are performed have been left to the references for the sake of brevity.
Standard material from algebraic topology [Hat02] is described in a minimal fashion, with
an emphasis on homology of clique complexes. The reader is expected to be familiar with
linear algebra.
Comparison to prior applications in biology
Topological data analysis has previously been used in biological applications to identify
individual persistent cycles that may have meaningful interpretation [CI08, SMI+ 08a,
NLC11, DMFC12, CCR13a, CGYW14]. In contrast, our approach relies on the statistical
1

Recall from the main text that a geometric matrix refers to a matrix of (negative) Euclidean distances
among random points in Rd .

2

properties of cycles, as captured by Betti curves, in order to detect geometric structure (or
randomness) in symmetric matrices. In particular, the relevant space from which the data
points are sampled may not possess any meaningful persistent cycles, as in the square box
environment covered by place fields. The background Euclidean geometry, however, has
a strong effect on the statistics of cycles, enabling detection of geometric structure and
providing a sharp contrast to Betti curves of random matrices with i.i.d. entries.

2

The order complex

Recall that a function f : R → R is said to be monotonically increasing if f (x) > f (y)
whenever x > y. Let f : R → R be a monotonically increasing function. For any
real-valued matrix M , we define the matrix f · M by
(f · M )ij = f (Mij ).
Note that this action preserves the ordering of matrix entries. That is, if L = f · M , then
all pairs of off-diagonal entries, (i, j) and (k, `), satisfy:
Lij < Lk` ⇔ Mij < Mk` .
Equivalence classes of matrices can thus be represented by integer-valued matrices that
record the ordering of off-diagonal entries (and carry no information on the diagonal).
Figure 1 shows three matrix orderings for N = 5. For a given symmetric matrix M , we
_
d>1
9 8 3 6
0 7 4
5 2
1

_
d>2
0 1 2 6
3 4 9
5 7
8

_
d>3
6 8 0 1
7 2 3
4 5
9

Figure 1: Three matrix orderings, reproduced from Figure 2a in the main text.
c, where
denote the representative matrix ordering by M
cij = |{(k, `) | 0 < k < ` ≤ N and Mk` < Mij }|
M
simply counts the number of upper-triangular entries of M that are smaller than Mij for
c are left undefined (| · | denotes the size of the set).
i 6= j, while the diagonal entries of M
cij = 0; if Mij is the largest matrix entry,
If Mij is the smallest off-diagonal entry, then M

cij = N − 1. With this notation, we
and all upper-triangular entries are distinct, then M
2
have:
3

b = M
c if and only if there exists a monotonically increasing function f
Lemma 2.1. L
such that L = f · M .
Proof. (⇐) is obvious, since the action of f preserves the ordering of matrix entries. (⇒)
One can construct f : R → R by setting f (Mij ) = Lij for each off-diagonal entry, and
b = M
c, this function is
interpolating monotonically (e.g., linearly). Since we assume L
monotonically increasing and well-defined.
In order to analyze the information present in the ordering of entries for an N × N
symmetric matrix, it is useful to represent it as a sequence of nested simple graphs. Recall
that a simple graph G is a pair ([N ], E), where [N ] = {1, 2, . . . , N } is the ordered set of
vertices, and E is the set of edges. Each edge is undirected and connects a unique pair
of distinct vertices (no self-loops). We will use the notation (ij) ∈ G to indicate that the
edge corresponding to vertices i, j is in the graph.

a

M

b

ord(M)=ord(L)

ρ = 0.1

ρ = 0.008

1

1

f(x)

2

12

L

4

10

1
2

12
3

11

1
2

12
3

11

4

10

4

10

9

7

7

4

10

5
9

6
8

3

11

5
9

6

2

12
3

11

5

5
9
8

ρ = 0.45

ρ = 0.25

6
8

7

6
8

7

Figure 2: Selected graphs in an order complex, adapted from Figure 1 in the main text.
c, and let
Definition 2.2. Let M be a real symmetric matrix with matrix ordering M
c
p = maxi<j Mij . The order complex of M , denoted ord(M ), is the sequence of graphs
G0 ⊂ G1 ⊂ · · · ⊂ Gp+1 ,
4

such that
cij > p − r for each r = 0, . . . , p + 1.
(ij) ∈ Gr ⇔ M
Note that G0 has no edges, G1 contains only the edge (ij) corresponding to the largest
off-diagonal entry of M , and subsequent graphs are each obtained from the previous one
by adding an additional edge for each next-largest entry until we reach the complete
graph, Gp+1 . A portion of an order complex is illustrated in Figure 2. It is clear from the
definition that:
b=M
c.
ord(L) = ord(M ) ⇔ L
Because of Lemma 2.1, the order complex ord(M ) captures all features of M that are
preserved under the action of monotonically increasing functions.

3

Clique topology

We are now ready to introduce clique topology, a tool for extracting invariant features of
a matrix from the ordering of matrix entries. We begin by describing the clique topology
of a single graph G, by which we simply mean the homology of its clique complex:
Hi (X(G), k),
where k is a field (more on the field in section 3.2). The clique complex, X(G), is defined
in section 3.1; while the simplicial homology groups, Hi (X(G), k), will be defined in
section 3.3. We refer to these invariants as clique topology in order to indicate that we
are measuring topological features of the organization of cliques in the graph, rather than
the usual topology of the graph.
We summarize the information present in clique topology via a set of Betti numbers,
βi (X(G)), which are the ranks of the corresponding homology groups:
def

βi (X(G)) = rank Hi (X(G), k).
The clique topology of a symmetric matrix M, with order complex G0 ⊂ G1 ⊂ · · · ⊂ Gp+1 ,
is reflected in the sequences of Betti numbers βi (X(Gr )), computed for various dimensions
i = 0, 1, 2, . . . , and for each graph Gr in ord(M ) (see section 3.4).
The reader familiar with homology of simplicial complexes, including clique complexes,
should feel free to skip the next few sections and proceed directly to section 3.4, where
we define Betti curves.

3.1

The clique complex of a graph

Recall that a clique in a graph G is an all-to-all connected collection of vertices in G.
An m-clique is a clique consisting of m vertices. Note that if σ is a clique of G, then all
subsets of σ are also cliques.
5

Definition 3.1. Let G be a graph with N vertices. The clique complex of G, denoted
X(G), is the set of all cliques of G:
X(G) = {σ ⊂ [N ] | σ is a clique of G}.
We write Xm (G) for the set of (m + 1)-cliques of G.
The shift in index reflects the “dimension” of a clique, when the clique complex is represented geometrically. If we think of the vertices of the graph G as embedded generically
in a high-dimensional space, each clique represents the simplex given by the convex hull of
its vertices. For example, the convex hull of two vertices is a 1-dimensional edge, for three
vertices we obtain a 2-dimensional triangle, and four vertices yields a 3-dimensional tetrahedron. Thus, cliques in Xm (G) consist of m + 1 vertices, but represent m-dimensional
simplices.
The boundary of a clique σ ⊆ G is the collection of subcliques τ ⊂ σ which have one
fewer vertex. This corresponds to the set of lower-dimensional simplices that comprise
the boundary of the simplex defined by σ (Figure 3b).
The homology of a clique complex X(G), to be defined in section 3.3, is a measurement
of relationships among the cliques in G. Intuitively, homology counts cycles in the clique
complex, a higher-dimensional generalization of the notion of cycles in a graph (Figure
3a). A collection of cliques forms a cycle if their boundaries overlap so as to “cancel”
one another (Figure 3b). We also wish avoid double-counting cycles which are in our
geometric sense equivalent. In particular, two cycles are considered equivalent if one can
be deformed into the other without leaving the clique complex (Figure 3c). Alternatively,
if we can “combine” two cycles to form a third (Figure 3d), we should not detect their
concatenation as a new independent cycle.
a

b

∂

c

d

Figure 3: Illustrations of homology ideas.

6

3.2

Chains and boundaries

To make the above notion of “cancellation” of boundaries precise (and computable), one
introduces linear combinations of cliques, called chains. Given a set of cliques σ1 , . . . , σ` ∈
X(G), one can form a vector space consisting of formal linear combinations of cliques with
coefficients in a field k:
`
X
ai cσi , where ai ∈ k,
i=1

and cσi denotes the basis element corresponding to the clique σi . To define chain groups,
one considers linear combinations of cliques of the same size. Recall that Xm (G) denotes
the set of (m + 1)-cliques of G.
Definition 3.2. The m-th chain group of X(G), with coefficients in k, is the k-vector
space:
( `
)
X
def
Cm (X(G); k) =
ai cσi | σi ∈ Xm (G) and ai ∈ k for each i = 1, . . . , ` .
i=1

As we will always be working with coefficients in an aribitrary field k,2 we will omit it
from the notation and write Cm (X(G)) instead of Cm (X(G); k).Note that C0 (X(G)) consists of formal linear combinations of 1-cliques (vertices), C1 (X(G)) of 2-cliques (edges),
C2 (X(G)) of 3-cliques (triangles), and so on.
The boundaries of cliques can also be described algebraically, allowing this notion to
be extended to chains. If σ = {vi }m
i=0 is an m-clique of G, we use the notation
cσ = cv0 v1 ...vm ,
where v0 < v1 < . . . < vm (recall that each vi ∈ [N ]). Consistent ordering is important
because it affects the signs in the boundary map. Given a sequence of vertices v0 v1 . . . vm ,
we denote by v0 v1 . . . v̂i . . . vm the sequence obtained by omitting the element vi . Note
that for each σ ∈ Xm (G), the element cσ = cv0 v1 ...vm is a basis element of the vector space
Cm (X(G)).
2

For readers uncomfortable with the notion of a general field k, it is relatively harmless to substitute
R or Q for k for the remainder of the discussion. One should keep in mind, however, that the actual
computations typically take place with k a finite field, Z/pZ. This can have an effect on the result: in
such a field, one can add a boundary to itself a finite number of times and get zero, creating “extra”
cycles – called torsion cycles – that would not be present over R. These extra cycles measure aspects of
the clique complex that are not relevant to our purposes. In our software we have chosen the field to be
Z/2Z, but this choice is somewhat arbitrary and not important. So long as all computations are done
using the same field, comparing the resulting homology groups across different graphs is entirely valid.

7

Definition 3.3. The boundary map ∂m : Cm (X(G)) → Cm−1 (X(G)), for m > 0, is given
on basis elements cv0 v1 ...vm by
m
X
∂m (cv0 v1 ...vm ) =
(−1)i cv0 v1 ...v̂i ...vm ,
i=0

P
P
and is extended via linearity to general chains; i.e. ∂m ( j aj cσj ) =
aj ∂m (cσj ). The
map ∂0 is defined to be the zero map.
Recall that in the geometric picture, an (m+1)-clique corresponds to a m-dimensional
simplex, and the boundary of this simplex is the set of m-cliques comprising its (m − 1)dimensional facets – that is, all subcliques on one fewer vertex. We have thus defined
the boundary of a chain in Cm (X(G)) in a fashion consistent with our geometric understanding: as a formal sum of chains in Cm−1 (X(G)), corresponding to simplices that are
one dimension lower (see Figure 3b). Note that signs are assigned to the elements of this
formal sum to indicate the orientation of cliques, which will be critical for obtaining the
desired “cancellation” of boundaries (see Remark 3.6 for details).
Example 3.4. Suppose σ, τ ∈ X2 (G) are cliques on vertices {1, 2, 3} and {1, 2, 4} respectively. The boundary of the 2-chain cσ − cτ ∈ C2 (X(G)) is
∂2 (c123 − c124 ) = ∂2 (c123 ) − ∂2 (c124 )
= (c23 − c13 + c12 ) − (c24 − c14 + c12 )
= c23 − c13 − c24 + c14 .
The cancellation of c12 reflects the fact that the clique {1, 2} appears twice in the boundary
of cσ − cτ , with opposite orientation. Note also that applying ∂1 to the resulting 1-chain
yields
∂1 (∂2 (c123 − c124 )) = ∂1 (c23 − c13 − c24 + c14 )
= (c3 − c2 ) − (c3 − c1 ) − (c4 − c2 ) + (c4 − c1 )
= 0.
In fact, it is straightforward to check from the definition that the composition of two
subsequent boundary maps always yields 0. In other words,
Lemma 3.5. For any m > 0, ∂m ◦ ∂m+1 = 0.
Remark 3.6. The orientation of cliques can be positive or negative. The vertices of a
clique cv0 v1 ...vm ∈ Xm (G) have a canonical ordering induced by the usual ordering of the
vertices [N ] of G. We define the canonical ordering to have positive orientation for each
clique. Any other ordering can be obtained as a permutation of the canonical ordering,
and the resulting ordering is positive or negative according to the sign of the permutation.
For example, c124 has a positive orientation, while c214 is negatively oriented. When we
compute the boundary of a clique cσ in Definition 3.3, the signs arise as a result of the
induced orientation on the boundary cliques. The result of taking all cliques on the
boundary is the signed sum we obtain in Definition 3.3.
8

3.3

Homology of a clique complex

For a given graph G, the chain groups Cm (X(G)) can be strung together to form a chain
complex:
0

∂k+1 =0

/

Ck (X(G))

∂k

/ Ck−1 (X(G))

∂k−1

/

...

∂2

/

C1 (X(G))

∂1

/

C0 (X(G))

∂0 =0

/

0,

The zeroes at either end of the complex represent the zero-dimensional k-vector space,
and the maps at each end are necessarily the zero map.
If a chain is in the kernel of the boundary map, it is because the (oriented) boundaries
of its constituent cliques cancel one another. This is precisely the desired notion of a
cycle, so the set of m-cycles is exactly ker(∂m ); in particular, 1-cycles correspond to the
usual notion of cycles in a graph. Note also that any chain in Cm (X(G)) which forms the
boundary of a clique in Xm+1 (G) is itself a cycle, so its own boundary should be zero.
This is reflected in the fact that ∂m ◦ ∂m+1 = 0 (Lemma 3.5). In particular,
im ∂m+1 ⊂ ker ∂m .
When we are counting cycles for homology, we do not want to consider those which
arise as boundaries of chains, as these are “filled in.” For example, the two clique complexes
in Figure 4 should have the same number of homology 1-cycles. In Figure 4b, we do not
wish to count the chain c23 + c35 − c25 ∈ C1 (X(G)) as a 1-cycle because it is the boundary
of a clique, c235 ∈ C2 (X(G)).
a

1

2

b

1

2

5

4

3

4

3

Figure 4: Two clique complexes for graphs on 4 and 5 vertices.

In order to eliminate cycles that are boundaries of higher-dimensional cliques, one computes quotient vector spaces, ker(∂m )/ im(∂m+1 ).
Definition 3.7. The m-th homology group of X(G) with coefficients in k is the quotient
space
def ker(∂m )
Hm (X(G); k) =
.
im(∂m+1 )
As with chain groups, we will omit the field from our notation and write simply Hm (X(G)).
9

Observe that the zeroth homology group is special: since ∂0 = 0, its kernel is always
C0 (X(G)). The quotient ker(∂0 )/ im(∂1 ) thus identifies vertices which are connected to
one another, so that H0 (X(G)) is a vector space whose basis can be chosen to correspond
to the connected components of G.
Example 3.8. Let G be the graph on four vertices in Figure 4a. The kernel of the boundary
map ∂1 : C1 (X(G)) → C0 (X(G)) is the one-dimensional space spanned by σ = c12 + c23 +
c34 − c14 . Indeed, ∂1 (σ) = (c2 − c1 ) + (c3 − c2 ) + (c4 − c3 ) − (c4 − c1 ) = 0. Since there are no
cliques of size greater than 2, C2 (X(G)) = 0 and hence ∂2 = 0. It follows that H1 (X(G))
is precisely the one-dimensional vector space spanned by σ. Furthermore, since C1 (X(G))
has dimension 4 and ker ∂1 has dimension 1, it follows that im ∂1 has dimension 3. We
can thus deduce that H0 (X(G)) is also one-dimensional, consistent with the fact that G
has just one connected component.
Next, consider the graph G0 on five vertices in Figure 4b. This graph has been obtained
from G by “attaching” the clique {2, 3, 5}. The kernel of ∂1 is now 2-dimensional, and
is spanned by both σ and a new cycle, τ = c23 + c35 − c25 . However, τ ∈ im ∂2 , so we
find that H1 (X(G0 )) continues to be one-dimensional, consistent with our intuition that
G and G0 both have just one cycle that has not been “filled in” by cliques.

a

b

c

d
5

3

2

3

1 2

2

1
1

5

2

3

4

4

4

7

1

6

8

6

Figure 5: Cross-polytopes generate the minimal clique complexes which produce homology
in each dimension. Adapted from Figure 1 of the main text.
Example 3.9. The smallest example of a graph Gm whose clique complex has non-trivial
m-th homology group is the 1-skeleton of the (m + 1)-dimensional cross-polytope (Figure
5). Such a graph can be built inductively starting from the graph G0 (Figure 5a), having
just two vertices and no edges. To obtain G1 from G0 , we attach two new vertices and
include all edges between the new vertices and the vertices of G0 (Figure 5b). More
generally, to obtain Gi from Gi−1 we attach two new vertices and all edges between
these new vertices and those of Gi−1 . Thus, we obtain G2 (Figure 5c) and G3 (Figure
5d), which give minimal examples of graphs whose clique complexes have a non-trivial
homology 2-cycle and 3-cycle, respectively.
A useful characterization of the clique topology of a graph is obtained by simply
tracking the dimensions of the homology groups. This is done via the so-called Betti
numbers.
10

Definition 3.10. The m-th Betti number of X(G), denoted βm (X(G)), is the rank of
Hm (X(G); k) as a k-vector space.
While this information discards the identities of individual cycles, it is well-suited to
statistical methods as it reduces the clique topology of a graph to a sequence of integers.

3.4

Clique topology across the order complex

We now turn our attention to the clique topology of all graphs in the order complex at
once. For a matrix M , the Betti numbers of the graphs in ord(M ) are collected as follows.
Definition 3.11. Let M be a real symmetric matrix and ord(M ) = (G0 ⊂ G1 ⊂ G2 ⊂
cij . The m-th Betti curve of M is the
· · · ⊂ Gp+1 ) its order complex, where p = maxi<j M
p+1
sequence of numbers {βm (ρr )}r=1 , where ρr is the edge density of the graph Gr , and
def

βm (ρr ) = rank Hm (X(Gr )).
As the matrix M will be clear from context, we omit it from the notation.
While each Betti curve is a discrete sequence, we can think of it as being a piecewise
constant function. To simplify comparison, we consider as a summary statistic the integral
of the entire Betti curve. We call this the m-th total Betti number of the matrix M , given
by
Z 1
p+1
X
def
β̄m (M ) =
βm (ρr )∆ρr =
βm (ρ) dρ,
0

r=1


where ∆ρr is the change in edge density between Gr and Gr−1 .3 Typically, ∆ρr = 1/ N2 ,
which is the change in density after adding a single edge. As we will see, the β̄m alone can
distinguish between a random symmetric matrix, drawn from a distribution with i.i.d.
entries, and a geometric matrix, which arises from distances between a set of randomlydistributed points in Euclidean space. Thus, we can use the total Betti number to test
the hypotheses that a matrix is random or geometric.

4

Clique topology of random and geometric matrices

In order to interpret the results of computing clique topology for matrices of interest, we
need suitable null models for comparison. This brings us back to our motivating questions
Q1 and Q2 from section 1. Can we use clique topology to reject the hypothesis that a given
matrix is random or geometric? This will be possible if matrices in these categories have
3

This measurement, β̄m (M ), also appears as the first element in the basis for the ring of algebraic
functions on the collection of all persistence structures described in [ACC13].

11

stereotyped Betti curves. In this case, it can be shown that a matrix with a substantially
different Betti curve is unlikely to have come from the given null model distribution, and
a p-value can be assigned to quantify the significance.
Because clique topology depends only on ord(M ), it suffices to describe the distributions of order complexes we obtain for random and geometric matrices. In both families,
the details of the Betti curves change with N ; however, we find that their large-scale
features are robust once N > 50. This means Betti curves can indeed be used to reject
these models.
c
The distribution of random order complexes arises by sampling a matrix ordering M
from the uniform distribution on all such orderings. For N × N symmetric matriceswith
distinct entries {Mij }i<j , this can be achieved by sampling permutations of {0, . . . , N2 −1}
uniformly at random. Equivalently, the matrix can be chosen with i.i.d. entries drawn
from any continuous distribution, or by shuffling the elements of a given matrix with
distinct off-diagonal entries. Thus, in a graph Gρ of ord(M ), each edge has independent
probability ρ of appearing. In other words, the graphs in the order complex are a nested
family of Erdös-Rényi random graphs. The clique topology of such complexes is relatively
well understood from a theoretical perspective [Kah09], with highly stereotyped, unimodal
Betti curves as illustrated in Figure 6a.

a

b

random/shuffled

geometric

1400
80

1200

# cycles

# cycles

70
1000
800

60
50
40

600

30
400
20
200

10

0.1

0.2

0.3

edge density

0.4

0.5

0.6

ρ

0.1

0.2

0.3

edge density

0.4

0.5

0.6

ρ

Figure 6: Betti curves for random and geometric matrices. (a) N = 100, and means for
β1 (ρ) (yellow), β2 (ρ) (red), and β3 (ρ) (blue) are displayed with bold lines, while shading
indicates 99.5% confidence intervals. (b) N=100, and average Betti curves are displayed
for dimensions d = 10, 50, 100, 1000, 10000, in increasing order (i.e., higher curves correspond to larger dimensions).
A geometric order complex is one arising from the negative distance matrix of a collection of points embedded in some Euclidean space. We choose negative distance matrices so
that the highest matrix values correspond to the nearest distances; this is consistent with
the intuition that correlations should decrease with distance, as described in the main text.
Sampling such a complex consists of sampling N i.i.d. points, {pi }, from some distribution
on Rd . The associated sequence of clique complexes, X(G0 ) ⊂ X(G1 ) ⊂ . . . ⊂ X(Gp+1 ),
12

corresponding to a geometric order complex is also referred to as the Vietoris-Rips complex of the underlying points.
These complexes have been heavily studied in cases where the points are presumably
sampled from an underlying manifold [CZCG04]. In our setting, however, we sample
points from the uniform distribution on the unit cube in Rd for d ≤ N. To our knowledge,
the Betti curves of geometric order complexes are largely unstudied. Our numerical
experiments show that they are highly stereotyped (Figure 6b), irrespective of d for a
large range of dimensions.4 Moreover, they are roughly an order of magnitude smaller
at the peak than the Betti curves of random order complexes with matching N , and the
peak values decrease rather than increase as we move between β1 (ρ) to β2 (ρ) and β3 (ρ).
The differences between the Betti curves of random and geometric matrices can also be
understood through the lens of persistence lifetimes, which we will describe in section 5.2.

4.1

Dimension of geometric order complexes

c appears with equal probability in the distribution of random
Any matrix ordering M
symmetric matrices with i.i.d. entries. The consistency of the Betti curves in Figure 6a
indicates that “most” of these matrix orderings have a similar organization of cliques. For
geometric matrices, the possible matrix orderings are sampled in a highly non-uniform
manner, leading to dramatically different Betti curves. Despite this, it is worth noting
that any matrix ordering can in fact arise from a distance matrix.
Definition 4.1. A set of points p1 , . . . , pN ∈ Rd is called a geometric realization of the
c if the distance matrix Dij = ||pi − pj || has D
b =M
c.
matrix ordering M
Note that for each collection of three or more points, the (higher) triangle inequalities
c. This means that for most matrix
implied by the metric impose strong constraints on M
orderings, the probability of sampling a point configuration in the unit cube that yields a
c is vanishingly small. This is why geometric Betti curves are, on
geometric realization of M
average, so different from those of random matrices. Nevertheless, geometric realizations
do always exist, provided d ≥ N − 1.

c that has N distinct off-diagonal entries
Lemma 4.2. Every N × N matrix ordering M
2
possesses a geometric realization in (N − 1)-dimensional Euclidean space. Moreover, this
realization can be chosen as
!
N
εX
1
~ei −
Mij ~ej ,
pi = √
2 j=1
2
4

We observed similar Betti curves to those in Figure 6b for values of d that were orders of magnitude
larger than N . Nevertheless, there is some evidence to indicate that Betti curves will approach those of
random order complexes as d → ∞.

13

c and zeroes
for small enough ε > 0, where M is any symmetric matrix with ordering M
N
N
on the diagonal, and {~ei }i=1 is the standard orthonormal basis in R .
Proof. With the choice above, ||pi − pj ||2 = ||pi ||2 + ||pj ||2 − 2pi · pj = 1 + εMij + O(ε2 ).
Despite this fact, when we constrain the dimension d of the Euclidean space we do
find matrix orderings that cannot be geometrically realized at all. This was the basis for
our examples in Figure 2a of the main text.

4.2

Figure 2a examples from the main text

Here we prove that the d ≥ 2 and d ≥ 3 matrices (reproduced in Figure 1) cannot be
geometrically realized in lower dimensions.
To see why the d ≥ 2 matrix cannot arise from an arrangement of points on a line,
observe that the three smallest matrix entries are M12 , M13 , and M14 . This implies the
three shortest distances in a corresponding point arrangement must all involve the point
p1 , which is not possible for points on a line.
To see why the d ≥ 3 matrix cannot arise from an arrangement of points on a plane,
notice that the six smallest matrix entries are Miα , for i = 1, 2, 3 and α = 4, 5. This
means the six smallest distances are those of the form kpi − pα k, for i = 1, 2, 3 and
α = 4, 5. Without loss of generality we can assume kpi − pα k < 1, and all other distances
are greater than one. Now suppose the points p1 , . . . , p5 all lie in a plane. Then p4 , p5 ∈
D(p1 ) ∩ D(p2 ) ∩ D(p3 ), where D(pi ) is a disk of radius 1 centered at pi . Since none of the
disk centers in contained in any of the other two disks, the largest distance between two
points in the intersection D(p1 ) ∩ D(p2 ) ∩ D(p3 ) is less than one, and thus kp4 − p5 k < 1,
which is a contradiction. We conclude that the matrix cannot arise from points in the
plane. We thank Anton Petrunin for this example.

5

Computational aspects and persistence

Each graph in an order complex, G0 ⊂ G1 ⊂ · · · ⊂ Gp+1 , is a subgraph of its successor.
Intuitively, this means that the clique topology of any Gr is closely related to the clique
topology of the previous graph, Gr−1 . Exploiting this structure dramatically reduces
the computational complexity of finding Betti curves (defined in section 3.4), and also
provides us with finer matrix invariants in the form of persistence lifetimes of cycles.
This is achieved via persistent homology, an approach that enables homology cycles to be
tracked as we move from one graph in the order complex to the next.

5.1

A brief history of persistent homology

The mathematics underlying persistent homology has existed since the middle of the
twentieth century, in the guise of Morse theory and spectral sequences for the homology
14

of filtered spaces. Its interpretation as a tool for data analysis, however, is a much
more recent development. One can trace the origins of these applications to work on
size theory in computer vision [FL11, CFP01, FM99] and alpha shapes in computational
geometry [Rob99, Ede95, EM94, ELZ00]. The use of persistent homology as a tool for
the study of data sets relies on two fundamental and recent developments: computabilty
and robustness.
Computability arose from the persistence algorithm, developed first for subsets of
three-dimensional complexes in [ELZ00] and then extended to work with general simplicial
complexes in [ZC05]. In addition to the algorithm, these papers introduced the notions of
persistence diagrams and modules. Several software packages [TVJA11, Mor14, Tau11]
have been developed based on the persistence algorithm, and recent work using discrete
Morse theory has led to further improvements in speed and memory efficiency [Nan14].
Robustness to perturbations of the underlying simplicial complexes, on the other hand,
was first explicitly shown through the bottleneck stability theorem of [CSEH07]. Further
work has broadened this result by developing more complete theoretical tools for the comparison of persistence structures, divorcing their stability from any underlying geometry
[CCSG+ 09, CdSGO12, CdSO12]. It is this interpretation of stability that most clearly
applies to our study of order complexes.
Although persistent homology has only recently emerged a tool for studying features
of data, it has already found a broad range of applications [CCR13b, SMI+ 08b, GH10,
CIdSZ08].

5.2

Persistent homology of order complexes

Here we present the basic ideas in persistent homology, restricted to the special case
of computing clique topology for order complexes. This means we need to apply the
persistence algorithm to filtered families of clique complexes,
X(G0 ) ⊂ X(G1 ) ⊂ · · · ⊂ X(Gp ) ⊂ X(Gp+1 ),
where the graphs {Gr } comprise the order complex of a symmetric matrix. In order
to track homology cycles from one clique complex to the next, we need to understand
how the natural inclusion maps on the graphs, ιr : Gr ,→ Gr+1 , translate to maps on
the corresponding cliques, chains, and homology groups, Hm (X(Gr )). This turns out
to be straightforward, as there is an obvious extension to maps on clique complexes,
ιr : X(Gr ) ,→ X(Gr+1 ), and these in turn can be extended linearly to maps between
chain groups.
Lemma 5.1. Consider the order complex G0 ⊂ G1 ⊂ · · · ⊂ Gp+1 . The standard inclusion
maps, ιr : Gr ,→ Gr+1 , induce maps on homology (ιr )m : Hm (X(Gr )) → Hm (X(Gr+1 )).
Using these maps, we can follow individual cycles and understand their evolution as
we move from one graph to the next in the order complex. Of particular interest are the
edge densities at which cycles appear and disappear (Figure 7).
15

Definition 5.2. Let ω ∈ Hm (X(Gr )) be a non-zero cycle which is not in the image of
ιr−1 , and let s > r be the smallest integer such that ιs−1 ◦ ιs−2 ◦ . . . ◦ ιr (ω) = 0. We say
that ω is born at r and dies at s, and has persistence lifetime `(ω) = s − r.

d

ex

ρ0

ρ2

e

ρ3

Figure 7: Illustration of persistence lifetime. The 1-cycle (yellow) appears at edge density
ρ = 0.45

.25

ρ1 and disappears at ρ3 , so random/shuffled
it’s lifetime is ` = ρ3 − ρBetti
1.

1

2

12
3
4

11

6
7

5

5

8

2
12

β2(ρ)
5.3 Persistence lifetimes β
of3(ρ)
random and geometric order com-

9

10

4

For
a given order complex,
the distribution
800
β1(ρ) of persistence lifetimes provides a measure
3
of matrix structure that is complementary to the Betti curves defined in section 3.4.
4

10

5

6

curves

1000

2

plexes

# cycles

1

ρ1

600

400

Recall
sharp qualitative difference in the Betti curves of random order
6 that there is a200
complexes
and
those
of
geometric order complexes (Figure 6). These differences are also
1
7 10
6
reflected in the distributions
of their persistence lifetimes. While random complexes have
0
0.2 the geometric
4
0.6 heavily weighted
0.4complexes are
0
2
relatively
broad
distributions
(Figure 8a),
density
5
toward shorter
lifetimes (Figure 8b). Theedge
shapes
of these ρ
distributions are a direct con12
9
sequence of the order in which edges are added in the order complex.
The qualitative differences in these distributions can be understood by thinking about
dependencies in edge orderings in the order complex. Minimal cycles, represented by crosspolytopes (Figure 5), are known to constitute the large majority of cycles in random order
complexes [KM13], and can thus be used to understand the shape of the distribution. Such
a cycle’s lifetime is governed by the density at which the first additional edge appears,
since the extra edge destroys the cycle by creating new cliques. Since the ordering of the
edges is completely random, the lifetimes will be broadly distributed. In contrast, geometric order complexes are constrained by triangle inequalities (and higher-dimensional
analogues); these produce dependencies in the edge ordering which imposes an upper limit
on the lifetime of small cycles, like the cross-polytopes.5 Persistence lifetimes in geometric
complexes are thus concentrated at short lifetimes.
5

This is true statistically. It is, of course, possible for two distances to be close in absolute terms and
still be separated by many edges in the order complex, but this is rare enough that the intuition about
Betti curves still holds.

16

b

100

100

80

60

80

60

80

60

40

40

40

20

20

20

0

0
0.1 0.2 0.3 0.4 0.5

edge density

ρ

0
0.1

0.2 0.3 0.4

edge density

30

30

30

25

25

25

20

15

0.1 0.2 0.3 0.4 0.5

ρ

edge density

ρ

20

15

20

15

10

10

10

5

5

5

0

0.5

# cycles

100

geometric

# cycles

120

# cycles

120

# cycles

# cycles

random/shuffled
120

# cycles

a

0
0.1 0.2 0.3 0.4 0.5

edge density

ρ

0
0.1 0.2 0.3 0.4 0.5

edge density

ρ

0.1 0.2 0.3 0.4 0.5

edge density

ρ

Figure 8: Persistence lifetimes for random and geometric matrices. (a) N = 100, and
mean lifetime distributions for 1-cycles (yellow), 2-cycles (red), and 3-cycles (blue) are
displayed with bold lines, while shading indicates 99.5% confidence intervals. (b) N=100,
and average lifetime distributions are displayed for dimensions d = 10, 50, 100, 1000, 10000,
in increasing order (i.e., higher curves correspond to larger dimensions).

5.4

CliqueTop software

To compute clique topology for symmetric matrices, we developed the CliqueTop Matlab
package. This software is maintained by Chad Giusti, and is available on GitHub at
https://github.com/nebneuron/clique-top. At the time of this writing, CliqueTop
makes use of one other package: Perseus [Nan14], by Vidit Nanda. Perseus provides an
implementation of the persistence algorithm, and is available at http://www.sas.upenn.
edu/~vnanda/perseus/index.html. Previous versions of CliqueTop also used the Cliquer
software package [NO02].

References
[ACC13]

Aaron Adcock, Erik Carlsson, and Gunnar Carlsson. The ring of algebraic
functions on persistence bar codes, 2013.

[CCR13a]

Joseph Minhow Chan, Gunnar Carlsson, and Raul Rabadan. Topology of
viral evolution. Proceedings of the National Academy of Sciences, 2013.

[CCR13b]

Joseph Minhow Chan, Gunnar Carlsson, and Raul Rabadan. Topology of
viral evolution. Proc. Natl. Acad. Sci. USA, 110(46):18566–18571, 2013.

[CCSG+ 09] F. Chazal, D. Cohen-Steiner, M. Glisse, L. J. Guibas, and S. Y. Oudot.
Proximity of persistence modules and their diagrams. In Proc. 25th Annu.
Symposium on Computational Geometry, pages 237–246, 2009.
17

[CdSGO12] Frederic Chazal, Vin de Silva, Marc Glisse, and Steve Oudot. The structure
and stability of persistence modules, 2012.
[CdSO12]

Frederic Chazal, Vin de Silva, and Steve Oudot. Persistence stability for
geometric complexes, 2012.

[CFP01]

Francesca Cagliari, Massimo Ferri, and Paola Pozzi. Size functions from a
categorical viewpoint. Acta Appl. Math., 67(3):225–235, 2001.

[CGYW14] Zhe Chen, Stephen N. Gomperts, Jun Yamamoto, and Matthew A. Wilson.
Neural representation of spatial topology in the rodent hippocampus. Neural
computation, 26(1):1–39, Jan 2014.
[CI08]

Carina Curto and Vladimir Itskov. Cell groups reveal structure of stimulus
space. PLoS Comput Biol, 4(10), 2008.

[CIdSZ08]

Gunnar Carlsson, Tigran Ishkhanov, Vin de Silva, and Afra Zomorodian.
On the local behavior of spaces of natural images. Int. J. Comput. Vision,
76(1):1–12, January 2008.

[CSEH07]

David Cohen-Steiner, Herbert Edelsbrunner, and John Harer. Stability of
persistence diagrams. Discrete Comput. Geom., 37(1):103–120, 2007.

[CZCG04]

Anne D. Collins, Afra Zomorodian, Gunnar E. Carlsson, and Leonidas J.
Guibas. A barcode shape descriptor for curve point cloud data. Computers
& Graphics, 28(6):881–894, 2004.

[DMFC12] Y. Dabaghian, F. Memoli, L. Frank, and G. Carlsson. A topological paradigm
for hippocampal spatial map formation using persistent homology. PLoS
Comput Biol, 8(8), 08 2012.
[Ede95]

H. Edelsbrunner. The union of balls and its dual shape. Discrete Comput.
Geom., 13(3-4):415–440, 1995.

[ELZ00]

Herbert Edelsbrunner, David Letscher, and Afra Zomorodian. Topological
persistence and simplification. In 41st Annual Symposium on Foundations of
Computer Science (Redondo Beach, CA, 2000), pages 454–463. IEEE Comput. Soc. Press, Los Alamitos, CA, 2000.

[EM94]

H. Edelsbrunner and E. P. Mucke. Three-dimensional alpha shapes. ACM
Trans. Graphics, 13:43–72, 1994.

[FL11]

Patrizio Frosini and Claudia Landi. Persistent Betti numbers for a noise
tolerant shape-based approach to image retrieval. In Computer analysis of
images and patterns. Part I, volume 6854 of Lecture Notes in Comput. Sci.,
pages 294–301. Springer, Heidelberg, 2011.
18

[FM99]

Patrizio Frosini and Michele Mulazzani. Size homotopy groups for computation of natural size distances. Bull. Belg. Math. Soc. Simon Stevin, 6(3):455–
464, 1999.

[GH10]

Jennifer Gamble and Giseon Heo. Exploring uses of persistent homology for
statistical analysis of landmark-based shape data. Journal of Multivariate
Analysis, 101(9):2184 – 2199, 2010.

[Hat02]

Allen Hatcher. Algebraic topology. Cambridge University Press, Cambridge,
2002.

[Kah09]

Matthew Kahle. Topology of random clique complexes. Discrete Math.,
309(6):1658–1671, 2009.

[KM13]

Matthew Kahle and Elizabeth Meckes. Limit theorems for Betti numbers
of random simplicial complexes. Homology Homotopy Appl., 15(1):343–374,
2013.

[Mor14]

Dmitriy Morozov. Dionysis, c++ library for computing persistent homology.
http://www.mrzv.org/software/dionysus/, 2011–2014.

[Nan14]

Vidit Nanda. Perseus, the persistent homology software. http://www.sas.
upenn.edu/~vnanda/perseus Accessed 06/14, 2012–2014.

[NLC11]

Monica Nicolau, Arnold J. Levine, and Gunnar Carlsson. Topology based
data analysis identifies a subgroup of breast cancers with a unique mutational profile and excellent survival. Proceedings of the National Academy of
Sciences, 108(17):7265–7270, 2011.

[NO02]

Sampo Niskanen and Patric Östergård. Cliquer. http://users.tkk.fi/
pat/cliquer.html, 2002.

[Rob99]

V. Robins. Towards computing homology from finite approximations. In
Proceedings of the 14th Summer Conference on General Topology and its
Applications (Brookville, NY, 1999), volume 24, pages 503–532 (2001), 1999.

[SMI+ 08a] Gurjeet Singh, Facundo Memoli, Tigran Ishkhanov, Guillermo Sapiro, Gunnar Carlsson, and Dario L Ringach. Topological analysis of population activity in visual cortex. Journal of vision, 8(8):11, 2008.
[SMI+ 08b] Gurjeet Singh, Facundo Memoli, Tigran Ishkhanov, Guillermo Sapiro, Gunnar Carlsson, and Dario L Ringach. Topological analysis of population activity in visual cortex. Journal of vision, 8(8):11, 2008.

19

[Tau11]

Andrew Tausz. phom: Persistent homology in r. http://cran.r-project.
org, 2011.

[TVJA11]

Andrew Tausz, Mikael Vejdemo-Johansson, and Henry Adams. Javaplex: A
research software package for persistent (co)homology. http://javaplex.
github.io/javaplex/, 2011.

[ZC05]

Afra Zomorodian and Gunnar Carlsson. Computing persistent homology.
Discrete Comput. Geom., 33(2):249–274, 2005.

20

